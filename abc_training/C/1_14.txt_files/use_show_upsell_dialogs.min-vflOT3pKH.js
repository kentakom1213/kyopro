define(["require","exports","tslib","react","api_v2/user_client","modules/clean/react/file_viewer/sdk_file_viewer/upsell/upsell_dialog_user_actions_tracker","modules/clean/react/campaigns/campaign_events_api"],(function(i,e,n,a,o,s,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.trackDismissAction=e.useShowUpsellDialogs=e.initialState=void 0,e.initialState={proEsign:{showUpsell:!1,stormcrowVariant:"OFF",productPlanType:"UNKNOWN",campaignContext:void 0,proEsignSpaceCopy:""},docsend:{showUpsell:!1,stormcrowVariant:"OFF",campaignContext:void 0}};const c=["pdf","doc","docx"],r=["pdf","docx","doc","pptx","ppt","xlsx","xls","key"];function p(i,e){var n,a,o,s,t,c;switch(e.type){case"showProEsignCampaign":return Object.assign(Object.assign({},i),{proEsign:Object.assign(Object.assign({},i.proEsign),{showUpsell:!0,stormcrowVariant:null===(n=e.proEsignPayload)||void 0===n?void 0:n.stormcrowVariant,productPlanType:null===(a=e.proEsignPayload)||void 0===a?void 0:a.productPlanType,campaignContext:null===(o=e.proEsignPayload)||void 0===o?void 0:o.campaignContext,proEsignSpaceCopy:null===(s=e.proEsignPayload)||void 0===s?void 0:s.proEsignSpaceCopy})});case"showDocsendUpsellCampaign":return Object.assign(Object.assign({},i),{docsend:Object.assign(Object.assign({},i.docsend),{showUpsell:!0,stormcrowVariant:null===(t=e.docsendPayload)||void 0===t?void 0:t.stormcrowVariant,campaignContext:null===(c=e.docsendPayload)||void 0===c?void 0:c.campaignContext})});default:return i}}function l(i){return n.__awaiter(this,void 0,void 0,(function*(){try{return{value:yield i,failed:!1}}catch(i){return{failed:!0}}}))}e.useShowUpsellDialogs=function(i,n){const[s,d]=a.useReducer(p,e.initialState);return a.useEffect(()=>{let e=!0;if(void 0!==i&&void 0!==n){if(!n.ext)return;const a=n.ext.slice(1);Promise.all([c.includes(a)?l((new o.UserApiV2Client).ns("growth_bundling").rpc("show_pro_esign_upsell",{sjid:n.sjid,ns_id:n.ns_id,file_ext:n.ext.slice(1),surface:"sdk_file_viewer"},{subjectUserId:i})):Promise.resolve(),r.includes(a)?l((new o.UserApiV2Client).ns("growth_bundling").rpc("show_docsend_upsell",{sjid:n.sjid,ns_id:n.ns_id,file_ext:n.ext.slice(1)},{subjectUserId:i})):Promise.resolve()]).then(([i,n])=>{var a,o,s;const c=i&&i.value,r=n&&n.value;e&&(c&&c.show_campaign&&d({type:"showProEsignCampaign",proEsignPayload:{showUpsell:!0,stormcrowVariant:c.variant||"",productPlanType:c.product_plan_type||"",campaignContext:void 0!==(null===(a=c.campaign_context)||void 0===a?void 0:a.campaign_impression_id)?t.createMegaphoneCampaignImpressionContext(c.campaign_context.campaign_impression_id,c.campaign_context.campaign_id,c.campaign_context.campaign_variant_id):void 0,proEsignSpaceCopy:(null===(o=c.rcs_copy)||void 0===o?void 0:o.pro_esign_space)||""}}),r&&r.show_campaign&&d({type:"showDocsendUpsellCampaign",docsendPayload:{showUpsell:!0,stormcrowVariant:r.variant||"",campaignContext:void 0!==(null===(s=r.campaign_context)||void 0===s?void 0:s.campaign_impression_id)?t.createMegaphoneCampaignImpressionContext(r.campaign_context.campaign_impression_id,r.campaign_context.campaign_id,r.campaign_context.campaign_variant_id):void 0}}))})}return()=>{e=!1}},[i,n]),s},e.trackDismissAction=i=>{if(!i)return;new s.EsignUpsellUserActionTracker(i).track(s.EsignUpsellUserAction.DISMISS)}}));
//# sourceMappingURL=use_show_upsell_dialogs.min.js-vflp73rkk.map