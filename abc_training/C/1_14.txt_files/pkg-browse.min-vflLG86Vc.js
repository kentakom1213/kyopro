define("modules/clean/react/browse/model_types",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FetchFolderSizeState=void 0,(function(e){e.LOADING="LOADING",e.COMPLETE="COMPLETE",e.NO_ACCESS="NO_ACCESS",e.ERROR="ERROR"})(t.FetchFolderSizeState||(t.FetchFolderSizeState={}))})),define("modules/clean/cloud_docs/create_api",["require","exports","tslib","apex-metrics/index","api_v2/user_client","modules/clean/cloud_docs/constants","modules/clean/cloud_docs/create_pointer_modal","modules/clean/cloud_docs/event_logging","modules/clean/cloud_docs/types","modules/clean/filepath/filepath","modules/clean/logging/hive/schemas/web-modal-activity","modules/clean/react/async_file_modal_controller","modules/clean/react/folder_dialog/async","modules/clean/react/components/modal","modules/clean/react/snackbar","modules/clean/react/browse/api","modules/clean/react/browse/action_logger","modules/clean/web_user_action_events","modules/core/browser","modules/core/cookies","modules/core/i18n","spectrum/util/uuid_generator","modules/clean/metrics/index","modules/clean/cloud_docs/constants"],(function(e,t,s,o,i,r,a,n,l,c,d,u,_,p,m,f,h,g,S,E,T,b,w,I){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCreateActionSource=t.createNewPointer=t.createNewCloudOnlyDoc=t.createPlaceholderTabForNewCloudDoc=t.constructFormForCreateNewMicrosoftFile=t.createNewFile=t.showAsyncFolderDialog=t.logCreateFileSuccessCallback=t.logCreateFileCallback=t.logCreateFileAttempt=t.getDepthFromPath=t.CloudDocSnackbarId=void 0,c=s.__importStar(c),u=s.__importStar(u),_=s.__importStar(_),f=s.__importStar(f),S=s.__importStar(S);const v=T.intl.formatMessage({id:"UpDkTB",defaultMessage:"Create file in..."}),O=T.intl.formatMessage({id:"7E4VWP",defaultMessage:"Create shortcut in..."}),C=T.intl.formatMessage({id:"bhV8Xa",defaultMessage:"Create"}),F=T.intl.formatMessage({id:"GDikFY",defaultMessage:"Choose folder"});t.CloudDocSnackbarId="create-cloud-doc",t.getDepthFromPath=e=>(e.replace(/\/$/,"").match(/\//g)||[]).length,t.logCreateFileAttempt=(e,t)=>{n.logUserAction({actionEvent:l.UserActionEventType.PRE_CREATE,userId:t.userId,actionSource:t.action_source,data:{webOpenId:e}})},t.logCreateFileCallback=({ts:e,documentType:t,selectionMode:i,emptyFolder:r,error:a})=>s.__awaiter(void 0,void 0,void 0,(function*(){const s=w.getMetricsReporter(),n={};n.document_type=t||"unknown",n.selection_mode=i||"undefined",n.empty_folder=String(r),n.error=a?"true":"false",s.createStats({ns:I.CLOUD_DOCS_AMP_NAMESPACE,name:"web/createFile"},n).recordDuration(Date.now()-e,o.TimeUnit.MILLISECONDS)})),t.logCreateFileSuccessCallback=({ts:e,openId:s,selection_mode:o,empty_folder:i})=>r=>{t.logCreateFileCallback({ts:Date.now(),documentType:r.documentType,selectionMode:o,emptyFolder:i}),h.logFileCreateSuccess({uid:r.userId,document_type:r.documentType,time_elapsed:Date.now()-e,open_id:s,selection_mode:o,empty_folder:i}),n.logUserAction({actionEvent:l.UserActionEventType.CREATE,userId:r.userId,docPathOrId:r.fq_path,actionSource:r.action_source,data:{webOpenId:s}})},t.showAsyncFolderDialog=({user:e,source:s,documentType:o,selection_mode:i,empty_folder:a,handleClickNewFolder:n,initialPath:l})=>{const c=r.isPointerFileType(o),u=c?O:v,p=c?F:C;_.showFolderDialog({modalName:d.ModalName.CLOUD_DOCS_CREATE,user:e,title:u,primaryActionLabel:p,handleClickNewFolder:n,initialPath:l,useApiV2:!0,onSuccess:(r,n)=>{const l=r||"/";h.logFileCreateClick({uid:e.id,source:s,action:g.WebUserActionLogEvent.FILE_CREATE_HOME_FOLDER_SELECTED,depth_folder_selected:t.getDepthFromPath(l),selection_mode:i,empty_folder:a}),t.createNewFile({user:e,path:l,documentType:o,source:s,selection_mode:i,empty_folder:a})}})},t.createNewFile=({user:o,path:i,documentType:l,source:c,selection_mode:d,empty_folder:u})=>s.__awaiter(void 0,void 0,void 0,(function*(){return Promise.all([new Promise((t,s)=>{e(["modules/clean/account/email"],t,s)}).then(s.__importStar),new Promise((t,s)=>{e(["modules/clean/account/email_verify_reasons"],t,s)}).then(s.__importStar)]).then(([{EmailVerification:e},{EmailVerificationReasons:s}])=>{if(!e.get_for_user(o).verified_or_show(s.CLOUD_DOCS))return;const _=b.generateUUID("web-create");if(r.isMicrosoftFileType(l)){t.logCreateFileAttempt(_,{userId:o.id,action_source:n.getActionSourceFromNewFileMenuType(c)});const e=t.logCreateFileSuccessCallback({ts:Date.now(),openId:_,selection_mode:d,empty_folder:u});R({userId:o.id,path:i,documentType:l,logSuccessCallback:e,source:c})}else if(r.isPointerFileType(l))a.CreatePointerModal.showInstance({createOnSubmit:e=>{t.logCreateFileAttempt(_,{userId:o.id,action_source:n.getActionSourceFromNewFileMenuType(c)});const s=t.logCreateFileSuccessCallback({ts:Date.now(),openId:_,selection_mode:d,empty_folder:u});t.createNewPointer({userId:o.id,pathName:i,name:e.pointerData.name,url:e.pointerData.url,onError:e.onError,logSuccessCallback:s,source:c})}});else{t.logCreateFileAttempt(_,{userId:o.id,action_source:n.getActionSourceFromNewFileMenuType(c)});const e=t.logCreateFileSuccessCallback({ts:Date.now(),openId:_,selection_mode:d,empty_folder:u});t.createNewCloudOnlyDoc({userId:o.id,pathName:i,title:T.intl.formatMessage({id:"j+AeKy",defaultMessage:"Untitled"}),documentType:l,logSuccessCallback:e,source:c,openId:_,selection_mode:d,empty_folder:u})}})}));const R=({userId:e,path:s,documentType:o,logSuccessCallback:i,source:r})=>{const a={fq_path:s,extension:o,action_source:t.getCreateActionSource(r),_subject_uid:String(e),t:E.Cookies.read("__Host-js_csrf")},l=t.constructFormForCreateNewMicrosoftFile(a);document.body.appendChild(l),l.submit(),i({userId:e,documentType:o,action_source:n.getActionSourceFromNewFileMenuType(r)})};t.constructFormForCreateNewMicrosoftFile=e=>{const t=document.createElement("form");t.action="/ow/msft/create_new_file",t.method="POST",t.target="_blank";for(const s of Object.keys(e)){const o=document.createElement("input");o.type="hidden",o.name=s,o.value=e[s],t.appendChild(o)}return t},t.createPlaceholderTabForNewCloudDoc=()=>S.open_tab(r.LOADING_PAGE_URL,!0),t.createNewCloudOnlyDoc=({userId:e,pathName:s,title:o,documentType:i,logSuccessCallback:r,source:a,openId:l,selection_mode:c,empty_folder:d})=>{const _=T.intl.formatMessage({id:"XcMi4Q",defaultMessage:"Creating new file…"}),p=T.intl.formatMessage({id:"5VrbkU",defaultMessage:"File created!"}),h=e=>(e.preventDefault(),e.returnValue="","");window.addEventListener("beforeunload",h);let g=t.createPlaceholderTabForNewCloudDoc();const S=E=>{m.Snackbar.sync(_,!0,t.CloudDocSnackbarId),f.createCloudDoc({pathName:s,title:o,documentType:i,userId:e,onSuccess:({changesets:s,createdFile:o,failureDetails:_})=>{if(_){const e=()=>{r=t.logCreateFileSuccessCallback({ts:Date.now(),openId:l,selection_mode:c,empty_folder:d}),g=t.createPlaceholderTabForNewCloudDoc(),S(!1)};g.close(),m.Snackbar.close(t.CloudDocSnackbarId),window.removeEventListener("beforeunload",h),u.showFileSystemWarningsModal({fsws:_,confirmText:T.intl.formatMessage({id:"bhV8Xa",defaultMessage:"Create"}),onFinalAccept:e})}else if(m.Snackbar.complete(p,t.CloudDocSnackbarId),window.removeEventListener("beforeunload",h),null!==o&&(r({userId:e,documentType:i,fq_path:o.fq_path,action_source:n.getActionSourceFromNewFileMenuType(a)}),g)){let e=o.open_to_url;try{const t=new URL(e);t.searchParams.set("web_open_id",l),e=t.toString()}catch(e){}g.location.replace(e)}},onError:e=>{t.logCreateFileCallback({ts:Date.now(),documentType:i,selectionMode:c,emptyFolder:d,error:!0}),m.Snackbar.fail(e,t.CloudDocSnackbarId),window.removeEventListener("beforeunload",h)},checkFSWs:E})};S(!0)},t.createNewPointer=({userId:e,pathName:t,name:s,url:o,onError:a,logSuccessCallback:d,source:u})=>{const _=new i.UserApiV2Client,f=T.intl.formatMessage({id:"l6L9q8",defaultMessage:"Creating new shortcut"}),h=T.intl.formatMessage({id:"EqUCHi",defaultMessage:"Created shortcut"});return m.Snackbar.sync(f,!0,"create-cloud-shortcut"),_.ns("cloud_docs").rpc("create",{to_path:c.normalize(t)||"/",title:s,cloud_doc_type:l.SimplePointer,pointer_url:o},{subjectUserId:e}).then(t=>{d({userId:e,documentType:r.PointerFileTypes.SIMPLE_POINTER,fq_path:t.result_path,action_source:n.getActionSourceFromNewFileMenuType(u)}),p.Modal.close(),m.Snackbar.complete(`${h} "${c.filename(t.result_path)}"`,"create-cloud-shortcut")}).catch(e=>{a(),m.Snackbar.fail(T.intl.formatMessage({id:"fi9Okp",defaultMessage:"Oops, something went wrong. Please try again later."}),"create-cloud-shortcut")})},t.getCreateActionSource=e=>{switch(e){case r.NewFileMenuFromType.BROWSE:return r.ActionSourceValue.WEB_BROWSE;case r.NewFileMenuFromType.HOME:return r.ActionSourceValue.WEB_HOME;default:return r.ActionSourceValue.WEB}}})),define("modules/clean/cloud_docs/create_pointer_modal",["require","exports","tslib","react","modules/clean/cloud_docs/pointers_common","modules/clean/react/components/css","modules/clean/react/components/modal","modules/core/i18n","spectrum/button/index","spectrum/modal/index"],(function(e,t,s,o,i,r,a,n,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CreatePointerModal=void 0,o=s.__importDefault(o);const d=n.intl.formatMessage({id:"Qq0yqO",defaultMessage:"Create a new shortcut"}),u=n.intl.formatMessage({id:"bhV8Xa",defaultMessage:"Create"}),_=n.intl.formatMessage({id:"KOp2Z9",defaultMessage:"Creating..."}),p=n.intl.formatMessage({id:"d9/SE1",defaultMessage:"Cancel"}),m=n.intl.formatMessage({id:"cJojIg",defaultMessage:"Name"}),f=n.intl.formatMessage({id:"Di2bB3",defaultMessage:"URL"}),h=n.intl.formatMessage({id:"vtIvYJ",defaultMessage:"Invalid URL"});class g extends o.default.Component{constructor(e){super(e),this.onChange=e=>{this.setState({pointerData:e})},this.handleCreateOnClick=()=>{this.setState({creationInProgress:!0}),this.props.createOnSubmit({pointerData:{name:this.state.pointerData.name.trim(),url:this.state.pointerData.url.trim()},onError:this.handleSubmitError})},this.handleSubmitError=()=>{this.setState({creationInProgress:!1})},this.renderCreateButton=()=>{const e=i.CreatePointerFields.canSubmit(this.state.pointerData)&&!this.state.creationInProgress;return o.default.createElement(l.Button,{variant:"primary",disabled:!e,onClick:this.handleCreateOnClick},this.state.creationInProgress?_:u)},this.closeModal=()=>{a.Modal.close()},this.renderCancelButton=()=>o.default.createElement(l.Button,{variant:"secondary",onClick:this.closeModal},p),this.state={pointerData:{name:"",url:""},creationInProgress:!1}}render(){return o.default.createElement(c.UtilityModal,{title:d,ariaLabel:"Shortcut Creation Modal",primaryAction:this.renderCreateButton,secondaryAction:this.renderCancelButton,open:!0,shouldRequestCloseOnActions:!1,overlayClickClose:!0,variant:"regular"},o.default.createElement(i.CreatePointerFields,{name:this.state.pointerData.name,url:this.state.pointerData.url,onChange:this.onChange,onSubmit:this.handleCreateOnClick,nameLabel:m,urlLabel:f,urlValidationMessage:h}))}static showInstance(e){return a.Modal.showInstance(o.default.createElement(S,Object.assign({},e)))}}t.CreatePointerModal=g,g.displayName="CreatePointerModal";const S=r.requireCssWithComponent(g,["/static/css/spectrum/index.web-vfliw9181.css","/static/css/cloud_docs/create_pointer_modal-vflATc8Dt.css"])})),define("modules/clean/cloud_docs/event_logging",["require","exports","tslib","api_v2/user_client","api_v2/noauth_client","modules/clean/cloud_docs/types","modules/clean/web_timing_logger","modules/clean/web_user_action_events","modules/clean/logging/hive/schemas/web-user-action","modules/clean/logging/telemetry","modules/constants/python","modules/clean/cloud_docs/constants","modules/core/browser","modules/clean/perf_tools/web_timing_utils","modules/core/exception","modules/clean/filepath/filepath"],(function(e,t,s,o,i,r,a,n,l,c,d,u,_,p,m,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.logLoggedOutUXSnackBarAction=t.logInterstitialLoginAction=t.logFileConvertPromptAction=t.logFileOpenPromptAction=t.getActionSourceFromNewFileMenuType=t.getActionSourceFromSourceArgs=t.getActionSourceFromSurface=t.checkAndLogNpu=t.logLoggedOutUserAction=t.logUserAction=t.logClientEvent=t.logViewEvent=t.getStartTime=void 0,a=s.__importStar(a),c=s.__importStar(c),_=s.__importStar(_);let h=void 0;t.getStartTime=()=>{try{h=h||_.performance().timing.fetchStart}catch(e){m.reportStack("Unable to get fetchStart from browser.",{severity:m.SEVERITY.NONCRITICAL}),h=a.start_time()}return h},t.logViewEvent=function(e,t,s){const i={file_views:[{file_info:{shared_link_details:{url:t}},platform_type:{".tag":s}}]};(new o.UserApiV2Client).ns("seen_state").rpc("log_file_view",i,{subjectUserId:e})},t.logClientEvent=function(e,s,o,n,l){const c=l||[];c.push({key:"time_on_page_with_redirect",value:a.time_since_start().toString()}),c.some(e=>"time_now"===e.key)||c.push({key:"time_now",value:Date.now().toString()}),(new i.NoAuthApiV2Client).ns("cloud_docs").rpc("log_client_event",{client:r.editorTypeToClient[s],doc_id:e,event_name:o,auth_token:n,time_on_page:p.WebTimingUtil.getNow()-t.getStartTime(),extras:c},{})},t.logUserAction=function(e){const t=(new o.UserApiV2Client).ns("cloud_docs");let s;e.hasOwnProperty("docPathOrId")&&e.docPathOrId&&(s={".tag":"path_or_id",path_or_id:e.docPathOrId});const i=e.data&&e.data.webOpenId,r=e.data&&e.data.origDest,a=e.data&&e.data.routingDest;t.rpc("log_user_action",{action:e.actionEvent,doc_id:s,source:e.actionSource,open_id:i,orig_dest:r,routing_dest:a,extra_info:e.extra},{subjectUserId:e.userId})},t.logLoggedOutUserAction=function(e){const t=(new i.NoAuthApiV2Client).ns("cloud_docs");let s;e.hasOwnProperty("docPathOrId")&&e.docPathOrId&&(s={".tag":"path_or_id",path_or_id:e.docPathOrId});const o=e.data&&e.data.webOpenId,r=e.data&&e.data.origDest,a=e.data&&e.data.routingDest;t.rpc("logged_out/log_user_action",{action:e.actionEvent,doc_id:s,source:e.actionSource,open_id:o,orig_dest:r,routing_dest:a,extra_info:e.extra},{})},t.checkAndLogNpu=function(e,t,s,i,r){(new o.UserApiV2Client).ns("cloud_docs").rpc("log_new_partner_users",{partner:t,cloud_doc_type:f.file_extension(s),cloud_editor:i,platform:r},{subjectUserId:e})},t.getActionSourceFromSurface=e=>"search"===e?r.UserActionSourceType.WEB_SEARCH:"previews"===e?r.UserActionSourceType.WEB_PREVIEW:"home_recent"===e||"home_starred"===e?r.UserActionSourceType.WEB_HOME:"browse"===e||"sidebar"===e?r.UserActionSourceType.WEB_BROWSE:r.UserActionSourceType.WEB,t.getActionSourceFromSourceArgs=e=>e.fileViewAction===d.FileViewActionType.SEARCH||e.fileViewOrigin===d.FileViewOriginType.SEARCH?r.UserActionSourceType.WEB_SEARCH:e.fileViewOrigin===d.FileViewOriginType.BROWSE?r.UserActionSourceType.WEB_BROWSE:e.fileViewOrigin===d.FileViewOriginType.HOME?r.UserActionSourceType.WEB_HOME:r.UserActionSourceType.WEB,t.getActionSourceFromNewFileMenuType=e=>{switch(e){case u.NewFileMenuFromType.BROWSE:return r.UserActionSourceType.WEB_BROWSE;case u.NewFileMenuFromType.HOME:return r.UserActionSourceType.WEB_HOME;default:return r.UserActionSourceType.WEB}},t.logFileOpenPromptAction=function(e,t,s,o,i){(new c.HiveLogger).log(new l.WebUserActionRow({user_id:e,event_name:n.WebUserActionLogEvent.FILE_OPEN_PROMPT_ACTION,extra:{file_type:t,integration_name:s,prompt_action:o,ask_again:i}}))},t.logFileConvertPromptAction=function(e,t,s,o){(new c.HiveLogger).log(new l.WebUserActionRow({user_id:e,event_name:n.WebUserActionLogEvent.FILE_CONVERT_PROMPT_ACTION,extra:{prompt_action:t,integration_name:s,file_extension:o}}))},t.logInterstitialLoginAction=function(e,t,s){(new c.HiveLogger).log(new l.WebUserActionRow({event_name:n.WebUserActionLogEvent.INTERSTITIAL_LOGIN_ACTION,extra:{prompt_action:e,logged_out_ux_google_variant:t,file_extension:s}}))},t.logLoggedOutUXSnackBarAction=function(e,t,s){(new c.HiveLogger).log(new l.WebUserActionRow({event_name:n.WebUserActionLogEvent.LOGGED_OUT_UX_SNACKBAR_ACTION,extra:{prompt_action:e,file_extension:t,logged_out_ux_google_variant:s||""}}))}})),define("modules/clean/cloud_docs/open_with_utils",["require","exports","tslib","apex-metrics/index","modules/core/browser","modules/clean/cloud_docs/constants","modules/clean/cloud_docs/event_logging","modules/clean/cloud_docs/types","modules/clean/referrer_cleansing_redirect","modules/clean/cloud_docs/constants","modules/core/uri","modules/clean/cloud_docs/utils","modules/clean/open_with","spectrum/util/uuid_generator","modules/core/browser_detection","modules/clean/cloud_docs/create_api","modules/clean/metrics/index"],(function(e,t,s,o,i,r,a,n,l,c,d,u,_,p,m,f,h){"use strict";let g;function S(e){if(void 0!==e&&void 0!==e.error&&void 0!==e.error[".tag"])return e.error[".tag"]}function E(e){switch(S(e)){case"invalid_file_id":case"permission_denied":case"other":default:return}}function T(e,t,s,o,r,l,c){const u=p.generateUUID("web_open_id"),_=d.URI.parse(e.cloud_editor_url).updateQuery({cloud_editor:r,web_open_id:u});l&&_.updateQuery({ignore_lock:"1"});const m=_.toString();m&&(void 0===c&&(c=n.UserActionSourceType.WEB),a.logUserAction({actionEvent:n.UserActionEventType.PRE_OPEN,userId:o,docPathOrId:s,actionSource:c,data:{webOpenId:u}}),null!=t?i.redirect(m,t):i.open_tab(m))}var b;function w(e){return[".gdoc",".gsheet",".gslides"].indexOf(u.getFileExt(e))>=0}function I(e){return".web"===u.getFileExt(e)}function v(e,t){const s=u.getFileExt(e);for(const e of Object.keys(c.DSS_TYPE_TO_SUPPORTED_EXTS)){const t=e;if(c.DSS_TYPE_TO_SUPPORTED_EXTS[t].indexOf(s)>=0)return t}switch(s){case".gdoc":return c.GoogleFileTypes.GOOGLE_DSS_DOC;case".gsheet":return c.GoogleFileTypes.GOOGLE_DSS_SHEET;case".gslides":return c.GoogleFileTypes.GOOGLE_DSS_SLIDES}return null}Object.defineProperty(t,"__esModule",{value:!0}),t.getGoogleEditorType=t.isCloudBasedDoc=t.isShortcut=t.isGoogleDoc=t.getOpenWithWopiEditorInfo=t.getOpenWithGoogleEditorInfo=t.getOpenWithCloudEditorInfo=t.OpenWithCloudDocProvider=t.openCloudDoc=t.openWithCloudEditor=t.fileToOpenWithParams=t.openCloudEditorUrl=t.isInEdgeIframe=t.handleError=t.decodeAPIError=t.getCloudEditorUrl=t.getCloudEditorUrlCached=void 0,l=s.__importStar(l),_=s.__importDefault(_),m=s.__importStar(m),t.getCloudEditorUrlCached=(e,o)=>s.__awaiter(void 0,void 0,void 0,(function*(){return g||(g=t.getCloudEditorUrl(e,o)),g})),t.getCloudEditorUrl=(t,o)=>s.__awaiter(void 0,void 0,void 0,(function*(){return(yield(function(){return s.__awaiter(this,void 0,void 0,(function*(){const{UserApiV2Client:t}=yield new Promise((t,s)=>{e(["api_v2/user_client"],t,s)}).then(s.__importStar);return(new t).ns("cloud_docs")}))})()).rpc("get_cloud_editor_url",{file_id:o},{subjectUserId:t})})),t.decodeAPIError=S,t.handleError=E,t.isInEdgeIframe=()=>{let e=!1;if(m.edge||m.msie||m.edgeChromium())try{e=window.self!==window.top}catch(t){e=!0}return e},t.openCloudEditorUrl=T,t.fileToOpenWithParams=e=>({fileId:e.file_id,openToUrl:e.open_to_url}),t.openWithCloudEditor=({fileId:e,openToUrl:i},a,n,l,c)=>s.__awaiter(void 0,void 0,void 0,(function*(){try{const s=performance.now(),d=h.getMetricsReporter(),u={};try{u.editor=n,c&&(u.source=c[".tag"]);const _=t.isInEdgeIframe();if(u.isInEdgeIframe=String(_),i&&i.startsWith("https://www.dropbox.com/scl/fi/")){u.usedOpenToURLFromFile="true",T({cloud_editor_url:i},null,e,a,n,l,c)}else{u.usedOpenToURLFromFile="false";const s=_?null:f.createPlaceholderTabForNewCloudDoc();T(_?yield t.getCloudEditorUrlCached(a,e):yield t.getCloudEditorUrl(a,e),s,e,a,n,l,c)}u.error="false"}catch(e){u.error="true",E(e)}finally{d.createStats({ns:r.CLOUD_DOCS_AMP_NAMESPACE,name:"web/openWithCloudEditor"},u).recordDuration(performance.now()-s,o.TimeUnit.MILLISECONDS)}}catch(e){E(e)}})),t.openCloudDoc=(t,o,c)=>{if(c||(c=n.UserActionSourceType.WEB),t.href)if(r.isPointerByExtension(t.ns_path))l.safe_open_tab_and_redirect(t.href),a.logUserAction({actionEvent:n.UserActionEventType.PRE_OPEN,userId:o.id,docPathOrId:t.file_id,actionSource:c});else{const e=p.generateUUID("web_open_id"),s=d.URI.parse(t.href).updateQuery("web_open_id",e).toString();i.open_tab(s),a.logUserAction({actionEvent:n.UserActionEventType.PRE_OPEN,userId:o.id,docPathOrId:t.file_id,actionSource:c,data:{webOpenId:e}})}else{const i=f.createPlaceholderTabForNewCloudDoc();new Promise((t,s)=>{e(["modules/clean/previews/data/actions"],t,s)}).then(s.__importStar).then(e=>e.fetchPreviewUrl(t,o)).then(e=>{e&&null!==i&&l.redirect(e,i,!0)})}},(function(e){e.OfficeOnline="OfficeOnline",e.GoogleDSS="GoogleDSS"})(b=t.OpenWithCloudDocProvider||(t.OpenWithCloudDocProvider={})),t.getOpenWithCloudEditorInfo=(e,s,o,i)=>{const r=[],a=t.getOpenWithWopiEditorInfo(e,s,i);a&&o.wopi&&r.push(a);const n=t.getOpenWithGoogleEditorInfo(e,s,i);return n&&o.gdd&&r.push(n),r},t.getOpenWithGoogleEditorInfo=(e,s,o)=>{const i=v(e,s);return i?{text:c.DSS_TYPE_TO_TEXT[i],iconUrl:c.DSS_TYPE_TO_OPEN_WITH_ICONS[i],handler:()=>t.openWithCloudEditor(t.fileToOpenWithParams(e),s.id,i,!1,o),provider:b.GoogleDSS}:null},t.getOpenWithWopiEditorInfo=(e,s,o)=>{const i=_.default.getWopiOpenWithButtonInfo(e);return i?{text:i.name,spriteName:i.icon,handler:()=>t.openWithCloudEditor(t.fileToOpenWithParams(e),s.id,i.editor,!1,o),provider:b.OfficeOnline}:null},t.isGoogleDoc=w,t.isShortcut=I,t.isCloudBasedDoc=function(e){return!!w(e)||!!I(e)},t.getGoogleEditorType=v})),define("modules/clean/cloud_docs/pointers_common",["require","exports","tslib","ts-key-enum","react","spectrum/input/index"],(function(e,t,s,o,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CreatePointerFields=void 0,i=s.__importStar(i);class a extends i.Component{constructor(){super(...arguments),this.handleKeyPress=e=>{e.key===o.Key.Enter&&a.canSubmit({name:this.props.name,url:this.props.url})&&this.props.onSubmit()},this.handleNameChange=e=>{const t=e.target.value;this.props.onChange({name:t,url:this.props.url})},this.handleUrlChange=e=>{const t=e.target.value;this.props.onChange({name:this.props.name,url:t})},this.setNameFieldRef=e=>{this.nameRef=e}}render(){const e=""===this.props.url||a.isUrlValid(this.props.url),t=e?"default":"invalid";let s="";return e||(s=this.props.urlValidationMessage),i.createElement("div",{className:"create-pointer--fields"},i.createElement("div",{className:"create-pointer--fieldset"},i.createElement("label",{htmlFor:"create-pointer--link_input"},this.props.urlLabel),i.createElement("div",{className:"create-pointer--fieldset-with-icon"},this.props.urlIcon,i.createElement(r.Input,{id:"create-pointer--link_input",className:"create-pointer--link_input",variant:t,onChange:this.handleUrlChange,onKeyPress:this.handleKeyPress,value:this.props.url,autoFocus:!0}))),i.createElement("div",{className:"create-pointer--url-validation-warning"},s),i.createElement("div",{className:"create-pointer--fieldset"},i.createElement("label",{htmlFor:"create-pointer--name_input"},this.props.nameLabel),i.createElement(r.Input,{id:"create-pointer--name_input",className:"create-pointer--name_input",onChange:this.handleNameChange,onKeyPress:this.handleKeyPress,forwardedRef:this.setNameFieldRef})))}componentDidMount(){return s.__awaiter(this,void 0,void 0,(function*(){if(this.props.urlPrepopulateFunction){const e=yield this.props.urlPrepopulateFunction();e&&(this.props.onChange({name:this.props.name,url:e}),this.nameRef.focus())}}))}}t.CreatePointerFields=a,a.isUrlValid=e=>/^((http|https):\/\/)?([^.:/\\?#@!]+?\.)+[^.:/\\?#@!]+/i.test(e.trim()),a.canSubmit=e=>""!==e.name&&""!==e.url&&a.isUrlValid(e.url),a.displayName="CreatePointerFields"})),define("modules/clean/cloud_docs/preferred_editor_utils",["require","exports","tslib","modules/core/i18n","modules/core/browser","modules/core/exception","modules/clean/cloud_docs/event_logging","modules/clean/cloud_docs/utils","modules/clean/cloud_docs/types","react","modules/clean/filepath/filepath","modules/clean/cloud_docs/open_with_utils","modules/core/uri","modules/clean/cloud_docs/cloud_doc_api_client","spectrum/util/uuid_generator","modules/clean/cloud_docs/preferred_editor_constants","modules/clean/cloud_docs/create_api"],(function(e,t,s,o,i,r,a,n,l,c,d,u,_,p,m,f,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPreferredEditorPrompt=t.openInPreferredEditor=t.hasPreferredEditorSupport=void 0,c=s.__importDefault(c),t.hasPreferredEditorSupport=function(e){const t=n.getFileExt(e);return f.PREFERRED_EDITOR_SUPPORTED_EXTS.indexOf(t)>=0},t.openInPreferredEditor=function(e,t,s,o,c){const d=n.getFileExt(t),g=s[e.id];let S="";if(g)try{const s=g[f.EXTENSION_TO_DOC_TYPE[d]],n=s===f.PreferredEditorTypes.GoogleDSS||s===f.PreferredEditorTypes.OfficeOnline,E=m.generateUUID("web_open_id");if(t.is_in_vault_folder)return n&&a.logUserAction({actionEvent:l.UserActionEventType.PRE_OPEN,userId:e.id,docPathOrId:t.file_id,actionSource:a.getActionSourceFromSourceArgs(c),data:{webOpenId:E},extra:{block_vault_content:"true"}}),void o();if(n){const s=h.createPlaceholderTabForNewCloudDoc();u.getCloudEditorUrl(e.id,t.file_id).then(i=>{S=_.URI.parse(i.cloud_editor_url).updateQuery("web_open_id",E).toString(),s?s.location.replace(S):o(),a.logUserAction({actionEvent:l.UserActionEventType.PRE_OPEN,userId:e.id,docPathOrId:t.file_id,actionSource:a.getActionSourceFromSourceArgs(c),data:{webOpenId:E}})}).catch(e=>{r.reportStack("Error getting cloud editor url from preferred editor open.",{severity:r.SEVERITY.CRITICAL,exc_extra:{preferred_editor_url:S,file_ext:d,preferred_editor_configs:g,error:e.message}}),s&&s.close(),o()})}else p.getPreferredUrl(e.id,t.file_id,d).then(s=>{s.preferred_editor_url&&(S=_.URI.parse(s.preferred_editor_url).updateQuery("web_open_id",E).toString(),a.logUserAction({actionEvent:l.UserActionEventType.PRE_OPEN,userId:e.id,docPathOrId:t.file_id,actionSource:a.getActionSourceFromSourceArgs(c),data:{webOpenId:E}}),i.redirect(S))}).catch(e=>{r.reportStack("Error getting preferred editor url from preferred editor open.",{severity:r.SEVERITY.CRITICAL,exc_extra:{preferred_editor_url:S,file_ext:d,preferred_editor_configs:g,error:e.message}})}),o()}catch(e){r.reportStack("Error opening docs in preferred editor.",{severity:r.SEVERITY.CRITICAL,exc_extra:{preferred_editor_url:S,file_ext:d,preferred_editor_configs:g,error:e.message}}),o()}else o()},t.getPreferredEditorPrompt=function(e,t){const s="."+d.file_extension(e),i=f.EXTENSION_TO_DOC_TYPE[s],r=f.INTEGRATION_NAME_TO_PROMPT[t][i];return r?{title:o.intl.formatMessage({id:"jXF9I9",defaultMessage:"Would you like to open <b>{file_extension}</b> files with {web_editor_name} by default?"},{file_extension:s,web_editor_name:r,b:e=>c.default.createElement("b",null,e)}),body:o.intl.formatMessage({id:"f37GH8",defaultMessage:"{web_editor_name} will automatically be used to open your <b>{file_extension}</b> files in Dropbox. You can always update this later in your Dropbox settings."},{file_extension:s,web_editor_name:r,b:e=>c.default.createElement("b",null,e)})}:null}})),define("modules/clean/cloud_docs/preferred_editor_constants",["require","exports","modules/core/i18n","modules/clean/cloud_docs/types"],(function(e,t,s,o){"use strict";var i,r;Object.defineProperty(t,"__esModule",{value:!0}),t.IntegrationNameToPreferredEditorEnums=t.INTEGRATION_NAME_TO_PROMPT=t.PREFERRED_EDITOR_SUPPORTED_EXTS=t.EXTENSION_TO_DOC_TYPE=t.PreferredEditorOptionsMap=t.PreferredEditorDocTypes=t.PreferredEditorTypes=void 0,(function(e){e[e.Unknown=0]="Unknown",e[e.FileViewer=1]="FileViewer",e[e.OfficeOnline=2]="OfficeOnline",e[e.GoogleDSS=3]="GoogleDSS"})(i=t.PreferredEditorTypes||(t.PreferredEditorTypes={})),(function(e){e.WORD="ms_word",e.EXCEL="ms_excel",e.POWERPOINT="ms_powerpoint"})(r=t.PreferredEditorDocTypes||(t.PreferredEditorDocTypes={})),t.PreferredEditorOptionsMap={[r.WORD]:{1:s.intl.formatMessage({id:"5+Wabe",defaultMessage:"View in dropbox.com"}),2:s.intl.formatMessage({id:"Y9FcUQ",defaultMessage:"Word for the web"}),3:s.intl.formatMessage({id:"+HsOFj",defaultMessage:"Google Docs"})},[r.EXCEL]:{1:s.intl.formatMessage({id:"5+Wabe",defaultMessage:"View in dropbox.com"}),2:s.intl.formatMessage({id:"o3mRdr",defaultMessage:"Excel for the web"}),3:s.intl.formatMessage({id:"cpuRML",defaultMessage:"Google Sheets"})},[r.POWERPOINT]:{1:s.intl.formatMessage({id:"5+Wabe",defaultMessage:"View in dropbox.com"}),2:s.intl.formatMessage({id:"RTj2SO",defaultMessage:"PowerPoint for the web"}),3:s.intl.formatMessage({id:"PcJCVL",defaultMessage:"Google Slides"})}},t.EXTENSION_TO_DOC_TYPE={".docx":r.WORD,".doc":r.WORD,".xlsx":r.EXCEL,".xls":r.EXCEL,".pptx":r.POWERPOINT,".ppt":r.POWERPOINT},t.PREFERRED_EDITOR_SUPPORTED_EXTS=Object.keys(t.EXTENSION_TO_DOC_TYPE),t.INTEGRATION_NAME_TO_PROMPT={[o.IntegrationName.GOOGLE_DSS]:{[r.WORD]:s.intl.formatMessage({id:"+HsOFj",defaultMessage:"Google Docs"}),[r.EXCEL]:s.intl.formatMessage({id:"cpuRML",defaultMessage:"Google Sheets"}),[r.POWERPOINT]:s.intl.formatMessage({id:"PcJCVL",defaultMessage:"Google Slides"})},[o.IntegrationName.OFFICE_ONLINE]:{[r.WORD]:s.intl.formatMessage({id:"Y9FcUQ",defaultMessage:"Word for the web"}),[r.EXCEL]:s.intl.formatMessage({id:"o3mRdr",defaultMessage:"Excel for the web"}),[r.POWERPOINT]:s.intl.formatMessage({id:"RTj2SO",defaultMessage:"PowerPoint for the web"})},[o.IntegrationName.PAPER_INTEGRATION]:{}},t.IntegrationNameToPreferredEditorEnums={[o.IntegrationName.GOOGLE_DSS]:i.GoogleDSS,[o.IntegrationName.OFFICE_ONLINE]:i.OfficeOnline,[o.IntegrationName.PAPER_INTEGRATION]:i.Unknown}})),define("modules/clean/cloud_docs/utils",["require","exports","modules/clean/filepath/filepath","spectrum-sharing/utils/sharing_constants","modules/clean/cloud_docs/types"],(function(e,t,s,o,i){"use strict";function r(e){return e.replace(/[/?<>:*\\]/g,"_")}Object.defineProperty(t,"__esModule",{value:!0}),t.replaceInvalidURLFilenameChars=t.replaceInvalidFilenameChars=t.integrationNameToShareActionOrigin=t.getFileExt=void 0,t.getFileExt=function(e){let t="";return e.hasOwnProperty("ext")?t=e.ext:e.hasOwnProperty("filename")?(t=s.file_extension(e.filename),t&&(t="."+t)):(t=s.file_extension(e),t&&(t="."+t)),t},t.integrationNameToShareActionOrigin=function(e){switch(e){case i.IntegrationName.GOOGLE_DSS:return o.SHARE_ACTION_ORIGIN_TYPE.GOOGLE_DSS;case i.IntegrationName.PAPER_INTEGRATION:return o.SHARE_ACTION_ORIGIN_TYPE.PAPER_INTEGRATION;case i.IntegrationName.OFFICE_ONLINE:return o.SHARE_ACTION_ORIGIN_TYPE.OFFICE_INTEGRATION;default:throw"No mapping for integration to share action origin: "+e}},t.replaceInvalidFilenameChars=r,t.replaceInvalidURLFilenameChars=function(e){return r(e).replace(/\ /g,"-")}})),define("modules/clean/file_actions/create-folder",["require","exports","tslib","modules/clean/file_actions/metrics","modules/clean/file_actions/strings","modules/clean/metrics/index","modules/clean/react/async_file_modal_controller","modules/clean/react/browse/action_logger","modules/clean/react/files_view/file_actions/api_v2","modules/clean/react/snackbar","modules/clean/web_user_action_events","modules/core/i18n","modules/clean/user_survey/user_survey","modules/clean/react/growth/rich_snackbar_actions/create_folder_actions","modules/clean/react/browse/data/store","modules/clean/react/browse/data/selectors"],(function(e,t,s,o,i,r,a,n,l,c,d,u,_,p,m,f){"use strict";function h(e,t,s){n.logWebUserAction({event_name:d.WebUserActionLogEvent.CREATE_FOLDER_ERROR,extra:{error_summary:e||null,error:t||null,origin:s||null}})}function g(e){n.logWebUserAction({event_name:d.WebUserActionLogEvent.CREATE_FOLDER_CANCEL,extra:{origin:e||null}})}function S(e){n.logWebUserAction({event_name:d.WebUserActionLogEvent.CREATE_FOLDER_PENDING,extra:{origin:e||null}})}function E(e){n.logWebUserAction({event_name:d.WebUserActionLogEvent.CREATE_FOLDER_SUCCESS,extra:{origin:e||null}}),_.UserSurvey.trackEvent("create_item","browse")}Object.defineProperty(t,"__esModule",{value:!0}),t.logCreateFolderSuccess=t.logCreateFolderPending=t.logCreateFolderCancel=t.logCreateFolderError=t.logCreateFolder=t.createFolder=void 0,a=s.__importStar(a),l=s.__importStar(l),f=s.__importStar(f),t.createFolder=({user:e,name:n,destination:d,checkFsw:_,origin:T,surface:b})=>s.__awaiter(void 0,void 0,void 0,(function*(){const w=r.getMetricsReporter(),I={surface:b},v={latency:w.createTimer({ns:o.FILE_ACTIONS_AMP_NAMESPACE,name:"create-folder/latency_ms"},I),completed:w.createStats({ns:o.FILE_ACTIONS_AMP_NAMESPACE,name:"create-folder/completed"},I)};S(T),c.Snackbar.sync(u.intl.formatMessage(i.createFolderSnackbarProgress),!1,"browse-action");const O=yield l.createFolder(d,n,e,_);if(O.isError&&"path"===O.error[".tag"]&&"file_system_warnings"===O.error.path[".tag"]){return c.Snackbar.close("browse-action"),(yield(function(e){return s.__awaiter(this,void 0,void 0,(function*(){return new Promise(t=>{a.showFileSystemWarningsModal({fsws:e,onFinalAccept:()=>{t(!0)},onAbortAction:()=>{t(!1)},confirmText:u.intl.formatMessage(i.createFolderFswConfirmText)})})}))})(O.error.path.details))?yield t.createFolder({user:e,name:n,destination:d,checkFsw:!1,origin:T,surface:b}):(g(T),{type:"cancel"})}if(v.latency.record(),O.isError)return"path"===O.error[".tag"]&&"malformed_path"===O.error.path[".tag"]?(c.Snackbar.fail(u.intl.formatMessage(i.createFolderErrorMalformedPath),"browse-action"),v.completed.record(1)):(c.Snackbar.fail(u.intl.formatMessage(i.createFolderErrorGeneric),"browse-action"),v.completed.record(0)),h(O.error_summary,O.error[".tag"],T),{type:"error",summary:O.error_summary,error:O.error[".tag"]};const C=m.getStoreForBrowse().getState(),F=f.getUsersJtbdInterestInfo(C),R=void 0!==O.result.metadata.path_lower?O.result.metadata.path_lower:"",A={richSnackbarProps:p.getRichSnackbarPropsForCreateFolder(e.home_ns_id,R,{expFullFunnelVideoSnackbar:F})},y=void 0!==A.richSnackbarProps;return c.Snackbar.complete(u.intl.formatMessage(i.createFolderSnackbarSuccess),"browse-action",void 0,A,y),E(T),v.completed.record(1),{type:"success",folder:O.result.metadata}})),t.logCreateFolder=function({uid:e,view_type:t,origin:s,source:o}){n.logWebUserAction({user_id:e,event_name:d.WebUserActionLogEvent.CREATE_FOLDER,view_type:t||null,extra:Object.assign({origin:s},o&&{source:o})})},t.logCreateFolderError=h,t.logCreateFolderCancel=g,t.logCreateFolderPending=S,t.logCreateFolderSuccess=E})),define("modules/clean/file_actions/metrics",["require","exports","modules/clean/metrics/index"],(function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.recordPathLookupErrors=t.batchContentType=t.bucketForBatchSize=t.FILE_ACTIONS_AMP_NAMESPACE=void 0,t.FILE_ACTIONS_AMP_NAMESPACE="web_file_actions",t.bucketForBatchSize=function(e){return 1===e?"single":e<=10?"small":e<=100?"medium":e<=1e3?"large":"massive"},t.batchContentType=function(e){return e.every(e=>e.is_dir)?"folders":e.every(e=>!e.is_dir)?"files":"mixed"};t.recordPathLookupErrors=function(e,o,i){const r={};e.forEach(e=>{if("path_lookup"===e.failure[".tag"]){const t=e.failure.path_lookup[".tag"];r[t]=(r[t]||0)+1}});for(const e in r)r.hasOwnProperty(e)&&s.getMetricsReporter().createStats({ns:t.FILE_ACTIONS_AMP_NAMESPACE,name:"common/failure/path_lookup"},Object.assign(Object.assign({},i),{lookupFailureType:e,operation:o})).record(r[e])}})),define("modules/clean/file_actions/strings",["require","exports","react-intl"],(function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.unstarSnackbarError=t.starSnackbarError=t.unstarSnackbarSuccess=t.starSnackbarSuccess=t.createFolderSnackbarSuccess=t.createFolderFswConfirmText=t.createFolderErrorGeneric=t.createFolderErrorMalformedPath=t.createFolderSnackbarProgress=t.renameSnackbarSuccessMessage=t.renameUndoSnackbarSuccessMessage=t.renameUndoSnackbarErrorMessage=t.renameUndoSnackbarProgressMessage=t.renameFswConfirmText=t.renameSnackbarProgressMessage=t.renameErrorInvalidName=t.deleteUndoSnackbarMessage=t.deleteFswConfirmText=t.deleteSnackbarProgressMessage=void 0,t.deleteSnackbarProgressMessage=s.defineMessage({id:"z7/sbf",defaultMessage:"{count, plural, one{Deleting {count} item...} other{Deleting {count} items...}}"}),t.deleteFswConfirmText=s.defineMessage({id:"da2lvf",defaultMessage:"Delete"}),t.deleteUndoSnackbarMessage=s.defineMessage({id:"hCpZct",defaultMessage:"Delete undone."}),t.renameErrorInvalidName=s.defineMessage({id:"KYHY0Z",defaultMessage:"Name was invalid."}),t.renameSnackbarProgressMessage=s.defineMessage({id:"8j6sBp",defaultMessage:"Renaming"}),t.renameFswConfirmText=s.defineMessage({id:"NYv8Vp",defaultMessage:"Rename"}),t.renameUndoSnackbarProgressMessage=s.defineMessage({id:"deJ8cD",defaultMessage:"Undoing rename..."}),t.renameUndoSnackbarErrorMessage=s.defineMessage({id:"n4o67d",defaultMessage:"Undo failed."}),t.renameUndoSnackbarSuccessMessage=s.defineMessage({id:"6RXx/7",defaultMessage:"Rename undone."}),t.renameSnackbarSuccessMessage=s.defineMessage({id:"NqCfwG",defaultMessage:"Renamed 1 item."}),t.createFolderSnackbarProgress=s.defineMessage({id:"U3y3i9",defaultMessage:"Creating folder..."}),t.createFolderErrorMalformedPath=s.defineMessage({id:"HOb8Zp",defaultMessage:'The following characters are not allowed: angle brackets \\ / : ? * " |'}),t.createFolderErrorGeneric=s.defineMessage({id:"qZTFM0",defaultMessage:"Can’t create folder."}),t.createFolderFswConfirmText=s.defineMessage({id:"VDjS9+",defaultMessage:"Create folder"}),t.createFolderSnackbarSuccess=s.defineMessage({id:"1zC4ih",defaultMessage:"Folder created."}),t.starSnackbarSuccess=s.defineMessage({id:"m96IvY",defaultMessage:"Starred {itemName}."}),t.unstarSnackbarSuccess=s.defineMessage({id:"Yn2gx1",defaultMessage:"Unstarred {itemName}."}),t.starSnackbarError=s.defineMessage({id:"LdcLnn",defaultMessage:"There was a problem starring {itemName}"}),t.unstarSnackbarError=s.defineMessage({id:"t8Eqso",defaultMessage:"There was a problem unstarring {itemName}"})})),define("modules/clean/file_operations/notifications",["require","exports","tslib","lodash","modules/clean/browse_interface","modules/clean/em_string","modules/clean/filepath/filepath","modules/clean/react/browse/api","modules/clean/undo","modules/core/html","modules/core/i18n","modules/core/notify"],(function(e,t,s,o,i,r,a,n,l,c,d,u){"use strict";function _(e,t,s,o){l.notifyWithUndo(e,s,()=>n.rollbackChangeSets({changesets:s,userId:t.id,progressText:d.intl.formatMessage({id:"wKzr7W",defaultMessage:"Undoing…"}),onSuccess:()=>{u.Notify.success(d.intl.formatMessage({id:"t6mPeQ",defaultMessage:"Undo complete."})),o&&o()}}))}function p(e,t){const s=i.browse_uri_for_fq_path(t,e),n=r.Emstring.em_snippet(a.filename(e),40);return{href:s,text:o.escape(n)}}Object.defineProperty(t,"__esModule",{value:!0}),t.notifyRestoreSuccess=t.notifyPurgeSuccess=t.notifyFolderCreationSuccess=t.notifyRenameSuccess=t.notifyDeleteSuccess=t.notifyMoveSuccess=t.notifyCopySuccess=void 0,o=s.__importStar(o),i=s.__importStar(i),a=s.__importStar(a),n=s.__importStar(n),l=s.__importStar(l),t.notifyCopySuccess=function(e,t,s,o,i){let r;if(o){const s=p(o,t);r=d.intl.formatMessage({id:"UZ+XVI",defaultMessage:"{count, plural, one{Copied {count} item to {dest}.} other{Copied {count} items to {dest}.}}"},{count:e,dest:`<a href="${s.href.toString()}">${s.text}</a>`}),r=new c.HTML(r)}else r=d.intl.formatMessage({id:"BDtFp+",defaultMessage:"{count, plural, one{Copied {count} item.} other{Copied {count} items.}}"},{count:e});_(r,t,s,i)},t.notifyMoveSuccess=function(e,t,s,o,i){let r;if(o){const s=p(o,t);r=d.intl.formatMessage({id:"GBu2Ic",defaultMessage:"{count, plural, one{Moved {count} item to {dest}.} other{Moved {count} items to {dest}.}}"},{count:e,dest:`<a href="${s.href.toString()}">${s.text}</a>`}),r=new c.HTML(r)}else r=d.intl.formatMessage({id:"tFGyx0",defaultMessage:"{count, plural, one{Moved {count} item.} other{Moved {count} items.}}"},{count:e});_(r,t,s,i)},t.notifyDeleteSuccess=function(e,t,s,o){_(d.intl.formatMessage({id:"THAbub",defaultMessage:"{count, plural, one{Deleted {count} item.} other{Deleted {count} items.}}"},{count:e}),t,s,o)},t.notifyRenameSuccess=function(e,t,s){_(d.intl.formatMessage({id:"sAZa2U",defaultMessage:"Rename complete."}),e,t,s)},t.notifyFolderCreationSuccess=function(e,t,s){_(d.intl.formatMessage({id:"ndMNx/",defaultMessage:"Created folder {folder_name}."},{folder_name:e}),t,s)},t.notifyPurgeSuccess=function(e){const t=d.intl.formatMessage({id:"jh+GyF",defaultMessage:"{count, plural, one{Permanently deleted {count} item.} other{Permanently deleted {count} items.}}"},{count:e});u.Notify.success(t)},t.notifyRestoreSuccess=function(e){let t;const s=e.length;if(1===s){const s=o.escape(a.filename(e[0].fq_path));t=d.intl.formatMessage({id:"TAukDw",defaultMessage:"Restored <strong>{filename}</strong>."},{strong:e=>`<strong>${e}</strong>`,filename:s}),t=new c.HTML(t)}else t=d.intl.formatMessage({id:"8N7KT8",defaultMessage:"{count, plural, one{Restored {count} file.} other{Restored {count} files.}}"},{count:s});u.Notify.success(t,30)}})),define("modules/clean/growth/smb_funnel/smb_funnel_logger",["require","exports","modules/clean/metrics/index","modules/core/exception","apex-metrics/index"],(function(e,t,s,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SMBFunnelLogger=t.SMBFunnelLoggerSingleton=t.Platform=void 0,(function(e){e.WEB="web",e.DESKTOP_SSCV="desktop_sscv",e.MOBILE_WEB="mobile_web"})(t.Platform||(t.Platform={}));const r=["platform","variant"],a=e=>{const t={};return Object.keys(e).forEach(s=>{r.indexOf(s)>=0&&(t[s]=e[s])}),t};class n{constructor(e={}){this.setCommonTags=e=>{const t=a(e);Object.keys(t).forEach(t=>{this.commonTags[t]&&this.commonTags[t]!==e[t]&&o.reportStack(`Attempting to change ${t} after it was already set`,{severity:o.SEVERITY.NONCRITICAL,tags:["onboarding-activation-multiplayer","smb-funnel"]})}),this.commonTags=t},this.log=(e,t={})=>{const s=Object.assign(Object.assign({},this.commonTags),t),o=this.metricsReporter.createCounter({ns:"smb_funnel",name:e},s);o.increment(),o.record()},this.logDuration=(e,t,s={})=>{const o=Object.assign(Object.assign({},this.commonTags),s);this.metricsReporter.createStats({ns:"smb_funnel",name:e},o).recordDuration(t,i.TimeUnit.MILLISECONDS)},this.commonTags=a(e),this.metricsReporter=s.getMetricsReporter()}}t.SMBFunnelLoggerSingleton=n,t.SMBFunnelLogger=new n})),define("modules/clean/react/admin/teams/onboarding/web/constants",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ContUrl=t.FlowId=t.AMPMetrics=t.Platform=t.BackgroundColors=t.StepStatus=t.Steps=t.MODULE_NAME=t.FRAMEWORK=void 0,t.FRAMEWORK="team_setup_essential",t.MODULE_NAME="smooth_transitions",(function(e){e.VERIFICATION="verification",e.RIGHTSIZING="rightsizing",e.TEAM_INFO="team_info",e.MOVE_FOLDERS="move_folders",e.CONFIRM_FOLDERS="confirm_folders",e.RESULTS_FOLDERS="results_folders",e.INVITE_MEMBERS="invite_members",e.SUGGESTED_INVITE_MEMBERS="suggested_invite_members",e.INVITE_MOBILE="invite_mobile",e.INSTALL="install",e.INSTALL_MOBILE="install_mobile",e.ROLE="role",e.COLLABORATION="collaboration",e.LOADING_SCREEN="loading_screen",e.PAIR="team_install_page_pair",e.OPEN="team_install_page_open",e.DOWNLOAD="team_install_page_download",e.DOWNLOAD_COMPLETE="download_complete",e.MOBILE_INSTALL="mobile_install",e.DOCSEND_ONBOARD="docsend_onboard",e.JOIN_ACCEPT="join_accept",e.JOIN_LOGIN="join_login",e.JOIN_MOVE_FILES="join_move_files",e.JOIN_PRIVACY_QUESTION="privacy_question",e.JOIN_TWO_ACCOUNT_SUGGESTION="two_account_suggestion",e.JOIN_ONE_ACCOUNT_SUGGESTION="one_account_suggestion",e.JOIN_CREATE_NEW_PERSONAL="create_new_personal",e.JOIN_PERSONAL_VERIFICATION="personal_verification",e.HELP_US_HELP_YOU="help_us_help_you"})(t.Steps||(t.Steps={})),(function(e){e.Inactive="inactive",e.Active="active",e.Completed="completed"})(t.StepStatus||(t.StepStatus={})),(function(e){e.CELADON="celadon",e.CLOUD="cloud",e.NAVY="navy",e.ORCHID="orchid",e.SAPPHIRE="sapphire",e.SAND="sand",e.VANILLA="vanilla",e.WHITE="white"})(t.BackgroundColors||(t.BackgroundColors={})),(function(e){e.DESKTOP_WEB="desktop_web",e.DESKTOP_SSCV="desktop_sscv",e.MOBILE_WEB="mobile_web"})(t.Platform||(t.Platform={})),(function(e){e.SETUP_START="setup/start",e.SETUP_FINISH="setup/finish",e.SETUP_STEP_START="setup/step/start",e.SETUP_STEP_FINISH="setup/step/finish",e.SETUP_STEP_ERROR="setup/step/error",e.SETUP_STEP_INTERRUPT="setup/step/interrupt",e.SETUP_STEP_CTA="setup/step/cta",e.SETUP_STEP_FETCH="setup/step/fetch",e.ACTIVATION_IMM_VIEW="activation/imm/view",e.ACTIVATION_IMM_ADD_MEMBERS="activation/imm/add_members",e.ACTIVATION_DESKTOP_ICON_OPEN="activation/desktop_icon/open",e.ACTIVATION_EMPTY_STATE_VIEW="activation/empty_state/view",e.ACTIVATION_SUGGESTED_FOLDER_CREATE="activation/suggested_folder/create",e.ACTIVATION_SUGGESTED_FOLDER_DISMISS="activation/suggested_folder/dismiss",e.ACTIVATION_SUGGESTED_FOLDER_TOGGLE="activation/suggested_folder/toggle",e.ACTIVATION_QUICK_ACTIONS_PANEL_VIEW="activation/quick_actions_panel/view",e.ACTIVATION_QUICK_ACTION_CREATE_CF="activation/quick_action/create_cf",e.ACTIVATION_QUICK_ACTION_REDIRECT="activation/quick_action/redirect",e.ACTIVATION_QUICK_ACTION_SEE_SF="activation/quick_action/see_sf",e.ACTIVATION_QUICK_ACTION_DISMISS="activation/quick_action/dismiss",e.ACTIVATION_COLLECTION_FOLDER_VIEW="activation/collection_folder/view",e.ACTIVATION_COLLECTIONS_ACTION_REDIRECT="activation/collections_action/redirect",e.ACTIVATION_COLLECTIONS_ACTION_UPLOAD="activation/collections_action/upload",e.ACTIVATION_COLLECTIONS_ACTION_CREATE="activation/collections_action/create",e.ACTIVATION_COLLECTIONS_ACTION_PAPER="activation/collections_action/paper",e.ACTIVATION_COLLECTIONS_ACTION_OPEN_DESKTOP="activation/collections_action/open_desktop",e.ACTIVATION_COLLECTIONS_ACTION_OPEN_SETTINGS="activation/collections_action/open_settings",e.ACTIVATION_INVITE_LINK_CREATE="activation/invite_link/create",e.ACTIVATION_MOBILE_LINK_SEND="activation/mobile_link/send",e.ACTIVATION_DESKTOP_LINK_DISMISS="activation/desktop_link/dismiss",e.ACTIVATION_DESKTOP_LINK_INIT="activation/desktop_link/init",e.ACTIVATION_DESKTOP_LINK_SEND="activation/desktop_link/send"})(t.AMPMetrics||(t.AMPMetrics={})),(function(e){e[e.ESSENTIAL_SETUP=1]="ESSENTIAL_SETUP",e[e.PERSONALIZATION=2]="PERSONALIZATION",e[e.MOBILE_APP_LINKS=5]="MOBILE_APP_LINKS",e[e.PISCES_BIZ_BASIC=7]="PISCES_BIZ_BASIC",e[e.TEAM_JOINER_FLOW=9]="TEAM_JOINER_FLOW",e[e.HELP_US_HELP_YOU=11]="HELP_US_HELP_YOU"})(t.FlowId||(t.FlowId={})),(function(e){e.DEFAULT="",e.WORK="/work",e.ESSENTIAL_SETUP="/team/setup/essential",e.ESSENTIAL_JOIN="/team/join/essential"})(t.ContUrl||(t.ContUrl={}))})),define("modules/clean/react/growth/rich_snackbar_actions/create_folder_actions",["require","exports","dig-components/icons/src","modules/core/i18n","modules/core/browser","modules/clean/react/onboarding/logging/logging","modules/clean/react/onboarding/logging/events","modules/clean/react/growth/personalization/util"],(function(e,t,s,o,i,r,a,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getRichSnackbarPropsForCreateFolder=void 0;const l={REQUEST_FILES:{name:"request_files",icon:s.FileRequestLine,onClick:e=>{const{ns_id:t,ns_path:s}=e;r.OALogger.logToTeamsWeb(a.FullFunnelOptimizationForVideoEvents.CLICK_REQUEST_FILES),i.redirect(`/requests?ns_id=${t}&path=${s}`)},text:o.intl.formatMessage({id:"JsXSfu",defaultMessage:"Request files"})}};t.getRichSnackbarPropsForCreateFolder=function(e,t,s){var i;let c;const d={userId:0,filePath:"",ns_id:e,ns_path:t};return n.shouldEnableFullFunnelVideoSnackbar(null==s?void 0:s.expFullFunnelVideoSnackbar)&&(c={actions:[l.REQUEST_FILES],helperText:o.intl.formatMessage({id:"EU51uM",defaultMessage:"Share and send a request for video or other files."}),clickHandlerArgs:d,onCloseClick:()=>{r.OALogger.logToTeamsWeb(a.FullFunnelOptimizationForVideoEvents.DISMISS_SNACKBAR,{action:"request_files"})}}),n.shouldLogFullFunnelVideoSnackbarExposure(null==s?void 0:s.expFullFunnelVideoSnackbar)&&r.OALogger.logToTeamsWeb(a.FullFunnelOptimizationForVideoEvents.EXPOSURE,{variant:null===(i=null==s?void 0:s.expFullFunnelVideoSnackbar)||void 0===i?void 0:i.variant,exposure:"new_folder"}),c}})),define("modules/clean/react/folder_overview/api",["require","exports","api_v2/types","api_v2/user_client"],(function(e,t,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getUserAccount=t.isFormatVersionError=t.isConflictError=t.getLoggingFileId=t.getSharedFolderPath=t.getFolderAccess=t.addContentReferencesToPath=t.addContentReferences=t.removeContentReferences=t.getContentReferences=t.setDescription=t.getDescription=void 0;const i=new o.UserApiV2Client;class r extends o.UserApiV2Client{constructor(e,t){super(t),this.user=e}_headers(e){return this.user.is_cdm_member&&this.user.is_team_admin&&this.user.team_member_id?Object.assign({[s.ApiV2HeaderNames.DropboxApiSelectAdmin]:this.user.team_member_id},super._headers(e)):super._headers(e)}}t.getDescription=(e,t)=>i.ns("files").rpc("get_description_batch",{file_ids:[t]},{subjectUserId:e}).then(e=>{if(!e||!e.items||1!==e.items.length)throw new Error("Unexpected response from get_description_batch");return e.items[0]}),t.setDescription=(e,t,s,o,i)=>new r(e).ns("files").rpc("set_description",{file_id:t,current_revision_id:s,text:o,format_version:i},{subjectUserId:e.id}),t.getContentReferences=(e,t)=>i.ns("files").rpc("get_content_references_info",{file_id:t},{subjectUserId:e}),t.removeContentReferences=(e,t,s)=>i.ns("files").rpc("remove_content_references",{anchor_file_id:t,return_roots_as_ns_ids:!0,file_ids:s},{subjectUserId:e}),t.addContentReferences=(e,t,s)=>i.ns("files").rpc("add_content_references",{anchor_file_id:t,return_roots_as_ns_ids:!0,file_ids:s},{subjectUserId:e}),t.addContentReferencesToPath=(e,t,s)=>i.ns("files").rpc("add_content_references_to_path",{path:t,return_roots_as_ns_ids:!0,file_ids:s},{subjectUserId:e}),t.getFolderAccess=({userId:e,sharedFolderId:t,accountId:s,accountEmail:o})=>i.ns("folder_overview").rpc("has_folder_access",{shared_folder_id:t,account_id:s,account_email:o},{subjectUserId:e}),t.getSharedFolderPath=({userId:e,sharedFolderId:t})=>i.ns("files").rpc("get_metadata",{path:`ns:${t}`},{subjectUserId:e}).then(e=>e.is_shareable?e.path_display:void 0),t.getLoggingFileId=({userId:e,path:t})=>i.ns("files").rpc("get_metadata",{path:t},{subjectUserId:e}).then(e=>e.id),t.isConflictError=e=>e.error&&e.error.status&&"conflict"===e.error.status[".tag"],t.isFormatVersionError=e=>e.error&&e.error.status&&"bad_format_version"===e.error.status[".tag"],t.getUserAccount=({userId:e,accountId:t})=>i.ns("users").rpc("get_account",{account_id:t},{subjectUserId:e})})),define("modules/clean/react/folder_overview/constants",["require","exports","modules/core/i18n","react-intl"],(function(e,t,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CONFLICT_POPUP_BUTTON=t.CONFLICT_POPUP_CONTENT_YOU=t.CONFLICT_POPUP_CONTENT=t.CONFLICT_POPUP_TITLE_YOU=t.CONFLICT_POPUP_TITLE=t.DESCRIPTION_LAST_EDIT=t.DESCRIPTION_LAST_EDIT_YOU=t.DESCRIPTION_LAST_EDIT_EMPTY=t.DESCRIPTION_LAST_EDIT_EMPTY_YOU=t.PIN_TO_READ_ONLY_FOLDER=t.PIN_TO_FAILURE_PERMISSION_DENIED=t.PIN_TO_MODAL_TITLE_MULTIPLE=t.PIN_TO_MODAL_TITLE_SINGLE=t.DESCRIPTION_VERSION=t.SHARING_MODAL_MESSAGE_PARENT_FOLDER_NO_NAME=t.SHARING_MODAL_MESSAGE_SAME_FOLDER_NO_NAME=t.SHARING_MODAL_MESSAGE_PARENT_FOLDER=t.SHARING_MODAL_MESSAGE_SAME_FOLDER=t.FOLDER_OVERVIEW_EDITOR_EDITING=t.CMD_KEY=t.CTRL_KEY=t.ALT_KEY=t.OPT_KEY=t.DESCRIPTION_SAVE_ERROR_DELAY_MS=t.DESCRIPTION_SAVE_DELAY_MS=t.SNACKBAR_SHOW_BUTTON_TEXT=t.SNACKBAR_CLOSE_BUTTON_TEXT=t.UNPIN_FROM_SNACKBAR_MESSAGE=t.PIN_TO_SNACKBAR_MESSAGE=t.ERROR_SHARE_NO_PERMISSION=t.ERROR_SHARE_MEMBER_FOLDER=t.ERROR_SHARE_PERSONAL_FOLDER=t.ERROR_DESCRIPTION_SAVE=t.ERROR_DESCRIPTION_FORMAT_VERSION=t.ERROR_DESCRIPTION_CONFLICT=t.FOLDER_EXAMPLES_LINK_URI=t.FOLDER_EXAMPLES_LINK_LABEL=t.DESCRIPTION_PLACEHOLDER_READ_ONLY=t.DESCRIPTION_PLACEHOLDER_EXAMPLES_BUTTON=t.DESCRIPTION_PLACEHOLDER_FOR_SPACE=t.DESCRIPTION_PLACEHOLDER=t.DESCRIPTION_PLACEHOLDER_RIGHT_RAIL=t.DATA_CACHE_TTL_MS=void 0,t.DATA_CACHE_TTL_MS=3e4,t.DESCRIPTION_PLACEHOLDER_RIGHT_RAIL=s.intl.formatMessage({id:"A5Lqjf",defaultMessage:"Add a few details about this folder here."}),t.DESCRIPTION_PLACEHOLDER=s.intl.formatMessage({id:"5wJAeB",defaultMessage:"Click here to describe this folder and turn it into a Space"}),t.DESCRIPTION_PLACEHOLDER_FOR_SPACE=s.intl.formatMessage({id:"uBopyb",defaultMessage:"Click here to describe this Space"}),t.DESCRIPTION_PLACEHOLDER_EXAMPLES_BUTTON=s.intl.formatMessage({id:"PR6SPH",defaultMessage:"Show examples"}),t.DESCRIPTION_PLACEHOLDER_READ_ONLY=s.intl.formatMessage({id:"PYQBlc",defaultMessage:"To edit this overview, ask the folder admin for access"}),t.FOLDER_EXAMPLES_LINK_LABEL=s.intl.formatMessage({id:"PR6SPH",defaultMessage:"Show examples"}),t.FOLDER_EXAMPLES_LINK_URI="https://www.dropbox.com/help/desktop-web/folder-overviews",t.ERROR_DESCRIPTION_CONFLICT=s.intl.formatMessage({id:"ssdefa",defaultMessage:"Can’t save changes. Paste text elsewhere to save, then click Refresh."}),t.ERROR_DESCRIPTION_FORMAT_VERSION=s.intl.formatMessage({id:"5dt0hu",defaultMessage:"Can’t save changes. Reload the page and try again."}),t.ERROR_DESCRIPTION_SAVE=s.intl.formatMessage({id:"PM6K+P",defaultMessage:"Can’t save changes."}),t.ERROR_SHARE_PERSONAL_FOLDER=s.intl.formatMessage({id:"9C/lc5",defaultMessage:"Can’t @mention someone in your Personal Dropbox."}),t.ERROR_SHARE_MEMBER_FOLDER=s.intl.formatMessage({id:"+dhj1b",defaultMessage:"Can’t @mention someone in your member folder."}),t.ERROR_SHARE_NO_PERMISSION=s.intl.formatMessage({id:"b7//2e",defaultMessage:"You don’t have permission to share this folder."}),t.PIN_TO_SNACKBAR_MESSAGE=o.defineMessage({id:"mjXnuX",defaultMessage:"Pinned to {folderName}"}),t.UNPIN_FROM_SNACKBAR_MESSAGE=o.defineMessage({id:"A1Fokf",defaultMessage:"Unpinned from {folderName}"}),t.SNACKBAR_CLOSE_BUTTON_TEXT=o.defineMessage({id:"Ww9LPX",defaultMessage:"Close"}),t.SNACKBAR_SHOW_BUTTON_TEXT=o.defineMessage({id:"8msMyU",defaultMessage:"Show"}),t.DESCRIPTION_SAVE_DELAY_MS=3e3,t.DESCRIPTION_SAVE_ERROR_DELAY_MS=10*t.DESCRIPTION_SAVE_DELAY_MS,t.OPT_KEY=s.intl.formatMessage({id:"HRXOjw",defaultMessage:"opt"}),t.ALT_KEY=s.intl.formatMessage({id:"RIxWSs",defaultMessage:"alt"}),t.CTRL_KEY=s.intl.formatMessage({id:"FL9yea",defaultMessage:"ctrl"}),t.CMD_KEY=s.intl.formatMessage({id:"NWv/3R",defaultMessage:"⌘"}),t.FOLDER_OVERVIEW_EDITOR_EDITING=s.intl.formatMessage({id:"Kud10T",defaultMessage:"Everyone in this folder can see notes, tasks, and pinned items"}),t.SHARING_MODAL_MESSAGE_SAME_FOLDER=o.defineMessage({id:"xkXFjI",defaultMessage:"Hi {user_name}, I @mentioned you in this folder. Take a look."}),t.SHARING_MODAL_MESSAGE_PARENT_FOLDER=o.defineMessage({id:"YzaJIx",defaultMessage:"Hi {user_name}, I @mentioned you in the {folder_name} folder. Take a look."}),t.SHARING_MODAL_MESSAGE_SAME_FOLDER_NO_NAME=s.intl.formatMessage({id:"sl5Fj7",defaultMessage:"I @mentioned you in this folder. Take a look."}),t.SHARING_MODAL_MESSAGE_PARENT_FOLDER_NO_NAME=o.defineMessage({id:"erm7J0",defaultMessage:"I @mentioned you in the {folder_name} folder. Take a look."}),t.DESCRIPTION_VERSION=[1,0,1],t.PIN_TO_MODAL_TITLE_SINGLE=o.defineMessage({id:"kh62rs",defaultMessage:"Pin “{name}” to..."}),t.PIN_TO_MODAL_TITLE_MULTIPLE=o.defineMessage({id:"oU0z79",defaultMessage:"Pin {num} items to..."}),t.PIN_TO_FAILURE_PERMISSION_DENIED=o.defineMessage({id:"BGyZpk",defaultMessage:"You do not have permission to pin to {path}"}),t.PIN_TO_READ_ONLY_FOLDER=o.defineMessage({id:"UD2+LM",defaultMessage:"Can't pin files or folders to a read-only folder"}),t.DESCRIPTION_LAST_EDIT_EMPTY_YOU=o.defineMessage({id:"PX5Hq1",defaultMessage:"Deleted {time_ago} by you"}),t.DESCRIPTION_LAST_EDIT_EMPTY=o.defineMessage({id:"7V5b6j",defaultMessage:"Deleted {time_ago} by {name}"}),t.DESCRIPTION_LAST_EDIT_YOU=o.defineMessage({id:"oA46AW",defaultMessage:"Updated {time_ago} by you"}),t.DESCRIPTION_LAST_EDIT=o.defineMessage({id:"MP7zas",defaultMessage:"Updated {time_ago} by {name}"}),t.CONFLICT_POPUP_TITLE=o.defineMessage({id:"PHRYz8",defaultMessage:"Your changes weren’t saved because you and {user} are editing at the same time."}),t.CONFLICT_POPUP_TITLE_YOU=s.intl.formatMessage({id:"tc/4YZ",defaultMessage:"Your changes weren’t saved because you are editing this description elsewhere."}),t.CONFLICT_POPUP_CONTENT=s.intl.formatMessage({id:"4aEgv5",defaultMessage:"Please wait until they’re done before making changes."}),t.CONFLICT_POPUP_CONTENT_YOU=s.intl.formatMessage({id:"oYSO1Z",defaultMessage:"Please save your other changes before making them here."}),t.CONFLICT_POPUP_BUTTON=s.intl.formatMessage({id:"nOO9Qi",defaultMessage:"OK"})})),define("modules/clean/react/folder_overview/data/action_creators",["require","exports","tslib","react","modules/clean/filepath/filepath","modules/clean/react/browse/data/selectors","modules/clean/react/folder_overview/api","modules/clean/react/folder_overview/constants","modules/clean/react/folder_overview/data/selectors","modules/clean/react/folder_overview/data/types","modules/clean/react/folder_overview/errors","modules/clean/react/folder_overview/live_update","modules/clean/react/folder_overview/logging","modules/clean/react/folder_overview/utils","modules/clean/react/snackbar","modules/core/persistence/storage","modules/clean/viewer","modules/clean/web_user_action_events","modules/core/exception","modules/core/i18n","modules/clean/react/right_rail/user_education/right_rail_user_education_tracker"],(function(e,t,s,o,i,r,a,n,l,c,d,u,_,p,m,f,h,g,S,E,T){"use strict";function b(e){m.Snackbar.complete(E.intl.formatMessage({id:"sz+AhS",defaultMessage:"{count, plural, one{Pinned {count} item.} other{Pinned {count} items.}}"},{count:e}),"folder-overview-pin-current-folder")}Object.defineProperty(t,"__esModule",{value:!0}),t.subscribeToBolt=t.initializeUserInteractionState=t.dismissEducationTooltip=t.interactedPinnedItems=t.interactedFolderOverview=t.fetchLoggingFileId=t.fetchAccountForUserId=t.fetchSharedFolderName=t.setDescriptionHasFocus=t.setRequiredComponents=t.updateFolderDataCache=t.removeContentReferences=t.addContentReferencesForPath=t.addContentReferences=t.reloadContentReferences=t.setContentReferencesData=t.saveDescriptionDraft=t.reloadDescription=t.setDescriptionData=t.setFailedToLoad=t.removeLoadedComponent=t.addLoadedComponent=t.saveFolderPreferences=t.loadFolderPreferences=t.handlePrefetch=t.fetchDataForFolder=void 0,o=s.__importStar(o),i=s.__importStar(i),r=s.__importStar(r),a=s.__importStar(a),l=s.__importStar(l),p=s.__importStar(p),S=s.__importStar(S),t.fetchDataForFolder=({path:e,nsId:o,componentNamespace:i,fetchContentReferences:r})=>(d,u)=>s.__awaiter(void 0,void 0,void 0,(function*(){let s,_=!1;const m=p.normalizePath(e),f=Date.now(),h=l.componentDataCache(u())[i];if(!h||0===h.requiredComponents.length){const e=r?["content_references","description","draftjs"]:["description","draftjs"];d(t.setRequiredComponents({componentNamespace:i,requiredComponents:e}))}const g=[];try{const h=l.user(u()).id;s=l.fileIdCache(u())[m];const S=s||l.nsIdCache(u())[m]||o;if(!S)throw new Error("Unable to get file ID or NS ID for current folder");d(t.setFailedToLoad({componentNamespace:i,hasFailedToLoad:!1}));let E=s?l.folderDataCache(u())[s]:void 0;E&&E.descriptionLastUpdated&&f-E.descriptionLastUpdated<n.DATA_CACHE_TTL_MS?(_=!!E.descriptionBaseRevision,d(t.addLoadedComponent({componentNamespace:i,component:"description"})),g.push(Promise.resolve(null))):(d(t.removeLoadedComponent({componentNamespace:i,component:"description"})),g.push(a.getDescription(h,S))),E&&E.contentReferencesLastUpdated&&f-E.contentReferencesLastUpdated<n.DATA_CACHE_TTL_MS?(d(t.addLoadedComponent({componentNamespace:i,component:"content_references"})),g.push(Promise.resolve(null))):r&&(d(t.removeLoadedComponent({componentNamespace:i,component:"content_references"})),g.push(a.getContentReferences(h,S)));const[T,b]=yield Promise.all(g);if(T&&(s=T.file_obj_id),!s)throw new Error("Did not get a file ID from the Sprinkle description payload");d({type:c.ActionTypes.UPDATE_FILE_ID_CACHE,payload:{fileIdCache:{[p.normalizePath(e)]:s}}}),_=!!T&&R(d,s,T,i,f),b&&A(d,s,b,_,i,f),E=l.folderDataCache(u())[s],E&&E.sharedFolderPath||d(t.fetchSharedFolderName({path:e})),E&&E.loggingFileId||d(t.fetchLoggingFileId({path:e})),d(t.loadFolderPreferences({folderFileId:s}))}catch(s){S.reportException({err:s,severity:"non-critical",exc_extra:{path:e}}),d(t.setFailedToLoad({componentNamespace:i,hasFailedToLoad:!0}))}})),t.handlePrefetch=({path:e,content_references:o,description:i,componentNamespace:r,ts:a=Date.now()})=>n=>s.__awaiter(void 0,void 0,void 0,(function*(){try{const t=i||{},s=o||{},l=t.file_obj_id;if(!l)throw new Error("Did not get a file ID from the Odyssey prefetch payload");n({type:c.ActionTypes.UPDATE_FILE_ID_CACHE,payload:{fileIdCache:{[p.normalizePath(e)]:l}}});const d=t&&R(n,l,t,r,a);s&&A(n,l,s,d,r,a)}catch(s){S.reportException({err:s,severity:"non-critical",exc_extra:{path:e}}),n(t.setFailedToLoad({componentNamespace:r,hasFailedToLoad:!0}))}})),t.loadFolderPreferences=({folderFileId:e})=>(o,i)=>s.__awaiter(void 0,void 0,void 0,(function*(){const s=l.user(i()).id;f.UserLocalStorage.clearOtherUsers([s]);const r=f.UserLocalStorage.get(s,`folder-overview-${e}`);r&&o(t.updateFolderDataCache({fileId:e,folderData:r}))})),t.saveFolderPreferences=({folderFileId:e})=>(t,o)=>s.__awaiter(void 0,void 0,void 0,(function*(){const t=l.user(o()).id;f.UserLocalStorage.clearOtherUsers([t]);const s=l.folderDataCache(o())[e];s&&f.UserLocalStorage.set(t,`folder-overview-${e}`,{isCollapsed:s.isCollapsed})})),t.addLoadedComponent=({componentNamespace:e,component:t})=>({type:c.ActionTypes.ADD_LOADED_COMPONENT,payload:{componentNamespace:e,component:t}}),t.removeLoadedComponent=({componentNamespace:e,component:t})=>({type:c.ActionTypes.REMOVE_LOADED_COMPONENT,payload:{componentNamespace:e,component:t}}),t.setFailedToLoad=({componentNamespace:e,hasFailedToLoad:t})=>({type:c.ActionTypes.SET_FAILED_TO_LOAD,payload:{componentNamespace:e,hasFailedToLoad:t}}),t.setDescriptionData=(e,s,o)=>{const{text:i,latest_revision_id:r,file_obj_id:a,bolt_channel_state:n,format_version:l,last_modified_time:d,last_modified_user:u}=e;if(!a)throw new Error("Unexpected response from Sprinkle");const _=r||"";s(t.updateFolderDataCache({fileId:a,folderData:{description:i,descriptionBaseRevision:_,descriptionDraft:void 0,descriptionSaveState:c.DescriptionSaveState.IDLE,descriptionFormatVersion:l,descriptionBoltChannelState:n,descriptionLastUpdated:Date.now()}})),s(t.addLoadedComponent({componentNamespace:o,component:"description"})),s(C({folderFileId:a,modifiedInfo:{timestamp:d,userId:u},field:"description"})),t.subscribeToBolt("description",n)},t.reloadDescription=({folderFileId:e,componentNamespace:o})=>(i,r)=>s.__awaiter(void 0,void 0,void 0,(function*(){const s=l.user(r());try{const r=yield a.getDescription(s.id,e);i(t.updateFolderDataCache({fileId:e,folderData:{descriptionBaseRevision:""}})),t.setDescriptionData(r,i,o)}catch(t){S.reportException({err:t,severity:S.SEVERITY.NONCRITICAL,tags:["browse","folder_overview"],exc_extra:{fileId:e,isReload:!0}})}})),t.saveDescriptionDraft=({folderFileId:e,componentNamespace:o,isInRightRail:i})=>(r,u)=>s.__awaiter(void 0,void 0,void 0,(function*(){const s=l.user(u());try{const d=l.folderDataCache(u())[e];if(!d||!v(d))return;p({descriptionSaveState:c.DescriptionSaveState.SAVING});const m=yield a.setDescription(s,e,d.descriptionLatestRevision,d.descriptionDraft,n.DESCRIPTION_VERSION.join(".")),f=l.componentDataCache(u())[o];(null==f?void 0:f.descriptionHasFocus)||void 0===d.descriptionOpenedAtRevision||I(d);const{text:h,latest_revision_id:S,last_modified_time:E,last_modified_user:T}=m;i&&r(t.interactedFolderOverview()),p({description:h,descriptionSaveState:c.DescriptionSaveState.IDLE,descriptionLastModified:{timestamp:E,userId:T},descriptionBaseRevision:S,descriptionLatestRevision:S});const b="BROWSE"===o?g.ActionSurfaceLogValue.CENTER_PANE:g.ActionSurfaceLogValue.RIGHT_SIDEBAR,w="search-sidebar"===o?g.RetrievalSourceValue.SEARCH:g.RetrievalSourceValue.BROWSE;_.logOverviewEdited({folderFileId:e,action_surface:b,retrievalSource:w,loggingFileId:d.loggingFileId})}catch(t){a.isConflictError(t)?(p({descriptionSaveState:c.DescriptionSaveState.CONFLICT,descriptionLastModified:{userId:void 0}}),r(F({folderFileId:e}))):a.isFormatVersionError(t)?(d.showDescriptionFormatError(),p({descriptionSaveState:c.DescriptionSaveState.ERROR})):(d.showDescriptionSaveError(),p({descriptionSaveState:c.DescriptionSaveState.ERROR}))}function p(s){r(t.updateFolderDataCache({fileId:e,folderData:s}))}})),t.setContentReferencesData=(e,s,o,i)=>{const r=s.content_references||[],a=s.latest_revision_id,n=s.last_modified_time,l=s.last_modified_user;o(t.updateFolderDataCache({fileId:e,folderData:{contentReferences:r,contentReferencesRevision:a,contentReferencesBoltChannelState:s.bolt_channel_state,contentReferencesLastUpdated:Date.now()}})),o(C({folderFileId:e,modifiedInfo:{timestamp:n,userId:l},field:"contentReferences"})),o(t.addLoadedComponent({componentNamespace:i,component:"content_references"})),t.subscribeToBolt("content_references",s.bolt_channel_state)},t.reloadContentReferences=({folderFileId:e,componentNamespace:o})=>(i,r)=>s.__awaiter(void 0,void 0,void 0,(function*(){const s=l.user(r());try{const r=yield a.getContentReferences(s.id,e);t.setContentReferencesData(e,r,i,o)}catch(t){S.reportException({err:t,severity:S.SEVERITY.NONCRITICAL,tags:["browse","folder_overview"],exc_extra:{fileId:e,isReload:!0}})}}));const w=({folderName:e,onShow:t})=>{m.Snackbar.show(o.createElement(m.Snackbar,{title:E.intl.formatMessage(n.PIN_TO_SNACKBAR_MESSAGE,{folderName:e}),timeoutDelayMs:5e3,actionButtonText:t?E.intl.formatMessage(n.SNACKBAR_SHOW_BUTTON_TEXT):void 0,closeButtonText:E.intl.formatMessage({id:"HBT96k",defaultMessage:"Close"}),onActionClick:t?()=>{m.Snackbar.close("folder-overview-pin"),t()}:void 0,id:"folder-overview-pin"}))};function I(e){const t=e.description?E.intl.formatMessage({id:"BV1uZg",defaultMessage:"Folder overview changed."}):E.intl.formatMessage({id:"MLktc7",defaultMessage:"Folder overview added."});m.Snackbar.generic(t,"folder-overview-change")}t.addContentReferences=({folderFileId:e,fileIds:o,componentNamespace:i,snackbarConfig:r})=>(n,c)=>s.__awaiter(void 0,void 0,void 0,(function*(){if(null===o||0===o.length)return;const s=l.user(c()).id;try{yield a.addContentReferences(s,e,o),r?w(r):b(o.length),n(t.reloadContentReferences({folderFileId:e,componentNamespace:i}))}catch(e){S.reportException({err:e,severity:S.SEVERITY.NONCRITICAL,tags:["browse","folder_overview"]})}})),t.addContentReferencesForPath=({path:e,files:o,currentPath:r,snackbarConfig:c})=>(d,u)=>s.__awaiter(void 0,void 0,void 0,(function*(){const s=l.user(u());try{yield a.addContentReferencesToPath(s.id,e,o.map(p.fileToContentReferenceId)),c?w(c):r!==e?m.Snackbar.complete(E.intl.formatMessage({id:"Mflc9Z",defaultMessage:"{count, plural, one{Pinned {count} item to {folder}.} other{Pinned {count} items to {folder}.}}"},{count:o.length,folder:i.filename(e,h.Viewer.get_root_name(s))}),"folder-overview-pin"):b(o.length);const n=l.fileIdCache(u())[p.normalizePath(e)];n&&d(t.reloadContentReferences({folderFileId:n,componentNamespace:"BROWSE"}))}catch(t){S.reportException({err:t,severity:S.SEVERITY.NONCRITICAL,tags:["browse","folder_overview"]});try{if("permission_denied"===t.error.status[".tag"]){const t=c?E.intl.formatMessage(n.PIN_TO_READ_ONLY_FOLDER):E.intl.formatMessage(n.PIN_TO_FAILURE_PERMISSION_DENIED,{path:i.filename(e,h.Viewer.get_root_name(s))});return void m.Snackbar.fail(t,"folder-overview-pin")}}catch(e){}m.Snackbar.fail(E.intl.formatMessage({id:"LYVKP8",defaultMessage:"{count, plural, one{Failed to pin {count} item to {folder}.} other{Failed to pin {count} items to {folder}.}}"},{count:o.length,folder:i.filename(e,h.Viewer.get_root_name(s))}),"folder-overview-pin")}})),t.removeContentReferences=({folderFileId:e,fileIds:i,componentNamespace:r,snackbarConfig:c})=>(d,u)=>s.__awaiter(void 0,void 0,void 0,(function*(){const s=l.user(u()).id;try{yield a.removeContentReferences(s,e,i),c?m.Snackbar.show(o.createElement(m.Snackbar,{title:E.intl.formatMessage(n.UNPIN_FROM_SNACKBAR_MESSAGE,{folderName:c.folderName}),variant:"complete",actionButtonText:E.intl.formatMessage({id:"GUtve/",defaultMessage:"Undo"}),closeButtonText:E.intl.formatMessage({id:"HBT96k",defaultMessage:"Close"}),onActionClick:()=>{m.Snackbar.close("folder-overview-unpin"),d(t.addContentReferences({folderFileId:e,fileIds:i,componentNamespace:r,snackbarConfig:c}))},timeoutDelayMs:5e3,id:"folder-overview-unpin"})):m.Snackbar.generic(E.intl.formatMessage({id:"0bkx9E",defaultMessage:"{count, plural, one{Unpinned {count} item.} other{Unpinned {count} items.}}"},{count:i.length}),"folder-overview-unpin"),d(t.reloadContentReferences({folderFileId:e,componentNamespace:r}))}catch(e){S.reportException({err:e,severity:S.SEVERITY.NONCRITICAL,tags:["browse","folder_overview"]})}})),t.updateFolderDataCache=({fileId:e,folderData:t})=>({type:c.ActionTypes.UPDATE_FOLDER_DATA_CACHE,payload:{fileId:e,folderData:t}}),t.setRequiredComponents=({componentNamespace:e,requiredComponents:t})=>({type:c.ActionTypes.SET_REQUIRED_COMPONENTS,payload:{componentNamespace:e,requiredComponents:t}}),t.setDescriptionHasFocus=({componentNamespace:e,descriptionHasFocus:s,folderFileId:o})=>(i,r)=>{const a=l.componentDataCache(r())[e];if(s&&a&&!a.descriptionHasFocus){const e=l.folderDataCache(r())[o].descriptionBaseRevision;i(t.updateFolderDataCache({fileId:o,folderData:{descriptionLatestRevision:e,descriptionOpenedAtRevision:e}}))}else if(!s&&(null==a?void 0:a.descriptionHasFocus)){const e=l.folderDataCache(r())[o];e&&(null==e?void 0:e.descriptionOpenedAtRevision)!==(null==e?void 0:e.descriptionLatestRevision)&&(I(e),i(t.updateFolderDataCache({fileId:o,folderData:{descriptionOpenedAtRevision:void 0}})))}i({type:c.ActionTypes.SET_DESCRIPTION_HAS_FOCUS,payload:{componentNamespace:e,descriptionHasFocus:s}})};const v=e=>!!e&&(e.descriptionSaveState!==c.DescriptionSaveState.CONFLICT&&(e.descriptionSaveState!==c.DescriptionSaveState.SAVING&&p.hasUnsavedDescriptionDraft(e)));t.fetchSharedFolderName=({path:e})=>(o,r)=>s.__awaiter(void 0,void 0,void 0,(function*(){if(i.paths_are_equal(e,"/"))return;const s=p.normalizePath(e),n=l.nsIdCache(r())[s];if(!n)return;const c=l.fileIdCache(r())[s],d=l.user(r()).id,u=p.extractSharedFolderId(n);if(u)try{const e=yield a.getSharedFolderPath({userId:d,sharedFolderId:u});o(t.updateFolderDataCache({fileId:c,folderData:{sharedFolderPath:e}}))}catch(e){S.reportException({err:e,severity:S.SEVERITY.NONCRITICAL,tags:["browse","folder_overview"]})}})),t.fetchAccountForUserId=({accountId:e})=>(t,o)=>s.__awaiter(void 0,void 0,void 0,(function*(){const s=l.user(o());if(!e)return;if(e in l.accountCache(o()))return;if(e===s.account_id)return;const i=yield a.getUserAccount({userId:s.id,accountId:e});t({type:c.ActionTypes.UPDATE_ACCOUNT_CACHE,payload:{accountCache:{[e]:i}}})})),t.fetchLoggingFileId=({path:e})=>(o,n)=>s.__awaiter(void 0,void 0,void 0,(function*(){if(i.paths_are_equal(e,"/"))return;if(i.paths_are_equal(r.context(n()).currentFQPath,e)&&!r.context(n()).currentNSPath)return;const s=p.normalizePath(e),c=l.fileIdCache(n())[s],d=l.user(n()).id;try{const e=yield a.getLoggingFileId({userId:d,path:s});o(t.updateFolderDataCache({fileId:c,folderData:{loggingFileId:e}}))}catch(e){S.reportException({err:e,severity:S.SEVERITY.NONCRITICAL,tags:["browse","folder_overview"]})}})),t.interactedFolderOverview=()=>(e,t)=>{const s=l.getRightRailUserEducationTracker(t()),o=l.getUserEducationTooltips(t());o.tooltipsEnabled&&!o.hasInteractedWithOverview&&(e({type:c.ActionTypes.UPDATE_EDUCATION_TOOLTIPS_STATE,payload:{hasInteractedWithOverview:!0}}),s.track(T.RightRailUserEducationActions.FOLDER_OVERVIEW_INTERACTION))},t.interactedPinnedItems=()=>(e,t)=>{const s=l.getRightRailUserEducationTracker(t()),o=l.getUserEducationTooltips(t());o.tooltipsEnabled&&!o.hasInteractedWithPinnedItems&&(e({type:c.ActionTypes.UPDATE_EDUCATION_TOOLTIPS_STATE,payload:{hasInteractedWithPinnedItems:!0}}),s.track(T.RightRailUserEducationActions.PINNED_BLADE_INTERACTION))},t.dismissEducationTooltip=()=>(e,t)=>{const s=l.getRightRailUserEducationTracker(t());e({type:c.ActionTypes.UPDATE_EDUCATION_TOOLTIPS_STATE,payload:{hasSeenTooltip:!0}}),s.track(T.RightRailUserEducationActions.TOOLTIP_SEEN)};const O=(e,t)=>s.__awaiter(void 0,void 0,void 0,(function*(){try{return yield t.hasPerfomed(e)}catch(e){return S.reportException({err:e,force:!0,severity:S.SEVERITY.NONCRITICAL,tags:["browse","folder_overview","browse_right_rail"]}),!0}}));t.initializeUserInteractionState=e=>(t,o)=>s.__awaiter(void 0,void 0,void 0,(function*(){if(!e)return;const s=l.getRightRailUserEducationTracker(o()),[i,r,a]=yield Promise.all([O(T.RightRailUserEducationActions.PINNED_BLADE_INTERACTION,s),O(T.RightRailUserEducationActions.FOLDER_OVERVIEW_INTERACTION,s),O(T.RightRailUserEducationActions.TOOLTIP_SEEN,s)]);t({type:c.ActionTypes.UPDATE_EDUCATION_TOOLTIPS_STATE,payload:{hasSeenTooltip:a,hasInteractedWithOverview:r,hasInteractedWithPinnedItems:i,tooltipsEnabled:!0}})}));const C=({folderFileId:e,modifiedInfo:s,field:o})=>(i,r)=>{if(!s.timestamp||!s.userId)return;const a=l.folderDataCache(r())[e];if(!a)return;const n="contentReferences"===o?"contentReferencesLastModified":"descriptionLastModified",c=a[n];(null==c?void 0:c.timestamp)&&s.timestamp<c.timestamp||(i(t.updateFolderDataCache({fileId:e,folderData:{[n]:s}})),i(t.fetchAccountForUserId({accountId:s.userId})))};t.subscribeToBolt=(e,t)=>{if(void 0!==t)try{const{channel_id:s,revision:o,token:i}=t;if(void 0===s||void 0===o||void 0===i)return;const{unique_id:r,app_id:a}=s;if(void 0===r||void 0===a)return;u.folderOverviewLiveUpdateManager.setUpdateChannelForType(e,{uniqueId:r,appId:a,token:i,revision:`${o}`})}catch(e){S.reportException({err:e,severity:S.SEVERITY.NONCRITICAL,tags:["browse","folder_overview"]})}};const F=({folderFileId:e})=>(t,o)=>s.__awaiter(void 0,void 0,void 0,(function*(){const s=l.user(o()),{last_modified_time:i,last_modified_user:r}=yield a.getDescription(s.id,e);t(C({folderFileId:e,modifiedInfo:{timestamp:i,userId:r},field:"description"}))})),R=(e,s,o,i,r)=>o.latest_revision_id?(t.setDescriptionData(o,e,i),!0):(e(t.addLoadedComponent({componentNamespace:i,component:"description"})),e(t.updateFolderDataCache({fileId:s,folderData:{descriptionBoltChannelState:o.bolt_channel_state,descriptionLastUpdated:r}})),t.subscribeToBolt("description",o.bolt_channel_state),!1),A=(e,s,o,i,r,a)=>o.latest_revision_id?(t.setContentReferencesData(s,o,e,r),!0):(e(t.updateFolderDataCache({fileId:s,folderData:{contentReferences:[],contentReferencesBoltChannelState:o.bolt_channel_state,contentReferencesLastUpdated:a}})),e(t.addLoadedComponent({componentNamespace:r,component:"content_references"})),!1)})),define("modules/clean/react/folder_overview/data/reducer",["require","exports","modules/clean/react/browse/data/types","modules/clean/react/browse/models","modules/clean/react/folder_overview/data/types","modules/clean/react/folder_overview/utils","modules/clean/search/single_page/data/types"],(function(e,t,s,o,i,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.folderOverviewReducer=t.defaultFolderOverviewState=void 0,t.defaultFolderOverviewState={folderDataCache:{},fileIdCache:{},accountCache:{},nsIdCache:{},componentDataCache:{},educationTooltips:{hasSeenTooltip:!0}};const n=(e,t)=>{const s=e.componentDataCache[t];return s||{requiredComponents:[],loadedComponents:[],hasFailedToLoad:!1,descriptionHasFocus:!1}},l=e=>{const t={};return e.forEach(e=>{t[r.normalizePath(e.fq_path)]=e.target_ns?`ns:${e.target_ns}/`:`ns:${e.ns_id}/${e.ns_path}`}),t};t.folderOverviewReducer=function(e=t.defaultFolderOverviewState,c){switch(c.type){case i.ActionTypes.UPDATE_FOLDER_DATA_CACHE:return((e,{fileId:t,folderData:s})=>Object.assign(Object.assign({},e),{folderDataCache:Object.assign(Object.assign({},e.folderDataCache),{[t]:Object.assign(Object.assign({},e.folderDataCache[t]),s)})}))(e,c.payload);case i.ActionTypes.UPDATE_FILE_ID_CACHE:return((e,{fileIdCache:t})=>Object.assign(Object.assign({},e),{fileIdCache:Object.assign(Object.assign({},e.fileIdCache),t)}))(e,c.payload);case i.ActionTypes.UPDATE_ACCOUNT_CACHE:return((e,{accountCache:t})=>Object.assign(Object.assign({},e),{accountCache:Object.assign(Object.assign({},e.accountCache),t)}))(e,c.payload);case i.ActionTypes.SET_REQUIRED_COMPONENTS:return((e,{componentNamespace:t,requiredComponents:s})=>{const o=n(e,t);return Object.assign(Object.assign({},e),{componentDataCache:Object.assign(Object.assign({},e.componentDataCache),{[t]:Object.assign(Object.assign({},o),{requiredComponents:s})})})})(e,c.payload);case s.ActionTypes.SET_CONTEXT:return((e,{context:t})=>Object.assign(Object.assign({},e),{nsIdCache:Object.assign(Object.assign({},e.nsIdCache),{[r.normalizePath(t.currentFQPath)]:`ns:${t.currentNSID}/${t.currentNSPath}`})}))(e,c.payload);case i.ActionTypes.REMOVE_LOADED_COMPONENT:return((e,{componentNamespace:t,component:s})=>{const o=n(e,t),i=o.loadedComponents;return Object.assign(Object.assign({},e),{componentDataCache:Object.assign(Object.assign({},e.componentDataCache),{[t]:Object.assign(Object.assign({},o),{loadedComponents:i.filter(e=>e!==s)})})})})(e,c.payload);case i.ActionTypes.ADD_LOADED_COMPONENT:return((e,{componentNamespace:t,component:s})=>{const o=n(e,t),i=o.loadedComponents;return i.includes(s)?e:Object.assign(Object.assign({},e),{componentDataCache:Object.assign(Object.assign({},e.componentDataCache),{[t]:Object.assign(Object.assign({},o),{loadedComponents:[...i,s]})})})})(e,c.payload);case i.ActionTypes.SET_FAILED_TO_LOAD:return((e,{componentNamespace:t,hasFailedToLoad:s})=>{const o=n(e,t);return Object.assign(Object.assign({},e),{componentDataCache:Object.assign(Object.assign({},e.componentDataCache),{[t]:Object.assign(Object.assign({},o),{hasFailedToLoad:s})})})})(e,c.payload);case i.ActionTypes.SET_DESCRIPTION_HAS_FOCUS:return((e,{componentNamespace:t,descriptionHasFocus:s})=>{const o=n(e,t);return Object.assign(Object.assign({},e),{componentDataCache:Object.assign(Object.assign({},e.componentDataCache),{[t]:Object.assign(Object.assign({},o),{descriptionHasFocus:s})})})})(e,c.payload);case s.ActionTypes.SET_UNSORTED_FILES:return((e,{unsortedFiles:t})=>{const s=t.filter(e=>e.is_dir).toArray();return Object.assign(Object.assign({},e),{nsIdCache:Object.assign(Object.assign({},e.nsIdCache),l(s))})})(e,c.payload);case a.ActionTypes.SET_RESULTS:case a.ActionTypes.APPEND_RESULTS:return((e,{searchResults:t})=>{const s=t.results.filter(e=>e instanceof o.File&&e.is_dir);return Object.assign(Object.assign({},e),{nsIdCache:Object.assign(Object.assign({},e.nsIdCache),l(s))})})(e,c.payload);case i.ActionTypes.UPDATE_EDUCATION_TOOLTIPS_STATE:return((e,t)=>Object.assign(Object.assign({},e),{educationTooltips:Object.assign(Object.assign({},e.educationTooltips),t)}))(e,c.payload)}return e}})),define("modules/clean/react/folder_overview/data/selectors",["require","exports","tslib","reselect","modules/clean/filepath/filepath","modules/clean/react/folder_overview/constants","modules/clean/react/folder_overview/data/reducer","modules/clean/react/folder_overview/utils","typescript/libraries/comments2/src/components/folder_overview_utils/index","modules/clean/redux/namespaces","modules/clean/redux/selectors","modules/clean/user","modules/clean/react/right_rail/user_education/right_rail_user_education_tracker"],(function(e,t,s,o,i,r,a,n,l,c,d,u,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.canShowToolFolderOverviewTooltip=t.getUserEducationTooltips=t.getRightRailUserEducationTracker=t.makeDoesFolderOverviewExistSelector=t.makeIsSpaceSelector=t.makeIsFolderOverviewEmptySelector=t.makePinnedItemsSelector=t.makeDescriptionContentSelector=t.makeLoggingFileIdSelector=t.makeSharedFolderNameSelector=t.makeSharedFolderPathSelector=t.makeHasUnsavedDescriptionDraftSelector=t.makeDescriptionFormatValidSelector=t.makeDescriptionSaveStateSelector=t.makeLastModifiedUserSelector=t.makeLastModifiedUserIdSelector=t.makeLastModifiedTimeSelector=t.makeDescriptionBaseRevisionSelector=t.makeIsCollapsedSelector=t.descriptionAuthorSelector=t.makeSharedFolderIdSelector=t.makeFolderNsIdSelector=t.makeFolderFileIdSelector=t.makeDescriptionHasFocusSelector=t.makeHasFailedToLoadSelector=t.makeHaveAllComponentsLoadedSelector=t.makeLoadedComponentsSelector=t.user=t.componentDataCache=t.accountCache=t.nsIdCache=t.fileIdCache=t.folderDataCache=void 0,i=s.__importStar(i),n=s.__importStar(n);const p=[],m=e=>d.getStateAtNamespace(e,c.FOLDER_OVERVIEW_NAMESPACE_KEY)||a.defaultFolderOverviewState;t.folderDataCache=e=>m(e).folderDataCache,t.fileIdCache=e=>m(e).fileIdCache;const f=(e,s)=>t.fileIdCache(e)[n.normalizePath(s.path)];t.nsIdCache=e=>m(e).nsIdCache;const h=(e,s)=>t.nsIdCache(e)[n.normalizePath(s.path)];t.accountCache=e=>m(e).accountCache,t.componentDataCache=e=>m(e).componentDataCache,t.user=e=>e.BROWSE&&e.BROWSE.user||u.mkUser(e.SEARCH.user);const g=(e,s)=>t.componentDataCache(e)[s.componentNamespace],S=(e,s)=>{const o=f(e,s);return t.folderDataCache(e)[o]},E=(e,t)=>{const s=S(e,t);return s?s.sharedFolderPath||t.path:void 0},T=(e,t)=>{var s;const o=b(e,t);return null!==(s=null==o?void 0:o.userId)&&void 0!==s?s:void 0},b=(e,t)=>{const{descriptionLastModified:s,contentReferencesLastModified:o}=S(e,t)||{};return t.isInRightRail?s:(null==s?void 0:s.timestamp)&&(null==o?void 0:o.timestamp)?s.timestamp<o.timestamp?o:s:s||o},w=o.createSelector(S,e=>e?e.descriptionFormatVersion:void 0),I=o.createSelector(S,e=>{if(e&&e.description)try{return JSON.parse(e.description)}catch(e){return}}),v=o.createSelector(S,e=>{if(void 0!==e&&void 0!==e.contentReferences)return 0===e.contentReferences.length?p:n.convertContentReferencesToSortedFiles(e.contentReferences)}),O=o.createSelector(I,l.isEmptyDescription);t.makeLoadedComponentsSelector=()=>o.createSelector(g,e=>e?e.loadedComponents:void 0),t.makeHaveAllComponentsLoadedSelector=()=>o.createSelector(g,e=>{if(!e||0===e.requiredComponents.length)return!1;return 0===e.requiredComponents.filter(t=>!e.loadedComponents.includes(t)).length}),t.makeHasFailedToLoadSelector=()=>o.createSelector(g,e=>!!e&&e.hasFailedToLoad),t.makeDescriptionHasFocusSelector=()=>o.createSelector(g,e=>!!e&&e.descriptionHasFocus),t.makeFolderFileIdSelector=()=>o.createSelector(f,e=>e),t.makeFolderNsIdSelector=()=>o.createSelector(h,e=>e),t.makeSharedFolderIdSelector=()=>o.createSelector(h,e=>{if(e)return n.extractSharedFolderId(e)}),t.descriptionAuthorSelector=o.createSelector(t.user,n.convertDbxUserToIUser),t.makeIsCollapsedSelector=()=>o.createSelector(S,e=>!!e&&!!e.isCollapsed),t.makeDescriptionBaseRevisionSelector=()=>o.createSelector(S,e=>e?e.descriptionBaseRevision:void 0),t.makeLastModifiedTimeSelector=()=>o.createSelector(b,e=>{var t;return null!==(t=null==e?void 0:e.timestamp)&&void 0!==t?t:void 0}),t.makeLastModifiedUserIdSelector=()=>o.createSelector(T,e=>e),t.makeLastModifiedUserSelector=()=>o.createSelector(T,t.accountCache,(e,t)=>e?t[e]:void 0),t.makeDescriptionSaveStateSelector=()=>o.createSelector(S,e=>e?e.descriptionSaveState:void 0),t.makeDescriptionFormatValidSelector=()=>o.createSelector(w,e=>{if(!e)return!0;const t=e.split(".").map(e=>parseInt(e,10));return!(t[0]>r.DESCRIPTION_VERSION[0])&&!(t[0]===r.DESCRIPTION_VERSION[0]&&t[1]>r.DESCRIPTION_VERSION[1])}),t.makeHasUnsavedDescriptionDraftSelector=()=>o.createSelector(S,n.hasUnsavedDescriptionDraft),t.makeSharedFolderPathSelector=()=>o.createSelector(E,e=>e),t.makeSharedFolderNameSelector=()=>o.createSelector(E,e=>e?i.filename(e):void 0),t.makeLoggingFileIdSelector=()=>o.createSelector(S,e=>e?e.loggingFileId:void 0),t.makeDescriptionContentSelector=()=>o.createSelector(I,e=>e),t.makePinnedItemsSelector=()=>o.createSelector(v,e=>e),t.makeIsFolderOverviewEmptySelector=()=>o.createSelector(O,v,(e,t)=>t.isInRightRail,(e,t,s)=>e&&(s||!(t&&t.length))),t.makeIsSpaceSelector=()=>o.createSelector(O,v,(e,t)=>!e||!(!t||!t.length)),t.makeDoesFolderOverviewExistSelector=()=>o.createSelector(S,e=>!!e&&(!!e.descriptionBaseRevision||!!e.contentReferencesRevision)),t.getRightRailUserEducationTracker=o.createSelector(t.user,e=>new _.RightRailUserEducationTracker(e.id)),t.getUserEducationTooltips=e=>m(e).educationTooltips,t.canShowToolFolderOverviewTooltip=o.createSelector(O,v,t.getUserEducationTooltips,(e,t,s)=>{const{tooltipsEnabled:o,hasInteractedWithOverview:i,hasInteractedWithPinnedItems:r,hasSeenTooltip:a}=s,n=!(!t||!t.length);return Boolean(o&&!a&&(!i&&!e||!r&&n))})})),define("modules/clean/react/folder_overview/data/store",["require","exports","modules/clean/react/folder_overview/data/reducer","modules/clean/redux/store","modules/clean/redux/namespaces"],(function(e,t,s,o,i){"use strict";let r;Object.defineProperty(t,"__esModule",{value:!0}),t.getStoreForFolderOverview=void 0,t.getStoreForFolderOverview=()=>(r||(r=o.getStoreAndRegisterReducers({[i.FOLDER_OVERVIEW_NAMESPACE_KEY]:s.folderOverviewReducer})),r)})),define("modules/clean/react/folder_overview/data/types",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DescriptionSaveState=t.ActionTypes=void 0,(function(e){e.UPDATE_FOLDER_DATA_CACHE="FOLDER_OVERVIEW/UPDATE_FOLDER_DATA_CACHE",e.UPDATE_FILE_ID_CACHE="FOLDER_OVERVIEW/UPDATE_FILE_ID_CACHE",e.REMOVE_LOADED_COMPONENT="FOLDER_OVERVIEW/REMOVE_LOADED_COMPONENT",e.ADD_LOADED_COMPONENT="FOLDER_OVERVIEW/ADD_LOADED_COMPONENT",e.SET_FAILED_TO_LOAD="FOLDER_OVERVIEW/SET_FAILED_TO_LOAD",e.SET_DESCRIPTION_HAS_FOCUS="FOLDER_OVERVIEW/SET_DESCRIPTION_HAS_FOCUS",e.UPDATE_ACCOUNT_CACHE="FOLDER_OVERVIEW/UPDATE_ACCOUNT_CACHE",e.SET_REQUIRED_COMPONENTS="FOLDER_OVERVIEW/SET_REQUIRED_COMPONENTS",e.UPDATE_EDUCATION_TOOLTIPS_STATE="FOLDER_OVERVIEW/UPDATE_EDUCATION_TOOLTIPS_STATE"})(t.ActionTypes||(t.ActionTypes={})),(function(e){e.IDLE="IDLE",e.SAVING="SAVING",e.CONFLICT="CONFLICT",e.ERROR="ERROR"})(t.DescriptionSaveState||(t.DescriptionSaveState={}))})),define("modules/clean/react/folder_overview/errors",["require","exports","modules/clean/react/folder_overview/constants","modules/clean/react/snackbar"],(function(e,t,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.showDescriptionSaveError=t.showDescriptionFormatError=void 0,t.showDescriptionFormatError=()=>{o.Snackbar.fail(s.ERROR_DESCRIPTION_FORMAT_VERSION,"folder-overview")},t.showDescriptionSaveError=()=>{o.Snackbar.fail(s.ERROR_DESCRIPTION_SAVE,"folder-overview")}})),define("modules/clean/react/folder_overview/live_update",["require","exports","tslib","lodash","eventemitter3","modules/clean/bolt/bolt"],(function(e,t,s,o,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.folderOverviewLiveUpdateManager=t.FolderOverviewLiveUpdateManager=void 0,o=s.__importStar(o),i=s.__importDefault(i);class a extends i.default{constructor(){super(),this.setUpdateChannelForType=(e,t)=>{this.signedChannelStates[e]=new r.SignedChannelState(t.appId,t.uniqueId,t.revision,t.token),this.boltClient.update_states(o.values(this.signedChannelStates)),this.boltClient.start()},this.handleUpdate=e=>{const t=[];e.forEach(e=>{const s=o.findKey(this.signedChannelStates,{app_id:e.app_id,unique_id:e.unique_id});s&&!t.includes(s)&&(this.emit("update",{type:s}),t.push(s))})},this.handleRefresh=()=>{this.boltClient.update_states(o.values(this.signedChannelStates))},this.boltClient=new r.BoltClient([],this.handleUpdate,this.handleRefresh),this.signedChannelStates={}}stop(){this.boltClient.unsubscribe()}}t.FolderOverviewLiveUpdateManager=a,t.folderOverviewLiveUpdateManager=new a})),define("modules/clean/react/folder_overview/logging",["require","exports","tslib","sjcl","immutable","modules/clean/filepath/filepath","modules/clean/logging/hive/schemas/web-user-action","modules/clean/logging/telemetry","modules/clean/react/folder_overview/data/selectors","modules/clean/react/folder_overview/data/store","modules/clean/react/folder_overview/utils","modules/clean/web_user_action_events"],(function(e,t,s,o,i,r,a,n,l,c,d,u){"use strict";function _(e){return e.blocks.map(e=>e.text.length).reduce((e,t)=>e+t,0)}function p(e){let t=i.OrderedSet();return t=t.merge(e.blocks.map(e=>e.type).filter(e=>"unstyled"!==e)),e.blocks.forEach(e=>e.inlineStyleRanges.forEach(e=>{t=t.add(e.style)})),e.blocks.forEach(s=>s.entityRanges.forEach(s=>{t=t.add(e.entityMap[s.key].type)})),t.toArray().sort()}Object.defineProperty(t,"__esModule",{value:!0}),t.logFolderOverviewAction=t.logOverviewEdited=t.makeOverviewResourceExtras=t.makeEditedData=t.extractNsIdAndPath=t.hashPath=t.hiveLogger=void 0,o=s.__importStar(o),r=s.__importStar(r),n=s.__importStar(n),l=s.__importStar(l),t.hiveLogger=new n.HiveLogger;const m=(e,t)=>{const s=l.folderDataCache(t)[e];return s&&s.contentReferences||[]},f=e=>{if(!e)return"";const t=o.hash.sha256.hash(e.toLowerCase());return o.codec.hex.fromBits(t)};t.hashPath=e=>(e||"/").split("/").map(f).join("/");const h=e=>{const t=r.normalize(e).split("/");return f(t.pop())};t.extractNsIdAndPath=e=>e?{nsId:d.extractSharedFolderId(e),nsPath:d.extractSharedFolderPath(e)}:{},t.makeEditedData=({folderFileId:e,loggingFileId:s,action_surface:o,retrievalSource:i})=>{const r=c.getStoreForFolderOverview().getState(),a=(function(e){const t=(function(e){const t={all:0,checked:0};if(!e)return t;return e.blocks.forEach(e=>{"task-block"===e.type&&(t.all+=1,e.data&&e.data.checked&&(t.checked+=1))}),t})(e);return{length:e?_(e):0,features:e?p(e):[],tasks:t.all,checkedTasks:t.checked}})(((e,t)=>{const s=l.folderDataCache(t)[e];if(s&&s.descriptionDraft)try{return JSON.parse(s.descriptionDraft)}catch(e){return}})(e,r)),n=t.makeOverviewResourceExtras({folderFileId:e,loggingFileId:s,action_surface:o,retrievalSource:i});if(n)return Object.assign(Object.assign({},n),{length:a.length.toString(),formatting:JSON.stringify(a.features),tasks:a.tasks.toString(),checkedTasks:a.checkedTasks.toString(),pins:JSON.stringify(m(e,r).map(e=>({file_id:e.ns_path?e.file_id:e.ns_id,file_obj_id:e.file_id,resource:{resource_title:h(e.fq_path),resource_type:e.is_dir?"SFJ_FOLDER":"SFJ_FILE",ns_id:`${e.ns_id}`,resource_path:t.hashPath(e.fq_path),resource_namespace_path:t.hashPath(e.ns_path)}})))})},t.makeOverviewResourceExtras=({folderFileId:e,loggingFileId:s,action_surface:o,retrievalSource:i})=>{const r=c.getStoreForFolderOverview().getState(),a=((e,t)=>{const s=l.fileIdCache(t);for(const t in s)if(s[t]===e)return t})(e,r);if(void 0===a)return;const{nsId:n,nsPath:d}=t.extractNsIdAndPath(l.nsIdCache(r)[a]);return n?{resource_type:"SFJ_FOLDER",resource_title:h(a),ns_id:n,resource_path:t.hashPath(a),resource_namespace_path:t.hashPath(d),file_id:(d?s:n)||null,file_obj_id:e,is_offline:"false",action_surface:o,retrieval_source:i}:void 0},t.logOverviewEdited=({folderFileId:e,loggingFileId:s,action_surface:o,retrievalSource:i})=>{const r=c.getStoreForFolderOverview().getState();t.logFolderOverviewAction(u.WebUserActionLogEvent.FOLDER_OVERVIEW_EDITED,l.user(r).id,null,t.makeEditedData({folderFileId:e,loggingFileId:s,action_surface:o,retrievalSource:i}))},t.logFolderOverviewAction=(e,s,o,i={})=>{let n={user_id:s,event_name:e};o&&(n=Object.assign(Object.assign({},n),{file_nsid:o.ns_id,file_sjid:o.sjid,file_id:o.file_id,file_name:r.filename(o.fq_path),file_path:o.fq_path,file_extension:o.ext})),t.hiveLogger.log(new a.WebUserActionRow(Object.assign(Object.assign({},n),{extra:Object.assign({},i)})))}})),define("modules/clean/react/folder_overview/utils",["require","exports","tslib","modules/clean/filepath/filepath","modules/clean/react/browse/models","modules/core/i18n","typescript/libraries/comments2/src/components/folder_overview_utils/index"],(function(e,t,s,o,i,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.canEditOverviewForFile=t.userInitials=t.fileToContentReferenceId=t.pathFromSharingFolder=t.extractSharedFolderPath=t.extractSharedFolderId=t.getFileExtension=t.convertContentReferencesToSortedFiles=t.hasUnsavedDescriptionDraft=t.normalizePath=t.convertDbxUserToIUser=void 0,o=s.__importStar(o),t.convertDbxUserToIUser=e=>({id:e.id.toString(),name:{display:e.display_name,initials:[e.fname.substr(0,1),e.lname.substr(0,1)].join(""),public:e.familiar_name},photoUrl:e.initials_url}),t.normalizePath=e=>o.normalize(e).toLowerCase(),t.hasUnsavedDescriptionDraft=e=>{if(!e)return!1;try{const t=void 0===e.description||""===e.description||a.isEmptyDescription(JSON.parse(e.description)),s=void 0===e.descriptionDraft||""===e.descriptionDraft||a.isEmptyDescription(JSON.parse(e.descriptionDraft));if(t&&s)return!1}catch(e){}return e.description!==e.descriptionDraft&&void 0!==e.descriptionDraft},t.convertContentReferencesToSortedFiles=e=>{const s=[];e.forEach(e=>{const o={file_id:e.file_id,fq_path:e.fq_path,href:e.href,icon:e.icon,is_cloud_doc:e.is_cloud_doc,is_dir:e.is_dir,thumbnail_url_tmpl:e.thumbnail_url_tmpl,ns_id:e.ns_id,ns_path:e.ns_path,sjid:e.sjid,isDeleted:e.is_deleted,ext:t.getFileExtension(e.fq_path)},r=new i.File(o);s.push(r)});const o=r.case_insensitive_comparator(!0);return s.sort((e,t)=>o(i.File.getFilename(e),i.File.getFilename(t)))},t.getFileExtension=e=>{if(!e)return"";const t=o.file_extension(e);return t?`.${t}`:""},t.extractSharedFolderId=e=>{const t=/^ns:([0-9]+)\/?/.exec(e);return t?t[1]:void 0},t.extractSharedFolderPath=e=>{const t=/^ns:[0-9]+\/?(.*)/.exec(e);return t?t[1]:void 0},t.pathFromSharingFolder=(e,t)=>e.length>=t.length?o.filename(t):[o.filename(e),...t.substr(e.length).split("/").filter(e=>!!e)].join(" › "),t.fileToContentReferenceId=e=>e.is_dir&&e.target_ns?`ns:${e.target_ns}`:e.file_id;t.userInitials=e=>(e=>"fname"in e)(e)?e.fname.substr(0,1)+e.lname.substr(0,1):e.name.given_name.substr(0,1)+e.name.surname.substr(0,1),t.canEditOverviewForFile=e=>(!e.is_dir||!e.isDeleted)&&(e.target_ns?!e._mount_access_perms||!(!e._mount_access_perms||!e._mount_access_perms.includes("can_edit")):!e.read_only)})),define("modules/clean/react/folder_subscriptions/customization/query_param_filter",["require","exports","tslib","react","modules/clean/history","modules/clean/react/folder_subscriptions/data/types"],(function(e,t,s,o,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.QueryParamFilter=void 0,o=s.__importStar(o),i=s.__importDefault(i),t.QueryParamFilter=({children:e})=>{const[t,s]=o.useState(i.default.deconstruct_url().qargs[r.FOLLOW_MODAL_QUERY_PARAM]);return o.useEffect(()=>{function e(e,t){s(t[r.FOLLOW_MODAL_QUERY_PARAM])}const t="/"+i.default.get_url().split(/[/?]/)[1];return i.default.add_callback(t,e),()=>{i.default.remove_callback(t,e)}},[t]),void 0===t||Array.isArray(t)?null:o.default.cloneElement(e,{param:t})},t.QueryParamFilter.displayName="QueryParamFilter"})),define("modules/clean/react/folder_subscriptions/data/types",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ActionTypes=t.FolderSubscriptionState=t.RequestFlightStatus=t.Frequencies=t.FOLLOW_MODAL_QUERY_PARAM=void 0,t.FOLLOW_MODAL_QUERY_PARAM="manage_folder_subscription",t.Frequencies={INSTANT:{".tag":"instant"},DAILY:{".tag":"daily"}},(function(e){e.IDLE="idle",e.READY="ready",e.INFLIGHT="inflight",e.ERROR="error"})(t.RequestFlightStatus||(t.RequestFlightStatus={})),(function(e){e.FOLLOWING="FOLLOWING",e.FOLLOWING_PARENT="FOLLOWING_PARENT",e.NOT_FOLLOWING="NOT_FOLLOWING"})(t.FolderSubscriptionState||(t.FolderSubscriptionState={})),(function(e){e.FETCHING_FOLDER_SUBSCRIPTION="FOLDER_SUBSCRIPTION/FETCHING_FOLDER_SUBSCRIPTION",e.OPTIMISTIC_SET_FOLDER_SUBSCRIPTION="FOLDER_SUBSCRIPTION/OPTIMISTIC_SET_FOLDER_SUBSCRIPTION",e.CONFIRM_FOLDER_SUBSCRIPTION="FOLDER_SUBSCRIPTION/CONFIRM_FOLDER_SUBSCRIPTION",e.ERROR_FOLDER_SUBSCRIPTION="FOLDER_SUBSCRIPTION/ERROR_FOLDER_SUBSCRIPTION"})(t.ActionTypes||(t.ActionTypes={}))})),define("modules/clean/react/folder_subscriptions/data/action_creators",["require","exports","tslib","modules/clean/react/browse/action_logger","modules/clean/react/browse/constants","modules/clean/react/browse/data/selectors","modules/clean/react/browse/logger_util","modules/clean/react/files_view/data/selectors/instance_selectors","modules/clean/react/folder_subscriptions/data/api","modules/clean/react/folder_subscriptions/data/selectors","modules/clean/react/folder_subscriptions/data/types","modules/clean/react/folder_subscriptions/follow/snackbar","modules/clean/web_user_action_events"],(function(e,t,s,o,i,r,a,n,l,c,d,u,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.editFolderSubscription=t.deleteFolderSubscriptionFromEmail=t.deleteFolderSubscription=t.createFolderSubscription=t.logAction=t.FolderSubscriptionOrigin=t.fetchFolderSubscription=void 0,r=s.__importStar(r),a=s.__importStar(a),n=s.__importStar(n),l=s.__importStar(l),c=s.__importStar(c);const p=(e,t,s)=>{e({type:d.ActionTypes.CONFIRM_FOLDER_SUBSCRIPTION,payload:{folderSubscription:s,path:t,timestamp:new Date}})},m=(e,t,s)=>{e({type:d.ActionTypes.ERROR_FOLDER_SUBSCRIPTION,payload:{folderSubscription:s,path:t}})};var f;t.fetchFolderSubscription=e=>(t,o)=>s.__awaiter(void 0,void 0,void 0,(function*(){const s=o(),i=r.user(s).id;c.getRequestState(s,e).status!==d.RequestFlightStatus.INFLIGHT&&(((e,t)=>{e({type:d.ActionTypes.FETCHING_FOLDER_SUBSCRIPTION,payload:{path:t}})})(t,e),l.getFolderSubscription(e,i).then(s=>p(t,e,s),()=>m(t,e)))})),(function(e){e.Email="email",e.SideMenu="side_menu",e.Thumbnail="thumbnail"})(f=t.FolderSubscriptionOrigin||(t.FolderSubscriptionOrigin={})),t.logAction=(e,t,s,l)=>{var d,u;const _=r.user(t).id,p=r.selectedFiles(t),{num_files_selected:m,num_folders_selected:f}=a.countFilesAndFolders(p),h=c.folderSubscription(t,s),g=null===(d=null==h?void 0:h.settings)||void 0===d?void 0:d.activity_types;o.logBrowseAction({action:e,uid:_,num_files_selected:m,num_folders_selected:f,view_type:n.selectViewType(t,{instanceId:i.BROWSE_FILES_VIEW_ID}),extra:{ns_id:l.ns_id.toString(),origin:l.origin||null,frequency:(null===(u=null==h?void 0:h.settings)||void 0===u?void 0:u.frequency[".tag"])||null,file_add:g?g.file_added.toString():null,file_delete:g?g.file_deleted.toString():null}})};const h=({dispatch:e,getState:s,path:o,newValue:i,apiUpdate:r,onSuccess:a,onError:n})=>{const l=s(),u=c.folderSubscription(l,o);return((e,t,s)=>{e({type:d.ActionTypes.OPTIMISTIC_SET_FOLDER_SUBSCRIPTION,payload:{folderSubscription:s,path:t}})})(e,o,i),r().then(t=>{p(e,o,i),a(t)},()=>{m(e,o,u),e(t.fetchFolderSubscription(o)),n()})};t.createFolderSubscription=(e,s,o)=>(i,a)=>{const n=a(),p=r.user(n).id;if(c.folderSubscriptionState(n,e)===d.FolderSubscriptionState.NOT_FOLLOWING)return h({dispatch:i,getState:a,path:e,newValue:{subscriptionState:d.FolderSubscriptionState.FOLLOWING,followingPath:e,settings:s},apiUpdate:()=>l.createFolderSubscription(e,s,p),onSuccess:()=>{u.showSetOptionsConfirmationSnackbar(e),t.logAction(_.WebUserActionLogEvent.FOLLOW_FOLDER,a(),e,o)},onError:()=>u.showSetOptionsErrorSnackbar(e)})},t.deleteFolderSubscription=(e,s)=>(o,i)=>{const a=i(),n=r.user(a).id;if(c.folderSubscriptionState(a,e)===d.FolderSubscriptionState.FOLLOWING)return h({dispatch:o,getState:i,path:e,newValue:{subscriptionState:d.FolderSubscriptionState.NOT_FOLLOWING},apiUpdate:()=>l.deleteFolderSubscription(e,n),onSuccess:()=>{u.showUnfollowConfirmationSnackbar(e),t.logAction(_.WebUserActionLogEvent.UNFOLLOW_FOLDER,i(),e,s)},onError:()=>u.showUnfollowErrorSnackbar(e)})},t.deleteFolderSubscriptionFromEmail=(e,s)=>(o,i)=>{const a=i(),n=r.user(a).id;return l.deleteFolderSubscription(e,n).then(()=>{u.showUnfollowConfirmationSnackbar(e),t.logAction(_.WebUserActionLogEvent.UNFOLLOW_FOLDER,a,e,{ns_id:s,origin:f.Email})},()=>u.showUnfollowErrorSnackbar(e))},t.editFolderSubscription=(e,s,o)=>(i,a)=>{const n=a(),p=r.user(n).id;if(c.folderSubscriptionState(n,e)===d.FolderSubscriptionState.FOLLOWING)return h({dispatch:i,getState:a,path:e,newValue:{subscriptionState:d.FolderSubscriptionState.FOLLOWING,followingPath:e,settings:s},apiUpdate:()=>l.editFolderSubscription(e,s,p),onSuccess:()=>{u.showSetOptionsConfirmationSnackbar(e),t.logAction(_.WebUserActionLogEvent.EDIT_FOLDER_FOLLOW_SETTINGS,a(),e,o)},onError:()=>u.showSetOptionsErrorSnackbar(e)})}})),define("modules/clean/react/folder_subscriptions/data/api",["require","exports","tslib","api_v2/user_client","modules/clean/react/folder_subscriptions/data/types"],(function(e,t,s,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.editFolderSubscription=t.deleteFolderSubscription=t.createFolderSubscription=t.getFolderSubscription=void 0;t.getFolderSubscription=function(e,t){return s.__awaiter(this,void 0,void 0,(function*(){return(new o.UserApiV2Client).ns("awareness_subscriptions").rpc("folder_subscriptions/get",{identifier:e},{subjectUserId:t}).then((s=e,({subscription:e})=>{if(!e)return{subscriptionState:i.FolderSubscriptionState.NOT_FOLLOWING};const t=e.fq_path;return t!==s?{subscriptionState:i.FolderSubscriptionState.FOLLOWING_PARENT,followingPath:t}:{subscriptionState:i.FolderSubscriptionState.FOLLOWING,followingPath:t,settings:e.settings}}));var s}))},t.createFolderSubscription=function(e,t,i){return s.__awaiter(this,void 0,void 0,(function*(){return(new o.UserApiV2Client).ns("awareness_subscriptions").rpc("folder_subscriptions/create",{identifier:e,settings:t},{subjectUserId:i})}))},t.deleteFolderSubscription=function(e,t){return s.__awaiter(this,void 0,void 0,(function*(){return(new o.UserApiV2Client).ns("awareness_subscriptions").rpc("folder_subscriptions/delete",{identifier:e},{subjectUserId:t})}))},t.editFolderSubscription=function(e,t,i){return s.__awaiter(this,void 0,void 0,(function*(){return(new o.UserApiV2Client).ns("awareness_subscriptions").rpc("folder_subscriptions/edit",{identifier:e,settings:t},{subjectUserId:i})}))}})),define("modules/clean/react/folder_subscriptions/data/reducer",["require","exports","tslib","immutable","modules/clean/react/folder_subscriptions/data/types"],(function(e,t,s,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.folderSubscriptionsReducer=t.defaultFolderSubscriptionsState=void 0,o=s.__importStar(o),t.defaultFolderSubscriptionsState={requests:o.Map(),folderSubscriptions:o.Map()},t.folderSubscriptionsReducer=function(e=t.defaultFolderSubscriptionsState,s){switch(s.type){case i.ActionTypes.OPTIMISTIC_SET_FOLDER_SUBSCRIPTION:return(function(e,t){const{path:s,folderSubscription:o}=t.payload;return Object.assign(Object.assign({},e),{requests:e.requests.set(s,{status:i.RequestFlightStatus.INFLIGHT}),folderSubscriptions:e.folderSubscriptions.set(s,o)})})(e,s);case i.ActionTypes.FETCHING_FOLDER_SUBSCRIPTION:return(function(e,t){const{path:s}=t.payload;return Object.assign(Object.assign({},e),{requests:e.requests.set(s,{status:i.RequestFlightStatus.INFLIGHT})})})(e,s);case i.ActionTypes.CONFIRM_FOLDER_SUBSCRIPTION:return(function(e,t){const{path:s,folderSubscription:o,timestamp:r}=t.payload;return Object.assign(Object.assign({},e),{requests:e.requests.set(s,{status:i.RequestFlightStatus.READY,lastUpdated:r}),folderSubscriptions:e.folderSubscriptions.set(s,o)})})(e,s);case i.ActionTypes.ERROR_FOLDER_SUBSCRIPTION:return(function(e,t){const{path:s,folderSubscription:o}=t.payload;return Object.assign(Object.assign({},e),{requests:e.requests.set(s,{status:i.RequestFlightStatus.ERROR}),folderSubscriptions:o?e.folderSubscriptions.set(s,o):e.folderSubscriptions})})(e,s)}return e}})),define("modules/clean/react/folder_subscriptions/data/selectors",["require","exports","modules/clean/redux/selectors","modules/clean/redux/namespaces","modules/clean/react/folder_subscriptions/data/types","modules/clean/react/folder_subscriptions/data/reducer"],(function(e,t,s,o,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.folderSubscriptions=t.folderSubscription=t.folderSubscriptionState=t.getRequestState=t.getFolderSubscriptionsState=void 0,t.getFolderSubscriptionsState=e=>s.getStateAtNamespace(e,o.FOLDER_SUBSCRIPTIONS_NAMESPACE_KEY)||r.defaultFolderSubscriptionsState,t.getRequestState=(e,s)=>t.getFolderSubscriptionsState(e).requests.get(s,{status:i.RequestFlightStatus.IDLE}),t.folderSubscriptionState=(e,s)=>{var o;return null===(o=t.folderSubscription(e,s))||void 0===o?void 0:o.subscriptionState},t.folderSubscription=(e,s)=>t.folderSubscriptions(e).get(s),t.folderSubscriptions=e=>t.getFolderSubscriptionsState(e).folderSubscriptions})),define("modules/clean/react/folder_subscriptions/data/store",["require","exports","modules/clean/react/folder_subscriptions/data/reducer","modules/clean/redux/store","modules/clean/redux/namespaces"],(function(e,t,s,o,i){"use strict";let r;Object.defineProperty(t,"__esModule",{value:!0}),t.getStoreForFolderSubscriptions=void 0,t.getStoreForFolderSubscriptions=()=>(r||(r=o.getStoreAndRegisterReducers({[i.FOLDER_SUBSCRIPTIONS_NAMESPACE_KEY]:s.folderSubscriptionsReducer})),r)})),define("modules/clean/react/folder_subscriptions/follow/snackbar",["require","exports","tslib","react","modules/clean/filepath/filepath","modules/clean/react/snackbar","modules/core/i18n"],(function(e,t,s,o,i,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.showFollowFailedSnackbar=t.showUnfollowErrorSnackbar=t.showUnfollowConfirmationSnackbar=t.showSetOptionsErrorSnackbar=t.showSetOptionsConfirmationSnackbar=t.showFolderSubscriptionSnackbar=void 0,o=s.__importDefault(o);const n=a.intl.formatMessage({id:"JBINyn",defaultMessage:"Close"}),l=a.intl.formatMessage({id:"Wzr+Eu",defaultMessage:"Unfollow"});function c({callToActionFn:e,isSuccess:t,message:s}){const i=t?"complete":"fail",a=t&&e?l:void 0,c=t?e:void 0,d=t&&e?void 0:n,u=o.default.createElement(r.Snackbar,{title:s,variant:i,actionButtonText:a,onActionClick:c,closeButtonText:d,timeoutDelayMs:5e3,id:"browse-action"});r.Snackbar.show(u)}t.showFolderSubscriptionSnackbar=c,t.showSetOptionsConfirmationSnackbar=function(e){c({isSuccess:!0,message:a.intl.formatMessage({id:"74emIA",defaultMessage:'Notification options for "{folderName}" have been set'},{folderName:i.filename(e)})})},t.showSetOptionsErrorSnackbar=function(e){c({isSuccess:!1,message:a.intl.formatMessage({id:"fwZe/f",defaultMessage:'Couldn\'t set options for "{folderName}"'},{folderName:i.filename(e)})})},t.showUnfollowConfirmationSnackbar=function(e){c({isSuccess:!0,message:a.intl.formatMessage({id:"nQncys",defaultMessage:'You’ll no longer get notifications about "{folderName}"'},{folderName:i.filename(e)})})},t.showUnfollowErrorSnackbar=function(e){c({isSuccess:!1,message:a.intl.formatMessage({id:"/QEApB",defaultMessage:'Unable to unfollow "{folderName}"'},{folderName:i.filename(e)})})},t.showFollowFailedSnackbar=function(e){c({isSuccess:!1,message:a.intl.formatMessage({id:"0G1Llb",defaultMessage:'Unable to follow "{folderName}"'},{folderName:e})})}})),define("modules/clean/react/browse/actions",["require","exports","tslib","immutable","modules/clean/file_actions/create-folder","modules/clean/file_operations/notifications","modules/clean/filepath/filepath","modules/clean/flux/dispatcher","modules/clean/history","modules/clean/react/async_file_modal_controller","modules/clean/react/browse/api","modules/clean/react/browse/constants","modules/clean/react/browse/data/action_creators/index","modules/clean/react/browse/data/action_creators/file_actions","modules/clean/react/browse/data/selectors","modules/clean/react/browse/data/store","modules/clean/react/file_uploader/constants","modules/clean/react/files_view/types","modules/clean/react/snackbar","modules/clean/sharing/browse_exports","modules/core/i18n","modules/clean/react/browse/fss_experiment_carousel_util","modules/clean/react/browse/model_types"],(function(e,t,s,o,i,r,a,n,l,c,d,u,_,p,m,f,h,g,S,E,T,b,w){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.browseActions=void 0,o=s.__importStar(o),r=s.__importStar(r),a=s.__importStar(a),l=s.__importDefault(l),c=s.__importStar(c),d=s.__importStar(d),_=s.__importStar(_),p=s.__importStar(p),m=s.__importStar(m);t.browseActions=new class{constructor(){this.initializeEverything=({path:t,files:i,paginatedTotalNumFiles:r,context:l,mountPoints:c,fqPathsToSelect:d,loadingState:p,teamFolders:m,currentFolderInfo:f})=>s.__awaiter(this,void 0,void 0,(function*(){this.reduxStore.dispatch(_.setPath({path:t})),this.reduxStore.dispatch(_.appendFiles({path:t,files:[...i,...m],currentFolderInfo:f})),this.reduxStore.dispatch(_.setPaginatedTotalNumFiles({paginatedTotalNumFiles:r})),this.reduxStore.dispatch(_.setMountPoints({mountPoints:c})),this.reduxStore.dispatch(_.setLoadingState({loadingState:p,path:t})),p===g.LoadingState.LOADED?this.reduxStore.dispatch(_.selectFilesByFqPath({fqPathsToSelect:d})):this.reduxStore.dispatch(_.setFilePathsToSelectOnNextUpdate({filePathsToSelectOnNextUpdate:o.Set(d)})),this.reduxStore.dispatch(_.setContext({context:l})),this.reduxStore.dispatch(_.setCurrentFolderInfo({currentFolderInfo:f})),n.Dispatcher.dispatch({type:h.UploaderActionType.SET_PATH,data:{path:t,hasPermissionToUploadToFolder:l.isCurrentPathWriteable(),isMovingIntoVault:l.isInsideVaultFolder}}),n.Dispatcher.dispatch({type:u.SharedWithActionType.BROWSE_FILES_LOADED,data:{parentPath:t,files:i}});const{ActionsAdapter:S}=yield new Promise((t,s)=>{e(["modules/clean/react/file_uploader/actions_adapter"],t,s)}).then(s.__importStar);S.on("uploadComplete",({filesAdded:e})=>{if(!e||0===e.length)return;const t=e.map(e=>a.normalize(e.path)+a.normalize(e.name));this.selectFilesAfterUpload({fqPathsToSelect:t})})})),this.addFilesAndSetLoadingState=({path:e,loadingState:t,files:s,paginatedTotalNumFiles:o})=>{this.reduxStore.dispatch(_.appendFiles({path:e,files:s})),this.reduxStore.dispatch(_.setPaginatedTotalNumFiles({paginatedTotalNumFiles:o})),this.reduxStore.dispatch(_.setLoadingState({loadingState:t,path:e})),n.Dispatcher.dispatch({type:u.SharedWithActionType.BROWSE_FILES_LOADED,data:{parentPath:e,files:s}})},this.setUrl=({path:e,qargs:t,expandedBlade:s,forceExpandRightRail:o})=>{this.reduxStore.dispatch(_.setUrl({path:e,qargs:t,expandedBlade:s,forceExpandRightRail:o}))},this.nameNewFolder=()=>{this.reduxStore.dispatch(_.setNewFolderCreationState({newFolderCreationState:g.NewFolderCreationState.PENDING_INPUT}))},this.createFolderPending=()=>{i.logCreateFolderPending(),this.reduxStore.dispatch(_.setNewFolderCreationState({newFolderCreationState:g.NewFolderCreationState.SAVING_INPUT}))},this.cancelCreateFolder=e=>{i.logCreateFolderCancel(e),this.reduxStore.dispatch(_.setNewFolderCreationState({newFolderCreationState:g.NewFolderCreationState.CREATE_FOLDER_INACTIVE}))},this.createFolderComplete=()=>{i.logCreateFolderSuccess(),this.reduxStore.dispatch(_.setNewFolderCreationState({newFolderCreationState:g.NewFolderCreationState.CREATE_FOLDER_INACTIVE})),S.Snackbar.complete(T.intl.formatMessage({id:"a26imc",defaultMessage:"Folder created."}),"browse-action")},this.createFolder=e=>{this.reduxStore.dispatch(_.createFolder(e))},this.createFolderInNewFolderModal=({folderName:e,isConfidential:s,user:o,context:i,redirectOnSuccess:r,redirectOnCancel:a,fqPath:n,selectCreatedFolder:l,origin:c,shouldSuppressRedirectToBrowse:d,handleSuccessSharing:u,handleCancelSharing:_})=>{const p=i?i.currentFQPath:n,m=i?i.rootNSID:o.root_ns_id;if(s&&i&&!i.isInsideTeamFolderTree)E.asyncShowNewFolderShareModal({defaultBasePath:p,initialContentName:e,onCancel:_,onSuccessSharing:u,setUrl:this.setUrl,shouldSuppressRedirectToBrowse:d,user:o});else{const n=(o.is_cdm_member||s)&&!!i&&i.isInsideTeamFolderTree;t.browseActions.createFolder({pathName:p,folderName:e,nsId:m,checkFSWs:!1,showShareModalOnSuccess:n?this.handleShowShareModal:null,redirectOnSuccess:r,redirectOnCancel:a,selectCreatedFolder:l,origin:c,user:o})}},this.handleNewFolderRedirectOnSuccess=e=>{this.setUrl({path:e})},this.doDeleteFilesWithModal=({files:e})=>{const t=m.user(this.reduxStore.getState()),o=m.context(this.reduxStore.getState());c.showDelete(t,e,o,a.filename(o.currentFQPath),()=>s.__awaiter(this,void 0,void 0,(function*(){this.reduxStore.dispatch(p.deleteFiles({files:[...e],checkFSWs:!0}))})))},this.purgeSuccessCallback=e=>{t.browseActions.reloadCurrentPath()},this.onPurgeBatch=(t,o)=>{new Promise((t,s)=>{e(["modules/clean/react/trash/actions"],t,s)}).then(s.__importStar).then(({purgeByPathBatch:e})=>{e(t,o,this.purgeSuccessCallback)})},this.doPermanentDeleteWithModal=e=>{const t=m.user(this.reduxStore.getState()),s=m.context(this.reduxStore.getState());c.showPurgeModal({userId:t.id,context:s,files:e,onPurge:this.onPurgeBatch})},this.onRestore=(e,t,s)=>{d.restoreFiles({files:t,userId:e,onSuccess:()=>{r.notifyRestoreSuccess(t)},isSearchMode:s})},this.doRestoreFilesWithUnifiedTrashModal=({files:e})=>{const t=m.user(this.reduxStore.getState()),s=m.context(this.reduxStore.getState());c.showUnifiedTrashModal({userId:t.id,context:s,files:e,onRestore:(e,t)=>{this.onRestore(e,t,!1)}})},this.handleShowRewindPanel=()=>{l.default.update_query_param(u.BrowseQueryArg.rewind,"true"),this.reduxStore.dispatch(_.showRewind())},this.fetchFolderSizes=({file:e})=>s.__awaiter(this,void 0,void 0,(function*(){const t=m.user(this.reduxStore.getState());let s=u.MAX_FOLDER_SIZE_ITERATIONS;try{this.reduxStore.dispatch(_.requestFolderSizes({fqPath:e.fq_path}));const o=yield d.fetchSharedFolderSizes(t.id,{fq_path:e.fq_path});this.reduxStore.dispatch(_.setFolderSizesPending({fetchFolderSizesResp:o}));let i=[],r=yield this.fetchAndSetSameNamespaceFolderSize(t.id,{fq_path:e.fq_path,folder_limit:u.MAX_FOLDERS_PER_CALL});for(r.queue&&(i=[...i,...r.queue]);i.length>0&&s>0;){s--;const o=Math.min(u.MAX_FOLDER_SIZE_QUEUE_SIZE,i.length),a=i.splice(0,o);r=yield this.fetchAndSetSameNamespaceFolderSize(t.id,{fq_path:e.fq_path,folder_limit:u.MAX_FOLDERS_PER_CALL,queue:a}),r.queue&&i&&(i=[...i,...r.queue])}const a=0!==s&&r.queue&&0===r.queue.length?w.FetchFolderSizeState.COMPLETE:w.FetchFolderSizeState.ERROR;this.reduxStore.dispatch(_.completeFolderSizes({fetchFolderSizeState:a}))}catch(t){this.reduxStore.dispatch(_.setFolderSizesPending({fetchFolderSizesResp:{sizes_dict:[{fq_path:e.fq_path,size:0}],queue:[]}})),this.reduxStore.dispatch(_.completeFolderSizes({fetchFolderSizeState:w.FetchFolderSizeState.ERROR}))}})),this.fetchMultipleFolderSizes=({files:e})=>s.__awaiter(this,void 0,void 0,(function*(){for(const t of e.toArray())yield this.fetchFolderSizes({file:t})})),this.handleShowShareModal=(e,t)=>{const s=m.user(this.reduxStore.getState()),o=m.context(this.reduxStore.getState());E.asyncShowShareModal(s,e,{browseContext:o,origin:t,onCancel:()=>{b.asyncShowFssExpr(s,e.ns_id,e.ns_path,e.is_dir)},onSuccessSharing:()=>{b.asyncShowFssExpr(s,e.ns_id,e.ns_path,e.is_dir)}},this.setUrl)},this.showOnboardingChecklistShareButtonTooltip=e=>{this.reduxStore.dispatch(_.showOnboardingChecklistShareButtonTooltip(e))},this.reduxStore=f.getStoreForBrowse()}reloadCurrentPath(){this.setUrl({path:m.path(this.reduxStore.getState()),qargs:{reload:!0}})}selectRowsFromBoltClient(e=[]){this.reduxStore.dispatch(_.setFilePathsToSelectOnNextUpdate({filePathsToSelectOnNextUpdate:o.Set(e.map(e=>e.fq_path))}))}selectFilesAfterUpload({fqPathsToSelect:e}){const t=m.unsortedFilesWithFolderSizes(this.reduxStore.getState());e.every(e=>t.has(e))?this.reduxStore.dispatch(_.selectFilesByFqPath({fqPathsToSelect:e})):this.reduxStore.dispatch(_.setFilePathsToSelectOnNextUpdate({filePathsToSelectOnNextUpdate:o.Set(e)}))}selectFilesByFqPath({fqPathsToSelect:e}){this.reduxStore.dispatch(_.selectFilesByFqPath({fqPathsToSelect:e}))}setShouldShowDeletedFiles({shouldShowDeletedFiles:e}){e?l.default.update_query_param(u.BrowseQueryArg.d,"1"):l.default.remove_query_param(u.BrowseQueryArg.d)}fetchAndSetSameNamespaceFolderSize(e,t){return s.__awaiter(this,void 0,void 0,(function*(){const s=yield d.fetchSameNamespaceFolderSizes(e,t);return this.reduxStore.dispatch(_.setFolderSizesPending({fetchFolderSizesResp:s})),s}))}}})),define("modules/clean/react/browse/api",["require","exports","tslib","lodash","modules/clean/deprecated_ajax/ajax","api_v2/user_client","modules/clean/filepath/filepath","modules/clean/react/browse/models","modules/core/assert","modules/core/html","modules/core/i18n","modules/core/notify","modules/core/uri","modules/clean/sharing/api/client"],(function(e,t,s,o,i,r,a,n,l,c,d,u,_,p){"use strict";function m(e){try{return JSON.parse(e)}catch(e){if(!(e instanceof SyntaxError))throw e}return null}function f(e){if(void 0===e)return{};const t={};for(const s of e)void 0!==s.ns_id&&void 0!==s.mount_point&&(t[s.ns_id]=s.mount_point);return t}Object.defineProperty(t,"__esModule",{value:!0}),t.getFolderMemberCounts=t.fetchSameNamespaceFolderSizes=t.fetchSharedFolderSizes=t.getChangesForDirectory=t.createCloudDoc=t.rollbackChangeSets=t.restoreFiles=t.moveFiles=t.isRewindButtonEnabled=t.copyFiles=t.loadPath2Continue=t.loadPath2=void 0,o=s.__importStar(o),i=s.__importStar(i),a=s.__importStar(a),t.loadPath2=function(e){var t,o,i,a;return s.__awaiter(this,void 0,void 0,(function*(){const{userId:s,rootNsId:c,path:d,sortType:u,sortIsAscending:_,includeDeleted:p}=e,m=new r.UserApiV2Client,h=yield m.ns("files").rpc("browse",{root_ns_id:c,fq_path:d,include_deleted:p,sort_type:u,sort_is_ascending:_,sort_folders_first:!0,include_xattrs:!0,include_folder_overview:!0},{subjectUserId:s});return l.assert(void 0!==h.context,"context is undefined"),l.assert(void 0!==h.paginated_file_info,"paginated_file_info is undefined"),l.assert(void 0!==h.total_count,"total_count is undefined"),{folderOverview:null!==(t=h.folder_overview)&&void 0!==t?t:null,mountPoints:f(h.context.ns_id_infos),context:n.BrowseContext.fromApiV2Object(h.context),items:h.paginated_file_info.map(e=>e.file_info),hasMore:null!==(o=h.has_more)&&void 0!==o&&o,nextRequestVoucher:null!==(i=h.next_request_voucher)&&void 0!==i?i:null,paginatedTotalNumFiles:h.total_count,currentFolderInfo:null===(a=h.folder_info)||void 0===a?void 0:a.file_info}}))},t.loadPath2Continue=function(e,t){return(new r.UserApiV2Client).ns("files").rpc("browse_continue",{cursor:e},{subjectUserId:t})},t.copyFiles=function(e){const{files:t,newPath:s,userId:o,onSuccess:r,checkFSWs:a}=e,l=t.map(e=>e.fq_path);return l.includes(s)?(u.Notify.error(d.intl.formatMessage({id:"wWiDtY",defaultMessage:"You can’t copy a folder into itself."})),!1):(i.WebProgressRequest({url:"/cmd/copy",data:{files:l,to_path:s,fsw_request:a?"check":void 0},dataType:"text",subject_user:o,progress_text:d.intl.formatMessage({id:"AZPIG5",defaultMessage:"Copying files..."}),success(e,t){try{const e=JSON.parse(t),o=e.new_browse_files?e.new_browse_files.map(n.File.fromServerObject):[];r({newFiles:o,destinationPath:s,changesets:e.changesets,failureDetails:e.failure_details})}catch(e){}}}),!0)},t.isRewindButtonEnabled=function(e,t){return s.__awaiter(this,void 0,void 0,(function*(){try{return"/"===e&&(e=""),(new r.UserApiV2Client).ns("chronicle").rpc("can_rewind",{path:e,version:2},{subjectUserId:t})}catch(e){return{can_rewind:!1}}}))},t.moveFiles=function(e){const{path:t,files:s,newPath:o,userId:r,onSuccess:l,allowOwnershipTransfer:_,checkFSWs:p}=e;if(void 0!==t&&a.paths_are_equal(t,o))return u.Notify.error(d.intl.formatMessage({id:"V6/bVk",defaultMessage:"Those files already exist in that folder."})),!1;const m=s.map(e=>e.fq_path);return m.includes(o)?(u.Notify.error(d.intl.formatMessage({id:"blAaiJ",defaultMessage:"You can’t move a folder into itself."})),!1):(i.WebProgressRequest({url:"/cmd/move",data:{files:m,to_path:o,allow_ownership_transfer:_,fsw_request:p?"check":void 0},dataType:"text",subject_user:r,progress_text:d.intl.formatMessage({id:"FdTkAn",defaultMessage:"Moving files..."}),skipNotifyError:!_,success(e,s){try{const e=JSON.parse(s),i=e.new_browse_files?e.new_browse_files.map(n.File.fromServerObject):[];l({path:t,destinationPath:o,newFiles:i,changesets:e.changesets,failureDetails:e.failure_details})}catch(e){}},error:(t,s,o)=>{u.Notify.error(new c.HTML(o.message)),e.onError&&e.onError(o.message)}}),!0)},t.restoreFiles=function(e){const{files:t,userId:s,onSuccess:o,isSearchMode:r}=e;i.WebProgressRequest({url:"/cmd/restore",data:{files:t.map(e=>e.fq_path),source:r?"search":"browse"},dataType:"text",subject_user:s,progress_text:d.intl.formatMessage({id:"kBkLSN",defaultMessage:"Restoring…"}),success(){o()}})},t.rollbackChangeSets=function(e){const{userId:t,changesets:s=null,progressText:o,onSuccess:r}=e;i.WebProgressRequest({url:"/cmd/rollback",data:{ns_to_cs:JSON.stringify(s)},dataType:"text",subject_user:t,progress_text:o,success(){r()}})},t.createCloudDoc=function(e){const{pathName:t,title:s,documentType:o,userId:r,onSuccess:a,onError:l,checkFSWs:c,actionSource:d}=e,u=`${t}/${s}.${o}`.replace("//","/");i.WebRequest({url:new _.URI({path:"/cmd/create_cloud_doc"}).toString(),subject_user:r,data:{to_path:u,title:s,fsw_request:c?"check":void 0,action_source:d},dataType:"text",success(e,t){const s=m(t);if(s){const e=s.new_browse_files?n.File.fromServerObject(s.new_browse_files[0]):null;a({changesets:null,createdFile:e,failureDetails:s.failure_details})}},error(e,t,s){l(s.message)},skipNotifyError:!0})},t.getChangesForDirectory=function(e){const{path:t,userId:s,namespaceToJournalIdMap:r,onSuccess:a,includeDeletedFiles:n}=e,l={fq_dir:"/"===t?"":t,ns_map:o.map(r,(e,t)=>`${t}_${e}`).join(","),show_deleted:!!n},c=new AbortController;return i.WebRequest({url:"/update/list_dir",subject_user:s,data:l,dataType:"text",signal:c.signal,success(e,t){const s=m(t);s&&a(s)}}),c},t.fetchSharedFolderSizes=function(e,t){return(new r.UserApiV2Client).ns("folders").rpc("get_shared_subfolder_sizes",t,{subjectUserId:e})},t.fetchSameNamespaceFolderSizes=function(e,t){return(new r.UserApiV2Client).ns("folders").rpc("get_subfolder_sizes_in_same_namespace",t,{subjectUserId:e})},t.getFolderMemberCounts=function(e,t){return s.__awaiter(this,void 0,void 0,(function*(){try{const s=new p.FolderShareApiClient({userId:t,client:new r.UserApiV2Client}),o=yield s.getMemberCounts({contentId:e});return o?o.total_unique_users:0}catch(e){return 0}}))}})),define("modules/clean/react/browse/async_extensions",["require","exports","tslib","modules/clean/web_timing_logger","modules/clean/redux/store"],(function(e,t,s,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.asyncExtensions=void 0;t.asyncExtensions=new class{constructor(){this.initOnce=!1,this.emptyState={},this.sharingServiceInfo=()=>this.emptyState,this.getFeatureFlags=()=>this.emptyState,this.initializeStore=(e,t)=>(this.files=t,this.user=e,i.getStoreAndRegisterReducers({}))}init(){this.initOnce||(o.waitForTTI().then(()=>this.loadExtensionsStore()),this.initOnce=!0)}loadExtensionsStore(){return s.__awaiter(this,void 0,void 0,(function*(){const[{getStore:t,initializeStore:o},{sharingServiceInfo:i,getFeatureFlags:r}]=yield Promise.all([new Promise((t,s)=>{e(["modules/clean/react/extensions/data/store"],t,s)}).then(s.__importStar),new Promise((t,s)=>{e(["modules/clean/react/extensions/data/selectors"],t,s)}).then(s.__importStar)]);t(),this.sharingServiceInfo=i,this.getFeatureFlags=r,this.initializeStore=o,this.user&&this.initializeStore(this.user,this.files)}))}}})),define("modules/clean/react/browse/crypto_subtle_digest",["require","exports","tslib"],(function(e,t,s){"use strict";function o(e){if(t.windowHasCryptoSubtleDigest())return new Promise(t=>{window.crypto.subtle.digest("SHA-256",e).then(t)});throw new Error("window.crypto.subtle.digest not available")}Object.defineProperty(t,"__esModule",{value:!0}),t.hashString=t.encryptArrayBuffer=t.windowHasCryptoSubtleDigest=void 0,t.windowHasCryptoSubtleDigest=()=>!!window.crypto.subtle&&!!window.crypto.subtle.digest,t.encryptArrayBuffer=o,t.hashString=function(e){return s.__awaiter(this,void 0,void 0,(function*(){if(!t.windowHasCryptoSubtleDigest()||void 0===window.TextEncoder||void 0===window.TextDecoder)return null;try{const t=yield o((new TextEncoder).encode(e));return new TextDecoder("utf-16").decode(t)}catch(e){return null}}))}})),define("modules/clean/react/browse/data/action_creators/index",["require","exports","tslib","lodash","immutable","dropbox/proto/hql_events/browse/web_browse","spectrum-sharing/utils/sharing_constants","modules/clean/file_actions/create-folder","modules/clean/filepath/filepath","modules/clean/filetypes","modules/clean/flux/dispatcher","modules/clean/history","modules/clean/tagging/experiments","modules/clean/hql/index","modules/clean/react/browse/action_logger","modules/clean/react/browse/api","modules/clean/react/browse/async_extensions","modules/clean/react/browse/constants","modules/clean/react/browse/crypto_subtle_digest","modules/clean/react/browse/data/folder_overview_selectors","modules/clean/react/browse/data/helpers","modules/clean/react/browse/data/selectors","modules/clean/react/browse/data/types","modules/clean/react/browse/logger_util","modules/clean/react/browse/models","modules/clean/react/browse/uri_helper","modules/clean/react/file_uploader/constants","modules/clean/react/files_view/data/action_creators","modules/clean/react/files_view/data/selectors/instance_selectors","modules/clean/react/files_view/file_actions/file_from_metadata","modules/clean/react/files_view/types","modules/clean/react/files_view/sort_types","modules/clean/react/folder_overview/data/action_creators","modules/clean/react/selection","modules/clean/react/snackbar","modules/clean/redux/tests/store","modules/clean/tagging/experiments","modules/clean/web_user_action_events","modules/constants/trademark","modules/core/exception","modules/core/i18n","modules/core/uri","modules/clean/react/browse/right_rail_preferences","modules/clean/tagging/data/action_creators","modules/clean/sync_everything/constants"],(function(e,t,s,o,i,r,a,n,l,c,d,u,_,p,m,f,h,g,S,E,T,b,w,I,v,O,C,F,R,A,y,D,L,M,N,P,U,x,k,V,W,B,H,j,G){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setCreateMenuOpenRequest=t.setBackupFolders=t.setOverflowMenuCloseRequest=t.setInlineOverflowMenuOpenRequest=t.setOverflowMenuCoordinates=t.setOverflowMenuOpenRequest=t.expandBlade=t.setFileHasAutomatedRuleMap=t.setRightRailIsCollapsed=t.setHideFilesAndSidebar=t.setViewType=t.showOnboardingChecklistShareButtonTooltip=t.showPersonalizationSuggestedFolders=t.setArePostTTIModulesLoaded=t.setIsFileViewerShown=t.appendFiles=t.applyBoltUpdates=t.completeFolderSizes=t.setFolderSizesPending=t.requestFolderSizes=t.setUnsortedFiles=t.setAndStoreSortOrder=t.setShouldShowDeletedFiles=t.clearSelection=t.setSelection=t.setPathData=t.setPath=t.setUrl=t.setPaginatedTotalNumFiles=t.setNewFolderCreationState=t.setMountPoints=t.setLoadingState=t.setFolderSizes=t.createFolder=t.refreshPinnedItems=t.toggleSpacesEntryPoint=t.hideFolderHistoryPanel=t.showFolderHistoryPanel=t.hideRewind=t.showRewind=t.setFolderMemberCounts=t.setIsRewindButtonEnabled=t.setFilePathsToSelectOnNextUpdate=t.resetFileJumpFilter=t.addFileJumpKeyCode=t.setBrowsePostTTIData=t.setBrowsePostTTIExperiments=t.setCurrentFolderInfo=t.setContext=t.pasteFilesFromClipboard=t.setFilesToClipboard=t.setCanDisplayFolderSizes=t.selectFilesByFqPath=t.popBoltIgnore=t.pushBoltIgnore=t.handleAppCleanup=t.appInit=void 0,o=s.__importStar(o),i=s.__importStar(i),n=s.__importStar(n),l=s.__importStar(l),u=s.__importDefault(u),f=s.__importStar(f),E=s.__importStar(E),b=s.__importStar(b),I=s.__importStar(I),F=s.__importStar(F),R=s.__importStar(R),H=s.__importStar(H),t.appInit=({props:e,user:t,viewer:s})=>o=>{o({type:w.ActionTypes.APP_INIT,payload:{props:e,user:t,viewer:s}}),o(F.loadScopedSortOrders({user:t,defaultSort:{sortField:D.SortField.FILENAME,sortDirection:D.SortDirection.ASCENDING}})),d.Dispatcher.dispatch({type:C.UploaderActionType.SET_USER,data:{user:t}})},t.handleAppCleanup=()=>({type:w.ActionTypes.HANDLE_APP_CLEANUP}),t.pushBoltIgnore=e=>({type:w.ActionTypes.PUSH_BOLT_IGNORE,payload:e}),t.popBoltIgnore=e=>({type:w.ActionTypes.POP_BOLT_IGNORE,payload:e}),t.selectFilesByFqPath=({fqPathsToSelect:e})=>({type:w.ActionTypes.SELECT_FILES_BY_FQ_PATH,payload:{fqPathsToSelect:e}}),t.setCanDisplayFolderSizes=({canDisplayFolderSizes:e})=>({type:w.ActionTypes.SET_CAN_DISPLAY_FOLDER_SIZES,payload:{canDisplayFolderSizes:e}});const q=({clipboard:e})=>({type:w.ActionTypes.SET_CLIPBOARD_FILES,payload:{clipboard:e}});t.setFilesToClipboard=({clipboard:e})=>t=>{const{files:s}=e;s.length&&(s.some(e=>e.isDeleted||e.is_unmounted)?N.Snackbar.fail(W.intl.formatMessage({id:"jdnaZR",defaultMessage:"Deleted files cannot be added to the clipboard"}),"browse-clipboard-copy"):s.some(v.File.isTeamSharedFolder)||s.some(v.File.isTeamMemberFolder)?N.Snackbar.fail(W.intl.formatMessage({id:"0Nkg/N",defaultMessage:"Team Folders cannot be added to the clipboard"}),"browse-clipboard-copy"):s.some(v.File.isFamilySharedFolder)?N.Snackbar.fail(W.intl.formatMessage({id:"KMcV0/",defaultMessage:"Family shared folders cannot be added to the clipboard"}),"browse-clipboard-copy"):s.some(e=>e.type===c.FileTypes.VAULT_FOLDER)?N.Snackbar.fail(W.intl.formatMessage({id:"La991r",defaultMessage:"{TRADEMARK_VAULT} cannot be added to the clipboard"},{TRADEMARK_VAULT:k.TRADEMARK_VAULT}),"browse-clipboard-copy"):(N.Snackbar.complete(W.intl.formatMessage({id:"BvUPS9",defaultMessage:"{count, plural, one{Added {count} item to clipboard.} other{Added {count} items to clipboard.}}"},{count:s.length}),"browse-clipboard-copy"),t(q({clipboard:e}))))},t.pasteFilesFromClipboard=({copyFiles:e,moveFiles:t})=>(s,o)=>{const i=o(),r=b.user(i),{files:a,action:n}=b.clipboard(o()),c=b.path(o());a.length<=0||("cut"===n?(l.paths_are_equal(l.parent_dir(a[0].fq_path),c)||t({user:r,files:a,newPath:"/"===c?"":c,checkFSWs:!0,synchronousSingleFileActions:!!b.postTTIExperiments(o()).expSynchronousSingleFileActions}),s(q({clipboard:{files:[]}}))):e({user:r,files:a,newPath:c,checkFSWs:!0,isPasteAction:!0,synchronousSingleFileActions:Boolean(b.postTTIExperiments(o()).expSynchronousSingleFileActions),onSuccess:e=>{}}))},t.setContext=({context:e})=>({type:w.ActionTypes.SET_CONTEXT,payload:{context:e}}),t.setCurrentFolderInfo=({currentFolderInfo:e})=>({type:w.ActionTypes.SET_CURRENT_FOLDER_INFO,payload:{currentFolderInfo:e}}),t.setBrowsePostTTIExperiments=({browsePostTTIExperiments:e})=>({type:w.ActionTypes.SET_BROWSE_POST_TTI_EXPERIMENTS,payload:{browsePostTTIExperiments:e}}),t.setBrowsePostTTIData=({browsePostTTIData:e})=>{const t=Object.assign({},e);return Object.keys(t).forEach(e=>{void 0===t[e]&&delete t[e]}),{type:w.ActionTypes.SET_BROWSE_POST_TTI_DATA,payload:{browsePostTTIData:t}}};const z=({fileJumpFilter:e})=>({type:w.ActionTypes.SET_FILE_JUMP_FILTER,payload:{fileJumpFilter:e}});t.addFileJumpKeyCode=({keyChar:e})=>(s,o)=>{const i=b.fileJumpFilter(o())+e.toLowerCase();s(z({fileJumpFilter:i}));let r=null;const a=b.fileJumpIndex(o());for(const{fqPath:e,filename:t}of a)if(t>=i){r=e;break}null!=r&&s(t.selectFilesByFqPath({fqPathsToSelect:[r]}))},t.resetFileJumpFilter=()=>(e,t)=>{m.logKeyboardShortcutUsage({user_id:b.user(t()).id,keyboard_shortcut_type:"jump",view_type:R.selectViewType(t(),{instanceId:g.BROWSE_FILES_VIEW_ID})}),e(z({fileJumpFilter:""}))},t.setFilePathsToSelectOnNextUpdate=({filePathsToSelectOnNextUpdate:e})=>({type:w.ActionTypes.SET_FILE_PATHS_TO_SELECT_ON_NEXT_UPDATE,payload:{filePathsToSelectOnNextUpdate:e}}),t.setIsRewindButtonEnabled=e=>(t,o)=>s.__awaiter(void 0,void 0,void 0,(function*(){const{path:s,userId:o,userSkuHasRewind:i}=e;if(!i)return void t({type:w.ActionTypes.SET_IS_REWIND_ENABLED,payload:{value:!0}});const r=yield f.isRewindButtonEnabled(s,o);t({type:w.ActionTypes.SET_IS_REWIND_ENABLED,payload:{value:!!r.can_rewind}})})),t.setFolderMemberCounts=e=>(t,o)=>s.__awaiter(void 0,void 0,void 0,(function*(){const{contentId:s,userId:o}=e,i=yield f.getFolderMemberCounts(s,o);t({type:w.ActionTypes.SET_FOLDER_MEMBER_COUNTS,payload:{value:i}})})),t.showRewind=()=>({type:w.ActionTypes.SHOW_TIMELINE,payload:{timestamp:(new Date).getTime()}}),t.hideRewind=()=>({type:w.ActionTypes.HIDE_TIMELINE,payload:{}}),t.showFolderHistoryPanel=()=>({type:w.ActionTypes.SHOW_FOLDER_HISTORY_PANEL,payload:{timestamp:(new Date).getTime()}}),t.hideFolderHistoryPanel=()=>({type:w.ActionTypes.HIDE_FOLDER_HISTORY_PANEL,payload:{}}),t.toggleSpacesEntryPoint=({value:e})=>({type:w.ActionTypes.TOGGLE_SPACES_ENTRY_POINT,payload:{value:e}}),t.refreshPinnedItems=()=>(e,t)=>s.__awaiter(void 0,void 0,void 0,(function*(){const s=E.folderOverviewFolderFileId(t());e(L.reloadContentReferences({folderFileId:s,componentNamespace:g.BrowseFolderOverviewComponentNamespace}))})),t.createFolder=({pathName:e,folderName:o,user:i,checkFSWs:r,showShareModalOnSuccess:l,redirectOnSuccess:c,redirectOnCancel:d,selectCreatedFolder:u=!0,origin:_})=>(p,m)=>s.__awaiter(void 0,void 0,void 0,(function*(){p(t.setNewFolderCreationState({newFolderCreationState:y.NewFolderCreationState.SAVING_INPUT}));const s=yield n.createFolder({destination:e,name:o,user:i,checkFsw:r,origin:_,surface:"browse"});if(p(t.setNewFolderCreationState({newFolderCreationState:y.NewFolderCreationState.CREATE_FOLDER_INACTIVE})),"success"===s.type){const e=A.folderFromFolderMetadata(s.folder);u&&p(t.selectFilesByFqPath({fqPathsToSelect:[e.fq_path]})),c&&c(e.fq_path),l&&l(e,a.SHARE_ACTION_ORIGIN_TYPE.BROWSE_NEW_FOLDER_MODAL)}else d&&d()})),t.setFolderSizes=({folderSizes:e})=>({type:w.ActionTypes.SET_FOLDER_SIZES,payload:{folderSizes:e}}),t.setLoadingState=({loadingState:e,path:t})=>({type:w.ActionTypes.SET_LOADING_STATE,payload:{loadingState:e,path:t}}),t.setMountPoints=({mountPoints:e})=>({type:w.ActionTypes.SET_MOUNT_POINTS,payload:{mountPoints:e}}),t.setNewFolderCreationState=({newFolderCreationState:e})=>({type:w.ActionTypes.SET_NEW_FOLDER_CREATION_STATE,payload:{newFolderCreationState:e}}),t.setPaginatedTotalNumFiles=({paginatedTotalNumFiles:e})=>({type:w.ActionTypes.SET_PAGINATED_TOTAL_NUM_FILES,payload:{paginatedTotalNumFiles:e}}),t.setUrl=({path:e="",qargs:s,expandedBlade:i="info",forceExpandRightRail:r=!1})=>(a,n)=>{u.default.push_state(b.urlPrefix(n())+B.URI.encode_parts(e),o.omitBy(Object.assign(Object.assign({},o.pick(O.getQueryArgs(),["d"])),s),o.isUndefined)),a(t.clearSelection({skipLogging:!0})),a(t.expandBlade(i)),r&&a(t.setRightRailIsCollapsed(!1))},t.setPath=({path:e})=>(t,o)=>s.__awaiter(void 0,void 0,void 0,(function*(){t({type:w.ActionTypes.SET_PATH,payload:{path:e}});const s=yield S.hashString(e);s||V.reportException({err:new Error("hashString returned null"),tags:["browse"],severity:V.SEVERITY.NONCRITICAL}),t({type:w.ActionTypes.SET_VIEW_SCOPE,payload:{viewScope:s}}),e&&(document.title=G.isBackupBrowse()?W.intl.formatMessage({id:"IePl0Y",defaultMessage:"{folder_name} - Dropbox Backup"},{folder_name:l.filename(e,W.intl.formatMessage({id:"UwzCW9",defaultMessage:"Backups"}))}):W.intl.formatMessage({id:"dbYCaa",defaultMessage:"{folder_name} - Dropbox"},{folder_name:l.filename(e,W.intl.formatMessage({id:"bObFEu",defaultMessage:"Files"}))}))})),t.setPathData=({path:e,files:s,paginatedTotalNumFiles:o,context:r,currentFolderInfo:a})=>(n,c)=>{if(!l.paths_are_equal(e,b.path(c())))return;const u=i.Map(s.map(e=>[e.fq_path,e]));n(t.setContext({context:r})),n(t.setCurrentFolderInfo({currentFolderInfo:a})),t.setUnsortedFiles({unsortedFiles:u})(n,c,P.mockExtraArguments),n(t.setPaginatedTotalNumFiles({paginatedTotalNumFiles:o})),n(t.clearSelection({skipLogging:!0})),K({unsortedFiles:u})(n,c,P.mockExtraArguments),U.isFetchTagsOnBrowseEnabled(b.manualTaggingVariant(c()))&&n(j.fetchTagsForFiles({user:b.user(c()),files:a?[...s,a]:[...s],override:!0})),setTimeout(()=>{d.Dispatcher.dispatch({type:g.SharedWithActionType.BROWSE_FILES_LOADED,data:{parentPath:e,files:s}}),d.Dispatcher.dispatch({type:C.UploaderActionType.SET_PATH,data:{path:e,hasPermissionToUploadToFolder:r.isCurrentPathWriteable(),isMovingIntoVault:r.isInsideVaultFolder}})},1)},t.setSelection=({selection:e,actionSource:t,skipLogging:s})=>(o,i)=>{if(!s){const s=i(),{event:o,itemId:a}=I.makeSelectionEvent(b.selection(s),e),n=b.selectFileByFullPath(s,{path:a}),{browseWebHqlPilot:l}=b.experiments(s);if(n){const{num_files_selected:a,num_folders_selected:c}=I.countFilesAndFolders(b.selectFilesForSelection(s,{selection:e}));l&&o===x.WebUserActionLogEvent.SELECT_ROW&&p.logEvent(r.hql_events.WebBrowseSelectRow.create({actionSource:t})),m.logBrowseAction({uid:b.user(s).id,action:o,action_source:t,num_files_selected:a,num_folders_selected:c,view_type:R.selectViewType(i(),{instanceId:g.BROWSE_FILES_VIEW_ID}),result:n,extra:{entity_type:n.is_dir?"folder":"file"}})}}o({type:w.ActionTypes.SET_SELECTION,payload:{selection:e,actionSource:t}}),Y(o,i,e)},t.clearSelection=({actionSource:e,skipLogging:s}={})=>t.setSelection({actionSource:e,skipLogging:s,selection:M.createSelection()}),t.setShouldShowDeletedFiles=({shouldShowDeletedFiles:e})=>({type:w.ActionTypes.SET_SHOULD_SHOW_DELETED_FILES,payload:{shouldShowDeletedFiles:e}});t.setAndStoreSortOrder=e=>(t,s)=>{const o=s(),i=b.user(o);m.logSortRecords({uid:i.id,sort_by:e.sortField,sort_direction:e.sortDirection,view_type:R.selectViewType(o,{instanceId:g.BROWSE_FILES_VIEW_ID})}),t(F.setSort({user:i,sort:e,viewScope:R.selectViewTypeScope(o,{instanceId:g.BROWSE_FILES_VIEW_ID}),updateGlobalScope:!0})),t((({sortOrder:e})=>({type:w.ActionTypes.SET_SORT_ORDER,payload:{sortOrder:e}}))({sortOrder:e}))},t.setUnsortedFiles=({unsortedFiles:e})=>(t,o)=>s.__awaiter(void 0,void 0,void 0,(function*(){const s=b.user(o());t({type:w.ActionTypes.SET_UNSORTED_FILES,payload:{unsortedFiles:e}}),h.asyncExtensions.initializeStore(s,e.toArray())})),t.requestFolderSizes=({fqPath:e})=>({type:w.ActionTypes.REQUEST_FOLDER_SIZES,payload:{fqPath:e}}),t.setFolderSizesPending=({fetchFolderSizesResp:e})=>({type:w.ActionTypes.SET_FOLDER_SIZES_PENDING,payload:{fetchFolderSizesResp:e}}),t.completeFolderSizes=({fetchFolderSizeState:e})=>({type:w.ActionTypes.COMPLETE_FOLDER_SIZES,payload:{fetchFolderSizeState:e}}),t.applyBoltUpdates=({path:e,updates:s})=>(o,i)=>{const{parent_changes:r}=s,a=b.user(i());if(l.paths_are_equal(e,b.path(i()))){if(r&&r.change_to_fq_path)return T.showUserNotificationForPathChange(a,r),void t.setUrl({path:r.change_to_fq_path})(o,i,P.mockExtraArguments);(function(e,s,o){const{mount_points:i}=o,r=b.path(s()),[a,n]=T.getMountPointUpdateForCurrentPath(i,r,b.mountPoints(s()));a&&!n&&N.Snackbar.complete(W.intl.formatMessage({id:"QB9ZqK",defaultMessage:"The folder was unshared."}),"browse-unshare");const l=T.getPathForNewMountPoint(a,n,r);if(l)return void e(t.setPath({path:l}));e(t.setMountPoints({mountPoints:i}))})(o,i,s),(function(e,s,o){const{added:i,moved:r,removed:a}=o,n=b.path(s());let c=b.unsortedFiles(s()),u=b.folderSizes(s()),_=c.size;const p={added:new Set([]),moved:new Set([]),removed:new Set([])};e(t.popBoltIgnore(p)),c=c.withMutations(e=>{u=u.withMutations(t=>{const s=t=>{(e=>l.paths_are_equal(l.parent_dir(e.fq_path),n))(t)&&(e.set(t.fq_path,v.File.fromServerObject(t)),_+=1)},o=(o,i)=>{const r=e.get(o);if(r&&r.sjid>=i.sjid&&o===i.fq_path)return;e.remove(o),s(i);const a=t.get(o);a&&(t.remove(o),t.set(i.fq_path,a))},c=s=>{e.remove(s),t.remove(s),_-=1};for(const t of i)e.has(t.fq_path)?o(t.fq_path,t):s(t);for(const[t,i]of r)e.has(t)?o(t,i):s(i);for(const t of a){const s=e.find(e=>e.fq_path.toLowerCase()===t.toLowerCase());s&&c(s.fq_path)}})}),c.size!==_&&V.reportException({err:new Error("applyBoltUpdates ended up with unexpected number of items"),tags:["browse_file_collections_mismatch"],severity:V.SEVERITY.CRITICAL,exc_extra:{expected_unsorted_files_size:_,actual_unsorted_files_size:c.size,is_deleted_files_on:b.shouldShowDeletedFiles(s()),filesAdded:i,filesRemoved:a,filesMove:r}});c!==b.unsortedFiles(s())&&(t.setUnsortedFiles({unsortedFiles:c})(e,s,P.mockExtraArguments),d.Dispatcher.dispatch({type:g.SharedWithActionType.BROWSE_FILES_UPDATED,data:{parentPath:n,files:c.toArray()}}));u!==b.folderSizes(s())&&e(t.setFolderSizes({folderSizes:u}));K({unsortedFiles:c})(e,s,P.mockExtraArguments)})(o,i,s),_.isTaggingEnabled(b.manualTaggingVariant(i()))&&(function(e,t,s,o){if(0===s.moved.length)return;const i=[];for(const e of s.moved){const{fq_path:s}=e[1],o=b.selectFileByFullPath(t(),{path:s});void 0!==o&&i.push(o)}e(j.fetchTagsForFiles({user:o,files:i}))})(o,i,s,a)}};const K=({unsortedFiles:e})=>(s,o)=>{const r=b.filePathsToSelectOnNextUpdate(o()).toArray(),a=r.filter(t=>e.has(t)),n=r.filter(t=>!e.has(t));0!==a.length&&(s(t.selectFilesByFqPath({fqPathsToSelect:a})),s(t.setFilePathsToSelectOnNextUpdate({filePathsToSelectOnNextUpdate:i.Set(n)})))};t.appendFiles=({path:e,files:s,currentFolderInfo:o})=>(r,a)=>{if(!l.paths_are_equal(e,b.path(a())))return;const n=b.unsortedFiles(a()).size,c=b.unsortedFiles(a()).merge(i.Map(s.map(e=>[e.fq_path,e])));t.setUnsortedFiles({unsortedFiles:c})(r,a,P.mockExtraArguments),K({unsortedFiles:c})(r,a,P.mockExtraArguments),U.isFetchTagsOnBrowseEnabled(b.manualTaggingVariant(a()))&&(o=null!=o?o:b.getCurrentFolderInfo(a()),r(j.fetchTagsForFiles({user:b.user(a()),files:o?[...s,o]:[...s],override:0===n}))),setTimeout(()=>{d.Dispatcher.dispatch({type:g.SharedWithActionType.BROWSE_FILES_LOADED,data:{parentPath:e,files:s}})},1),c.size!==n+s.length&&V.reportException({err:new Error("appendFiles ended up with unexpected number of files."),tags:["browse_file_collections_mismatch"],severity:V.SEVERITY.CRITICAL,exc_extra:{previous_unsorted_files_size:n,incoming_files_size:s.length,updated_unsorted_files_size:c.size,is_deleted_files_on:b.shouldShowDeletedFiles(a())}})},t.setIsFileViewerShown=({isShown:e})=>({type:w.ActionTypes.SET_IS_FILE_VIEWER_SHOWN,payload:{isShown:e}}),t.setArePostTTIModulesLoaded=({arePostTTIModulesLoaded:e})=>({type:w.ActionTypes.SET_ARE_POST_TTI_MODULES_LOADED,payload:{arePostTTIModulesLoaded:e}});const Y=(e,t,s)=>{if(!s||0===s.selected.count())return;const o=b.unsortedFiles(t()),i=null==o?void 0:o.filter(e=>s.selected.has(e.fq_path)&&!e.thumbnail_url_tmpl),r=[];if(null==i||i.forEach(e=>{r.push({file_id:e.file_id,sj_id:e.sjid,ns_id:e.ns_id})}),r.length>0){const s=b.user(t()).id;e(F.loadPreviewThumbnails(r,s,g.BROWSE_FILES_VIEW_ID))}};t.showPersonalizationSuggestedFolders=e=>({type:w.ActionTypes.SHOW_PERSONALIZATION_SUGGESTED_FOLDERS,payload:{showSuggestedFolders:e}}),t.showOnboardingChecklistShareButtonTooltip=e=>({type:w.ActionTypes.SHOW_ONBOARDING_CHECKLIST_SHARE_BUTTON_TOOLTIP,payload:{showOnboardingChecklistShareButtonTooltip:e}}),t.setViewType=e=>(t,s)=>{const o=s();t(F.setViewType({user:b.user(o),viewType:e,viewTypeScope:b.selectViewTypeScope(o),updateGlobalScope:!0}))},t.setHideFilesAndSidebar=({shouldHideFilesAndSidebar:e})=>({type:w.ActionTypes.SET_HIDE_FILES_AND_SIDEBAR,payload:{shouldHideFilesAndSidebar:e}}),t.setRightRailIsCollapsed=e=>(t,s)=>{const o=b.user(s());t({type:w.ActionTypes.SET_RIGHTRAIL_IS_COLLAPSED,payload:{collapsed:e}}),H.setIsCollapsed(o.id,e)},t.setFileHasAutomatedRuleMap=({fileHasAutomatedRuleMap:e})=>({type:w.ActionTypes.SET_FILE_HAS_AUTOMATED_RULE_MAP,payload:{fileHasAutomatedRuleMap:e}}),t.expandBlade=e=>({type:w.ActionTypes.SET_EXPANDED_BLADE,payload:{expandedBlade:e}}),t.setOverflowMenuOpenRequest=e=>({type:w.ActionTypes.SET_OVERFLOW_MENU_OPEN_REQUEST,payload:{overflowMenuOpenRequest:e}}),t.setOverflowMenuCoordinates=e=>({type:w.ActionTypes.SET_OVERFLOW_MENU_COORDINATES,payload:{overflowMenuCoordinates:e}}),t.setInlineOverflowMenuOpenRequest=e=>({type:w.ActionTypes.SET_INLINE_OVERFLOW_MENU_OPEN_REQUEST,payload:{inlineOverflowMenuOpenRequest:e}}),t.setOverflowMenuCloseRequest=e=>({type:w.ActionTypes.SET_OVERFLOW_MENU_CLOSE_REQUEST,payload:{overflowMenuCloseRequest:e}}),t.setBackupFolders=t=>(o,i)=>s.__awaiter(void 0,void 0,void 0,(function*(){if(null!==b.backupFolders(i()))return;const{fetchBackups:r}=yield new Promise((t,s)=>{e(["modules/clean/sync_everything/api"],t,s)}).then(s.__importStar),a=yield r(t);o({type:w.ActionTypes.SET_BACKUP_FOLDERS,payload:{backupFolders:a.map(e=>e.browsePath.substring(e.browsePath.indexOf("/",1)))}})})),t.setCreateMenuOpenRequest=e=>({type:w.ActionTypes.SET_CREATE_MENU_OPEN_REQUEST,payload:{createMenuOpenRequest:e}})})),define("modules/clean/react/browse/data/action_creators/file_actions",["require","exports","tslib","modules/clean/file_actions/metrics","modules/clean/file_actions/strings","modules/clean/filepath/filepath","modules/clean/metrics/index","modules/clean/react/async_file_modal_controller","modules/clean/react/browse/action_logger","modules/clean/react/browse/constants","modules/clean/react/browse/data/action_creators/index","modules/clean/react/browse/data/selectors","modules/clean/react/browse/logger_util","modules/clean/react/browse/models","modules/clean/react/files_view/data/action_creators","modules/clean/react/files_view/data/selectors/instance_selectors","modules/clean/react/files_view/file_actions/api_v2","modules/clean/react/files_view/file_actions/file_from_metadata","modules/clean/react/files_view/file_actions/rollback","modules/clean/react/files_view/file_actions/snackbars","modules/clean/react/files_view/types","modules/clean/tagging/data/action_creators","modules/clean/react/snackbar","modules/clean/undo","modules/clean/web_user_action_events","modules/core/i18n","modules/clean/react/browse/data/selectors"],(function(e,t,s,o,i,r,a,n,l,c,d,u,_,p,m,f,h,g,S,E,T,b,w,I,v,O,C){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.renameFile=t.renameUndo=t.deleteFiles=void 0,r=s.__importStar(r),n=s.__importStar(n),u=s.__importStar(u),_=s.__importStar(_),m=s.__importStar(m),f=s.__importStar(f),h=s.__importStar(h),E=s.__importStar(E),C=s.__importStar(C);const F=({state:e,eventName:t,num_files_selected:s,num_folders_selected:o,batch_success_count:i,batch_fail_count:r,lookup_error_type:a,error_summary:n})=>{l.logBrowseAction({uid:u.user(e).id,action:t,num_files_selected:s,num_folders_selected:o,view_type:f.selectViewType(e,{instanceId:c.BROWSE_FILES_VIEW_ID}),batch_success_count:i,batch_fail_count:r,lookup_error_type:a,error_summary:n})};t.deleteFiles=({files:e,checkFSWs:l})=>(c,m)=>s.__awaiter(void 0,void 0,void 0,(function*(){const f=u.user(m()),g=u.path(m()),T=u.shouldShowDeletedFiles(m()),b=a.getMetricsReporter(),C={surface:"browse",batchSizeBucket:o.bucketForBatchSize(e.length),contentType:o.batchContentType(e)},R=b.createTimer({ns:o.FILE_ACTIONS_AMP_NAMESPACE,name:"delete/batch/latency_total_ms"},C),A=Date.now(),y=b.createStats({ns:o.FILE_ACTIONS_AMP_NAMESPACE,name:"delete/batch/latency_average_ms"},C),D=b.createStats({ns:o.FILE_ACTIONS_AMP_NAMESPACE,name:"delete/batch/completed"},C);w.Snackbar.sync(O.intl.formatMessage(i.deleteSnackbarProgressMessage,{count:e.length}),!0,"browse-action"),1!==e.length||T||c(d.pushBoltIgnore({removed:new Set([e[0].fq_path])})),F({state:m(),eventName:v.WebUserActionLogEvent.DELETE_REQUEST_ATTEMPT,num_files_selected:e.length,num_folders_selected:0});const L=yield h.deleteFiles(e,f.id,l);if(L.isError&&"path"===L.error[".tag"]&&"file_system_warnings"===L.error.path[".tag"])return void c((({files:e,details:o})=>(r,a)=>s.__awaiter(void 0,void 0,void 0,(function*(){w.Snackbar.close("browse-action"),n.showFileSystemWarningsModal({fsws:o,onFinalAccept:()=>{r(t.deleteFiles({files:e,checkFSWs:!1}))},confirmText:O.intl.formatMessage(i.deleteFswConfirmText)})})))({files:e,details:L.error.path.details}));if(R.record(),y.record((Date.now()-A)/e.length),L.isError)return c((({files:e,result:t})=>(o,i)=>s.__awaiter(void 0,void 0,void 0,(function*(){const s=u.shouldShowDeletedFiles(i());1!==e.length||s||o(d.popBoltIgnore({removed:new Set([e[0].fq_path])})),w.Snackbar.fail(E.deleteError(e.length,t.error),"browse-action");const r=u.selectedFiles(i()),{num_files_selected:a,num_folders_selected:n}=_.countFilesAndFolders(r);F({state:i(),eventName:v.WebUserActionLogEvent.DELETE_REQUEST_FAIL,num_files_selected:a,num_folders_selected:n,batch_success_count:0,batch_fail_count:e.length,error_summary:t.error_summary})})))({files:e,result:L})),void D.record(0);const M=L.result.entries.filter(e=>"success"===e[".tag"]);c((({pathAtRequestTime:e,successEntries:t})=>(o,i)=>s.__awaiter(void 0,void 0,void 0,(function*(){const s=u.shouldShowDeletedFiles(i());if(!r.paths_are_equal(u.path(i()),e))return;const a=t.map(e=>e.metadata.path_display),n=u.unsortedFiles(i()),l=a.reduce((e,t)=>{if(void 0===t)return e;const o=n.get(t);return s&&void 0!==o?e.set(t,new p.File(Object.assign(Object.assign({},o),{isDeleted:!0}))):e.delete(t)},n);o(d.setUnsortedFiles({unsortedFiles:l}))})))({pathAtRequestTime:g,successEntries:M}));const N=((e,t)=>()=>s.__awaiter(void 0,void 0,void 0,(function*(){w.Snackbar.close("browse-action"),F({state:e,eventName:v.WebUserActionLogEvent.DELETE_UNDO,num_files_selected:t.result.changeset_data.length,num_folders_selected:0}),S.rollback({changeset_data:t.result.changeset_data,userId:u.user(e).id,onSuccess:()=>{w.Snackbar.complete(O.intl.formatMessage(i.deleteUndoSnackbarMessage),"browse-action"),F({state:e,eventName:v.WebUserActionLogEvent.DELETE_UNDO_REQUEST_SUCCESS,num_files_selected:t.result.changeset_data.length,num_folders_selected:0})}})})))(m(),L);I.setHandleUndo(N);const P=L.result.entries.filter(h.isFailure),U=P[0];let x,k;if(void 0!==U){const e=U.failure;x=e[".tag"],h.isPathLookupFailure(e)&&(k=e.path_lookup[".tag"])}const V=L.result.entries.filter(e=>h.isFailure(e)&&!h.isPathLookupFailure(e.failure)).length;D.record(V>0?0:1),o.recordPathLookupErrors(P,"delete",C),P.length===L.result.entries.length?(w.Snackbar.fail(E.deleteCompleteError(P),"browse-action"),F({state:m(),eventName:v.WebUserActionLogEvent.DELETE_REQUEST_FAIL,num_files_selected:L.result.changeset_data.length,num_folders_selected:0,batch_success_count:L.result.entries.length-P.length,batch_fail_count:P.length,error_summary:x,lookup_error_type:k})):(w.Snackbar.completeWithUndo(E.deleteCompleteSuccess(e.length,M.length),N,"browse-action"),F({state:m(),eventName:v.WebUserActionLogEvent.DELETE_REQUEST_SUCCESS,num_files_selected:L.result.changeset_data.length,num_folders_selected:0,batch_success_count:L.result.entries.length,batch_fail_count:0,error_summary:x,lookup_error_type:k}))}));const R=(e,t,s,o)=>{const i=u.selectedFiles(e),{num_files_selected:r,num_folders_selected:a}=_.countFilesAndFolders(i);l.logBrowseAction({uid:u.user(e).id,action:t,num_files_selected:r,num_folders_selected:a,view_type:f.selectViewType(e,{instanceId:c.BROWSE_FILES_VIEW_ID}),result:s,error_summary:o})};t.renameUndo=({file:e,pathAtRequestTime:t,resultEntry:n,changeset:l})=>(c,_)=>s.__awaiter(void 0,void 0,void 0,(function*(){const s=u.user(_()),p=g.fileFromMetadata(e,n.success),m=a.getMetricsReporter(),f={surface:"browse",contentType:e.is_dir?"folders":"files",batchSizeBucket:"single"},S={latency:m.createTimer({ns:o.FILE_ACTIONS_AMP_NAMESPACE,name:"undo/latency_ms"},f),completed:m.createStats({ns:o.FILE_ACTIONS_AMP_NAMESPACE,name:"undo/completed"},f)};w.Snackbar.sync(O.intl.formatMessage(i.renameUndoSnackbarProgressMessage),!1,"browse-action"),c(d.pushBoltIgnore({added:new Set([e.fq_path]),removed:new Set([p.fq_path])})),R(_(),v.WebUserActionLogEvent.RENAME_UNDO,e);const E=yield h.undo(l,s);E.isError?(w.Snackbar.fail(O.intl.formatMessage(i.renameUndoSnackbarErrorMessage),"browse-action"),c(d.popBoltIgnore({added:new Set([e.fq_path]),removed:new Set([p.fq_path])})),R(_(),v.WebUserActionLogEvent.RENAME_UNDO_REQUEST_FAIL,e,E.error_summary),S.completed.record(0)):(w.Snackbar.complete(O.intl.formatMessage(i.renameUndoSnackbarSuccessMessage),"browse-action"),r.paths_are_equal(u.path(_()),t)&&(c(d.setUnsortedFiles({unsortedFiles:u.unsortedFiles(_()).remove(p.fq_path).set(e.fq_path,e)})),c(d.refreshPinnedItems())),c(d.selectFilesByFqPath({fqPathsToSelect:[e.fq_path]})),R(_(),v.WebUserActionLogEvent.RENAME_UNDO_REQUEST_SUCCESS,e),S.completed.record(1)),S.latency.record()})),t.renameFile=({file:e,name:l,checkFSWs:c,onSuccessSnackbarClose:_,synchronousSingleFileActions:p})=>(f,S)=>s.__awaiter(void 0,void 0,void 0,(function*(){const F=u.user(S()),A=u.path(S()),y=a.getMetricsReporter(),D={surface:"browse",contentType:e.is_dir?"folders":"files",synchronousSingleFileActions:p.toString()},L={latency:y.createTimer({ns:o.FILE_ACTIONS_AMP_NAMESPACE,name:"rename/latency_ms"},D),completed:y.createStats({ns:o.FILE_ACTIONS_AMP_NAMESPACE,name:"rename/completed"},D)};if(-1!==l.indexOf("/"))return w.Snackbar.fail(O.intl.formatMessage(i.renameErrorInvalidName),"browse-action"),void f(m.setFileRename({file:e,renameState:null}));f(m.setFileRename({file:e,renameState:T.RenameState.SAVING_INPUT})),w.Snackbar.sync(O.intl.formatMessage(i.renameSnackbarProgressMessage),!1,"browse-action");const M=yield h.renameFile(e.fq_path,l,F.id,{checkFSWs:c,synchronousSingleFileActions:p});if(M.isError&&"to"===M.error[".tag"]&&"file_system_warnings"===M.error.to[".tag"])return void f((({file:e,name:o,details:r})=>(a,l)=>s.__awaiter(void 0,void 0,void 0,(function*(){w.Snackbar.close("browse-action"),n.showFileSystemWarningsModal({fsws:r,onFinalAccept:()=>{a(t.renameFile({file:e,name:o,checkFSWs:!1,synchronousSingleFileActions:Boolean(C.postTTIExperiments(l()).expSynchronousSingleFileActions)}))},onAbortAction:()=>{a(m.setFileRename({file:e,renameState:null})),a(d.pushBoltIgnore({moved:new Set([e.fq_path])}))},confirmText:O.intl.formatMessage(i.renameFswConfirmText)})})))({file:e,name:l,details:M.error.to.details}));if(L.latency.record(),M.isError||"success"!==M.result.entries[0][".tag"]){const t=M.isError?M:h.createUndefinedRpcResult();return f((({file:e,result:t})=>(o,i)=>s.__awaiter(void 0,void 0,void 0,(function*(){o(d.pushBoltIgnore({moved:new Set([e.fq_path])})),o(m.setFileRename({file:e,renameState:null})),w.Snackbar.fail(E.renameError(t.error,e.fq_path),"browse-action"),R(i(),v.WebUserActionLogEvent.RENAME_REQUEST_FAIL,e,t.error_summary)})))({file:e,result:t})),L.completed.record(0),void y.createStats({ns:o.FILE_ACTIONS_AMP_NAMESPACE,name:"rename/error"},Object.assign(Object.assign({},D),{error:t.error[".tag"]})).record(1)}const N=M.result.entries[0],P=g.fileFromMetadata(e,N.success);r.paths_are_equal(u.path(S()),A)&&(f(d.setUnsortedFiles({unsortedFiles:u.unsortedFiles(S()).remove(e.fq_path).set(P.fq_path,P)})),f(b.fileRename({file:e,newFile:P})),f(d.refreshPinnedItems())),f(d.selectFilesByFqPath({fqPathsToSelect:[P.fq_path]})),f(m.setFileRename({file:e,renameState:null})),L.completed.record(1);const U=()=>{f(t.renameUndo({file:e,resultEntry:N,pathAtRequestTime:A,changeset:M.result.changeset_data}))};I.setHandleUndo(U),w.Snackbar.completeWithUndo(O.intl.formatMessage(i.renameSnackbarSuccessMessage),U,"browse-action",{onClosed:()=>{null==_||_(P)}}),R(S(),v.WebUserActionLogEvent.RENAME_REQUEST_SUCCESS,P)}))})),define("modules/clean/react/browse/data/reducer",["require","exports","tslib","immutable","modules/clean/filepath/filepath","modules/clean/react/browse/data/types","modules/clean/react/files_view/types","modules/core/assert","modules/clean/react/browse/right_rail_preferences","modules/clean/react/browse/model_types"],(function(e,t,s,o,i,r,a,n,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.browseReducer=void 0,o=s.__importStar(o),i=s.__importStar(i),l=s.__importStar(l),t.browseReducer=function(e=r.defaultBrowseState,t){switch(t.type){case r.ActionTypes.APP_INIT:return(function(e,t){const{props:o,user:i,viewer:r}=t.payload;n.assert(null===e.user,"Cannot reinitialize Browse store; changing invariants such as `user` is untested");const{browseExperiments:a}=o,c=s.__rest(o,["browseExperiments"]);return Object.assign(Object.assign(Object.assign(Object.assign({},e),{user:i,viewer:r,experiments:a}),c),{isRightRailCollapsed:l.getIsCollapsed(i.id)})})(e,t);case r.ActionTypes.PUSH_BOLT_IGNORE:return(function(e,t){let{added:s,moved:o,removed:i}=e.boltIgnore;return t.payload.added&&(s=new Set(s),t.payload.added.forEach(e=>s.add(e))),t.payload.moved&&(o=new Set(o),t.payload.moved.forEach(e=>o.add(e))),t.payload.removed&&(i=new Set(i),t.payload.removed.forEach(e=>i.add(e))),Object.assign(Object.assign({},e),{boltIgnore:{added:s,moved:o,removed:i}})})(e,t);case r.ActionTypes.POP_BOLT_IGNORE:return(function(e,t){let{added:s,moved:o,removed:i}=e.boltIgnore;return t.payload.added&&(s=new Set(s),t.payload.added.forEach(e=>s.delete(e))),t.payload.moved&&(o=new Set(o),t.payload.moved.forEach(e=>o.delete(e))),t.payload.removed&&(i=new Set(i),t.payload.removed.forEach(e=>i.delete(e))),Object.assign(Object.assign({},e),{boltIgnore:{added:s,moved:o,removed:i}})})(e,t);case r.ActionTypes.SELECT_FILES_BY_FQ_PATH:return(function(e,t){const{fqPathsToSelect:s}=t.payload,i=s.map(e=>e.toLowerCase()),r=e.unsortedFiles.toList().filter(e=>i.includes(e.fq_path.toLowerCase())).map(e=>e.fq_path),a=o.OrderedSet(r),n=r.size?r.get(0):null;return Object.assign(Object.assign({},e),{selection:e.selection.set("selected",a).set("anchor",n)})})(e,t);case r.ActionTypes.SET_CAN_DISPLAY_FOLDER_SIZES:return(function(e,t){const{canDisplayFolderSizes:s}=t.payload;return Object.assign(Object.assign({},e),{canDisplayFolderSizes:s})})(e,t);case r.ActionTypes.SET_CLIPBOARD_FILES:return(function(e,t){const{clipboard:s}=t.payload;return Object.assign(Object.assign({},e),{clipboard:s})})(e,t);case r.ActionTypes.SET_CONTEXT:return(function(e,t){const{context:s}=t.payload;return Object.assign(Object.assign({},e),{context:s})})(e,t);case r.ActionTypes.SET_CURRENT_FOLDER_INFO:return(function(e,t){const{currentFolderInfo:s}=t.payload;return Object.assign(Object.assign({},e),{currentFolderInfo:s})})(e,t);case r.ActionTypes.SET_FILE_HAS_AUTOMATED_RULE_MAP:return(function(e,t){return Object.assign(Object.assign({},e),{fileHasAutomatedRuleMap:e.fileHasAutomatedRuleMap.merge(t.payload.fileHasAutomatedRuleMap)})})(e,t);case r.ActionTypes.SET_FILE_JUMP_FILTER:return(function(e,t){const{fileJumpFilter:s}=t.payload;return Object.assign(Object.assign({},e),{fileJumpFilter:s})})(e,t);case r.ActionTypes.SET_FILE_PATHS_TO_SELECT_ON_NEXT_UPDATE:return(function(e,t){const{filePathsToSelectOnNextUpdate:s}=t.payload;return Object.assign(Object.assign({},e),{filePathsToSelectOnNextUpdate:s})})(e,t);case r.ActionTypes.SET_FOLDER_SIZES:return(function(e,t){const{folderSizes:s}=t.payload;return Object.assign(Object.assign({},e),{folderSizes:s})})(e,t);case r.ActionTypes.SET_LOADING_STATE:return(function(e,t){const{loadingState:s,path:r}=t.payload;return i.paths_are_equal(r,e.path)?s===a.LoadingState.LOADED?Object.assign(Object.assign({},e),{loadingState:s,filePathsToSelectOnNextUpdate:o.Set()}):Object.assign(Object.assign({},e),{loadingState:s}):e})(e,t);case r.ActionTypes.SET_MOUNT_POINTS:return(function(e,t){const{mountPoints:s}=t.payload;return Object.assign(Object.assign({},e),{mountPoints:o.Map(s)})})(e,t);case r.ActionTypes.SET_NEW_FOLDER_CREATION_STATE:return(function(e,t){const{newFolderCreationState:s}=t.payload;return Object.assign(Object.assign({},e),{newFolderCreationState:s})})(e,t);case r.ActionTypes.SET_PAGINATED_TOTAL_NUM_FILES:return(function(e,t){const{paginatedTotalNumFiles:s}=t.payload;return Object.assign(Object.assign({},e),{paginatedTotalNumFiles:s})})(e,t);case r.ActionTypes.SET_PATH:return(function(e,t){const{path:s}=t.payload;return Object.assign(Object.assign({},e),{path:s})})(e,t);case r.ActionTypes.SET_SELECTION:return(function(e,t){const{selection:s}=t.payload;return Object.assign(Object.assign({},e),{selection:s})})(e,t);case r.ActionTypes.SET_SHOULD_SHOW_DELETED_FILES:return(function(e,t){const{shouldShowDeletedFiles:s}=t.payload;return Object.assign(Object.assign({},e),{shouldShowDeletedFiles:s})})(e,t);case r.ActionTypes.SET_UNSORTED_FILES:return(function(e,t){const{unsortedFiles:s}=t.payload;return Object.assign(Object.assign({},e),{unsortedFiles:s})})(e,t);case r.ActionTypes.SHOW_TIMELINE:return(function(e,t){return Object.assign(Object.assign({},e),{isRewindVisible:!0,clickRewindTimestamp:t.payload.timestamp})})(e,t);case r.ActionTypes.HIDE_TIMELINE:return(function(e,t){return Object.assign(Object.assign({},e),{isRewindVisible:!1})})(e);case r.ActionTypes.SHOW_FOLDER_HISTORY_PANEL:return(function(e,t){return Object.assign(Object.assign({},e),{isFolderHistoryVisible:!0,clickFolderHistoryTimestamp:t.payload.timestamp})})(e,t);case r.ActionTypes.HIDE_FOLDER_HISTORY_PANEL:return(function(e,t){return Object.assign(Object.assign({},e),{isFolderHistoryVisible:!1})})(e);case r.ActionTypes.SET_IS_FILE_VIEWER_SHOWN:return(function(e,t){return Object.assign(Object.assign({},e),{isFileViewerShown:t.payload.isShown})})(e,t);case r.ActionTypes.SET_IS_REWIND_ENABLED:return(function(e,t){return Object.assign(Object.assign({},e),{isRewindButtonEnabled:t.payload.value})})(e,t);case r.ActionTypes.SET_FOLDER_MEMBER_COUNTS:return(function(e,t){return Object.assign(Object.assign({},e),{folderMemberCounts:t.payload.value})})(e,t);case r.ActionTypes.TOGGLE_SPACES_ENTRY_POINT:return(function(e,t){return Object.assign(Object.assign({},e),{isSpacesEntryPointEnabled:t.payload.value})})(e,t);case r.ActionTypes.REQUEST_FOLDER_SIZES:return(function(e,t){const{fqPath:s}=t.payload;if(e.isQueryingFolderSizes)return e;const o=e.folderSizes.withMutations(e=>{e.set(s,{size:0,state:c.FetchFolderSizeState.LOADING})});return Object.assign(Object.assign({},e),{folderSizes:o,isQueryingFolderSizes:!0})})(e,t);case r.ActionTypes.SET_FOLDER_SIZES_PENDING:return(function(e,t){const{fetchFolderSizesResp:s}=t.payload;let o=e.currentFolderSizesQuery;const i=e.folderSizes.withMutations(e=>{for(const t of s.sizes_dict)e.update(t.fq_path,{size:0,state:c.FetchFolderSizeState.LOADING},()=>({size:t.size,state:c.FetchFolderSizeState.LOADING})),o=o.withMutations(e=>e.add(t.fq_path))});return Object.assign(Object.assign({},e),{currentFolderSizesQuery:o,folderSizes:i})})(e,t);case r.ActionTypes.COMPLETE_FOLDER_SIZES:return(function(e,t){const{fetchFolderSizeState:s}=t.payload,i=e.folderSizes.withMutations(t=>{e.currentFolderSizesQuery.forEach(o=>{const i=e.folderSizes.get(o);i&&t.update(o,()=>({size:i.size,state:s}))})});return Object.assign(Object.assign({},e),{currentFolderSizesQuery:o.Set(),folderSizes:i,isQueryingFolderSizes:!1})})(e,t);case r.ActionTypes.SET_ARE_POST_TTI_MODULES_LOADED:return(function(e,t){return Object.assign(Object.assign({},e),{arePostTTIModulesLoaded:t.payload.arePostTTIModulesLoaded})})(e,t);case r.ActionTypes.SET_VIEW_SCOPE:return(function(e,t){return Object.assign(Object.assign({},e),{viewScope:t.payload.viewScope})})(e,t);case r.ActionTypes.SET_HIDE_FILES_AND_SIDEBAR:return(function(e,t){return Object.assign(Object.assign({},e),{shouldHideFilesAndSidebar:t.payload.shouldHideFilesAndSidebar})})(e,t);case r.ActionTypes.SET_IS_CREATING_SHARED_LINK:return(function(e,t){return Object.assign(Object.assign({},e),{isCreatingSharedLinkMap:e.isCreatingSharedLinkMap.set(t.payload.fileIdOrPath,t.payload.isCreatingSharedLink)})})(e,t);case r.ActionTypes.SET_RIGHTRAIL_IS_COLLAPSED:return(function(e,t){return Object.assign(Object.assign({},e),{isRightRailCollapsed:t.payload.collapsed})})(e,t);case r.ActionTypes.SET_EXPANDED_BLADE:return(function(e,t){return Object.assign(Object.assign({},e),{expandedBlade:t.payload.expandedBlade})})(e,t);case r.ActionTypes.SET_OVERFLOW_MENU_OPEN_REQUEST:return(function(e,t){return Object.assign(Object.assign({},e),{overflowMenuOpenRequest:t.payload.overflowMenuOpenRequest})})(e,t);case r.ActionTypes.SET_OVERFLOW_MENU_CLOSE_REQUEST:return(function(e,t){return Object.assign(Object.assign({},e),{overflowMenuCloseRequest:t.payload.overflowMenuCloseRequest})})(e,t);case r.ActionTypes.SET_INLINE_OVERFLOW_MENU_OPEN_REQUEST:return(function(e,t){return Object.assign(Object.assign({},e),{inlineOverflowMenuOpenRequest:t.payload.inlineOverflowMenuOpenRequest})})(e,t);case r.ActionTypes.SET_OVERFLOW_MENU_COORDINATES:return(function(e,t){return Object.assign(Object.assign({},e),{overflowMenuCoordinates:t.payload.overflowMenuCoordinates})})(e,t);case r.ActionTypes.SET_BROWSE_POST_TTI_EXPERIMENTS:return(function(e,t){const{browsePostTTIExperiments:s}=t.payload;return Object.assign(Object.assign({},e),{browsePostTTIExperiments:s})})(e,t);case r.ActionTypes.SET_BROWSE_POST_TTI_DATA:return(function(e,t){const{browsePostTTIData:s}=t.payload;return Object.assign(Object.assign({},e),{browsePostTTIData:Object.assign(Object.assign({},e.browsePostTTIData),s)})})(e,t);case r.ActionTypes.SET_BACKUP_FOLDERS:return(function(e,t){return Object.assign(Object.assign({},e),{backupFolders:t.payload.backupFolders})})(e,t);case r.ActionTypes.SET_CREATE_MENU_OPEN_REQUEST:return(function(e,t){return Object.assign(Object.assign({},e),{createMenuOpenRequest:t.payload.createMenuOpenRequest})})(e,t);case r.ActionTypes.SHOW_PERSONALIZATION_SUGGESTED_FOLDERS:return(function(e,t){const{browsePostTTIExperimentsOverrides:s}=e,{showSuggestedFolders:o}=t.payload;return Object.assign(Object.assign({},e),{browsePostTTIExperimentsOverrides:Object.assign(Object.assign({},s),{showPersonalizationSuggestedFolders:o})})})(e,t);case r.ActionTypes.SHOW_ONBOARDING_CHECKLIST_SHARE_BUTTON_TOOLTIP:return(function(e,t){const{browsePostTTIExperimentsOverrides:s}=e,{showOnboardingChecklistShareButtonTooltip:o}=t.payload;return Object.assign(Object.assign({},e),{browsePostTTIExperimentsOverrides:Object.assign(Object.assign({},s),{showOnboardingChecklistShareButtonTooltip:o})})})(e,t);case r.ActionTypes.HANDLE_APP_CLEANUP:return r.defaultBrowseState}return e}})),define("modules/clean/react/browse/data/selectors",["require","exports","tslib","immutable","reselect","modules/clean/filepath/filepath","modules/clean/react/browse/constants","modules/clean/react/browse/data/types","modules/clean/react/browse/models","modules/clean/react/browse/uri_helper","modules/clean/react/browse/util","modules/clean/react/files_view/data/selectors/files_view_selectors","modules/clean/react/files_view/data/selectors/instance_selectors","modules/clean/react/files_view/types","modules/clean/react/growth/personalization/util","modules/clean/redux/namespaces","modules/clean/redux/selectors","modules/core/assert","modules/clean/react/flows/types","modules/clean/tagging/data/selectors/index","modules/clean/tagging/experiments","modules/clean/tagging/utils","modules/clean/filetypes","modules/clean/react/browse/data/helpers","modules/clean/sync_everything/constants"],(function(e,t,s,o,i,r,a,n,l,c,d,u,_,p,m,f,h,g,S,E,T,b,w,I,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.backupNewLocationHintEnabled=t.getIndexOfFile=t.createMenuOpenRequest=t.selectCurrentFolderInfoWithTags=t.selectedFilesWithTags=t.sortedFilesWithFolderSizesAndTags=t.selectIsTagsColumnEnabled=t.selectIsTaggingEnabled=t.autoTagAwarenessVariant=t.flowsAutoTagUiVariant=t.flowsAutomatedFolderUiVariant=t.manualTaggingVariant=t.isInsideBackupFolder=t.backupFolderPath=t.isSelectedBackupFolder=t.backupFolders=t.isContinuousOnboardingBackgroundActive=t.browseBoostSharing=t.showBrowseViewToggleInToolbar=t.showShareViewInToolbar=t.expandedBlade=t.fileHasAutomatedRuleMap=t.isInsideFlowsEligibleFolder=t.flowsFolderRule=t.isRightRailCollapsed=t.showSelectionIndicatorInToolbar=t.expActionBarRedesignVariant=t.browseCommentsEnabled=t.getCurrentFolderInfo=t.selectionMode=t.selectViewTypeScope=t.getUsersJtbdInterestInfo=t.getFullFunnelOptimizationVideoVariant=t.shouldLogCreateSuggestedFolderTooltipExposure=t.shouldDisplayCreateSuggestedFolderTooltip=t.isEligibleForOnboardingChecklist=t.isEligibleForSuggestedFoldersToMove=t.shouldShowTeamSpaceEmptyZone=t.selectFileByFullPath=t.canEditFolderOverview=t.shouldShowSidebarFolderOverview=t.unsortedFilesWithFolderSizes=t.sortedFilesWithFolderSizes=t.urlPrefix=t.selectFilesForSelection=t.allFilesSelected=t.selectedFilesForSidebar=t.selectedFiles=t.sortedFiles=t.fileJumpIndex=t.isCurrentPathRoot=t.arePostTTIModulesLoaded=t.unsortedFiles=t.browsePostTTIExperimentsOverrides=t.browsePostTTIExperiments=t.isSpacesEntryPointEnabled=t.folderMemberCounts=t.isRewindButtonEnabled=t.isFileViewerShown=t.clickFolderHistoryTimestamp=t.clickRewindTimestamp=t.isFolderHistoryVisible=t.isRewindVisible=t.viewer=t.user=t.isCreatingSharedLinkForFile=t.shouldHideFilesAndSidebar=t.autoTeamGroupId=t.hasLinkedMobile=t.browsePostTTIData=t.boltIgnore=t.sortOrder=t.shouldShowDeletedFiles=t.selection=t.path=t.newFolderCreationState=t.mountPoints=t.browseLoadingState=t.isQueryingFolderSizes=t.isFileJumping=t.folderSizes=t.filePathsToSelectOnNextUpdate=t.fileJumpFilter=t.selectPostTTIExperimentsOptional=t.postTTIExperiments=t.selectBrowseExperimentsOptional=t.experiments=t.inlineOverflowMenuOpenRequest=t.overflowMenuCoordinates=t.overflowMenuCloseRequest=t.overflowMenuOpenRequest=t.context=t.clipboard=t.canDisplayFolderSizes=t.getBrowseState=void 0,o=s.__importStar(o),r=s.__importStar(r),t.getBrowseState=e=>h.getStateAtNamespace(e,f.BROWSE_NAMESPACE_KEY)||n.defaultBrowseState,t.canDisplayFolderSizes=e=>t.getBrowseState(e).canDisplayFolderSizes,t.clipboard=e=>t.getBrowseState(e).clipboard,t.context=e=>t.getBrowseState(e).context,t.overflowMenuOpenRequest=e=>t.getBrowseState(e).overflowMenuOpenRequest,t.overflowMenuCloseRequest=e=>t.getBrowseState(e).overflowMenuCloseRequest,t.overflowMenuCoordinates=e=>t.getBrowseState(e).overflowMenuCoordinates,t.inlineOverflowMenuOpenRequest=e=>t.getBrowseState(e).inlineOverflowMenuOpenRequest,t.experiments=e=>t.getBrowseState(e).experiments,t.selectBrowseExperimentsOptional=e=>{var t;return null===(t=e[f.BROWSE_NAMESPACE_KEY])||void 0===t?void 0:t.experiments},t.postTTIExperiments=e=>t.getBrowseState(e).browsePostTTIExperiments,t.selectPostTTIExperimentsOptional=e=>{var t;return null===(t=e[f.BROWSE_NAMESPACE_KEY])||void 0===t?void 0:t.browsePostTTIExperiments},t.fileJumpFilter=e=>t.getBrowseState(e).fileJumpFilter,t.filePathsToSelectOnNextUpdate=e=>t.getBrowseState(e).filePathsToSelectOnNextUpdate,t.folderSizes=e=>t.getBrowseState(e).folderSizes,t.isFileJumping=e=>t.getBrowseState(e).fileJumpFilter.length>0,t.isQueryingFolderSizes=e=>t.getBrowseState(e).isQueryingFolderSizes,t.browseLoadingState=e=>t.getBrowseState(e).loadingState,t.mountPoints=e=>t.getBrowseState(e).mountPoints,t.newFolderCreationState=e=>t.getBrowseState(e).newFolderCreationState,t.path=e=>t.getBrowseState(e).path,t.selection=e=>t.getBrowseState(e).selection,t.shouldShowDeletedFiles=e=>t.getBrowseState(e).shouldShowDeletedFiles,t.sortOrder=e=>{const t=_.selectScopedSort(e,{instanceId:a.BROWSE_FILES_VIEW_ID});return t||a.BROWSE_DEFAULT_SORT_ORDER},t.boltIgnore=e=>t.getBrowseState(e).boltIgnore,t.browsePostTTIData=e=>t.getBrowseState(e).browsePostTTIData,t.hasLinkedMobile=e=>t.getBrowseState(e).hasLinkedMobile,t.autoTeamGroupId=e=>t.getBrowseState(e).autoTeamGroupId,t.shouldHideFilesAndSidebar=e=>t.getBrowseState(e).shouldHideFilesAndSidebar,t.isCreatingSharedLinkForFile=(e,s)=>Boolean(t.getBrowseState(e).isCreatingSharedLinkMap.get(s)),t.user=e=>{const s=t.getBrowseState(e).user;return g.assert(null!=s,"Browse store `user` accessed before APP_INIT action"),s},t.viewer=e=>{const s=t.getBrowseState(e).viewer;return g.assert(null!=s,"Browse store `viewer` accessed before APP_INIT action"),s},t.isRewindVisible=e=>t.getBrowseState(e).isRewindVisible,t.isFolderHistoryVisible=e=>t.getBrowseState(e).isFolderHistoryVisible,t.clickRewindTimestamp=e=>t.getBrowseState(e).clickRewindTimestamp,t.clickFolderHistoryTimestamp=e=>t.getBrowseState(e).clickFolderHistoryTimestamp,t.isFileViewerShown=e=>t.getBrowseState(e).isFileViewerShown,t.isRewindButtonEnabled=e=>t.getBrowseState(e).isRewindButtonEnabled,t.folderMemberCounts=e=>t.getBrowseState(e).folderMemberCounts,t.isSpacesEntryPointEnabled=e=>t.getBrowseState(e).isSpacesEntryPointEnabled,t.browsePostTTIExperiments=e=>t.getBrowseState(e).browsePostTTIExperiments||{},t.browsePostTTIExperimentsOverrides=e=>t.getBrowseState(e).browsePostTTIExperimentsOverrides||{},t.unsortedFiles=e=>t.getBrowseState(e).unsortedFiles,t.arePostTTIModulesLoaded=e=>t.getBrowseState(e).arePostTTIModulesLoaded,t.isCurrentPathRoot=e=>r.paths_are_equal(t.path(e),"/"),t.fileJumpIndex=i.createSelector(t.unsortedFiles,e=>e.keySeq().toArray().map(e=>({filename:r.filename(e).toLowerCase(),fqPath:e})).sort((e,t)=>e.filename<t.filename?-1:e.filename>t.filename?1:0)),t.sortedFiles=i.createSelector(t.unsortedFiles,t.sortOrder,t.folderSizes,t.context,t.experiments,(e,t,s,o,i)=>d.sortFiles(e.toList(),t,s)),t.selectedFiles=i.createSelector(t.unsortedFiles,t.selection,(e,t)=>O(e,t)),t.selectedFilesForSidebar=i.createSelector(t.selectedFiles,u.previewThumbnails,(e,t)=>e.count()>0?e.withMutations(e=>{e.forEach((s,o)=>{var i;if(!s.thumbnail_url_tmpl&&(null===(i=t[s.file_id])||void 0===i?void 0:i.preview_url)){const i=t[s.file_id].preview_url;e.set(o,new l.File(Object.assign(Object.assign({},s),{thumbnail_url_tmpl:i})))}})}):e),t.allFilesSelected=i.createSelector(t.selectedFiles,t.unsortedFiles,(e,t)=>e.size===t.size),t.selectFilesForSelection=(e,s)=>O(t.unsortedFiles(e),s.selection);const O=(e,t)=>t.selected.isEmpty()||e.isEmpty()?o.OrderedMap():o.OrderedMap(t.selected.map(t=>{const s=e.find(e=>e.fq_path===t);return s?[s.fq_path,s]:void 0}));t.urlPrefix=i.createSelector(t.user,t.viewer,(e,t)=>c.browse_root(t,e)),t.sortedFilesWithFolderSizes=i.createSelector(t.sortedFiles,t.folderSizes,(e,t)=>e.map(e=>{const s=t.get(e.fq_path);return s?e.updateSize(s.size,s.state):e})),t.unsortedFilesWithFolderSizes=i.createSelector(t.unsortedFiles,t.folderSizes,(e,t)=>e.withMutations(s=>{t.forEach((t,o)=>{const i=e.get(o);if(i&&t){const e=i.updateSize(t.size,t.state);s.set(o,e)}})})),t.shouldShowSidebarFolderOverview=i.createSelector(t.selectedFiles,e=>e&&1===e.size&&e.first().is_dir&&!l.File.isNoAccessSharedFolder(e.first())),t.canEditFolderOverview=i.createSelector(t.user,t.context,(e,t)=>e.is_cdm_member&&e.is_team_admin&&t.isCurrentlyInRoot||!!t.isCurrentPathWriteable()),t.selectFileByFullPath=(e,s)=>t.sortedFilesWithFolderSizes(e).find(e=>e.fq_path===s.path),t.shouldShowTeamSpaceEmptyZone=i.createSelector(t.context,t.experiments,t.browsePostTTIData,t.browsePostTTIExperiments,t.browseLoadingState,(e,t,s,o,i)=>!(s.mobileWebInvites||!o.expPersonalizedFirstPaths&&!s.firstTaskProps.is_eligible_team||!e.isInsideMyTeamFolderTree||!e.isCurrentlyInRoot||i===p.LoadingState.LOADING_FIRST_PAGE)),t.isEligibleForSuggestedFoldersToMove=i.createSelector(t.context,t.experiments,t.browsePostTTIData,t.browseLoadingState,(e,t,s,o)=>{var i;const r=null===(i=s.suggestedFoldersToMoveInfo)||void 0===i?void 0:i.is_dismissed,a=t.splitTmfTsd&&"/Team Files"===e.currentFQPath;return Boolean(!r&&!s.mobileWebInvites&&e.isInsideMyTeamFolderTree&&(e.isCurrentlyInRoot&&!t.splitTmfTsd||a)&&o!==p.LoadingState.LOADING_FIRST_PAGE)}),t.isEligibleForOnboardingChecklist=i.createSelector(t.context,t.experiments,t.browsePostTTIData,t.browseLoadingState,(e,t,s,o)=>Boolean(!s.mobileWebInvites&&!t.splitTmfTsd&&e.isCurrentlyInRoot&&e.isInsideMyTeamFolderTree&&o===p.LoadingState.LOADED)),t.shouldDisplayCreateSuggestedFolderTooltip=i.createSelector(t.browsePostTTIData,e=>{var t,s,o;return"V1"===(null===(t=e.usersJtbdInterestInfo)||void 0===t?void 0:t.variant)&&(null===(s=e.usersJtbdInterestInfo)||void 0===s?void 0:s.onboarding_interest)===m.OnboardingInterest.VIDEO_SHARE&&!1===(null===(o=e.usersJtbdInterestInfo)||void 0===o?void 0:o.is_tooltip_dismissed)}),t.shouldLogCreateSuggestedFolderTooltipExposure=i.createSelector(t.browsePostTTIData,e=>{var t,s,o;return void 0!==(null===(t=e.usersJtbdInterestInfo)||void 0===t?void 0:t.variant)&&["CONTROL","V1"].includes(e.usersJtbdInterestInfo.variant)&&(null===(s=e.usersJtbdInterestInfo)||void 0===s?void 0:s.onboarding_interest)===m.OnboardingInterest.VIDEO_SHARE&&!1===(null===(o=e.usersJtbdInterestInfo)||void 0===o?void 0:o.is_tooltip_dismissed)}),t.getFullFunnelOptimizationVideoVariant=i.createSelector(t.browsePostTTIData,e=>{var t;return null===(t=e.usersJtbdInterestInfo)||void 0===t?void 0:t.variant}),t.getUsersJtbdInterestInfo=i.createSelector(t.browsePostTTIData,e=>e.usersJtbdInterestInfo),t.selectViewTypeScope=e=>t.getBrowseState(e).viewScope||void 0,t.selectionMode=i.createSelector(t.selectedFiles,e=>e.count()>0?"selected":"unselected"),t.getCurrentFolderInfo=e=>t.getBrowseState(e).currentFolderInfo,t.browseCommentsEnabled=i.createSelector(t.postTTIExperiments,e=>"ON"===e.expBrowseWebComments),t.expActionBarRedesignVariant=i.createSelector(t.postTTIExperiments,e=>e.expActionBarRedesign?e.expActionBarRedesign:"OFF"),t.showSelectionIndicatorInToolbar=e=>t.getBrowseState(e).context.isInsideFamilySharedFolder,t.isRightRailCollapsed=e=>t.getBrowseState(e).isRightRailCollapsed||!1,t.flowsFolderRule=(e,s)=>t.getBrowseState(e).fileHasAutomatedRuleMap.get(s)||S.FlowsRuleType.None,t.isInsideFlowsEligibleFolder=e=>{const s=t.getCurrentFolderInfo(e),o=t.getBrowseState(e).context;return s&&o.isInFolderMode&&!o.isCurrentlyInRoot&&!o.isInsideTeamFolderRoot&&!o.isInsideVaultFolder&&s.type!==w.FileTypes.TEAM_MEMBER_FOLDER&&!l.File.isReadOnlySharedFolder(s)},t.fileHasAutomatedRuleMap=e=>t.getBrowseState(e).fileHasAutomatedRuleMap,t.expandedBlade=e=>t.getBrowseState(e).expandedBlade,t.showShareViewInToolbar=(e,s)=>{const o=!s.isResponsive||s.isMatchedLarge,i=!o&&s.isMatchedMedium,r=t.getBrowseState(e).context.isInsideFamilySharedFolder;return(t.isRightRailCollapsed(e)&&o||i)&&!r},t.showBrowseViewToggleInToolbar=e=>t.getBrowseState(e).context.isInsideFamilySharedFolder,t.browseBoostSharing=i.createSelector(t.selectBrowseExperimentsOptional,e=>e?e.browseBoostSharing:"OFF"),t.isContinuousOnboardingBackgroundActive=i.createSelector(t.context,t.experiments,t.unsortedFiles,t.selectedFiles,(e,t,s,o)=>{const i=o.size>0,r="V1"===t.coreO21nInFolderActivationM1&&!e.isCurrentlyInRoot&&s.size<=0;return i||r}),t.backupFolders=e=>t.getBrowseState(e).backupFolders,t.isSelectedBackupFolder=i.createSelector(t.selectedFiles,t.browsePostTTIExperiments,(e,t)=>!!t.expEnableBackupWeb&&I.isBackupFolder(e.first())),t.backupFolderPath=e=>{if(v.isBackupBrowse()){const s=t.path(e).split("/").filter(Boolean);return s.length>=2&&s[1]===`${s[0]}.dbx-external-drive`?`/${s[0]}/${s[1]}`:"/"}const s=t.backupFolders(e);if(null===s)return null;const o=t.path(e),i=[o,...r.parent_dirs(o)],a=s.filter(e=>i.includes(e));return 0===a.length?null:a[0]},t.isInsideBackupFolder=e=>!!v.isBackupBrowse()||!!t.browsePostTTIExperiments(e).expEnableBackupWeb&&(!!I.isBackupFolder(t.getCurrentFolderInfo(e))||null!==t.backupFolderPath(e)),t.manualTaggingVariant=i.createSelector(t.selectBrowseExperimentsOptional,e=>{var t;return null!==(t=null==e?void 0:e.manualTagging)&&void 0!==t?t:"OFF"}),t.flowsAutomatedFolderUiVariant=i.createSelector(t.selectBrowseExperimentsOptional,e=>{var t;return null!==(t=null==e?void 0:e.flowsAutomatedFolderUi)&&void 0!==t&&t}),t.flowsAutoTagUiVariant=i.createSelector(t.selectBrowseExperimentsOptional,e=>{var t;return null!==(t=null==e?void 0:e.flowsAutoTagUi)&&void 0!==t&&t}),t.autoTagAwarenessVariant=i.createSelector(t.selectBrowseExperimentsOptional,e=>{var t;return null!==(t=null==e?void 0:e.autoTagAwareness)&&void 0!==t&&t}),t.selectIsTaggingEnabled=i.createSelector(t.manualTaggingVariant,T.isTaggingEnabled),t.selectIsTagsColumnEnabled=i.createSelector(t.manualTaggingVariant,T.isTagsColumnOnBrowseEnabled);const C=(e,t)=>{const s=t[b.getFileMapKey(e)];let o=e;return void 0!==s&&(o=new l.File(Object.assign(Object.assign({},e),{tags:s.map(e=>({value:e,highlighted:!1}))}))),o};t.sortedFilesWithFolderSizesAndTags=i.createSelector(t.sortedFilesWithFolderSizes,E.selectTagsByFile,(e,t)=>e.map(e=>C(e,t)));const F=i.createSelector(t.unsortedFiles,E.selectTagsByFile,(e,t)=>e.withMutations(e=>{e.forEach((s,o)=>{e.set(o,C(s,t))})}));t.selectedFilesWithTags=i.createSelector(F,t.selection,(e,t)=>O(e,t)),t.selectCurrentFolderInfoWithTags=i.createSelector(t.getCurrentFolderInfo,E.selectTagsByFile,(e,t)=>{if(void 0!==e)return C(e,t)}),t.createMenuOpenRequest=e=>t.getBrowseState(e).createMenuOpenRequest,t.getIndexOfFile=(e,s)=>t.sortedFiles(s).findIndex(t=>t.sjid===e.sjid&&t.ns_id===e.ns_id),t.backupNewLocationHintEnabled=i.createSelector(t.selectPostTTIExperimentsOptional,e=>"ON"===(null==e?void 0:e.expBackupNewLocationHint))})),define("modules/clean/react/browse/data/folder_overview_selectors",["require","exports","tslib","modules/clean/react/browse/constants","modules/clean/react/folder_overview/data/selectors","modules/clean/react/browse/data/selectors","reselect","modules/clean/react/files_view/types","modules/clean/filepath/filepath"],(function(e,t,s,o,i,r,a,n,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.shouldShowFamilyEmptyState=t.shouldShowVaultEmptyState=t.paginatedTotalNumFiles=t.folderOverviewPinnedItems=t.folderOverviewLoggingFileId=t.folderOverviewFolderFileId=t.hasFailedToLoad=t.haveAllComponentsLoaded=void 0,i=s.__importStar(i),l=s.__importStar(l);const c=i.makeHaveAllComponentsLoadedSelector(),d=i.makeHasFailedToLoadSelector(),u=i.makeFolderFileIdSelector(),_=i.makeLoggingFileIdSelector(),p=i.makePinnedItemsSelector();t.haveAllComponentsLoaded=e=>c(e,{componentNamespace:o.BrowseFolderOverviewComponentNamespace}),t.hasFailedToLoad=e=>d(e,{componentNamespace:o.BrowseFolderOverviewComponentNamespace}),t.folderOverviewFolderFileId=e=>u(e,{path:r.path(e)}),t.folderOverviewLoggingFileId=e=>_(e,{path:r.path(e)}),t.folderOverviewPinnedItems=e=>p(e,{path:r.path(e)}),t.paginatedTotalNumFiles=e=>r.browseLoadingState(e)===n.LoadingState.LOADED?r.sortedFiles(e).count():r.getBrowseState(e).paginatedTotalNumFiles,t.shouldShowVaultEmptyState=a.createSelector(r.context,t.paginatedTotalNumFiles,(e,t)=>e.isInsideVaultFolder&&null!=e.currentNSPath&&l.paths_are_equal(e.currentNSPath,"")&&0===t),t.shouldShowFamilyEmptyState=a.createSelector(r.context,t.paginatedTotalNumFiles,r.experiments,(e,t,s)=>e.isInFamilySharedFolder&&null!=e.currentNSPath&&l.paths_are_equal(e.currentNSPath,"")&&0===t)})),define("modules/clean/react/browse/data/store",["require","exports","modules/clean/redux/namespaces","modules/clean/react/browse/data/reducer","modules/clean/redux/store","modules/clean/tagging/data/store"],(function(e,t,s,o,i,r){"use strict";let a;Object.defineProperty(t,"__esModule",{value:!0}),t.getStoreForBrowse=void 0,t.getStoreForBrowse=()=>(a||(a=i.getStoreAndRegisterReducers({[s.BROWSE_NAMESPACE_KEY]:o.browseReducer})),r.getStoreForTagging(),a)})),define("modules/clean/react/browse/right_rail_preferences",["require","exports","modules/core/persistence/storage","modules/core/exception"],(function(e,t,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setIsCollapsed=t.getIsCollapsed=t.RIGHTRAIL_COLLAPSED_STORAGE_KEY=void 0,t.RIGHTRAIL_COLLAPSED_STORAGE_KEY="browse_right_rail_collapsed_preferences",t.getIsCollapsed=function(e){try{return s.UserLocalStorage.get(e,t.RIGHTRAIL_COLLAPSED_STORAGE_KEY)||!1}catch(e){return o.reportException({err:e,severity:"non-critical"}),!1}},t.setIsCollapsed=function(e,i){try{s.UserLocalStorage.set(e,t.RIGHTRAIL_COLLAPSED_STORAGE_KEY,i)}catch(e){o.reportException({err:e,severity:"non-critical"})}}})),define("modules/clean/react/right_rail/user_education/right_rail_user_education_tracker",["require","exports","tslib","modules/clean/growth/user_action/tracker"],(function(e,t,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RightRailUserEducationTracker=t.RightRailUserEducationActions=void 0,(function(e){e.FOLDER_OVERVIEW_INTERACTION="folder_overview_interaction",e.PINNED_BLADE_INTERACTION="pinned_blade_interaction",e.TOOLTIP_SEEN="tooltip_seen"})(t.RightRailUserEducationActions||(t.RightRailUserEducationActions={}));class i extends o.GrowthUserActionTracker{constructor(){super(...arguments),this.project="right_rail_user_education"}hasPerfomed(e){return s.__awaiter(this,void 0,void 0,(function*(){return(yield this.client.rpc("performed_user_action",{project:this.project,action:e},{subjectUserId:this.userId})).has_performed}))}}t.RightRailUserEducationTracker=i})),define("modules/clean/react/file_uploader/action_logger",["require","exports","tslib","modules/clean/filepath/filepath","modules/clean/react/file_uploader/constants","modules/clean/react/file_uploader/web_upload_action_logger","modules/clean/web_user_action_logger","modules/clean/react/file_uploader/web_upload_action_events","modules/clean/web_user_action_events","modules/core/browser","modules/clean/react/file_uploader/utils","modules/core/exception"],(function(e,t,s,o,i,r,a,n,l,c,d,u){"use strict";function _(){const e=c.get_pathname();return"/h"===e?"HOME":"/recents"===e?"RECENTS":"/starred"===e?"STARRED":e.startsWith("/share")?"SHARED":"/requests"===e?"FILE_REQUESTS":"/deleted_files"===e?"DELETED_FILES":"BROWSE"}Object.defineProperty(t,"__esModule",{value:!0}),t.logUploadAction=void 0,o=s.__importStar(o),c=s.__importStar(c),t.logUploadAction=function({action:e,upload:t,chooser_type:s,upload_method:p,num_files:m,num_dirs:f,errorType:h,extra:g,batchId:S,user:E,uploadPath:T,useUploadKit:b,source:w}){let I={num_files:m,num_dirs:f,chooser_type:s,upload_method:p,extra:Object.assign({origin:_(),use_upload_kit:b?"true":"false"},w&&{source:w})};if((function(e){return e&&!!e.uploadId})(t)){const s=t,r=e===n.WebUploadActionEvent.UPLOAD_FAILURE?s.errorType===i.UploadErrorType.GENERIC&&h?h:s.errorType:void 0;I=Object.assign(Object.assign({},I),{upload_id:s.uploadId,file_size:s.size,file_extension:o.file_extension(s.name),failure_reason:r,batch_id:s.batchId,upload_destination:s.dest,current_path:c.get_pathname(),file_name:s.name})}else if((function(e){return e&&!!e.batchId})(t)){const e=t;I=Object.assign(Object.assign({},I),{file_size:e.size,file_extension:o.file_extension(e.name),batch_id:e.batchId})}return!I.chooser_type&&t&&"chooserType"in t&&t.chooserType&&(I.chooser_type=t.chooserType),S&&(I.batch_id=S),T&&(I.batch_dest_folder_level=d.getFolderLevel(T),E&&(I.member_folder=d.isInMemberFolder(E,T))),g&&(I.extra=Object.assign(Object.assign({},I.extra),g)),E?(function(e){return e===l.WebUserActionLogEvent.UPLOAD_BUTTON_CLICK||e===l.WebUserActionLogEvent.ADD_MORE_FILES_CLICK||e===l.WebUserActionLogEvent.VIEW_DETAILS_CLICK||e===l.WebUserActionLogEvent.CLOSE_MODAL_CLICK||e===l.WebUserActionLogEvent.UPLOAD_CLICK||e===l.WebUserActionLogEvent.UPLOAD_FILES_CLICK||e===l.WebUserActionLogEvent.UPLOAD_FOLDER_CLICK||e===l.WebUserActionLogEvent.CANCEL_UPLOAD_CLICK})(e)?a.WebUserActionLog.log(E.id,e,I):(e=e,I.client_timestamp=Math.round(Date.now()/1e3),r.WebUploadActionLog.log(E.id,e,I)):void u.reportStack("Trying to log web upload event but user is null",{severity:u.SEVERITY.NONCRITICAL})}})),define("modules/clean/react/file_uploader/constants",["require","exports","tslib","immutable"],(function(e,t,s,o){"use strict";var i,r;Object.defineProperty(t,"__esModule",{value:!0}),t.ValidChunkSizeStrings=t.FileUpload=t.OverQuotaStatusType=t.UploadErrorType=t.TeamAccessLevel=t.FileStatusType=t.UploaderActionType=t.MAX_FILE_SIZE=t.ChooserType=void 0,o=s.__importStar(o),(function(e){e.FILE="file",e.FOLDER="folder",e.FILE_FOLDER="file_folder",e.UNKNOWN="unknown"})(t.ChooserType||(t.ChooserType={})),t.MAX_FILE_SIZE=524288e5,(function(e){e.ALL_UPLOADS_COMPLETE="ALL_UPLOADS_COMPLETE",e.SET_PATH="UPLOADER_SET_PATH",e.SET_FOLDER_NS_ID="UPLOADER_SET_FOLDER_NS_ID",e.SET_USER="UPLOADER_SET_USER",e.SET_NUM_DRAGGING_FILES="SET_NUM_DRAGGING_FILES",e.READY_UPLOADS="READY_UPLOADS",e.QUEUE_UPLOADS="QUEUE_UPLOADS",e.START_UPLOAD="START_UPLOAD",e.COMPLETE_UPLOAD="COMPLETE_UPLOAD",e.CANCEL_UPLOADS="CANCEL_UPLOADS",e.SET_CURRENT_UPLOAD_PROGRESS="SET_CURRENT_UPLOAD_PROGRESS",e.UPLOAD_ERROR="UPLOAD_ERROR",e.SET_IS_UPLOAD_MODAL_OPEN="SET_IS_UPLOAD_MODAL_OPEN",e.SET_INLINE_STATUS_SHOULD_BE_DISMISSED="SET_INLINE_STATUS_SHOULD_BE_DISMISSED",e.ADD_NEW_FAILED_FILE="ADD_NEW_FAILED_FILE",e.CONFIRM_FSW="CONFIRM_FSW",e.ADD_FILES_TO_PLU="ADD_FILES_TO_PLU",e.ADD_DIRECTORIES_TO_PLU="ADD_DIRECTORIES_TO_PLU",e.REMOVE_FILES="REMOVE_FILES",e.SET_HAS_OVERQUOTA_ERROR="SET_HAS_OVERQUOTA_ERROR",e.SET_IS_PERMISSIONS_AT_UPLOAD_MODAL_OPEN="SET_IS_PERMISSIONS_AT_UPLOAD_MODAL_OPEN",e.ADD_TEAM_ACCESS_LEVEL="ADD_TEAM_ACCESS_LEVEL",e.RESET_TEAM_ACCESS_LEVELS="RESET_TEAM_ACCESS_LEVELS",e.SET_UPLOAD_PROGRESS="SET_UPLOAD_PROGRESS",e.SET_FILE_UPLOAD_TIME_LEFT="SET_FILE_UPLOAD_TIME_LEFT"})(t.UploaderActionType||(t.UploaderActionType={})),(function(e){e.SET_PERMISSIONS="SET_PERMISSIONS",e.PENDING="PENDING",e.UPLOADING="UPLOADING",e.COMPLETE="COMPLETE",e.CANCELLED="CANCELLED",e.FAILED="FAILED"})(i=t.FileStatusType||(t.FileStatusType={})),(function(e){e.WRITER="WRITER",e.READER="READER",e.NO_ACCESS="NO_ACCESS",e.INHERIT="INHERIT"})(t.TeamAccessLevel||(t.TeamAccessLevel={})),(function(e){e.FILE_SIZE_ERROR="FILE_SIZE_ERROR",e.HTTP_ERROR="HTTP_ERROR",e.CONNECTION_ERROR="CONNECTION_ERROR",e.OVER_QUOTA_ERROR="OVER_QUOTA_ERROR",e.LOCKED_TEAM_ERROR="LOCKED_TEAM_ERROR",e.IGNORED="IGNORED",e.INVALID_EXTENSION="INVALID_EXTENSION",e.EMPTY_OR_FOLDER="EMPTY_OR_FOLDER",e.FOLDER_SAFARI="FOLDER_SAFARI",e.PACKAGE_FILE="PACKAGE_FILE",e.GENERIC="GENERIC",e.BLOCKS_MISSING_ERROR="BLOCKS_MISSING_ERROR",e.COMMIT_HTTP_ERROR="COMMIT_HTTP_ERROR",e.COMMIT_INVALID_ARGS="COMMIT_INVALID_ARGS",e.UPLOAD_BLOCK_ERROR="UPLOAD_BLOCK_ERROR",e.CHUNKS_NOT_ENABLED_ERROR="CHUNKS_NOT_ENABLED_ERROR",e.SERVER_RESPONSE_ERROR="SERVER_RESPONSE_ERROR",e.SERVER_TOKEN_EMPTY_ERROR="SERVER_TOKEN_EMPTY_ERROR",e.SERVER_TOKENS_MISSING_ERROR="SERVER_TOKENS_MISSING_ERROR",e.SERVER_HASH_RESPONSE_ERROR="SERVER_HASH_RESPONSE_ERROR",e.BLOCK_RUNTIME_ID_MISSING_ERROR="BLOCK_RUNTIME_ID_MISSING",e.CLIENT_HASH_EMPTY_ERROR="CLIENT_HASH_EMPTY_ERROR",e.SERVER_HASH_EMPTY_ERROR="SERVER_HASH_EMPTY_ERROR",e.HASHES_NOT_EQUAL_ERROR="HASHES_NOT_EQUAL_ERROR",e.BLOCK_INDEX_ERROR="BLOCK_INDEX_ERROR",e.BLOCK_EMPTY_ERROR="BLOCK_EMPTY_ERROR",e.BLOB_EMPTY_ERROR="BLOB_EMPTY_ERROR",e.BLOB_MISSING_ERROR="BLOB_MISSING_ERROR",e.CLIENT_HASH_DIGEST_ERROR="CLIENT_HASH_DIGEST_ERROR",e.FILE_READER_NULL_RESULT_ERROR="FILE_READER_NULL_RESULT_ERROR",e.COMMIT_READINESS_ERROR="COMMIT_READINESS_ERROR",e.UPLOAD_PRECHECK_ERROR="UPLOAD_PRECHECK_ERROR",e.UPLOAD_PRECHECK_INVALID_CHAR_ERROR="UPLOAD_PRECHECK_INVALID_CHAR_ERROR",e.PERMISSIONS_AT_UPLOAD_ERROR="PERMISSIONS_AT_UPLOAD_ERROR"})(r=t.UploadErrorType||(t.UploadErrorType={})),(function(e){e.NONE="NONE",e.BASIC_OVER_QUOTA="BASIC_OVER_QUOTA",e.BASIC_NEAR_QUOTA="BASIC_NEAR_QUOTA",e.LIMITED_TEAM_USER_OVER_QUOTA="LIMITED_TEAM_USER_OVER_QUOTA",e.LIMITED_TEAM_TSD_OVER_QUOTA="LIMITED_TEAM_TSD_OVER_QUOTA",e.LOCKED_TEAM_USER_OVER_QUOTA="LOCKED_TEAM_USER_OVER_QUOTA"})(t.OverQuotaStatusType||(t.OverQuotaStatusType={}));class a extends(o.Record({uploadId:void 0,dest:"",ns_id:null,ns_path:null,userId:null,name:"",size:0,percentUploaded:0,status:i.SET_PERMISSIONS,errorType:r.GENERIC,errorMessage:"",batchId:void 0,chooserType:void 0,numSecondsLeft:0},"FileUpload")){}t.FileUpload=a,(function(e){e[e["4mb"]=0]="4mb",e[e["8mb"]=1]="8mb"})(t.ValidChunkSizeStrings||(t.ValidChunkSizeStrings={}))})),define("modules/clean/react/file_uploader/utils",["require","exports","tslib","react","dig-components/tooltips","modules/clean/base64","modules/clean/filepath/filepath","modules/clean/react/async_file_modal_controller","modules/clean/react/file_uploader/constants","modules/clean/react/upload_kit/lib/types","modules/core/browser","modules/core/i18n"],(function(e,t,s,o,i,r,a,n,l,c,d,u){"use strict";function _(){let e="";for(let t=0;t<16;++t)e+=String.fromCharCode(Math.floor(256*Math.random()));let t=r.encode(e);return t=t.replace(/\+/g,"-"),t=t.replace(/\//g,"_"),t=t.replace(/\=*$/,""),t}function p(e,t){return!e.is_team||!e.is_cdm_member||""!==a.normalize(t)&&(a.paths_are_equal(e.cdm_tmf_path,t)||a.inSubDirectory(e.cdm_tmf_path,t))}function m(e,t){let s=e.dest;const o=h(t);for(;h(s)-1>o;)s=a.parent_dir(s);return s}function f(e,t){const s=e.toArray().map(e=>m(e,t));return Array.from(new Set(s))}function h(e){return(a.normalize(e).match(/\//g)||[]).length+1}function g(e){switch(e){case c.UploadErrorType.EmptyFile:return u.intl.formatMessage({id:"KZETkM",defaultMessage:"Empty files cannot be uploaded."});case c.UploadErrorType.OverMaxFileSize:return u.intl.formatMessage({id:"Hg3ZgC",defaultMessage:"File is too large to be uploaded."});default:return u.intl.formatMessage({id:"WQDOGQ",defaultMessage:"This file is not supported by Dropbox and cannot be uploaded."})}}Object.defineProperty(t,"__esModule",{value:!0}),t.promiseWithRetries=t.folderModalTitle=t.getDestinationDir=t.showInvalidFileWarning=t.getFolderLevel=t.getFileUploadsWithStatus=t.isUploadInTmf=t.uploadContainsFolder=t.isMultifolderUpload=t.getRootDests=t.getRootDest=t.getFSWMetadataToLog=t.PERMISSION_FSW_IDS=t.getUploadLocationMetadataToLog=t.isInMemberFolder=t.getOQmodalOQALocationCode=t.getNsId=t.calculateSizeOfUploads=t.generateBatchId=t.generateUploadId=void 0,o=s.__importDefault(o),r=s.__importStar(r),a=s.__importStar(a),n=s.__importStar(n),d=s.__importStar(d),t.generateUploadId=function(){return _()},t.generateBatchId=function(){return"batch-"+_()},t.calculateSizeOfUploads=function(e,t){let s=0;return e.forEach(e=>{-1!==t.indexOf(e.status)&&(s+=e.size)}),s},t.getNsId=function(e,t,s){let o=t,i=0;return e.forEach((e,t)=>{let r=0;const a=e.split("/"),n=s.split("/");for(;r<a.length&&r<n.length&&a[r]===n[r];)r++;r===a.length&&r>1&&r>i&&(i=r,o=Number(t))}),o},t.getOQmodalOQALocationCode=e=>"/h"===(e||d.get_uri().path)?"ho":"fb",t.isInMemberFolder=p,t.getUploadLocationMetadataToLog=function(e,t){return{root_folder:""===a.normalize(t),member_folder:p(e,t),folder_level:a.normalize(t).split("/").length}},t.PERMISSION_FSW_IDS=["action_commit_to_tsd_root","action_missing_parent"],t.getFSWMetadataToLog=function(e){return{has_permissions:e.includes("action_commit_to_tsd_root"),has_permissions_nonroot:e.includes("action_missing_parent"),has_other:e.some(e=>!t.PERMISSION_FSW_IDS.includes(e))}},t.getRootDest=m,t.getRootDests=f,t.isMultifolderUpload=function(e,t){const s=f(e.filter(e=>l.FileStatusType.SET_PERMISSIONS===e.status),t);return!s.every(e=>e===s[0])},t.uploadContainsFolder=function(e,t){const s=e.filter(e=>l.FileStatusType.SET_PERMISSIONS===e.status),o=h(t);return f(s,t).some(e=>h(e)>o)},t.isUploadInTmf=function(e,t){if(!t.cdm_tmf_path)return!1;const s=e.filter(e=>l.FileStatusType.SET_PERMISSIONS===e.status),o=a.normalize(t.cdm_tmf_path);return s.some(e=>e.dest===o||a.inSubDirectory(o,e.dest))},t.getFileUploadsWithStatus=function(e,t){return e.valueSeq().toArray().filter(e=>t.includes(e.status))},t.getFolderLevel=h,t.showInvalidFileWarning=function(e,t,s){return new Promise((o,i)=>{if(e.length){const{title:r,text:a}=(function(e){if(1===e.length){const{name:t,validationError:s}=e[0];return{title:u.intl.formatMessage({id:"uQF0D4",defaultMessage:"Unable to upload {file}"},{file:t}),text:g(s)}}{const t=u.intl.formatMessage({id:"Chf30m",defaultMessage:"Unable to upload one or more files"}),s=e.map(({name:e})=>e);if(e.length<=3)return{title:t,text:u.intl.formatMessage({id:"fKAsp7",defaultMessage:"The following files are not supported by Dropbox and cannot be uploaded: {files}"},{files:s.join(", ")})};const o=s.length-3;return{title:t,text:u.intl.formatMessage({id:"z9swUK",defaultMessage:"{count, plural, one{The following files are not supported by Dropbox and cannot be uploaded: {files} and {count} more} other{The following files are not supported by Dropbox and cannot be uploaded: {files} and {count} more}}"},{files:s.slice(0,3).join(", "),count:o})}}})(e),l=e.some(({validationError:e})=>e===c.UploadErrorType.CloudDoc)?"https://www.dropbox.com/help/syncing-uploads/web-based-files":"https://help.dropbox.com/installs-integrations/sync-uploads/files-not-syncing";n.showFileSystemWarningsModal({confirmText:u.intl.formatMessage({id:"Bmo28B",defaultMessage:"{count, plural, one{Skip this file} other{Skip these files}}"},{count:e.length}),fsws:[{id:"action_upload_invalid_extension",blocking:t,title:r,text:a,learn_more:l}],onFinalAccept:o,onAbortAction:s?i:void 0})}else o()})},t.getDestinationDir=function(e,t){const s=a.normalize(e),o=a.parent_dir(t);return""===s?"/"===o?"/":"/"+o:"/"===o?s:s+"/"+o},t.folderModalTitle=o.default.createElement(o.default.Fragment,null,u.intl.formatMessage({id:"2sJoAc",defaultMessage:"Upload file in..."}),o.default.createElement(i.Toggletip,{"aria-label":"More information",iconButtonSize:"standard",title:u.intl.formatMessage({id:"Grmp0v",defaultMessage:"Choose a folder you have access to"})})),t.promiseWithRetries=(e,t)=>s.__awaiter(void 0,void 0,void 0,(function*(){let s=0,o=yield e();for(;o.isError&&s<t;)s++,o=yield e();return{response:o,retryCount:s}}))})),define("modules/clean/react/files_view/column_helpers",["require","exports","modules/clean/immutability_helper"],(function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.swapColumns=void 0,t.swapColumns=function(e,t,o){const i=e.map(e=>e.sortField).indexOf(t),r=e.map(e=>e.sortField).indexOf(o);if(i===r||-1===i||-1===r)return e;const a=e[i],n=e[r];return s.splice(s.splice(e,i,1,n),r,1,a)}})),define("modules/clean/react/files_view/column_manager",["require","exports","tslib","lodash","react","modules/clean/react/hooks/usePrevious","spectrum/dimensions/index","modules/clean/immutability_helper","modules/clean/react/files_view/column_helpers","modules/clean/react/files_view/resizing/column_size_context","modules/clean/react/files_view/sort_types","modules/clean/react/files_view/view_type"],(function(e,t,s,o,i,r,a,n,l,c,d,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ColumnManagerComponent=t.ColumnManager=void 0,o=s.__importStar(o),i=s.__importDefault(i),t.ColumnManager=e=>{var{responsiveContainer:o}=e,r=s.__rest(e,["responsiveContainer"]);return(r.isMatchedLarge||r.isMatchedMedium)&&o?i.default.createElement(a.Dimensions,null,({width:e})=>{const s=Object.assign({},r);return e&&(s.isMatchedLarge=e>824,s.isMatchedMedium=!s.isMatchedLarge&&e>588),i.default.createElement(t.ColumnManagerComponent,Object.assign({},s,{containerWidth:e}))}):i.default.createElement(t.ColumnManagerComponent,Object.assign({},r))},t.ColumnManager.displayName="ColumnManager",t.ColumnManagerComponent=e=>{const[t,s]=i.default.useState(()=>e.preferredColumns?h(e):(function(e){return e.columns.slice(0,T(e))})(e)),[a,_]=i.default.useState(()=>b(t)),p=i.default.useRef(),m=i.default.useRef(),f=r.usePrevious(e);function h(e){const{currentSort:t,viewType:s,preferredColumns:o}=e;let i=o;if(s===u.ViewType.Grid||s===u.ViewType.LargeGrid){const e=i.find(e=>e.sortField===t.sortField);i=[e||i[0]]}else i=i.slice(0,T(e));return i}function g(t,o=!1){const i=b(t);s(t),_(i),o?p.current=setTimeout(()=>{S(),e.onCanDisplayFolderSizesChanged(i)}):e.onCanDisplayFolderSizesChanged(i)}i.default.useEffect(()=>{if(!f)return void e.onCanDisplayFolderSizesChanged(a);if(e.preferredColumns){const s=h(e);return void(o.isEqual(s,t)||g(s,!0))}const{columns:i,currentSort:r}=e,n=T(f),c=T(e);if(o.isEqual(e.columns,f.columns)&&e.viewType===f.viewType){if(c<n)g(t.slice(0,c),!0);else if(c>n){const e=c-t.length,s=o.filter(i,e=>!o.find(t,t=>t.sortField===e.sortField)).slice(0,e);g([...t,...s],!0)}}else if(1===c&&i.length&&r){const{viewType:t,viewTypeColumns:o}=e,a=o?o[u.ViewType.Grid]:void 0;switch(t){case u.ViewType.List:case u.ViewType.CondensedList:g([i[0]],!0);break;case u.ViewType.Grid:case u.ViewType.LargeGrid:if(a){const o=i.find(e=>e.sortField===r.sortField)||i[0];(function(t,o,i){E();const r=b(t);s(t),_(r),m.current=setTimeout(()=>{E(),e.onColumnsChanged({columns:o,viewType:i,canDisplayFolderSizes:r})})})([o],l.swapColumns(a,a[0].sortField,o.sortField),t)}}}else g(i.slice(0,c),!0)},[e.columns,e.viewType,e.isMatchedLarge,e.isMatchedMedium,e.numVisibleColumns,e.preferredColumns]);const S=()=>{p.current&&(clearTimeout(p.current),p.current=void 0)};function E(){m.current&&(clearTimeout(m.current),m.current=void 0)}function T(e){const{isMatchedLarge:t,isMatchedMedium:s,viewType:o,numVisibleColumns:i,isMoreColumnsEnabled:r,isSearchMode:a}=e;switch(o){case u.ViewType.Grid:case u.ViewType.LargeGrid:return 1;case u.ViewType.List:case u.ViewType.CondensedList:default:return r?a?3:i||3:t?3:s?2:1}}function b(e){return e.some(e=>e.sortField===d.SortField.SIZE)}const{children:w,containerWidth:I}=e;if(!w)return null;let v=w;return"function"==typeof w&&(v=w({visibleColumns:t,canDisplayFolderSizes:a,handleSelection:function(s,o){const{isMoreColumnsEnabled:i,preferredColumns:r,viewType:a}=e;i&&r&&(a===u.ViewType.List||a===u.ViewType.CondensedList)?(function(s,o,i){const{onColumnsChanged:r,viewType:a}=e,l=t.indexOf(s),c=t.includes(o)?t.indexOf(o):t.length-1,d=l>=0?n.splice(t,l,1):n.splice(t,c+1,0,s);g(d),r({columns:[...d,...i.filter(e=>!d.includes(e))],viewType:a,canDisplayFolderSizes:b(d),numVisibleColumns:d.length})})(s,o,r):(function(s,o){const{viewType:i,onColumnsChanged:r,viewTypeColumns:a,preferredColumns:c}=e,_=c||(a?a[u.ViewType.List]:void 0),p=a?a[u.ViewType.Grid]:void 0;if(_&&p){const e=t.indexOf(o);if(-1===e||t.includes(s))g(t);else{const a=n.splice(t,e,1,s);g(a);const m=b(a);i===u.ViewType.List||i===u.ViewType.CondensedList?r({columns:l.swapColumns(_,o.sortField,s.sortField),viewType:u.ViewType.List,canDisplayFolderSizes:m}):(c||r({columns:l.swapColumns(p,o.sortField,s.sortField),viewType:i,canDisplayFolderSizes:m}),s.sortField!==d.SortField.FILENAME&&r({columns:l.swapColumns(_,_[1].sortField,s.sortField),viewType:u.ViewType.List,canDisplayFolderSizes:m}))}}})(s,o)},handleReorder:function(s,o){const{preferredColumns:i,onColumnsChanged:r,viewType:a}=e;if(!i||!t[s]||!t[o])return;const l=n.splice(n.splice(t,o,1),s,0,t[o]);g(l),r({columns:[...l,...i.filter(e=>!l.includes(e))],viewType:a,canDisplayFolderSizes:b(l),numVisibleColumns:l.length})},containerWidth:I})),i.default.createElement(c.ColumnResizingProvider,{storageSetting:e.columnResizeStorageSetting||c.noStorage,columnResizingEnabled:!!e.isMoreColumnsEnabled,scrollContainerWidth:e.scrollContainerWidth,visibleColumns:t},v)}})),define("modules/clean/react/files_view/column_headers/column_header_cell",["require","exports","tslib","classnames","react","dig-components/buttons","dig-components/icons","dig-components/icons/src","dig-components/typography","spectrum/table/index","modules/clean/react/files_view/column_headers/draggable_reorder","modules/clean/react/files_view/resizing/column_size_context","modules/clean/react/files_view/sort_types","focus-visible"],(function(e,t,s,o,i,r,a,n,l,c,d,u,_){"use strict";function p(e){return e===_.SortDirection.ASCENDING?"ascending":e===_.SortDirection.DESCENDING?"descending":"none"}Object.defineProperty(t,"__esModule",{value:!0}),t.ColumnHeaderCell=void 0,o=s.__importDefault(o),i=s.__importDefault(i),n=s.__importStar(n);const m=(e,t)=>s=>{s.getModifierState("Alt")&&"ArrowLeft"===s.key&&e(),s.getModifierState("Alt")&&"ArrowRight"===s.key&&t()},f=({column:e,sortDirection:t,setSort:s,onDecreaseSize:c,onIncreaseSize:d})=>{const{columnResizingEnabled:p}=i.default.useContext(u.ColumnResizingContext);return e.isSortDisabled||e.isSortOrderOptionDisabled?i.default.createElement(l.Text,{variant:"label",isBold:void 0!==t,className:o.default("files-view-column-header-unclickable","files-view-column-header-text",{"column-resizing-enabled":p}),tabIndex:p?0:void 0,onKeyDown:m(c,d)},e.label):i.default.createElement(r.Button,{variant:"transparent",hasNoUnderline:!0,onClick:()=>s(e.sortField,(function(e){switch(e){case _.SortDirection.ASCENDING:return _.SortDirection.DESCENDING;default:return _.SortDirection.ASCENDING}})(t)),className:o.default("files-view-column-header-text",{"column-resizing-enabled":p}),onKeyDown:m(c,d)},i.default.createElement(l.Text,{variant:"label",isBold:void 0!==t},e.label),t&&i.default.createElement(a.UIIcon,{src:t===_.SortDirection.ASCENDING?n.ArrowUpLine:n.ArrowDownLine,size:"small",className:"files-view-column-header-sort-button"}))};f.displayName="ColumnHeaderCellContent",f.displayName="ColumnHeaderCellContent";const h=e=>{var{index:t,className:r}=e,a=s.__rest(e,["index","className"]);const n=d.useDraggableReorder(t),{className:l}=n,u=s.__rest(n,["className"]);return i.default.createElement(c.TableHeadCell,Object.assign({className:o.default(r,l)},a,u))};h.displayName="DraggableTableHeadCell",t.ColumnHeaderCell=({children:e,column:t,index:s,role:o,setSort:r,sortDirection:a,canMove:n,onDecreaseSize:l,onIncreaseSize:d})=>{const _=i.default.useContext(u.ColumnResizingContext);let m;_.columnResizingEnabled&&(m=_.columnSizes[t.sortField]);const g=void 0===m?{}:{width:m,minWidth:m,maxWidth:m},S={key:s,role:o,scope:"col","aria-sort":p(a),className:"files-view-column-header-table-cell",style:g,children:i.default.createElement(i.default.Fragment,null,i.default.createElement(f,{column:t,sortDirection:a,setSort:r,onDecreaseSize:l,onIncreaseSize:d}),e)};return n?i.default.createElement(h,Object.assign({index:s},S)):i.default.createElement(c.TableHeadCell,Object.assign({},S))},t.ColumnHeaderCell.displayName="ColumnHeaderCell",t.ColumnHeaderCell.displayName="ColumnHeaderCell"})),define("modules/clean/react/files_view/column_headers/column_header_menu",["require","exports","tslib","classnames","react","react-redux","dig-components/buttons","dig-components/icons","dig-components/icons/src","dig-components/menu","modules/core/i18n","modules/clean/react/browse/data/selectors","modules/clean/tagging/experiments","modules/clean/react/files_view/column_headers/tags_column_tooltip/index"],(function(e,t,s,o,i,r,a,n,l,c,d,u,_,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ColumnHeaderMenu=t.AvailableMoves=void 0,o=s.__importDefault(o),i=s.__importDefault(i);var m;(function(e){e[e.NONE=0]="NONE",e[e.LEFT=1]="LEFT",e[e.RIGHT=2]="RIGHT",e[e.BOTH=3]="BOTH"})(m=t.AvailableMoves||(t.AvailableMoves={})),t.ColumnHeaderMenu=({columns:e,index:t,onSelection:s,onMenuOpen:f,selectedColumns:h,title:g,allowUnchecking:S,availableMoves:E,isSearchMode:T})=>{const b=[m.BOTH,m.LEFT].includes(E),w=[m.BOTH,m.RIGHT].includes(E),I=b||w,[v,O]=i.default.useState(!1),C=r.useSelector(u.manualTaggingVariant),F=0===t&&!T&&_.isTagsColumnOnBrowseEnabled(C);return i.default.createElement(c.Menu.Wrapper,{onSelection:e=>s(t,e),onToggle:({isOpen:e})=>e&&f(t,h[t].popoverTriggerLabel)},({getContentProps:t,getTriggerProps:s,triggerRef:r})=>i.default.createElement(i.default.Fragment,null,i.default.createElement(a.IconButton,Object.assign({},s(),{variant:"transparent",size:"small","aria-label":d.intl.formatMessage({id:"+D26UW",defaultMessage:"Change column"}),className:o.default("files-view-column-header-menu-button",{"files-view-column-header-menu-open":t().open||v}),"data-testid":"files-view-column-header-menu-trigger"}),i.default.createElement(n.UIIcon,{src:l.ChevronDownLine,size:"small"})),i.default.createElement(c.Menu.Content,Object.assign({},t(),{placement:"bottom-end"}),i.default.createElement(c.Menu.Segment,{withLabel:g},e.map(e=>i.default.createElement(c.Menu.SelectItem,{"aria-label":e.popoverTriggerLabel,key:e.popoverTriggerLabel,value:{type:"ColumnSelection",payload:e},selected:h.includes(e),disabled:e.isLocked||!S&&h.includes(e)},e.label))),I&&i.default.createElement(c.Menu.Segment,{withLabel:d.intl.formatMessage({id:"Yzabjr",defaultMessage:"Adjust"})},i.default.createElement(c.Menu.Submenu,{withTriggerContent:d.intl.formatMessage({id:"qKy/7I",defaultMessage:"Column order"})},i.default.createElement(c.Menu.Segment,null,i.default.createElement(c.Menu.ActionItem,{value:{type:"ColumnOrderSelection",payload:"left"},disabled:!b},d.intl.formatMessage({id:"obFNpg",defaultMessage:"Move left"})),i.default.createElement(c.Menu.ActionItem,{value:{type:"ColumnOrderSelection",payload:"right"},disabled:!w},d.intl.formatMessage({id:"7QBrxY",defaultMessage:"Move right"})))))),F&&i.default.createElement(p.TagsColumnTooltip,{showTooltip:v,setShowTooltip:O,triggerRef:r})))},t.ColumnHeaderMenu.displayName="ColumnHeaderMenu"})),define("modules/clean/react/files_view/column_headers/dig_column_header",["require","exports","tslib","classnames","react","dig-components/controls","spectrum/table/index","modules/clean/react/files_view/column_headers/column_header_cell","modules/clean/react/files_view/column_headers/column_header_menu","modules/clean/react/files_view/column_headers/draggable_reorder","modules/clean/react/files_view/column_headers/resize_handle","modules/clean/react/files_view/constants","modules/clean/react/files_view/fixed_table_head","modules/clean/react/files_view/resizing/column_size_context","modules/clean/react/files_view/sticky_table_head","modules/clean/react/files_view/sort_types","modules/clean/react/files_view/view_type","modules/core/i18n"],(function(e,t,s,o,i,r,a,n,l,c,d,u,_,p,m,f,h,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ColumnHeader=void 0,o=s.__importDefault(o),i=s.__importDefault(i);const S=(e,t)=>{switch(e){case h.ViewType.Grid:case h.ViewType.LargeGrid:return g.intl.formatMessage({id:"iWzO4p",defaultMessage:"Group by"});case h.ViewType.List:default:return t?g.intl.formatMessage({id:"t3Jo9w",defaultMessage:"Sort by"}):g.intl.formatMessage({id:"IUsgJf",defaultMessage:"Show"})}};t.ColumnHeader=({columnFlex:e,items:t,isCompactMode:s,isSelectMode:h,currentSort:E,selectAllCheckboxState:T="unchecked",showSelectAllCheckbox:b=!0,stickyOffsetHeight:w,stickyOffsetTop:I,columns:v,visibleColumns:O,viewType:C,isSearchMode:F,presentationOnly:R,variant:A="fixed",onMenuOpen:y,onSelectAll:D,onDeselectAll:L,onReorder:M,onSort:N,onSelection:P,isMoreColumnsEnabled:U,disableResizing:x})=>{const{resizeColumn:k,resizeColumnToDefault:V,columnSizes:W,columnResizingEnabled:B}=i.default.useContext(p.ColumnResizingContext),H=B&&!x,[j,G]=i.default.useState(!1),[q,z]=i.default.useState(!1),K={onMouseEnter:()=>z(!0),onMouseLeave:()=>z(!1)},Y=F?u.SEARCH_LIST_VIEW_SORT_ENABLED_COLUMNS:v,Q=Y.filter(e=>!e.isLocked),X=!h&&!q&&!s,J=(e,t)=>{if("ColumnSelection"===t.type&&(function(e){return"string"==typeof(null==e?void 0:e.popoverTriggerLabel)})(t.payload)){const s=O[e],o=t.payload;P(o,s,e),F?N(o.sortField,f.SortDirection.DESCENDING):U?O.includes(o)&&(null==E?void 0:E.sortField)===o.sortField&&N(O[0].sortField,f.SortDirection.ASCENDING):(null==E?void 0:E.sortField)===s.sortField&&(o.isSortOrderOptionDisabled?N(O[0].sortField,f.SortDirection.ASCENDING):N(o.sortField,E.sortDirection||f.SortDirection.ASCENDING))}else"ColumnOrderSelection"===t.type&&("right"===t.payload&&e<O.length-1?M(e+1,e):"left"===t.payload&&e>1&&M(e-1,e))},Z=O.map((e,s)=>{const o=(e=>{if(!U)return l.AvailableMoves.NONE;const t=O[e];if(!t||t.isLocked)return l.AvailableMoves.NONE;const s=0!==e&&!O[e-1].isLocked,o=e!==O.length-1&&!O[e+1].isLocked;return s&&o?l.AvailableMoves.BOTH:s?l.AvailableMoves.LEFT:o?l.AvailableMoves.RIGHT:l.AvailableMoves.NONE})(s),r=U||!(e.isLocked||e.isSortDisabled);return i.default.createElement(n.ColumnHeaderCell,{key:e.popoverTriggerLabel,column:e,index:s,setSort:N,role:R?"presentation":"columnheader",sortDirection:(null==E?void 0:E.sortField)===e.sortField?E.sortDirection:void 0,canMove:o!==l.AvailableMoves.NONE,onIncreaseSize:()=>k(e.sortField,W[e.sortField]+4),onDecreaseSize:()=>k(e.sortField,W[e.sortField]-4)},r&&i.default.createElement(l.ColumnHeaderMenu,{columns:U?Y:Q,index:s,onMenuOpen:y,onSelection:J,selectedColumns:O,title:S(C,!!F),allowUnchecking:U,availableMoves:o,isSearchMode:F}),H&&void 0!==k&&void 0!==V&&void 0!==E&&i.default.createElement(d.ResizeHandle,{onResize:t=>{G(!0),k(e.sortField,t)},onResizeToDefault:()=>V(e.sortField),onColumnResizeEnd:()=>G(!1),sortField:e.sortField,items:t}))}),$=i.default.createElement(c.DraggableReorderProvider,{onReorder:M},i.default.createElement(a.TableHeadCell,{className:"files-view-column-header-table-cell brws-checkbox-cell",key:"checkbox-cell",role:R?"presentation":"columnheader",scope:"col"},i.default.createElement("div",{className:"brws-vertically-center"},b&&!X?i.default.createElement(r.Checkbox,{className:o.default("brws-checkbox",{"brws-checkbox-checked":"checked"===T}),checked:"checked"===T,isIndeterminate:"mixed"===T,onChange:e=>{"unchecked"===T?D():L()},"aria-label":g.intl.formatMessage({id:"YzMs/g",defaultMessage:"Select all"})}):null)),Z);return"default"===A?i.default.createElement(a.TableHead,Object.assign({className:o.default("brws-column-header",{"header-column-resize":H,"column-header-is-resizing":j})},K,{"data-testid":"table-head"}),$):"fixed"===A?i.default.createElement(_.FixedTableHead,Object.assign({offsetHeight:w},K,{"data-testid":"fixed-table-head"}),$):"sticky-native"===A?i.default.createElement(a.TableHead,Object.assign({className:o.default("brws-column-header brws-column-header--sticky",{"header-column-resize":H,"column-header-is-resizing":j}),style:{top:I}},K,{"data-testid":"sticky-native-table-head"}),$):i.default.createElement(m.StickyTableHead,Object.assign({columnFlex:e,offsetHeight:w,offsetTop:I,className:o.default("brws-column-header",{"header-column-resize":H,"column-header-is-resizing":j})},K,{"data-testid":"sticky-table-head"}),$)},t.ColumnHeader.displayName="ColumnHeader",t.ColumnHeader.displayName="ColumnHeader"})),define("modules/clean/react/files_view/column_headers/resize_handle",["require","exports","tslib","react","modules/clean/em_string","modules/clean/react/browse/models","modules/clean/react/files_view/util","modules/clean/react/files_view/sort_types","modules/clean/react/files_view/rows/cells/async_folder_size"],(function(e,t,s,o,i,r,a,n,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ResizeHandle=t.SCROLLBAR_WIDTH=void 0,o=s.__importDefault(o);t.SCROLLBAR_WIDTH=16;const c=e=>14*new i.Emstring(e).length;t.ResizeHandle=({items:e,onResize:s,onResizeToDefault:i,onColumnResizeEnd:d,sortField:u})=>{const _=o.default.useRef({type:"not_resizing"}),[p,m]=o.default.useState();o.default.useRef(s).current=s;const f=o.default.useCallback(e=>{if("resizing"===_.current.type){const{startingPageX:t,startingWidth:o}=_.current,i=o-(t-e.pageX);i!==o&&s(i)}},[]),h=o.default.useCallback(e=>{window.removeEventListener("mousemove",f),window.removeEventListener("mouseup",h),_.current={type:"not_resizing"},m(void 0),d()},[]),g=e=>{e.preventDefault(),window.document.removeEventListener("click",g,!0)},S=()=>{let t=0;null==e||e.forEach(e=>{if(e instanceof r.File)switch(u){case n.SortField.CATEGORY:t=Math.max(c(r.File.getCategoryDescription(e)),t);break;case n.SortField.EXTENSION:t=Math.max(c(r.File.getExtension(e)),t);break;case n.SortField.FILENAME:t=Math.max(c(a.getFilename(e)),t);break;case n.SortField.MODIFIED:case n.SortField.RELEVANCE:t=Math.max(c(e.is_dir?"--":e.ago),t);break;case n.SortField.SIZE:t=Math.max(c(e.is_dir?"--":e.size),t)}else if(e instanceof r.FileSharedWithMe)switch(u){case n.SortField.FILENAME:t=Math.max(c(a.getFilename(e)),t);break;case n.SortField.MODIFIED:case n.SortField.RELEVANCE:t=Math.max(c(e.agoFromLastActionByUserTs||e.ago),t);break;case n.SortField.SIZE:t=Math.max(c(e.is_cloud_doc&&l.isCloudDocProviderStored(e)?"--":e.size),t)}});let s=30;return u===n.SortField.FILENAME&&(s=110),t>0?t+s:0};return o.default.createElement("div",{className:"resize-drag-handle",onMouseDown:e=>{e.preventDefault(),e.stopPropagation(),window.addEventListener("mousemove",f),window.addEventListener("mouseup",h);const s=window.innerHeight-e.currentTarget.getBoundingClientRect().top-4-t.SCROLLBAR_WIDTH;_.current={type:"resizing",startingWidth:e.currentTarget.parentElement.getBoundingClientRect().width,startingPageX:e.pageX},m(s),window.document.addEventListener("click",g,!0)},onDoubleClick:()=>{if(u===n.SortField.SHARED_WITH)i();else{const e=S();e>0?s(e):i()}},"data-testid":"resize-handle"},void 0!==p&&o.default.createElement("div",{className:"resize-vertical-focus-line",style:{height:`${p}px`}}))},t.ResizeHandle.displayName="ResizeHandle",t.ResizeHandle.displayName="ResizeHandle"})),define("modules/clean/react/files_view/column_headers/draggable_reorder",["require","exports","tslib","classnames","react"],(function(e,t,s,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useDraggableReorder=t.DraggableReorderProvider=void 0,o=s.__importDefault(o);const r=(i=s.__importStar(i)).default.createContext({draggedIndex:null,setDraggedIndex:()=>{},onReorder:()=>{}});t.DraggableReorderProvider=({onReorder:e,children:t})=>{const[s,o]=i.useState(null);return i.default.createElement(r.Provider,{value:{draggedIndex:s,setDraggedIndex:o,onReorder:e}},t)},t.DraggableReorderProvider.displayName="DraggableReorderProvider",t.DraggableReorderProvider.displayName="DraggableReorderProvider",t.useDraggableReorder=e=>{const{draggedIndex:t,setDraggedIndex:s,onReorder:a}=i.useContext(r),[n,l]=i.useState(!1),c=i.useRef(null),d=t===e,u=null!==t&&!d;return{draggable:!0,onDragStart:i.useCallback(t=>{t.dataTransfer&&(t.dataTransfer.effectAllowed="move",t.dataTransfer.dropEffect="move"),s(e)},[e]),onDragEnd:i.useCallback(e=>{e.preventDefault(),e.stopPropagation(),s(null)},[]),onDragEnter:i.useCallback(e=>{u&&(e.preventDefault(),e.stopPropagation(),l(!0),c.current=e.target)},[u]),onDragLeave:i.useCallback(e=>{e.target===c.current&&(e.preventDefault(),e.stopPropagation(),l(!1))},[]),onDrop:i.useCallback(o=>{u&&null!==t&&(o.preventDefault(),o.stopPropagation(),s(null),l(!1),a(e,t))},[e,u,t,a]),className:o.default("draggable-reorder",{"draggable-reorder--dragging":d,"draggable-reorder--dragged-over-from-right":n&&null!==t&&t-e>0,"draggable-reorder--dragged-over-from-left":n&&null!==t&&t-e<0})}}})),define("modules/clean/react/files_view/column_headers/tags_column_tooltip/component",["require","exports","tslib","react","react-intl","dig-components/buttons","dig-components/click_outside","dig-components/typography","dig-components/tooltips","modules/clean/react/files_view/resizing/column_size_context","modules/clean/react/files_view/sort_types","modules/clean/react/files_view/column_headers/tags_column_tooltip/tracker"],(function(e,t,s,o,i,r,a,n,l,c,d,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TagsColumnTooltip=void 0,o=s.__importDefault(o),t.TagsColumnTooltip=o.default.memo(({showTooltip:e,setShowTooltip:t,triggerRef:s})=>{const[_,p]=o.default.useState("bottom"),m=i.useIntl(),{columnSizes:f}=o.default.useContext(c.ColumnResizingContext),h=o.default.useRef(null),g=f[d.SortField.FILENAME];o.default.useEffect(()=>{var e;null===(e=null==h?void 0:h.current)||void 0===e||e.update()},[g]),o.default.useEffect(()=>{u.fetchTagsColumnTooltipSeen().then(e=>t(!e))},[t]);const S=()=>{t(!1),p("bottom")};return o.default.createElement(a.ClickOutside,{isActive:e,onClickOutside:S},o.default.createElement(l.Tooltip.Control,{variant:"rich",open:e,ref:h,triggerRef:s,auto:!0,placement:_,onChangePlacement:e=>p(e),onDisplayed:()=>{u.setTagsColumnTooltipSeen()}},o.default.createElement(n.Title,{size:"standard",inverse:!0},m.formatMessage({id:"+NJwpB",defaultMessage:"Show tags here"})),o.default.createElement(n.Text,{tagName:"p",color:"standard",inverse:!0},m.formatMessage({id:"7uh+Vn",defaultMessage:"To see all these files’ tags at a glance, just click the arrow and choose “tags” from the list."})),o.default.createElement("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-end",marginTop:"var(--spacing__unit--2)"}},o.default.createElement(r.Button,{variant:"outline",inverse:!0,onClick:S,autoFocus:!0},m.formatMessage({id:"5LJHki",defaultMessage:"Got it"})))))}),t.TagsColumnTooltip.displayName="TagsColumnTooltip"})),define("modules/clean/react/files_view/column_headers/tags_column_tooltip/index",["require","exports","modules/clean/react/files_view/column_headers/tags_column_tooltip/component"],(function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TagsColumnTooltip=void 0,Object.defineProperty(t,"TagsColumnTooltip",{enumerable:!0,get:function(){return s.TagsColumnTooltip}})})),define("modules/clean/react/files_view/column_headers/tags_column_tooltip/tracker",["require","exports","tslib","modules/clean/growth/user_action/tracker","api_v2/default_user_client","modules/clean/viewer"],(function(e,t,s,o,i,r){"use strict";var a;Object.defineProperty(t,"__esModule",{value:!0}),t.setTagsColumnTooltipSeen=t.fetchTagsColumnTooltipSeen=void 0,(function(e){e.TAGS_COLUMN_TOOLTIP_SEEN="tags_column_tooltip_seen"})(a||(a={}));class n extends o.GrowthUserActionTracker{constructor(){super(...arguments),this.project="manual_tagging"}}t.fetchTagsColumnTooltipSeen=function(){var e;return s.__awaiter(this,void 0,void 0,(function*(){const t=r.Viewer.get_viewer(),s=null!==(e=t.work_user)&&void 0!==e?e:t.personal_user;if(!s)return!0;const o=new i.DefaultUserApiV2Client(s),l=new n(s.id);return(yield o.ns("growth").rpc("performed_user_action",{project:l.project,action:a.TAGS_COLUMN_TOOLTIP_SEEN},{})).has_performed}))},t.setTagsColumnTooltipSeen=function(){var e;return s.__awaiter(this,void 0,void 0,(function*(){const t=r.Viewer.get_viewer(),s=null!==(e=t.work_user)&&void 0!==e?e:t.personal_user;if(s)return new n(s.id).track(a.TAGS_COLUMN_TOOLTIP_SEEN)}))}})),define("modules/clean/react/files_view/resizing/column_size_context",["require","exports","tslib","react","lodash","modules/core/browser_detection","modules/clean/react/files_view/constants","modules/clean/react/files_view/sort_types","lodash"],(function(e,t,s,o,i,r,a,n,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ColumnResizingProvider=t.localStorage=t.noStorage=t.ColumnResizingContext=void 0,o=s.__importDefault(o),l=s.__importStar(l);const c={columnResizingEnabled:!1,columnSizes:a.COLUMN_DEFAULT_WIDTHS,resizeColumn:function(e,t){},resizeColumnToDefault:function(e){}};function d(e,t){const s=a.COLUMN_MIN_WIDTHS[t],o=a.COLUMN_MAX_WIDTHS[t];return Math.min(Math.max(e,s),o)}function u(e){return l.mapValues(e,(e,t)=>d(e,t))}t.ColumnResizingContext=o.default.createContext(c);const _=i.debounce((function(e,t){window.localStorage.setItem(e,JSON.stringify(t))}));t.noStorage={type:"no_storage"},t.localStorage={type:"local_storage",localStorageKey:"dbx_files_view_column_sizes"};const p=e=>{const t=o.default.useRef(e);return t.current=e,t};t.ColumnResizingProvider=({children:e,storageSetting:s,columnResizingEnabled:i,scrollContainerWidth:c,visibleColumns:m})=>{const[f,h]=o.default.useState(()=>{switch(s.type){case"no_storage":return a.COLUMN_DEFAULT_WIDTHS;case"local_storage":return(function(e){try{const t=window.localStorage.getItem(e),s=JSON.parse(t);return l.mapValues(a.COLUMN_DEFAULT_WIDTHS,(e,t)=>{const o=s[t];return"number"==typeof o?o:e})}catch(e){return a.COLUMN_DEFAULT_WIDTHS}})(s.localStorageKey)}}),g=p(f),S=p(c),E=o.default.useRef("UNFROZEN"),T=o.default.useRef(r.safari);o.default.useEffect(()=>{if(i&&c&&c>0){if(T.current)return void(T.current=!1);const e=b(f),t="UNFROZEN"===E.current||"OVERFLOW"===E.current&&c>e||"UNDERFLOW"===E.current&&c<e;e>0&&c!==e&&t&&w(n.SortField.FILENAME,c-(e-f[n.SortField.FILENAME]),"DYNAMIC")}},[c]);const b=e=>{let t=0;return m.map(e=>e.sortField).forEach(s=>{t+=e[s]}),t},w=o.default.useCallback((e,t,o="MANUAL")=>{if(g.current[e]!==t){const i=Object.assign(Object.assign({},g.current),{[e]:d(t,e)});h(i),"local_storage"===s.type&&_(s.localStorageKey,i),"MANUAL"===o&&S.current?E.current=b(i)>S.current?"OVERFLOW":"UNDERFLOW":"DYNAMIC"===o&&(E.current="UNFROZEN")}},[s,g,S]),I=o.default.useCallback(e=>{const t=a.COLUMN_DEFAULT_WIDTHS[e];w(e,t)},[w]),v=o.default.useMemo(()=>({columnSizes:u(f),resizeColumn:w,resizeColumnToDefault:I,columnResizingEnabled:i}),[f,w,I,i]);return o.default.createElement(t.ColumnResizingContext.Provider,{value:v},e)},t.ColumnResizingProvider.displayName="ColumnResizingProvider",t.ColumnResizingProvider.displayName="ColumnResizingProvider"})),define("modules/clean/react/files_view/contexts/files_view_context",["require","exports","tslib","react","react-redux","modules/clean/react/files_view/contexts/callback_context","modules/clean/react/files_view/contexts/file_thumb_store","modules/clean/react/files_view/view_type","modules/clean/react/files_view/data/selectors/instance_selectors"],(function(e,t,s,o,i,r,a,n,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FilesViewContextProvider=void 0,o=s.__importStar(o);t.FilesViewContextProvider=({children:e,props:t,instanceId:s})=>{const{items:c,path:d}=t,u=i.useSelector((e=>t=>l.selectViewType(t,{instanceId:e}))(s));return o.createElement(r.FilesViewCallbackContextProvider,{props:t},o.createElement(a.ThumbStoreProvider,{shouldPrewarm:u!==n.ViewType.Grid,items:c,path:d},e))},t.FilesViewContextProvider.displayName="FilesViewContextProvider"})),define("modules/clean/react/files_view/controller",["require","exports","tslib","react-redux","react","modules/clean/react/files_view/data/store","modules/clean/react/files_view/files_view","modules/clean/react/files_view/data/action_creators","modules/clean/react/files_view/contexts/files_view_context","modules/clean/react/flows/types","modules/clean/react/files_view/legacy_types"],(function(e,t,s,o,i,r,a,n,l,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FilesViewController=t.FilesViewWithUpserter=t.splitProps=void 0,i=s.__importDefault(i),s.__exportStar(d,t);const u={arePostTTIModulesLoaded:!0,context:!0,createNewFolderState:!0,items:!0,selection:!0,user:!0,responsive:!0,clipboard:!0,currentSort:!0,disabledMultiselect:!0,dropTargetHighlightMode:!0,enableUnity:!0,expBizFoldersEmptyStateAdmin:!0,expBizFoldersEmptyStateUser:!0,fileRename:!0,filteredContactName:!0,renderFilenameSubtitleAsLink:!0,hideViewFileButton:!0,highDensity:!0,isOverFreeQuota:!0,isSearchMode:!0,loadingState:!0,sharingServiceInfo:!0,starredState:!0,teamFolders:!0,viewTypeScope:!0,viewTypes:!0,eligibleForFirstTaskSubtitle:!0,expVaultEnableViewOnlySharing:!0,isActionBarEnabled:!0,inlineActionBar:!0,expAutoPDFConversionBackend:!0,expFlowsAutoUnzipLambda:!0,expFlowsAutomatedFolderUI:!0,fileHasAutomatedRuleMap:c.FlowsMap({}),expManualTagging:"OFF",currentFolderInfo:!0,mediaFiltersVariant:"OFF",isRightClickEnabled:!0},_=(e,t,s)=>{t[s]=e[s]};t.splitProps=e=>{const t={},s={};for(const o of Object.keys(e))if(u.hasOwnProperty(o)){const t=o;void 0!==e[t]&&_(e,s,t)}else _(e,t,o);return{ownProps:t,upsertedProps:s}};let p=0;const m=e=>{const{id:s,isActive:r=!0}=e,c=o.useDispatch(),{ownProps:d,upsertedProps:u}=t.splitProps(e),_=i.default.useMemo(()=>s||`files-view:${p++}`,[s]),m=_!==s;return c(n.upsertInstance(_,u)),i.default.useEffect(()=>()=>{m&&c(n.deleteInstance(_))},[m,c,_]),i.default.useEffect(()=>{r&&s&&c(n.markActiveInstance(s))},[r,s,c]),i.default.createElement(l.FilesViewContextProvider,{props:e,instanceId:_},i.default.createElement(a.FilesView,Object.assign({},d,{id:_})))};m.displayName="UpsertWrapper",t.FilesViewWithUpserter=o.connect()(m);const f=r.getStoreForFilesView();t.FilesViewController=e=>i.default.createElement(o.Provider,{store:f},i.default.createElement(t.FilesViewWithUpserter,Object.assign({},e))),t.FilesViewController.displayName="FilesViewController"})),define("modules/clean/react/files_view/culled_table_body",["require","exports","tslib","spectrum/table/index","modules/clean/react/files_view/util","react"],(function(e,t,s,o,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.computeOffsetCache=t.scrollTo=t.CulledTableBodyWithScrollToRow=t.CulledTableBodyWithScrollContainer=void 0,r=s.__importDefault(r),t.CulledTableBodyWithScrollContainer=e=>{var{scrollContainer:t}=e,o=s.__rest(e,["scrollContainer"]);const n=r.default.useMemo(()=>(null==t?void 0:t.current)?i.createFakeWindow(t.current):null,[null==t?void 0:t.current]);return t?t.current&&n?r.default.createElement(a,Object.assign({},o,{shouldUseWindowAsScrollContainer:!0,window:n})):null:r.default.createElement(a,Object.assign({},o))},t.CulledTableBodyWithScrollContainer.displayName="CulledTableBodyWithScrollContainer",t.CulledTableBodyWithScrollContainer.displayName="CulledTableBodyWithScrollContainer";class a extends r.default.PureComponent{constructor(e){super(e),this.updateOffsetCache()}componentDidMount(){this.updateScroll(!0)}componentDidUpdate(e){e.listItemHeight!==this.props.listItemHeight&&this.updateOffsetCache(),e.scrollToRow!==this.props.scrollToRow&&this.updateScroll(void 0===e.scrollToRow||e.scrollToRow<0)}updateOffsetCache({listItemHeight:e}=this.props){this.offsetCache=Array.isArray(e)?t.computeOffsetCache(e):void 0}updateScroll(e){const{scrollToRow:s,listItemHeight:o,viewportTopOffset:i=0,scrollPositionOffset:r=0,window:a}=this.props;if(void 0!==s&&s>=0){const n=(Array.isArray(o)?this.offsetCache[s]:(s+1)*o)+r,l=n-(Array.isArray(o)?o[s]:o);t.scrollTo([l,n],i,a,e)}}render(){const e=this.props,{viewportTopOffset:t,scrollToRow:i}=e,a=s.__rest(e,["viewportTopOffset","scrollToRow"]);return r.default.createElement(o.CulledTableBody,Object.assign({viewportHeight:window.innerHeight-t},a))}}t.CulledTableBodyWithScrollToRow=a,a.defaultProps={viewportTopOffset:0},a.displayName="CulledTableBodyWithScrollToRow";t.scrollTo=([e,t],s=0,o=window,i)=>{const r=o.innerHeight-s,a=((e=window)=>"scrollingElement"in e.document&&e.document.scrollingElement?e.document.scrollingElement.scrollTop:e.document.documentElement.scrollTop)(o),n=a+r;e<a?o.scrollTo(0,e):t>n&&(i&&t-e<r/2?o.scrollTo(0,t-r/2):o.scrollTo(0,t-r))},t.computeOffsetCache=e=>e.reduce((e,t)=>(e.push(t+(e[e.length-1]||0)),e),[])})),define("modules/clean/react/files_view/data/action_creators",["require","exports","tslib","lodash","immutable","api_v2/user_client","modules/clean/react/files_view/constants","modules/clean/react/files_view/data/selectors/files_view_selectors","modules/clean/react/files_view/data/selectors/instance_selectors","modules/clean/react/files_view/data/types","lodash","modules/clean/react/browse/action_logger","modules/clean/web_user_action_events","modules/clean/react/files_view/view_preferences"],(function(e,t,s,o,i,r,a,n,l,c,d,u,_,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadScopedSortOrders=t.setSort=t.loadPreviewThumbnails=t.batchLoadPreviewThumbnails=t.openKeyboardShortcutsModal=t.filterOutColumns=t.markActiveInstance=t.deleteInstance=t.upsertInstance=t.resetScroll=t.setFileRename=t.loadViewTypeColumns=t.setColumns=t.loadViewTypes=t.setViewType=void 0,n=s.__importStar(n),l=s.__importStar(l),d=s.__importStar(d),p=s.__importStar(p),t.setViewType=({user:e,viewType:t,viewTypeScope:s=a.VIEW_TYPE_GLOBAL_SCOPE,updateGlobalScope:o=!1})=>i=>{const r=[s];o&&s!==a.VIEW_TYPE_GLOBAL_SCOPE&&r.push(a.VIEW_TYPE_GLOBAL_SCOPE),i({type:c.ActionTypes.SET_VIEW_TYPE,payload:{viewType:t,viewScopes:r}}),p.setViewType(e.id,r,t)};t.loadViewTypes=({user:e,defaultViewType:t})=>s=>{const o=((e,t)=>{const s=p.getViewTypes(e);return s||(t?{[a.VIEW_TYPE_GLOBAL_SCOPE]:t}:null)})(e.id,t);o&&s({type:c.ActionTypes.SET_VIEW_TYPES,payload:{viewTypes:o}})},t.setColumns=({columns:e,user:t,viewTypeScope:s=a.VIEW_TYPE_GLOBAL_SCOPE,updateGlobalScope:o=!1,numVisibleColumns:i})=>r=>{const n={};e.forEach((e,t)=>{n[t]=e.sortField});const l=[s];o&&s!==a.VIEW_TYPE_GLOBAL_SCOPE&&l.push(a.VIEW_TYPE_GLOBAL_SCOPE),r({type:c.ActionTypes.SET_COLUMNS_INDEX,payload:{viewScopes:l,columnsIndex:n,numVisibleColumns:i}}),p.setColumnsIndex(t.id,l,n),void 0!==i&&p.setNumVisibleColumns(t.id,l,i)},t.loadViewTypeColumns=({user:e})=>{const t=p.getScopedColumnsIndex(e.id),s=p.getScopedNumVisibleColumns(e.id);return{type:c.ActionTypes.SET_SCOPED_COLUMNS_INDEX,payload:{scopedColumnsIndex:t,scopedNumVisibleColumns:s}}},t.setFileRename=({file:e,renameState:t})=>({type:c.ActionTypes.SET_FILE_RENAME,payload:{file:e,renameState:t}}),t.resetScroll=()=>({type:c.ActionTypes.SET_SCROLL,payload:{scrollTop:0}});t.upsertInstance=(e,t)=>(s,r)=>{var a,l;a=t,(!(l=n.selectInstances(r()).get(e))||Object.keys(a).some(e=>{const t=a[e],s=l[e];return!(!s&&!t)&&(i.Map.isMap(s)&&i.Map.isMap(t)?s.equals(t):!o.isEqual(t,s))}))&&s({type:c.ActionTypes.UPSERT_INSTANCE,payload:{id:e,instance:t}})},t.deleteInstance=e=>({type:c.ActionTypes.DELETE_INSTANCE,payload:{id:e}}),t.markActiveInstance=e=>({type:c.ActionTypes.MARK_ACTIVE_INSTANCE,payload:{id:e}}),t.filterOutColumns=e=>({type:c.ActionTypes.FILTER_OUT_COLUMNS,payload:e}),t.openKeyboardShortcutsModal=t=>(o,i)=>{(function(t){s.__awaiter(this,void 0,void 0,(function*(){const{showKeyboardShortcutsModal:o}=yield new Promise((t,s)=>{e(["modules/clean/react/files_view/keyboard_shortcuts_modal"],t,s)}).then(s.__importStar);o(t)}))})(l.selectIsListView(i(),t))};t.batchLoadPreviewThumbnails=(e,t,o,i,a)=>s.__awaiter(void 0,void 0,void 0,(function*(){const s=n.previewThumbnailsToLoad(t()),d=l.selectViewType(t(),{instanceId:a});try{if(s.length>0){const t=new r.UserApiV2Client,a=yield t.ns("previews").rpc("get_preview_data_batch",{files:s},{subjectUserId:o}),n=[];a.results.forEach(e=>{var t;const s=null===(t=e.preview)||void 0===t?void 0:t.content,o=e.file.file_id;o&&s&&(s.hasOwnProperty("thumbnail_url_tmpl")?n.push({file_id:o,preview_url:s.thumbnail_url_tmpl}):s.hasOwnProperty("placeholder_image_url")&&n.push({file_id:o,preview_url:s.placeholder_image_url}))}),n.length>0&&(e((({preview_thumbnails:e})=>({type:c.ActionTypes.PREVIEW_THUMBNAILS_LOADED,payload:{preview_thumbnails:e}}))({preview_thumbnails:n})),p={view_type:d,userId:o,num_files_requested:s.length,num_files_retrieved:n.length,elapsed_ms:Date.now()-i},u.logWebUserAction({user_id:p.userId,event_name:_.WebUserActionLogEvent.PREVIEW_THUMBNAIL_SUCCESS,extra:{view_type:p.view_type,num_files_requested:p.num_files_requested.toString(),num_files_retrieved:p.num_files_retrieved.toString(),elapsed_ms:p.elapsed_ms.toString()}}))}}catch(t){e((({files:e})=>({type:c.ActionTypes.PREVIEW_THUMBNAILS_REMOVED,payload:{files:e}}))({files:s})),(e=>{u.logWebUserAction({user_id:e.userId,event_name:_.WebUserActionLogEvent.PREVIEW_THUMBNAIL_ERROR,extra:{view_type:e.view_type,error_summary:e.error_summary||"unknown"}})})({view_type:d,userId:o,error_summary:null==t?void 0:t.toString()})}var p}));const m=d.debounce((e,s,o,i,r)=>{t.batchLoadPreviewThumbnails(e,s,o,i,r)},300);t.loadPreviewThumbnails=(e,t,s)=>(o,i)=>{const r=n.previewThumbnails(i()),a=e.filter(e=>e.file_id&&!r.hasOwnProperty(e.file_id));a.length>0&&(o((({files:e})=>({type:c.ActionTypes.PREVIEW_THUMBNAILS_LOADING,payload:{files:e}}))({files:a})),m(o,i,t,Date.now(),s))},t.setSort=({user:e,sort:t,viewScope:s=a.VIEW_TYPE_GLOBAL_SCOPE,updateGlobalScope:o=!1})=>i=>{const r=[s];o&&s!==a.VIEW_TYPE_GLOBAL_SCOPE&&r.push(a.VIEW_TYPE_GLOBAL_SCOPE),i({type:c.ActionTypes.SET_SORT,payload:{sort:t,viewScopes:r}}),p.setSort(e.id,r,t)},t.loadScopedSortOrders=({user:e,defaultSort:t})=>({type:c.ActionTypes.SET_SCOPED_SORTS,payload:{scopedSorts:Object.assign({[a.VIEW_TYPE_GLOBAL_SCOPE]:t},p.getScopedSorts(e.id))}})})),define("modules/clean/react/files_view/data/reducer",["require","exports","tslib","immutable","modules/clean/react/files_view/constants","modules/clean/react/files_view/data/types","modules/clean/react/files_view/types","modules/clean/react/files_view/view_type","modules/clean/react/flows/types"],(function(e,t,s,o,i,r,a,n,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.filesViewReducer=t.defaultFilesViewInstance=t.defaultFilesViewState=void 0,o=s.__importStar(o),t.defaultFilesViewState={viewTypes:{[i.VIEW_TYPE_GLOBAL_SCOPE]:n.ViewType.List},scopedColumnsIndex:void 0,scopedSorts:void 0,viewTypeColumns:{[n.ViewType.List]:i.LIST_VIEW_COLUMNS,[n.ViewType.CondensedList]:i.LIST_VIEW_COLUMNS,[n.ViewType.Grid]:i.GRID_VIEW_COLUMNS,[n.ViewType.LargeGrid]:i.GRID_VIEW_COLUMNS},fileRename:null,instances:o.Map(),previewThumbnails:{},activeInstance:void 0};t.defaultFilesViewInstance={dropTargetHighlightMode:a.DropTargetHighlightMode.NONE,enableUnity:!0,loadingState:a.LoadingState.LOADING_FIRST_PAGE,fileRename:null,renderFilenameSubtitleAsLink:!0,eligibleForFirstTaskSubtitle:!1,viewTypeScope:i.VIEW_TYPE_GLOBAL_SCOPE,hideViewFileButton:!1,fileHasAutomatedRuleMap:l.FlowsMap({})};t.filesViewReducer=function(e=t.defaultFilesViewState,s){switch(s.type){case r.ActionTypes.SET_VIEW_TYPE:return((e,{viewType:t,viewScopes:s})=>{const o=Object.assign({},e.viewTypes);for(const e of s)o[e]=t;return Object.assign(Object.assign({},e),{viewTypes:o})})(e,s.payload);case r.ActionTypes.SET_VIEW_TYPES:return((e,{viewTypes:t})=>Object.assign(Object.assign({},e),{viewTypes:Object.assign(Object.assign({},e.viewTypes),t)}))(e,s.payload);case r.ActionTypes.SET_FILE_RENAME:return(function(e,t){const{file:s,renameState:o}=t.payload;return o?Object.assign(Object.assign({},e),{fileRename:{file:s,state:o}}):Object.assign(Object.assign({},e),{fileRename:null})})(e,s);case r.ActionTypes.SET_COLUMNS_INDEX:return((e,{payload:{columnsIndex:t,viewScopes:s,numVisibleColumns:o}})=>{const i=Object.assign({},e.scopedColumnsIndex),r=Object.assign({},e.scopedNumVisibleColumns);for(const e of s)i[e]=t,void 0!==o&&(r[e]=o);return Object.assign(Object.assign({},e),{scopedColumnsIndex:i,scopedNumVisibleColumns:r})})(e,s);case r.ActionTypes.SET_SCOPED_COLUMNS_INDEX:return((e,{payload:{scopedColumnsIndex:t,scopedNumVisibleColumns:s}})=>Object.assign(Object.assign({},e),{scopedColumnsIndex:t,scopedNumVisibleColumns:s}))(e,s);case r.ActionTypes.SET_SCOPED_SORTS:return((e,{payload:{scopedSorts:t}})=>Object.assign(Object.assign({},e),{scopedSorts:t}))(e,s);case r.ActionTypes.SET_SORT:return((e,{payload:{sort:t,viewScopes:s}})=>{const o=Object.assign({},e.scopedSorts);for(const e of s)o[e]=t;return Object.assign(Object.assign({},e),{scopedSorts:o})})(e,s);case r.ActionTypes.SET_SCROLL:return((e,t)=>Object.assign(Object.assign({},e),{currentScroll:{scrollTop:t.scrollTop}}))(e,s.payload);case r.ActionTypes.UPSERT_INSTANCE:return((e,{payload:{instance:s,id:o}})=>{const i=e.instances.get(o);return Object.assign(Object.assign({},e),{activeInstance:o,instances:e.instances.set(o,Object.assign(Object.assign({},i||t.defaultFilesViewInstance),s))})})(e,s);case r.ActionTypes.DELETE_INSTANCE:return((e,{payload:{id:t}})=>Object.assign(Object.assign({},e),{instances:e.instances.delete(t)}))(e,s);case r.ActionTypes.PREVIEW_THUMBNAILS_LOADING:return((e,{payload:{files:t}})=>{const s=Object.assign({},e.previewThumbnails);return t.forEach(e=>{var t;e.file_id&&!(null===(t=s[e.file_id])||void 0===t?void 0:t.isLoading)&&(s[e.file_id]={isLoading:!0,file_info:e})}),Object.assign(Object.assign({},e),{previewThumbnails:s})})(e,s);case r.ActionTypes.PREVIEW_THUMBNAILS_LOADED:return((e,{payload:{preview_thumbnails:t}})=>{const s=Object.assign({},e.previewThumbnails);return t.forEach(e=>{e.file_id&&(s[e.file_id]={isLoading:!1,preview_url:e.preview_url})}),Object.assign(Object.assign({},e),{previewThumbnails:s})})(e,s);case r.ActionTypes.PREVIEW_THUMBNAILS_REMOVED:return((e,{payload:{files:t}})=>{const s=Object.assign({},e.previewThumbnails);return t.forEach(e=>{e.file_id&&delete s[e.file_id]}),Object.assign(Object.assign({},e),{previewThumbnails:s})})(e,s);case r.ActionTypes.MARK_ACTIVE_INSTANCE:return((e,{payload:{id:t}})=>e.activeInstance!==t?Object.assign(Object.assign({},e),{activeInstance:t}):e)(e,s);case r.ActionTypes.FILTER_OUT_COLUMNS:return((e,t)=>{const s=i.LIST_VIEW_COLUMNS.filter(e=>-1===t.payload.indexOf(e.sortField));return Object.assign(Object.assign({},e),{viewTypeColumns:Object.assign(Object.assign({},e.viewTypeColumns),{[n.ViewType.List]:s,[n.ViewType.CondensedList]:s})})})(e,s)}return e}})),define("modules/clean/react/files_view/data/selectors/files_view_selectors",["require","exports","modules/clean/react/files_view/data/reducer","modules/clean/redux/namespaces","modules/clean/redux/selectors"],(function(e,t,s,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.previewThumbnailsToLoad=t.previewThumbnails=t.selectInstances=t.isActiveFilesView=t.currentScroll=t.fileRename=t.scopedNumVisibleColumns=t.scopedSorts=t.viewTypeColumns=t.scopedColumnsIndex=t.viewTypes=void 0;const r=e=>i.getStateAtNamespace(e,o.FILES_VIEW_NAMESPACE_KEY)||s.defaultFilesViewState;t.viewTypes=e=>r(e).viewTypes,t.scopedColumnsIndex=e=>r(e).scopedColumnsIndex,t.viewTypeColumns=e=>r(e).viewTypeColumns,t.scopedSorts=e=>r(e).scopedSorts,t.scopedNumVisibleColumns=e=>r(e).scopedNumVisibleColumns,t.fileRename=e=>r(e).fileRename,t.currentScroll=e=>r(e).currentScroll,t.isActiveFilesView=(e,t)=>r(e).activeInstance===t,t.selectInstances=e=>r(e).instances,t.previewThumbnails=e=>r(e).previewThumbnails,t.previewThumbnailsToLoad=e=>{const s=[],o=t.previewThumbnails(e);for(const e in o)!0===o[e].isLoading&&o[e].file_info&&s.push(o[e].file_info);return s}})),define("modules/clean/react/files_view/data/selectors/instance_selectors",["require","exports","reselect","modules/clean/react/browse/models","modules/clean/react/files_view/constants","modules/clean/react/files_view/data/selectors/files_view_selectors","modules/clean/react/files_view/data/store","modules/clean/react/files_view/file_grouper","modules/clean/react/files_view/view_type","modules/clean/react/files_view/util","modules/core/assert"],(function(e,t,s,o,i,r,a,n,l,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.selectExpManualTagging=t.selectExpFlowsAutomatedFolderUI=t.selectExpFlowsAutoUnzipLambda=t.selectExpAutoPDFConversionBackend=t.selectNumVisibleColumns=t.selectScopedSort=t.selectPreferredColumns=t.selectColumnsIndex=t.selectViewType=t.selectViewTypes=t.selectViewTypeScope=t.selectItemsForUnityListener=t.selectItemIds=t.selectSections=t.selectHasItemsSelected=t.selectNumItemsSelected=t.selectShouldShowFileNameLocation=t.selectShouldShowFileNameHighlights=t.selectCutItems=t.selectClipboard=t.selectIsMobileMode=t.selectIsCompactMode=t.selectInlineActionBar=t.selectIsActionBarEnabled=t.selectEligibleForFirstTaskSubtitle=t.selectRenderFilenameSubtitleAsLink=t.selectHighDensity=t.selectFileRename=t.selectResponsive=t.selectSelection=t.selectDisabledMultiselect=t.selectIsSearchMode=t.selectCurrentSort=t.selectIsListView=t.selectIsGridView=t.selectArePostTTIModulesLoaded=t.selectUser=t.selectContext=t.selectFileHasAutomatedRuleMap=t.selectCurrentFolderInfo=t.selectMainItems=t.selectDropTargetHighlightMode=t.selectInstance=void 0;const u=(e,t)=>r.selectInstances(e).get(t.instanceId);t.selectInstance=(e,t)=>{const s=u(e,t);return d.assert(!!s,`[FilesView] Instance '${t.instanceId}' must be defined in redux store before mounting`),s};const _=e=>(s,o)=>e(t.selectInstance(s,o)),p=e=>(t,s)=>e(u(t,s));t.selectDropTargetHighlightMode=_(e=>e.dropTargetHighlightMode),t.selectMainItems=_(e=>e.items),t.selectCurrentFolderInfo=_(e=>e.currentFolderInfo),t.selectFileHasAutomatedRuleMap=_(e=>e.fileHasAutomatedRuleMap),t.selectContext=_(e=>e.context),t.selectUser=_(e=>e.user),t.selectArePostTTIModulesLoaded=_(e=>e.arePostTTIModulesLoaded),t.selectIsGridView=(e,s)=>[l.ViewType.Grid,l.ViewType.LargeGrid].includes(t.selectViewType(e,s)),t.selectIsListView=(e,s)=>[l.ViewType.List,l.ViewType.CondensedList].includes(t.selectViewType(e,s)),t.selectCurrentSort=_(e=>e.currentSort),t.selectIsSearchMode=_(e=>e.isSearchMode),t.selectDisabledMultiselect=_(e=>!!e.disabledMultiselect),t.selectSelection=_(e=>e.selection),t.selectResponsive=_(e=>e.responsive),t.selectFileRename=_(e=>e.fileRename),t.selectHighDensity=_(e=>e.highDensity),t.selectRenderFilenameSubtitleAsLink=_(e=>e.renderFilenameSubtitleAsLink),t.selectEligibleForFirstTaskSubtitle=_(e=>e.eligibleForFirstTaskSubtitle),t.selectIsActionBarEnabled=_(e=>e.isActionBarEnabled),t.selectInlineActionBar=_(e=>e.inlineActionBar),t.selectIsCompactMode=(e,s)=>!t.selectResponsive(e,s).isMatchedLarge,t.selectIsMobileMode=(e,s)=>{const o=t.selectResponsive(e,s);return c.isMobileMode(o)},t.selectClipboard=_(e=>e.clipboard),t.selectCutItems=(e,s)=>{const o=t.selectClipboard(e,s);return o&&"cut"===o.action?new Map(o.files.map(e=>[e.fq_path,e])):new Map},t.selectShouldShowFileNameHighlights=(e,s)=>t.selectIsSearchMode(e,s),t.selectShouldShowFileNameLocation=(e,s)=>t.selectIsSearchMode(e,s),t.selectNumItemsSelected=(e,s)=>t.selectSelection(e,s).selected.size,t.selectHasItemsSelected=(e,s)=>t.selectNumItemsSelected(e,s)>0,t.selectSections=s.createSelector(t.selectIsGridView,t.selectCurrentSort,t.selectMainItems,t.selectIsSearchMode,(e,t,s,o)=>e&&t?n.getSections(s,t.sortField,t.sortDirection,o):n.EMPTY_SECTIONS),t.selectItemIds=s.createSelector(t.selectMainItems,e=>e.toArray().map(e=>e instanceof o.File?e.fq_path:e instanceof o.FileSharedWithMe?e.file_id:"")),t.selectItemsForUnityListener=s.createSelector(t.selectMainItems,t.selectCurrentFolderInfo,(e,t)=>t?e.concat(t):e),t.selectViewTypeScope=p(e=>(null==e?void 0:e.viewTypeScope)||i.VIEW_TYPE_GLOBAL_SCOPE),t.selectViewTypes=p(e=>(null==e?void 0:e.viewTypes)||[]),t.selectViewType=s.createSelector(r.viewTypes,t.selectViewTypes,t.selectViewTypeScope,(e,t,s)=>{let o;return o=s in e?e[s]:s in i.defaultViewTypes?i.defaultViewTypes[s]:e[i.VIEW_TYPE_GLOBAL_SCOPE],t.includes(o)?o:l.ViewType.List}),t.selectColumnsIndex=s.createSelector(r.scopedColumnsIndex,t.selectViewTypeScope,t.selectIsSearchMode,(e,t,s)=>{if(e&&!s)return t in e?e[t]:e[i.VIEW_TYPE_GLOBAL_SCOPE]||{}}),t.selectPreferredColumns=s.createSelector(t.selectColumnsIndex,t.selectViewType,r.viewTypeColumns,(e,t,s)=>{if(!e)return;const[o,...i]=s[t],r=Object.keys(e).reduce((t,s)=>{const o=parseInt(s,10);return t[e[o]]=o,t},{}),a=[],n={};for(const e of i){const t=r[e.sortField];void 0===t||0===t?a.push(e):n[t]=e}const l=[o];for(let e=1;e<=i.length;e++){const t=n[e]||a.shift();t&&l.push(t)}return l}),t.selectScopedSort=s.createSelector(r.scopedSorts,t.selectViewTypeScope,(e,t)=>{if(e)return t in e?e[t]:e[i.VIEW_TYPE_GLOBAL_SCOPE]}),t.selectNumVisibleColumns=s.createSelector(r.scopedNumVisibleColumns,t.selectViewTypeScope,(e,t)=>{if(e)return t in e?e[t]:e[i.VIEW_TYPE_GLOBAL_SCOPE]}),t.selectExpAutoPDFConversionBackend=p(e=>(null==e?void 0:e.expAutoPDFConversionBackend)||!1),t.selectExpFlowsAutoUnzipLambda=p(e=>(null==e?void 0:e.expFlowsAutoUnzipLambda)||!1),t.selectExpFlowsAutomatedFolderUI=p(e=>(null==e?void 0:e.expFlowsAutomatedFolderUI)||!1),t.selectExpManualTagging=p(e=>(null==e?void 0:e.expManualTagging)||"OFF"),a.getStoreForFilesView()})),define("modules/clean/react/files_view/data/selectors/item_selectors",["require","exports","modules/clean/react/browse/models","modules/clean/react/files_view/constants","modules/clean/react/files_view/data/selectors/instance_selectors","modules/clean/react/files_view/view_type","modules/clean/react/files_view/util","modules/core/assert","modules/clean/react/flows/types","modules/clean/tagging/experiments"],(function(e,t,s,o,i,r,a,n,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.selectFlowsBadge=t.selectIsCutToClipboard=t.selectIconSize=t.selectShouldShowFirstTaskSubtitle=t.selectSnippetRows=t.selectRowHeight=t.selectShouldShowTags=t.selectShouldShowSnippets=t.selectFirstValidSnippet=t.selectSnippets=t.selectIsTooltipEnabled=t.selectShowCDMUserEducationEffects=t.selectShouldShowStar=t.selectIsNoAccessSharedFolder=t.selectShouldShowSubtitle=t.selectRenameState=t.selectUserEducationEffectName=t.selectShouldShowUserEducationEffects=t.selectIsCheckboxVisible=t.selectIsItemSelected=t.selectItemSelectionId=t.selectItemAssertFileOrFileSharedWithMe=t.selectItem=void 0,t.selectItem=(e,t)=>{const s=i.selectMainItems(e,t),o=s&&s.get(t.itemIndex);return n.assert(!!o,`Item undefined at index: ${t.itemIndex}`),o},t.selectItemAssertFileOrFileSharedWithMe=(e,o)=>{const i=t.selectItem(e,o);return n.assert(i instanceof s.File||i instanceof s.FileSharedWithMe,`item must be File or FileSharedWithMe at index: ${o.itemIndex}`),i},t.selectItemSelectionId=(e,o)=>{const i=t.selectItemAssertFileOrFileSharedWithMe(e,o);return i instanceof s.File?o.fileToId(i):i.file_id},t.selectIsItemSelected=(e,s)=>i.selectSelection(e,s).selected.has(t.selectItemSelectionId(e,s)),t.selectIsCheckboxVisible=(e,t)=>t.isHovered||i.selectHasItemsSelected(e,t)||i.selectIsCompactMode(e,t),t.selectShouldShowUserEducationEffects=(e,t)=>{const{rowIndex:s}=t;return 0===s||i.selectUser(e,t).is_cdm_member&&(2===t.rowIndex||1===t.rowIndex)},t.selectUserEducationEffectName=(e,s)=>t.selectShouldShowUserEducationEffects(e,s)?"FileNameLabel-"+s.rowIndex:void 0,t.selectRenameState=(e,o)=>{const r=i.selectFileRename(e,o),a=t.selectItem(e,o);if(r&&a instanceof s.File)return r.file.fq_path===a.fq_path?r.state:void 0},t.selectShouldShowSubtitle=(e,s)=>!t.selectRenameState(e,s)&&i.selectViewType(e,s)!==r.ViewType.CondensedList,t.selectIsNoAccessSharedFolder=(e,o)=>{const i=t.selectItem(e,o);return i instanceof s.File&&s.File.isNoAccessSharedFolder(i)},t.selectShouldShowStar=(e,s)=>i.selectArePostTTIModulesLoaded(e,s)&&!t.selectIsNoAccessSharedFolder(e,s)&&!i.selectContext(e,s).isInsideVaultFolder&&!i.selectIsMobileMode(e,s),t.selectShowCDMUserEducationEffects=(e,o)=>{const i=t.selectItem(e,o);return i instanceof s.File&&s.File.isTeamMemberFolder(i)},t.selectIsTooltipEnabled=(e,t)=>i.selectArePostTTIModulesLoaded(e,t),t.selectSnippets=(e,o)=>{const i=t.selectItem(e,o);if(i instanceof s.Paper||i instanceof s.File||i instanceof s.FileSharedWithMe)return i.snippets},t.selectFirstValidSnippet=(e,s)=>{const o=t.selectSnippets(e,s);return o&&o.find(({highlight_spans:e})=>!!e&&e.length>0)},t.selectShouldShowSnippets=(e,s)=>Boolean(!i.selectIsMobileMode(e,s)&&t.selectFirstValidSnippet(e,s)),t.selectShouldShowTags=(e,o)=>{const r=t.selectItem(e,o),a=i.selectExpManualTagging(e,o);return c.isTaggingEnabled(a)&&r instanceof s.File&&r.tags&&r.tags.length>0},t.selectRowHeight=(e,s)=>{const a=t.selectShouldShowSnippets(e,s),n=i.selectHighDensity(e,s),l=i.selectViewType(e,s),c=t.selectShouldShowTags(e,s);if(a){const i=t.selectSnippetRows(e,s);if(!i)return c?o.DEFAULT_ROW_HEIGHT_WITH_SNIPPETS+o.TAGS_HEIGHT:o.DEFAULT_ROW_HEIGHT_WITH_SNIPPETS;const r=o.ROW_VERTICAL_PADDING+o.ROW_TITLE_HEIGHT+o.ROW_SUBTITLE_HEIGHT+o.ROW_SNIPPET_VERTICAL_MARGIN+o.SNIPPET_HEIGHT_PER_ROW*i;return c?r+o.TAGS_HEIGHT:r}return l===r.ViewType.CondensedList?o.DEFAULT_ROW_HEIGHT_CONDENSED_LIST:n?c?o.DEFAULT_ROW_HEIGHT_DENSE+o.TAGS_HEIGHT:o.DEFAULT_ROW_HEIGHT_DENSE:c?o.DEFAULT_ROW_HEIGHT+o.TAGS_HEIGHT:o.DEFAULT_ROW_HEIGHT};t.selectSnippetRows=(e,s)=>{const i=t.selectFirstValidSnippet(e,s);if(!i||!i.highlight_spans)return 0;const{containerWidth:r,numVisibleColumns:a}=s,n=r?r*o.FILE_NAME_CELL_SEARCH_FLEX_BASIS[a]/100:void 0;if(!n)return 3;const l=i.highlight_spans.map(e=>e.highlight_str).join().length,c=Math.max(n-o.MEDIA_CELL_ICON_WIDTH-o.SNIPPET_HORIZONTAL_PADDING,1),d=6*l;return Math.min(Math.ceil(d/c),3)},t.selectShouldShowFirstTaskSubtitle=(e,t)=>Boolean(i.selectEligibleForFirstTaskSubtitle(e,t)&&d(e,t));const d=(e,o)=>{const r=i.selectContext(e,o),a=t.selectItem(e,o),n=i.selectUser(e,o);return a instanceof s.File&&(r.isInsideMyTeamFolderTree&&r.isCurrentlyInRoot&&a.fq_path===n.cdm_tmf_path)};t.selectIconSize=(e,t)=>i.selectViewType(e,t)===r.ViewType.CondensedList?32:void 0,t.selectIsCutToClipboard=(e,s)=>{const o=i.selectCutItems(e,s),r=t.selectItem(e,s);return a.isCutToClipboard(r,o)},t.selectFlowsBadge=(e,o)=>{const r=t.selectItemAssertFileOrFileSharedWithMe(e,o);if(r instanceof s.FileSharedWithMe)return l.FlowsRuleType.None;const a=i.selectFileHasAutomatedRuleMap(e,o),n=i.selectExpAutoPDFConversionBackend(e,o),c=i.selectExpFlowsAutoUnzipLambda(e,o),d=i.selectExpFlowsAutomatedFolderUI(e,o),u=a.get(r.fq_path);return u===l.FlowsRuleType.AutoPDF&&n||u===l.FlowsRuleType.AutoUnzip&&c||null!=u&&u!==l.FlowsRuleType.None&&d?u:l.FlowsRuleType.None}})),define("modules/clean/react/files_view/data/selectors/list_selectors",["require","exports","tslib","reselect","modules/clean/react/browse/models","modules/clean/react/files_view/constants","modules/clean/react/files_view/data/selectors/instance_selectors","modules/clean/react/files_view/file_list_utils","modules/clean/react/files_view/view_type","modules/clean/react/files_view/util","modules/clean/tagging/experiments","modules/clean/media_filters/gating"],(function(e,t,s,o,i,r,a,n,l,c,d,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.estimateSnippetRowsNeeded=t.getFileRowHeight=t.shouldShowSnippets=t.getFirstValidSnippet=t.getFilesViewListRowItems=t.selectListItemBuffer=t.selectListItemHeights=t.selectListItems=void 0,t.selectListItems=(e,s)=>{const o=a.selectMainItems(e,s),i=!!a.selectDisabledMultiselect(e,s),r=a.selectViewType(e,s)===l.ViewType.CondensedList,n=a.selectIsActionBarEnabled(e,s);return t.getFilesViewListRowItems(Object.assign(Object.assign({},s),{isCheckboxDisabled:i,isCondensedListView:r,items:o,isActionBarEnabled:n}))},t.selectListItemHeights=o.createSelector(t.selectListItems,e=>e.map(({height:e})=>e)),t.selectListItemBuffer=(e,t)=>a.selectViewType(e,t)===l.ViewType.CondensedList?20:void 0;const _=o.createSelectorCreator(o.defaultMemoize,(e,t)=>Object.keys(e).length===Object.keys(t).length&&Object.keys(e).every(s=>t.hasOwnProperty(s)&&e[s]===t[s]));t.getFilesViewListRowItems=_(({activeDropTarget:e,arePostTTIModulesLoaded:t,canDisplayFolderSizes:s,context:o,createNewFolderState:i,dropTargetHighlightMode:r,fileRename:a,focusedFileIndex:n,isCheckboxDisabled:l,isCompactMode:c,isSearchMode:d,isSelectMode:u,items:_,selection:p,sharingServiceInfo:m,starredState:f,user:h,visibleColumns:g,responsive:S,containerWidth:E,highDensity:T,isCondensedListView:b,fileToId:w,renderSharedWithController:I,expVaultEnableViewOnlySharing:v,isActionBarEnabled:O,expManualTagging:C,mediaFiltersVariant:F})=>({activeDropTarget:e,arePostTTIModulesLoaded:t,canDisplayFolderSizes:s,context:o,createNewFolderState:i,dropTargetHighlightMode:r,fileRename:a,focusedFileIndex:n,isCheckboxDisabled:l,isCompactMode:c,isSearchMode:d,isSelectMode:u,items:_,selection:p,sharingServiceInfo:m,starredState:f,user:h,visibleColumns:g,responsive:S,containerWidth:E,highDensity:T,isCondensedListView:b,fileToId:w,renderSharedWithController:I,expVaultEnableViewOnlySharing:v,isActionBarEnabled:O,expManualTagging:C,mediaFiltersVariant:F}),e=>{const{activeDropTarget:o,context:a,createNewFolderState:l,dropTargetHighlightMode:u,items:_,fileRename:p,focusedFileIndex:m,selection:f,user:h,visibleColumns:g,responsive:S,containerWidth:E,highDensity:T,fileToId:b,isCondensedListView:w,isActionBarEnabled:I,mediaFiltersVariant:v}=e,O=s.__rest(e,["activeDropTarget","context","createNewFolderState","dropTargetHighlightMode","items","fileRename","focusedFileIndex","selection","user","visibleColumns","responsive","containerWidth","highDensity","fileToId","isCondensedListView","isActionBarEnabled","mediaFiltersVariant"]),C=!!e.expVaultEnableViewOnlySharing,F=d.isTaggingEnabled(e.expManualTagging),R=w?r.DEFAULT_ROW_HEIGHT_CONDENSED_LIST:T?r.DEFAULT_ROW_HEIGHT_DENSE:r.DEFAULT_ROW_HEIGHT,A=w?32:void 0,y=_.toArray().map((e,s)=>{if(e instanceof i.UserDefinedItem)return{type:"UserDefinedItemRow",props:{userDefinedItem:e},height:R};const l=E?E*r.FILE_NAME_CELL_SEARCH_FLEX_BASIS[g.length]/100:void 0,d=t.shouldShowSnippets({file:e,responsive:S}),_=t.estimateSnippetRowsNeeded({snippets:e.snippets,fileNameCellWidth:l}),y=t.getFileRowHeight({file:e,showSnippets:d,snippetRows:_,highDensity:T,isCondensedListView:w,showTags:F,mediaFiltersVariant:v,fileNameCellWidth:l});if(e instanceof i.Paper)return{type:"PaperRow",props:{isSearchMode:O.isSearchMode,paper:e,visibleColumns:g,arePostTTIModulesLoaded:O.arePostTTIModulesLoaded,showSnippets:d,snippetRows:_,height:y,showStar:O.arePostTTIModulesLoaded&&!c.isMobileMode(S)},height:y};const D="fq_path"in e?b(e):e.file_id,L=f.selected.has(D);if(e instanceof i.FileSharedWithMe)return{type:"FileSharedWithMeRow",props:{file:e,visibleColumns:g,showSnippets:d,snippetRows:_,height:y,isSelected:L,arePostTTIModulesLoaded:O.arePostTTIModulesLoaded,isSelectMode:O.isSelectMode,isFocused:s===m,iconSize:A},height:y};const M=n.canFileBeHighlightedDropTarget({file:e,dropTargetHighlightMode:u});return{type:"FileRow",key:`file:${encodeURIComponent(e.file_id)}:${encodeURIComponent(e.fq_path)}`,itemIndex:s,props:Object.assign(Object.assign({},O),{file:e,isActionBarEnabled:I,isActiveDropTarget:M&&o===e,isAvailableDropTarget:M,isFocused:s===m,isSelected:L,isExtensionsMenuDisabled:!0,isSharingDisabled:n.isSharingDisabledForFile({context:a,file:e,user:h,expVaultEnableViewOnlySharing:C}),renameState:p&&p.file.fq_path===e.fq_path?p.state:void 0,visibleColumns:g,height:y,containerWidth:E,isCondensedListView:w,responsive:S}),height:y}});return l&&"CREATE_FOLDER_INACTIVE"!==l&&y.unshift({type:"NewFolderRow",props:{createNewFolderState:l,isInsideMyTeamFolderTree:a.isInsideTeamFolderTree,iconSize:A},height:R}),y}),t.getFirstValidSnippet=e=>e.find(({highlight_spans:e})=>!!e&&e.length>0),t.shouldShowSnippets=({file:{snippets:e},responsive:s})=>!!e&&!!t.getFirstValidSnippet(e)&&(s.isMatchedLarge||s.isMatchedMedium),t.getFileRowHeight=({file:e,showSnippets:t,snippetRows:s,highDensity:o,isCondensedListView:i,showTags:a,mediaFiltersVariant:n,fileNameCellWidth:l})=>{const d=a&&c.isFile(e)&&e.tags&&e.tags.length>0?r.TAGS_HEIGHT:0,u=p({file:e,mediaFiltersVariant:n,fileNameCellWidth:l});if(e.snippets&&t){if(!s)return r.DEFAULT_ROW_HEIGHT_WITH_SNIPPETS+d+u;return r.ROW_VERTICAL_PADDING+r.ROW_TITLE_HEIGHT+r.ROW_SUBTITLE_HEIGHT+r.ROW_SNIPPET_VERTICAL_MARGIN+r.SNIPPET_HEIGHT_PER_ROW*s+d+u}return i?r.DEFAULT_ROW_HEIGHT_CONDENSED_LIST:o?r.DEFAULT_ROW_HEIGHT_DENSE+d+u:r.DEFAULT_ROW_HEIGHT+d+u};const p=({file:e,mediaFiltersVariant:s,fileNameCellWidth:o})=>{var i,a,n,l;const d=c.isFile(e)&&!!(null===(a=null===(i=e.media_data)||void 0===i?void 0:i.data)||void 0===a?void 0:a.date_taken);if(u.isMediaMetadataSearchEnabled(s)){if(c.isFile(e)){const s=(null!==(l=null===(n=e.media_data)||void 0===n?void 0:n.display_info)&&void 0!==l?l:[]).map(e=>t.estimateSnippetRowsNeeded({snippets:[{highlight_spans:e.highlights}],fileNameCellWidth:o})).reduce((e,t)=>e+t,0),i=d?s+1:s;return Math.min(i,3)*r.MEDIA_INFO_ITEM_HEIGHT}return 0}return u.isMediaFiltersEnabled(s)&&d?r.MEDIA_INFO_ITEM_HEIGHT:0};t.estimateSnippetRowsNeeded=({snippets:e,fileNameCellWidth:s})=>{if(!e)return 0;const o=t.getFirstValidSnippet(e);if(!o||!o.highlight_spans)return 0;if(!s)return 3;const i=o.highlight_spans.map(e=>e.highlight_str).join().length,a=Math.max(s-r.MEDIA_CELL_ICON_WIDTH-r.SNIPPET_HORIZONTAL_PADDING,1),n=6*i;return Math.min(Math.ceil(n/a),3)}})),define("modules/clean/react/files_view/data/store",["require","exports","modules/clean/react/files_view/data/reducer","modules/clean/redux/namespaces","modules/clean/redux/store"],(function(e,t,s,o,i){"use strict";let r;Object.defineProperty(t,"__esModule",{value:!0}),t.getStoreForFilesView=void 0,t.getStoreForFilesView=()=>(r||(r=i.getStoreAndRegisterReducers({[o.FILES_VIEW_NAMESPACE_KEY]:s.filesViewReducer})),r)})),define("modules/clean/react/files_view/data/types",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ActionTypes=void 0,(function(e){e.SET_VIEW_TYPE="FILES_VIEW/SET_VIEW_TYPE",e.SET_VIEW_TYPES="FILES_VIEW/SET_VIEW_TYPES",e.SET_VIEW_TYPE_SCOPE="FILES_VIEW/SET_VIEW_TYPE_SCOPE",e.SET_FILE_RENAME="FILES_VIEW/SET_FILE_RENAME",e.SET_COLUMNS_INDEX="FILES_VIEW/SET_COLUMNS_INDEX",e.SET_SCOPED_COLUMNS_INDEX="FILES_VIEW/SET_SCOPED_COLUMNS_INDEX",e.SET_SORT="FILES_VIEW/SET_SORT",e.SET_SCOPED_SORTS="FILES_VIEW/SET_SCOPED_SORTS",e.SET_SCROLL="FILES_VIEW/SET_SCROLL",e.UPDATE_INSTANCE="FILES_VIEW/UPDATE_INSTANCE",e.UPSERT_INSTANCE="FILES_VIEW/UPSERT_INSTANCE",e.DELETE_INSTANCE="FILES_VIEW/DELETE_INSTANCE",e.PREVIEW_THUMBNAILS_LOADING="FILES_VIEW/PREVIEW_THUMBNAILS_LOADING",e.PREVIEW_THUMBNAILS_LOADED="FILES_VIEW/PREVIEW_THUMBNAILS_LOADED",e.PREVIEW_THUMBNAILS_REMOVED="FILES_VIEW/PREVIEW_THUMBNAILS_REMOVED",e.MARK_ACTIVE_INSTANCE="FILES_VIEW/MARK_ACTIVE_INSTANCE",e.FILTER_OUT_COLUMNS="FILES_VIEW/FILTER_OUT_COLUMNS"})(t.ActionTypes||(t.ActionTypes={}))})),define("modules/clean/react/files_view/file_actions/api_v2",["require","exports","tslib","api_v2/user_client","modules/clean/filepath/filepath","modules/core/exception"],(function(e,t,s,o,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isPathLookupFailure=t.isFailure=t.createFolder=t.deleteFiles=t.copyFiles=t.moveFiles=t.renameFile=t.undo=t.getFilenameFromActionInfo=t.fileInfoIsFqPathBased=t.createUndefinedRpcResult=t.EXCLOG_TAG=void 0,i=s.__importStar(i);t.EXCLOG_TAG="file_actions_client_error",t.createUndefinedRpcResult=e=>({isError:!0,error:{".tag":"undefined_error"},error_summary:"undefined_error",jobId:e});const a=(e,s)=>{r.reportStack(JSON.stringify("error"in s?s.error:s),{severity:r.SEVERITY.NON_CRITICAL,silent:!0,tags:[t.EXCLOG_TAG,`${t.EXCLOG_TAG}_${e}`]})};function n(e){return Boolean("fq_path"in e?e:null)}function l(e){return n(e)?i.filename(e.fq_path):e.name}function c(e,o){return s.__awaiter(this,void 0,void 0,(function*(){try{const s=yield e();if("complete"===s[".tag"])return _("relocation_batch",s),{isError:!1,result:s};{let e=void 0;do{yield new Promise(e=>setTimeout(e,1e3)),e=yield o(s.async_job_id)}while(e&&"in_progress"===e[".tag"]);if("complete"===e[".tag"]){const t=e;for(const e of t.entries){const t=d(e,s.async_job_id);if(t)return t}return _("relocation_batch",t),{isError:!1,result:t,jobId:s.async_job_id}}return a("relocation_batch_poll",e),t.createUndefinedRpcResult(s.async_job_id)}}catch(e){return a("relocation_batch_poll",e),e&&e.error&&e.error[".tag"]?{isError:!0,error:e.error,error_summary:e.error[".tag"]}:t.createUndefinedRpcResult()}}))}function d(e,t){if("failure"===e[".tag"]&&"relocation_error"===e.failure[".tag"]&&"to"===e.failure.relocation_error[".tag"]&&"file_system_warnings"===e.failure.relocation_error.to[".tag"])return{isError:!0,error:e.failure.relocation_error,error_summary:"file_system_warnings",jobId:t}}function u(e){var s;if(null===(s=null==e?void 0:e.error)||void 0===s?void 0:s[".tag"]){const t={".tag":"failure",failure:{".tag":"relocation_error",relocation_error:e.error}},s=d(t,void 0);return void 0!==s?s:{isError:!1,result:{changeset_data:[],entries:[t]}}}return t.createUndefinedRpcResult()}t.fileInfoIsFqPathBased=n,t.getFilenameFromActionInfo=l,t.undo=function(e,i){return s.__awaiter(this,void 0,void 0,(function*(){const s=new o.UserApiV2Client;try{return{isError:!1,result:yield s.ns("files").rpc("undo_batch",{entries:e},{subjectUserId:i.id})}}catch(e){return a("undo_batch",e),e&&e.error&&e.error[".tag"]?{isError:!0,error:e.error,error_summary:e.summary}:t.createUndefinedRpcResult()}}))},t.renameFile=function(e,t,r,a){return s.__awaiter(this,void 0,void 0,(function*(){const s=i.parent_dir(e),n=i.normalize(s)+"/"+t,l=new o.UserApiV2Client,{checkFSWs:d,synchronousSingleFileActions:_}="boolean"==typeof a?{checkFSWs:a,synchronousSingleFileActions:!1}:a;if(_)try{const t=yield l.ns("files").rpc("move_v2",{from_path:e,to_path:n,autorename:!0,allow_ownership_transfer:!1,fsw_request:d?{".tag":"check"}:void 0},{subjectUserId:r});return{isError:!1,result:{changeset_data:t.changeset_data,entries:[{".tag":"success",success:t.metadata}]}}}catch(e){return u(e)}return yield c(()=>l.ns("files").rpc("move_batch_v2",{entries:[{from_path:e,to_path:n}],autorename:!0,allow_ownership_transfer:!1,fsw_request:d?{".tag":"check"}:void 0},{subjectUserId:r}),e=>l.ns("files").rpc("move_batch/check_v2",{async_job_id:e},{subjectUserId:r}))}))},t.moveFiles=function(e,t,i,r,a){return s.__awaiter(this,void 0,void 0,(function*(){const s=new o.UserApiV2Client,{allowOwnershipTransfer:d,checkFSWs:_,synchronousSingleFileActions:p}="object"==typeof r?r:{allowOwnershipTransfer:r,checkFSWs:a,synchronousSingleFileActions:!1},m=e=>{const s=`${t}/${l(e)}`;return n(e)?{from_path:e.fq_path,to_path:s}:{from_path:e.id,to_path:s}};if(p&&1===e.length&&n(e[0])&&!e[0].is_dir)try{const t=yield s.ns("files").rpc("move_v2",Object.assign(Object.assign({},m(e[0])),{allow_ownership_transfer:!!d,fsw_request:_?{".tag":"check"}:void 0}),{subjectUserId:i});return{isError:!1,result:{changeset_data:t.changeset_data,entries:[{".tag":"success",success:t.metadata}]}}}catch(e){return u(e)}return yield c(()=>s.ns("files").rpc("move_batch_v2",{entries:e.map(m),autorename:!0,allow_ownership_transfer:!!d,fsw_request:_?{".tag":"check"}:void 0},{subjectUserId:i}),e=>s.ns("files").rpc("move_batch/check_v2",{async_job_id:e},{subjectUserId:i}))}))},t.copyFiles=function(e,t,r,a){return s.__awaiter(this,void 0,void 0,(function*(){const s=new o.UserApiV2Client,{checkFSWs:n,synchronousSingleFileActions:l}="object"==typeof a?a:{checkFSWs:a,synchronousSingleFileActions:!1};if(l&&1===e.length&&!e[0].is_dir)try{const o=yield s.ns("files").rpc("copy_v2",{from_path:e[0].fq_path,to_path:`${t}/${i.filename(e[0].fq_path)}`,autorename:!0,fsw_request:n?{".tag":"check"}:void 0},{subjectUserId:r});return{isError:!1,result:{changeset_data:o.changeset_data,entries:[{".tag":"success",success:o.metadata}]}}}catch(e){return u(e)}return yield c(()=>s.ns("files").rpc("copy_batch_v2",{entries:e.map(e=>({from_path:e.fq_path,to_path:`${t}/${i.filename(e.fq_path)}`})),autorename:!0,fsw_request:n?{".tag":"check"}:void 0},{subjectUserId:r}),e=>s.ns("files").rpc("copy_batch/check_v2",{async_job_id:e},{subjectUserId:r}))}))},t.deleteFiles=function(e,i,r){var n;return s.__awaiter(this,void 0,void 0,(function*(){const l=new o.UserApiV2Client;if(1===e.length&&!e[0].is_dir)try{const t=yield l.ns("files").rpc("delete_v2",{path:e[0].fq_path,fsw_request:r?{".tag":"check"}:void 0},{subjectUserId:i});return{isError:!1,result:{changeset_data:t.changeset_data,entries:[{".tag":"success",metadata:t.metadata}]}}}catch(e){return t.isPathLookupFailure(e)||a("delete_v2",e),(null===(n=null==e?void 0:e.error)||void 0===n?void 0:n[".tag"])?{isError:!1,result:{changeset_data:[],entries:[{".tag":"failure",failure:e.error}]}}:t.createUndefinedRpcResult()}return yield(function(e,o){return s.__awaiter(this,void 0,void 0,(function*(){try{const s=yield e();if("complete"===s[".tag"])return _("delete_batch",s),{isError:!1,result:s};if("other"===s[".tag"])return a("delete_batch",s),t.createUndefinedRpcResult();{let e=void 0;do{yield new Promise(e=>setTimeout(e,1e3)),e=yield o(s.async_job_id)}while(e&&"in_progress"===e[".tag"]);return"complete"===e[".tag"]?(_("delete_batch",e),{isError:!1,result:e,jobId:s.async_job_id}):(a("delete_batch_poll",e),t.createUndefinedRpcResult(s.async_job_id))}}catch(e){return a("delete_batch",e),e&&e.error&&e.error[".tag"]?{isError:!0,error:e.error,error_summary:e.summary}:t.createUndefinedRpcResult()}}))})(()=>l.ns("files").rpc("delete_batch",{entries:e.map(e=>({path:e.fq_path})),fsw_request:r?{".tag":"check"}:void 0},{subjectUserId:i}),e=>l.ns("files").rpc("delete_batch/check",{async_job_id:e},{subjectUserId:i}))}))};const _=(e,t)=>{t.entries.forEach(t=>{".tag"in t&&"failure"===t[".tag"]&&a(e,t.failure)})};t.createFolder=function(e,r,n,l){return s.__awaiter(this,void 0,void 0,(function*(){const s=new o.UserApiV2Client;try{return{isError:!1,result:yield s.ns("files").rpc("create_folder_v2",{path:i.normalize(e)+"/"+r,autorename:!0,fsw_request:l?{".tag":"check"}:void 0},{subjectUserId:n.id})}}catch(e){return a("create_folder",e),e&&e.error&&e.error[".tag"]?{isError:!0,error:e.error,error_summary:e.summary}:t.createUndefinedRpcResult()}}))},t.isFailure=e=>"failure"===e[".tag"],t.isPathLookupFailure=e=>"path_lookup"===e[".tag"]})),define("modules/clean/react/files_view/file_actions/file_from_metadata",["require","exports","modules/clean/react/browse/models"],(function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.folderFromFolderMetadata=t.fileFromMetadata=void 0,t.fileFromMetadata=(e,t)=>{if("file"===t[".tag"]){const o=t,i=Object.assign(Object.assign({},e),{fq_path:o.path_display||e.fq_path,icon:o.icon+"_32",revision_id:o.rev,file_id:o.id});return new s.File(i)}return"folder"===t[".tag"]?new s.File(Object.assign(Object.assign({},e),{fq_path:t.path_display||e.fq_path})):e},t.folderFromFolderMetadata=e=>new s.File({file_id:e.id,fq_path:e.path_display||"",icon:e.icon,is_dir:!0})})),define("modules/clean/react/files_view/file_actions/rollback",["require","exports","tslib","modules/clean/react/browse/api","modules/core/i18n"],(function(e,t,s,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.rollback=void 0,o=s.__importStar(o),t.rollback=({changeset_data:e,userId:t,onSuccess:s})=>{const r={};for(const{ns_id:t,op_id:s}of e){const e=parseInt(s.slice(6),10);r.hasOwnProperty(t)?r[t].push(e):r[t]=[e]}o.rollbackChangeSets({changesets:r,onSuccess:s,userId:t,progressText:i.intl.formatMessage({id:"wKzr7W",defaultMessage:"Undoing…"})})}})),define("modules/clean/react/files_view/file_actions/snackbars",["require","exports","modules/core/i18n"],(function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.deleteCompleteError=t.deleteInProgress=t.deleteCompleteSuccess=t.deleteError=t.renameError=void 0,t.renameError=(e,t)=>{let o;return o="to"===e[".tag"]&&"malformed_path"===e.to[".tag"]?s.intl.formatMessage({id:"rBgywO",defaultMessage:"Name was invalid."}):"from_write"===e[".tag"]&&"team_folder"===e.from_write[".tag"]?s.intl.formatMessage({id:"zqiuDZ",defaultMessage:"Team folders can’t be renamed."}):"from_lookup"===e[".tag"]&&"not_found"===e.from_lookup[".tag"]?s.intl.formatMessage({id:"kdizeA",defaultMessage:"Couldn’t find the file."}):s.intl.formatMessage({id:"pUBm7w",defaultMessage:"Rename failed."}),o},t.deleteError=(e,t)=>s.intl.formatMessage({id:"pjyJun",defaultMessage:"{count, plural, one{Couldn’t delete {count} item.} other{Couldn’t delete {count} items.}}"},{count:e}),t.deleteCompleteSuccess=(e,t)=>t<e?s.intl.formatMessage({id:"QGz6Gm",defaultMessage:"{count, plural, one{Deleted {succesfully_deleted_files} out of {count} item.} other{Deleted {succesfully_deleted_files} out of {count} items.}}"},{count:e,succesfully_deleted_files:t}):s.intl.formatMessage({id:"THAbub",defaultMessage:"{count, plural, one{Deleted {count} item.} other{Deleted {count} items.}}"},{count:t}),t.deleteInProgress=e=>s.intl.formatMessage({id:"z7/sbf",defaultMessage:"{count, plural, one{Deleting {count} item...} other{Deleting {count} items...}}"},{count:e}),t.deleteCompleteError=e=>{if(1===e.length){const t=e[0].failure;if("too_many_files"===t[".tag"]||"too_many_write_operations"===t[".tag"])return s.intl.formatMessage({id:"ane1pD",defaultMessage:"There are too many files in one request. Please retry with fewer files."});if("path_lookup"===t[".tag"]&&"not_found"===t.path_lookup[".tag"])return s.intl.formatMessage({id:"9suezP",defaultMessage:"File does not exist."})}return s.intl.formatMessage({id:"pjyJun",defaultMessage:"{count, plural, one{Couldn’t delete {count} item.} other{Couldn’t delete {count} items.}}"},{count:e.length})}})),define("modules/clean/react/files_view/file_grouper",["require","exports","modules/core/i18n","modules/clean/datetime/datetime","modules/clean/react/browse/constants","modules/clean/react/files_view/sort_types","modules/clean/react/browse/models"],(function(e,t,s,o,i,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getSections=t.EMPTY_SECTIONS=void 0;const n=s.intl.formatMessage({id:"RzhnRl",defaultMessage:"Extensionless"}),l=s.intl.formatMessage({id:"DcKHEo",defaultMessage:"Missing dates"}),c=s.intl.formatMessage({id:"GYhJ5f",defaultMessage:"Deleted content isn’t sorted by last modified"});t.EMPTY_SECTIONS={sectionLabels:[],sectionStartIndices:[]},t.getSections=function(e,t,d,u=!1){const _=[],p=[];let m=null;if(t===r.SortField.CATEGORY)e.forEach((e,t)=>{if(!e)return;const s=(function(e){return e instanceof a.File?a.File.getCategoryDescription(e,!0):i.ExtensionCategories.DOCUMENT})(e);s!==m&&(_.push(s),p.push(t),m=s)});else if(t===r.SortField.EXTENSION)e.forEach((e,t)=>{if(!e)return;const s=(function(e){return e instanceof a.File?e.is_dir?i.FileTypeCapitalizedCategoryTranslations.FOLDER:a.File.getExtension(e).toUpperCase():n})(e);if(s!==m){let e=s;""===s&&(e=n),_.push(e),p.push(t),m=s}});else if(t===r.SortField.MODIFIED)if(d===r.SortDirection.DESCENDING){const t=o.getTimeBands(Date.now());e.forEach((e,o)=>{if(!e)return;let i;if(u&&e instanceof a.File&&e.isDeleted)i=c;else{const o=a.itemTimestampInMs(e);i=o>=t.today?s.intl.formatMessage({id:"JDRaFD",defaultMessage:"Today"}):o>=t.yesterday?s.intl.formatMessage({id:"2iSDDx",defaultMessage:"Yesterday"}):o>=t.thisWeek?s.intl.formatMessage({id:"e3KIPg",defaultMessage:"This week"}):o>=t.lastWeek?s.intl.formatMessage({id:"dsHtkw",defaultMessage:"Last week"}):o>=t.thisMonth?s.intl.formatMessage({id:"G0eFMx",defaultMessage:"This month"}):o>=t.lastMonth?s.intl.formatMessage({id:"nM5Fv4",defaultMessage:"Last month"}):o>=t.lastThreeMonths?s.intl.formatMessage({id:"U7dFRR",defaultMessage:"Three months ago"}):s.intl.formatMessage({id:"Y/NN0h",defaultMessage:"Older"})}i!==m&&(_.push(i),p.push(o),m=i)})}else e.forEach((e,t)=>{if(!e)return;let o;o=u&&e instanceof a.File&&e.isDeleted?c:a.itemTimestampInMs(e)?s.intl.formatDate(a.itemTimestampInMs(e),{year:"numeric",month:"long"}):l,o!==m&&(_.push(o),p.push(t),m=o)});return{sectionLabels:_,sectionStartIndices:p}}})),define("modules/clean/react/files_view/file_actions/file_media_actions",["require","exports","tslib","react","spectrum/media_table/index","modules/clean/react/extensions/split_share_button","modules/clean/react/files_view/overflow_menu","modules/clean/react/files_view/util","modules/clean/react/vault/lib/browse_utils","modules/clean/user_survey/user_survey"],(function(e,t,s,o,i,r,a,n,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FileMediaActions=void 0,o=s.__importDefault(o);class d extends o.default.PureComponent{constructor(){super(...arguments),this.state={isActionDropdownOpen:!1},this.onSplitShareDropdownOpen=()=>{this.onActionDropdownOpen()},this.onActionDropdownOpen=()=>{this.setState({isActionDropdownOpen:!0})},this.onActionDropdownClose=()=>{this.setState({isActionDropdownOpen:!1})},this.logSplitShareButton=e=>{c.UserSurvey.trackEvent("share_item","browse"),n.isFile(this.props.file)&&this.props.file.is_in_vault_folder&&l.logShareFromInsideVault(this.props.file.is_dir)}}render(){const{arePostTTIModulesLoaded:e,canDisplayFolderSizes:t,file:s,getOverflowMenuActions:n,isCompactMode:l,isHovered:c,isSelectMode:d,isSharingDisabled:u,onPresentInZoom:_,shareButtonLabel:p,showShareButton:m,showBorders:f,user:h,viewportTopOffset:g}=this.props,S=this.props.onShowShare||(()=>{});return d?null:o.default.createElement(i.MediaActions,null,!u&&!1!==m&&o.default.createElement(r.SplitShareButton,{shareButtonLabel:p,onShowShare:S,logShareButtonClick:this.logSplitShareButton,isVisible:c&&!l||this.state.isActionDropdownOpen,user:h,files:[s],onDropdownOpen:this.onSplitShareDropdownOpen,onDropdownClose:this.onActionDropdownClose,onPresentInZoom:_,variant:"opacity",shouldUsePortalPopover:!0}),e&&o.default.createElement(a.FilesViewOverflowMenu,{canDisplayFolderSizes:t,file:s,getOverflowMenuActions:n,showBorders:c||!!f,viewportTopOffset:g,ariaHidden:!0}))}}t.FileMediaActions=d,d.displayName="FileMediaActions"})),define("modules/clean/react/files_view/file_actions/file_media_actions_v2",["require","exports","tslib","classnames","react","react-redux","modules/clean/react/files_view/data/selectors/instance_selectors","modules/core/browser_detection"],(function(e,t,s,o,i,r,a,n){"use strict";function l(e){e.stopPropagation()}function c(e){const{FilesViewInlineActionBar:t,file:s,highlighted:r,onHoverLocked:a,isMobile:c}=e,d=o.default("brws-file-row-inline-action-bar",{"brws-file-row-inline-action-bar--safari":n.safari});return t?i.default.createElement("div",{onClick:l,className:"brws-file-row-inline-action-bar--container"},i.default.createElement(t,{className:d,file:s,highlighted:r,onHoverLocked:a,isMobile:c})):null}Object.defineProperty(t,"__esModule",{value:!0}),t.FileMediaActionsV2=t.FileMediaActionsV2Element=void 0,o=s.__importDefault(o),i=s.__importDefault(i),n=s.__importStar(n),t.FileMediaActionsV2Element=c;t.FileMediaActionsV2=r.connect((e,t)=>({FilesViewInlineActionBar:a.selectInlineActionBar(e,t)}))(c)})),define("modules/clean/react/files_view/file_name/file_name_audio_description",["require","exports","tslib","react","modules/clean/filetypes","modules/clean/react/browse/models","modules/clean/react/files_view/util","modules/core/i18n"],(function(e,t,s,o,i,r,a,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FileNameAudioDescription=void 0,o=s.__importDefault(o),t.FileNameAudioDescription=({file:e,isSelected:t})=>{const s=[];return a.isFile(e)&&e.isDeleted&&s.push(n.intl.formatMessage({id:"RBvabN",defaultMessage:"Deleted"})),t&&s.push(n.intl.formatMessage({id:"mpdvwi",defaultMessage:"Selected"})),a.isFile(e)&&e.is_dir&&(e.type===i.FileTypes.SHARED_FOLDER?r.File.isReadOnlySharedFolder(e)?s.push(n.intl.formatMessage({id:"513aYe",defaultMessage:"Read-only shared folder"})):s.push(n.intl.formatMessage({id:"r6q13e",defaultMessage:"Shared folder"})):e.type===i.FileTypes.TEAM_SHARED_FOLDER?r.File.isReadOnlySharedFolder(e)?s.push(n.intl.formatMessage({id:"dNfvWF",defaultMessage:"Read-only team shared folder"})):s.push(n.intl.formatMessage({id:"8zuxGM",defaultMessage:"Team shared folder"})):s.push(n.intl.formatMessage({id:"MLqiSW",defaultMessage:"Folder"}))),s.length>0?o.default.createElement("span",{className:"ax-visually-hidden"},`${s.join(" ")}`):null},t.FileNameAudioDescription.displayName="FileNameAudioDescription"})),define("modules/clean/react/files_view/file_name/file_name_cell",["require","exports","tslib","classnames","react","react-redux","spectrum/dimensions/index","modules/clean/react/browse/data/selectors","modules/clean/react/files_view/data/selectors/instance_selectors","modules/clean/react/files_view/data/selectors/item_selectors","modules/clean/react/files_view/star","modules/clean/react/files_view/types","modules/clean/react/selectable_list","modules/clean/react/files_view/file_name/file_name_cell_contents","modules/clean/react/flows/components/badge_async","modules/clean/react/flows/types"],(function(e,t,s,o,i,r,a,n,l,c,d,u,_,p,m,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FileNameCell=t.FileNameCellComponent=void 0,o=s.__importDefault(o),i=s.__importDefault(i),t.FileNameCellComponent=({mediaActions:e,fileNameCellWidth:t,draggable:s,shouldTruncateMiddleFilename:r,renameState:a,flowsBadge:n,showStar:l,file:c,user:g,isMobileMode:S,isSelected:E,showLocation:T,showSnippets:b,shouldShowSubtitle:w,snippetRows:I,onNameClick:v,showUserEducationEffects:O,showHighlights:C,hrefForFile:F,userEducationEffectName:R,isTooltipEnabled:A,showFirstTaskSubtitle:y,renderFilenameSubtitleAsLink:D,onRenameCancel:L,onRenameSubmit:M,isHovered:N,onLocationLinkClick:P,onSelect:U,onDragStart:x,expFlowsAutomatedFolderUI:k,showTags:V,preventSelectionOnDrag:W,mediaFiltersVariant:B,backupNewLocationHintEnabled:H})=>{const j=o.default("brws-file-name-cell-text","brws-vertically-center",{"brws-file-name-cell-text-rename":!!a}),G=o.default("brws-file-name-container",{"brws-file-name-container--action-ui-inline-star":!0}),q=s=>{let o;return r&&(o=t||s,void 0!==o&&void 0!==e&&(o-=48)),o},z=e=>{x&&(W||E||!U||U(_.SelectOptions.DEFAULT,u.FilesViewActionSource.ROW_SINGLE_CLICK),x(e))},K=r&&void 0===t;return i.default.createElement(i.default.Fragment,null,i.default.createElement(h,{className:G,shouldWrap:K},e=>i.default.createElement("div",{className:G},i.default.createElement("div",{className:j,draggable:s,onDragStart:z},i.default.createElement(p.FileNameCellContents,{file:c,renameState:a,showLocation:T,showSnippets:b,shouldShowSubtitle:w,snippetRows:I,user:g,onNameClick:v,isSelected:E,showUserEducationEffects:O,showHighlights:C,hrefForFile:F,userEducationEffectName:R,isTooltipEnabled:A,showFirstTaskSubtitle:y,renderFilenameSubtitleAsLink:D,onRenameCancel:L,onRenameSubmit:M,isHovered:N,onLocationLinkClick:P,width:q(e),shouldShowTags:V,mediaFiltersVariant:B,backupNewLocationHintEnabled:H})),n!==f.FlowsRuleType.None&&i.default.createElement(m.AsyncBadgeComponent,{isFolderFocused:E,type:n,isInUnifiedModal:!!k}),!a&&l&&i.default.createElement(d.StarContainer,{item:c,user:g,className:"brws-file-name-cell-star",isReadOnly:S,tabIndex:E?0:-1,starButtonClassName:"brws-file-name-star-button",alwaysShowUnstarred:!0}))),e)},t.FileNameCellComponent.displayName="FileNameCellComponent";const h=({children:e,className:t,shouldWrap:s})=>s?i.default.createElement(a.Dimensions,{className:t},({width:t})=>e(t)):e();h.displayName="ConditionalDimensions";t.FileNameCell=r.connect((e,t)=>({file:c.selectItemAssertFileOrFileSharedWithMe(e,t),flowsBadge:c.selectFlowsBadge(e,t),isSelectMode:l.selectHasItemsSelected(e,t),isSelected:c.selectIsItemSelected(e,t),expFlowsAutomatedFolderUI:l.selectExpFlowsAutomatedFolderUI(e,t),renameState:c.selectRenameState(e,t),renderFilenameSubtitleAsLink:l.selectRenderFilenameSubtitleAsLink(e,t),isMobileMode:l.selectIsMobileMode(e,t),showHighlights:l.selectShouldShowFileNameHighlights(e,t),showLocation:l.selectShouldShowFileNameLocation(e,t),showStar:c.selectShouldShowStar(e,t),showUserEducationEffects:c.selectShouldShowUserEducationEffects(e,t),userEducationEffectName:c.selectUserEducationEffectName(e,t),isTooltipEnabled:c.selectIsTooltipEnabled(e,t),user:l.selectUser(e,t),shouldTruncateMiddleFilename:l.selectArePostTTIModulesLoaded(e,t),showSnippets:c.selectShouldShowSnippets(e,t),snippetRows:c.selectSnippetRows(e,Object.assign(Object.assign({},t),{numVisibleColumns:t.visibleColumns.length})),showFirstTaskSubtitle:c.selectShouldShowFirstTaskSubtitle(e,t),shouldShowSubtitle:c.selectShouldShowSubtitle(e,t),backupNewLocationHintEnabled:n.backupNewLocationHintEnabled(e)}))(t.FileNameCellComponent)})),define("modules/clean/react/files_view/file_name/file_name_cell_contents",["require","exports","tslib","react","spectrum/media_table/index","modules/clean/filepath/filepath","modules/clean/react/files_view/file_snippets","modules/clean/react/files_view/name_input","modules/clean/react/files_view/types","modules/clean/react/files_view/util","modules/clean/react/files_view/file_name/file_name_subtitle","modules/clean/react/files_view/file_name/file_name_title","modules/clean/react/files_view/file_name/file_name_audio_description","modules/core/i18n","modules/clean/tagging/logger","modules/clean/tagging/utils","modules/clean/tagging/components/tags_container","modules/clean/media_filters/gating","modules/clean/media_filters/media_search_snippet_loader","modules/clean/react/browse/data/helpers","dig-components/buttons","dig-components/tooltips","dig-components/icons","dig-components/icons/src","modules/core/browser"],(function(e,t,s,o,i,r,a,n,l,c,d,u,_,p,m,f,h,g,S,E,T,b,w,I,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FileNameCellContents=void 0,o=s.__importDefault(o),r=s.__importStar(r),m=s.__importStar(m),f=s.__importStar(f),v=s.__importStar(v);const O=e=>{null==e||e.stopPropagation()};t.FileNameCellContents=({file:t,renameState:p,showLocation:F,showSnippets:R,shouldShowSubtitle:A,snippetRows:y,user:D,onNameClick:L,isSelected:M,showUserEducationEffects:N,showHighlights:P,hrefForFile:U,userEducationEffectName:x,isTooltipEnabled:k,showFirstTaskSubtitle:V,renderFilenameSubtitleAsLink:W,onRenameCancel:B,onRenameSubmit:H,isHovered:j,onLocationLinkClick:G,width:q,shouldShowTags:z,mediaFiltersVariant:K,backupNewLocationHintEnabled:Y})=>{const Q=C(),X=((e,t)=>s=>{const o=!c.shouldHandleClick(s);o||(s.preventDefault(),s.stopPropagation()),c.isFile(e)&&(null==t||t(e,o))})(t,G),J=()=>{c.isFile(t)&&(null==B||B(t))},Z=e=>{c.isFile(t)&&(null==H||H(t,e))};if(c.isFile(t)&&p===l.RenameState.PENDING_INPUT)return o.default.createElement(n.NameInput,{defaultValue:r.filename(t.fq_path),label:t.is_dir?Q.renameDirStr:Q.renameFileStr,onClick:O,onSubmit:Z,onCancel:J,ignoreFileExtension:t.is_dir});let $;$=p===l.RenameState.SAVING_INPUT?o.default.createElement(o.default.Fragment,null,Q.renamingStr):o.default.createElement(u.FileNameTitle,{file:t,user:D,containerWidth:q,isSelected:M,onNameClick:L,hrefForFile:U,showHighlights:P,isTooltipEnabled:k,showUserEducationEffects:N,userEducationEffectName:x});let ee=null;V?ee=o.default.createElement("span",{className:"first-task-content-subtitle"},Q.filesMovedString):F&&(ee=o.default.createElement(d.FileSubtitle,{containerWidth:q,file:t,onClick:X,renderAsLink:W,user:D,focusable:M}));const te=q?{width:q}:void 0,se=g.isMediaFiltersEnabled(K)&&c.isFile(t)&&t.media_data,oe=R||z&&c.isFile(t)||se;return o.default.createElement(o.default.Fragment,null,o.default.createElement(i.MediaCellText,{key:"title",highlight:j},o.default.createElement("div",{className:"brws-file-name-cell-title-container"},$,o.default.createElement(_.FileNameAudioDescription,{file:t,isSelected:M}),Y&&E.isBackupFolder(t)&&o.default.createElement(b.Tooltip,{title:Q.backupNewLocationTooltipStr,placement:"right"},o.default.createElement(T.Button,{className:"brws-file-name-cell-backup-new-location",variant:"transparent",size:"small",withIconLeft:o.default.createElement(w.UIIcon,{src:I.OpenLine,size:"small"}),onClick:t=>{new Promise((t,s)=>{e(["modules/clean/sync_everything/constants"],t,s)}).then(s.__importStar).then(({getBackupUrl:e})=>v.open_tab(e("browse_row"))),t.stopPropagation()}},Q.backupNewLocationButtonStr)))),A&&o.default.createElement(i.MediaCellText,{key:"subtitle",variant:"subtitle"},ee),oe&&o.default.createElement(i.MediaCellText,{key:"snippets_tags",variant:"subtitle",style:te},o.default.createElement("div",{className:"brws-file-snippets-tags-container"},se&&c.isFile(t)&&o.default.createElement("span",{className:"brws-file-snippets-media-search",style:te},o.default.createElement(S.AsyncMediaSearchSnippet,{mediaData:t.media_data,mediaFiltersVariant:K})),R&&o.default.createElement(a.FileSnippets,{snippets:t.snippets,lineClamp:y}),z&&c.isFile(t)&&t.tags&&t.tags.length>0&&o.default.createElement("span",{className:"brws-file-snippets",style:te},o.default.createElement(h.TagsContainer,{tags:t.tags.map(e=>e.value),highlightedIndexes:t.tags.map((e,t)=>e.highlighted?t:void 0).filter(e=>void 0!==e),onTagClick:(e,s)=>{if(s){!c.shouldHandleClick(s)||(s.preventDefault(),s.stopPropagation())}c.isFile(t)&&(m.logTagClick(D,[t],"center_pane",e),f.redirectToSearchByTag(D,e.tag_text))},containerClassName:"brws-file-tags-container",chipClassName:"brws-file-tag",showMoreClassName:"brws-file-tags-show-more",chipSize:"xsmall",containerMaxRows:1,expandable:!1,showMoreWidth:100})))))},t.FileNameCellContents.displayName="FileNameCellContents";const C=()=>({filesMovedString:p.intl.formatMessage({id:"WYezR2",defaultMessage:"Your existing files moved here."}),renameFileStr:p.intl.formatMessage({id:"44Ky+Q",defaultMessage:"Rename file"}),renameDirStr:p.intl.formatMessage({id:"YApL4x",defaultMessage:"Rename directory"}),renamingStr:p.intl.formatMessage({id:"KvygQC",defaultMessage:"Renaming…"}),backupNewLocationButtonStr:p.intl.formatMessage({id:"wX0e+1",defaultMessage:"New location"}),backupNewLocationTooltipStr:p.intl.formatMessage({id:"Pn0YTw",defaultMessage:"Backups have a new home"})})})),define("modules/clean/react/files_view/file_name/file_name_subtitle",["require","exports","tslib","react","modules/clean/browse_interface","modules/clean/filepath/filepath","modules/clean/react/files_view/util","modules/core/i18n","modules/clean/react/files_view/file_name/truncation_helpers"],(function(e,t,s,o,i,r,a,n,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FileSubtitle=void 0,o=s.__importDefault(o),r=s.__importStar(r);t.FileSubtitle=({file:e,renderAsLink:t=!0,user:s,containerWidth:c,onClick:d,focusable:u})=>{const _={notAddedYetString:e=>n.intl.formatMessage({id:"hY0d5Z",defaultMessage:"not added yet, in {location}"},{location:e}),sharedWithYouString:n.intl.formatMessage({id:"FWJkxz",defaultMessage:"Shared with you"}),formattedLocationText:e=>n.intl.formatMessage({id:"yR1l4z",defaultMessage:"in {location}"},{location:e})};if(!a.isFile(e))return o.default.createElement(o.default.Fragment,null,_.sharedWithYouString);const p=r.parent_dir(e.fq_path),m="/"===p?i.get_browse_root_name(s):p.slice(1);if(e.is_unmounted)return o.default.createElement(o.default.Fragment,null,_.notAddedYetString(m));const f=l.truncateTextInFilenameCell(_.formattedLocationText(m),12,6,c);if(!t||e.isDeleted)return o.default.createElement(o.default.Fragment,null,f);const h=i.browse_uri_for_fq_path(s,p);return o.default.createElement("a",{className:"brws-file-name-cell-location",href:h.toString(),onClick:d,tabIndex:u?0:-1},f)},t.FileSubtitle.displayName="FileSubtitle",t.FileSubtitle.displayName="FileSubtitle"})),define("modules/clean/react/files_view/file_name/file_name_title",["require","exports","tslib","react","modules/clean/filepath/filepath","modules/clean/react/browse/models","modules/clean/react/files_view/constants","modules/clean/react/files_view/util","modules/clean/react/title_bubble","modules/clean/user_education/react/user_education_effect","modules/clean/react/sticky_position","typescript/component_libraries/retrieval-components/src/highlighted-truncated-string/index","modules/clean/react/files_view/file_name/truncation_helpers"],(function(e,t,s,o,i,r,a,n,l,c,d,u,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FileNameTitle=void 0,o=s.__importDefault(o),i=s.__importStar(i);const p=e=>e instanceof r.FileSharedWithMe;t.FileNameTitle=({file:e,user:t,hrefForFile:s,showHighlights:r,showUserEducationEffects:m,userEducationEffectName:f,isSelected:h,containerWidth:g,onNameClick:S,isTooltipEnabled:E})=>{const T=n.getFilename(e),b=o.default.useRef(null),w=o.default.useMemo(()=>((e,t,s)=>{if(!t||p(e)||!s.current)return!1;const o=s.current,r=i.filename(e.fq_path),a=o.offsetWidth<o.scrollWidth,n=o.textContent!==r;return a||n})(e,E,b),[e,E]);let I,v;if(g)I=o.default.createElement(u.HighlightedTruncatedString,{text:T,className:"brws-file-name-element",fontSize:14,availableWidth:g,highlightSpans:_.getHighlightedSpansForHighlightedTruncatedString(T,e),cellBuffer:3});else{const t=_.truncateTextInFilenameCell(T,14,3,g);I=r&&(e.highlight_spans||n.isFile(e)&&e.filename_highlights)?_.getHighlightedSpan(t,e):o.default.createElement("span",null,t),I=o.default.createElement("div",{className:"brws-file-name-element",ref:b},I)}if(w){const e=T.length<=a.FILE_NAME_TOOLTIP_MAX_LINE_LENGTH?T:o.default.createElement("div",{className:"brws-file-name-cell-tooltip"},T);I=o.default.createElement(l.TitleBubble,{content:e,position:d.StickyPosition.BOTTOM,className:"list-label__title-bubble"},I)}return p(e)?v=e.href:e.is_unmounted||e.isDeleted||(v=null==s?void 0:s(t,e)),void 0!==v&&(I=o.default.createElement("a",{className:"brws-file-name-cell-filename",href:v,onClick:S,tabIndex:h?0:-1},I)),m&&(I=o.default.createElement(c.UserEducationEffect,{containerName:"FileNameLabel",name:f||"FileNameLabel",useSpan:!0},I)),I},t.FileNameTitle.displayName="FileNameTitle",t.FileNameTitle.displayName="FileNameTitle"})),define("modules/clean/react/files_view/file_name/truncation_helpers",["require","exports","tslib","react","modules/clean/em_string","modules/clean/filename_highlights","modules/clean/react/browse/models","modules/clean/react/files_view/util"],(function(e,t,s,o,i,r,a,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getHighlightedSpansForHighlightedTruncatedString=t.getHighlightedSpan=t.truncateTextInFilenameCell=void 0,o=s.__importDefault(o);t.truncateTextInFilenameCell=function(e,t,s,o){if(o&&o>32){const r=(o-32)/t,a=Math.max(s,r-s);return i.Emstring.em_snippet(e,Math.floor(a),.5)}return e},t.getHighlightedSpan=function(e,t){const s=n.getFilename(t),i=(function(e,t){let s=0;for(;s<e.length&&e.charAt(s)===t.charAt(s);)++s;return s===e.length||"…"!==e.charAt(s)?[e]:[e.substring(0,s),e.substring(s+1)]})(e,s);if(1===i.length)return n.isFile(t)&&!t.highlight_spans?r.highlightMatchReact(e,t.filename_highlights):r.highlightReactFromHighlightSpans(e,t.highlight_spans);let a,l;return n.isFile(t)&&!t.highlight_spans?(a=r.highlightMatchReact(s,t.filename_highlights,0,i[0].length),l=r.highlightMatchReact(s,t.filename_highlights,s.lastIndexOf(i[1]))):(a=r.highlightReactFromHighlightSpans(s,t.highlight_spans,0,i[0].length),l=r.highlightReactFromHighlightSpans(s,t.highlight_spans,s.lastIndexOf(i[1]))),o.default.createElement("span",null,a,"…",l)},t.getHighlightedSpansForHighlightedTruncatedString=function(e,t){if(n.isFile(t)||(e=>e instanceof a.FileSharedWithMe)(t)){if(t.highlight_spans)return t.highlight_spans.map(e=>({string:e.highlight_str,isHighlighted:e.is_highlighted}));if(n.isFile(t)&&t.filename_highlights){return r.highlightMatchSections(e,t.filename_highlights).map(e=>({string:e.text,isHighlighted:e.isHighlighted}))}}}})),define("modules/clean/react/files_view/rows/file_row",["require","exports","tslib","classnames","modules/clean/react/files_view/file_actions/file_media_actions_v2","react","spectrum/media_table/index","modules/clean/media_filters/gating","modules/clean/filepath/filepath","modules/clean/react/browse/models","modules/clean/react/files_view/file_actions/file_media_actions","modules/clean/react/files_view/file_name/file_name_cell","modules/clean/react/files_view/rows/cells/file_row_checkbox","modules/clean/react/files_view/rows/row","modules/clean/react/files_view/thumbnail_media_cell","modules/clean/react/files_view/types","modules/clean/react/files_view/sort_types","modules/clean/react/files_view/util","modules/core/browser","modules/core/exception","modules/clean/react/files_view/rows/cells/modified_cell","modules/clean/react/files_view/rows/cells/async_folder_size","modules/clean/react/files_view/rows/cells/tags_cell","modules/clean/tagging/experiments","modules/clean/react/browse/data/helpers"],(function(e,t,s,o,i,r,a,n,l,c,d,u,_,p,m,f,h,g,S,E,T,b,w,I,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FileRow=void 0,o=s.__importDefault(o),r=s.__importDefault(r),l=s.__importStar(l),S=s.__importStar(S),E=s.__importStar(E);const O=()=>r.default.createElement("span",{"aria-hidden":!0},"--");class C extends r.default.Component{constructor(){super(...arguments),this.state={isHoverLocked:!1,rowIsDragging:!1},this.handleOpenFileClick=e=>this.handleOpenNewTabOrNavigate(e,f.FilesViewActionSource.ROW_PREVIEW_ICON),this.handleTitleClick=e=>this.handleOpenNewTabOrNavigate(e,f.FilesViewActionSource.ROW_TITLE),this.handleOpenNewTabOrNavigate=(e,t)=>{if(0===e.button){const s=g.hasModifierKey(e);if(s&&"A"===e.currentTarget.tagName)return void e.stopPropagation();e.preventDefault(),e.stopPropagation(),this.onNavigateToItem({openInNewTab:s,actionSource:t})}},this.onSelect=(e,t)=>{this.props.onSelect&&this.props.onSelect(this.props.fileToId(this.props.file),e,t)},this.onDeselect=(e,t)=>{this.props.onDeselect&&this.props.onDeselect(this.props.fileToId(this.props.file),e,t)},this.onNavigateToItem=({openInNewTab:e,actionSource:t})=>{if(e){const{file:e,user:t,hrefForFile:s}=this.props;S.open_tab(s(t,e))}else this.props.onNavigateToFileOrFolder(this.props.file,{actionSource:t})},this.onDragEnter=e=>{const{file:t,isSelected:s,isActiveDropTarget:o}=this.props;this.props.onDragEnter(e,t,!!s,!!o)},this.onDragStart=e=>{this.setState({rowIsDragging:!0});const{file:t,isSelected:s,onDragStart:o}=this.props;o&&(s?o(e):o(e,[t]))},this.onDragEnd=e=>{this.setState({rowIsDragging:!1});const{onDragEnd:t}=this.props;t&&t(e)},this.onShowShare=()=>{this.props.onShowShare(this.props.file,"BROWSE_FILE_ROW")},this.onPresentInZoom=()=>{this.props.onPresentInZoom&&this.props.onPresentInZoom(this.props.file)},this.handleHoverLocked=({isOpen:e})=>{this.setState({isHoverLocked:e})},this.getAriaLabelForColumn=(e,t)=>{var s;switch(e.sortField){case h.SortField.FILENAME:return e.label+" "+l.filename(t.fq_path);case h.SortField.MODIFIED:return e.label+" "+t.ago;case h.SortField.CATEGORY:return e.label+" "+c.File.getCategoryDescription(t);case h.SortField.EXTENSION:return e.label+" "+c.File.getExtension(t);case h.SortField.SIZE:return e.label+" "+t.size;case h.SortField.TAGS:return e.label+" "+t.tags?null===(s=t.tags)||void 0===s?void 0:s.map(e=>e.value).join(", "):"";case h.SortField.SHARED_WITH:default:return}},this.renderMediaActions=(e,t)=>{const{instanceId:s,arePostTTIModulesLoaded:o,canDisplayFolderSizes:a,file:n,getOverflowMenuActions:l,isCompactMode:c,responsive:u,isSelectMode:_,isSelected:p,isSharingDisabled:m,renameState:f,shareButtonLabel:h,showShareButton:g,user:S,viewportTopOffset:E,isActionBarEnabled:T}=this.props,b=!u.isMatchedLarge&&!u.isMatchedMedium;return!(b&&(f||_))?T?e||b?r.default.createElement(i.FileMediaActionsV2,{instanceId:s,file:n,highlighted:p,onHoverLocked:this.handleHoverLocked,isMobile:b}):void 0:r.default.createElement(d.FileMediaActions,{arePostTTIModulesLoaded:o,canDisplayFolderSizes:a,file:n,getOverflowMenuActions:l,isCompactMode:!!c,isHovered:e,isSelectMode:!!_,isSharingDisabled:!!m,onOpenFileClick:this.handleOpenFileClick,onPresentInZoom:this.onPresentInZoom,onShowShare:this.onShowShare,shareButtonLabel:h,showShareButton:g,showBorders:t,user:S,viewportTopOffset:E}):void 0}}renderCell({isHovered:e,sortField:t,renderCell:s}){var o,i;const{instanceId:l,itemIndex:d,rowIndex:_,fileToId:p,visibleColumns:f,containerWidth:g,height:S,file:v,hrefForFile:C,isSearchMode:F,isSelectMode:R,onLocationLinkClick:A,onRenameCancel:y,onRenameSubmit:D,filteredContactName:L,showCDMUserEducationEffects:M,iconSize:N,isCondensedListView:P,columnSizes:U,renderSharedWithController:x,isSelected:k,expManualTagging:V,user:W,preventSelectionOnDrag:B,mediaFiltersVariant:H}=this.props;if(s)return s({file:v});const j=null==U?void 0:U[t];switch(t){case h.SortField.FILENAME:return r.default.createElement(m.ThumbnailMediaCell,{key:"fileName",file:v,height:S,width:j,showCDMUserEducationEffects:M,iconSize:N},r.default.createElement(u.FileNameCell,{instanceId:l,itemIndex:d,rowIndex:_,isHovered:e,fileToId:p,visibleColumns:f,containerWidth:g,onLocationLinkClick:A,onRenameCancel:y,onRenameSubmit:D,hrefForFile:C,onNameClick:this.handleTitleClick,onSelect:this.onSelect,onDragStart:this.onDragStart,draggable:!R,showTags:F&&I.isTaggingEnabled(V),mediaFiltersVariant:F?H:"OFF",preventSelectionOnDrag:B}));case h.SortField.RELEVANCE:case h.SortField.MODIFIED:return r.default.createElement(T.ModifiedCell,{key:"modified",file:v,filteredContactName:L,isSearchMode:Boolean(F),shouldBubbleSubtitle:P,width:j});case h.SortField.SHARED_WITH:case h.SortField.CATEGORY:case h.SortField.EXTENSION:case h.SortField.SIZE:case h.SortField.TAGS:case h.SortField.LOCKED_FILES:{const e=void 0===j?{}:{width:j,minWidth:j,maxWidth:j},s={[h.SortField.SHARED_WITH]:x(v,k?0:void 0),[h.SortField.CATEGORY]:null,[h.SortField.EXTENSION]:null,[h.SortField.SIZE]:null,[h.SortField.LOCKED_FILES]:null,[h.SortField.TAGS]:r.default.createElement(w.TagsCell,{file:v,user:W})}[t],l={[h.SortField.SHARED_WITH]:void 0,[h.SortField.CATEGORY]:c.File.getCategoryDescription(v),[h.SortField.EXTENSION]:c.File.getExtension(v),[h.SortField.SIZE]:r.default.createElement(b.SizeCellTitle,{file:v}),[h.SortField.LOCKED_FILES]:void 0,[h.SortField.TAGS]:void 0}[t],d={[h.SortField.SHARED_WITH]:"sharedWith",[h.SortField.CATEGORY]:"category",[h.SortField.EXTENSION]:"extension",[h.SortField.SIZE]:"size",[h.SortField.LOCKED_FILES]:"locked_files",[h.SortField.TAGS]:"tags"}[t],u={[h.SortField.SHARED_WITH]:"brws-file-shared-with-cell",[h.SortField.CATEGORY]:"brws-file-category-cell",[h.SortField.EXTENSION]:"brws-file-extension-cell",[h.SortField.SIZE]:"brws-file-size-cell",[h.SortField.LOCKED_FILES]:"brws-file-size-cell",[h.SortField.TAGS]:"brws-file-tags-cell"}[t];let _=void 0;if(t===h.SortField.SIZE&&F&&n.isMediaFiltersEnabled(H)){const e=null===(o=v.media_data)||void 0===o?void 0:o.data.image_width,t=null===(i=v.media_data)||void 0===i?void 0:i.data.image_height;_=e&&t?`${e}x${t} px`:"​"}return r.default.createElement(a.MediaCell,{className:u,subtitle:_,title:l,style:e,key:d},s)}default:return E.reportException({err:new Error("renderCell function for "+t+"is not implemented"),severity:E.SEVERITY.NONCRITICAL,tags:["js:browse"]}),r.default.createElement(O,null)}}render(){const{file:e,fileToId:t,instanceId:s,isActiveDropTarget:i,isSearchMode:n,isSelectMode:l,isSelected:d,itemIndex:u,onDeselect:m,onSelect:f,renameState:h,rowIndex:g,topOffset:S,visibleColumns:E,isCutToClipboard:T,isFocused:b,isRightClickEnabled:w}=this.props,{isHoverLocked:I}=this.state;let O="";E.forEach(t=>{const s=this.getAriaLabelForColumn(t,e);s&&(O+=s+", ")});const C=this.state.rowIsDragging&&!d,F=o.default({"brws-file-row":!0,"brws-file-row-no-access":c.File.isNoAccessSharedFolder(e)||C,"brws-file-row-hover-forced":I,"brws-file-row-cut":T,"brws-file-row-dragging":C}),R=!(h||n||c.File.isTeamMemberFolder(e)||c.File.isReadOnlySharedFolder(e)||c.File.isNoAccessSharedFolder(e)||v.isBackupFolder(e)||!d);return r.default.createElement(p.FilesViewRow,{className:F,isActiveDropTarget:i,isSelected:d,isDeleted:e.isDeleted,isDraggable:R,topOffset:S,rowIndex:g,isSelectMode:l,filename:String(e.fq_path.split("/").slice(-1)),ariaLabel:O,onSelect:this.onSelect,onDeselect:this.onDeselect,onNavigateToItem:this.onNavigateToItem,onDragEnter:this.onDragEnter,onDragStart:this.onDragStart,onDragEnd:this.onDragEnd,isRightClickEnabled:w},({isHovered:e,isKeyboardFocused:o})=>(e=e||I,r.default.createElement(r.default.Fragment,null,r.default.createElement(a.MediaCell,{key:"checkboxCell",className:"brws-checkbox-cell"},r.default.createElement(_.FileRowCheckbox,{instanceId:s,itemIndex:u,rowIndex:g,isHovered:e,isFocused:!!b,fileToId:t,onSelect:f,onDeselect:m})),E.map((t,s)=>this.renderCell({isHovered:e&&!C,sortField:t.sortField,renderCell:t.renderCell})),this.renderMediaActions(e,o))))}}t.FileRow=C,C.defaultProps={topOffset:0,controlsFocusable:!1,fileToId:e=>e.fq_path},C.displayName="FileRow"})),define("modules/clean/react/files_view/rows/cells/modified_cell",["require","exports","tslib","react","dig-components/tooltips","spectrum/media_table/index","modules/core/i18n"],(function(e,t,s,o,i,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ModifiedCell=void 0,o=s.__importDefault(o),t.ModifiedCell=({file:e,mediaActions:t,filteredContactName:s,isSearchMode:n,shouldBubbleSubtitle:l,width:c})=>{const d=s&&e.agoFromLastActionByUserTs,u=e.is_dir&&!n?void 0:d?e.agoFromLastActionByUserTs:e.ago,_=d?s:e.last_modified_name||void 0,p=_?a.intl.formatMessage({id:"ACVnV9",defaultMessage:"by {modified_by}"},{modified_by:_}):e.is_dir?void 0:a.intl.formatMessage({id:"5794tP",defaultMessage:"by you"}),m=u||o.default.createElement("span",{"aria-hidden":!0},"--"),f=void 0===c?{}:{width:c,minWidth:c,maxWidth:c},h=l&&p?o.default.createElement(i.Tooltip,{title:p},o.default.createElement("span",null,m)):m;return o.default.createElement(r.MediaCell,{className:"brws-file-modified-at-cell",subtitle:l?void 0:p,title:h,style:f},t)},t.ModifiedCell.displayName="ModifiedCell",t.ModifiedCell.displayName="ModifiedCell"})),define("modules/clean/react/files_view/rows/cells/async_folder_size",["require","exports","tslib","react","modules/clean/cloud_docs/constants","modules/clean/react/files_view/util","modules/clean/filepath/filepath"],(function(e,t,s,o,i,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SizeCellTitle=t.isCloudDocProviderStored=void 0,o=s.__importDefault(o),a=s.__importStar(a);const n=()=>o.default.createElement("span",{"aria-hidden":!0},"--");function l(e){switch(r.isFile(e)?a.split_filename(e.fq_path).ext:e.ext.slice(1)){case i.PaperFileTypes.PAPER:case i.PaperFileTypes.PAPER_TEMPLATE:return!0;default:return!1}}t.isCloudDocProviderStored=l;const c=o.default.lazy(()=>s.__awaiter(void 0,void 0,void 0,(function*(){return{default:(yield new Promise((t,s)=>{e(["modules/clean/react/files_view/rows/cells/folder_size"],t,s)}).then(s.__importStar)).FolderSizeCell}})));t.SizeCellTitle=e=>{const{file:t}=e;return t.is_dir?o.default.createElement(o.default.Suspense,{fallback:o.default.createElement(n,null)},o.default.createElement(c,{file:t},o.default.createElement(n,null))):t.is_cloud_doc&&l(t)?o.default.createElement(n,null):o.default.createElement("span",null,t.size)}})),define("modules/clean/react/files_view/rows/cells/tags_cell",["require","exports","tslib","react","modules/clean/react/files_view/util","modules/clean/tagging/logger","modules/clean/tagging/utils","modules/clean/tagging/components/tags_container","modules/clean/tagging/utils"],(function(e,t,s,o,i,r,a,n,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TagsCell=void 0,o=s.__importDefault(o),r=s.__importStar(r),a=s.__importStar(a),t.TagsCell=e=>{const{file:t,user:s}=e,c=t.tags&&t.tags.map(e=>e.value.tag_text)||[];if(0===c.length)return null;return o.default.createElement(n.TagsContainer,{tags:l.textTagsToUserGeneratedTags(c),onTagClick:(e,o)=>{i.isFile(t)&&(o&&(o.preventDefault(),o.stopPropagation()),r.logTagClick(s,[t],"browse_tag_col",e),a.redirectToSearchByTag(s,e.tag_text))},containerClassName:"brws-col-tags-container",chipClassName:"brws-tag-chip",chipSize:"xsmall",showMoreClassName:"brws-tag-chip",expandable:!1})}})),define("modules/clean/react/files_view/rows/cells/file_row_checkbox",["require","exports","tslib","react","classnames","react-redux","dig-components/controls","modules/clean/react/files_view/data/selectors/instance_selectors","modules/clean/react/files_view/data/selectors/item_selectors","modules/clean/react/files_view/types","modules/clean/react/selectable_list","modules/clean/user_education/react/user_education_effect","modules/core/i18n"],(function(e,t,s,o,i,r,a,n,l,c,d,u,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FileRowCheckbox=t.FileRowCheckboxComponent=void 0,o=s.__importDefault(o),i=s.__importDefault(i);t.FileRowCheckboxComponent=({isSelected:e,isDisabled:t,shouldShowUserEducationEffects:s,isCheckboxVisible:r,onSelect:n,onDeselect:l,selectionId:p,isFocused:m})=>{const f={selectItem:_.intl.formatMessage({id:"MkD8+F",defaultMessage:"Select item"})},h=o.default.useRef(null),g=()=>{var e,t;null===(t=null===(e=h.current)||void 0===e?void 0:e.querySelector("input"))||void 0===t||t.focus()};o.default.useEffect(()=>{m&&g()},[m]),o.default.useEffect(()=>{e&&m&&g()},[e,m]);const S=s=>{n&&l&&!t&&(s.stopPropagation(),e?l(p,s.shiftKey,c.FilesViewActionSource.SINGLE_CHECKBOX):n(p,s.shiftKey?d.SelectOptions.EXTEND:d.SelectOptions.DEFAULT,c.FilesViewActionSource.SINGLE_CHECKBOX))};let E=null;return r&&(E=o.default.createElement(a.Checkbox,{disabled:t,checked:e,onClick:S,"aria-label":f.selectItem,tabIndex:e?0:-1,readOnly:!0})),s&&(E=o.default.createElement(u.UserEducationEffect,{containerName:"FileItemRow",name:"FirstFileSelectCheckbox",useSpan:!0},E||o.default.createElement("div",{style:{width:20,height:20}}))),o.default.createElement("div",{className:i.default("brws-vertically-center","brws-file-row-checkbox-target",{"brws-file-row-checkbox-background":r}),onClick:S,"aria-controls":"brws-sidebar-view",ref:h},E)},t.FileRowCheckboxComponent.displayName="FileRowCheckboxComponent",t.FileRowCheckboxComponent.displayName="FileRowCheckboxComponent";t.FileRowCheckbox=r.connect((e,t)=>({isCheckboxDisabled:n.selectDisabledMultiselect(e,t),isCheckboxVisible:l.selectIsCheckboxVisible(e,t),isSelected:l.selectIsItemSelected(e,t),shouldShowUserEducationEffects:l.selectShouldShowUserEducationEffects(e,t),isDisabled:n.selectDisabledMultiselect(e,t),selectionId:l.selectItemSelectionId(e,t)}))(t.FileRowCheckboxComponent)})),define("modules/clean/react/files_view/rows/file_shared_with_me_row",["require","exports","tslib","classnames","react","react-dom","dig-components/controls","spectrum/media_table/index","spectrum/util/raf_throttle","modules/clean/react/files_view/file_name/file_name_cell","modules/clean/react/files_view/rows/cells/async_folder_size","modules/clean/react/files_view/rows/row","modules/clean/react/files_view/thumbnail_media_cell","modules/clean/react/files_view/types","modules/clean/react/files_view/sort_types","modules/clean/react/files_view/util","modules/clean/react/selectable_list","modules/clean/user_education/react/user_education_effect","modules/core/browser","modules/core/exception","modules/core/i18n","modules/clean/react/flows/types"],(function(e,t,s,o,i,r,a,n,l,c,d,u,_,p,m,f,h,g,S,E,T,b){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FileSharedWithMeRow=void 0,o=s.__importDefault(o),i=s.__importDefault(i),r=s.__importStar(r),S=s.__importStar(S),E=s.__importStar(E);const w=()=>i.default.createElement("span",{"aria-hidden":!0},"--"),I=e=>void 0===e?{}:{width:e,minWidth:e,maxWidth:e},v=({file:e})=>e.is_cloud_doc&&d.isCloudDocProviderStored(e)?i.default.createElement(w,null):i.default.createElement("span",null,e.size);class O extends i.default.PureComponent{constructor(e){super(e),this.setRef=e=>{this.brwsFilenameContainerDiv=e},this.checkboxRef=null,this.handleWindowResize=()=>{this.throttledWindowResize.request()},this.handleResize=()=>{if(this.brwsFilenameContainerDiv){const{brwsFilenameContainerDivWidth:e}=this.state,t=this.brwsFilenameContainerDiv.getBoundingClientRect().width;t&&t!==e&&this.setState({brwsFilenameContainerDivWidth:t})}},this.handleTitleClick=e=>this.handleOpenNewTabOrNavigate(e,p.FilesViewActionSource.ROW_TITLE),this.handleOpenNewTabOrNavigate=(e,t)=>{0===e.button&&(e.preventDefault(),e.stopPropagation(),this.onNavigateToItem({openInNewTab:f.hasModifierKey(e),actionSource:t}))},this.onSelect=(e,t)=>{this.props.onSelect&&this.props.onSelect(this.props.file.file_id,e,t)},this.onDeselect=(e,t)=>{this.props.onDeselect&&this.props.onDeselect(this.props.file.file_id,e,t)},this.onNavigateToItem=({openInNewTab:e,actionSource:t})=>{e?S.open_tab(this.props.file.href):this.props.onOpenFileSharedWithMe(this.props.file,{actionSource:t})},this.getCheckboxNode=()=>this.checkboxRef&&r.findDOMNode(this.checkboxRef),this.isCheckboxNode=e=>{const t=this.getCheckboxNode();return!!t&&t.contains(e)},this.handleCheckboxChange=e=>{},this.handleCheckboxClick=e=>{e.stopPropagation();const{onSelect:t,onDeselect:s,file:o}=this.props;t&&s&&(e.currentTarget.checked?t(o.file_id,e.shiftKey?h.SelectOptions.EXTEND:h.SelectOptions.DEFAULT,p.FilesViewActionSource.SINGLE_CHECKBOX):s(o.file_id,e.shiftKey,p.FilesViewActionSource.SINGLE_CHECKBOX))},this.setCheckboxRef=e=>{this.checkboxRef=e},this.handleCheckboxTouchTargetClick=e=>{if(this.shouldHandleClick(e)){if(!this.props.isCheckboxDisabled&&this.props.onDeselect&&this.props.onSelect){e.preventDefault();const t=this.props.file.file_id;this.props.isSelected?this.props.onDeselect(t,e.shiftKey,p.FilesViewActionSource.SINGLE_CHECKBOX):this.props.onSelect(t,e.shiftKey?h.SelectOptions.EXTEND:h.SelectOptions.DEFAULT,p.FilesViewActionSource.SINGLE_CHECKBOX)}}else e.preventDefault()},this.renderCheckbox=e=>{const{isCompactMode:t,isSelectMode:s,isSelected:r,showUserEducationEffects:n}=this.props;let l=null;return l=!(e||r||s||t)?null:i.default.createElement(a.Checkbox,{disabled:this.props.isCheckboxDisabled,checked:!!r,className:o.default("brws-checkbox",{"brws-checkbox-checked":r}),onChange:this.handleCheckboxChange,onClick:this.handleCheckboxClick,ref:this.setCheckboxRef,"aria-label":T.intl.formatMessage({id:"sJRsRx",defaultMessage:"Select item"}),tabIndex:r?0:-1}),n&&(l=i.default.createElement(g.UserEducationEffect,{containerName:"FileSharedWithMeRow",name:"FirstFileSelectCheckbox",useSpan:!0},l||i.default.createElement("div",{style:{width:20,height:20}}))),l},this.state={brwsFilenameContainerDivWidth:void 0},this.throttledWindowResize=new l.RafThrottle(()=>this.handleResize())}componentDidMount(){this.handleResize(),window.addEventListener("resize",this.handleWindowResize)}componentWillUnmount(){window.removeEventListener("resize",this.handleWindowResize)}componentDidUpdate(e){(this.props.isFocused&&!e.isFocused||this.props.isFocused&&this.props.isSelected&&!e.isSelected)&&this.checkboxRef&&Promise.resolve().then(()=>{const e=this.getCheckboxNode();e&&e.focus()})}renderModifiedCell(e,t,s,o){const r=s&&e.agoFromLastActionByUserTs,a=r?e.agoFromLastActionByUserTs:e.ago,l=r?s:e.last_modified_name||void 0,c=l?T.intl.formatMessage({id:"ACVnV9",defaultMessage:"by {modified_by}"},{modified_by:l}):T.intl.formatMessage({id:"5794tP",defaultMessage:"by you"});return i.default.createElement(n.MediaCell,{className:"brws-file-modified-at-cell",key:"modifiedAt",subtitle:c,title:a||i.default.createElement(w,null),style:I(o)},t)}renderCell({isHovered:e,isKeyboardFocused:t,sortField:s,isLastCell:r}){const{arePostTTIModulesLoaded:a,file:l,isSelectMode:d,isSelected:u,responsive:p,user:f,showSnippets:h,snippetRows:g,height:S,filteredContactName:T,iconSize:O,columnSizes:C}=this.props,F=null==C?void 0:C[s];switch(s){case m.SortField.FILENAME:const t={file:l,isHovered:e,isSelectMode:!!d,isSelected:!!u,isMobileMode:!p.isMatchedLarge&&!p.isMatchedMedium,user:f,mediaActions:void 0,flowsBadge:b.FlowsRuleType.None,shouldTruncateMiddleFilename:a,showHighlights:!0,showLocation:!0,showStar:!1,showSnippets:!!h,snippetRows:g,onNameClick:this.handleTitleClick,renameState:void 0,renderFilenameSubtitleAsLink:!1,showUserEducationEffects:!1,userEducationEffectName:"",isTooltipEnabled:!1,showFirstTaskSubtitle:!1,shouldShowSubtitle:!0,draggable:!1,expFlowsAutomatedFolderUI:!1,backupNewLocationHintEnabled:!1},{brwsFilenameContainerDivWidth:r}=this.state;return i.default.createElement("div",{className:o.default("brws-file-name-container",{"brws-file-name-container-resizing-enabled":void 0!==F}),ref:this.setRef},i.default.createElement(_.ThumbnailMediaCell,{file:l,height:S,iconSize:O,width:F},i.default.createElement(c.FileNameCellComponent,Object.assign({},t,{fileNameCellWidth:r?r-64:void 0}))));case m.SortField.RELEVANCE:case m.SortField.MODIFIED:return this.renderModifiedCell(l,void 0,T,F);case m.SortField.SIZE:return i.default.createElement(n.MediaCell,{className:"brws-file-size-cell",key:"size",title:i.default.createElement(v,{file:l}),style:I(F)},void 0);default:case m.SortField.CATEGORY:case m.SortField.EXTENSION:case m.SortField.SHARED_WITH:case m.SortField.TAGS:return E.reportException({err:new Error("FileSharedWithMe.renderCell is not implemented for "+s),severity:E.SEVERITY.NONCRITICAL,tags:["js:search"]}),i.default.createElement(n.MediaCell,{key:s,title:i.default.createElement(w,null),style:I(F)})}}shouldHandleClick(e){return!e.defaultPrevented&&!this.isCheckboxNode(e.target)}render(){const{rowIndex:e,topOffset:t,isSelected:s,isSelectMode:o,visibleColumns:r}=this.props;return i.default.createElement(u.FilesViewRow,{className:"brws-filesharedwithme-row",isSelected:s,topOffset:t,rowIndex:e,isSelectMode:o,onSelect:this.onSelect,onDeselect:this.onDeselect,onNavigateToItem:this.onNavigateToItem},({isHovered:e,isKeyboardFocused:t})=>[i.default.createElement(n.MediaCell,{key:"checkboxCell",className:"brws-checkbox-cell"},i.default.createElement("div",{className:"brws-vertically-center brws-file-row-checkbox-target",onClick:this.handleCheckboxTouchTargetClick},this.renderCheckbox(e))),...r.map((s,o)=>this.renderCell({isHovered:e,isKeyboardFocused:t,sortField:s.sortField,isLastCell:o===r.length-1}))])}}t.FileSharedWithMeRow=O,O.displayName="FileSharedWithMeRow"})),define("modules/clean/react/files_view/file_snippets",["require","exports","tslib","react","modules/clean/filename_highlights","modules/clean/react/files_view/constants","modules/clean/react/files_view/data/selectors/list_selectors"],(function(e,t,s,o,i,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FileSnippet=t.FileSnippets=void 0,o=s.__importDefault(o),i=s.__importStar(i);class n extends o.default.PureComponent{render(){const{snippets:e,lineClamp:s}=this.props,i={maxHeight:r.SNIPPET_HEIGHT_PER_ROW*s,WebkitLineClamp:s},n=a.getFirstValidSnippet(e);return n?o.default.createElement("span",{className:"brws-file-snippets",style:i},o.default.createElement(t.FileSnippet,{snippet:n})):null}}t.FileSnippets=n,n.defaultProps={lineClamp:3},n.displayName="FileSnippets",t.FileSnippet=({snippet:e})=>i.highlightReactFromAllHighlightSpans(e.highlight_spans||[]),t.FileSnippet.displayName="FileSnippet"})),define("modules/clean/react/files_view/files_view",["require","exports","tslib","classnames","lodash","immutable","react","react-dom","react-redux","spectrum/media_table_skeleton/index","spectrum/table/index","modules/clean/react/browse/action_logger","modules/clean/react/browse/models","modules/clean/react/files_view/column_manager","modules/clean/react/files_view/constants","modules/clean/react/files_view/data/action_creators","modules/clean/react/files_view/data/selectors/instance_selectors","modules/clean/react/files_view/column_headers/dig_column_header","modules/clean/react/files_view/drag_drop/drag_and_drop","modules/clean/react/files_view/file_list_empty_folder_table","modules/clean/react/files_view/files_view_logging","modules/clean/react/files_view/list","modules/clean/react/files_view/scroll_updater","modules/clean/react/files_view/tile_grid","modules/clean/react/files_view/types","modules/clean/react/files_view/view_type","modules/clean/react/selectable_list","modules/clean/sharing/access_level","modules/clean/web_user_action_events","modules/core/browser_detection","modules/core/i18n","modules/core/notify","modules/clean/react/files_view/drag_drop/drag_to_select","modules/clean/react/files_view/data/selectors/files_view_selectors","modules/clean/react/files_view/unity_listener","modules/clean/react/async/loadable","modules/clean/filepath/filepath","modules/clean/react/browse/data/helpers"],(function(e,t,s,o,i,r,a,n,l,c,d,u,_,p,m,f,h,g,S,E,T,b,w,I,v,O,C,F,R,A,y,D,L,M,N,P,U,x){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FilesView=t.FilesViewComponent=t.getShouldShowSelectAllCheckbox=void 0,o=s.__importDefault(o),i=s.__importStar(i),r=s.__importStar(r),a=s.__importDefault(a),n=s.__importStar(n),U=s.__importStar(U);const k=P.Loadable({loader:()=>new Promise((t,s)=>{e(["typescript/component_libraries/files_components/src/file-drag/index"],t,s)}).then(s.__importStar).then(({InternalFileDrag:e})=>e)}),V=[F.NameSpaceAccess.ACCESS_NO_ACCESS,F.NameSpaceAccess.ACCESS_READER,F.NameSpaceAccess.ACCESS_READER_NO_COMMENT],W={keyboard:v.FilesViewActionSource.KEYBOARD,drag_to_select:v.FilesViewActionSource.DRAG_TO_SELECT},B=[];function H(e){return e.some(j)}function j(e){return e instanceof _.File||e instanceof _.FileSharedWithMe}t.getShouldShowSelectAllCheckbox=H;class G extends a.default.Component{constructor(){super(...arguments),this.internalDragStatusRef=a.default.createRef(),this.state={dropTarget:null,tilesPerRow:1,draggedFiles:null},this.handleCopyToClipboard=()=>{const{selectedFiles:e,onSetClipboard:t}=this.props;e.size&&t({files:e.toArray(),action:"copy"})},this.handleCutToClipboard=()=>{const{selectedFiles:e,onSetClipboard:t}=this.props,s=e.filter(e=>!e.read_only);s.size&&t({files:s.toArray(),action:"cut"})},this.handleNewFolderSubmit=e=>{""===e?(this.props.onNewFolderCancel(),this.handleNewFolderCancel({source:v.NameInputActionSource.SUBMIT})):this.props.onNewFolderSubmit(e)},this.handleNewFolderCancel=({source:e})=>{e!==v.NameInputActionSource.ESC&&D.Notify.error(y.intl.formatMessage({id:"9xXIAi",defaultMessage:"Please provide a name for the new folder."})),this.props.onNewFolderCancel()},this.handleSetFileUploaderPath=e=>{const t=e?e.path:this.props.path;let s=this.props.context.isCurrentPathWriteable();e&&e.hasOwnProperty("hasPermissionToUploadToFolder")&&(s=!!e.hasPermissionToUploadToFolder);const o=!!(null==e?void 0:e.isMovingIntoVault);this.props.setFileUploaderPath({path:t,hasPermissionToUploadToFolder:s,isMovingIntoVault:o,targetSurface:"files_view"})},this.handleDragStart=(e,t=[])=>{var s;const{path:o,selectedFiles:r,user:a,preventSelectionOnDrag:l}=this.props;let c=i.keyBy(t,"fq_path");0!==t.length&&l||(c=Object.assign(Object.assign({},c),r.toJS()));const d=i.values(c),{isInsideBackupFolder:u}=this.props;if(u)return void D.Notify.error(y.intl.formatMessage({id:"+HTDO0",defaultMessage:"Backup contents can’t be moved."}));if(null==d?void 0:d.some(e=>x.isBackupFolder(e)))return void D.Notify.error(y.intl.formatMessage({id:"isN1D3",defaultMessage:"Backups can’t be moved."}));if(d.some(e=>_.File.isTeamSharedFolder(e)))return void D.Notify.error(y.intl.formatMessage({id:"1cIg3V",defaultMessage:"Team folders can’t be moved."}));if(d.some(e=>_.File.isTeamMemberFolder(e)))return void D.Notify.error(y.intl.formatMessage({id:"ZxTpZJ",defaultMessage:"Your member folder can’t be moved."}));const p=e.dataTransfer;if(!p)return;if(this.setState({draggedFiles:d}),p.setDragImage&&(null===(s=this.internalDragStatusRef)||void 0===s?void 0:s.current)){const e=n.findDOMNode(this.internalDragStatusRef.current);e&&p.setDragImage(e,-10,-10)}const m={userId:a.id,fromPath:o,fileInfos:d.map(e=>({target_ns:e.target_ns,file_id:e.file_id,is_dir:e.is_dir,fq_path:e.fq_path}))};p.setData(A.INTERNAL_FILE_DATA_TRANSFER_TYPE,JSON.stringify(m)),p.effectAllowed="copyMove",this.props.onDragStart&&this.props.onDragStart(e,d)},this.handleDragEnter=(e,t,s,o)=>{const{draggedFiles:i}=this.state;i&&x.isBackupFolder(t)&&D.Notify.error(y.intl.formatMessage({id:"rRI7QJ",defaultMessage:"Files can’t be moved into backups."}));const r=null==i?void 0:i.some(e=>e.fq_path===t.fq_path);S.onFileDragEnterItem(t,!!this.props.isDraggingExternalFiles,!!this.props.isDraggingInternalFiles,!!r,o,this.props.context,this.handleSetDropTarget,this.handleSetFileUploaderPath)},this.handleDragEnd=e=>{this.setState({draggedFiles:null}),this.props.onDragEnd&&this.props.onDragEnd(e)},this.handleSetDropTarget=e=>{this.setState({dropTarget:e}),this.props.updateDropTarget&&this.props.updateDropTarget(e)},this.handleSelectionChange=(e,t)=>{const s=t?t in C.SelectableListActionSource?W[t]:t:void 0;this.props.onSelectionChange(e,s)},this.onAllCheckboxDeselectAll=()=>{const{selection:e,onSelectionChange:t}=this.props;t(e.set("selected",r.OrderedSet()),v.FilesViewActionSource.ALL_CHECKBOX)},this.onAllCheckboxSelectAll=()=>{const{items:e,selection:t,onSelectionChange:s}=this.props;s(t.set("selected",r.OrderedSet(e.filter(j).map(e=>"fq_path"in e?this.props.fileToId(e):e.file_id))),v.FilesViewActionSource.ALL_CHECKBOX)},this._handleGetOverflowMenuActions=(e,t)=>{const{getOverflowMenuActions:s,responsive:o}=this.props;return s(e,t,o)},this.handleTTI=()=>{this.props.onComponentTTI("FilesViewController")},this.getIsCurrentPathWriteable=()=>this.props.context.isCurrentPathWriteable(),this.onTilesPerRowChange=e=>{this.setState({tilesPerRow:e})},this.onDeselectAll=()=>{this.props.isSearchMode&&this.props.onFocusSearchBar()},this.logRightClick=e=>{const{selectedFiles:t,user:s,viewType:o}=this.props,i=t?t.count(e=>e.is_dir):0,r=t?t.count()-i:0;u.logRightClickItems({uid:s.id,viewType:o,action_surface:R.ActionSurfaceLogValue.CENTER_PANE,numFilesSelected:r,numFoldersSelected:i})},this.InternalFileDragHelper=()=>{const e=this.state.draggedFiles||B,t=e.length;let s="",o=!1,i="";return t>0&&(s=U.filename(e[0].fq_path),o=e[0].is_dir,i=e[0].icon),a.default.createElement(k,{ref:this.internalDragStatusRef,numberOfFiles:t,firstFileName:s,isFolder:o,icon:i})}}shouldComponentUpdate(e){return e.loadingState!==this.props.loadingState||e.loadingState!==v.LoadingState.LOADING_FIRST_PAGE||(o=e.context,i=this.props.context,!!(o&&i&&o.currentFQPath!==i.currentFQPath||(t=e.items,s=this.props.items,t!==s)));var t,s,o,i}renderEmptyFolderView(){const{context:e,customEmptyFolderView:t,onFocusSearchBar:s,onPasteFromClipboard:o,onNavigateToParentFolder:i,isDraggingExternalFiles:r,isColumnResizingEnabled:n,scrollContainerWidth:l}=this.props;if(t){const e=t({isDraggingExternalFiles:!!r,handleTTI:this.handleTTI,isColumnResizingEnabled:n,width:l});if(e)return e}const{isInsideSharedFolder:c,currentSharedFolderPermissionRole:d}=e,u=c&&V.includes(d)?void 0:y.intl.formatMessage({id:"jXqkXG",defaultMessage:"Drag and drop files onto this window to upload."});return a.default.createElement(E.EmptyFolderTable,{title:y.intl.formatMessage({id:"YLBqRL",defaultMessage:"This folder is empty"}),subtitle:u,onTTI:this.handleTTI,onFocusSearchBar:s,onPasteFromClipboard:o,onNavigateToParentFolder:i,onOpenKeyboardShortcutModal:this.props.openKeyboardShortcutsModal})}getSelectAllCheckboxCheckedVariant(){const{selectedFiles:e,items:t}=this.props;let s="unchecked";return e.size===t.filter(j).size?s="checked":e.size&&(s="mixed"),s}isCreateFolderUIActive(){const{createNewFolderState:e}=this.props;return e&&"CREATE_FOLDER_INACTIVE"!==e}shouldShowEmptyFolderView(){return this.props.loadingState===v.LoadingState.LOADED&&!this.props.items.size&&!this.isCreateFolderUIActive()}render(){const{id:e,onDelete:t,onShowRename:s,onRenameSubmit:i,onRenameCancel:r,onSwitchViewType:n,onPasteFromClipboard:l,onColumnsChanged:u,onCanDisplayFolderSizesChanged:_,onFocusSearchBar:f,currentSort:h,createNewFolderState:S,context:E,columns:F,dropTargetHighlightMode:A,fileRename:y,getIsFileJumping:D,onAddFileJumpKeyCode:M,onResetFileJump:P,hideViewFileButton:U,items:x,itemIds:k,isCompactMode:V,isSearchMode:W,isDraggingExternalFiles:B,isDraggingInternalFiles:j,isQueryingFolderSizes:G,isFileViewerShown:q,loadingState:z,onSortChange:K,path:Y,responsive:Q,selectedFiles:X,selection:J,renderSharedWithController:Z,onShowShare:$,onPresentInZoom:ee,totalNumFiles:te,user:se,viewType:oe,viewTypeColumns:ie,onLocationLinkClick:re,onNavigateToFileOrFolder:ae,onNavigateToParentFolder:ne,onOpenFileSharedWithMe:le,onOpenPaper:ce,arePostTTIModulesLoaded:de,scrollContainer:ue,sharingServiceInfo:_e,stickyOffsetTop:pe,disabledMultiselect:me,isStickyColumnHeader:fe,onRangeInView:he,highDensity:ge,filteredContactName:Se,sections:Ee,preferredColumns:Te,isDragToSelectEnabled:be,cutItems:we,numVisibleColumns:Ie,isListView:ve,isActive:Oe,enableUnity:Ce,inlineActionBar:Fe,scrollContainerWidth:Re,columnResizeStorageSetting:Ae,isColumnResizingEnabled:ye,expManualTagging:De,useSkinnyCheckboxes:Le,mediaFiltersVariant:Me,isRightClickEnabled:Ne}=this.props,{isMatchedLarge:Pe,isMatchedMedium:Ue}=Q,{dropTarget:xe,tilesPerRow:ke}=this.state;if(z===v.LoadingState.LOADING_FIRST_PAGE)return de?a.default.createElement(c.MediaTableSkeleton,{numRows:15}):null;const Ve=!!X.size,We=!!ye;if(this.shouldShowEmptyFolderView())return a.default.createElement("div",{className:"brws-files-view"},this.renderEmptyFolderView(),Ce&&a.default.createElement(N.UnityListener,{items:this.props.unityItems,userId:se.id}));const Be=Pe?m.DEFAULT_COLUMN_HEADER_HEIGHT:m.COMPACT_COLUMN_HEADER_HEIGHT,He=Be+pe,je=this.props.scrollPositionOffset||0;return a.default.createElement("div",{className:o.default("brws-files-view",`brws-files-view--${oe.toLowerCase()}`,{"brws-files-view-condensed-list":oe===O.ViewType.CondensedList}),onContextMenu:this.logRightClick},a.default.createElement(p.ColumnManager,{columns:F,viewTypeColumns:ie,currentSort:h,onCanDisplayFolderSizesChanged:_,onColumnsChanged:u,isMatchedLarge:Pe,isMatchedMedium:Ue,isSearchMode:W,viewType:oe,responsiveContainer:W,preferredColumns:Te,isMoreColumnsEnabled:We,numVisibleColumns:Ie,scrollContainerWidth:Re,columnResizeStorageSetting:Ae},({visibleColumns:c,handleSelection:u,canDisplayFolderSizes:_,containerWidth:p,handleReorder:w})=>{const v=(W?m.LIST_VIEW_SEARCH_MODE_COLUMN_FLEX:m.LIST_VIEW_COLUMN_FLEX)[c.length];Le&&v&&(v[0]=m.CHECKBOX_CELL_FLEX_RIGHT_RAIL);const O={columnFlex:v,currentSort:h,isCompactMode:V,isSelectMode:Ve,onDeselectAll:this.onAllCheckboxDeselectAll,onSelectAll:this.onAllCheckboxSelectAll,onSelection:(e,t,s)=>{var o,i;e.popoverTriggerLabel!==t.popoverTriggerLabel&&T.logEvent({user:se,action:R.WebUserActionLogEvent.SWITCH_COLUMN_TYPE,extra:{column_position:(s+1).toString(),selected_column_header:null!==(o=e.loggingLabel)&&void 0!==o?o:e.popoverTriggerLabel,open_from_column_header:null!==(i=e.loggingLabel)&&void 0!==i?i:t.popoverTriggerLabel,action_type:c.includes(e)?"deselected":"selected"}}),u(e,t)},onSort:K,onMenuOpen:(e,t)=>{T.logEvent({user:se,action:R.WebUserActionLogEvent.SELECT_COLUMN_MENU,extra:{column_position:(e+1).toString(),column_header:t}})},onReorder:w,onSwitchViewType:n,selectAllCheckboxState:this.getSelectAllCheckboxCheckedVariant(),showSelectAllCheckbox:H(this.props.items),stickyOffsetHeight:Be,stickyOffsetTop:pe,columns:F,visibleColumns:c,viewType:oe,isSearchMode:W,presentationOnly:ve,isMoreColumnsEnabled:ve&&We,items:x};return ve?a.default.createElement(C.SelectableList,{itemIds:k,keyScope:C.SELECTABLE_LIST_KEY_SCOPE,onSelectionChange:this.handleSelectionChange,selection:J,tilesPerRow:ke,onDeselectAll:this.onDeselectAll,isActive:Oe},({focusedFileId:n,handleDeselect:u,handleFocusFile:m,handleSelect:h,isSelectableListEvent:T,updateSelection:w})=>a.default.createElement(L.DragToSelectController,{handleSelect:h,handleDeselect:u,updateSelection:w,selection:J,isDragToSelectEnabled:be},({registerSelectableItem:w})=>a.default.createElement(d.Table,{"aria-rowcount":te,className:o.default("brws-files-view-list",{"brws-files-view-list-high-density":ge}),columnFlex:v},a.default.createElement(g.ColumnHeader,Object.assign({},O,{variant:ue?"sticky-native":fe?"sticky":"fixed"})),a.default.createElement(b.FilesViewList,{onTTI:this.handleTTI,registerListItem:w,instanceId:e,onDelete:t,onShowRename:s,activeDropTarget:xe,context:E,createNewFolderState:S,dropTargetHighlightMode:A,fileRename:y,focusedFileIndex:n?k.indexOf(n):void 0,getOverflowMenuActions:this._handleGetOverflowMenuActions,getIsCurrentPathWriteable:this.getIsCurrentPathWriteable,getIsFileJumping:D,onAddFileJumpKeyCode:M,onResetFileJump:P,isCompactMode:V,hideViewFileButton:!!U,isDraggingExternalFiles:B,isDraggingInternalFiles:j,isFileViewerShown:q,isSearchMode:W,isSelectMode:Ve,isSelectableListEvent:T,arePostTTIModulesLoaded:de,keyScope:C.SELECTABLE_LIST_KEY_SCOPE,onCopyToClipboard:this.handleCopyToClipboard,onCutToClipboard:this.handleCutToClipboard,onDragStart:this.handleDragStart,onDragEnter:this.handleDragEnter,onDragEnd:this.handleDragEnd,onDeselectFile:u,onFocusFile:m,onFocusSearchBar:f,onOpenKeyboardShortcutModal:this.props.openKeyboardShortcutsModal,onLocationLinkClick:re,onNavigateToFileOrFolder:ae,onNavigateToParentFolder:ne,onNewFolderCancel:this.handleNewFolderCancel,onNewFolderSubmit:this.handleNewFolderSubmit,onOpenFileSharedWithMe:le,onOpenPaper:ce,onPasteFromClipboard:l,onRenameCancel:r,onRenameSubmit:i,onSelectFile:h,onSetDropTarget:this.handleSetDropTarget,onSetFileUploaderPath:this.handleSetFileUploaderPath,responsive:Q,scrollPositionOffset:je,selectedFiles:X,selection:J,renderSharedWithController:Z,hrefForFile:this.props.hrefForFile,onShowShare:$,onPresentInZoom:ee,user:se,viewportTopOffset:He,visibleColumns:c,canDisplayFolderSizes:_,scrollContainer:ue,shareButtonLabel:this.props.shareButtonLabel,sharingServiceInfo:_e,showShareButton:this.props.showShareButton,starredState:this.props.starredState,onRangeInView:he,containerWidth:p,highDensity:ge,filteredContactName:Se,fileToId:this.props.fileToId,eligibleForFirstTaskSubtitle:this.props.eligibleForFirstTaskSubtitle,expVaultEnableViewOnlySharing:this.props.expVaultEnableViewOnlySharing,isFirstTaskEmptyState:this.props.isFirstTaskEmptyState,expAutoPDFConversionBackend:this.props.expAutoPDFConversionBackend,expFlowsAutoUnzipLambda:this.props.expFlowsAutoUnzipLambda,expManualTagging:De,preventSelectionOnDrag:this.props.preventSelectionOnDrag,mediaFiltersVariant:Me,isRightClickEnabled:Ne})))):a.default.createElement(C.SelectableList,{itemIds:k,keyScope:C.SELECTABLE_TILE_GRID_KEY_SCOPE,onSelectionChange:this.handleSelectionChange,selection:J,tilesPerRow:ke,sectionStartIndices:Ee.sectionStartIndices,isActive:Oe},({handleDeselect:e,handleDeselectAll:o,handleFocusFile:n,handleSelect:c,handleSelectAll:u,updateSelection:_,focusedFileId:p})=>a.default.createElement(L.DragToSelectController,{handleSelect:c,handleDeselect:e,updateSelection:_,selection:J,isDragToSelectEnabled:be},({registerSelectableItem:_})=>a.default.createElement(a.default.Fragment,null,a.default.createElement(d.Table,{columnFlex:Le?m.GRID_VIEW_COLUMN_FLEX_RIGHT_RAIL:m.GRID_VIEW_COLUMN_FLEX,role:"presentation",style:ue?{position:"sticky",top:pe,zIndex:1}:void 0},a.default.createElement(g.ColumnHeader,Object.assign({},O,{variant:ue?"default":fe?"sticky":"fixed",disableResizing:!0}))),a.default.createElement(I.FilesViewTileGrid,{onDelete:t,disabledMultiselect:me||!1,onShowRename:s,activeDropTarget:xe,arePostTTIModulesLoaded:de,createNewFolderState:S,context:E,deselectAll:o,dropTargetHighlightMode:A,fileRename:y,getOverflowMenuActions:this._handleGetOverflowMenuActions,getIsCurrentPathWriteable:this.getIsCurrentPathWriteable,getIsFileJumping:D,onAddFileJumpKeyCode:M,onResetFileJump:P,onTTI:this.handleTTI,items:x,isCreateFolderUIActive:this.isCreateFolderUIActive(),isDraggingExternalFiles:B,isDraggingInternalFiles:j,isQueryingFolderSizes:G,isSearchMode:W,onCopyToClipboard:this.handleCopyToClipboard,onCutToClipboard:this.handleCutToClipboard,onDeselectFile:e,onDragEnter:this.handleDragEnter,onDragStart:this.handleDragStart,onDragEnd:this.handleDragEnd,onFocusFile:n,onFocusSearchBar:f,onNewFolderCancel:this.handleNewFolderCancel,onNewFolderSubmit:this.handleNewFolderSubmit,onNavigateToFileOrFolder:ae,onOpenFileSharedWithMe:le,onOpenPaper:ce,onOpenKeyboardShortcutModal:this.props.openKeyboardShortcutsModal,onPasteFromClipboard:l,onRangeInView:he,onRenameCancel:r,onRenameSubmit:i,onSelectFile:c,onSetDropTarget:this.handleSetDropTarget,onSortChange:K,onTilesPerRowChange:this.onTilesPerRowChange,path:Y,sections:Ee,selectAll:u,selectedFiles:X,selection:J,onSetFileUploaderPath:this.handleSetFileUploaderPath,tilesPerRow:ke,totalNumItems:te,user:se,viewportTopOffset:He,viewType:oe,starredState:this.props.starredState,hrefForFile:this.props.hrefForFile,focusedFileIndex:p?k.indexOf(p):void 0,scrollContainer:ue,scrollPositionOffset:je,registerSelectableTile:_,cutItems:we,isActive:Oe,inlineActions:Fe,preventSelectionOnDrag:this.props.preventSelectionOnDrag}))))}),a.default.createElement(w.ScrollUpdater,{scrollContainer:ue,path:Y}),this.InternalFileDragHelper(),Ce&&a.default.createElement(N.UnityListener,{items:this.props.unityItems,userId:se.id}))}}t.FilesViewComponent=G,G.defaultProps={fileToId:e=>e.fq_path},G.displayName="FilesViewComponent";t.FilesView=l.connect((e,{id:t})=>Object.assign(Object.assign({},h.selectInstance(e,{instanceId:t})),{itemIds:h.selectItemIds(e,{instanceId:t}),sections:h.selectSections(e,{instanceId:t}),responsive:h.selectResponsive(e,{instanceId:t}),isCompactMode:h.selectIsCompactMode(e,{instanceId:t}),viewType:h.selectViewType(e,{instanceId:t}),preferredColumns:h.selectPreferredColumns(e,{instanceId:t}),cutItems:h.selectCutItems(e,{instanceId:t}),numVisibleColumns:h.selectNumVisibleColumns(e,{instanceId:t}),isListView:h.selectIsListView(e,{instanceId:t}),isActive:M.isActiveFilesView(e,t),unityItems:h.selectItemsForUnityListener(e,{instanceId:t})}),(e,{id:t})=>({openKeyboardShortcutsModal:()=>e(f.openKeyboardShortcutsModal({instanceId:t}))}))(G)})),define("modules/clean/react/files_view/files_view_logging",["require","exports","tslib","modules/clean/react/browse/logger_util"],(function(e,t,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.logEvent=t.logEventWithNumberOfFiles=void 0,t.logEventWithNumberOfFiles=t=>{const{isSearchMode:i,file:r,extra:a,action:n,action_source:l,action_surface:c,user:d}=t;if(i){const t=new Promise((t,s)=>{e(["modules/clean/search/single_page/logger"],t,s)}).then(s.__importStar),i=new Promise((t,s)=>{e(["modules/clean/search/single_page/data/selectors/index"],t,s)}).then(s.__importStar),d=new Promise((t,s)=>{e(["modules/clean/search/single_page/data/store"],t,s)}).then(s.__importStar);Promise.all([t,i,d]).then(([e,t,s])=>{const i=s.getStoreForSearch().getState(),d=t.selectedFiles(i),{num_files_selected:u,num_folders_selected:_}=o.countFilesAndFolders(d),p=Object.assign(Object.assign({},a),{num_files_selected:u.toString(),num_folders_selected:_.toString()});e.logResultAction(n,t.resultsList(i),r,c,l,p)})}else{const t=new Promise((t,s)=>{e(["modules/clean/react/browse/action_logger"],t,s)}).then(s.__importStar),i=new Promise((t,s)=>{e(["modules/clean/react/browse/data/store"],t,s)}).then(s.__importStar),u=new Promise((t,s)=>{e(["modules/clean/react/browse/data/selectors"],t,s)}).then(s.__importStar);Promise.all([t,i,u]).then(([{logBrowseAction:e},{getStoreForBrowse:t},s])=>{const i=s.selectedFiles(t().getState()),{num_files_selected:u,num_folders_selected:_}=o.countFilesAndFolders(i);e({uid:d.id,action:n,result:r,num_files_selected:u,num_folders_selected:_,action_surface:c,action_source:l,extra:a})})}},t.logEvent=({user:t,action:o,extra:i})=>s.__awaiter(void 0,void 0,void 0,(function*(){(yield new Promise((t,s)=>{e(["modules/clean/react/browse/action_logger"],t,s)}).then(s.__importStar)).logWebUserAction({user_id:t.id,event_name:o,extra:i})}))})),define("modules/clean/react/files_view/fixed_table_head",["require","exports","tslib","spectrum/vertically_fixed/index","spectrum/table/index","react"],(function(e,t,s,o,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FixedTableHead=void 0,r=s.__importDefault(r),t.FixedTableHead=e=>{var{children:t,offsetHeight:a,style:n={}}=e,l=s.__rest(e,["children","offsetHeight","style"]);const c=void 0===a?n:Object.assign({flexBasis:a},n);return r.default.createElement("thead",Object.assign({className:"mc-table-head mc-table-head-fixed brws-column-header",style:c},l),r.default.createElement(o.VerticallyFixed,{tag:({style:e})=>r.default.createElement(i.TableRow,{className:"mc-table-head-row mc-table-head-row-fixed",style:Object.assign({height:a},e),role:"presentation"},t)}))}})),define("modules/clean/react/files_view/legacy_types",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})})),define("modules/clean/react/files_view/list",["require","exports","tslib","react","react-redux","modules/clean/react/browse/models","modules/clean/react/files_view/resizing/column_size_context","modules/clean/react/files_view/culled_table_body","modules/clean/react/files_view/data/selectors/list_selectors","modules/clean/react/files_view/data/selectors/instance_selectors","modules/clean/react/files_view/drag_drop/drag_and_drop","modules/clean/react/files_view/rows/file_shared_with_me_row","modules/clean/react/files_view/keyboard_shortcuts","modules/clean/react/files_view/rows/new_folder_row","modules/clean/react/files_view/rows/paper_row","modules/clean/react/files_view/rows/row_container","modules/clean/react/files_view/types","modules/clean/react/files_view/view_type","modules/clean/react/files_view/rows/user_defined_item_row","modules/clean/react/files_view/data/selectors/files_view_selectors"],(function(e,t,s,o,i,r,a,n,l,c,d,u,_,p,m,f,h,g,S,E){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FilesViewList=t.FilesViewListComponent=t.isGlobalEvent=void 0,o=s.__importDefault(o);const T=()=>{};t.isGlobalEvent=e=>{const t=["menuitem","treeitem"];switch(e.key){case"ArrowLeft":case"ArrowUp":case"ArrowRight":case"ArrowDown":return!(e.target instanceof Element&&t.includes(e.target.getAttribute("role")||""));default:return!0}};class b extends o.default.Component{constructor(){super(...arguments),this.getIsListEvent=e=>this.props.isSelectableListEvent()&&(!(e.target instanceof Element)||"BUTTON"!==e.target.tagName),this.getSelectedFiles=()=>this.props.selectedFiles,this.getActiveDropTarget=()=>this.props.activeDropTarget,this.getIsDraggingInternalFiles=()=>!!this.props.isDraggingInternalFiles,this.getIsDraggingExternalFiles=()=>!!this.props.isDraggingExternalFiles,this.renderRow=(e,t,s)=>{var i,n,l,c;if("NewFolderRow"===e.type)return o.default.createElement(p.NewFolderRow,{createNewFolderState:e.props.createNewFolderState,isInsideMyTeamFolderTree:e.props.isInsideMyTeamFolderTree,onCancel:this.props.onNewFolderCancel,onSubmit:this.props.onNewFolderSubmit,rowIndex:t,topOffset:s,iconSize:e.props.iconSize});if("PaperRow"===e.type)return o.default.createElement(a.ColumnResizingContext.Consumer,null,({columnSizes:i,columnResizingEnabled:r})=>o.default.createElement(m.PaperRow,{paper:e.props.paper,rowIndex:t,topOffset:s,user:this.props.user,visibleColumns:e.props.visibleColumns,onOpenPaper:this.props.onOpenPaper,arePostTTIModulesLoaded:e.props.arePostTTIModulesLoaded,showSnippets:e.props.showSnippets,snippetRows:e.props.snippetRows,height:e.props.height,showStar:e.props.showStar,columnSizes:r?i:void 0}));if("UserDefinedItemRow"===e.type)return o.default.createElement(S.UserDefinedItemRow,{userDefinedItem:e.props.userDefinedItem,rowIndex:t,topOffset:s});const{selection:d}=this.props,_=e.props.file instanceof r.File?d.selected.last()===this.props.fileToId(e.props.file):d.selected.last()===e.props.file.file_id;if("FileSharedWithMeRow"===e.type)return null===(n=(i=this.props).registerListItem)||void 0===n||n.call(i,e.props.file.file_id,{top:s,height:e.props.height,left:0}),o.default.createElement(a.ColumnResizingContext.Consumer,null,({columnSizes:i,columnResizingEnabled:r})=>o.default.createElement(u.FileSharedWithMeRow,{arePostTTIModulesLoaded:this.props.arePostTTIModulesLoaded,file:e.props.file,visibleColumns:this.props.visibleColumns,isCompactMode:e.props.isCompactMode,getOverflowMenuActions:this.props.getOverflowMenuActions,onOpenFileSharedWithMe:this.props.onOpenFileSharedWithMe,rowIndex:t,controlsFocusable:_,topOffset:s,user:this.props.user,responsive:this.props.responsive,showSnippets:e.props.showSnippets,snippetRows:e.props.snippetRows,height:e.props.height,isSelectMode:e.props.isSelectMode,isSelected:e.props.isSelected,onSelect:this.props.onSelectFile,onDeselect:this.props.onDeselectFile,isFocused:e.props.isFocused,filteredContactName:this.props.filteredContactName,iconSize:e.props.iconSize,columnSizes:r?i:void 0}));null===(c=(l=this.props).registerListItem)||void 0===c||c.call(l,this.props.fileToId(e.props.file),{top:s,height:e.props.height,left:0});const h={key:e.key,instanceId:this.props.instanceId,itemIndex:e.itemIndex,containerWidth:e.props.containerWidth,file:e.props.file,sharingServiceInfo:e.props.sharingServiceInfo,getOverflowMenuActions:this.props.getOverflowMenuActions,hideViewFileButton:this.props.hideViewFileButton,isActiveDropTarget:e.props.isActiveDropTarget,isAvailableDropTarget:e.props.isAvailableDropTarget,isCompactMode:e.props.isCompactMode,responsive:e.props.responsive,isExtensionsMenuDisabled:e.props.isExtensionsMenuDisabled,isFocused:e.props.isFocused,isSearchMode:e.props.isSearchMode,isSelectMode:e.props.isSelectMode,isSelected:e.props.isSelected,isSharingDisabled:e.props.isSharingDisabled,onDeselect:this.props.onDeselectFile,onDragStart:this.props.onDragStart,onDragEnter:this.props.onDragEnter,onDragEnd:this.props.onDragEnd,onLocationLinkClick:this.props.onLocationLinkClick,onNavigateToFileOrFolder:this.props.onNavigateToFileOrFolder,onRenameCancel:this.props.onRenameCancel,onRenameSubmit:this.props.onRenameSubmit,onSelect:this.props.onSelectFile,renameState:e.props.renameState,rowIndex:t,controlsFocusable:_,topOffset:s,user:this.props.user,visibleColumns:this.props.visibleColumns,canDisplayFolderSizes:this.props.canDisplayFolderSizes,renderSharedWithController:this.props.renderSharedWithController,hrefForFile:this.props.hrefForFile,onShowShare:this.props.onShowShare,onPresentInZoom:this.props.onPresentInZoom,shareButtonLabel:this.props.shareButtonLabel,showShareButton:this.props.showShareButton,filteredContactName:this.props.filteredContactName,fileToId:this.props.fileToId,isFirstTaskEmptyState:this.props.isFirstTaskEmptyState,isCondensedListView:e.props.isCondensedListView,isActionBarEnabled:e.props.isActionBarEnabled,expManualTagging:this.props.expManualTagging,preventSelectionOnDrag:this.props.preventSelectionOnDrag,mediaFiltersVariant:this.props.mediaFiltersVariant,isRightClickEnabled:this.props.isRightClickEnabled};return o.default.createElement(f.RowContainer,Object.assign({},h))}}componentDidMount(){this.props.onTTI(),this.setupKeyboardShortcuts(),this.setupExternalDragHandler()}componentWillUnmount(){this.cleanupKeyboardShortcuts(),d.cleanupExternalDragHandler(this.props.keyScope)}componentDidUpdate(e){e.isActive!==this.props.isActive&&(this.props.isActive?this.setupKeyboardShortcuts():this.cleanupKeyboardShortcuts())}cleanupKeyboardShortcuts(){_.resetFilesViewKeyboardShortcuts(this.props.keyScope),_.resetFileJumpKeyboardShortcuts(this.props.keyScope)}setupKeyboardShortcuts(){const{user:e,onDelete:t,onShowRename:s,getIsFileJumping:o,onAddFileJumpKeyCode:i,onResetFileJump:r,keyScope:a,onCopyToClipboard:n,onCutToClipboard:l,onNavigateToParentFolder:c,onPasteFromClipboard:d}=this.props;_.setupFileJumpKeyboardShortcuts({scope:a,getIsFileJumping:o,onAddFileJumpKeyCode:i,onResetFileJump:r}),_.setupFilesViewKeyboardShortcuts({user:e,viewType:g.ViewType.List,getIsGlobalEvent:this.getIsGlobalEvent(),getIsItemEvent:this.getIsListEvent,getSelectedFiles:this.getSelectedFiles,isCurrentPathWriteable:this.props.getIsCurrentPathWriteable,selectAllAction:T,deselectAllAction:T,onCopyToClipboard:n,onCutToClipboard:l,onDelete:t,onFocusSearchBar:this.props.onFocusSearchBar,onNavigateToFileOrFolder:e=>this.props.onNavigateToFileOrFolder(e,{actionSource:h.FilesViewActionSource.KEYBOARD}),onNavigateToParentFolder:c,onPasteFromClipboard:d,onShowRename:s,scope:a,onShowHelpMenu:()=>this.props.onOpenKeyboardShortcutModal()})}setupExternalDragHandler(){d.setupExternalDragHandler(this.props.keyScope,this.getIsDraggingInternalFiles,this.getIsDraggingExternalFiles,this.props.onSetFileUploaderPath,".brws-file-row",this.getActiveDropTarget,this.props.onSetDropTarget)}getIsGlobalEvent(){return t.isGlobalEvent}render(){const{scrollPositionOffset:e,viewportTopOffset:t,focusedFileIndex:s,onRangeInView:i,scrollContainer:r,listItems:a,heights:l,itemBuffer:c}=this.props;return o.default.createElement(n.CulledTableBodyWithScrollContainer,{items:a,listItemHeight:l,renderRow:this.renderRow,scrollPositionOffset:e,scrollToRow:s,shouldUseWindowAsScrollContainer:!0,viewportTopOffset:t,onRangeInView:i,scrollContainer:r,itemBuffer:c,id:"files-view-table-container"})}}t.FilesViewListComponent=b,b.defaultProps={isFileViewerShown:()=>!1},b.displayName="FilesViewListComponent";t.FilesViewList=i.connect((e,t)=>({listItems:l.selectListItems(e,t),heights:l.selectListItemHeights(e,t),itemBuffer:l.selectListItemBuffer(e,t),isActive:E.isActiveFilesView(e,t.instanceId),isCheckboxDisabled:c.selectDisabledMultiselect(e,t),cutItems:c.selectCutItems(e,t)}))(b)})),define("modules/clean/react/files_view/rows/new_folder_row",["require","exports","tslib","spectrum/media_table/index","spectrum/table/index","react","spectrum/icon_content/index","modules/clean/react/files_view/name_input","modules/core/i18n"],(function(e,t,s,o,i,r,a,n,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NewFolderIcon=t.NewFolderRow=void 0,r=s.__importDefault(r),t.NewFolderRow=e=>{const{createNewFolderState:s,isInsideMyTeamFolderTree:a=!1,onCancel:c,onSubmit:d,rowIndex:u,topOffset:_,iconSize:p}=e;let m;m="SAVING_INPUT"===s?r.default.createElement("p",{className:"brws-new-folder-row-status",role:"status","aria-live":"polite"},l.intl.formatMessage({id:"p58M12",defaultMessage:"Creating new folder…"})):r.default.createElement(n.NameInput,{defaultValue:"",label:l.intl.formatMessage({id:"ss4CO0",defaultMessage:"Folder name"}),onSubmit:d,onCancel:c});const f=r.default.createElement(t.NewFolderIcon,{isInsideMyTeamFolderTree:a,iconSize:p});return r.default.createElement(o.CulledMediaRow,{"aria-rowindex":void 0!==u?u+1:void 0,className:"brws-new-folder-row",topOffset:_},r.default.createElement(i.TableCell,{className:"brws-checkbox-cell"}),r.default.createElement(o.MediaCell,{icon:f},r.default.createElement("div",{className:"brws-new-folder-row-content brws-vertically-center"},m)),r.default.createElement(i.TableCell,null),r.default.createElement(i.TableCell,null))},t.NewFolderIcon=e=>{const{isInsideMyTeamFolderTree:t,iconSize:s}=e,o=e.className||"",i=s?{width:s,height:s}:{};return r.default.createElement(a.IconContent,Object.assign({className:o,name:t?"folder_team-small":"folder-small"},i))}})),define("modules/clean/react/files_view/rows/paper_row",["require","exports","tslib","react","classnames","typescript/component_libraries/retrieval-components/src/highlighted-truncated-string/index","spectrum/media_table/index","spectrum/util/raf_throttle","modules/clean/emoji_utils","modules/clean/filename_highlights","modules/clean/paper_formatting_utils","modules/clean/react/files_view/file_snippets","modules/clean/react/files_view/star","modules/clean/react/files_view/sort_types","modules/clean/react/files_view/util","modules/core/browser","modules/core/i18n","modules/clean/react/files_view/rows/row"],(function(e,t,s,o,i,r,a,n,l,c,d,u,_,p,m,f,h,g){"use strict";function S(){}Object.defineProperty(t,"__esModule",{value:!0}),t.PaperRow=void 0,o=s.__importDefault(o),i=s.__importDefault(i),l=s.__importStar(l),d=s.__importStar(d),f=s.__importStar(f);const E=e=>void 0===e?{}:{width:e,minWidth:e,maxWidth:e};class T extends o.default.PureComponent{constructor(e){super(e),this.setRef=e=>{this.brwsFilenameContainerDiv=e},this.handleWindowResize=()=>{this.throttledWindowResize.request()},this.handleResize=()=>{if(this.brwsFilenameContainerDiv){const{brwsFilenameContainerDivWidth:e}=this.state,t=this.brwsFilenameContainerDiv.getBoundingClientRect().width;t&&t!==e&&this.setState({brwsFilenameContainerDivWidth:t})}},this.handleOpenNewTabOrNavigate=e=>{0===e.button&&(e.preventDefault(),e.stopPropagation(),this.handleNavigate({openInNewTab:m.hasModifierKey(e)}))},this.handleNavigate=({openInNewTab:e})=>{const{paper:t,onOpenPaper:s}=this.props;e?f.open_tab(t.url):s(t)},this.throttledWindowResize=new n.RafThrottle(()=>this.handleResize()),this.state=this.calcState(e)}UNSAFE_componentWillReceiveProps(e){if(this.props.paper.title!==e.paper.title||this.props.paper.highlight_spans!==e.paper.highlight_spans){const t=this.calcState(e);this.setState(t)}}componentDidMount(){this.handleResize(),window.addEventListener("resize",this.handleWindowResize)}componentWillUnmount(){window.removeEventListener("resize",this.handleWindowResize)}componentDidUpdate(e){var t,s;(null===(t=e.columnSizes)||void 0===t?void 0:t[p.SortField.FILENAME])!==(null===(s=this.props.columnSizes)||void 0===s?void 0:s[p.SortField.FILENAME])&&this.handleResize()}calcState(e){return{titleParts:d.getPaperDocTitleParts(e.paper,"brws-file-name-cell-icon","brws-file-name-cell-icon-emoji")}}getHighlightedSpansForHighlightedTruncatedString(e){let{title:t,highlight_spans:s,title_highlights:o}=e;const i=s&&s.length>0,r=l.getFirstEmojiFromTitle(t);if(i){if(r){const e={highlight_str:s[0].highlight_str.substr(r.length),is_highlighted:s[0].is_highlighted};s=[e,...s.slice(1)]}return s.map(e=>({string:e.highlight_str,isHighlighted:e.is_highlighted}))}if(o){if(r){t=t.substr(r.length);const e=r.length/2;o=o.slice().map(t=>({pos:t.pos-e,len:t.string.length,string:t.string}))}return c.highlightMatchSections(t,o).map(e=>({string:e.text,isHighlighted:e.isHighlighted}))}}renderTitleElement(e){const{paper:t,showHighlights:s}=this.props,{title:i,highlightedTitle:a}=this.state.titleParts;if(e){const a=o.default.createElement(r.HighlightedTruncatedString,{text:i,className:"brws-file-name-element",fontSize:14,highlightSpans:this.getHighlightedSpansForHighlightedTruncatedString(t),cellBuffer:3,availableWidth:e});return o.default.createElement("a",{className:"brws-paper-doc-name-cell-title",href:t.url,onClick:this.handleOpenNewTabOrNavigate},s?a:o.default.createElement("span",null,i))}return o.default.createElement("a",{className:"brws-paper-doc-name-cell-title",href:t.url,onClick:this.handleOpenNewTabOrNavigate},s?a:o.default.createElement("span",null,i))}renderPaperCellContent(e,t){const{paper:s,user:i,showSnippets:r,snippetRows:n,showStar:l}=this.props;return o.default.createElement(o.default.Fragment,null,o.default.createElement("div",{className:"brws-paper-doc-name-cell-content brws-vertically-center"},o.default.createElement("div",{className:"brws-paper-doc-name-cell-title-container"},o.default.createElement(a.MediaCellText,{highlight:e,className:"brws-paper-doc-cell-name"},this.renderTitleElement(t))),o.default.createElement(a.MediaCellText,{variant:"subtitle"},h.intl.formatMessage({id:"mvOTrD",defaultMessage:"in Paper"})),r&&o.default.createElement(a.MediaCellText,{key:"snippets",variant:"subtitle"},o.default.createElement("div",{className:"brws-file-snippets-tags-container"},o.default.createElement(u.FileSnippets,{snippets:s.snippets,lineClamp:n})))),l&&o.default.createElement(_.StarContainer,{item:s,user:i,key:"paperStar",className:"brws-file-name-cell-star",starButtonClassName:"brws-file-name-star-button",alwaysShowUnstarred:!0}))}renderDocName(e,t){const{height:s}=this.props,{icon:r}=this.state.titleParts,n={highlight:e,icon:r,style:Object.assign({minHeight:s-1},E(t))},l=i.default("brws-file-name-container",{"brws-file-name-container--action-ui-inline-star":!0}),{brwsFilenameContainerDivWidth:c}=this.state;return o.default.createElement(a.MediaCell,Object.assign({key:"docName"},n),o.default.createElement("div",{className:l,ref:this.setRef},this.renderPaperCellContent(e,c)))}renderDocInfo(e){const{paper:t}=this.props,s=t.last_modified_date||"",i=t.last_editor_name?h.intl.formatMessage({id:"ACVnV9",defaultMessage:"by {modified_by}"},{modified_by:t.last_editor_name}):h.intl.formatMessage({id:"5794tP",defaultMessage:"by you"});return o.default.createElement(a.MediaCell,{key:"docInfo",subtitle:i,title:s,style:E(e)})}renderCell({isHovered:e,sortField:t}){var s;const i=null===(s=this.props.columnSizes)||void 0===s?void 0:s[t];switch(t){case p.SortField.FILENAME:return this.renderDocName(e,i);case p.SortField.RELEVANCE:case p.SortField.MODIFIED:return this.renderDocInfo(i);default:return o.default.createElement(a.MediaCell,{key:t,title:o.default.createElement("span",{"aria-hidden":!0},"--"),style:E(i)})}}render(){const{rowIndex:e,topOffset:t,visibleColumns:s,paper:i}=this.props;return o.default.createElement(g.FilesViewRow,{className:"brws-paper-row",topOffset:t,rowIndex:e,filename:i.title,ariaLabel:i.title,onSelect:S,onDeselect:S,onNavigateToItem:this.handleNavigate},({isHovered:e})=>[o.default.createElement(a.MediaCell,{key:"checkboxCell",className:"brws-checkbox-cell"}),...s.map(t=>this.renderCell({isHovered:e,sortField:t.sortField}))])}}t.PaperRow=T,T.defaultProps={showHighlights:!0},T.displayName="PaperRow"})),define("modules/clean/react/files_view/rows/row",["require","exports","tslib","classnames","react","spectrum/media_table/index","modules/clean/react/files_view/double_click","modules/clean/react/files_view/types","modules/clean/react/files_view/util","modules/clean/react/selectable_list"],(function(e,t,s,o,i,r,a,n,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FilesViewRow=void 0,o=s.__importDefault(o),i=s.__importDefault(i);const d=({className:e,isSelected:t,isDeleted:s,isDraggable:d,isActiveDropTarget:u,rowIndex:_,ariaLabel:p,filename:m,children:f,onDragEnter:h,isSelectMode:g,onDragStart:S,onDragEnd:E,onNavigateToItem:T,onSelect:b,onDeselect:w,topOffset:I=0,isRightClickEnabled:v})=>{const O=e=>{v&&(e.defaultPrevented||(e.preventDefault(),e.shiftKey?b(c.SelectOptions.EXTEND,n.FilesViewActionSource.ROW_SINGLE_CLICK):e.ctrlKey||e.metaKey?b(c.SelectOptions.DEFAULT,n.FilesViewActionSource.ROW_SINGLE_CLICK):t||b(c.SelectOptions.ONLY,n.FilesViewActionSource.ROW_SINGLE_CLICK)))},C=(e,t)=>{0===e.button&&(e.preventDefault(),e.stopPropagation(),T({openInNewTab:Boolean(l.hasModifierKey(e)),actionSource:t}))};return i.default.createElement(a.WithDoubleClick,{onClick:e=>{e.defaultPrevented||(e.preventDefault(),e.shiftKey?b(c.SelectOptions.EXTEND,n.FilesViewActionSource.ROW_SINGLE_CLICK):e.ctrlKey||e.metaKey?t?w(!1,n.FilesViewActionSource.ROW_SINGLE_CLICK):b(c.SelectOptions.DEFAULT,n.FilesViewActionSource.ROW_SINGLE_CLICK):b(c.SelectOptions.ONLY,n.FilesViewActionSource.ROW_SINGLE_CLICK))},onDoubleClick:e=>{e.defaultPrevented||C(e,n.FilesViewActionSource.ROW_DOUBLE_CLICK)}},({onClick:a})=>i.default.createElement(r.CulledMediaRow,{className:o.default(e,{"brws-file-row-selected":t,"brws-file-row-deleted":s,"brws-file-row-dragover":u,"brws-row-click-selection-method":!0}),variant:(u?"dragover":t&&"selected")||"default",onClick:a,onContextMenu:O,draggable:d,topOffset:I,onDragEnter:h,onDragStart:t?S:void 0,onDragEnd:E,"aria-rowindex":(_||0)+1,"aria-controls":"brws-sidebar-view","aria-label":p,"data-filename":m,tabIndex:g?-1:0===_?0:-1},f))};d.displayName="FilesViewRowUnmemoed",t.FilesViewRow=i.default.memo(d),t.FilesViewRow.displayName="FilesViewRow"})),define("modules/clean/react/files_view/rows/row_container",["require","exports","tslib","react","react-redux","modules/clean/react/files_view/resizing/column_size_context","modules/clean/react/files_view/data/selectors/instance_selectors","modules/clean/react/files_view/data/selectors/item_selectors","modules/clean/react/files_view/rows/file_row"],(function(e,t,s,o,i,r,a,n,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RowContainer=t.RowContainerWithoutRedux=void 0,o=s.__importDefault(o),t.RowContainerWithoutRedux=o.default.memo(e=>o.default.createElement(r.ColumnResizingContext.Consumer,null,({columnSizes:t,columnResizingEnabled:s})=>o.default.createElement(l.FileRow,Object.assign({},e,{columnSizes:s?t:void 0})))),t.RowContainerWithoutRedux.displayName="RowContainerWithoutRedux";t.RowContainer=i.connect((e,t)=>({arePostTTIModulesLoaded:a.selectArePostTTIModulesLoaded(e,t),context:a.selectContext(e,t),isCheckboxDisabled:a.selectDisabledMultiselect(e,t),responsive:a.selectResponsive(e,t),showCDMUserEducationEffects:n.selectShowCDMUserEducationEffects(e,t),height:n.selectRowHeight(e,Object.assign(Object.assign({},t),{numVisibleColumns:t.visibleColumns.length})),iconSize:n.selectIconSize(e,t),isCutToClipboard:n.selectIsCutToClipboard(e,t)}))(t.RowContainerWithoutRedux)})),define("modules/clean/react/files_view/scroll_updater",["require","exports","tslib","react-redux","react","modules/clean/react/files_view/data/selectors/files_view_selectors"],(function(e,t,s,o,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ScrollUpdater=void 0,i=s.__importDefault(i),r=s.__importStar(r),t.ScrollUpdater=({scrollContainer:e,path:t})=>{const s=o.useSelector(r.currentScroll),a=t=>{e&&e.current?e.current.scrollTop=t:window.scrollTo(0,t)};return i.default.useEffect(()=>{(()=>{if(!s)return;const{scrollTop:e}=s;a(e)})()},[s]),i.default.useEffect(()=>{a(0)},[t]),null}})),define("modules/clean/react/files_view/sticky_table_head",["require","exports","tslib","spectrum/dimensions/index","spectrum/table/index","react","modules/clean/react/sticky/sticky","modules/clean/react/sticky/container"],(function(e,t,s,o,i,r,a,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StickyTableHead=void 0,r=s.__importDefault(r),t.StickyTableHead=e=>{var{children:t,columnFlex:l,offsetHeight:c,offsetTop:d}=e,u=s.__rest(e,["children","columnFlex","offsetHeight","offsetTop"]);const _=r.default.createElement(o.Dimensions,{tagName:"tr"},({width:e})=>r.default.createElement("td",{className:"brws-sticky-table-cell"},r.default.createElement(n.StickyContainer,{offsetTop:d},r.default.createElement(a.Sticky,null,r.default.createElement(i.Table,{columnFlex:l,style:{width:e}},r.default.createElement(i.TableHead,Object.assign({},u),t))))));return r.default.createElement("thead",{className:"brws-sticky-table-head"},_)}})),define("modules/clean/react/files_view/thumbnail_media_cell",["require","exports","tslib","react","spectrum/media_table/index","modules/clean/react/files_view/file_thumbnail"],(function(e,t,s,o,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ThumbnailMediaCell=void 0,o=s.__importDefault(o),t.ThumbnailMediaCell=e=>{var{height:t,width:a,children:n}=e,l=s.__rest(e,["height","width","children"]);const c=void 0===a?{}:{width:a,minWidth:a,maxWidth:a};return o.default.createElement(i.MediaCell,{icon:o.default.createElement(r.FileThumbnail,Object.assign({},l)),style:Object.assign({minHeight:t-1},c),children:n})},t.ThumbnailMediaCell.displayName="ThumbnailMediaCell",t.ThumbnailMediaCell.displayName="ThumbnailMediaCell"})),define("modules/clean/react/files_view/unity_listener",["require","exports","tslib","react","modules/clean/web_timing_logger","modules/core/cancelable_promise","modules/clean/react/browse/models"],(function(e,t,s,o,i,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UnityListener=void 0,o=s.__importDefault(o),i=s.__importStar(i);t.UnityListener=({items:t,userId:n})=>{const[l,c]=o.default.useState(void 0);return o.default.useEffect(()=>{const t=r.makeCancelable(s.__awaiter(void 0,void 0,void 0,(function*(){return yield i.waitForTTI(),(yield new Promise((t,s)=>{e(["modules/clean/unity_browse_interface"],t,s)}).then(s.__importStar)).unityBrowseInterface})).then(e=>c(e)));return()=>t.cancel()},[]),o.default.useEffect(()=>{null==l||l.browse_visible_change_callback(t.toArray().filter(e=>e instanceof a.File),n,0,t.size-1)},[l,t,n]),null},t.UnityListener.displayName="UnityListener"})),define("modules/clean/react/files_view/rows/user_defined_item_row",["require","exports","tslib","react"],(function(e,t,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UserDefinedItemRow=void 0,o=s.__importDefault(o),t.UserDefinedItemRow=o.default.memo(({rowIndex:e,topOffset:t,userDefinedItem:s})=>s.renderUserDefinedItemRow({rowIndex:e,topOffset:t})),t.UserDefinedItemRow.displayName="UserDefinedItemRow"})),define("modules/clean/react/files_view/view_preferences",["require","exports","modules/core/persistence/storage"],(function(e,t,s){"use strict";function o(e){return Object.assign({},s.UserLocalStorage.get(e,t.VIEW_PREFERENCES_STORAGE_KEY))}function i(e,i,r){const a=o(e),n=Object.assign(Object.assign({},r),{last_updated_ts:Date.now()});for(const e of i)a[e]=Object.assign(Object.assign({},a[e]),n);for(;Object.keys(a).length>t.VIEW_PREFERENCES_STORAGE_LIMIT;){const e=Object.keys(a).reduce((e,t)=>!e||a[t].last_updated_ts<a[e].last_updated_ts?t:e);delete a[e]}s.UserLocalStorage.set(e,t.VIEW_PREFERENCES_STORAGE_KEY,a)}function r(e,t){const s={},i=o(e);return Object.keys(i).forEach(e=>{const o=i[e][t];void 0!==o&&(s[e]=o)}),s}Object.defineProperty(t,"__esModule",{value:!0}),t.setNumVisibleColumns=t.getScopedNumVisibleColumns=t.setSort=t.getScopedSorts=t.setColumnsIndex=t.getScopedColumnsIndex=t.setViewType=t.getViewTypes=t.getPreferences=t.VIEW_PREFERENCES_STORAGE_LIMIT=t.VIEW_PREFERENCES_STORAGE_KEY=void 0,t.VIEW_PREFERENCES_STORAGE_KEY="files_view_preferences",t.VIEW_PREFERENCES_STORAGE_LIMIT=500,t.getPreferences=o,t.getViewTypes=function(e){const t=o(e);if(!t||0===Object.keys(t).length)return null;const s={};return Object.keys(t).forEach(e=>{const o=t[e].file_view_mode;o&&(s[e]=o)}),s},t.setViewType=function(e,t,s){i(e,t,{file_view_mode:s})},t.getScopedColumnsIndex=function(e){return r(e,"columns_index")},t.setColumnsIndex=function(e,t,s){i(e,t,{columns_index:s})},t.getScopedSorts=function(e){return r(e,"sort_state")},t.setSort=function(e,t,s){i(e,t,{sort_state:s})},t.getScopedNumVisibleColumns=function(e){return r(e,"num_visible_columns")},t.setNumVisibleColumns=function(e,t,s){i(e,t,{num_visible_columns:s})}})),define("modules/clean/react/folder_dialog/async",["require","exports","tslib","react","modules/clean/react/components/modal_controller","modules/clean/css"],(function(e,t,s,o,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.prewarmFolderDialog=t.showFolderDialog=void 0,o=s.__importDefault(o),t.showFolderDialog=function(t){new Promise((t,s)=>{e(["modules/clean/react/folder_dialog/folder_dialog"],t,s)}).then(s.__importStar).then(({FolderDialog:e})=>{i.mountModal(o.default.createElement(e,Object.assign({},t)))})},t.prewarmFolderDialog=function(){new Promise((t,s)=>{e(["modules/clean/react/folder_dialog/folder_dialog"],t,s)}).then(s.__importStar).then(()=>{r.require_css("/static/css/react/folder_picker-vflqf-mgm.css")})}})),define("modules/clean/react/growth/personalization/collection_folder/collection_folder",["require","exports","tslib","react","modules/clean/react/components/css","modules/clean/react/image","modules/clean/static_urls","dig-components/typography","dig-components/buttons","modules/clean/react/growth/personalization/collection_folder/constants","modules/clean/react/growth/personalization/collection_folder/actions","modules/clean/paper/template_library/constants","modules/clean/dropbox_form","modules/clean/react/growth/personalization/collection_folder/logger","modules/clean/growth/smb_funnel/smb_funnel_logger","modules/clean/react/admin/teams/onboarding/web/constants"],(function(e,t,s,o,i,r,a,n,l,c,d,u,_,p,m,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CollectionFolder=t.CollectionFolderView=void 0,o=s.__importDefault(o),d=s.__importStar(d),p=s.__importStar(p);class h extends o.default.PureComponent{constructor(){super(...arguments),this.getActionCallback=(e,t,s,o,i,r)=>{switch(o){case c.ActionCallbackType.CREATE_GOOGLE_SHEETS:return()=>d.createGoogleSheets(e,t.currentFQPath);case c.ActionCallbackType.DOWNLOAD:return()=>d.downloadDesktop(e);case c.ActionCallbackType.OPEN_SHARE_MODAL:return()=>d.asyncOpenShareFolderSetting(e,t,r);case c.ActionCallbackType.UPLOAD:return()=>d.uploadFile(s);case c.ActionCallbackType.REDIRECT:return()=>d.redirectToLink(i);default:return()=>{}}},this.logOnActionClicked=(e,t,s)=>{p.userClickedCollectionsFolderAction(e,t),s?s():m.SMBFunnelLogger.log(f.AMPMetrics.ACTIVATION_COLLECTIONS_ACTION_PAPER,{collectionFolderType:String(e),templateName:t})},this.getActionButton=e=>{const{user:t,context:s,handleUploadButtonClick:i}=this.props;if(e.actionCallbackType===c.ActionCallbackType.CREATE_PAPER_TEMPLATE)return o.default.createElement(_.DropboxForm,{method:"post",action:u.REDIRECT_URL+"?slugId="+e.paperTemplateSlugId,target:"_blank"},o.default.createElement(l.Button,{type:"submit",variant:"outline",onClick:()=>this.logOnActionClicked(s.collectionFolderType,e.loggingTitle)},e.buttonText));{const r=this.getActionCallback(t,s,i,e.actionCallbackType,e.redirectLink,e.shareModalSettingsTab);return o.default.createElement(l.Button,{type:"button",variant:"outline",onClick:()=>this.logOnActionClicked(s.collectionFolderType,e.loggingTitle,r)},e.buttonText)}}}render(){const{context:e,role:t}=this.props,s=c.collectionPanelConfig(t,e.collectionFolderType);if(void 0===s)return null;p.userViewCollectionsFolder(e.collectionFolderType,t,s.actions);const i=s.actions.map((e,t)=>o.default.createElement("div",{className:"collection-action-item",key:t},o.default.createElement(r.Image,{alt:c.imageAltString,src:a.static_url(e.imageUrl),srcHiRes:a.static_url(e.imageHiResUrl)}),o.default.createElement("div",{className:"collection-action-item__rc"},o.default.createElement("div",{className:"collection-action-item__rc__title"},o.default.createElement(n.Title,{size:"small",isBold:!0},e.title)),o.default.createElement("div",{className:"collection-action-item__rc__desc"},o.default.createElement(n.Text,null,e.desc)),o.default.createElement("div",{className:"collection-action-item__rc__button"},this.getActionButton(e)))));return o.default.createElement("div",{className:"collection-panel"},o.default.createElement("div",{className:"collection-overview-title"},o.default.createElement(n.Title,{size:"small",isBold:!0},c.overviewTitle)),o.default.createElement("div",{className:"collection-overview-desc"},o.default.createElement("div",{className:"collection-overview-desc__text"},o.default.createElement(n.Text,null,s.overviewDesc))),o.default.createElement("div",{className:"collection-action-title"},o.default.createElement("div",{className:"collection-action-title__text"},o.default.createElement(n.Title,{size:"small",isBold:!0},s.actionsTitle))),o.default.createElement("div",{className:"collection-action-panel"},i))}}t.CollectionFolderView=h,h.displayName="CollectionFolderView",t.CollectionFolder=i.requireCssWithComponent(h,["/static/css/dig-components/index.web-vflm67Rix.css","/static/css/growth/experiments/collection_folder-vflpSIfgG.css"])})),define("modules/clean/react/growth/personalization/collection_folder/constants",["require","exports","modules/core/i18n","modules/clean/filetypes"],(function(e,t,s,o){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.overviewTitle=t.collectionPanelConfig=t.imageAltString=t.ActionCallbackType=t.WATERMARK_LINK=t.PAPER_TEMPLATES_LINK=t.FILE_REQUEST_LINK=void 0,t.FILE_REQUEST_LINK="/requests",t.PAPER_TEMPLATES_LINK="/paper/templates",t.WATERMARK_LINK="/features/share/watermark",(function(e){e.DOWNLOAD="download",e.CREATE_GOOGLE_SHEETS="create_google_sheets",e.CREATE_PAPER_TEMPLATE="create_paper_template",e.OPEN_SHARE_MODAL="open_share_modal",e.UPLOAD="upload",e.REDIRECT="redirect"})(i=t.ActionCallbackType||(t.ActionCallbackType={})),t.imageAltString=s.intl.formatMessage({id:"G0BGYo",defaultMessage:"Image loading"});const r={imageUrl:"/static/images/growth/personalization/collections_exp/Get_Smart_Sync_on_desktop-vfllGWHCs.png",imageHiResUrl:"/static/images/growth/personalization/collections_exp/Get_Smart_Sync_on_desktop@2x-vflXfvyBS.png",title:s.intl.formatMessage({id:"cBBY+o",defaultMessage:"Get Smart Sync on desktop"}),loggingTitle:"smart_sync",desc:s.intl.formatMessage({id:"4PtkZL",defaultMessage:"Store all your computer files in the cloud to save computer space and keep everything backed up."}),buttonText:s.intl.formatMessage({id:"8cyvqx",defaultMessage:"Open the desktop app"}),actionCallbackType:i.DOWNLOAD},a={imageUrl:"/static/images/growth/personalization/collections_exp/Lock_files_when_you_edit_them-vflNkx0x7.png",imageHiResUrl:"/static/images/growth/personalization/collections_exp/Lock_files_when_you_edit_them@2x-vflEgd1S9.png",title:s.intl.formatMessage({id:"XVzKiX",defaultMessage:"Lock files when you edit them"}),loggingTitle:"lock_files",desc:s.intl.formatMessage({id:"LhuHW+",defaultMessage:"In the desktop app, right click a file in any shared folder to keep others from editing it at the same time."}),buttonText:s.intl.formatMessage({id:"8m53T6",defaultMessage:"Upload file and try"}),actionCallbackType:i.UPLOAD},n={imageUrl:"/static/images/growth/personalization/collections_exp/Work_off_Google_Sheets-vflnZKx1s.png",imageHiResUrl:"/static/images/growth/personalization/collections_exp/Work_off_Google_Sheets@2x-vflY3NFJm.png",title:s.intl.formatMessage({id:"ZWTwJC",defaultMessage:"Work off Google Sheets"}),loggingTitle:"google_sheet",desc:s.intl.formatMessage({id:"HdzKjx",defaultMessage:"Create and use Google files from within Dropbox to have all your spreadsheets stored in one place."}),buttonText:s.intl.formatMessage({id:"vlzkco",defaultMessage:"Create Google Sheet"}),actionCallbackType:i.CREATE_GOOGLE_SHEETS},l={imageUrl:"/static/images/growth/personalization/collections_exp/Decide_who_can_edit_folders-vfl3MUfmT.png",imageHiResUrl:"/static/images/growth/personalization/collections_exp/Decide_who_can_edit_folders@2x-vflzQOJeG.png",title:s.intl.formatMessage({id:"vhvaO9",defaultMessage:"Decide who can edit folders"}),loggingTitle:"folder_settings",desc:s.intl.formatMessage({id:"jSmn2k",defaultMessage:"Give specific people permission to edit or view-only access for individual folders."}),buttonText:s.intl.formatMessage({id:"+pTjXN",defaultMessage:"Open folder settings"}),actionCallbackType:i.OPEN_SHARE_MODAL,shareModalSettingsTab:"folder_settings"},c={imageUrl:"/static/images/growth/personalization/collections_exp/Have_total_control_of_shared_links-vflyAyrmd.png",imageHiResUrl:"/static/images/growth/personalization/collections_exp/Have_total_control_of_shared_links@2x-vflfnAKvn.png",title:s.intl.formatMessage({id:"6oKVMW",defaultMessage:"Have total control of shared links"}),loggingTitle:"link_settings",desc:s.intl.formatMessage({id:"z4ud8c",defaultMessage:"Set passwords, disable downloads, and set expirations dates on anything you share with a link."}),buttonText:s.intl.formatMessage({id:"Q9UABZ",defaultMessage:"Open link settings"}),actionCallbackType:i.OPEN_SHARE_MODAL,shareModalSettingsTab:"view_link_settings"},d={imageUrl:"/static/images/growth/personalization/collections_exp/Watermark_your_PDFs_and_photos-vflkjxZpk.png",imageHiResUrl:"/static/images/growth/personalization/collections_exp/Watermark_your_PDFs_and_photos@2x-vfl4utj4c.png",title:s.intl.formatMessage({id:"0ZcoHO",defaultMessage:"Watermark your PDFs and photos"}),loggingTitle:"watermark",desc:s.intl.formatMessage({id:"UYiZrN",defaultMessage:"When you preview a file in Dropbox, you can watermark it with your logos or text."}),buttonText:s.intl.formatMessage({id:"gk12sS",defaultMessage:"Learn more"}),actionCallbackType:i.REDIRECT,redirectLink:t.WATERMARK_LINK},u={imageUrl:"/static/images/growth/personalization/collections_exp/Comment_and_annotate_on_files-vfl-sZwtU.png",imageHiResUrl:"/static/images/growth/personalization/collections_exp/Comment_and_annotate_on_files@2x-vflg-KF4w.png",title:s.intl.formatMessage({id:"6uwoJY",defaultMessage:"Comment and annotate on files"}),loggingTitle:"comment_files",desc:s.intl.formatMessage({id:"xqj2eW",defaultMessage:"Mention teammates on specific areas of files for targeted feedback."}),buttonText:s.intl.formatMessage({id:"8m53T6",defaultMessage:"Upload file and try"}),actionCallbackType:i.UPLOAD},_={imageUrl:"/static/images/growth/personalization/collections_exp/Request_files_from_others-vflvy4CGu.png",imageHiResUrl:"/static/images/growth/personalization/collections_exp/Request_files_from_others@2x-vflms8zVt.png",title:s.intl.formatMessage({id:"bgGX06",defaultMessage:"Request files from others"}),loggingTitle:"request_files",desc:s.intl.formatMessage({id:"BqqQJn",defaultMessage:"Collect and receive large files from anyone-right in your Dropbox account."}),buttonText:s.intl.formatMessage({id:"34LFfx",defaultMessage:"Try file request"}),actionCallbackType:i.REDIRECT,redirectLink:t.FILE_REQUEST_LINK},p={imageUrl:"/static/images/growth/personalization/collections_exp/Brainstorming-vflzwizf3.png",imageHiResUrl:"/static/images/growth/personalization/collections_exp/Brainstorming@2x-vfljrvaTs.png",title:s.intl.formatMessage({id:"mIVTjA",defaultMessage:"Brainstorming"}),loggingTitle:"brainstorming",desc:s.intl.formatMessage({id:"8yBNxI",defaultMessage:"Collect inspiration, exchange ideas in real-time, and get feedback."}),buttonText:s.intl.formatMessage({id:"KLVfpZ",defaultMessage:"Create doc"}),actionCallbackType:i.CREATE_PAPER_TEMPLATE,paperTemplateSlugId:"brainstorm"},m={imageUrl:"/static/images/growth/personalization/collections_exp/Brand_guidelines-vfl73kagH.png",imageHiResUrl:"/static/images/growth/personalization/collections_exp/Brand_guidelines@2x-vflWEdsrX.png",title:s.intl.formatMessage({id:"qpwvDp",defaultMessage:"Brand guidelines"}),loggingTitle:"brand_guidelines",desc:s.intl.formatMessage({id:"PhOzXb",defaultMessage:"Craft guidelines that help everyone create written and visual materials."}),buttonText:s.intl.formatMessage({id:"KLVfpZ",defaultMessage:"Create doc"}),actionCallbackType:i.CREATE_PAPER_TEMPLATE,paperTemplateSlugId:"brand-guidelines"},f={imageUrl:"/static/images/growth/personalization/collections_exp/Creative_brief-vflzoR7nu.png",imageHiResUrl:"/static/images/growth/personalization/collections_exp/Creative_brief@2x-vflfJwHyd.png",title:s.intl.formatMessage({id:"4HhApp",defaultMessage:"Creative brief"}),loggingTitle:"creative_brief",desc:s.intl.formatMessage({id:"+2jNKl",defaultMessage:"Capture project information, share deliverables, and collect targeted feedback in a single doc."}),buttonText:s.intl.formatMessage({id:"KLVfpZ",defaultMessage:"Create doc"}),actionCallbackType:i.CREATE_PAPER_TEMPLATE,paperTemplateSlugId:"creative-brief"},h={imageUrl:"/static/images/growth/personalization/collections_exp/Hiring_doc-vfl7-KGxC.png",imageHiResUrl:"/static/images/growth/personalization/collections_exp/Hiring_doc@2x-vfltl18DZ.png",title:s.intl.formatMessage({id:"Ob69jI",defaultMessage:"Hiring doc"}),loggingTitle:"hiring_doc",desc:s.intl.formatMessage({id:"/MXP6f",defaultMessage:"Consolidate candidate data, manage interview schedules, and co-edit interview questions."}),buttonText:s.intl.formatMessage({id:"KLVfpZ",defaultMessage:"Create doc"}),actionCallbackType:i.CREATE_PAPER_TEMPLATE,paperTemplateSlugId:"hiring-doc"},g={imageUrl:"/static/images/growth/personalization/collections_exp/Launch_plan-vflUr4YEg.png",imageHiResUrl:"/static/images/growth/personalization/collections_exp/Launch_plan@2x-vflBHVqHw.png",title:s.intl.formatMessage({id:"eJBiUX",defaultMessage:"Launch plan"}),loggingTitle:"launch_plan",desc:s.intl.formatMessage({id:"Dnp+hz",defaultMessage:"Coordinate teams by setting milestones, assigning to-dos, and managing approvals."}),buttonText:s.intl.formatMessage({id:"KLVfpZ",defaultMessage:"Create doc"}),actionCallbackType:i.CREATE_PAPER_TEMPLATE,paperTemplateSlugId:"launch-plan"},S={imageUrl:"/static/images/growth/personalization/collections_exp/More_templates-vflPM9mUx.png",imageHiResUrl:"/static/images/growth/personalization/collections_exp/More_templates@2x-vflu1bMcB.png",title:s.intl.formatMessage({id:"o6Oqk/",defaultMessage:"More templates"}),loggingTitle:"more_templates",desc:"",buttonText:s.intl.formatMessage({id:"SJ7MeI",defaultMessage:"See all templates"}),actionCallbackType:i.REDIRECT,redirectLink:t.PAPER_TEMPLATES_LINK},E={imageUrl:"/static/images/growth/personalization/collections_exp/New_hire_onboarding-vflhJapds.png",imageHiResUrl:"/static/images/growth/personalization/collections_exp/New_hire_onboarding@2x-vfl6PxFtO.png",title:s.intl.formatMessage({id:"ZTukLA",defaultMessage:"New hire onboarding"}),loggingTitle:"new_hire_onboarding",desc:s.intl.formatMessage({id:"eHWzWM",defaultMessage:"Centralize information to help new employees get started during their first few days."}),buttonText:s.intl.formatMessage({id:"KLVfpZ",defaultMessage:"Create doc"}),actionCallbackType:i.CREATE_PAPER_TEMPLATE,paperTemplateSlugId:"new-hire-onboarding"},T={imageUrl:"/static/images/growth/personalization/collections_exp/Project_plan-vfleFZaG-.png",imageHiResUrl:"/static/images/growth/personalization/collections_exp/Project_plan@2x-vfl7tdW9j.png",title:s.intl.formatMessage({id:"WAEQqE",defaultMessage:"Project plan"}),loggingTitle:"project_plan",desc:s.intl.formatMessage({id:"7kQoXu",defaultMessage:"Organize and track work from start to finish. Help your team stay updated on who's doing what."}),buttonText:s.intl.formatMessage({id:"KLVfpZ",defaultMessage:"Create doc"}),actionCallbackType:i.CREATE_PAPER_TEMPLATE,paperTemplateSlugId:"project-plan"},b={accounting:[T,{imageUrl:"/static/images/growth/personalization/collections_exp/Team_checklist-vflYtWkbF.png",imageHiResUrl:"/static/images/growth/personalization/collections_exp/Team_checklist@2x-vfl-cPX_9.png",title:s.intl.formatMessage({id:"FAZpqt",defaultMessage:"Team checklist"}),loggingTitle:"team_checklist",desc:s.intl.formatMessage({id:"k9LVWK",defaultMessage:"Manage team to-dos with task assignments, due dates, and reminder notifications."}),buttonText:s.intl.formatMessage({id:"KLVfpZ",defaultMessage:"Create doc"}),actionCallbackType:i.CREATE_PAPER_TEMPLATE,paperTemplateSlugId:"team-checklist"},S],human_resources:[E,h,S],self_employed:[T,p,S],marketing:[g,m,S],art:[f,{imageUrl:"/static/images/growth/personalization/collections_exp/Video_production_plan-vfltPey9e.png",imageHiResUrl:"/static/images/growth/personalization/collections_exp/Video_production_plan@2x-vflnUV7G8.png",title:s.intl.formatMessage({id:"qLearS",defaultMessage:"Video production plan"}),loggingTitle:"video_production_plan",desc:s.intl.formatMessage({id:"w4SaFl",defaultMessage:"Stay organized and on track from pre- to post-production. Add scripts, music, video, timelines, and budgets."}),buttonText:s.intl.formatMessage({id:"KLVfpZ",defaultMessage:"Create doc"}),actionCallbackType:i.CREATE_PAPER_TEMPLATE,paperTemplateSlugId:"video-production-plan"},S]};t.collectionPanelConfig=(e,t)=>{switch(t){case o.CollectionFolderType.SHARING:return{overviewDesc:s.intl.formatMessage({id:"8i5CD2",defaultMessage:"We've got ways to make sure files stay protected—however you decide to share them."}),actionsTitle:s.intl.formatMessage({id:"0Pf729",defaultMessage:"Things to try"}),actions:[l,c,d]};case o.CollectionFolderType.SPREADSHEET:return{overviewDesc:s.intl.formatMessage({id:"rKBrhz",defaultMessage:"If you work on files with other people, here’s how to prevent unwanted changes."}),actionsTitle:s.intl.formatMessage({id:"0Pf729",defaultMessage:"Things to try"}),actions:[r,a,n]};case o.CollectionFolderType.PAPER:return{overviewDesc:s.intl.formatMessage({id:"deyLLm",defaultMessage:"Here are some Dropbox Paper templates we think would be most helpful for your role."}),actionsTitle:s.intl.formatMessage({id:"JI9VaJ",defaultMessage:"Try these templates"}),actions:b[e]};case o.CollectionFolderType.FEEDBACK:return{overviewDesc:s.intl.formatMessage({id:"rwgI/k",defaultMessage:"Whether you prefer comments, requesting docs, or private feedback—these tools can help."}),actionsTitle:s.intl.formatMessage({id:"0Pf729",defaultMessage:"Things to try"}),actions:[_,c,u]};default:return}},t.overviewTitle=s.intl.formatMessage({id:"Dvwua+",defaultMessage:"Overview"})})),define("modules/clean/react/growth/personalization/util",["require","exports"],(function(e,t){"use strict";var s,o,i,r;function a(e){return(null==e?void 0:e.firstPath)||s.NONE}function n(e,t){const i=null==t?void 0:t.desktopCtaType;if(i){return a(t)===s.DOWNLOAD_APP.valueOf()?l(e,t)?i:o.ShowWithText:i}return null}function l(e,t){return!!(null==t?void 0:t.enableDownloadAppPanel)&&e<=1}Object.defineProperty(t,"__esModule",{value:!0}),t.shouldFirstPathHaveDropTargetIcon=t.enableCollectionsQuickActions=t.enableDownloadAppPanel=t.enableDesktopCta=t.enableInvitePanel=t.enableHideRightsideActions=t.enableHideFolderOverview=t.getSuggestedFoldersType=t.getDesktopCtaType=t.getRole=t.getFirstPath=t.shouldLogFullFunnelVideoSnackbarExposure=t.shouldEnableFullFunnelVideoSnackbar=t.OnboardingInterest=t.SlimMode=t.emptyStateType=t.CollectionsQuickActionsRoleGroup=t.DropTargetBgColorType=t.SuggestedFoldersType=t.DesktopCtaType=t.FirstPathId=void 0,(function(e){e.INVITE_MEMBER="invite",e.UPLOAD_FOLDERS="upload",e.SUGGESTED_FOLDERS="folder",e.DOWNLOAD_APP="download",e.EXPLORE="explore",e.COLLECTIONS="collections",e.SUGGESTED_FOLDERS_ITERATION="suggested_folders_iteration",e.NONE=""})(s=t.FirstPathId||(t.FirstPathId={})),(function(e){e[e.ShowWithoutText=1]="ShowWithoutText",e[e.ShowWithText=2]="ShowWithText",e[e.ShowWithTextAsPrimary=3]="ShowWithTextAsPrimary"})(o=t.DesktopCtaType||(t.DesktopCtaType={})),(function(e){e[e.None=0]="None",e[e.SuggestedFoldersAsBar=1]="SuggestedFoldersAsBar",e[e.SuggestedFolders=2]="SuggestedFolders",e[e.SuggestedFoldersWithDismissAll=3]="SuggestedFoldersWithDismissAll"})(i=t.SuggestedFoldersType||(t.SuggestedFoldersType={})),(function(e){e[e.Blue=1]="Blue"})(t.DropTargetBgColorType||(t.DropTargetBgColorType={})),(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.ADMIN_SUPPORT=1]="ADMIN_SUPPORT",e[e.ACCOUNTING_FINANCE=2]="ACCOUNTING_FINANCE",e[e.LEGAL=3]="LEGAL",e[e.IT_INFOSEC=4]="IT_INFOSEC",e[e.ART_DESIGN_CREATIVE=5]="ART_DESIGN_CREATIVE",e[e.MARKETING=6]="MARKETING",e[e.SELF_EMPLOYED_FREELANCE=7]="SELF_EMPLOYED_FREELANCE",e[e.HR=8]="HR"})(t.CollectionsQuickActionsRoleGroup||(t.CollectionsQuickActionsRoleGroup={})),(function(e){e.DROP_TARGET_VIEW="drop_target_view",e.INVITE_VIEW="invite_view",e.SUGGESTED_FOLDERS_VIEW="suggested_folders_view",e.SUGGESTED_FOLDERS_TOGGLE_VIEW="suggested_folders_toggle_view",e.DOWNLOAD_APP_VIEW="download_app_view"})(t.emptyStateType||(t.emptyStateType={})),(function(e){e[e.None=0]="None",e[e.Slim=1]="Slim",e[e.SplitTmfTsdSlim=2]="SplitTmfTsdSlim"})(t.SlimMode||(t.SlimMode={})),(function(e){e[e.UNSET=0]="UNSET",e[e.VIDEO_SHARE=1]="VIDEO_SHARE"})(r=t.OnboardingInterest||(t.OnboardingInterest={})),t.shouldEnableFullFunnelVideoSnackbar=function(e){return"V2"===(null==e?void 0:e.variant)&&(null==e?void 0:e.onboarding_interest)===r.VIDEO_SHARE},t.shouldLogFullFunnelVideoSnackbarExposure=function(e){return void 0!==(null==e?void 0:e.variant)&&["CONTROL","V2"].includes(e.variant)&&(null==e?void 0:e.onboarding_interest)===r.VIDEO_SHARE},t.getFirstPath=a,t.getRole=function(e){return(null==e?void 0:e.role)||""},t.getDesktopCtaType=n,t.getSuggestedFoldersType=function(e){return(null==e?void 0:e.suggestedFoldersType)||i.None},t.enableHideFolderOverview=function(e,t){var s;return!!(null===(s=null==t?void 0:t.hiddenState)||void 0===s?void 0:s.hideFolderOverview)&&e<=4},t.enableHideRightsideActions=function(e){var t;return!!(null===(t=null==e?void 0:e.hiddenState)||void 0===t?void 0:t.hideRightsideActions)},t.enableInvitePanel=function(e){return!!(null==e?void 0:e.enableInvitePanel)},t.enableDesktopCta=function(e,t,o){if(!n(t,o))return!1;const i=a(o);return i===s.UPLOAD_FOLDERS.valueOf()||i===s.SUGGESTED_FOLDERS.valueOf()?t>1:i!==s.INVITE_MEMBER.valueOf()||(e>1||t>1)},t.enableDownloadAppPanel=l,t.enableCollectionsQuickActions=function(e){return!!(null==e?void 0:e.enableCollectionsQuickActions)},t.shouldFirstPathHaveDropTargetIcon=function(e){return void 0!==e&&-1!==[s.COLLECTIONS.valueOf(),s.SUGGESTED_FOLDERS_ITERATION.valueOf()].indexOf(e)}})),define("modules/clean/react/hooks/usePrevious",["require","exports","react"],(function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.usePrevious=void 0,t.usePrevious=function(e){const t=s.useRef();return s.useEffect(()=>{t.current=e},[e]),t.current}})),define("modules/clean/react/new_file_menu/new_file_icon",["require","exports","tslib","react","spectrum/icon_partners/index","modules/clean/static_urls"],(function(e,t,s,o,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NewFileIcon=void 0,o=s.__importDefault(o);const a={dropbox_form:r.static_url("/static/images/dropbox_form-vfl1f-v2W.svg")};t.NewFileIcon=({iconName:e,displayName:t})=>{const s=a[e];return s?o.default.createElement("img",{alt:t,src:s,width:"24px",height:"24px"}):o.default.createElement(i.IconPartners,{name:e,width:"24px",height:"24px"})},t.NewFileIcon.displayName="NewFileIcon"})),define("modules/clean/react/new_file_menu/new_file_menu",["require","exports","tslib","classnames","react","dig-components/buttons","dig-components/typography","dig-components/menu","modules/clean/cloud_docs/constants","modules/clean/cloud_docs/create_api","modules/clean/react/browse/action_logger","modules/clean/react/components/css","modules/clean/web_user_action_events","modules/constants/page_load","modules/clean/react/new_file_menu/new_file_icon","modules/clean/react/new_file_menu/new_file_util"],(function(e,t,s,o,i,r,a,n,l,c,d,u,_,p,m,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NewFileMenu=t.NewFileTypeRow=t.handleNewFileSelection=void 0,o=s.__importDefault(o),i=s.__importDefault(i),p=s.__importStar(p),t.handleNewFileSelection=e=>{e.handleClick()};class h extends i.default.Component{render(){return i.default.createElement(n.Menu.ActionItem,{key:this.props.item.displayName,value:this.props.item,className:this.props.item.className,withLeftAccessory:i.default.createElement(m.NewFileIcon,{displayName:this.props.item.displayName,iconName:this.props.item.iconName})},i.default.createElement(a.Text,null,this.props.item.displayName))}}t.NewFileTypeRow=h,h.displayName="NewFileTypeRow";class g extends i.default.Component{constructor(){super(...arguments),this.handleCreateNewFile=e=>()=>{const{selection_mode:t,empty_folder:s}=this.props,o=i=>{c.showAsyncFolderDialog({user:this.props.user,source:this.props.source,documentType:e,selection_mode:t,empty_folder:s,handleClickNewFolder:this.props.handleClickNewFolder?this.props.handleClickNewFolder(this.props.user,o):void 0,initialPath:i})};d.logFileCreateClick({uid:this.props.user.id,source:this.props.source,action:f.newFileTypeToLogEvent(e),depth_folder_selected:this.props.path?c.getDepthFromPath(this.props.path):void 0,selection_mode:t,empty_folder:s}),this.props.path?c.createNewFile({user:this.props.user,path:this.props.path,documentType:e,source:this.props.source,selection_mode:t,empty_folder:s}):o()},this.logTriggerClick=()=>{const{empty_folder:e,selection_mode:t,path:s,user:o,source:i}=this.props;d.logFileCreateClick({uid:o.id,source:i,action:_.WebUserActionLogEvent.FILE_CREATE_OPEN_MENU,depth_folder_selected:s?c.getDepthFromPath(s):void 0,selection_mode:t,empty_folder:e})}}getNewFileTypeSections(){const e=[],t=[];this.props.showPaper&&(t.push({displayName:f.NewPaperDocLabel,iconName:"dropbox_paper",className:"action-create-file-paper-doc",handleClick:this.handleCreateNewFile(l.PaperNewFileTypes.PAPER)}),t.push({displayName:f.NewPaperTemplateLabel,iconName:"dropbox_paper_template",className:"action-create-file-paper-template",handleClick:this.handleCreateNewFile(l.PaperNewFileTypes.PAPER_TEMPLATE)})),this.props.showBinder&&t.push({displayName:f.NewPaperBinderDocLabel,iconName:"dropbox_paper_binder",className:"action-create-file-paper-binder",handleClick:this.handleCreateNewFile(l.PaperNewFileTypes.PAPER_BINDER)}),t.push({displayName:f.NewSimplePointerLabel,iconName:"shortcut",className:"action-create-simple-pointer",handleClick:this.handleCreateNewFile(l.PointerFileTypes.SIMPLE_POINTER)}),t.length>0&&e.push(t);const s=[];if(s.push({displayName:f.NewMicrosoftWordDocLabel,iconName:"microsoft_docx",className:"action-create-file-word",handleClick:this.handleCreateNewFile(l.MicrosoftFileTypes.WORD)}),s.push({displayName:f.NewMicrosoftExcelWorkbookLabel,iconName:"microsoft_xlsx",className:"action-create-file-excel",handleClick:this.handleCreateNewFile(l.MicrosoftFileTypes.EXCEL)}),s.push({displayName:f.NewMicrosoftPowerPointPresentationLabel,iconName:"microsoft_pptx",className:"action-create-file-powerpoint",handleClick:this.handleCreateNewFile(l.MicrosoftFileTypes.POWERPOINT)}),e.push(s),this.props.showGdd){const t=[];t.push({displayName:f.NewGoogleDocsLabel,iconName:"google_gdoc",className:"action-create-file-google-doc",handleClick:this.handleCreateNewFile(l.GoogleFileTypes.GOOGLE_DSS_DOC)}),t.push({displayName:f.NewGoogleSheetsLabel,iconName:"google_gsheet",className:"action-create-file-google-sheet",handleClick:this.handleCreateNewFile(l.GoogleFileTypes.GOOGLE_DSS_SHEET)}),t.push({displayName:f.NewGoogleSlidesLabel,iconName:"google_gslides",className:"action-create-file-google-slides",handleClick:this.handleCreateNewFile(l.GoogleFileTypes.GOOGLE_DSS_SLIDES)}),e.push(t)}return e}renderTrigger(e){const t=0===p.USER_LOCALE.indexOf("en")||this.props.forceLongLabel?f.LongNewFileCreateLabel:f.ShortNewFileCreateLabel,s=Object.assign(Object.assign({},e),{disabled:this.props.disabled,className:o.default("primary-action-menu__button","action-create-file"),variant:this.props.enableSecondary?"opacity":"primary"});return i.default.createElement(r.Button,Object.assign({key:f.LongNewFileCreateLabel,withDropdownIcon:!0},s),t)}renderSection(e,t){return i.default.createElement(n.Menu.Segment,{key:t},e.map(e=>i.default.createElement(h,{item:e,key:e.displayName})))}render(){const e=this.getNewFileTypeSections();return i.default.createElement(n.Menu.Wrapper,{onToggle:this.logTriggerClick,onSelection:t.handleNewFileSelection},({getContentProps:t,getTriggerProps:s})=>i.default.createElement(i.default.Fragment,null,this.renderTrigger(s()),i.default.createElement(n.Menu.Content,Object.assign({},t()),e.map(this.renderSection))))}}g.defaultProps={},g.displayName="NewFileMenu";const S=u.requireCssWithComponent(g,["/static/css/dig-components/index.web-vflm67Rix.css","/static/css/cloud_docs/create_pointer_modal-vflATc8Dt.css"]);t.NewFileMenu=S})),define("modules/clean/react/new_file_menu/new_file_util",["require","exports","modules/clean/cloud_docs/constants","modules/clean/web_user_action_events","modules/core/i18n"],(function(e,t,s,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.newFileTypeToLogEvent=t.NewSimplePointerLabel=t.NewPaperBinderDocLabel=t.NewPaperTemplateLabel=t.NewPaperDocLabel=t.NewMicrosoftWordDocLabel=t.NewMicrosoftPowerPointPresentationLabel=t.NewMicrosoftExcelWorkbookLabel=t.NewGoogleSlidesLabel=t.NewGoogleSheetsLabel=t.NewGoogleDocsLabel=t.ShortNewFileCreateLabel=t.LongNewFileCreateLabel=void 0,t.LongNewFileCreateLabel=i.intl.formatMessage({id:"8/w9ir",defaultMessage:"Create new file"}),t.ShortNewFileCreateLabel=i.intl.formatMessage({id:"o96TiK",defaultMessage:"Create"}),t.NewGoogleDocsLabel=i.intl.formatMessage({id:"+HsOFj",defaultMessage:"Google Docs"}),t.NewGoogleSheetsLabel=i.intl.formatMessage({id:"cpuRML",defaultMessage:"Google Sheets"}),t.NewGoogleSlidesLabel=i.intl.formatMessage({id:"PcJCVL",defaultMessage:"Google Slides"}),t.NewMicrosoftExcelWorkbookLabel=i.intl.formatMessage({id:"0rYKaW",defaultMessage:"Excel Workbook"}),t.NewMicrosoftPowerPointPresentationLabel=i.intl.formatMessage({id:"e9uLbL",defaultMessage:"PowerPoint Presentation"}),t.NewMicrosoftWordDocLabel=i.intl.formatMessage({id:"yY5byF",defaultMessage:"Word Document"}),t.NewPaperDocLabel=i.intl.formatMessage({id:"neBk7u",defaultMessage:"Dropbox Paper"}),t.NewPaperTemplateLabel=i.intl.formatMessage({id:"Rvv7NR",defaultMessage:"Dropbox Paper Template"}),t.NewPaperBinderDocLabel=i.intl.formatMessage({id:"sbO30Y",defaultMessage:"Dropbox Binder (Beta)"}),t.NewSimplePointerLabel=i.intl.formatMessage({id:"4gEt6j",defaultMessage:"Shortcut"}),t.newFileTypeToLogEvent=e=>{switch(e){case s.MicrosoftFileTypes.WORD:return o.WebUserActionLogEvent.FILE_CREATE_WORD;case s.MicrosoftFileTypes.EXCEL:return o.WebUserActionLogEvent.FILE_CREATE_EXCEL;case s.MicrosoftFileTypes.POWERPOINT:return o.WebUserActionLogEvent.FILE_CREATE_POWERPOINT;case s.GoogleFileTypes.GOOGLE_DSS_DOC:return o.WebUserActionLogEvent.FILE_CREATE_GOOGLE_DOC;case s.GoogleFileTypes.GOOGLE_DSS_SHEET:return o.WebUserActionLogEvent.FILE_CREATE_GOOGLE_SHEET;case s.GoogleFileTypes.GOOGLE_DSS_SLIDES:return o.WebUserActionLogEvent.FILE_CREATE_GOOGLE_SLIDES;case s.PaperNewFileTypes.PAPER:return o.WebUserActionLogEvent.FILE_CREATE_PAPER;case s.PaperNewFileTypes.PAPER_TEMPLATE:return o.WebUserActionLogEvent.FILE_CREATE_PAPER_TEMPLATE;case s.PaperNewFileTypes.PAPER_BINDER:return o.WebUserActionLogEvent.FILE_CREATE_BINDER;case s.PointerFileTypes.SIMPLE_POINTER:return o.WebUserActionLogEvent.FILE_CREATE_SIMPLE_POINTER}}})),define("modules/clean/react/path_breadcrumbs",["require","exports","tslib","classnames","react","dig-components/buttons","dig-components/icons","dig-components/icons/src","dig-components/menu","dig-components/typography","spectrum/icon_content/index","modules/clean/em_string","modules/clean/filepath/filepath","modules/clean/react/icon/icon_helper","modules/clean/react/title_bubble","modules/clean/user_education/react/user_education_effect","modules/clean/web_timing_logger","modules/core/i18n","modules/clean/react/sticky_position","modules/clean/react/flows/components/badge_async","modules/clean/pnm/utils"],(function(e,t,s,o,i,r,a,n,l,c,d,u,_,p,m,f,h,g,S,E,T){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BreadcrumbMenuItem=t.BreadcrumbSegment=t.PathBreadcrumbs=t.PathBreadcrumbsSize=t.generateBreadcrumbData=void 0,o=s.__importDefault(o),i=s.__importDefault(i),n=s.__importStar(n),_=s.__importStar(_);function b(e,t,s=20){return s-(t?2.625:new u.Emstring(e).length)}function w(e,t,s,o,i=20,r){const a=null!=r?r:"",n=e.substring(a.length).split("/").filter(Boolean),l=[{path:a,icon:"folder_dropbox-small",folderName:t,alt:s}],c=p.spectrumFolderIcon({size:p.SpectrumIconSize.Small});for(let t=0;t<n.length;t++)e=`${a}/${n.slice(0,t+1).join("/")}`,l.push({path:e,folderName:T.getDisplayedFilename(_.filename(e)),icon:c,alt:g.intl.formatMessage({id:"MLqiSW",defaultMessage:"Folder"})});if(l.length<3)return{dropdownCrumbs:[],inlineCrumbs:l,root:l[0]};const d=b(l[0]&&l[0].folderName||"",!1,i),m=l.map(e=>new u.Emstring(e.folderName||"").length);let f=1,h=m[l.length-1];for(let e=l.length-2;e>=1&&(h+=1.64,h+=m[e],!(h>d));e--)f+=1;l.length===f+1&&(f+=1),1===f&&o===I.SMALL&&f++;const S=l.length-f;return{dropdownCrumbs:l.slice(0,S),inlineCrumbs:l.slice(S),root:l[0]}}var I;t.generateBreadcrumbData=w,(function(e){e.LARGE="LARGE",e.SMALL="SMALL"})(I=t.PathBreadcrumbsSize||(t.PathBreadcrumbsSize={}));class v extends i.default.PureComponent{constructor(e){super(e),this._breadcrumbContainerElement=null,this._flowsBadgeElement=null,this.resizeListener=()=>{const e=this.getBreadcrumbsContainerSpan();if(e){let t=e.getBoundingClientRect().width;if(this.props.mobileWebInvites&&(t-=20),this.props.flowsFolderRule){const e=this.getFlowsBadgeSpan(),s=16;t-=e?e.getBoundingClientRect().width+s:0}const s=Math.max(0,this.getMaxWidthInEm(t));s!==this.state.maxWidthInEm&&s>0&&this.setState({maxWidthInEm:s})}},this.handleTitleClick=e=>t=>{const s=e.path;if(0===t.button){if(t.altKey||t.ctrlKey||t.metaKey||t.shiftKey)return void t.stopPropagation();t.preventDefault(),t.stopPropagation(),this.props.setUrl({path:s})}};const t=this.getBreadcrumbsContainerSpan();this.state={maxWidthInEm:t?this.getMaxWidthInEm(t.getBoundingClientRect().width):20}}getBreadcrumbsContainerSpan(){if(!this._breadcrumbContainerElement){const e=document.getElementsByClassName("maestro-app-content");e&&1===e.length&&(this._breadcrumbContainerElement=e[0])}return this._breadcrumbContainerElement}getFlowsBadgeSpan(){const e=document.querySelector(".flows-badge");return!this._flowsBadgeElement&&e&&(this._flowsBadgeElement=e),this._flowsBadgeElement}getMaxWidthInEm(e){return(e-100)/22}componentDidMount(){window.addEventListener("resize",this.resizeListener),h.waitForTTI().then(()=>this.resizeListener())}componentWillUnmount(){window.removeEventListener("resize",this.resizeListener)}componentDidUpdate(e){e.mobileWebInvites!==this.props.mobileWebInvites&&this.resizeListener()}render(){const e=this.props.path,{firstBreadcrumbName:t,firstBreadcrumbAlt:s,firstBreadcrumbPath:r,shouldHighlightDropTargets:a,setFileUploaderPath:n,getUrlForPath:l,setUrl:d,size:u,enableDragging:p,flowsFolderRule:m,expFlowsAutomatedFolderUI:h}=this.props,S=this.state.maxWidthInEm?this.state.maxWidthInEm:20,{dropdownCrumbs:T,inlineCrumbs:v,root:C}=w(e,t,s,u,S,r),R=b(C&&C.folderName||"",T.length>0,S),A=o.default({"brws-path-breadcrumbs":!0,"brws-path-breadcrumbs--small":this.props.size===I.SMALL});if(v.length>1||T.length>0)return i.default.createElement("span",{className:A},i.default.createElement("h1",{className:"ax-visually-hidden"},_.filename(e)),i.default.createElement("nav",{className:"page-header-text u-l-fl",id:"path-breadcrumbs","aria-label":g.intl.formatMessage({id:"SzftTr",defaultMessage:"Folder hierarchy"}),role:"navigation"},T.length>0&&i.default.createElement(F,{crumbs:T,currentPath:e,shouldHighlightDropTargets:a,setFileUploaderPath:n,setUrl:d,enableDragging:!!p,onTitleClick:this.handleTitleClick,getUrlForPath:l}),v.map((t,s)=>i.default.createElement(O,Object.assign({},t,{key:encodeURI(t.path),isOnlyCrumb:0===s&&1===v.length&&0===T.length,index:s,isLastCrumb:s===v.length-1,maxWidth:R,currentPath:e,shouldHighlightDropTargets:a,setFileUploaderPath:n,getUrlForPath:l,setUrl:d,size:u,enableDragging:!!p,onTitleClick:this.handleTitleClick(t)})))),!!m&&i.default.createElement(E.AsyncBadgeComponent,{type:m,isInUnifiedModal:!!h,isFolderFocused:!0}));{const e=u===I.SMALL?c.Text:c.Title,s=u===I.SMALL?"small":"standard";return i.default.createElement(f.UserEducationEffect,{containerName:"PathBreadcrumbs",name:"HomeTitle",useSpan:!0},i.default.createElement(e,{size:s,className:"page-header-text"},t))}}}t.PathBreadcrumbs=v,v.defaultProps={path:"/",shouldHighlightDropTargets:!1,setFileUploaderPath:()=>{},size:I.LARGE,enableDragging:!1},v.displayName="PathBreadcrumbs";class O extends i.default.Component{constructor(e){super(e),this.handleDragEnter=e=>{e.preventDefault(),e.target!==this.lastEnteredElement&&this.props.enableDragging&&(this.lastEnteredElement=e.target,this.dragEnterCount+=1,this.setState({isDraggedOver:!0}),this.props.isLastCrumb||this.props.setFileUploaderPath({path:this.props.path,targetSurface:"breadcrumb"}))},this.handleDragLeave=e=>{e.preventDefault(),this.props.enableDragging&&(this.lastEnteredElement=null,this.dragEnterCount-=1,this.dragEnterCount<1&&(this.dragEnterCount=0,this.state.isDraggedOver&&(this.props.setFileUploaderPath({path:this.props.currentPath}),this.setState({isDraggedOver:!1}))))},this.handleDrop=()=>{this.setState({isDraggedOver:!1})},this.handleDragOver=e=>{e.preventDefault(),e.stopPropagation()},this.handleMouseEnter=()=>{this.props.enableDragging||this.setState({isDraggedOver:!0})},this.handleMouseLeave=()=>{this.state.isDraggedOver&&this.setState({isDraggedOver:!1})},this.handleMouseUp=()=>{this.state.isDraggedOver&&this.setState({isDraggedOver:!1})},this.eventHandlers={onDragEnter:this.handleDragEnter,onDragLeave:this.handleDragLeave,onDrop:this.handleDrop,onDragOver:this.handleDragOver,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,onMouseUp:this.handleMouseUp},this.state={isDraggedOver:!1}}componentDidMount(){this.dragEnterCount=0,this.lastEnteredElement=null}render(){const{getUrlForPath:e,path:t,index:s,isOnlyCrumb:r,maxWidth:l,isLastCrumb:d,shouldHighlightDropTargets:_,size:p}=this.props,h=r?this.props.folderName:u.Emstring.em_snippet(this.props.folderName,l),g={"breadcrumb-segment":!0,"breadcrumb-text-dragged-over":!d&&_&&this.state.isDraggedOver},E=p===I.SMALL?c.Text:c.Title,T=p===I.SMALL?"small":"standard";let b;return b=d?i.default.createElement(E,Object.assign({size:T,"aria-current":"page"},this.eventHandlers,{"data-testid":"breadcrumb-segment"}),h):i.default.createElement("span",Object.assign({className:"breadcrumb-segment__wrapper"},this.eventHandlers),i.default.createElement(f.UserEducationEffect,{containerName:"BreadcrumbSegment",name:`link-${s}`,useSpan:!0},i.default.createElement(E,{size:T,color:"faint"},i.default.createElement("a",{href:e(t).toString(),onClick:this.props.onTitleClick,className:o.default(g),"data-testid":"breadcrumb-segment"},h),i.default.createElement(a.UIIcon,{src:n.ChevronRightLine,size:"small",className:"breadcrumb__spacer"})))),this.props.folderName!==h?i.default.createElement(m.TitleBubble,{content:this.props.folderName,position:S.StickyPosition.BOTTOM,className:"list-label__title-bubble"},b):b}}t.BreadcrumbSegment=O,O.defaultProps={isOnlyCrumb:!1,shouldHighlightDropTargets:!1,disableDragging:!1},O.displayName="BreadcrumbSegment";class C extends i.default.Component{constructor(e){super(e),this.handleDragEnter=e=>{e.preventDefault(),e.target!==this.lastEnteredElement&&this.props.enableDragging&&(this.lastEnteredElement=e.target,this.dragEnterCount+=1,this.setState({isDraggedOver:!0}),this.props.setFileUploaderPath({path:this.props.path,targetSurface:"breadcrumb"}))},this.handleDragLeave=e=>{e.preventDefault(),this.props.enableDragging&&(this.lastEnteredElement=null,this.dragEnterCount-=1,this.dragEnterCount<1&&(this.dragEnterCount=0,this.state.isDraggedOver&&(this.props.setFileUploaderPath({path:this.props.currentPath}),this.setState({isDraggedOver:!1}))))},this.handleDrop=e=>{this.setState({isDraggedOver:!1}),this.dragEnterCount=0,this.props.onClose()},this.handleDragOver=e=>{e.preventDefault(),e.stopPropagation()},this.handleMouseEnter=()=>{this.props.enableDragging&&this.setState({isDraggedOver:!0})},this.handleMouseLeave=()=>{this.state.isDraggedOver&&(this.setState({isDraggedOver:!1}),this.props.onClose())},this.handleMouseUp=()=>{this.state.isDraggedOver&&this.setState({isDraggedOver:!1}),this.props.enableDragging&&!this.props.isLastCrumb&&this.props.onClose()},this.state={isDraggedOver:!1}}componentDidMount(){this.dragEnterCount=0,this.lastEnteredElement=null}render(){const{icon:e,alt:t,folderName:s}=this.props,r={"breadcrumb-text-dragged-over":this.state.isDraggedOver};return i.default.createElement(l.Menu.LinkItem,{href:this.props.href,onClick:this.props.onCrumbClick,className:o.default(r),withLeftAccessory:i.default.createElement(d.IconContent,{name:e,"aria-label":t,role:"img",className:"breadcrumb-menu-item-icon"}),onDragEnter:this.handleDragEnter,onDragLeave:this.handleDragLeave,onDrop:this.handleDrop,onDragOver:this.handleDragOver,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,onMouseUp:this.handleMouseUp},u.Emstring.em_snippet(s,20))}}t.BreadcrumbMenuItem=C,C.defaultProps={isHighlightedDropTarget:!1,onClose(){},alt:"",disableDragging:!1},C.displayName="BreadcrumbMenuItem";class F extends i.default.Component{constructor(){super(...arguments),this.state={menuVisible:!1},this.handleDragOver=e=>t=>{this.props.enableDragging&&(t.preventDefault(),e({autoFocus:!1}),this.setState({menuVisible:!0}))},this.handleInnerDragEnter=e=>{e.preventDefault(),this.dragEnterCount++},this.handleDragLeave=e=>t=>{t.preventDefault(),this.dragEnterCount--,this.dragEnterCount<1&&(this.dragEnterCount=0,this.state.menuVisible&&(this.setState({menuVisible:!1}),e({autoFocus:!1})))},this.handleMouseEnter=e=>t=>{this.props.enableDragging&&(t.preventDefault(),this.setState({menuVisible:!0}),e({autoFocus:!1}))},this.handleCrumbSelected=e=>{this.props.setUrl({path:e})},this.handlePopoverToggle=({isOpen:e})=>{this.setState({menuVisible:e})},this.handleClose=()=>{this.dragEnterCount=0,this.handlePopoverToggle({isOpen:!1})}}componentDidMount(){this.dragEnterCount=0}render(){const e=[...this.props.crumbs].reverse(),{currentPath:t,shouldHighlightDropTargets:s,setFileUploaderPath:o,enableDragging:u,onTitleClick:_}=this.props,p=g.intl.formatMessage({id:"JY5LSc",defaultMessage:"Show parent folders (descending)"});return i.default.createElement(i.default.Fragment,null,i.default.createElement(l.Menu.Wrapper,{onSelection:this.handleCrumbSelected,shouldPropagateClickOutsideMouseEvents:!0,className:"breadcrumb-menu-wrapper"},({getContentProps:a,getTriggerProps:n,openMenu:c,closeMenu:m})=>i.default.createElement(i.default.Fragment,null,i.default.createElement(r.IconButton,Object.assign({variant:"transparent",onDragOver:this.handleDragOver(c),onMouseEnter:this.handleMouseEnter(c)},n()),i.default.createElement(d.IconContent,{name:"folder_dropdown-small","aria-label":p,role:"img",className:"breadcrumb-menu-icon"})),i.default.createElement(l.Menu.Content,Object.assign({},a(),{onDragEnter:this.handleInnerDragEnter,onDragLeave:this.handleDragLeave(m)}),i.default.createElement(l.Menu.Segment,null,e.map(e=>i.default.createElement(C,{key:encodeURI(e.path),path:e.path,icon:e.icon,alt:e.alt,folderName:e.folderName,currentPath:t,isHighlightedDropTarget:s,setFileUploaderPath:o,onClose:this.handleClose,enableDragging:u,onCrumbClick:_(e),href:this.props.getUrlForPath(e.path).toString()})))))),i.default.createElement(c.Text,{color:"faint",className:"breadcrumb-menu-icon-parent"},i.default.createElement(a.UIIcon,{src:n.ChevronRightLine,className:"breadcrumb__spacer",size:"small"})))}}F.defaultProps={shouldHighlightDropTargets:!1},F.displayName="BreadcrumbMenu"})),define("modules/clean/react/share_download/api",["require","exports","tslib","modules/clean/deprecated_ajax/ajax_as_promised_jquery"],(function(e,t,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fetchDownloadUrl=t.testDownload=t.TooLargeError=t.DownloadError=void 0,o=s.__importStar(o);class i extends class{constructor(e){this.message=e}}{}t.DownloadError=i;class r extends i{}t.TooLargeError=r,t.testDownload=function(e,t){return s.__awaiter(this,void 0,void 0,(function*(){let s;try{s=yield o.SilentBackgroundRequest({url:e,data:{rlkey:t}})}catch(e){throw new i}if("OK"!==s)throw 0===s.indexOf("err:")?new r:new i}))},t.fetchDownloadUrl=function(e,t,s){return o.SilentBackgroundRequest({url:"/sharing/fetch_user_content_link",data:{url:e,rlkey:t,origin:s}})}})),define("modules/clean/redux/tests/store",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mockExtraArguments=void 0,t.mockExtraArguments=()=>({})})),define("modules/clean/react/upload_kit/lib/processors",["require","exports","tslib","modules/clean/react/upload_kit/lib/types","modules/clean/react/upload_kit/utils/makers","modules/clean/react/upload_kit/utils/path","modules/clean/react/upload_kit/utils/file","modules/clean/filepath/filepath","modules/core/uri"],(function(e,t,s,o,i,r,a,n,l){"use strict";function c(e){return s.__awaiter(this,void 0,void 0,(function*(){return e.map(([e,t])=>i.makeFileUploadItem(e,o.isWebkitFile(e)&&""!==e.webkitRelativePath?e.webkitRelativePath:e.name,t))}))}function d(e,t,s){return Promise.resolve([i.makeFileUploadItem(e,t,s)])}function u(e,t){return s.__awaiter(this,void 0,void 0,(function*(){const o=yield Promise.all(e.map(e=>s.__awaiter(this,void 0,void 0,(function*(){if(null==e?void 0:e.isFile){const s=yield a.getFile(e);return[i.makeFileUploadItem(s,r.getDestPath(e),t)]}if(null==e?void 0:e.isDirectory){const s=e;return u(yield _(s),t)}return null})))),n=[];return o.forEach(e=>{e&&n.push(...e)}),n}))}function _(e){return s.__awaiter(this,void 0,void 0,(function*(){return(function e(t){return s.__awaiter(this,void 0,void 0,(function*(){return new Promise((o,i)=>t.readEntries(i=>s.__awaiter(this,void 0,void 0,(function*(){i.length>0?o([...i,...yield e(t)]):o(i)})),e=>i(e)))}))})(e.createReader())}))}function p(e){const t={};return e.map(e=>n.parent_dir(e.destPath)).forEach(e=>{""!==e&&"/"!==e&&(t[e]=e)}),Object.keys(t).map(e=>i.makeDirectoryUploadItem(e))}function m(e){const t={};return e.forEach(e=>{n.parent_dirs(e.destPath).forEach(e=>{""!==e&&"/"!==e&&(t[e]=e)})}),Object.keys(t).map(e=>i.makeDirectoryUploadItem(e))}Object.defineProperty(t,"__esModule",{value:!0}),t.processFilesWithRenamingRecursive=t.processFilesWithRenaming=t.resolveDuplicates=t.collectDirectoriesRecursive=t.collectDirectories=t.readDirectory=t.preprocessFileSystemEntries=t.preprocessDataTransfer=t.preprocessDropboxFiles=t.preprocessBlob=t.preprocessFiles=void 0,t.preprocessFiles=c,t.preprocessBlob=d,t.preprocessDropboxFiles=function(e){return s.__awaiter(this,void 0,void 0,(function*(){return e.map(([e,t])=>i.makeChooserUploadItem(e,t))}))},t.preprocessDataTransfer=function(e,t){return s.__awaiter(this,void 0,void 0,(function*(){const{files:s,items:o,types:i}=e;if(i&&i.length>0&&-1===i.indexOf("Files")){const s=a.getDataTransferUrl(e),o=l.URI.parse(s).getAuthority();return d(a.makeLinkBlob(s),`#${o}.url`,t)}if(o&&o.length>0&&o[0]&&o[0].webkitGetAsEntry)return u(Array.from(o).map(e=>e.webkitGetAsEntry()),t);if(s&&s.length>0){return c(Array.from(s).map(e=>[e,t||{}]))}return Promise.resolve([])}))},t.preprocessFileSystemEntries=u,t.readDirectory=_,t.collectDirectories=p,t.collectDirectoriesRecursive=m,t.resolveDuplicates=(e,t=[])=>{const s=new Set,o=new Set,i=[];return t&&t.forEach(e=>{o.add(e.id),s.add(r.getNameAtRoot(e.destPath).toLowerCase())}),e.forEach(e=>{if(o.has(e.id))return;const t=-1!==e.destPath.indexOf("/");let a,l=1,c=r.getNameAtRoot(e.destPath);const d=n.split_filename(c);if(s.has(c.toLowerCase()))do{a=`${d.name} (${l})`,c=d.ext?`${a}.${d.ext}`:a,l++}while(s.has(c.toLowerCase()));if(t){const t=e.destPath.split("/");t[0]=c,e.destPath=t.join("/")}else e.destPath=c;o.add(e.id),s.add(e.destPath.toLowerCase()),i.push(e)}),i},t.processFilesWithRenaming=(e,s,o)=>Promise.resolve(t.resolveDuplicates(e,o)).then(e=>({errors:s,items:e.concat(p(e))})),t.processFilesWithRenamingRecursive=(e,s,o)=>Promise.resolve(t.resolveDuplicates(e,o)).then(e=>({errors:s,items:e.concat(m(e))}))})),define("modules/clean/react/upload_kit/lib/types",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UploadErrorType=t.UploadStatus=t.FileSource=t.isChooserFile=t.isWebkitFile=void 0,t.isWebkitFile=e=>"webkitRelativePath"in e,t.isChooserFile=e=>"bytes"in e,(function(e){e.Dropbox="dropbox",e.Computer="computer",e.Server="server"})(t.FileSource||(t.FileSource={})),(function(e){e.Staged="staged",e.Queued="queued",e.Uploading="uploading",e.Success="success",e.Error="error",e.Cancelling="cancelling"})(t.UploadStatus||(t.UploadStatus={})),(function(e){e.CloudDoc="cloud_doc",e.EmptyFile="empty_file",e.IgnoredFile="ignored_file",e.OverMaxFileSize="over_max_file_size",e.PointerFile="pointer_file",e.TemporaryFile="temporary_file",e.InvalidChar="invalid_char",e.NotFound="not_found",e.NoPermission="no_permission",e.Restricted="restricted",e.InvalidArgs="invalid_args",e.Unknown="unknown"})(t.UploadErrorType||(t.UploadErrorType={}))})),define("modules/clean/react/upload_kit/lib/upload_block",["require","exports","modules/clean/csrf","modules/core/uri"],(function(e,t,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.uploadBlock=void 0,t.uploadBlock=(e,t,i,r)=>{const a=new o.URI({scheme:"https",authority:"dl-web.dropbox.com",path:"/put_block_returning_token",query:{owner_id:e.toString(),_subject_uid:e.toString(),t:s.readCsrfToken()||"",reported_block_size:r.size.toString(),num_blocks:Math.ceil(i/r.size).toString(),ns_id_for_routing:t.toString()}});return new Promise((e,t)=>{const s=new XMLHttpRequest;return s.withCredentials=!0,s.onreadystatechange=()=>{if(s.readyState===XMLHttpRequest.DONE)if(200===s.status){const o=JSON.parse(s.responseText);o.token?e(o.token):t("Server token empty or undefined error.")}else t(`Server error ${s.status}`)},s.open("POST",a.toString(),!0),s.setRequestHeader("Content-Type","application/octet-stream"),s.send(r),s})}})),define("modules/clean/react/upload_kit/uploader/async_controller",["require","exports","tslib"],(function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AsyncUploadController=void 0;t.AsyncUploadController=class{constructor(e){var{onLoaded:t}=e,o=s.__rest(e,["onLoaded"]);this.onLoaded=t,this.controllerProps=o}get(){return this.promise||(this.promise=new Promise(t=>s.__awaiter(this,void 0,void 0,(function*(){const{UploadController:o}=yield new Promise((t,s)=>{e(["modules/clean/react/upload_kit/uploader/controller"],t,s)}).then(s.__importStar),i=new o(this.controllerProps);this.onLoaded(i),t(i)})))),this.promise}}})),define("modules/clean/react/upload_kit/uploader/context",["require","exports","tslib","react","modules/clean/react/components/helpers","modules/clean/react/upload_kit/uploader/async_controller","modules/clean/react/upload_kit/lib/processors"],(function(e,t,s,o,i,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.withUploadConsumer=t.UploadConsumer=t.withCustomUploadProvider=t.UploadProvider=void 0;const n=(o=s.__importDefault(o)).default.createContext({});let l=0;class c extends o.default.PureComponent{constructor(e){super(e),this.fileField=o.default.createRef(),this.folderField=o.default.createRef(),this.chooseHandled=new Set,this.state={uploadItems:[],isUploading:!1},this.setInitialUploadedItems=(...e)=>s.__awaiter(this,void 0,void 0,(function*(){return(yield this.asyncController.get()).setInitialUploadedItems(...e)})),this.cancelUploadItem=(...e)=>s.__awaiter(this,void 0,void 0,(function*(){return(yield this.asyncController.get()).cancelUploadItem(...e)})),this.chooseFiles=()=>s.__awaiter(this,void 0,void 0,(function*(){const e=this.fileField?this.fileField.current:null;return this.chooseLocalFiles(e)})),this.chooseFolder=()=>s.__awaiter(this,void 0,void 0,(function*(){const e=this.folderField?this.folderField.current:null;return this.chooseLocalFiles(e)})),this.chooseLocalFiles=(function(e,t=100){let s;return(...o)=>(s||(s=e(...o),setTimeout(()=>{s=void 0},t)),s)})((e=null)=>(this.asyncController.get(),new Promise((t,o)=>{if(!e)return void o();e.dataset.uploadKitId||(e.dataset.uploadKitId=String(l++));const i=e.dataset.uploadKitId,r=()=>s.__awaiter(this,void 0,void 0,(function*(){if(this.chooseHandled.delete(i),e.removeEventListener("change",r),e.files)try{const s=yield this.asyncController.get(),o=yield s.addFiles(Array.from(e.files));t(o)}catch(e){o(e)}else o()}));this.chooseHandled.has(i)||(this.chooseHandled.add(i),e.addEventListener("change",r)),e.value="",e.click()}))),this.chooseDropboxFiles=(...e)=>s.__awaiter(this,void 0,void 0,(function*(){return(yield this.asyncController.get()).chooseDropboxFiles(...e)})),this.handleDrop=(e,t)=>s.__awaiter(this,void 0,void 0,(function*(){if(!e)return Promise.reject();const[s,o]=yield Promise.all([a.preprocessDataTransfer(e,{parentPath:t}),this.asyncController.get()]);return o.addUploadItems(s)})),this.makeDirectory=(...e)=>s.__awaiter(this,void 0,void 0,(function*(){return(yield this.asyncController.get()).makeDirectory(...e)})),this.moveUploadItem=(...e)=>s.__awaiter(this,void 0,void 0,(function*(){return(yield this.asyncController.get()).moveUploadItem(...e)})),this.removeUploadItem=(...e)=>s.__awaiter(this,void 0,void 0,(function*(){return(yield this.asyncController.get()).removeUploadItem(...e)})),this.renameUploadItem=(...e)=>s.__awaiter(this,void 0,void 0,(function*(){return(yield this.asyncController.get()).renameUploadItem(...e)})),this.startUploading=(...e)=>s.__awaiter(this,void 0,void 0,(function*(){return(yield this.asyncController.get()).startUploading(...e)})),this.stopUploading=(...e)=>s.__awaiter(this,void 0,void 0,(function*(){return(yield this.asyncController.get()).stopUploading(...e)})),this.asyncController=new r.AsyncUploadController(Object.assign(Object.assign({},e),{onLoaded:e=>{this.subscription=e=>{this.setState(e)},e.subscribe(this.subscription)}}))}componentWillUnmount(){return s.__awaiter(this,void 0,void 0,(function*(){if(this.subscription){(yield this.asyncController.get()).unsubscribe(this.subscription)}}))}render(){const{children:e,fileExtensions:t,selectMultiple:s}=this.props,i=Object.assign(Object.assign({},this.state),{setInitialUploadedItems:this.setInitialUploadedItems,cancelUploadItem:this.cancelUploadItem,chooseFiles:this.chooseFiles,chooseFolder:this.chooseFolder,chooseDropboxFiles:this.chooseDropboxFiles,handleDrop:this.handleDrop,makeDirectory:this.makeDirectory,moveUploadItem:this.moveUploadItem,removeUploadItem:this.removeUploadItem,renameUploadItem:this.renameUploadItem,startUploading:this.startUploading,stopUploading:this.stopUploading});return o.default.createElement(n.Provider,{value:i},e,o.default.createElement("input",{type:"file",ref:this.fileField,id:"uploader-file-field",style:{display:"none"},multiple:!!s,accept:t?t.join(","):void 0}),o.default.createElement("input",Object.assign({type:"file",ref:this.folderField,id:"uploader-folder-field",style:{display:"none"}},{webkitdirectory:""})))}}t.UploadProvider=c,c.displayName="UploadProvider",t.withCustomUploadProvider=function(e,t){const s=s=>o.default.createElement(t,Object.assign({},s),o.default.createElement(e,Object.assign({},s)));return s.displayName=`withCustomUploadProvider(${i.getDisplayName(e)}, ${i.getDisplayName(t)})`,s},t.UploadConsumer=n.Consumer,t.withUploadConsumer=function(e){const s=s=>o.default.createElement(t.UploadConsumer,null,t=>o.default.createElement(e,Object.assign({},s,t)));return s.displayName=`WithUploadConsumer(${i.getDisplayName(e)})`,s}})),define("modules/clean/react/upload_kit/utils/file",["require","exports","tslib","modules/clean/react/upload_kit/lib/types"],(function(e,t,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeLinkBlob=t.getDataTransferUrl=t.getSize=t.getFile=void 0,t.getFile=e=>s.__awaiter(void 0,void 0,void 0,(function*(){return new Promise(t=>e.file(e=>t(e)))})),t.getSize=e=>e?o.isChooserFile(e)?e.bytes:e.size:0,t.getDataTransferUrl=function(e){let t;return t=e.getData("Url")||e.getData("text/x-moz-url")||e.getData("text/uri-list")||"",t=t.split("\n")[0],t},t.makeLinkBlob=function(e){return new Blob([`[InternetShortcut]\r\nURL=${e}\r\n`],{type:"text/plain"})}})),define("modules/clean/react/upload_kit/utils/makers",["require","exports","modules/clean/react/upload_kit/lib/types","modules/clean/uuid/uuid"],(function(e,t,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeChooserUploadItem=t.makeDirectoryUploadItem=t.makeFileUploadItem=void 0,t.makeFileUploadItem=function(e,t,i){return Object.assign(Object.assign({},i),{bytes:e.size,bytesUploaded:0,destPath:t,file:e,id:o.UUID.v4(),isDir:!1,source:s.FileSource.Computer,status:s.UploadStatus.Staged})},t.makeDirectoryUploadItem=function(e){return{bytes:0,bytesUploaded:0,destPath:e,id:o.UUID.v4(),isDir:!0,source:s.FileSource.Computer,status:s.UploadStatus.Staged}},t.makeChooserUploadItem=function(e,t){return Object.assign(Object.assign({},t),{bytes:e.bytes,bytesUploaded:0,destPath:e.name,file:e,id:e.id,isDir:e.isDir,source:s.FileSource.Dropbox,status:s.UploadStatus.Staged})}})),define("modules/clean/react/upload_kit/utils/path",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getNameAtRoot=t.getRootDir=t.getDestPath=t.reparentFilename=t.renameFilename=void 0,t.renameFilename=function(e,t){const s=e.split("/");return s[s.length-1]=t,s.join("/")},t.reparentFilename=function(e,t){return`${t}/${e.split("/").pop()}`},t.getDestPath=e=>e.fullPath?e.fullPath.startsWith("/")?e.fullPath.substring(1):e.fullPath:e.name,t.getRootDir=e=>-1===e.indexOf("/")?"/":e.split("/")[0],t.getNameAtRoot=e=>e.split("/")[0]})),define("modules/clean/search/api",["require","exports","tslib","modules/clean/analytics","api_v2/user_client","modules/clean/react/browse/models","modules/clean/search/api_helpers","modules/clean/search/constants","modules/clean/search/search_helpers","modules/clean/search/types","api_v2/error"],(function(e,t,s,o,i,r,a,n,l,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.searchApiClient=t.SearchApiClient=void 0,n=s.__importStar(n),l=s.__importStar(l);class u{constructor(){this._activeRequest=null}abortPreviousLoading(){null!=this._activeRequest&&this._activeRequest.abort()}loadResults({user:e,path:t,query:s,start:o,maxResults:i,searchSessionId:r,nsId:n,fileNameOnly:c,loadDeleted:d,showPaperResults:u,isDropdown:_,isAdminConsole:p,webTimer:m,onSuccess:f,onError:h}){const g=a.getCurrentTimezoneOffset(),S={query:s,search_token:l.getSearchCsrfToken(),fq_path:t,ns_id:n,filename_only:!!c,max_results:i,deleted:!!d,start:o,show_paper_results:!!u,is_dropdown:!!_,is_admin_console:!!p,show_unmounted_results:!0,timezone_offset:g,include_browse_context:!0,include_shared_docs:!0,include_snippets:!0};this._fetchResults({requestData:S,nextOffset:o,user:e,searchSessionId:r,onSuccess:f,onError:h,webTimer:m})}_getSearchType(e){return e.is_image_content_search?"image_search":e.is_dropdown?"dropdown":e.deleted?"full_page_deleted":"full_page"}loadPartialResults(e){const t=this._prepareSearchApiRequestData(e);(()=>{this._fetchResults({requestData:t,nextOffset:e.start,user:e.user,searchSessionId:e.searchSessionId,onSuccess:e.onSuccess,onError:e.onError,webTimer:e.webTimer,skipLogging:e.skipLogging})})()}_fetchResults({requestData:e,nextOffset:t,user:s,searchSessionId:n,onSuccess:c,onError:u,webTimer:_,skipLogging:m}){if(null!=this._activeRequest&&this._activeRequest.abort(),this._activeRequestController&&(this._activeRequestController.abort(),this._activeRequestController=null),p(e))return;const f=l.fileCategoryStringToLogValue(e.file_categories),h={path_scoped:"/"!==e.fq_path,search_type:this._getSearchType(e),query_string:e.query,start:t,search_session_id:n,timezone_offset:e.timezone_offset,file_type_filters:f,user_filter_account_id:e.user_filter_account_id};m||o.SearchClientActivityLogger.log("query_started",s.id,h);let g=void 0;void 0!==window.AbortController&&(g=new AbortController,this._activeRequestController=g);const S=new i.UserApiV2Client,E=s=>{const{result:o,headers:i}=s;this._activeRequestController=null;const n=i["x-dropbox-request-id"];let l;o.spell_correction&&(l={query:o.spell_correction.query,score:0,isCorrected:o.spell_correction.is_corrected,requestId:n});const d={results:a.extractSearchV2ResultsList(o.matches,t,n),hasMore:o.has_more,cursor:o.cursor,spellCorrection:l};c({context:new r.BrowseContext({blockHash:o.root_block_hash}),searchResults:d,deleted:!!e.deleted,requestId:n}),_&&_.end(n||void 0)},T=e=>{if(void 0===g||!g.signal.aborted){let t="",s="";(d.isApiError(e)||d.isBadRequestError(e)||d.isAuthError(e)||d.isAppError(e)||d.isServerError(e)||d.isRateLimitError(e))&&(t=e.toString(),e.headers&&(s=e.headers["x-dropbox-request-id"])),"function"==typeof u&&u(t,s)}_&&_.abort()};if(e.cursor)S.ns("files").rpcWithResponseHeaders("search/continue_v2",{cursor:e.cursor},{subjectUserId:s.id,signal:null==g?void 0:g.signal}).then(E).catch(T);else{const t=a.convertRequestDataToV2(e);S.ns("files").rpcWithResponseHeaders("search_v2",t,{subjectUserId:s.id,signal:null==g?void 0:g.signal}).then(E).catch(T)}}loadPopularFiltersResults(e){const t=this._prepareSearchApiRequestData(e);(()=>{this._fetchPopularFiltersResults({requestData:t,user:e.user,onSuccess:e.onSuccess,onError:e.onError,webTimer:e.webTimer})})()}_fetchPopularFiltersResults({requestData:e,user:t,onSuccess:s,onError:o,webTimer:r}){if(this._popularFiltersActiveRequestController&&(this._popularFiltersActiveRequestController.abort(),this._popularFiltersActiveRequestController=null),p(e))return;let n=void 0;void 0!==window.AbortController&&(n=new AbortController,this._popularFiltersActiveRequestController=n);const l=new i.UserApiV2Client,c=a.convertRequestDataToV2(e);l.ns("files").rpcWithResponseHeaders("popular_filters_search_aggregations",c,{subjectUserId:t.id,signal:null==n?void 0:n.signal}).then(e=>{const{result:t,headers:o}=e;this._popularFiltersActiveRequestController=null;const i=o["x-dropbox-request-id"];s({popularFiltersResult:t,requestId:i}),r&&r.end(i||void 0)}).catch(e=>{if(void 0===n||!n.signal.aborted){let t="",s="";(d.isApiError(e)||d.isBadRequestError(e)||d.isAuthError(e)||d.isAppError(e)||d.isServerError(e)||d.isRateLimitError(e))&&(t=e.toString(),e.headers&&(s=e.headers["x-dropbox-request-id"])),"function"==typeof o&&o(t,s)}r&&r.abort()})}_prepareSearchApiRequestData(e){const t=_(e.isPaperEnabled,!0),s=_(e.searchTags,!1),o=_(e.dateTaken,c.DateTaken.Any),i=_(e.selectedDimensions,[]),r=_(e.media_filters_enabled,!1),a=_(e.media_metadata_search_enable,!1),d=_(e.queries_for_fields,[]),u=_(e.searchDocClassification,!1);let p=e.fileCategories;e.searchType===n.SearchType.IMAGE&&(p=void 0);const m=p&&!l.allCategoriesChecked(p,t)?l.fileCategoriesToString(p):"",f=e.sortOrder?l.sortFieldToOrderBy(e.sortOrder.sortField):"",h=e.sortOrder?l.sortDirectionToReverseOrder(e.sortOrder.sortDirection):"";return Object.assign(Object.assign({query:e.query,fq_path:e.path,cursor:e.cursor,max_results:e.maxResults,show_paper_results:e.searchType!==n.SearchType.IMAGE,include_browse_context:e.includeBrowseContext,search_session_id:e.searchSessionId},m&&{file_categories:m}),{is_image_content_search:e.searchType===n.SearchType.IMAGE,order_by:f,reverse_order:h,include_shared_docs:!0,include_snippets:e.searchType===n.SearchType.ALL,user_filter_account_id:e.filteredAccountId,search_tags:s,selected_dimensions:i,date_taken:o,media_filters_enabled:r,media_metadata_search_enable:a,queries_for_fields:d,search_doc_classification:u})}}function _(e,t){return void 0===e?t:e}function p(e){return a.skipNonValidSearchArgs(e.query,e.user_filter_account_id,!!e.media_filters_enabled&&e.media_filters_enabled,e.date_taken?e.date_taken:c.DateTaken.Any,e.selected_dimensions?e.selected_dimensions:[],(function(e){var t;if(!(null===(t=e.queries_for_fields)||void 0===t?void 0:t.length))return;const{raw_query:s,fields:o}=e.queries_for_fields[0];if(!(null==o?void 0:o.length))return;const i=o[0]===c.SearchFields.FileName?"names":o[0]===c.SearchFields.ImageMetadata?"metadata":void 0;if(!i)return;return{query:s,type:i}})(e))}t.SearchApiClient=u,t.searchApiClient=new u})),define("modules/clean/search/single_page/data/types",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ActionTypes=void 0,(function(e){e.SET_VARIANT="SEARCH/SET_VARIANT",e.SET_USER="SEARCH/SET_USER",e.SET_EXPERIMENTS="SEARCH/SET_EXPERIMENTS",e.SET_PATH="SEARCH/SET_PATH",e.SET_QUERY="SEARCH/SET_QUERY",e.SET_FILE_CATEGORIES="SEARCH/SET_FILE_CATEGORIES",e.SET_RESULTS="SEARCH/SET_RESULTS",e.CLEAR_RESULTS="SEARCH/CLEAR_RESULTS",e.APPEND_RESULTS="SEARCH/APPEND_RESULTS",e.SET_LOADING_STATE="SEARCH/SET_LOADING_STATE",e.SET_SESSION_ID="SEARCH/SET_SESSION_ID",e.SET_REQUEST_ID="SEARCH/SET_REQUEST_ID",e.SET_SELECTION="SEARCH/SET_SELECTION",e.SET_PREVIEW_FILE_ID="SEARCH/SET_PREVIEW_FILE",e.SET_PREVIEW_COMMENTS_THREAD_ID="SEARCH/SET_PREVIEW_COMMENTS_THREAD_ID",e.SET_SORT_ORDER="SEARCH/SET_SORT_ORDER",e.ADD_TTI_COMPONENT="SEARCH/ADD_TTI_COMPONENT",e.CLEAR_TTI_COMPONENTS="SEARCH/CLEAR_TTI_COMPONENTS",e.SET_SEARCH_TYPE="SEARCH/SET_SEARCH_TYPE",e.SET_IMAGE_SUGGESTION="SEARCH/SET_IMAGE_SUGGESTION",e.UPDATE_FILE_IN_RESULTS="SEARCH/UPDATE_FILE_IN_RESULTS",e.UPDATE_RESULTS="SEARCH/UPDATE_RESULTS",e.REMOVE_RESULTS="SEARCH/REMOVE_RESULTS",e.RENAME_FILE="SEARCH/RENAME_FILE",e.DELETE_FILES="SEARCH/DELETE_FILES",e.PURGE_FILES="SEARCH/PURGE_FILES",e.RESTORE_FILES="SEARCH/RESTORE_FILES",e.SET_QUERY_HISTORY="SEARCH/SET_QUERY_HISTORY",e.SET_HIGHLIGHTED_ROW="SEARCH/SET_HIGHLIGHTED_ROW",e.UPDATE_QUERY_SUGGESTIONS_CACHE="SEARCH/UPDATE_QUERY_SUGGESTIONS_CACHE",e.SET_LAST_QUERY_WITH_QUERY_SUGGESTIONS_LOADED="SEARCH/SET_LAST_QUERY_WITH_QUERY_SUGGESTIONS_LOADED",e.SET_FILTERED_ACCOUNT_ID="SEARCH/SET_FILTERED_ACCOUNT_ID",e.UPDATE_PEOPLE_SUGGESTIONS_CACHE="SEARCH/UPDATE_PEOPLE_SUGGESTIONS_CACHE",e.SET_LAST_QUERY_WITH_PEOPLE_SUGGESTIONS_LOADED="SEARCH/SET_LAST_QUERY_WITH_PEOPLE_SUGGESTIONS_LOADED",e.SET_DWELL_TIME="SEARCH/SET_DWELL_TIME",e.SET_QUERY_START_TIME="SEARCH/SET_QUERY_START_TIME",e.SET_IS_CREATING_SHARED_LINK="SEARCH/SET_IS_CREATING_SHARED_LINK",e.UPDATE_TAGS_SUGGESTIONS_CACHE="SEARCH/UPDATE_TAGS_SUGGESTIONS_CACHE",e.SET_LAST_QUERY_WITH_TAGS_SUGGESTIONS_LOADED="SEARCH/SET_LAST_QUERY_WITH_TAGS_SUGGESTIONS_LOADED",e.UPDATE_POPULAR_FILTERS_CACHE="SEARCH/UPDATE_POPULAR_FILTERS_CACHE",e.SET_LAST_QUERY_WITH_POPULAR_FILTERS_LOADED="SEARCH/SET_LAST_QUERY_WITH_POPULAR_FILTERS_LOADED",e.SET_FILTERED_SEARCH_SUGGESTION="SEARCH/SET_FILTERED_SEARCH_SUGGESTION",e.SET_DATE_TAKEN="SEARCH/SET_DATE_TAKEN_VALUE",e.SET_SELECTED_DIMENSIONS="SEARCH/SET_SELECTED_DIMENSIONS",e.SET_MEDIA_DATA="SEARCH/SET_MEDIA_DATA"})(t.ActionTypes||(t.ActionTypes={}))})),define("modules/clean/react/growth/teams_web_actions_logger_events",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DefaultPermissionsWebUploadsEvents=t.TeamSpaceTsdAccessVisibilityEvents=t.TeamSpaceEmptyZoneCTALoggerEvents=t.CollectionsFolderActionsLoggerEvents=t.CollectionsQuickActionsLoggerEvents=t.TeamSpaceEmptyZoneLoggerEvents=t.SuggestedFoldersLoggerEvents=t.DownloadAppZoneLoggerEvents=t.OpenInDesktopCtaLoggerEvents=t.InviteFacepileLoggerEvents=t.EmptyStateDropTargetLoggerEvents=t.TeamJoinerLoggerEvents=t.RightsizingLoggerEvents=t.TeamInstallLoggerEvents=t.OnboardingLoggerEvents=void 0,(function(e){e.ESSENTIAL_SETUP_STEPS="essential_setup_steps",e.ESSENTIAL_SETUP_START="essential_setup_start",e.ESSENTIAL_SETUP_FINISH="essential_setup_finish",e.INSTALL_PAGE_ESCAPE="install_page_escape",e.DOCSEND_ONBOARD_PAGE_ESCAPE="docsend_onboard_page_escape",e.OPEN_DESKTOP_BANNER="open_desktop_banner",e.OPEN_DESKTOP_CLICK="open_desktop_click",e.RESEND_VERIFICATION_EMAIL="resend_verification_email",e.STEP_RENDER="setup_render",e.SUBMIT_TEAM_INFO="submit_team_info",e.TRANSITION_OPEN_GMAIL="transition_open_gmail",e.TRANSITION_OPEN_OUTLOOK="transition_open_outlook",e.TRIGGER_CLIENT_CHECK="trigger_client_check",e.TRIGGER_CLIENT_RESULT="trigger_client_result",e.TRIGGER_DOWNLOAD="trigger_download",e.TRIGGER_DOWNLOAD_AGAIN="trigger_download_again",e.TRIGGER_MAGIC_PAIRING="trigger_magic_pairing",e.UJ_CLINK_DOWNLOAD="uj_clink_download",e.ROLE_OPTION_SELECTED="role_option_selected",e.VIEW_SUGGESTIONS_LOADING_SCREEN="view_suggestions_loading_screen",e.COLLABORATION_TYPE_SELECTED="collaboration_type_selected",e.SETUP_SKIP_ADD_MEMBERS="setup_skip_add_members",e.SETUP_INVITE_MEMBERS_IMPORT="setup_invite_members_import",e.SETUP_INVITE_MEMBERS_COPY_LINK="setup_invite_members_copy_link",e.SETUP_INVITE_MEMBERS_ADD_EMAIL="setup_invite_members_add_email",e.SETUP_INVITE_MEMBERS_ADD_MORE_CLICKED="setup_invite_members_add_more_clicked",e.SETUP_ADD_MEMBERS="setup_add_members",e.SETUP_ADD_MEMBERS_SUBMITTED="setup_add_members_submitted",e.SETUP_ADD_MEMBERS_FAILED="setup_add_members_failed",e.SHARE_INVITE_CLICK="share_invite_click",e.SHARE_INVITE_SHEET_ACTION="share_invite_sheet_action",e.SHARE_INVITE_SHEET_DISMISS="share_invite_sheet_dismiss",e.SHARE_INVITE_COPIED="share_invite_copied",e.INVITE_PAGE_ESCAPE="invite_page_escape",e.MW_APP_STORE_REDIRECT="mw_app_store_redirect",e.MW_CLINK_FLOW_REDIRECT="mw_clink_flow_redirect",e.INSTALL_APP_PAGE_ESCAPE="install_app_page_escape",e.INSTALL_PAGE_REDIRECT="install_page_redirect",e.MOBILE_ICON_CLICK="mobile_icon_click",e.SEND_MOBILE_APP_LINK="send_mobile_app_link",e.MW_STEP_NOT_RENDER="mw_step_not_render",e.REC_FOLDER_LOADED="rec_folder_loaded",e.REC_FOLDER_LOAD_FAILED="rec_folder_load_failed",e.SETUP_ADD_MEMBERS_REC_LOADED="setup_add_members_rec_loaded",e.SETUP_ADD_MEMBERS_REC_LOAD_FAILED="setup_add_members_rec_load_failed",e.REC_FOLDER_CHECK="rec_folder_check",e.REC_FOLDER_UNCHECK="rec_folder_uncheck",e.REC_FOLDER_CLK_NEXT="rec_folder_clk_next",e.CONF_FOLDER_CLK_MOVE="conf_folder_clk_move",e.CONF_FOLDER_MOVE_SUCCEEDED="conf_folder_move_succeeded",e.CONF_FOLDER_MOVE_PARTIAL="conf_folder_move_partial_fail",e.CONF_FOLDER_MOVE_FAILED="conf_folder_move_failed",e.CONF_FOLDER_MOVE_INDIVIDUAL_ERROR="conf_folder_move_individual_error",e.CONF_FOLDER_MOVE_INTERRUPTED="conf_folder_move_interrupted",e.SETUP_CONFIRM_MOVE_FOLDERS_IMPRESSION="setup_confirm_move_folders_impression",e.SETUP_RESULTS_MOVE_FOLDERS_IMPRESSION="setup_results_move_folders_impression",e.SETUP_SELECT_FOLDERS_IMPRESSION="setup_select_folders_impression",e.SETUP_MOVE_FOLDERS_KEEP_PERSONAL="setup_move_folders_keep_personal",e.SETUP_ADD_MEMBERS_UNCHECK="setup_add_members_uncheck",e.SETUP_ADD_MEMBERS_CHECK="setup_add_members_check",e.SETUP_ADD_MEMBERS_MORE_RECOS="setup_add_members_more_recos",e.SCROLL_EVENT="scroll_event",e.ACCESS_FOLDER_CHECK="access_folder_check",e.ACCESS_FOLDER_UNCHECK="access_folder_uncheck",e.FLOW_STEPS_DOES_NOT_MATCH="flow_steps_does_not_match",e.FLOW_STEPS_DOES_NOT_MATCH_V2="flow_steps_does_not_match_v2",e.FLOW_STEPS_DOES_NOT_MATCH_V3="flow_steps_does_not_match_v3",e.FLOW_CONT_URL_DOES_NOT_MATCH="flow_cont_url_does_not_match"})(t.OnboardingLoggerEvents||(t.OnboardingLoggerEvents={})),(function(e){e.UJ_CLINK_DOWNLOAD_AGAIN="uj_clink_download_again",e.UJ_CLINK_SKIP_AFTER_DOWNLOAD="uj_clink_skip_after_download",e.SETUP_RENDER="setup_render",e.UJ_CLINK_DOWNLOAD_MOBILE_REROUTE="uj_clink_download_mobile_reroute",e.UJ_CLINK_DOWNLOAD="uj_clink_download",e.UJ_CLINK_SKIP="uj_clink_skip",e.OPEN_DESKTOP_CLICK="open_desktop_click"})(t.TeamInstallLoggerEvents||(t.TeamInstallLoggerEvents={})),(function(e){e.CLICK_MULTIPLE="rightsizing_clk_filter_screen_multiple",e.CLICK_YOU="rightsizing_clk_filter_screen_you",e.VIEW="rightsizing_view_filter_screen"})(t.RightsizingLoggerEvents||(t.RightsizingLoggerEvents={})),(function(e){e.CLK_YES_TO_CREATE="clk_yes_to_create",e.CLK_NO_TO_COMBINE="clk_no_to_combine",e.CLK_CREATE_JOINER="clk_create_joiner",e.CLK_CREATE_NEW="clk_create_new",e.CLK_COMBINE="clk_combine",e.SETUP_RENDER="setup_render",e.MERGE_ACCOUNTS="joiner_merge_accounts",e.CREATE_NEW_PERSONAL="joiner_create_new_personal",e.SIGNUP="joiner_signup",e.SIGNIN="joiner_signin"})(t.TeamJoinerLoggerEvents||(t.TeamJoinerLoggerEvents={})),(function(e){e.VIEW_CONTENT_EMPTY_STATE="view_content_empty_state",e.CLICK_BROWSE_UPLOAD_CTA="click_browse_upload_cta"})(t.EmptyStateDropTargetLoggerEvents||(t.EmptyStateDropTargetLoggerEvents={})),(function(e){e.VIEW_INVITE_EMPTY_STATE="view_invite_empty_state",e.INVITE_MEMBERS_PRIMARY_CTA_CLK="invite_members_primary_cta_clk"})(t.InviteFacepileLoggerEvents||(t.InviteFacepileLoggerEvents={})),(function(e){e.DESKTOP_ICON_TOOLTIP="desktop_icon_tooltip",e.DESKTOP_ICON_CLICK="desktop_icon_click",e.DESKTOP_ICON_CLICK_RESULT="desktop_icon_click_result",e.DESKTOP_ICON_TOOLTIP_DISMISS="desktop_icon_tooltip_dismiss"})(t.OpenInDesktopCtaLoggerEvents||(t.OpenInDesktopCtaLoggerEvents={})),(function(e){e.VIEW_MOBILE_EMPTY_STATE="view_mobile_empty_state",e.DISMISS_MOBILE_EMPTY_STATE="dismiss_mobile_empty_state",e.SEND_MOBILE_LINK_CLK="send_mobile_link_clk",e.SEND_MOBILE_LINK_SUCCESS="send_mobile_link_success",e.SEND_MOBILE_LINK_FAIL="send_mobile_link_fail"})(t.DownloadAppZoneLoggerEvents||(t.DownloadAppZoneLoggerEvents={})),(function(e){e.MOUNT_SUGGESTED_FOLDERS="mount_suggested_folders",e.VIEW_SUGGESTED_FOLDERS="view_suggested_folders",e.SUGGESTED_FOLDER_ADD_CLICKED="suggested_folder_add_clicked",e.SUGGESTED_FOLDERS_HIDE_CLICKED="suggested_folders_hide_clicked",e.SUGGESTED_FOLDER_CREATED="suggested_folder_created",e.SUGGESTED_FOLDER_FAILED="suggested_folder_failed",e.SUGGESTED_FOLDER_ACCESS_VIEW="suggested_folder_access_view",e.SUGGESTED_FOLDER_ACCESS_CHANGE="suggested_folder_access_change",e.VIEW_SUGGESTED_FOLDERS_MINIMIZED="view_suggested_folders_minimized",e.VIEW_SUGGESTED_FOLDERS_OPEN="view_suggested_folders_open"})(t.SuggestedFoldersLoggerEvents||(t.SuggestedFoldersLoggerEvents={})),(function(e){e.VIEW_EXPLORE_CONTENT_STATE="view_explore_content_state",e.VIEW_EXPLORE_EMPTY_STATE="view_explore_empty_state"})(t.TeamSpaceEmptyZoneLoggerEvents||(t.TeamSpaceEmptyZoneLoggerEvents={})),(function(e){e.VIEW_ROLE_SUGGESTIONS="view_role_suggestions",e.VIEW_ROLE_SUGGESTIONS_MINIMIZED="view_role_suggestions_hidden",e.SHOW_SUGGESTIONS_CLICKED="role_suggestions_clk_view",e.HIDE_SUGGESTIONS_CLICKED="role_suggestions_clk_hide",e.CLICKED_SUGGESTION="role_suggestions_clk_cta",e.DISMISSED_SUGGESTION="role_suggestions_clk_dismiss",e.DISMISS_ALL_SUGGESTED_FOLDERS="suggested_folder_dismiss_all"})(t.CollectionsQuickActionsLoggerEvents||(t.CollectionsQuickActionsLoggerEvents={})),(function(e){e.SUGGESTIONS_PAGE_IMPRESSION="suggestions_page_impression",e.SUGGESTIONS_PAGE_CLICK_CTA="suggestions_page_clk_cta"})(t.CollectionsFolderActionsLoggerEvents||(t.CollectionsFolderActionsLoggerEvents={})),(function(e){e.UPLOAD_FILES_CLICKED="upload_files_clk",e.CREATE_FOLDER_CLICKED="create_folder_clk"})(t.TeamSpaceEmptyZoneCTALoggerEvents||(t.TeamSpaceEmptyZoneCTALoggerEvents={})),(function(e){e.CREATE_FOLDER_MODAL_OPEN="tsd_create_folder_modal_open",e.CREATE_FOLDER_CLICK="tsd_create_folder_click",e.PERMISSIONS_AT_UPLOAD_MODAL_OPEN="tsd_upload_folder_modal_open",e.PERMISSIONS_AT_UPLOAD_CLICK="tsd_upload_folder_click"})(t.TeamSpaceTsdAccessVisibilityEvents||(t.TeamSpaceTsdAccessVisibilityEvents={})),(function(e){e.ACCOUNT_PREF_DEFAULT_PERMISSION_TOGGLE="account_pref_default_permission_toggle",e.DEFAULT_PERMISSION_MODAL_IMPRESSION="default_permission_modal_impression",e.DEFAULT_PERMISSION_MODAL_ACCEPT="default_permission_modal_accept",e.DEFAULT_PERMISSION_MODAL_DISMISS="default_permission_modal_dismiss",e.DEFAULT_PERMISSION_MODAL_ACCOUNT_PREF_CTA="default_permission_modal_account_pref_cta"})(t.DefaultPermissionsWebUploadsEvents||(t.DefaultPermissionsWebUploadsEvents={}))})),define("modules/clean/react/file_uploader/web_upload_action_logger",["require","exports","tslib","modules/clean/deprecated_ajax/ajax_jquery"],(function(e,t,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WebUploadActionLogClass=t.WebUploadActionLog=t.MAX_ERRORS=void 0,o=s.__importStar(o),t.MAX_ERRORS=3;class i{constructor(){this.errorCount=0,this.lastError=Date.now(),this.shouldReport=!0}log(e,s,i){return i=Object.assign(Object.assign(Object.assign({},i),i.extra),{extra:void 0}),this.shouldReport&&(this.errorCount<t.MAX_ERRORS||Date.now()-this.lastError>6e5)?new Promise((r,a)=>{o.SilentBackgroundRequest({url:"/log/web_upload_action",data:{_subject_uid:e,event_type:s,extra_params:JSON.stringify(i)},error:e=>{429===e.status?this.errorCount=t.MAX_ERRORS:this.errorCount++,this.lastError=Date.now(),a(e)},success:e=>{try{const t=JSON.parse(e);t&&!t.continue_sending&&(this.shouldReport=!1),this.errorCount=0,r(e)}catch(e){throw this.errorCount++,this.lastError=Date.now(),a(e),e}}})}):Promise.resolve({})}}t.WebUploadActionLog=new i,t.WebUploadActionLogClass=i})),define("modules/core/custom_protocol",["require","exports","tslib","modules/core/browser_detection"],(function(e,t,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.canLaunchUri=t.launchUriForMicrosoftBrowsers=t.launchUriByIframe=t.launchUri=void 0;const i=(o=s.__importStar(o)).chrome?1e3:2e3;function r(e){const t=document.createElement("iframe");t.src=e,t.setAttribute("style","display: none;"),document.body.appendChild(t)}function a(e,t,s){const o=window.navigator;o&&o.msLaunchUri?o.msLaunchUri(e,t,s):s()}t.launchUri=function(e){let t=null;return new Promise((s,n)=>{function l(){window.removeEventListener("blur",l),null!==t&&clearTimeout(t),s()}window.addEventListener("blur",l),t=setTimeout(()=>{window.removeEventListener("blur",l),n()},i),o.chromium()?window.location.assign(e):o.mozilla||o.safari?r(e):(o.msie||o.edge)&&a(e,s,n)})},t.launchUriByIframe=r,t.launchUriForMicrosoftBrowsers=a,t.canLaunchUri=function(){return o.msie?o.windowsInfo.win8OrHigher:!!(o.mozilla||o.safari||o.chrome)}})),define("modules/clean/react/vault/constants",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ENCRYPTED_DOWNLOAD_ARGS_QUERY_PARAM_KEY=t.ENCRYPTED_OWNER_QUERY_PARAM_KEY=t.VAULT_OWNER_DISPLAY_NAME_QUERY_PARAM_KEY=t.VAULT_OWNER_FNAME_QUERY_PARAM_KEY=t.DEFAULT_APPS_PATH=t.SECURITY_CHECKUP_RELATIVE_URL=t.VAULT_STYLESHEETS=t.VAULT_NAME=t.VAULT_HASH_MODAL_KEY=t.VAULT_HASH_TAB_KEY=t.VAULT_URL=void 0,t.VAULT_URL="/vault",t.VAULT_HASH_TAB_KEY="tab",t.VAULT_HASH_MODAL_KEY="modal",t.VAULT_NAME="Vault",t.VAULT_STYLESHEETS=["/static/css/spectrum/index.web-vfliw9181.css","/static/css/dig-components/index.web-vflm67Rix.css","/static/js/vault/index.web-vflDlO13I.css","/static/css/vault/vault-vflbqmnaC.css"],t.SECURITY_CHECKUP_RELATIVE_URL="/security_checkup",t.DEFAULT_APPS_PATH="/account/default_apps",t.VAULT_OWNER_FNAME_QUERY_PARAM_KEY="vo_fn",t.VAULT_OWNER_DISPLAY_NAME_QUERY_PARAM_KEY="vo_dn",t.ENCRYPTED_OWNER_QUERY_PARAM_KEY="vo",t.ENCRYPTED_DOWNLOAD_ARGS_QUERY_PARAM_KEY="enc"})),define("modules/clean/react/vault/lib/browse_utils",["require","exports","tslib","modules/clean/filepath/filepath","modules/clean/react/vault/constants"],(function(e,t,s,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getVaultFqPath=t.isInsideVault=t.logShareFromInsideVault=void 0,o=s.__importStar(o),t.logShareFromInsideVault=function(t){return s.__awaiter(this,void 0,void 0,(function*(){const{logProductAnalyticsEvent:o}=yield new Promise((t,s)=>{e(["modules/clean/react/vault/lib/api"],t,s)}).then(s.__importStar),{AnalyticsEventAction:i,AnalyticsEventObject:r,AnalyticsEventActionSurface:a}=yield new Promise((t,s)=>{e(["vault/common/logging-types"],t,s)}).then(s.__importStar);o({eventAction:i.SELECT,eventObject:t?r.SHARE_FOLDER:r.SHARE_FILE,actionSurface:a.VAULT_HOME})}))},t.isInsideVault=function(e){const t=e.split("/");return("/"===e[0]?t[1]:t[0])===i.VAULT_NAME},t.getVaultFqPath=function(){return o.normalize(i.VAULT_NAME)}})),define("typescript/libraries/comments2/src/components/folder_overview_utils/index",["require","exports","typescript/libraries/comments2/src/components/folder_overview_utils/description_utils"],(function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isEmptyDescription=void 0,Object.defineProperty(t,"isEmptyDescription",{enumerable:!0,get:function(){return s.isEmptyDescription}})})),define("typescript/libraries/comments2/src/components/folder_overview_utils/description_utils",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isEmptyDescription=void 0,t.isEmptyDescription=e=>{if(!e)return!0;if(0===e.blocks.length)return!0;if(e.blocks.length>1)return!1;if("unstyled"!==e.blocks[0].type)return!1;return 0===e.blocks.map(e=>e.text).join("\n").replace(/%u200B/g,"").trim().length}})),define("typescript/component_libraries/retrieval-components/src/collapsable-section/index",["require","exports","tslib","react","classnames","spectrum/button/index"],(function(e,t,s,o,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CollapsableSection=void 0,o=s.__importDefault(o),i=s.__importDefault(i),t.CollapsableSection=({title:e,isOpen:t,onHeaderClick:s,children:a,top:n,strings:l,containerClassName:c})=>o.default.createElement("div",{className:i.default({"rc-collapsable-section":!0,"rc-collapsable-section--closed":!t}),style:{top:n}},o.default.createElement("div",{className:"rc-collapsable-section__header"},o.default.createElement("h2",{className:"rc-collapsable-section__header-tag"},o.default.createElement("span",null,e),o.default.createElement(r.Button,{onClick:s,className:"rc-collapsable-section__toggle",variant:"styleless"},t?l.buttonClose:l.buttonOpen))),o.default.createElement("div",{className:c,style:{display:t?void 0:"none"}},a))})),define("dropbox/proto/hql_events/browse/web_browse",["require","exports","tslib","protobufjs/minimal","dropbox/proto/hql_events/extensions"],(function(e,t,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.hql_events=void 0;const i=(o=s.__importStar(o)).Reader,r=o.Writer,a=(o.util,o.roots.default||(o.roots.default={}));var n;t.default=a,t.hql_events=a.hql_events=((n=a.hql_events||{}).WebBrowseSelectRow=(function(e){function e(e){if(e)for(let t=Object.keys(e),s=0;s<t.length;++s)null!=e[t[s]]&&(this[t[s]]=e[t[s]])}return e.prototype.actionSource="",e.prototype.hqlMetadata=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=r.create()),null!=e.actionSource&&Object.hasOwnProperty.call(e,"actionSource")&&t.uint32(10).string(e.actionSource),null!=e.hqlMetadata&&Object.hasOwnProperty.call(e,"hqlMetadata")&&a.hql_events.HQLMetadata.encode(e.hqlMetadata,t.uint32(18).fork()).ldelim(),t},e.decode=function(e,t){e instanceof i||(e=i.create(e));let s=void 0===t?e.len:e.pos+t,o=new a.hql_events.WebBrowseSelectRow;for(;e.pos<s;){let t=e.uint32();switch(t>>>3){case 1:o.actionSource=e.string();break;case 2:o.hqlMetadata=a.hql_events.HQLMetadata.decode(e,e.uint32());break;default:e.skipType(7&t)}}return o},e.getTypeUrl=function(){return"type.googleapis.com/hql_events.WebBrowseSelectRow"},e})(n.WebBrowseSelectRow||{}),n)})),define("modules/clean/react/upload_kit/scheduler/types",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UploadScheduler=void 0;t.UploadScheduler=class{constructor(e){}}}));var __createBinding=this&&this.__createBinding||(Object.create?function(e,t,s,o){void 0===o&&(o=s),Object.defineProperty(e,o,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,o){void 0===o&&(o=s),e[o]=t[s]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),__importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.prototype.hasOwnProperty.call(e,s)&&__createBinding(t,e,s);return __setModuleDefault(t,e),t};define("modules/clean/react/browse/fss_experiment_carousel_util",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.asyncShowFssExpr=void 0,t.asyncShowFssExpr=(t,s,o,i)=>{new Promise((t,s)=>{e(["modules/clean/react/browse/fss_experiment_carousel"],t,s)}).then(__importStar).then(e=>{e.showFssExpr(t,s,o,i)})}})),define("modules/clean/react/flows/components/badge_async",["require","exports","tslib","react"],(function(e,t,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AsyncBadgeComponent=void 0,o=s.__importStar(o);const{lazy:i,Suspense:r}=o,a=i(()=>s.__awaiter(void 0,void 0,void 0,(function*(){const{FlowsFolderBadge:t}=yield new Promise((t,s)=>{e(["modules/clean/react/flows/components/badge"],t,s)}).then(s.__importStar);return{default:t}})));t.AsyncBadgeComponent=({type:e,isInUnifiedModal:t,isFolderFocused:s})=>o.createElement(r,{fallback:o.createElement("div",null)},o.createElement(a,{type:e,isInUnifiedModal:t,isFolderFocused:s})),t.AsyncBadgeComponent.displayName="AsyncBadgeComponent"})),define("modules/clean/media_filters/gating",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isOrganizedRetrievalSurveyEnabled=t.isPopularFiltersSearchEnabled=t.isMediaMetadataSearchEnabled=t.isMediaFiltersEnabled=t.isMediaInformationEnabled=void 0,t.isMediaInformationEnabled=function(e){return!!e&&["V1","V2","V3","V4","V1_SURVEY","V2_SURVEY","V3_SURVEY","V4_SURVEY"].includes(e)},t.isMediaFiltersEnabled=function(e){return!!e&&["V2","V3","V4","V2_SURVEY","V3_SURVEY","V4_SURVEY"].includes(e)},t.isMediaMetadataSearchEnabled=function(e){return!!e&&["V3","V4","V3_SURVEY","V4_SURVEY"].includes(e)},t.isPopularFiltersSearchEnabled=function(e){return!!e&&["V4","V4_SURVEY"].includes(e)},t.isOrganizedRetrievalSurveyEnabled=function(e){return!!e&&["SURVEY","V1_SURVEY","V2_SURVEY","V3_SURVEY","V4_SURVEY"].includes(e)}})),define("modules/clean/media_filters/media_search_snippet_loader",["require","exports","tslib","modules/clean/react/async/loadable","react","modules/clean/web_timing_logger"],(function(e,t,s,o,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AsyncMediaSearchSnippet=void 0,i=s.__importDefault(i);const a=o.Loadable({loader:()=>s.__awaiter(void 0,void 0,void 0,(function*(){yield r.waitForTTI();const{MediaSearchSnippet:t}=yield new Promise((t,s)=>{e(["modules/clean/media_filters/media_search_snippet"],t,s)}).then(s.__importStar);return t}))});t.AsyncMediaSearchSnippet=e=>i.default.createElement(a,Object.assign({},e)),t.AsyncMediaSearchSnippet.displayName="AsyncMediaSearchSnippet"}));
//# sourceMappingURL=pkg-browse.min.js-vfl5ZGYos.map