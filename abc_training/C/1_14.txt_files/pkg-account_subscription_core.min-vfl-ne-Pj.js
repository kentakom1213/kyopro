define("family/common/features",["require","exports","tslib","react"],(function(e,t,a,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useFeatureFlag=t.FeatureFlagProvider=t.FAMILY_FEATURE_FLAGS=void 0,n=a.__importStar(n);const{createContext:i,useContext:s}=n;(t.FAMILY_FEATURE_FLAGS||(t.FAMILY_FEATURE_FLAGS={})).HAS_FAMILY_SHARED_FOLDER="has_family_shared_folder";const l=i({});t.FeatureFlagProvider=({children:e,flags:t})=>n.createElement(l.Provider,{value:t},e),t.FeatureFlagProvider.displayName="FeatureFlagProvider",t.useFeatureFlag=function(e){return!!s(l)[e]}})),define("family/common/links",["require","exports","tslib","react","dig-components/typography"],(function(e,t,a,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ageGatingHelpCenterLink=t.AGE_GATING_HELP_CENTER_ARTICLE=t.REMOVE_MEMBER_HELP_CENTER_ARTICLE=t.FAMILY_ROOM_HELP_CENTER_ARTICLE=void 0,n=a.__importStar(n),t.FAMILY_ROOM_HELP_CENTER_ARTICLE="https://help.dropbox.com/accounts-billing/plans-upgrades/share-files-family-plan#familyroom",t.REMOVE_MEMBER_HELP_CENTER_ARTICLE="https://help.dropbox.com/accounts-billing/plans-upgrades/manage-family-plan#remove",t.AGE_GATING_HELP_CENTER_ARTICLE="https://help.dropbox.com/accounts-billing/plans-upgrades/dropbox-family-age-requirements",t.ageGatingHelpCenterLink=e=>n.createElement(i.Link,{href:t.AGE_GATING_HELP_CENTER_ARTICLE},e)})),define("modules/clean/account_page/constants",["require","exports","modules/core/uri"],(function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GIGABYTE_IN_BYTES=t.MEGABYTE_IN_BYTES=t.ROOT_DOWNGRADE_URI=t.CancellationType=void 0,(function(e){e[e.ALL=1]="ALL",e[e.PLAN=2]="PLAN",e[e.SCHEDULE=3]="SCHEDULE",e[e.LICENSES=4]="LICENSES",e[e.ADDON=5]="ADDON",e[e.IND_SUBSCRIPTION=6]="IND_SUBSCRIPTION",e[e.FAMILY_NONPAYER=7]="FAMILY_NONPAYER"})(t.CancellationType||(t.CancellationType={})),t.ROOT_DOWNGRADE_URI=new a.URI({path:"/downgrade",query:{oqa:"acc_cancel"}}),t.MEGABYTE_IN_BYTES=1048576,t.GIGABYTE_IN_BYTES=1073741824})),define("modules/clean/account_page/tabs/billing",["require","exports","tslib","react","react-redux","styled-components","modules/clean/account_page/components/key_value_block","modules/clean/account_page/components/loading","modules/clean/account_page/widgets/billing/action_creators","modules/clean/account_page/widgets/billing/payment_methods_util","modules/clean/payments/billing_instrument/payment_methods_util","modules/clean/account_page/widgets/billing/views/billing_history","modules/clean/account_page/widgets/billing/views/invoice_details","modules/clean/account_page/widgets/plan/action_creators","modules/clean/account_page/widgets/plan/add_ons/action_creators","modules/clean/account_page/widgets/plan/views/add_schedule_modal","modules/clean/account_page/widgets/plan/views/cancel_subs_warning_modal","modules/clean/account_page/widgets/plan/views/change_plan_modal","modules/clean/active_user","modules/clean/analytics","modules/clean/dbmodal_stack","modules/clean/event_handler","modules/clean/payments/skus/constants","modules/clean/payments/skus/sku_content","modules/clean/payments/skus/subscription_status","modules/clean/react/components/css","modules/clean/react/payments/edit_invoice_address_modal/edit_invoice_address_modal_loader","modules/clean/react/payments/error/browser_update_required_modal","modules/clean/react/payments/update_individual_billing/update_individual_billing_modal_loader","modules/clean/react/payments/update_individual_billing/update_individual_store_creator","modules/clean/teams/admin/lib/billing_history","modules/clean/web_timing_logger","modules/constants/trademark","modules/core/browser","modules/core/i18n","modules/core/notify","modules/core/uri","modules/clean/account_page/widgets/plan/api"],(function(e,t,a,n,i,s,l,o,r,d,c,u,p,m,g,_,f,h,y,b,v,M,S,P,E,C,A,T,I,w,D,N,L,x,k,R,B,O){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initialize_module=t.moduleInit=t.BillingTab=t.BillingTabView=void 0,n=a.__importDefault(n),i=a.__importStar(i),s=a.__importDefault(s),x=a.__importStar(x);const F=s.default.div`
  .billing-table-container {
    border-radius: 0;
    border: 1px solid var(--color__faint__border);

    .billing-history-table {
      width: 100%;
      border-collapse: collapse;

      .row-header {
        background-color: var(--color__faint__background);
        padding: var(--spacing__unit--2) 0;
        color: var(--color__faint__text);
        font-size: var(--type__body__standard--fontsize);
        height: auto;
        font-weight: normal;
      }

      .caret {
        vertical-align: middle;
      }

      .date-header-cell {
        font-weight: normal;
        text-align: left;
        color: var(--color__faint__text);
      }

      .date-row {
        padding-left: var(--spacing__unit--2);
        padding-right: var(--spacing__unit--3);
        width: 80px;
        font-weight: normal;
        text-align: left;
        font-size: var(--type__body__small--fontsize);
        color: var(--color__faint__text);
      }

      .desc-row {
        font-weight: normal;
        text-align: left;
        font-size: var(--type__body__small--fontsize);
        color: var(--color__faint__text);
      }

      .price-row {
        padding-left: var(--spacing__unit--3);
        padding-right: var(--spacing__unit--2);
        width: 100px;
        font-weight: normal;
        text-align: left;
        font-size: var(--type__body__small--fontsize);
        color: var(--color__faint__text);
      }

      .row-content {
        height: 56px;
        border-top: 1px solid var(--color__faint__border);
        color: var(--color__standard__text);

        &__links {
          white-space: nowrap;
          padding: var(--spacing__base_unit);
          text-align: right;

          a,
          button {
            &:not(:first-child) {
              margin-left: var(--spacing__base_unit);
            }
          }
        }
      }

      .row-content__date {
        padding-left: var(--spacing__unit--2);
        padding-right: var(--spacing__unit--3);
        width: 80px;
        text-align: left;
        color: var(--color__standard__text);
      }

      .row-content__description {
        color: var(--color__standard__text);

        .description-line {
          margin: 0;
        }
      }

      .row-content__price {
        padding-left: var(--spacing__unit--3);
        padding-right: var(--spacing__unit--2);
        width: 100px;
        text-align: left;
        color: var(--color__standard__text);
      }

      .billing-history-row {
        border-top: 1px solid var(--color__faint__border);
      }

      .billing-history-col {
        text-align: center;
        height: ver(--spacing__unit--5);
      }
    }
  }
`;let U=class extends n.default.Component{constructor(e){super(e),this.browserUpdateRequired=()=>!!this.props.browserUpdateRequired&&(T.BrowserUpdateModalLoader.showInstance(),!0),this.handlePaymentUpdate=()=>{this.browserUpdateRequired()||(b.ProEventsLogger.log("de_billing_tab_update_payment_method_click"),this.props.billingInfo.scheduled_for_downgrade?f.CancelChangesModalConfirmation.showInstance({transitionPerformed:this.reloadData,subStatus:this.subStatus}):I.IndividualUpdateBillingModalLoader.showInstance())},this.handlePaymentAdd=()=>{this.browserUpdateRequired()||(b.ProEventsLogger.log("de_billing_tab_add_payment_method_click"),I.IndividualUpdateBillingModalLoader.showInstance())},this.handlePaymentAddToResubscribe=()=>{this.browserUpdateRequired()||(b.ProEventsLogger.log("de_billing_tab_add_payment_method_resubscribe_click"),R.Notify.success(k.intl.formatMessage({id:"CDgQc9",defaultMessage:"Please update your billing information to be resubscribed."})),I.IndividualUpdateBillingModalLoader.showInstance())},this.reloadData=()=>{const{loadBillingInfo:e,loadPlanDataIfNecessary:t,loadAddonsInfoIfNecessary:a,loadAvailableAddonsInfoIfNecessary:n}=this.props;O.resetApolloStore(),e(!0),a(!0),n(!0),t(!0)},this.handleRebillUpsell=e=>{e&&e.showChangePlanConfirm&&h.ChangePlanModalView.showInstance({mode:h.ChangePlanMode.CONFIRM,transitionPerformed:this.reloadData})},this.handleAddBillUpsell=()=>{this.props.trialsConfig&&this.props.showNptScheduleModal&&(_.AddScheduleModalView.showInstance({project:this.props.trialsConfig.project,productType:P.SkuContentClient.deserialize(this.props.trialsConfig.trialPlan.skuContent).dropboxDisplayName(),userId:this.user.id,skuCode:this.props.trialsConfig.trialPlan.skuCode,duration:this.props.trialsConfig.trialPlan.duration,billingId:this.props.billingInfo.payment_info.gateway_id}),b.ProEventsLogger.log("de_billing_tab_trigger_add_schedule_modal",{source:"billing_info_updated",project:this.props.trialsConfig.project}))},this.onEditInvoiceDetailsClick=()=>{b.ProEventsLogger.log("de_billing_tab_edit_invoice_modal_open"),A.EditInvoiceAddressModalLoader.showUpdateTaxProfileModal(!1,this.onInvoiceDetailsUpdated)},this.onInvoiceDetailsUpdated=()=>{this.props.loadBillingInfo(!0)},this.renderBillingHistory=()=>{const{transactions:e,show_edit_invoice_modal:t,edit_past_invoices:a}=this.props.billingInfo,i=t&&a;let s=!1;if(null!==e&&e.transactions.length>0){s=D.getHistoryData(e.transactions).length>3}return n.default.createElement(u.BillingHistory,{showEditInvoiceModal:i,transactions:e.transactions,filters:e.filters,hasMore:s})},this.renderPaymentMethod=()=>{var e,t;if(this.disallowChangesToCurrentBilling)return;if(this.props.trialsConfig&&this.props.trialsConfig.hideBillingModal)return;const{gateway_id:a,expiration_date:i,description:s,is_reseller_billing:o,end_date:r,deactivated:u,is_on_trial:p,reseller_name:m,reseller_link:g}=this.props.billingInfo.payment_info;if(o){const e=k.intl.formatMessage({id:"b9rPCC",defaultMessage:"Go to {reseller_name} to view or make changes to your account details"},{reseller_name:m}),t=n.default.createElement("a",{href:g,target:"_blank",rel:"noopener noreferrer"},e);return n.default.createElement(l.KeyValueBlock,{className:"jest-update-payment",keyText:t})}if(-1===a)return;if(!d.shouldHidePaymentMethod(a)&&!this.props.billingInfo.payment_method)return n.default.createElement(l.KeyValueBlock,{className:"add-payment jest-update-payment",keyText:k.intl.formatMessage({id:"7Au+O9",defaultMessage:"You can add your payment information now to have your subscription automatically renew when it expires"}),linkText:k.intl.formatMessage({id:"YcxVqg",defaultMessage:"Add"}),onLinkClick:this.handlePaymentAddToResubscribe});if(c.isLicenseKey(a))return n.default.createElement("div",{className:"account-page-block"},n.default.createElement(l.KeyValueBlock,{className:"jest-update-payment",keyText:k.intl.formatMessage({id:"DlX7Ow",defaultMessage:"Payment method"}),subtext:k.intl.formatMessage({id:"nST3rs",defaultMessage:"Add your payment information now to have your subscription automatically renew when it expires"}),linkText:k.intl.formatMessage({id:"CyOG7U",defaultMessage:"Add payment method"}),onLinkClick:this.handlePaymentAdd}));if(d.shouldHidePaymentMethod(a)){const i=d.getPaymentMethodDisabledMessage(a,o,(null===(t=null===(e=this.subStatus)||void 0===e?void 0:e.subState.plan)||void 0===t?void 0:t.displayName())||L.TRADEMARK_PLUS,r,u,p);return n.default.createElement(l.KeyValueBlock,{className:"jest-update-payment",keyText:i})}let _=s;return null!==i&&(_=k.intl.formatMessage({id:"3tRkOA",defaultMessage:"{payment_description}, exp: {expiration_date}"},{payment_description:s,expiration_date:i})),n.default.createElement(l.KeyValueBlock,{className:"update-payment-key-value jest-update-payment",keyText:k.intl.formatMessage({id:"DlX7Ow",defaultMessage:"Payment method"}),valueText:_,linkText:k.intl.formatMessage({id:"+5HiT6",defaultMessage:"Update"}),onLinkClick:this.handlePaymentUpdate})},this.renderInvoiceDetails=()=>{const{show_edit_invoice_modal:e,payment_info:t,payment_method:a,has_invoice_details:i}=this.props.billingInfo;if(this.user.paid&&e&&!d.shouldHideBillingChange(t.gateway_id,t.is_reseller_billing)&&t.period)return n.default.createElement(p.InvoiceDetails,{onLinkClick:this.onEditInvoiceDetailsClick,has_invoice_details:i,country_code:a?a.country_code:void 0})},this.user=y.mustGetActiveUser(),v.DBModalStack.register(w.BILLING_INFO_UPDATED,e=>{b.ProEventsLogger.log("de_payment_modal_save_click"),O.resetApolloStore(),this.props.loadBillingInfo(!0),this.props.loadPlanDataIfNecessary(!0),this.handleRebillUpsell(e.detail),this.handleAddBillUpsell()})}componentDidMount(){this.props.loadBillingInfo(),this.checkTTIstate(),b.ProEventsLogger.log("de_billing_tab_view"),this.events.on(window,"hashchange",()=>{this.displayResubscribeBillingModal(),this.displayUpdateBillingModal(),this.displayAddScheduleModal()}),this.displayResubscribeBillingModal(),this.displayUpdateBillingModal(),this.displayAddScheduleModal()}componentDidUpdate(){this.checkTTIstate()}displayUpdateBillingModal(){var e;const t=x.get_hash(),a=void 0!==t&&-1!==t.search("billing_info")&&-1===t.search("resubscribe_billing_info"),n=B.URI.parse(x.get_href()).getQuery().modal,i=n&&"billing_info"===n,s=B.URI.parse(x.get_href()).getQuery().reason;if(a||i){if(!this.user.paid)return;if(this.browserUpdateRequired())return;if(this.props.trialsConfig&&this.props.trialsConfig.hideBillingModal)return;I.IndividualUpdateBillingModalLoader.showInstance(),b.ProEventsLogger.log("de_billing_tab_trigger_update_billing_modal",{reason:s,project:null===(e=this.props.trialsConfig)||void 0===e?void 0:e.project})}}displayResubscribeBillingModal(){const e=x.get_hash();if(void 0!==e&&-1!==e.search("resubscribe_billing_info")){if(this.browserUpdateRequired())return;I.IndividualUpdateBillingModalLoader.showInstance()}}displayAddScheduleModal(){const e=x.get_hash(),t=void 0!==e&&-1!==e.search("add_schedule"),a=B.URI.parse(x.get_href()).getQuery().modal;(t||a&&"add_schedule"===a)&&this.user.paid&&!this.browserUpdateRequired()&&this.props.trialsConfig&&!this.props.trialsConfig.hideBillingModal&&(_.AddScheduleModalView.showInstance({project:this.props.trialsConfig.project,productType:P.SkuContentClient.deserialize(this.props.trialsConfig.trialPlan.skuContent).dropboxDisplayName(),userId:this.user.id,skuCode:this.props.trialsConfig.trialPlan.skuCode,duration:this.props.trialsConfig.trialPlan.duration,billingId:this.props.billingInfo.payment_info.gateway_id}),b.ProEventsLogger.log("de_billing_tab_trigger_add_schedule_modal",{source:"redirect_url",project:this.props.trialsConfig.project}))}get subStatus(){const{serialized_sub_status:e}=this.props.billingInfo;if(e)return E.SubscriptionStatus.deserialize(e)}get isFamilyNonPayerPlan(){var e,t;return(null===(t=null===(e=this.subStatus)||void 0===e?void 0:e.subState.plan)||void 0===t?void 0:t.productType)===S.ProductPlanType.FAMILY_NONPAYER}get disallowChangesToCurrentBilling(){return!this.user.paid||this.isFamilyNonPayerPlan}checkTTIstate(){this.props.dataLoadedForTTI&&(N.mark_time_to_view(),N.mark_time_to_interactive())}isLoading(){return"ready"!==this.props.loadingState}render(){return this.isLoading()?n.default.createElement(o.Loading,null):n.default.createElement(F,{className:"account-page-tab"},this.renderPaymentMethod(),this.renderInvoiceDetails(),this.renderBillingHistory())}};U.displayName="BillingTabView",U=a.__decorate([M.eventHandler],U),t.BillingTabView=U;const q=i.connect((e,t)=>({browserUpdateRequired:t.browserUpdateRequired,billingInfo:e.billingInfo.billingInfo,loadingState:e.billingInfo.loadingState,dataLoadedForTTI:"ready"===e.billingInfo.loadingState}),e=>({loadBillingInfo:(t=!1)=>e(r.loadDataIfNecessary(t)),loadPlanDataIfNecessary:(t=!1,a)=>e(m.loadDataIfNecessary(t,a)),loadAddonsInfoIfNecessary:(t=!1)=>e(g.loadAddonsInfoIfNecessary(t)),loadAvailableAddonsInfoIfNecessary:(t=!1)=>e(g.loadAvailableAddonsInfoIfNecessary(t))}))(U);t.BillingTab=C.requireCssWithComponent(q,["/static/css/plan_management-vflirqNOR.css"]),t.moduleInit=function(e){},t.initialize_module=function(e){}})),define("modules/clean/account_page/widgets/billing/payment_methods_util",["require","exports","tslib","react","styled-components","modules/core/i18n","modules/constants/trademark","modules/clean/analytics","modules/clean/payments/skus/constants","modules/clean/payments/billing_instrument/payment_method_constants","modules/clean/payments/cash","modules/clean/payments/billing_instrument/payment_methods_util"],(function(e,t,a,n,i,s,l,o,r,d,c,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPaymentMethodDisabledMessage=t.getBillingDisabledMessage=t.getProfessionalTrialScheduleDescription=t.getProfessionalTrialPlanDescription=t.getTrialDescription=t.getAppleLink=t.shouldHideBillingSummary=t.shouldHideBillingChange=t.shouldHidePaymentMethod=void 0,n=a.__importDefault(n);const p=(i=a.__importDefault(i)).default.a`
  font-size: var(--type__body__small--fontsize);
  color: var(--color__dbx__blue--100);
  text-align: left;
  width: 500px;
`;function m(e){return[d.GOOGLE_PLAY_SUBSCRIPTION,d.IOS_ONE_TIME_PAYMENT,d.IOS_SANDBOX_ONE_TIME_PAYMENT,d.IOS_RECURRING_PAYMENT,d.IOS_SANDBOX_RECURRING_PAYMENT,d.NO_CHARGE_GATEWAY,d.RESELLER_LICENSE_KEY].includes(e)}function g(){o.ProEventsLogger.log("account_plan_ios_apple_cancel_help_clicked")}function _(){return n.default.createElement(p,{href:"https://support.apple.com/HT202039",target:"_blank",rel:"noopener noreferrer",onClick:g},s.intl.formatMessage({id:"KmMbqM",defaultMessage:"Learn how to manage your Apple App Store subscription"}))}t.shouldHidePaymentMethod=m,t.shouldHideBillingChange=function(e,t){return t||m(e)},t.shouldHideBillingSummary=function(e,t){const a=null==e?void 0:e.gateway_id;return a&&a===d.NO_CHARGE_GATEWAY&&t===r.ProductPlanType.FREE},t.getAppleLink=_,t.getTrialDescription=function(e,t,a){const i=u.isIOS(e);let o;o=t.is_trial_overdue?i?n.default.createElement("div",null,s.intl.formatMessage({id:"7ivi5Y",defaultMessage:"You started a Dropbox {plus} trial through the iOS app."},{plus:l.TRADEMARK_PLUS}),n.default.createElement("br",null),s.intl.formatMessage({id:"/4tX/Q",defaultMessage:"For billing details, please check your iTunes receipt."}),n.default.createElement("br",null),s.intl.formatMessage({id:"HZjsks",defaultMessage:"Your subscription is on an extension period."})):s.intl.formatMessage({id:"CABcgS",defaultMessage:"Your trial has expired but we were unable to process your credit card for the Dropbox {plus} upgrade."},{plus:l.TRADEMARK_PLUS}):t.is_close_to_trial_conversion?s.intl.formatMessage({id:"oJVrbs",defaultMessage:"Your trial will automatically upgrade to a Dropbox {plus} account in the next 48 hours."},{plus:l.TRADEMARK_PLUS}):s.intl.formatMessage({id:"AAPE8r",defaultMessage:"{num_days, plural, one{Your trial will automatically upgrade to a {dropbox_plus} account in {num_days} day.} other{Your trial will automatically upgrade to a {dropbox_plus} account in {num_days} days.}}"},{dropbox_plus:l.DROPBOX_PLUS,num_days:t.days_left});let r=n.default.createElement("noscript",null);return i&&!t.is_trial_overdue&&(r=_()),n.default.createElement("span",null,o,n.default.createElement("br",null),r)},t.getProfessionalTrialPlanDescription=function(e){if(e&&e.nextBillingSummary&&e.subState.billingSchedule)return s.intl.formatMessage({id:"QBzB1q",defaultMessage:"Starting on {conversion_date}, we’ll bill you once a {period_noun} for your Dropbox {professional} plan. Your new {period_adj} total will be {price}."},{professional:l.TRADEMARK_PROFESSIONAL,conversion_date:e.formattedNextBillingDate,period_noun:e.subState.billingSchedule.scheduleDescriptionNoun,period_adj:e.subState.billingSchedule.scheduleDescriptionAdjective,price:c.Cash.formatWithTaxLabels(e.nextBillingSummary.total,e.nextBillingSummary)})},t.getProfessionalTrialScheduleDescription=function(e){if(e&&e.nextBillingSummary&&e.subState.billingSchedule)return s.intl.formatMessage({id:"8WOGDU",defaultMessage:"Your Dropbox {professional} plan will convert on {conversion_date}. Your {period} total will be {price} (including taxes)."},{professional:l.TRADEMARK_PROFESSIONAL,conversion_date:e.formattedNextBillingDate,period:e.subState.billingSchedule.scheduleDescriptionAdjective,price:c.Cash.formatWithTaxLabels(e.nextBillingSummary.total,e.nextBillingSummary)})},t.getBillingDisabledMessage=function(e){return e.isResellerBilling?n.default.createElement("a",{href:e.resellerLink,target:"_blank",rel:"noopener noreferrer"},s.intl.formatMessage({id:"sCHiez",defaultMessage:"Go to {reseller_name} to view or make changes to your account details."},{reseller_name:e.resellerName})):e.gatewayId===d.GOOGLE_PLAY_SUBSCRIPTION?s.intl.formatMessage({id:"qmzNq4",defaultMessage:"You purchased Dropbox {dropbox_plan} through Google Play. To make changes to your subscription, visit the Google Play Store."},{dropbox_plan:e.dropboxPlan}):e.gatewayId===d.IOS_ONE_TIME_PAYMENT?s.intl.formatMessage({id:"9Oab9R",defaultMessage:"You purchased Dropbox {dropbox_plan} through the iOS app. Your plan will expire on {end_date}."},{dropbox_plan:e.dropboxPlan,end_date:e.endDate}):[d.IOS_RECURRING_PAYMENT,d.IOS_SANDBOX_RECURRING_PAYMENT].includes(e.gatewayId)?e.deactivated?s.intl.formatMessage({id:"TDhZyM",defaultMessage:"Your subscription from Apple is no longer active."}):e.isOnTrial?n.default.createElement("div",null,n.default.createElement("span",null,s.intl.formatMessage({id:"W5pK97",defaultMessage:"You started a Dropbox {dropbox_plan} trial through the iOS app."},{dropbox_plan:e.dropboxPlan})),n.default.createElement("br",null),_()):n.default.createElement("div",null,n.default.createElement("span",null,s.intl.formatMessage({id:"J5IeA4",defaultMessage:"You purchased Dropbox {dropbox_plan} through the iOS app."},{dropbox_plan:e.dropboxPlan})),n.default.createElement("br",null),_()):s.intl.formatMessage({id:"R8sDaj",defaultMessage:"Sorry, you cannot change your billing schedule at this time."})},t.getPaymentMethodDisabledMessage=function(e,t,a,i,l,o){return t?s.intl.formatMessage({id:"FN1EQh",defaultMessage:"You’re being externally billed."}):e===d.GOOGLE_PLAY_SUBSCRIPTION?s.intl.formatMessage({id:"qmzNq4",defaultMessage:"You purchased Dropbox {dropbox_plan} through Google Play. To make changes to your subscription, visit the Google Play Store."},{dropbox_plan:a}):e===d.IOS_ONE_TIME_PAYMENT?s.intl.formatMessage({id:"9Oab9R",defaultMessage:"You purchased Dropbox {dropbox_plan} through the iOS app. Your plan will expire on {end_date}."},{dropbox_plan:a,end_date:i}):[d.IOS_RECURRING_PAYMENT,d.IOS_SANDBOX_RECURRING_PAYMENT].includes(e)?l?s.intl.formatMessage({id:"TDhZyM",defaultMessage:"Your subscription from Apple is no longer active."}):o?n.default.createElement("div",null,n.default.createElement("span",null,s.intl.formatMessage({id:"W5pK97",defaultMessage:"You started a Dropbox {dropbox_plan} trial through the iOS app."},{dropbox_plan:a})),n.default.createElement("br",null),_()):n.default.createElement("div",null,n.default.createElement("span",null,s.intl.formatMessage({id:"J5IeA4",defaultMessage:"You purchased Dropbox {dropbox_plan} through the iOS app."},{dropbox_plan:a})),n.default.createElement("br",null),_()):s.intl.formatMessage({id:"R8sDaj",defaultMessage:"Sorry, you cannot change your billing schedule at this time."})}})),define("modules/clean/account_page/widgets/billing/action_creators",["require","exports","tslib","modules/clean/account_page/widgets/billing/api","modules/clean/active_user"],(function(e,t,a,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadDataIfNecessary=void 0,t.loadDataIfNecessary=function(e=!1){return(t,s)=>a.__awaiter(this,void 0,void 0,(function*(){if("never_loaded"===s().billingInfo.loadingState||e){t({type:"billing_info_load"});const e=yield n.getBillingInfo(i.mustGetActiveUserId());return t({type:"billing_info_loaded",billingInfo:e}),!0}return!1}))}})),define("modules/clean/account_page/widgets/billing/api",["require","exports","modules/clean/deprecated_ajax/ajax_as_promised_jquery"],(function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getBillingInfo=void 0,t.getBillingInfo=function(e){return a.WebRequest({url:"/account/ajax_billing_tab_model",subject_user:e,dataType:"json"})}})),define("modules/clean/account_page/widgets/billing/billing_history/api",["require","exports","tslib","modules/clean/deprecated_ajax/ajax_as_promised_jquery"],(function(e,t,a,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getBillingHistory=void 0,t.getBillingHistory=function(e,t,i,s){return a.__awaiter(this,void 0,void 0,(function*(){return n.WebRequest({url:"/account/ajax_load_more_billing_history/",data:{block:t,filter_type:i,filter_change:s},subject_user:e,dataType:"json"})}))}})),define("modules/clean/account_page/widgets/billing/billing_history/types",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BillingHistoryOrder=void 0,(function(e){e.ASCENDING="ASCENDING",e.DESCENDING="DESCENDING"})(t.BillingHistoryOrder||(t.BillingHistoryOrder={}))})),define("modules/clean/account_page/widgets/billing/views/billing_history",["require","exports","tslib","react","modules/core/i18n","modules/clean/active_user","modules/clean/teams/admin/widgets/billing_history/billing_history_table","modules/clean/teams/admin/lib/billing_history","modules/clean/analytics","modules/clean/account_page/widgets/billing/billing_history/api","modules/clean/account_page/widgets/billing/billing_history/types","dig-components/progress_indicators"],(function(e,t,a,n,i,s,l,o,r,d,c,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BillingHistory=void 0,n=a.__importDefault(n);class p extends n.default.Component{constructor(e){super(e),this.loadMoreBillingHistory=e=>a.__awaiter(this,void 0,void 0,(function*(){this.setState({isLoading:!0}),r.ProEventsLogger.log("de_billing_history_view_more_click"),e.preventDefault();const t=yield d.getBillingHistory(s.mustGetActiveUserId(),this.state.numBlocksLoaded,this.state.filter,!1);return this.setState(e=>({transactions:e.isInitialLoad?t.transactions:e.transactions.concat(t.transactions),hasMore:t.hasMore,isLoading:!1,numBlocksLoaded:e.numBlocksLoaded+1,isInitialLoad:!1})),!1})),this.changeFilter=e=>a.__awaiter(this,void 0,void 0,(function*(){this.setState({isLoading:!0,filter:e}),r.ProEventsLogger.log("de_billing_history_change_filter_click");const t=yield d.getBillingHistory(s.mustGetActiveUserId(),this.state.numBlocksLoaded,e,!0);if(this.state.isInitialLoad){const e=o.getHistoryData(t.transactions);t.hasMore=e.length>3}return this.setState(e=>({transactions:t.transactions,hasMore:t.hasMore,isLoading:!1,numBlocksLoaded:e.numBlocksLoaded,isInitialLoad:e.isInitialLoad})),!1})),this.changeOrder=()=>{this.setState(e=>({order:e.order===c.BillingHistoryOrder.ASCENDING?c.BillingHistoryOrder.DESCENDING:c.BillingHistoryOrder.ASCENDING})),r.ProEventsLogger.log("de_billing_history_change_order_click")},this.handlePopoverSelection=e=>{this.state.filter!==e&&this.state.order!==e&&(e===c.BillingHistoryOrder.ASCENDING||e===c.BillingHistoryOrder.DESCENDING?this.changeOrder():this.changeFilter(e))},this.state={transactions:this.props.transactions?this.props.transactions.slice():[],hasMore:this.props.hasMore,isLoading:!1,numBlocksLoaded:0,isInitialLoad:!0,filter:"all_time",order:c.BillingHistoryOrder.ASCENDING}}render(){return n.default.createElement("div",{className:"account-page-block"},n.default.createElement("span",{className:"account-page-block__heading"},i.intl.formatMessage({id:"h9UTH1",defaultMessage:"Billing history"})),n.default.createElement("p",{className:"account-page-block__subtext"},i.intl.formatMessage({id:"efUvgd",defaultMessage:"View invoices and receipts for all payments made on your Dropbox account."})),n.default.createElement("div",{className:"billing-table-container"},n.default.createElement(l.BillingHistoryTable,{billingHistoryRecords:this.getHistory(),amountLabel:i.intl.formatMessage({id:"Q9yFMv",defaultMessage:"Amount"}),displayNoTransactionsOnEmptyRecords:!0,showEditInvoiceModal:this.props.showEditInvoiceModal,noTransactionLabel:i.intl.formatMessage({id:"lj3d2i",defaultMessage:"No transaction history"}),footer:this.buildFooter(),logAccountBillingTabEvents:!0,isTeam:!1,filter:this.state.filter,order:this.state.order,onSelection:this.handlePopoverSelection,filters:this.props.filters})))}getHistory(){let e=[];return this.state.transactions.length>0&&(e=o.getHistoryData(this.state.transactions),this.state.isInitialLoad&&(e=e.slice(0,3))),this.state.order===c.BillingHistoryOrder.ASCENDING?e:e.reverse()}buildFooter(){return this.state.isLoading?n.default.createElement("tr",{className:"billing-history-row"},n.default.createElement("td",{colSpan:4,className:"billing-history-col"},n.default.createElement(u.Spinner,{size:"small","aria-valuetext":i.intl.formatMessage({id:"jybGUg",defaultMessage:"Loading"})}))):this.state.hasMore?n.default.createElement("tr",{className:"billing-history-row"},n.default.createElement("td",{colSpan:4,className:"billing-history-col"},n.default.createElement("a",{href:"#",className:"account-page__link",rel:"noopener noreferrer",onClick:this.loadMoreBillingHistory},i.intl.formatMessage({id:"Td8CMX",defaultMessage:"View more billing history"})))):void 0}}t.BillingHistory=p,p.displayName="BillingHistory"})),define("modules/clean/account_page/widgets/billing/views/invoice_details",["require","exports","tslib","react","modules/core/i18n","modules/clean/account_page/components/key_value_block","modules/clean/payments/validation"],(function(e,t,a,n,i,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InvoiceDetails=void 0,n=a.__importDefault(n);class o extends n.default.Component{render(){const{country_code:e,has_invoice_details:t}=this.props;let a=i.intl.formatMessage({id:"uD4mCH",defaultMessage:"Add details to your invoice, such as company name and address."});e&&l.hasVat(e)&&(a=i.intl.formatMessage({id:"uhx0D0",defaultMessage:"Add details to your invoice, such as company name, address, and VAT ID."}));const o=t?i.intl.formatMessage({id:"+5HiT6",defaultMessage:"Update"}):i.intl.formatMessage({id:"VLPo6o",defaultMessage:"Add invoice details"});return n.default.createElement(s.KeyValueBlock,{className:"jest-invoice-details",keyText:i.intl.formatMessage({id:"IyXKYR",defaultMessage:"Invoice details"}),linkText:o,subtext:a,onLinkClick:this.props.onLinkClick})}}t.InvoiceDetails=o,o.displayName="InvoiceDetails"})),define("modules/clean/account_page/widgets/plan/action_creators",["require","exports","tslib","modules/clean/account_page/widgets/plan/api","modules/clean/active_user"],(function(e,t,a,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadDataIfNecessary=void 0,t.loadDataIfNecessary=function(e,t){return(s,l)=>a.__awaiter(this,void 0,void 0,(function*(){if("never_loaded"===l().planTab.loadingState||e){t||s({type:"plan_tab_load_info"});const e=yield n.getPlanInfo(i.mustGetActiveUserId());return s({type:"plan_tab_info_loaded",planInfo:e}),!0}return!1}))}})),define("modules/clean/account_page/widgets/plan/add_ons/action_creators",["require","exports","tslib","modules/clean/active_user","modules/clean/account_page/widgets/plan/add_ons/api"],(function(e,t,a,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadAvailableAddonsInfoIfNecessary=t.loadAddonsInfoIfNecessary=void 0,t.loadAddonsInfoIfNecessary=function(e,t){return(s,l)=>a.__awaiter(this,void 0,void 0,(function*(){if("never_loaded"===l().planTab.addonsLoadingState||e){let e;if(s({type:"load_addons_info"}),t){const t=new i.AddonsInfoTeamClient;e=yield t.getCurrentAddonsInfoForTeam(n.mustGetActiveUserId())}else{const t=new i.AddonsInfoClient;e=yield t.getCurrentAddonsInfo(n.mustGetActiveUserId())}return s({type:"addons_info_loaded",addonsInfo:e.addons_info}),!0}return!1}))},t.loadAvailableAddonsInfoIfNecessary=function(e){return(t,s)=>a.__awaiter(this,void 0,void 0,(function*(){if("never_loaded"===s().planTab.availableAddonsLoadingState||e){t({type:"load_available_addons_info"});const e=new i.AddonsInfoClient,a=yield e.getAvailableAddonsInfo(n.mustGetActiveUserId());return t({type:"available_addons_info_loaded",availableAddonsInfo:a.available_addons_info}),!0}return!1}))}})),define("modules/clean/account_page/widgets/plan/add_ons/api",["require","exports","api_v2/user_client","api_v2/team_client","modules/clean/viewer"],(function(e,t,a,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.performAddonTransition=t.getAddonTransitionPreview=t.AddonsInfoTeamClient=t.AddonsInfoClient=void 0;class s extends a.UserApiV2Client{getCurrentAddonsInfo(e){return this.ns("growth_plans").rpc("get_current_addons_info",void 0,{subjectUserId:e})}getAvailableAddonsInfo(e){return this.ns("growth_plans").rpc("get_available_addons_info",void 0,{subjectUserId:e})}getAddonTransitionPreview(e,t){return this.ns("growth_plans").rpc("get_addon_transition_preview",t,{subjectUserId:e})}performAddonTransition(e,t){return this.ns("growth_plans").rpc("perform_addon_transition",t,{subjectUserId:e})}}t.AddonsInfoClient=s;class l extends n.TeamApiV2Client{getCurrentAddonsInfoForTeam(e){return this.ns("growth_plans").rpc("get_current_addons_info_for_team",void 0,{subjectUserId:e})}getAvailableAddonsInfoForTeam(e){return this.ns("growth_plans").rpc("get_available_addons_info_for_team",void 0,{subjectUserId:e})}getAddonTransitionPreviewForTeam(e,t){return this.ns("growth_plans").rpc("get_addon_transition_preview_for_team",t,{subjectUserId:e})}performAddonTransitionForTeam(e,t){return this.ns("growth_plans").rpc("perform_addon_transition_for_team",t,{subjectUserId:e})}}t.AddonsInfoTeamClient=l,t.getAddonTransitionPreview=(e,t,a)=>o(e)?(new s).getAddonTransitionPreview(t,a):(new l).getAddonTransitionPreviewForTeam(t,a),t.performAddonTransition=(e,t,a)=>o(e)?(new s).performAddonTransition(t,a):(new l).performAddonTransitionForTeam(t,a);const o=e=>{const t=i.Viewer.get_viewer();return"personal"===e||t.team_is_limited}})),define("modules/clean/account_page/widgets/plan/api",["require","exports","tslib","modules/clean/deprecated_ajax/ajax_as_promised_jquery","api_v2/default_user_client","apiql/client/apollo","modules/clean/active_user"],(function(e,t,a,n,i,s,l){"use strict";let o;function r(){return o||(o=s.createApolloClient(l.mustGetActiveUserId(),{connectToDevTools:!0})),o}Object.defineProperty(t,"__esModule",{value:!0}),t.resetApolloStore=t.getApolloClient=t.getFamilyQuotaInfo=t.getPlanInfo=void 0,t.getPlanInfo=function(e){return a.__awaiter(this,void 0,void 0,(function*(){return n.WebRequest({url:"/account/ajax_plan_tab_model",subject_user:e,dataType:"json"})}))},t.getFamilyQuotaInfo=function(e){return a.__awaiter(this,void 0,void 0,(function*(){const t=new i.DefaultUserApiV2Client(e);return(yield t.ns("users").rpc("get_current_account",void 0,{})).family_quota_info}))},t.getApolloClient=r,t.resetApolloStore=function(){r().resetStore()}})),define("modules/clean/account_page/widgets/plan/notifications/action_creators",["require","exports","tslib"],(function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setProductChangeNotificationSeen=t.setCancellationNotificationSeen=void 0,t.setCancellationNotificationSeen=function(){return e=>a.__awaiter(this,void 0,void 0,(function*(){return e({type:"cancellation_notification_seen"}),!0}))},t.setProductChangeNotificationSeen=function(){return e=>a.__awaiter(this,void 0,void 0,(function*(){return e({type:"product_change_notification_seen"}),!0}))}})),define("modules/clean/account_page/widgets/plan/constants",["require","exports","modules/clean/payments/skus/constants"],(function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.planTypeToUpgrades=t.CHANGE_IND_PLAN_MODAL_UPDATED=void 0,t.CHANGE_IND_PLAN_MODAL_UPDATED="change_inv_plan_modal:updated",t.planTypeToUpgrades={[a.ProductPlanType.FAMILY_PAYER]:[a.ProductPlanType.PROFESSIONAL],[a.ProductPlanType.PROFESSIONAL]:[a.ProductPlanType.FAMILY_PAYER,a.ProductPlanType.HS_DBX_PRO_BUNDLE],[a.ProductPlanType.PLUS]:[a.ProductPlanType.PROFESSIONAL,a.ProductPlanType.FAMILY_PAYER,a.ProductPlanType.HS_DBX_PRO_BUNDLE],[a.ProductPlanType.STANDARD]:[a.ProductPlanType.PROFESSIONAL,a.ProductPlanType.FAMILY_PAYER,a.ProductPlanType.HS_DBX_PRO_BUNDLE],[a.ProductPlanType.TRANSFER]:[a.ProductPlanType.PROFESSIONAL],[a.ProductPlanType.SYNC_EVERYTHING]:[a.ProductPlanType.PLUS,a.ProductPlanType.PROFESSIONAL]}})),define("modules/clean/account_page/widgets/plan/revenue_api_migration_utils",["require","exports","tslib","lodash","modules/core/exception","modules/clean/metrics/index","modules/clean/payments/billing_instrument/payment_method_constants","apiql/client/components/account-gql","modules/clean/payments/skus/constants"],(function(e,t,a,n,i,s,l,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.compareScheduledPlan=t.filterRevAPIScheduledPlan=t.convertLegacyScheduledPlan=t.isAccountScheduledPlanResult=t.compareCurrentPlan=t.filterRevAPICurrentPlan=t.convertLegacyCurrentPlan=t.isAccountCurrentPlanResult=t.comparePaymentInfo=t.filterRevAPIPaymentInfo=t.convertLegacyPaymentInfo=t.isAccountPaymentInfoResult=t.compareChangePlanPreviewData=t.filterRevAPIChangePlanPreviewData=t.convertLegacyChangePlanPreviewData=t.isAccountChangePlanPreviewResult=t.compareAvailablePlansData=t.convertLegacyAvailablePlansData=t.legacyProductTypeToProductFamily=t.isAccountAvailablePlansResult=t.recordRevAPIConsistencyStats=t.reportRevAPIException=t.PersonalPlanManagementRoutes=t.RevAPIConsistencyException=void 0;const d={INDIVIDUAL_BASIC:[[r.ProductFamily.PRO,r.ProductPlanType.BASIC]],FAMILY:[[r.ProductFamily.FAMILY,r.ProductPlanType.FAMILY_PAYER]],PLUS:[[r.ProductFamily.PRO,r.ProductPlanType.PLUS]],PROFESSIONAL:[[r.ProductFamily.PRO,r.ProductPlanType.PROFESSIONAL]],TRANSFER:[[r.ProductFamily.PRO,r.ProductPlanType.TRANSFER]],BACKUP:[[r.ProductFamily.PRO,r.ProductPlanType.SYNC_EVERYTHING]],HELLOSIGN_PRO_BUNDLE:[[r.ProductFamily.PRO,r.ProductPlanType.HS_DBX_PRO_BUNDLE]],TEAM_BASIC:[[r.ProductFamily.TEAM,r.ProductPlanType.BASIC]],STANDARD:[[r.ProductFamily.TEAM,r.ProductPlanType.NEW_STANDARD]],ADVANCED:[[r.ProductFamily.TEAM,r.ProductPlanType.ADVANCED]],SERVER:[[r.ProductFamily.TEAM,r.ProductPlanType.SERVER]],ENTERPRISE:[[r.ProductFamily.ENTERPRISE,r.ProductPlanType.NEW_STANDARD],[r.ProductFamily.ENTERPRISE,r.ProductPlanType.SERVER]],EDUCATION:[[r.ProductFamily.EDUCATION,r.ProductPlanType.STANDARD]],TEAM_DEPRECATED:[[r.ProductFamily.TEAM,r.ProductPlanType.STANDARD],[r.ProductFamily.ENTERPRISE,r.ProductPlanType.STANDARD]]};class c extends Error{constructor(e){super(e),this.name="RevAPIConsistencyException"}}var u;t.RevAPIConsistencyException=c,(function(e){e.GET_AVAILABLE_PLANS="get_available_plans",e.GET_CHANGE_PLAN_PREVIEW="get_change_plan_preview",e.GET_PAYMENT_INFO="get_payment_info",e.GET_CURRENT_PLAN="get_current_plan",e.GET_SCHEDULED_PLAN="get_scheduled_plan"})(u=t.PersonalPlanManagementRoutes||(t.PersonalPlanManagementRoutes={})),t.reportRevAPIException=(e,t)=>{const a={};if(t)for(const e of Object.keys(t))a["mismatch_"+e]=t[e];i.reportException({err:new c(e),severity:i.SEVERITY.NONCRITICAL,tags:["rev_api_migration_pa"],exc_extra:a})},t.recordRevAPIConsistencyStats=(e,t)=>{s.getMetricsReporter().createStats({ns:"personal_plan_management",name:`revapi_consistency/${t}`}).record(e?1:0)},t.isAccountAvailablePlansResult=e=>Boolean(e&&"AccountAvailablePlansResult"===e.__typename),t.legacyProductTypeToProductFamily=(e,t)=>{let a;for(a in d)if(a)for(const n of d[a]){if(!n)continue;const[i,s]=n;if(i===e&&s===t)return a}return"UNKNOWN_PRODUCT_FAMILY"},t.convertLegacyAvailablePlansData=function(e){if(e)return e.map(e=>({advertised_contract_length_price:e.displayCost.formatCurrency(),advertised_space_short_tb:e.formattedSpecQuotaGb,contract_length_quantity:1,contract_length_unit:e.scheduleDescription.toUpperCase(),dropbox_brand_display_name:`Dropbox ${e.displayName()}`,offering_id:e.code,product_family:t.legacyProductTypeToProductFamily(e.productFamily,e.productType)}))},t.compareAvailablePlansData=(e,a,i)=>{let s=!0;const l=e.map(e=>e.offering_id),o=a.map(e=>e.offering_id);n.isEqual(l,o)||(s=!1,t.reportRevAPIException("Different number of available plans",Object.assign({revAPIPlanIDs:l,legacyPlanIDs:o},i))),s&&a.forEach((a,n)=>{let l;for(l in a)"__typename"!==l&&p(a[l])!==p(e[n][l])&&(s=!1,t.reportRevAPIException("Mismatch Catalog and RevAPI available plans data",Object.assign({property:l,revAPIValue:e[n][l],legacyAPIValue:a[l],revAPIOfferingID:e[n].offering_id,legacyOfferingID:a.offering_id},i)))}),t.recordRevAPIConsistencyStats(s,u.GET_AVAILABLE_PLANS)};const p=e=>"string"==typeof e?0===e.indexOf("AU$")?"":e.replace(/\s/g,"").replace(/\./g,",").replace(",00",""):e;t.isAccountChangePlanPreviewResult=e=>Boolean(e&&"AccountChangePlanPreviewResult"===e.__typename),t.convertLegacyChangePlanPreviewData=function(e){if(e)return{immediate_price:e.formatted_prorated_price,offering_id:e.sku_code,preview_request_token:"",tax_included_in_total_amount:e.price_includes_tax,upcoming_bill_date:e.formatted_long_date,upcoming_bill_total_price:e.formatted_total_price,vat_id:e.vat}},t.filterRevAPIChangePlanPreviewData=e=>({immediate_price:e.immediate_price,offering_id:e.offering_id,preview_request_token:"",tax_included_in_total_amount:e.tax_included_in_total_amount,upcoming_bill_date:e.upcoming_bill_date,upcoming_bill_total_price:e.upcoming_bill_total_price,vat_id:e.vat_id}),t.compareChangePlanPreviewData=(e,a,i,s)=>{const l=t.filterRevAPIChangePlanPreviewData(i);let o=!0;if(!n.isEqual(s,l)){let n;for(n in s)p(s[n])!==p(l[n])&&(o=!1,t.reportRevAPIException("Mismatch Legacy and RevAPI change plan preview data",{property:n,revAPIValue:l[n],legacyAPIValue:s[n],scheduledUserPlanID:e,chosenPlanID:a}))}t.recordRevAPIConsistencyStats(o,u.GET_CHANGE_PLAN_PREVIEW)},t.isAccountPaymentInfoResult=e=>Boolean(e&&"AccountPaymentInfoResult"===e.__typename),t.convertLegacyPaymentInfo=function(e){if(!e)return;let t,a="unknown"===e.account?null:e.account.slice(-4),n=!0,i=null;switch(e.gateway_id){case l.BRAINTREE:t=o.AccountPaymentInfoType.Card,i=e.type;break;case l.ADYEN_SEPA_GATEWAY:t=o.AccountPaymentInfoType.Sepa;break;case l.ADYEN_IDEAL_GATEWAY:t=o.AccountPaymentInfoType.Ideal;break;case l.PAYPAL_REFERENCE_TRANSACTION:t=o.AccountPaymentInfoType.Paypal,a=null;break;default:t=o.AccountPaymentInfoType.Unknown,n=!1}return{active_payment_method_type:t,last_digits:a,vat_country_code:e.country_code,can_update_payment_method_via_web_storefront:n,credit_type:i}},t.filterRevAPIPaymentInfo=e=>({active_payment_method_type:e.active_payment_method_type,last_digits:e.last_digits,vat_country_code:e.vat_country_code,can_update_payment_method_via_web_storefront:e.can_update_payment_method_via_web_storefront,credit_type:e.credit_type}),t.comparePaymentInfo=(e,a)=>{const i=t.filterRevAPIPaymentInfo(e),s=n.isEqual(a,i);if(!s){let e;for(e in a)a[e]!==i[e]&&t.reportRevAPIException("Mismatch Legacy and RevAPI payment info",{property:e,revAPIValue:i[e],legacyAPIValue:a[e]})}t.recordRevAPIConsistencyStats(s,u.GET_PAYMENT_INFO)},t.isAccountCurrentPlanResult=e=>Boolean(e&&"AccountCurrentPlanResult"===e.__typename),t.convertLegacyCurrentPlan=function(e){const t=null==e?void 0:e.subState;if(!e||!t)return;const a=t.plan;if(!a)return;const n=m(a);return Object.assign(Object.assign({},n),{contract_interval_end:t.formattedNextBillingDate,total_addon_offerings:[]})},t.filterRevAPICurrentPlan=e=>{const{__typename:t,advertised_space_long_rounded:n}=e,i=a.__rest(e,["__typename","advertised_space_long_rounded"]);return Object.assign(Object.assign({},i),{total_addon_offerings:[]})},t.compareCurrentPlan=(e,a)=>{const i=t.filterRevAPICurrentPlan(e),s=n.isEqual(a,i);if(!s){let e;for(e in a){const s=p(a[e]),l=p(i[e]);n.isEqual(s,l)||t.reportRevAPIException("Mismatch Legacy and RevAPI current plan info",{property:e,revAPIValue:l,legacyAPIValue:s})}}t.recordRevAPIConsistencyStats(s,u.GET_CURRENT_PLAN)},t.isAccountScheduledPlanResult=e=>Boolean(e&&"AccountScheduledPlanResult"===e.__typename),t.convertLegacyScheduledPlan=function(e,t){var a;const n=null==e?void 0:e.scheduledSubState,i=null==e?void 0:e.subState;if(!e||!n||!i)return;const s=n.plan;if(!s)return;const l=m(s),o=null===(a=e.nextBillingSummary)||void 0===a?void 0:a.total;return Object.assign(Object.assign({},l),{total_addon_offerings:[],scheduled_downgrade_to_basic:t,upcoming_billing_date:i.formattedNextBillingDate,upcoming_billing_total_amount:o?o.formatCurrency():"NO TOTAL PROVIDED"})},t.filterRevAPIScheduledPlan=e=>{const{__typename:t}=e,n=a.__rest(e,["__typename"]);return Object.assign(Object.assign({},n),{total_addon_offerings:[]})},t.compareScheduledPlan=(e,a)=>{const i=t.filterRevAPIScheduledPlan(e),s=n.isEqual(a,i);if(!s){let e;for(e in a){const s=p(a[e]),l=p(i[e]);n.isEqual(s,l)||t.reportRevAPIException("Mismatch Legacy and RevAPI scheduled plan info",{property:e,revAPIValue:l,legacyAPIValue:s})}}t.recordRevAPIConsistencyStats(s,u.GET_SCHEDULED_PLAN)};const m=e=>({advertised_space_short_tb:e.formattedSpecQuotaGb||"",contract_length_quantity:1,contract_length_unit:e.scheduleDescription.toUpperCase(),dropbox_brand_display_name:e.displayUntranslatableNameDirectFromSku,offering_id:e.code,product_family:t.legacyProductTypeToProductFamily(e.productFamily,e.productType)})})),define("modules/clean/account_page/widgets/plan/revenue_api_migration_comparisons",["require","exports","apiql/client/components/account-gql","modules/clean/account_page/widgets/plan/revenue_api_migration_utils","react"],(function(e,t,a,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CompareRevApiScheduledPlan=t.CompareRevApiCurrentPlan=t.CompareRevApiChangePlanPreview=t.CompareRevApiAvailablePlans=t.CompareRevApiPaymentInfo=void 0,t.CompareRevApiPaymentInfo=e=>{const{loading:t,error:s,data:l}=a.useGetAccountPaymentInfoQuery();return i.useEffect(()=>{const a=l&&l.account_payment_info&&n.isAccountPaymentInfoResult(l.account_payment_info)?l.account_payment_info:void 0;if(s)return n.recordRevAPIConsistencyStats(!1,n.PersonalPlanManagementRoutes.GET_PAYMENT_INFO),void n.reportRevAPIException("Error loading payment info",{error:s});!t&&a&&e.legacyPaymentInfo&&n.comparePaymentInfo(a,e.legacyPaymentInfo)},[t,e.legacyPaymentInfo]),null},t.CompareRevApiAvailablePlans=e=>{const{loading:t,error:s,data:l}=a.useGetAccountAvailablePlansQuery({variables:{filter_product_family:e.filterProductFamily,filter_contract_length:e.filterContractLength}}),o={context:e.context,userUpcomingPlanID:e.upcomingPlanId};return i.useEffect(()=>{const a=l&&l.account_available_plans&&n.isAccountAvailablePlansResult(l.account_available_plans)?l.account_available_plans:void 0;if(s)return n.recordRevAPIConsistencyStats(!1,n.PersonalPlanManagementRoutes.GET_AVAILABLE_PLANS),void n.reportRevAPIException("Error loading available plans data",Object.assign({error:s},o));!t&&a&&e.legacyAvailablePlans&&(a.available_plans?n.compareAvailablePlansData(a.available_plans,e.legacyAvailablePlans,o):(n.recordRevAPIConsistencyStats(!1,n.PersonalPlanManagementRoutes.GET_AVAILABLE_PLANS),n.reportRevAPIException("Available plans list not provided",Object.assign({error:s},o))))},[t,e.legacyAvailablePlans]),null},t.CompareRevApiChangePlanPreview=e=>{const{loading:t,error:s,data:l}=a.useGetAccountChangePlanPreviewQuery({variables:{offering_id:e.offeringId,vat_id:e.vatId}});return i.useEffect(()=>{const a=l&&l.account_change_plan_preview&&n.isAccountChangePlanPreviewResult(l.account_change_plan_preview)?l.account_change_plan_preview:void 0;if(s)return n.recordRevAPIConsistencyStats(!1,n.PersonalPlanManagementRoutes.GET_CHANGE_PLAN_PREVIEW),void n.reportRevAPIException("Error loading change plan preview data",{error:s});!t&&a&&e.legacyChangePlanPreviewData&&n.compareChangePlanPreviewData(e.scheduledPlanID,e.offeringId,a,e.legacyChangePlanPreviewData)},[t,e.legacyChangePlanPreviewData]),null},t.CompareRevApiCurrentPlan=e=>{const{loading:t,error:s,data:l}=a.useGetAccountCurrentPlanQuery({variables:{should_hide_pricing_info:e.shouldHidePricingInfo}});return i.useEffect(()=>{const a=l&&l.account_current_plan&&n.isAccountCurrentPlanResult(l.account_current_plan)?l.account_current_plan:void 0;if(s)return n.recordRevAPIConsistencyStats(!1,n.PersonalPlanManagementRoutes.GET_CURRENT_PLAN),void n.reportRevAPIException("Error loading current plan ",{error:s});!t&&a&&e.legacyCurrentPlanInfo&&n.compareCurrentPlan(a,e.legacyCurrentPlanInfo)},[t,e.legacyCurrentPlanInfo]),null},t.CompareRevApiScheduledPlan=e=>{const{loading:t,error:s,data:l}=a.useGetAccountScheduledPlanQuery({variables:{should_hide_pricing_info:e.shouldHidePricingInfo}});return i.useEffect(()=>{const a=l&&l.account_scheduled_plan&&n.isAccountScheduledPlanResult(l.account_scheduled_plan)?l.account_scheduled_plan:void 0;if(s)return n.recordRevAPIConsistencyStats(!1,n.PersonalPlanManagementRoutes.GET_SCHEDULED_PLAN),void n.reportRevAPIException("Error loading scheduled plan",{error:s});!t&&a&&e.legacyScheduledPlanInfo&&n.compareScheduledPlan(a,e.legacyScheduledPlanInfo)},[t,e.legacyScheduledPlanInfo]),null}})),define("modules/clean/account_page/widgets/plan/strings",["require","exports","react-intl","modules/core/i18n","modules/clean/payments/skus/constants","modules/clean/payments/cash","modules/clean/family/constants","modules/clean/account_page/constants","modules/clean/display_format","dropbox/proto/storefront_platform_js_init_data/types"],(function(e,t,a,n,i,s,l,o,r,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getResubscribeUpsellDescription=t.getResubscribeUpsellPlanDetailsButtonText=t.getResubscribeUpsellResubscribeButtonText=t.getDowngradeSnackbarMessage=t.CANCEL_DESCRIPTION=t.getPaidPlanScheduledToCancelDescription=t.getPlanFeatureDescription=t.getPaidPlanDefaultDescription=t.getPriceBreakdownByPlan=t.getPaidPlanDefaultBillingSummary=t.getPaidPlanName=t.getLockedTeamPlanName=void 0;var c=d.storefront_platform.StorefrontPlatformContractLengthUnit;t.getLockedTeamPlanName=(e,t)=>{const a=e?n.intl.formatMessage({id:"h2UqcJ",defaultMessage:"(team downgraded)"}):n.intl.formatMessage({id:"LGoRkl",defaultMessage:"(trial ended)"});return n.intl.formatMessage({id:"3onAtc",defaultMessage:"{plan_name} {downgraded_text}"},{plan_name:t,downgraded_text:a})},t.getPaidPlanName=(e,t,a)=>{let s,l;return 1024===e.specQuotaGb||e.productFamily===i.ProductFamily.FAMILY?(s=e.displayName(!1,!1,a),l=n.intl.formatMessage({id:"Trr3KV",defaultMessage:"Dropbox {plan}"},{plan:s})):l=e.displayName(!0),l},t.getPaidPlanDefaultBillingSummary=(e,t)=>{let a="";return(null==t?void 0:t.scheduleDescriptionNoun)&&(null==e?void 0:e.total)&&(a=n.intl.formatMessage({id:"fRlyEz",defaultMessage:"{total} per {period}."},{total:s.Cash.formatWithTaxLabels(e.total,e),period:t.scheduleDescriptionNoun})),a},t.getPriceBreakdownByPlan=(e,t,a)=>{if(!t||!e||!a)return"";return e.lineItems.find(e=>e.sku.productType===a.productType)?n.intl.formatMessage({id:"Sd6QRw",defaultMessage:"{total} per {period}."},{total:a.displayCost.formatCurrency(),period:t.scheduleDescriptionNoun}):""},t.getPaidPlanDefaultDescription=(e,t,a,i)=>{let s;return s=i?n.intl.formatMessage({id:"pO8IP6",defaultMessage:"Your {plan} plan will renew on {date}. {billing_summary}"},{plan:e,date:a,billing_summary:t}):n.intl.formatMessage({id:"Ofo1Y4",defaultMessage:"This account’s {plan} plan will renew on {date}. {billing_summary}"},{plan:e,date:a,billing_summary:t}),s},t.getPlanFeatureDescription=(e,t)=>{const a=e.content&&e.content.spaceShortFormTb();switch(e.productType){case i.ProductPlanType.STANDARD:case i.ProductPlanType.PLUS:return a?n.intl.formatMessage({id:"gK4PxX",defaultMessage:"Smart Sync, stress-free sharing, offline folders on mobile, and {plan_space} storage."},{plan_space:a}):n.intl.formatMessage({id:"/Jj95M",defaultMessage:"Smart Sync, stress-free sharing, offline folders on mobile."});case i.ProductPlanType.HS_DBX_PRO_BUNDLE:return a&&(null==t?void 0:t.isEsignUpsell)?n.intl.formatMessage({id:"7XEHpu",defaultMessage:"Includes {space} of storage and unlimited e-signatures. Up to 20% off vs. buying each separately."},{space:a}):n.intl.formatMessage({id:"IXOQ0a",defaultMessage:"Includes Dropbox Pro and unlimited e-signatures with HelloSign Essentials."});case i.ProductPlanType.PROFESSIONAL:return a?n.intl.formatMessage({id:"Muci4i",defaultMessage:"Everything in Plus, shared link controls, and {plan_space} storage."},{plan_space:a}):n.intl.formatMessage({id:"wULqRj",defaultMessage:"Everything in Plus, with shared link controls."},{plan_space:a});case i.ProductPlanType.FAMILY_PAYER:return n.intl.formatMessage({id:"9Ru4ky",defaultMessage:"{count, plural, one{Up to {count} member, easy family sharing, and {plan_space} storage.} other{Up to {count} members, easy family sharing, and {plan_space} storage.}}"},{count:l.MAX_LICENSES,plan_space:a});case i.ProductPlanType.TRANSFER:return n.intl.formatMessage({id:"4k1fvl",defaultMessage:"Send transfers up to {transfer_send_size_limit} at a time with password protection and customized experiences."},{transfer_send_size_limit:r.format_bytes(100*o.GIGABYTE_IN_BYTES,2,!0,!0,!1)});case i.ProductPlanType.SYNC_EVERYTHING:return n.intl.formatMessage({id:"ACkjCJ",defaultMessage:"Automatic backup and recovery protection for one device."})}return""},t.getPaidPlanScheduledToCancelDescription=(e,t,a)=>{let i;return i=a?n.intl.formatMessage({id:"DbT6E7",defaultMessage:"Your {plan} will downgrade to Dropbox Basic on {date}."},{plan:e,date:t}):n.intl.formatMessage({id:"KxyGh1",defaultMessage:"This account’s {plan} will downgrade to Dropbox Basic on {date}."},{plan:e,date:t}),i},t.CANCEL_DESCRIPTION=a.defineMessages({default_plan:{id:"XHP8sT",defaultMessage:"If you cancel your plan, your account will drop from {quota} to {basic_space_short_form_gb} of space (plus any bonus space earned previously)."},default_plan_with_addon_warning:{id:"n0hWtQ",defaultMessage:"If you cancel your plan, your account will drop from {quota} to {basic_space_short_form_gb} of space (plus any bonus space earned previously), and any add-ons will be removed."},family_non_payer_no_shared_folder:{id:"kBU+3Q",defaultMessage:"Your account will be downgraded to {dropbox_basic}, and you’ll lose access to {trademark_family} storage and features."},family_non_payer_with_shared_folder:{id:"JuNSrl",defaultMessage:"Your account will be downgraded to {dropbox_basic}, and you’ll lose access to the plan’s storage, features, and the Family Room folder."},family_payer_no_shared_folder:{id:"VGD5gM",defaultMessage:"You and your family members will be downgraded to {dropbox_basic}, and you’ll lose access to the plan’s features."},family_payer_with_shared_folder:{id:"OpkK4e",defaultMessage:"You and your family will be downgraded to {dropbox_basic}, and you’ll lose access to the plan’s storage, features, and the Family Room folder."},backup:{id:"7xDVJJ",defaultMessage:"If you cancel your plan, your computer backup will remain available but it’ll be limited to the {basic_space_short_form_gb} storage quota of the {dropbox_basic} plan. If you exceed your quota, automatic backups will stop."},transfer:{id:"rYm7Gd",defaultMessage:"If you cancel your plan, you’ll lose access to your {transfer_send_size_limit} send size, as well as custom expiration dates, passwords, and branding. Any existing transfer stats, logos, and custom backgrounds will be removed. Expired transfers older than 30 days will be permanently deleted."},other_addon_warning:{id:"0jUnCn",defaultMessage:"Any current add-ons will be removed."}}),t.getDowngradeSnackbarMessage=e=>e?n.intl.formatMessage({id:"K7hrab",defaultMessage:"Done! Your paid plan will end on {endDate}. You won't be charged again."},{endDate:e}):n.intl.formatMessage({id:"tL5Ofr",defaultMessage:"Done! Your paid plan has been cancelled. You won't be charged again."}),t.getResubscribeUpsellResubscribeButtonText=()=>n.intl.formatMessage({id:"vEt76n",defaultMessage:"Resubscribe"}),t.getResubscribeUpsellPlanDetailsButtonText=()=>n.intl.formatMessage({id:"06582P",defaultMessage:"See plan details"}),t.getResubscribeUpsellDescription=(e,t,a,i)=>{const s=n.intl.formatMessage({id:"ZydEtp",defaultMessage:"You cancelled {planName} on {endDate}. Resubscribe for {billingPrice} per month."},{planName:e,endDate:t,billingPrice:a}),l=n.intl.formatMessage({id:"P1UfTK",defaultMessage:"You cancelled {planName} on {endDate}. Resubscribe for {billingPrice} per year."},{planName:e,endDate:t,billingPrice:a});return i===c.MONTH?s:l}})),define("modules/clean/account_page/widgets/plan/types",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProductAddonType=t.PerformPlanTransition=void 0,(function(e){e[e.MONTHLY=1]="MONTHLY",e[e.YEARLY=2]="YEARLY",e[e.PLUS=3]="PLUS",e[e.PROFESSIONAL=4]="PROFESSIONAL",e[e.ADD_EVH=5]="ADD_EVH",e[e.REMOVE_EVH=6]="REMOVE_EVH",e[e.FAMILY_PAYER=7]="FAMILY_PAYER",e[e.BACKUP=8]="BACKUP",e[e.HS_DBX_PRO_BUNDLE=9]="HS_DBX_PRO_BUNDLE",e[e.TRANSFER=10]="TRANSFER"})(t.PerformPlanTransition||(t.PerformPlanTransition={})),(function(e){e.EVH="EVH",e.QUOTA="QUOTA",e.LEGAL_HOLD="LEGAL_HOLD",e.PREMIUM_SUPPORT="PREMIUM_SUPPORT",e.MEDIA="MEDIA",e.API_RATE="API_RATE"})(t.ProductAddonType||(t.ProductAddonType={}))})),define("modules/clean/account_page/widgets/plan/views/add_schedule_modal",["require","exports","tslib","react","classnames","modules/clean/analytics","modules/clean/account_page/util","modules/clean/payments/skus/constants","modules/clean/react/components/css","spectrum/button/index","dig-components/modal","modules/clean/react/components/modal","dig-components/typography","modules/clean/static_urls","modules/core/i18n","modules/clean/react/payments/checkout/components/inputs/labeled_checkbox_input","modules/core/notify","modules/core/browser","modules/clean/react/growth/trials/requests","modules/clean/react/growth/logging_util","modules/clean/account_page/widgets/plan/views/npt_billing_schedule_items"],(function(e,t,a,n,i,s,l,o,r,d,c,u,p,m,g,_,f,h,y,b,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AddScheduleModalView=t.REFRESH_DELAY_SECONDS=void 0,n=a.__importDefault(n),i=a.__importDefault(i),u=a.__importStar(u),h=a.__importStar(h),t.REFRESH_DELAY_SECONDS=5;class M extends n.default.Component{constructor(e){super(e),this.closeModals=()=>{this.setState({isOpen:!1})},this.onTermsCheck=()=>{this.setState({displayTermsErrorMsg:!1,termsChecked:!this.state.termsChecked})},this.redirectToBilling=()=>{h.redirect("/account/billing")},this.onAccept=()=>{const{project:e,userId:a,skuCode:n,billingId:i}=this.props,{trialPriceConversions:l,finalBillingScheduleId:o,termsChecked:r}=this.state;if(!r)return void this.setState({displayTermsErrorMsg:!0});const d={trial_sku_code:n,conversion_token:l[o].conversion_token,billing_id:i.toString()};this.setState({submitting:!0}),s.ProEventsLogger.log("add_schedule_modal_accept",{scheduleId:o,advertised_monthly_price:l[o].advertised_monthly_price,advertised_yearly_price:l[o].advertised_yearly_price,currency:l[o].currency,total_amount:l[o].total_amount,project:e}),y.enableAutoConvert(a,e,b.ComponentName.TRIAL_ENABLE_AUTO_CONVERT_MODAL,d,()=>{f.Notify.success(g.intl.formatMessage({id:"RNIIJ0",defaultMessage:"You’ve added your billing period!"}),t.REFRESH_DELAY_SECONDS,this.redirectToBilling)},()=>{f.Notify.error(g.intl.formatMessage({id:"OXfp6E",defaultMessage:"There was an error adding the billing period!"})),this.doneSubmittingRequest(),this.closeModals()})},this.changeProductScheduleType=e=>{this.setState({finalBillingScheduleId:e})},this.getTermsErrorString=()=>{const{displayTermsErrorMsg:e}=this.state,t=g.intl.formatMessage({id:"a2NBnL",defaultMessage:"Please agree to the terms of service."});return e?t:""},this.onDismissModal=()=>{s.ProEventsLogger.log("add_schedule_modal_dismiss",{project:this.props.project}),this.closeModals()},this.state={displayTermsErrorMsg:!1,finalBillingScheduleId:o.ScheduleId.YEARLY,loadingContent:!0,submitting:!1,termsChecked:!1,trialPriceConversions:{},type:"",isOpen:!0}}static showInstance(e){u.Modal.showInstance(n.default.createElement(M.AddScheduleModal,Object.assign({},e)))}componentDidMount(){this.loadPlanTransitions()}loadPlanTransitions(){const{project:e,productType:t,userId:a,skuCode:n,duration:i}=this.props,s={trial_sku_code:n,trial_duration:i,schedule_ids:[o.ScheduleId.MONTHLY,o.ScheduleId.YEARLY]};y.getPriceConversionsForSchedule(a,e,b.ComponentName.TRIAL_ENABLE_AUTO_CONVERT_MODAL,s,e=>{if(e){const a=e.trial_price_conversions;a[o.ScheduleId.MONTHLY]&&a[o.ScheduleId.YEARLY]||(f.Notify.error(g.intl.formatMessage({id:"C2BKnZ",defaultMessage:"Failed to load modal."})),this.closeModals()),this.setState({loadingContent:!1,type:t,trialPriceConversions:a})}},()=>{f.Notify.error(g.intl.formatMessage({id:"C2BKnZ",defaultMessage:"Failed to load modal."})),this.closeModals()})}doneSubmittingRequest(){this.setState(e=>Object.assign(Object.assign({},e),{submitting:!1}))}get scheduleTransitionText(){const{trialPriceConversions:e,finalBillingScheduleId:t}=this.state,a=e[t.toString()],i=t===o.ScheduleId.MONTHLY?"month":"year",s=g.intl.formatMessage({id:"OUUNz7",defaultMessage:"I agree to the <link>Dropbox Terms</link> and the <strong>Automatic Renewal Terms</strong> above"},{link:(...e)=>n.default.createElement("a",{"aria-label":g.intl.formatMessage({id:"zmINZ0",defaultMessage:"terms"}),className:"terms-info__tos--terms-link",href:"#",key:"link_dbx",onClick:l.logClickAndOpenTab("de_terms_link_click","/terms",{from:"add_schedule_modal"})},e),strong:(...e)=>n.default.createElement("strong",null,e)}),r=n.default.createElement("span",null,s);return n.default.createElement("div",null,n.default.createElement("span",{className:"change-summary"},g.intl.formatMessage({id:"38ZvV3",defaultMessage:"Purchase summary"})),n.default.createElement("p",{className:"plan-transition"},g.intl.formatMessage({id:"Ufvtdi",defaultMessage:"Your trial ends on {date}. If you don’t <cancelLink>cancel</cancelLink> your free trial by that date, we’ll charge you {scheduled_total} per {schedule} (including applicable taxes) until you cancel your plan. If you have any charges after your trial, they <refundLink>won’t be refunded</refundLink> when you <downgradeLink>cancel</downgradeLink>, <legalLink>unless it’s legally required</legalLink>. All amounts shown are in {currency}."},{date:a.formatted_trial_end_date,schedule:i,scheduled_total:a.total_amount,currency:a.currency,strong:e=>n.default.createElement("strong",null,e),cancelLink:e=>n.default.createElement("a",{"aria-label":g.intl.formatMessage({id:"lGpNw6",defaultMessage:"CancelLink"}),href:"#",onClick:l.logClickAndOpenTab("de_cancel_link_click","/help/accounts-billing/cancellations-refunds/cancel-free-trial",{from:"add_schedule_modal"})},e),refundLink:e=>n.default.createElement("a",{"aria-label":g.intl.formatMessage({id:"WSrUNs",defaultMessage:"RefundLink"}),href:"#",onClick:l.logClickAndOpenTab("de_refund_link_click","/terms",{from:"add_schedule_modal"})},e),downgradeLink:e=>n.default.createElement("a",{"aria-label":g.intl.formatMessage({id:"zuLHeg",defaultMessage:"DowngradeLink"}),href:"#",onClick:l.logClickAndOpenTab("de_downgrade_link_click","/help/accounts-billing/cancellations-refunds/downgrade-dropbox-plus-professional-plans",{from:"add_schedule_modal"})},e),legalLink:e=>n.default.createElement("a",{"aria-label":g.intl.formatMessage({id:"enHZxv",defaultMessage:"LegalLink"}),href:"#",onClick:l.logClickAndOpenTab("de_legal_link_click","/help/accounts-billing/payments-billing/refund",{from:"add_schedule_modal"})},e)})),n.default.createElement(_.LabeledCheckboxInput,{checked:this.state.termsChecked,onChange:this.onTermsCheck,labelText:r,name:"terms-checkbox",className:"billing-terms-and-service",errorText:this.getTermsErrorString()}))}get acceptButtonDisabled(){const{loadingContent:e,submitting:t}=this.state;return e||t}render(){const{loadingContent:e,trialPriceConversions:t,finalBillingScheduleId:a,type:s}=this.state;let l;const o=g.intl.formatMessage({id:"nRgwkK",defaultMessage:"Step 2/2: choose your billing period"});l=e?n.default.createElement("div",{className:"loading-indicator"},n.default.createElement("img",{src:m.static_url("/static/images/icons/ajax-loading-small-vfl3Wt7C_.gif"),alt:g.intl.formatMessage({id:"jybGUg",defaultMessage:"Loading"})})):n.default.createElement("div",null,n.default.createElement("div",null,n.default.createElement(v.NptBillingScheduleItems,{trialPriceConversions:t,finalBillingScheduleId:a,planName:s,changeProductScheduleType:this.changeProductScheduleType})),n.default.createElement("div",{className:"plan-footer u-font-meta"},this.scheduleTransitionText));const r=i.default("change-plan-modal");return n.default.createElement(c.Modal,{overlayClassName:r,open:this.state.isOpen,isCentered:!0,withCloseButton:g.intl.formatMessage({id:"11bV9n",defaultMessage:"Cancel"}),shouldCloseOnOverlayClick:!1,onRequestClose:this.onDismissModal,onAfterClose:u.Modal.close},n.default.createElement(c.Modal.Header,{hasBottomSpacing:"title-standard"},n.default.createElement(p.Title,{isBold:!1,size:"small"},o)),n.default.createElement(c.Modal.Body,{hasVerticalSpacing:!0},l),n.default.createElement(c.Modal.Footer,{hasTopBorder:!0},n.default.createElement(d.Button,{variant:"secondary",onClick:this.onDismissModal},g.intl.formatMessage({id:"dqvpHx",defaultMessage:"Cancel"})),n.default.createElement(d.Button,{className:"confirm-purchase-button",disabled:this.acceptButtonDisabled,variant:"primary",onClick:this.onAccept},g.intl.formatMessage({id:"/w1aTc",defaultMessage:"Confirm purchase"}))))}}t.AddScheduleModalView=M,M.AddScheduleModal=r.requireCssWithComponent(M,["/static/css/teams/admin/widgets/add_schedule_modal/add_schedule_modal-vflzjyX-t.css"]),M.displayName="AddScheduleModalView"})),define("modules/clean/account_page/widgets/plan/views/addons/addon_info_component",["require","exports","tslib","react","styled-components","modules/core/i18n","modules/clean/analytics","dig-components/buttons","dig-components/icons","dig-components/icons/src","modules/clean/account_page/widgets/plan/views/addons/strings"],(function(e,t,a,n,i,s,l,o,r,d,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AddonInfoComponent=t.AddonDropdown=t.AddonCTA=t.AddonDescription=t.AddonTitle=t.AddonDetailsContainer=t.AddonContainer=void 0,n=a.__importDefault(n),i=a.__importDefault(i),t.AddonContainer=i.default.div`
  margin-bottom: var(--spacing__unit--3);
  margin-top: 0px;
  font-size: var(--type__body__standard--fontsize);
  display: flex;
  justify-content: space-between;
  min-width: 500px;
`,t.AddonDetailsContainer=i.default.div`
  margin-right: 48px;
`,t.AddonTitle=i.default.p`
  margin-bottom: var(--spacing__unit--1);
  color: var(--color__standard__text);
`,t.AddonDescription=i.default.p`
  margin-bottom: 0;
  color: var(--color__faint__text);
  line-height: var(--type__body__standard--lineheight);
  width: 100%;
  box-sizing: border-box;
`,t.AddonCTA=i.default.div`
  display: flex;
  align-items: self-end;
`,t.AddonDropdown=i.default.div`
  display: flex;
  align-items: center;
  color: var(--color__standard__text);
  margin-bottom: 32px;
`,t.AddonInfoComponent=e=>{const{addonInfo:a,addonIndex:i,addonButton:u,addonSectionStatus:p,addonsInfoMinimized:m,showButton:g,showPrice:_,defaultAddonsToShow:f,billingSchedule:h,updateMinimizedState:y}=e,b=()=>{y(),l.ProEventsLogger.log("addons_showall",{addon_status:p})},v=s.intl.formatMessage({id:"vAUdR2",defaultMessage:"View all add-ons"}),{name:M,description:S,formatted_total_amount:P,is_license_based:E}=a,C=(_?c.getPaidAddonBillingSummary(P,E,h)+" ":"")+S,A=i===f&&m;let T;return i<f||i>=f&&!m?T=n.default.createElement(t.AddonContainer,null,n.default.createElement(t.AddonDetailsContainer,null,n.default.createElement(t.AddonTitle,{"data-testid":"plan-status-addon-title"},M),n.default.createElement(t.AddonDescription,{"data-testid":"plan-status-addon-addonDescription"},C)),n.default.createElement(t.AddonCTA,null,g&&u)):A&&(T=n.default.createElement(t.AddonDropdown,null,n.default.createElement(r.UIIcon,{size:"standard",src:d.ChevronDownLine}),n.default.createElement(o.Button,{variant:"transparent",className:"jest-addons-info-dropdown-cta",size:"standard",onClick:b},v))),n.default.createElement("div",{key:i,className:"jest-addons-info-section"},T)},t.AddonInfoComponent.displayName="AddonInfoComponent"})),define("modules/clean/account_page/widgets/plan/views/addons/addon_management_modal",["require","exports","tslib","react","modules/core/browser","dig-components/typography","modules/core/notify","modules/clean/account_page/widgets/plan/views/change_confirmation_modal","modules/clean/account_page/widgets/plan/add_ons/api","modules/clean/react/components/modal","modules/clean/active_user","modules/clean/analytics","modules/core/i18n","modules/clean/account_page/widgets/plan/api","modules/clean/react/payments/update_individual_billing/update_individual_billing_modal_loader","modules/clean/react/payments/error/browser_update_required_modal","modules/clean/account_page/widgets/plan/views/update_billing_info","modules/clean/dbmodal_stack","modules/clean/react/payments/update_individual_billing/update_individual_store_creator","modules/clean/payments/three_ds_helper","modules/clean/account_page/widgets/plan/views/individual_inline_payment_method","modules/clean/account_page/widgets/plan/views/addons/strings","modules/clean/account_page/widgets/plan/views/addons/constants","modules/clean/account_page/widgets/plan/views/addons/logging"],(function(e,t,a,n,i,s,l,o,r,d,c,u,p,m,g,_,f,h,y,b,v,M,S,P){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AddonManagementModal=void 0,n=a.__importDefault(n),i=a.__importStar(i);class E extends n.default.Component{constructor(e){super(e),this.updateThreeDsData=e=>{this.threeDsData=e},this.getLoggingExtra=()=>{const{addonInfo:e}=this.props,t="personal"===this.currentUser.role,a={addon_family:e.addon_family,addon_name:e.name,is_team:!t};return t||(a.team_addon_id=P.getTeamAddonIdForLogging(e)),a},this.onAccept=()=>{this.setState({submitting:!0});const{addonInfo:e,isAddition:t,onAddonUpdate:a}=this.props,n="personal"===this.currentUser.role?S.AddonRedirectPath.ACCOUNT_PAGE:S.AddonRedirectPath.BILLING_PAGE,s=t?"addon_purchase_confirm":"addon_remove_confirm";u.ProEventsLogger.log(s,this.getLoggingExtra());const o={offering_id:e.offering_id,is_addition:t,preview_request_token:this.previewResult.preview_request_token,redirect_path:n,browser_info:b.collectBrowserInfo(),three_ds_data:this.threeDsData};r.performAddonTransition(this.currentUser.role,this.currentUser.id,o).then(e=>{if(e.change_completed)return a();if(e.redirect_url&&i.redirect(e.redirect_url),e.three_ds_error_data&&this.threeDsMessageHandler){const t=JSON.parse(e.three_ds_error_data);this.threeDsMessageHandler(t)}}).catch(e=>{l.Notify.error(e.message)}).finally(()=>{this.setState({submitting:!1}),this.updateThreeDsData(""),this.closeModal()})},this.onCancel=()=>{const e=this.props.isAddition?"addon_purchase_cancel":"addon_remove_cancel";u.ProEventsLogger.log(e,this.getLoggingExtra()),this.closeModal()},this.closeModal=()=>{this.setState({open:!1}),d.Modal.close()},this.onCancelSubscriptionLinkClick=()=>{i.open_tab("https://help.dropbox.com/accounts-billing/cancellations-refunds/downgrade-dropbox-plus-professional-plans")},this.onRefundLinkClick=()=>{i.open_tab("https://help.dropbox.com/accounts-billing/payments-billing/refund")},this.updateBillingInfo=e=>{const t="personal"===this.currentUser.role;u.ProEventsLogger.log("addon_update_billing",{is_team:!t}),this.closeModal(),h.DBModalStack.register(y.BILLING_INFO_UPDATED,()=>{m.resetApolloStore(),E.showInstance(this.props)}),this.props.browserUpdateRequired?_.BrowserUpdateModalLoader.showInstance():g.IndividualUpdateBillingModalLoader.showInstance()},this.currentUser=c.mustGetActiveUser(),this.threeDsData="",this.state={open:!0,loadingContent:!0,submitting:!1}}static showInstance(e){d.Modal.showInstance(n.default.createElement(E,Object.assign({},e)))}componentDidMount(){const{isAddition:e,addonInfo:t,trigger:a}=this.props,n=e?"addon_purchase_view":"addon_remove_view",i=Object.assign(Object.assign({},this.getLoggingExtra()),{refer_parameters:a});u.ProEventsLogger.log(n,i);const s={offering_id:t.offering_id,is_addition:e};r.getAddonTransitionPreview(this.currentUser.role,this.currentUser.id,s).then(e=>{const t=new b.ThreeDsHandler({updateThreeDsData:this.updateThreeDsData,submitThreeDsChallenge:this.onAccept,triggerThreeDsChallenge:()=>{},submitThreeDsFingerprint:this.onAccept,triggerThreeDsFingerprint:()=>{},isDesktop:!1,isSeleniumChangesTest:!1});this.threeDsMessageHandler=t.handle3DsMessage,this.previewResult=e}).catch(e=>{l.Notify.error(e.message),this.closeModal()}).finally(()=>{this.setState({loadingContent:!1})})}getPaymentInfo(){const{active_payment_method_type:e,last_digits:t}=this.previewResult;if(!e)return;const a={active_payment_method_type:e[".tag"],last_digits:t};return n.default.createElement(v.IndividualInlinePaymentMethodView,{accountPaymentInfo:a})}getDescription(){if(this.state.loadingContent)return"";const{isAddition:e,addonInfo:t,totalQuota:a,planQuota:i,billingSchedule:l,formattedAddonAttribute:o}=this.props,{name:r,description:d,addon_family:c}=t,{upcoming_bill_date:u,upcoming_bill_total_price:m,upcoming_bill_addon_price:g,current_bill_addon_price:_,total_includes_taxes:h,last_digits:y}=this.previewResult,b=p.intl.formatMessage({id:"69RiKK",defaultMessage:"{price} (taxes included)"},{price:m}),v=h?b:m,P=e?S.AddonTransitionType.ADD:S.AddonTransitionType.REMOVE,E=M.getAddonDescription(c,P),C=M.getAddonLegalDescription(P);return n.default.createElement("div",null,n.default.createElement(s.Text,null,p.intl.formatMessage(E,{addon_name:r,addon_description:d,schedule_noun:null==l?void 0:l.scheduleDescriptionNoun,upcoming_addon_price:g,addon_quota:o,addon_retention:o,total_quota:a,plan_quota:i})),n.default.createElement(s.Text,{size:"small",color:"faint"},p.intl.formatMessage(C,{br:n.default.createElement("br",null),schedule:null==l?void 0:l.scheduleDescriptionAdjective,schedule_noun:null==l?void 0:l.scheduleDescriptionNoun,current_addon_price:_,upcoming_addon_price:g,next_billing_date:u,new_total:v,payment_info:this.getPaymentInfo(),last_digits:y,cancelSubscriptionLink:e=>n.default.createElement(s.Link,{href:"#","aria-label":p.intl.formatMessage({id:"vMob1H",defaultMessage:"Link to cancel subscription help article."}),onClick:this.onCancelSubscriptionLinkClick,hasNoUnderline:!0},e),refundLink:e=>n.default.createElement(s.Link,{href:"#","aria-label":p.intl.formatMessage({id:"U8EUPD",defaultMessage:"Link to refund help article"}),onClick:this.onRefundLinkClick,hasNoUnderline:!0},e),updateBillingInfoLink:n.default.createElement(f.UpdateBillingInfoLink,{updateBillingCTA:this.updateBillingInfo})})))}render(){const{isAddition:e,addonInfo:t}=this.props,{open:a,loadingContent:i,submitting:s}=this.state,l=p.intl.formatMessage(M.getAddonTitle(e),{addon_name:t.name}),r=p.intl.formatMessage({id:"v9SfkL",defaultMessage:"Confirm"}),d=p.intl.formatMessage({id:"uVzYam",defaultMessage:"Cancel"});return n.default.createElement(o.ChangeConfirmationModal,{acceptButtonDisabled:s,acceptButtonText:r,description:this.getDescription(),dismissButtonText:d,loadingContent:i,onAccept:this.onAccept,onDismiss:this.onCancel,open:a,submitting:s,title:l})}}t.AddonManagementModal=E,E.displayName="AddonManagementModal"})),define("modules/clean/account_page/widgets/plan/views/addons/addon_section",["require","exports","tslib","react","modules/core/i18n","dig-components/buttons","modules/clean/account_page/widgets/plan/views/addons/addon_info_component","modules/clean/account_page/widgets/plan/views/addons/utils","modules/clean/account_page/widgets/plan/views/addons/constants","modules/clean/account_page/components/key_value_block"],(function(e,t,a,n,i,s,l,o,r,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AddonSection=void 0,n=a.__importStar(n),t.AddonSection=e=>{const[t,a]=n.useState(!0),c=()=>{a(!1)},{addonSectionStatus:u,addonsInfo:p,addonsLoadingState:m,billingSchedule:g,browserUpdateRequired:_,onAddonUpdate:f,isPersonalUser:h}=e;if("ready"!==m||!(null==p?void 0:p.length))return null;if(u===r.AddonSectionStatus.CURRENT){const{formattedSpecQuotaGb:a,totalQuota:d}=e;o.logAddonsView(u,h);const m=i.intl.formatMessage({id:"bnNVIg",defaultMessage:"Remove"}),y=p.map((i,p)=>{const y=n.default.createElement(s.Button,{variant:"transparent",className:"plan-status-section__remove-addon-button",onClick:()=>o.openAddonManagementModal(i,r.AddonManagementModalTrigger.BUTTON,!1,f,h,g,_,a,d)},m),{showPrice:b,showButton:v}=(t=>{const{isPersonalUser:a,eligibleFor1tb:n,onlyShowDescription:i}=e,s=t.is_paid_addon&&!t.scheduled_to_remove;let l,o;return a?(l=s,o=s&&!n):(l=s&&!i,o=s&&!i),{showPrice:l,showButton:o}})(i);return n.default.createElement(l.AddonInfoComponent,{key:`current-addon-${p}`,addonIndex:p,addonInfo:i,addonButton:y,addonSectionStatus:u,billingSchedule:g,addonsInfoMinimized:t,showButton:v,showPrice:b,defaultAddonsToShow:2,updateMinimizedState:c})});return n.default.createElement("div",{className:"account-addons-section"},y)}{const{isSubscriptionMgmtAddonsRollout:a,inGracePeriod:m}=e;if(!a)return null;o.logAddonsView(u,h);const y=i.intl.formatMessage({id:"ZkhfIA",defaultMessage:"Add"}),b=p.map((e,a)=>{const i=n.default.createElement(s.Button,{variant:"transparent",className:"plan-status-section__add-addon-button","data-offeringid":e.offering_id,onClick:()=>o.openAddonManagementModal(e,r.AddonManagementModalTrigger.BUTTON,!0,f,h,g,_),disabled:m},y);return n.default.createElement(l.AddonInfoComponent,{key:`available-addon-${a}`,addonIndex:a,addonInfo:e,addonButton:i,addonSectionStatus:u,billingSchedule:g,addonsInfoMinimized:t,showButton:!0,showPrice:!0,defaultAddonsToShow:1,updateMinimizedState:c})}),v=i.intl.formatMessage({id:"lfz3xn",defaultMessage:"Available add-ons"});return n.default.createElement("div",{className:"account-plan-section addons-section"},h?n.default.createElement(d.KeyValueBlock,{className:"zero_padding",keyText:v}):n.default.createElement("h1",{className:"f2 addons-section-header"},v),n.default.createElement("div",{className:"account-addons-section"},b))}},t.AddonSection.displayName="AddonSection"})),define("modules/clean/account_page/widgets/plan/views/addons/constants",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AddonTransitionType=t.AddonSectionStatus=t.AddonRedirectPath=t.AddonManagementModalTrigger=void 0,(function(e){e.BUTTON="button",e.QUERY_PARAM="query_param"})(t.AddonManagementModalTrigger||(t.AddonManagementModalTrigger={})),(function(e){e.ACCOUNT_PAGE="/account/plan",e.BILLING_PAGE="/team/admin/billing"})(t.AddonRedirectPath||(t.AddonRedirectPath={})),(function(e){e.CURRENT="current",e.AVAILABLE="available"})(t.AddonSectionStatus||(t.AddonSectionStatus={})),(function(e){e.ADD="Add",e.REMOVE="Remove"})(t.AddonTransitionType||(t.AddonTransitionType={}))})),define("modules/clean/account_page/widgets/plan/views/addons/logging",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getTeamAddonIdForLogging=void 0,t.getTeamAddonIdForLogging=e=>e.addon_attribute?`${e.addon_family}_${e.addon_attribute.attribute_value}`:e.addon_family})),define("modules/clean/account_page/widgets/plan/views/addons/strings",["require","exports","react-intl","modules/core/i18n","modules/clean/account_page/widgets/plan/types","modules/clean/ts_utils","modules/clean/account_page/widgets/plan/views/addons/constants"],(function(e,t,a,n,i,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPaidAddonBillingSummary=t.getAddonLegalDescription=t.getAddonDescription=t.getAddonTitle=t.ADDON_STRINGS=void 0,t.ADDON_STRINGS=a.defineMessages({ADD_ADDON_TITLE:{id:"7WmcLH",defaultMessage:"Add {addon_name}"},REMOVE_ADDON_TITLE:{id:"P2d7hJ",defaultMessage:"Remove {addon_name}"},BILLING_SUMMARY:{id:"utV4HI",defaultMessage:"{price} per {period}."},LICENSE_BILLING_SUMMARY:{id:"mNQboU",defaultMessage:"{price} per license per {period}."},EVH_ADD:{id:"frV3Nx",defaultMessage:"You're buying {addon_retention} file recovery and version history for {upcoming_addon_price} per {schedule_noun}, which applies to any file deleted or modified after purchase."},EVH_REMOVE:{id:"EZeHar",defaultMessage:"When you remove Extended Version History, you will lose access to {addon_retention} file recovery and version history."},QUOTA_ADD:{id:"pM2UbV",defaultMessage:"You're buying {addon_quota} of additional storage space for {upcoming_addon_price} per {schedule_noun}."},QUOTA_REMOVE:{id:"rACkS4",defaultMessage:"Your storage space will decrease from {total_quota} to {plan_quota}. If you've used over {plan_quota} of storage space, Dropbox will stop syncing files to your devices."},LEGAL_HOLD_REMOVE:{id:"LDxrjw",defaultMessage:"When you remove Data Governance, you will lose access to compliance and audit support tools."},PREMIUM_SUPPORT_REMOVE:{id:"JXecv3",defaultMessage:"When you remove Premium Support, your team members will lose access to enhanced customer support."},MEDIA_REMOVE:{id:"4MOAh3",defaultMessage:"When you remove Media Creative tools, you will lose access to simplified media support tools."},API_RATE_REMOVE:{id:"6VfUNX",defaultMessage:"When you remove Unlimited API Call Rate, you will lose access to unlimited API calls."},LEGAL_ADD:{id:"S3fgQV",defaultMessage:"{br}{br}When you click confirm, we'll charge you {current_addon_price} now, which is prorated for the current billing period. Starting on {next_billing_date} your {schedule} subscription will increase by {upcoming_addon_price} and your new {schedule} total will be {new_total} until you <cancelSubscriptionLink>cancel</cancelSubscriptionLink>. If you cancel, previous charges won't be refunded <refundLink>unless it's legally required</refundLink>.{br}{br}{payment_info} {updateBillingInfoLink}."},LEGAL_REMOVE:{id:"I1A5yW",defaultMessage:"{br}{br}By clicking Confirm, your {schedule} subscription will decrease by {upcoming_addon_price} per {schedule_noun} on {next_billing_date}, and your subscription will be {new_total} per {schedule_noun}."}}),t.getAddonTitle=e=>e?t.ADDON_STRINGS.ADD_ADDON_TITLE:t.ADDON_STRINGS.REMOVE_ADDON_TITLE,t.getAddonDescription=(e,a)=>{switch(e){case i.ProductAddonType.EVH:return a===l.AddonTransitionType.ADD?t.ADDON_STRINGS.EVH_ADD:t.ADDON_STRINGS.EVH_REMOVE;case i.ProductAddonType.QUOTA:return a===l.AddonTransitionType.ADD?t.ADDON_STRINGS.QUOTA_ADD:t.ADDON_STRINGS.QUOTA_REMOVE;case i.ProductAddonType.LEGAL_HOLD:return t.ADDON_STRINGS.LEGAL_HOLD_REMOVE;case i.ProductAddonType.PREMIUM_SUPPORT:return t.ADDON_STRINGS.PREMIUM_SUPPORT_REMOVE;case i.ProductAddonType.MEDIA:return t.ADDON_STRINGS.MEDIA_REMOVE;case i.ProductAddonType.API_RATE:return t.ADDON_STRINGS.API_RATE_REMOVE;default:return s.enforceExhaustive(e)}},t.getAddonLegalDescription=e=>e===l.AddonTransitionType.ADD?t.ADDON_STRINGS.LEGAL_ADD:t.ADDON_STRINGS.LEGAL_REMOVE,t.getPaidAddonBillingSummary=(e,a,i)=>{let s="";if(null==i?void 0:i.scheduleDescriptionNoun){const l=a?t.ADDON_STRINGS.LICENSE_BILLING_SUMMARY:t.ADDON_STRINGS.BILLING_SUMMARY;s=n.intl.formatMessage(l,{price:e,period:i.scheduleDescriptionNoun})}return s}})),define("modules/clean/account_page/widgets/plan/views/addons/utils",["require","exports","tslib","modules/clean/display_format","modules/clean/account_page/widgets/plan/types","modules/clean/analytics","modules/clean/account_page/widgets/plan/views/addons/addon_management_modal","modules/core/uri","modules/core/browser","modules/clean/account_page/widgets/plan/views/addons/logging"],(function(e,t,a,n,i,s,l,o,r,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getAvailableAddonsInfoFromQuery=t.clearAvailableAddonsInfoFromQuery=t.formatQuota=t.getAddonAttribute=t.isAddonUpdateIncludedWithLicenseChange=t.addonScheduledForRemoval=t.logAddonsView=t.openAddonManagementModal=void 0,r=a.__importStar(r),t.openAddonManagementModal=(e,a,n,i,o,r,c,u,p)=>{const m={addon_family:e.addon_family,addon_name:e.name,trigger:a,is_team:!o};o||(m.team_addon_id=d.getTeamAddonIdForLogging(e)),n?s.ProEventsLogger.log("addon_add_click",m):s.ProEventsLogger.log("addon_remove_click",m),t.clearAvailableAddonsInfoFromQuery(e);const g=t.getAddonAttribute(e);l.AddonManagementModal.showInstance({addonInfo:e,trigger:a,isAddition:n,billingSchedule:r,onAddonUpdate:i,formattedAddonAttribute:g,browserUpdateRequired:c,planQuota:u,totalQuota:t.formatQuota(p)})},t.logAddonsView=(e,t)=>{const a={addon_status:e,is_team:!t};s.ProEventsLogger.log("addons_view",a)},t.addonScheduledForRemoval=(e,t)=>{for(const a of t)if(e.productType===a.productType)return!1;return!0},t.isAddonUpdateIncludedWithLicenseChange=(e,a,n)=>{if(a&&e&&n){const n=e.addons.skus,i=a.addons.skus;for(const e of n)if(e.isLicenseBased&&!t.addonScheduledForRemoval(e,i))return!0}return!1},t.getAddonAttribute=e=>{const{addon_attribute:t,addon_family:a}=e;switch(a){case i.ProductAddonType.EVH:if(null==t?void 0:t.vacuuming_policy_max_days)return null==t?void 0:t.vacuuming_policy_max_days;break;case i.ProductAddonType.QUOTA:if(null==t?void 0:t.quota_gb)return n.formatGigabytes(t.quota_gb,2,!0,!0)}return""},t.formatQuota=e=>e?n.format_bytes(e,2,!0,!0,!1):"",t.clearAvailableAddonsInfoFromQuery=e=>{var t;const a=o.URI.parse(r.get_href()),n=a.getQuery();delete n.modal,delete n.addon_family,e.addon_attribute&&delete n[null===(t=e.addon_attribute)||void 0===t?void 0:t.attribute_name],a.setQuery(n);const i=a.toString();window.history.pushState({path:i},"",i)},t.getAvailableAddonsInfoFromQuery=(e,t)=>{const a=o.URI.parse(r.get_href()).getQuery();return e.filter(e=>{var n,i;if(a.addon_family!==e.addon_family)return!1;if(!t){const t=null===(n=e.addon_attribute)||void 0===n?void 0:n.attribute_name,s=null===(i=e.addon_attribute)||void 0===i?void 0:i.attribute_value;return t&&a[t]&&a[t]===s}return!0})}})),define("modules/clean/account_page/widgets/plan/views/basic_plan_status",["require","exports","tslib","react","modules/core/browser","styled-components","modules/core/i18n","modules/clean/static_urls","modules/clean/analytics","modules/constants/trademark","dig-components/typography","dig-components/buttons","modules/clean/hql/index","dropbox/proto/hql_events/revenue/revenue","dropbox/proto/hql_events/extensions","dropbox/proto/hql_events/taxonomy"],(function(e,t,a,n,i,s,l,o,r,d,c,u,p,m,g,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BasicPlanStatusSection=void 0,n=a.__importDefault(n),i=a.__importStar(i),s=a.__importDefault(s);const f=_.hql_events.TaxonomyAppSurface.AppSurface,h=_.hql_events.TaxonomyActionSurface.ActionSurface,y=s.default.div`
  flex-basis: 140px;
  text-align: right;
  display: flex;
  flex-direction: column;
  justify-content: center;
`,b=s.default.div`
  width: 36px;
  margin: 0 var(--spacing__unit--2) auto var(--spacing__base_unit);
  height: 69px;
`,v=s.default.div`
  display: flex;
  padding-top: var(--spacing__unit--2);
`,M=s.default.div`
  flex-grow: 1;
  color: var(--color__faint__text);
  font-size: var(--type__body__small--fontsize);
  line-height: var(--type__body__large--lineight);
`,S=s.default(c.Title)`
  font-size: var(--type__body__large--fontsize);
  margin-bottom: 0;
  color: var(--color__standard__text);
`,P=s.default(u.Button)`
  .plan-status-section__link--inline {
    font-style: italic;
  }
`;t.BasicPlanStatusSection=e=>{const{planName:t=d.DROPBOX_BASIC,plansUrl:a="/plans?oqa=acc_general_upgrade",limitedTeam:s,hidePlansLink:c,hideUpgradeButton:E}=e;let{upgradePlanButton:C}=e;const A=()=>{(()=>{const e=g.hql_events.HQLEventIdentity.create({eventClass:g.hql_events.HQLEventIdentity.EventClass.create({className:_.hql_events.TaxonomyClass.ClassName.SEE_AND_CLICK}),legacyEvent:g.hql_events.HQLEventIdentity.LegacyEvent.create({table:"pro_events",name:"de_general_tab_upgrade_to_plus_click"}),actionEventId:g.hql_events.HQLEventIdentity.ActionEventIdentity.create({object:"basic_upgrade_button",action:_.hql_events.TaxonomyAction.Action.SELECT})});p.logEvent(m.hql_events.SelectBasicUpgradeButton.create({hqlMetadata:g.hql_events.HQLMetadata.create({appSurface:f.WEB,actionSurface:h.CENTER_PANE_GENERAL_TAB,identityOverride:e})}))})(),r.ProEventsLogger.log("de_general_tab_upgrade_to_plus_click",{},()=>{i.redirect("/upgrade?oqa=acc_general_upgrade")})};return C||(C=n.default.createElement(y,{className:"plan-status-section__upgrade_btn"},n.default.createElement(u.Button,{variant:"primary",size:"standard",role:"link",onClick:A,className:"jest-upgrade-plan-button"},l.intl.formatMessage({id:"7/M9u2",defaultMessage:"Upgrade"})))),n.default.createElement(n.default.Fragment,null,n.default.createElement("div",{className:"plan-status-section__infohead account-plan-section__title"},l.intl.formatMessage({id:"7Fz7qP",defaultMessage:"Current plan"})),n.default.createElement(v,{className:"plan-status-section has-no-border"},n.default.createElement(b,{className:"plan-status-section__icon"},n.default.createElement("img",{src:o.static_url("/static/images/logo_catalog/dropbox-business-icon_m1-vflczuza3.svg"),alt:l.intl.formatMessage({id:"ORB1Kv",defaultMessage:"See other plans"})})),n.default.createElement(M,{className:"plan-status-section__description"},n.default.createElement(S,{size:"small",isBold:!0,className:"plan-status-section__title"},t),s,!c&&n.default.createElement(P,{size:"small",className:"plan-status-section__link",variant:"transparent",onClick:()=>{i.open_tab(a)},role:"link"},l.intl.formatMessage({id:"ORB1Kv",defaultMessage:"See other plans"}))),!E&&C))}})),define("modules/clean/account_page/widgets/plan/views/billing_period",["require","exports","tslib","react","modules/core/i18n","modules/clean/account_page/components/key_value_block","modules/clean/payments/skus/constants","modules/clean/account_page/widgets/billing/payment_methods_util"],(function(e,t,a,n,i,s,l,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BillingPeriod=void 0,n=a.__importDefault(n);class r extends n.default.Component{render(){const{billingInfo:e,isPaidUser:t,productType:a,handleBillingChange:r}=this.props;if(!t||a===l.ProductPlanType.FAMILY_NONPAYER||a===l.ProductPlanType.PLUS_TRIAL)return null;const{payment_info:d,scheduled_for_downgrade:c}=e;if(o.shouldHideBillingChange(d.gateway_id,d.is_reseller_billing)||!d.period)return null;if(!d.schedule_switchable&&!c&&a!==l.ProductPlanType.PROFESSIONAL_TRIAL)return n.default.createElement(s.KeyValueBlock,{className:"change-billing-period account-plan-section",keyText:i.intl.formatMessage({id:"R8sDaj",defaultMessage:"Sorry, you cannot change your billing schedule at this time."})});const u="yearly"===d.period?i.intl.formatMessage({id:"qklV/o",defaultMessage:"Plan billed yearly"}):i.intl.formatMessage({id:"tWmQYf",defaultMessage:"Plan billed monthly"});return n.default.createElement(s.KeyValueBlock,{className:"change-billing-period account-plan-section",keyText:i.intl.formatMessage({id:"OrbqQ3",defaultMessage:"Billing Period"}),subtext:u,linkText:i.intl.formatMessage({id:"ZPvZld",defaultMessage:"Change"}),onLinkClick:r,disabled:d&&d.is_in_grace_period})}}t.BillingPeriod=r,r.displayName="BillingPeriod"})),define("modules/clean/account_page/widgets/plan/views/cancel_changes_modal",["require","exports","tslib","react","modules/clean/deprecated_ajax/ajax_jquery","modules/clean/account_page/widgets/plan/constants","modules/clean/account_page/constants","modules/clean/react/components/modal","modules/clean/analytics","modules/clean/payments/skus/constants","modules/clean/payments/skus/subscription_service","modules/constants/trademark","modules/core/i18n","modules/clean/dbmodal_stack","modules/clean/active_user","modules/core/notify","modules/clean/account_page/widgets/plan/views/change_confirmation_modal","api_v2/user_client","modules/clean/payments/skus/billing_schedule","modules/core/exception","modules/clean/account_page/widgets/plan/views/loading_view","modules/clean/subscription/tools/amp_logger"],(function(e,t,a,n,i,s,l,o,r,d,c,u,p,m,g,_,f,h,y,b,v,M){"use strict";var S;Object.defineProperty(t,"__esModule",{value:!0}),t.CancelChangesModalConfirmationView=void 0,n=a.__importDefault(n),i=a.__importStar(i),(function(e){e[e.NeverLoaded=0]="NeverLoaded",e[e.Loading=1]="Loading",e[e.Ready=2]="Ready"})(S||(S={}));const P=new Set([d.ProductFamily.PRO,d.ProductFamily.FAMILY]);class E extends n.default.Component{constructor(e){super(e),this.onAccept=()=>{const{cancellationType:e,addonFamilyType:t}=this.props;this.cancelScheduledChange(e,t)},this.closeModals=()=>{const{onClose:e}=this.props;e&&e(),this.setState({open:!1})},this.handleWrongPlanError=(e,t)=>{b.reportException({err:new Error(`Current user plan (id: ${e}, family: ${t}) is invalid for cancel_changes_modal`),severity:b.SEVERITY.CRITICAL})},this.getDisplayName=(e,t)=>{if(e&&t){if(P.has(t))return d.productPlanTypeToIndividualDisplayName(e);if(t===d.ProductFamily.TEAM)return d.productPlanTypeToBusinessDisplayName(e,t)}return this.handleWrongPlanError(e,t),""},this.loadDowngradeInfo=()=>{this.setState({loadingDowngradeInfo:S.Loading}),(new h.UserApiV2Client).ns("growth").rpc("get_cancel_changes_info",void 0,{subjectUserId:g.mustGetActiveUserId()}).then(e=>{this.setState({loadingDowngradeInfo:S.Ready,downgradeInfo:{subState:e.sub_state,finalSubState:e.final_sub_state}})}).catch(()=>{_.Notify.error(p.intl.formatMessage({id:"yhOAKQ",defaultMessage:"There was an issue cancelling your changes, please contact Customer Support."})),b.reportException({err:new Error(`get_cancel_changes_info call failed for user attempting to cancel changes of type: ${this.props.cancellationType}`),severity:b.SEVERITY.CRITICAL}),this.modalLogger.logModalError("modal_init"),this.closeModals()})},new c.SubscriptionService,this.state={loadingDowngradeInfo:S.NeverLoaded,submitting:!1,open:!0},this.modalLogger=M.getSubscriptionAMPLogger({ns:"personal",modal:M.ModalTypes.CANCEL_CHANGES_MODAL})}static showInstance(e){o.Modal.showInstance(n.default.createElement(E,Object.assign({},e)))}componentDidMount(){this.loadDowngradeInfo()}get currentProductPlanType(){var e,t;return null===(t=null===(e=this.state.downgradeInfo)||void 0===e?void 0:e.subState.product_plan_type)||void 0===t?void 0:t.toString()}submittingRequest(){this.setState(e=>Object.assign(Object.assign({},e),{submitting:!0}))}doneSubmittingRequest(){this.setState(e=>Object.assign(Object.assign({},e),{submitting:!1}))}cancelScheduledChange(e,t){const{transitionPerformed:a,productLine:n}=this.props,{downgradeInfo:o}=this.state;if(!o)return;const{subState:d,finalSubState:c}=o;this.modalLogger.setProductPlanType(this.currentProductPlanType),this.submittingRequest();const u=y.getScheduleDescriptionAdjective(d.schedule_id),f=y.getScheduleDescriptionAdjective(c.schedule_id);i.WebRequest({url:"/account/ajax_cancel_scheduled_change",data:{scheduled_change_type:e,addon_family_type:t,product_line:n},subject_user:g.mustGetActiveUserId(),success:t=>{_.Notify.success(p.intl.formatMessage({id:"dC654w",defaultMessage:"You’ve cancelled your change!"})),e===l.CancellationType.SCHEDULE&&(r.ProEventsLogger.log("de_change_billing_cancel_change"),r.ProEventsLogger.log("scheduled_billing_change_prompt_click_confirmed",{cta:"cancel_change_confirm",currentBillingSchedule:u,nextBillingSchedule:f})),e===l.CancellationType.ADDON&&r.ProEventsLogger.log("de_addon_modal_cancel_change"),e===l.CancellationType.PLAN&&r.ProEventsLogger.log("scheduled_plan_change_prompt_click_confirmed",{cta:"cancel_change_confirm"}),this.modalLogger.logModalSuccess(),a&&a(),this.doneSubmittingRequest(),this.closeModals(),this.props.reOpenModalDialogAfterCancellation&&m.DBModalStack.trigger(s.CHANGE_IND_PLAN_MODAL_UPDATED,null)},error:()=>{_.Notify.error(p.intl.formatMessage({id:"iQ7Rjk",defaultMessage:"Failed to cancel changes."})),this.modalLogger.logModalError("modal_submit"),this.doneSubmittingRequest(),this.closeModals(),this.props.reOpenModalDialogAfterCancellation&&m.DBModalStack.trigger(s.CHANGE_IND_PLAN_MODAL_UPDATED,null)}})}render(){const{cancellationType:e}=this.props,{open:t,submitting:a,downgradeInfo:i,loadingDowngradeInfo:s}=this.state;if(s!==S.Ready||!i)return n.default.createElement(v.LoadingView,{className:"cancel_changes_modal__loading-indicator"});const{subState:o,finalSubState:r}=i,c=y.getScheduleDescriptionAdjective(r.schedule_id),m=this.getDisplayName(o.product_plan_type,o.product_family),g=this.getDisplayName(r.product_plan_type,r.product_family);let _,h=p.intl.formatMessage({id:"G4ktGR",defaultMessage:"Confirm cancelling change"});switch(e){case l.CancellationType.PLAN:_=r.schedule_id===d.ScheduleId.YEARLY?p.intl.formatMessage({id:"1VHHGq",defaultMessage:"You’re cancelling your scheduled plan change. Your Dropbox {plan} plan will renew on <strong>{date}</strong> and you will be billed yearly."},{trademark_plus:u.TRADEMARK_PLUS,plan:m,date:o.next_billing_date,strong:e=>n.default.createElement("strong",null,e)}):p.intl.formatMessage({id:"hOx+lQ",defaultMessage:"You’re cancelling your scheduled plan change. Your Dropbox {plan} plan will renew on <strong>{date}</strong> and you will be billed monthly."},{trademark_plus:u.TRADEMARK_PLUS,plan:m,date:o.next_billing_date,strong:e=>n.default.createElement("strong",null,e)});break;case l.CancellationType.SCHEDULE:_=o.schedule_id===d.ScheduleId.YEARLY?p.intl.formatMessage({id:"U+lU7/",defaultMessage:"You’re cancelling your scheduled billing change. Your Dropbox {plan} plan will renew on <strong>{date}</strong> and you will be billed yearly."},{plan:g,date:o.next_billing_date,strong:e=>n.default.createElement("strong",null,e)}):p.intl.formatMessage({id:"AtC6hy",defaultMessage:"You’re cancelling your scheduled billing change. Your Dropbox {plan} plan will renew on <strong>{date}</strong> and you will be billed monthly."},{plan:g,date:o.next_billing_date,strong:e=>n.default.createElement("strong",null,e)});break;case l.CancellationType.ADDON:_=p.intl.formatMessage({id:"30QKkb",defaultMessage:"You’re cancelling your add-on changes. Your Dropbox {plan} plan will renew on <strong>{date}</strong> and you will be billed {schedule}."},{plan:g,date:o.next_billing_date,schedule:c,strong:e=>n.default.createElement("strong",null,e)});break;case l.CancellationType.IND_SUBSCRIPTION:h=p.intl.formatMessage({id:"NCTtwj",defaultMessage:"Confirmation"}),_=p.intl.formatMessage({id:"ikAVu1",defaultMessage:"By confirming, your downgrade to Dropbox Basic will be cancelled."});break;case l.CancellationType.ALL:h=p.intl.formatMessage({id:"NCTtwj",defaultMessage:"Confirmation"}),_=p.intl.formatMessage({id:"AmEj2/",defaultMessage:"By confirming, all existing scheduled changes will be cancelled."});break;default:h=p.intl.formatMessage({id:"NCTtwj",defaultMessage:"Confirmation"}),_=p.intl.formatMessage({id:"kMZoFx",defaultMessage:"By confirming, the scheduled change will be cancelled."})}const b=p.intl.formatMessage({id:"BKISIV",defaultMessage:"Confirm"}),M=p.intl.formatMessage({id:"7VYYNS",defaultMessage:"Don’t cancel"});return n.default.createElement(f.ChangeConfirmationModal,{acceptButtonDisabled:a,acceptButtonText:b,description:_,dismissButtonText:M,loadingContent:!1,onAccept:this.onAccept,onDismiss:this.closeModals,open:t,submitting:a,title:h})}}t.CancelChangesModalConfirmationView=E,E.displayName="CancelChangesModalConfirmationView"})),define("modules/clean/account_page/widgets/plan/views/cancel_subs_warning_modal",["require","exports","tslib","modules/clean/deprecated_ajax/ajax_jquery","modules/core/notify","react","modules/core/i18n","modules/clean/payments/skus/constants","modules/clean/active_user","modules/clean/account_page/constants","modules/clean/react/components/modal","modules/clean/account_page/widgets/plan/views/change_confirmation_modal","modules/clean/subscription/tools/amp_logger"],(function(e,t,a,n,i,s,l,o,r,d,c,u,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CancelChangesModalConfirmation=void 0,n=a.__importStar(n),s=a.__importDefault(s);class m extends s.default.Component{constructor(e){super(e),this.closeModals=()=>{this.setState({open:!1}),c.Modal.close()},this.onAccept=()=>{const{planType:e,onAccept:t}=this.props;e===o.ProductPlanType.HS_DBX_PRO_BUNDLE?this.closeModals():this.cancelScheduledChange(),t&&t()},this.state={submitting:!1,open:!0}}static showInstance(e){c.Modal.showInstance(s.default.createElement(m,Object.assign({},e)))}submittingRequest(){this.setState(e=>Object.assign(Object.assign({},e),{submitting:!0}))}doneSubmittingRequest(){this.setState(e=>Object.assign(Object.assign({},e),{submitting:!1}))}cancelScheduledChange(){var e,t,a;const{transitionPerformed:s,userIdOverride:o}=this.props,c=p.getSubscriptionAMPLogger({ns:"personal",modal:p.ModalTypes.CANCEL_SUBS_WARNING_MODAL,productPlanType:null===(a=null===(t=null===(e=this.props.subStatus)||void 0===e?void 0:e.subState)||void 0===t?void 0:t.plan)||void 0===a?void 0:a.productType.toString()});let u=null;u=o||r.mustGetActiveUserId(),this.submittingRequest(),n.WebRequest({url:"/account/ajax_cancel_scheduled_change",data:{scheduled_change_type:d.CancellationType.IND_SUBSCRIPTION},subject_user:u,success:e=>{i.Notify.success(l.intl.formatMessage({id:"dC654w",defaultMessage:"You’ve cancelled your change!"})),s&&s(),c.logModalSuccess(),this.doneSubmittingRequest(),this.closeModals()},error:()=>{i.Notify.error(l.intl.formatMessage({id:"iQ7Rjk",defaultMessage:"Failed to cancel changes."})),c.logModalError("modal_submit"),this.doneSubmittingRequest(),this.closeModals()}})}render(){const{planType:e,subStatus:t}=this.props,{submitting:a,open:n}=this.state;if(!t)return s.default.createElement("noscript",null);const{title:i,getDescription:r,acceptButtonText:d,dismissButtonText:c}=(function(e){if(e===o.ProductPlanType.SYNC_EVERYTHING)return{title:l.intl.formatMessage({id:"yOnuCE",defaultMessage:"All set."}),getDescription:e=>l.intl.formatMessage({id:"muP0dn",defaultMessage:"You’ll have access to your plan until <strong>{date}</strong>. After that, your backup will remain available but it’ll be limited to the 2 GB storage quota of the Dropbox Basic plan. If you exceed your quota, automatic backups will stop."},{date:e,strong:e=>s.default.createElement("strong",null,e)}),acceptButtonText:l.intl.formatMessage({id:"bGzf4A",defaultMessage:"I changed my mind, keep Backup"}),dismissButtonText:l.intl.formatMessage({id:"eyC1rP",defaultMessage:"Close"})};if(e===o.ProductPlanType.HS_DBX_PRO_BUNDLE)return{title:l.intl.formatMessage({id:"RQS9wP",defaultMessage:"Are you sure you want to cancel?"}),getDescription:(e,{dropboxDisplayName:t,spaceShortFormTb:a})=>l.intl.formatMessage({id:"w/CLLG",defaultMessage:"If you cancel today, you’ll be moved to a free plan on <strong>{date}</strong>, and you’ll lose access to {current_plan} features including:{br}<ul><li>{space_quota} of Dropbox space</li><li>Unlimited eSignatures</li><li>Any saved templates</li></ul>"},{br:s.default.createElement("br",null),current_plan:t,date:e,li:e=>s.default.createElement("li",{style:{marginBottom:"var(--spacing__unit--1)"}},e),strong:e=>s.default.createElement("strong",null,e),space_quota:a,ul:e=>s.default.createElement("ul",{style:{paddingLeft:0,listStylePosition:"inside"}},e)}),acceptButtonText:l.intl.formatMessage({id:"1wtgq1",defaultMessage:"Confirm cancel"}),dismissButtonText:l.intl.formatMessage({id:"ZyFp/R",defaultMessage:"Don’t cancel"})};return{title:l.intl.formatMessage({id:"Au8OeU",defaultMessage:"Plan downgrade scheduled"}),getDescription:e=>l.intl.formatMessage({id:"tQTXOk",defaultMessage:"Your plan is scheduled to be downgraded to Dropbox Basic on <strong>{date}</strong>. If you want to make any changes, first cancel your scheduled downgrade."},{date:e,strong:e=>s.default.createElement("strong",null,e)}),acceptButtonText:l.intl.formatMessage({id:"vhlPqJ",defaultMessage:"Cancel downgrade"}),dismissButtonText:l.intl.formatMessage({id:"DYOfu0",defaultMessage:"Dismiss"})}})(e),p=t.subState.formattedNextBillingDate,m=(function(e){var t,a,n,i;const s=(null===(a=null===(t=e.subState.plan)||void 0===t?void 0:t.content)||void 0===a?void 0:a.dropboxDisplayName())||"",l=(null===(i=null===(n=e.subState.plan)||void 0===n?void 0:n.content)||void 0===i?void 0:i.spaceShortFormTb())||"";return{dropboxDisplayName:s,spaceShortFormTb:l}})(t);return s.default.createElement(u.ChangeConfirmationModal,{acceptButtonDisabled:a,acceptButtonText:d,description:r(p,m),dismissButtonText:c,loadingContent:!1,onAccept:this.onAccept,onDismiss:this.closeModals,open:n,submitting:a,title:i})}}t.CancelChangesModalConfirmation=m,m.displayName="CancelChangesModalConfirmation"})),define("modules/clean/account_page/widgets/plan/views/cancellable_notifications_view",["require","exports","tslib","react","classnames","styled-components","modules/clean/react/components/css","modules/core/i18n","modules/clean/account_page/widgets/billing/payment_methods_util","modules/clean/teams/admin/widgets/billing_notifications/cancellable_item","modules/clean/account_page/constants","modules/clean/payments/skus/constants","modules/constants/trademark","modules/clean/account_page/widgets/plan/views/cancel_changes_modal","modules/clean/analytics","api_v2/user_client","modules/clean/active_user","modules/clean/ts_utils"],(function(e,t,a,n,i,s,l,o,r,d,c,u,p,m,g,_,f,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CancellableNotificationsView=t.CancellableNotificationsViewControl=void 0,n=a.__importDefault(n),i=a.__importDefault(i);const y=(s=a.__importDefault(s)).default.div`
  border-bottom: 1px solid var(--color__faint__background);
`;class b extends n.default.Component{constructor(){super(...arguments),this.state={},this.getFamilyPayerScheduledChange=e=>{(new _.UserApiV2Client).ns("growth_plans").rpc("get_scheduled_change_family_manager",void 0,{subjectUserId:f.mustGetActiveUserId()}).then(t=>{this.setState({payerHasScheduledDowngrade:t.has_scheduled_plan_change,payerScheduledChangeDate:t.scheduled_change_date},e)})},this.handleCancelSubscriptionAction=()=>{this.handleCancelActions(c.CancellationType.IND_SUBSCRIPTION)},this.handleCancelPlanAction=()=>{this.shouldLogScheduledProToPlusChange()&&g.ProEventsLogger.log("scheduled_plan_change_prompt_click",{cta:"cancel_change"}),this.handleCancelActions(c.CancellationType.PLAN)},this.handleCancelScheduleAction=()=>{this.shouldLogScheduledBillingChange()&&g.ProEventsLogger.log("scheduled_billing_change_prompt_click",{cta:"cancel_change",currentBillingSchedule:this.props.subStatus.subState.billingSchedule.id===u.ScheduleId.MONTHLY?"monthly":"yearly",nextBillingSchedule:this.props.subStatus.scheduledSubState.billingSchedule.id===u.ScheduleId.MONTHLY?"monthly":"yearly"}),this.handleCancelActions(c.CancellationType.SCHEDULE)},this.handleCancelAddonAction=e=>{this.handleCancelActions(c.CancellationType.ADDON,e)},this.handleCancelActions=(e,t)=>{const{subStatus:a,transitionPerformed:n,reOpenModalDialogAfterCancellation:i}=this.props;a&&m.CancelChangesModalConfirmationView.showInstance({transitionPerformed:n,cancellationType:e,addonFamilyType:t,reOpenModalDialogAfterCancellation:i})}}componentDidMount(){var e,t;(null===(t=null===(e=this.props.subStatus)||void 0===e?void 0:e.subState.plan)||void 0===t?void 0:t.productType)===u.ProductPlanType.FAMILY_NONPAYER&&this.getFamilyPayerScheduledChange(()=>{this.shouldLogScheduledFamilyMemberDowngradePrompt()&&g.ProEventsLogger.log("scheduled_family_member_downgrade_prompt_view")}),this.shouldLogScheduledProToPlusChange()&&g.ProEventsLogger.log("scheduled_plan_change_prompt_view"),this.shouldLogScheduledBillingChange()&&g.ProEventsLogger.log("scheduled_billing_change_prompt_view",{currentBillingSchedule:this.props.subStatus.subState.billingSchedule.id===u.ScheduleId.MONTHLY?"monthly":"yearly",nextBillingSchedule:this.props.subStatus.scheduledSubState.billingSchedule.id===u.ScheduleId.MONTHLY?"monthly":"yearly"})}shouldDisplayFamilyPayersScheduledChange(){var e,t;return(null===(t=null===(e=this.props.subStatus)||void 0===e?void 0:e.subState.plan)||void 0===t?void 0:t.productType)===u.ProductPlanType.FAMILY_NONPAYER&&!0===this.state.payerHasScheduledDowngrade&&void 0!==this.state.payerScheduledChangeDate}renderCancelSubscriptionNotification(){const{subStatus:e,scheduledForDowngrade:t}=this.props;if(e)return t?this.props.useAlternateNotifications?(g.ProEventsLogger.log("cancel_banner_view"),n.default.createElement(d.CancellableItemView,{title:o.intl.formatMessage({id:"97TpvL",defaultMessage:"Cancellation scheduled for <b>{date}</b>."},{date:e.formattedNextBillingDate,b:e=>n.default.createElement("b",null,e)}),handleAction:this.handleCancelSubscriptionAction,useCTA:!0,useAlternateStyle:!0})):n.default.createElement(d.CancellableItemView,{title:o.intl.formatMessage({id:"4c06XP",defaultMessage:"Scheduled plan change"}),description:o.intl.formatMessage({id:"Ai+Hmi",defaultMessage:"Dropbox Basic"}),handleAction:this.handleCancelSubscriptionAction,useCTA:!0}):void 0}shouldRenderDowngradePlanNotif(){const{subStatus:e,scheduledForDowngrade:t}=this.props;if(!e||t)return!1;const a=e.scheduledSubState;if(!a)return!1;const n=e.subState.plan,i=a.plan;return!(!n||!i)&&(n.productType!==i.productType||n.productType===i.productType&&n.productSpec!==i.productSpec)}shouldRenderBillingChangeNotif(){const{subStatus:e,scheduledForDowngrade:t}=this.props;if(!e||t)return!1;const a=e.scheduledSubState;return!!(a&&a.billingSchedule&&e.subState.billingSchedule)&&e.subState.billingSchedule.id!==a.billingSchedule.id}shouldLogScheduledProToPlusChange(){if(this.shouldRenderDowngradePlanNotif()){const e=this.props.subStatus.subState.plan,t=this.props.subStatus.scheduledSubState.plan;return e.productType===u.ProductPlanType.PROFESSIONAL&&t.productType===u.ProductPlanType.PLUS}return!1}shouldLogScheduledBillingChange(){return this.shouldRenderBillingChangeNotif()}shouldLogScheduledFamilyMemberDowngradePrompt(){return this.shouldDisplayFamilyPayersScheduledChange()}renderDowngradePlanNotification(){if(this.shouldRenderDowngradePlanNotif()){const e=this.props.subStatus.scheduledSubState.plan,t=o.intl.formatMessage({id:"McVRyL",defaultMessage:"Dropbox {scheduled_plan}"},{scheduled_plan:e.displayName()});return n.default.createElement(d.CancellableItemView,{title:o.intl.formatMessage({id:"4c06XP",defaultMessage:"Scheduled plan change"}),description:t,handleAction:this.handleCancelPlanAction,useCTA:!0,className:"cancel-plan-schedule"})}}renderFamilyMemberScheduledChange(){if(this.shouldDisplayFamilyPayersScheduledChange())return n.default.createElement(d.CancellableItemView,{title:o.intl.formatMessage({id:"27UqZZ",defaultMessage:"Your plan will change from {dropbox_family} to {dropbox_basic}"},{dropbox_family:p.DROPBOX_FAMILY,dropbox_basic:p.DROPBOX_BASIC}),className:"cancel-plan-schedule"})}renderScheduledChange(){if(this.shouldRenderBillingChangeNotif()){const e=this.props.subStatus.scheduledSubState.billingSchedule.scheduleDescriptionAdjective;return n.default.createElement(d.CancellableItemView,{title:o.intl.formatMessage({id:"pSiFZ2",defaultMessage:"Scheduled billing period"}),description:o.intl.formatMessage({id:"HCfuYu",defaultMessage:"{billing} billing"},{billing:e.charAt(0).toUpperCase()+e.slice(1)}),handleAction:this.handleCancelScheduleAction,useCTA:!0,className:"cancel-billing-schedule"})}}getAddonCancellationNotificationText(e){switch(e){case u.ProductAddonType.EVH:return o.intl.formatMessage({id:"ruwa4d",defaultMessage:"Remove extended version history"});case u.ProductAddonType.QUOTA:return o.intl.formatMessage({id:"OgTPbs",defaultMessage:"Remove storage space"});default:return}}renderAddonChange(){const{subStatus:e,scheduledForDowngrade:t}=this.props;if(!e||t)return;const a=e.scheduledSubState;if(!a)return;const i=e.subState.addons.skus,s=a.addons.skus;if(i.length>s.length){const e=s.map(e=>e.productType);return i.filter(t=>-1===e.indexOf(t.productType)).map((e,t)=>n.default.createElement(d.CancellableItemView,{key:t,title:o.intl.formatMessage({id:"3YA4ZU",defaultMessage:"Scheduled add-on change"}),description:this.getAddonCancellationNotificationText(e.productType),handleAction:()=>{this.handleCancelAddonAction(e.productType)},useCTA:!0,className:"cancel-evh-schedule"}))}}appendAllCancellationTypes(e){e.push(this.renderCancelSubscriptionNotification()),e.push(this.renderDowngradePlanNotification()),e.push(this.renderScheduledChange()),e.push(this.renderAddonChange())}render(){const{displaySingleChangeCancellationItem:e,scheduledForDowngrade:t,subStatus:a,paymentInfo:s,hasLicenseKey:l,displayNewTotal:d}=this.props;if(!a)return n.default.createElement("noscript",null);if(!s||r.shouldHideBillingChange(s.gateway_id,s.is_reseller_billing))return n.default.createElement("noscript",null);if(!this.props.useAlternateNotifications&&t&&!this.shouldDisplayFamilyPayersScheduledChange())return n.default.createElement("noscript",null);let p=[];if(e)switch(e){case c.CancellationType.IND_SUBSCRIPTION:p.push(this.renderCancelSubscriptionNotification());break;case c.CancellationType.PLAN:p.push(this.renderDowngradePlanNotification());break;case c.CancellationType.SCHEDULE:p.push(this.renderScheduledChange());break;case c.CancellationType.ADDON:p.push(this.renderAddonChange());break;case c.CancellationType.FAMILY_NONPAYER:p.push(this.renderFamilyMemberScheduledChange());break;case c.CancellationType.ALL:this.appendAllCancellationTypes(p);break;case c.CancellationType.LICENSES:break;default:h.enforceExhaustive(e)}if(p=p.filter(e=>void 0!==e),!p.length)return n.default.createElement("noscript",null);let m="";t||!d||this.shouldDisplayFamilyPayersScheduledChange()||(m=o.intl.formatMessage({id:"BunHhw",defaultMessage:"Your new {schedule} total will be {total}."},{schedule:u.productScheduleToProductScheduleDescription(a.finalSubState.plan.schedule),total:a.nextBillingSummary.total.toString()}));const g=this.shouldDisplayFamilyPayersScheduledChange()?this.state.payerScheduledChangeDate:a.subState.formattedNextBillingDate;let _=n.default.createElement("div",{className:"cancellable-scheduled-notifications cancellable-scheduled-notifications__header"},o.intl.formatMessage({id:"/3HS66",defaultMessage:"Changes are scheduled for <strong>{date}</strong>."},{date:g,strong:e=>n.default.createElement("strong",null,e)})," ",m),f=i.default("cancellable-scheduled-notifications cancellable-scheduled-notifications__items",{"cancellable-scheduled-notifications__items--alternate":this.props.useAlternateNotifications});return this.props.useAlternateNotifications&&(_=null,f=i.default(f,"cancellable-scheduled-notifications__items--alternate")),n.default.createElement(y,{className:"cancellable-scheduled-notifications personal-cancellable-scheduled-notifications"},_,!l&&n.default.createElement("div",{className:f},p))}}t.CancellableNotificationsViewControl=b,b.displayName="CancellableNotificationsViewControl",t.CancellableNotificationsView=l.requireCssWithComponent(b,["/static/css/teams/admin/widgets/billing_notifications/cancellable_scheduled_notifications-vflBpufaG.css"])})),define("modules/clean/account_page/widgets/plan/views/change_confirmation_modal",["require","exports","tslib","react","styled-components","spectrum/modal/index","dig-components/buttons","modules/core/i18n","modules/clean/static_urls","dig-components/typography"],(function(e,t,a,n,i,s,l,o,r,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ChangeConfirmationModal=void 0,n=a.__importDefault(n);const c=(i=a.__importDefault(i)).default(s.Modal)`
  color: var(--color__standard__text);
  display: flex;
  flex-direction: column;
  font-size: var(--type__body__standard--fontsize);
  border-radius: 0;
`,u=i.default.div`
  font-family: var(--type__body__standard--fontfamily);
  padding: var(--spacing__unit--3);
`,p=i.default(d.Title)`
  font-family: var(--type__title__small--fontfamily);
  font-size: var(--type__title__small--fontsize);
  font-weight: var(--type__title__small--fontweight_strong);
  margin-bottom: var(--spacing__unit--3);
`,m=i.default.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  height: 65px;
  padding-left: var(--spacing__unit--3);
  padding-right: var(--spacing__unit--3);

  .change-confirmation-modal__btn-submit {
    margin-left: var(--spacing__base_unit);
  }
`,g=i.default.div`
  white-space: nowrap;
`,_=i.default.div`
  display: flex;
  justify-content: center;
  padding: 100px;
`;class f extends n.default.Component{constructor(){super(...arguments),this.handleAccept=()=>{this.props.onAccept()},this.handleDismiss=()=>{this.props.onDismiss()}}render(){const{acceptButtonDisabled:e,acceptButtonText:t,description:a,dismissButtonText:i,loadingContent:s,open:f,link:h,title:y,submitting:b}=this.props;let v;return v=s?n.default.createElement(_,{className:"change-confirmation-modal__loading-indicator"},n.default.createElement("img",{src:r.static_url("/static/images/icons/ajax-loading-small-vfl3Wt7C_.gif"),alt:o.intl.formatMessage({id:"60HSB/",defaultMessage:"Loading"})})):n.default.createElement("div",{className:"change-confirmation-modal"},n.default.createElement(u,null,n.default.createElement(p,{className:"change-confirmation-modal__title"},y),n.default.createElement(d.Text,{className:"change-confirmation-modal__description"},a)),n.default.createElement(m,null,n.default.createElement(g,null,h),n.default.createElement("div",null,n.default.createElement(l.Button,{className:"change-confirmation-modal__btn-cancel",variant:"opacity",disabled:b,onClick:this.handleDismiss},i),n.default.createElement(l.Button,{className:"change-confirmation-modal__btn-submit",variant:"primary",disabled:e,onClick:this.handleAccept},t)))),n.default.createElement(c,{appElement:document.getElementById("embedded-app")||document.body,ariaLabel:o.intl.formatMessage({id:"qgM6UX",defaultMessage:"Change Confirmation Modal"}),className:"ChangeConfirmationModal",displayCloseButton:!i,onRequestClose:this.handleDismiss,open:f,overlayClickClose:!1,width:560},v)}}t.ChangeConfirmationModal=f,f.displayName="ChangeConfirmationModal"})),define("modules/clean/account_page/widgets/plan/views/change_plan_modal",["require","exports","tslib","modules/core/browser","modules/core/notify","react","modules/clean/deprecated_ajax/ajax_jquery","modules/clean/react/components/css","modules/clean/react/badge","modules/clean/teams/admin/widgets/admin_priced_list/admin_priced_list","modules/clean/teams/admin/widgets/admin_priced_list/admin_priced_list_item","modules/clean/account_page/widgets/plan/constants","modules/constants/individual_invoice_modal","modules/clean/account_page/widgets/plan/views/cancel_changes_modal","modules/clean/account_page/widgets/plan/views/confirm_age_modal","modules/clean/account_page/widgets/plan/views/plus_to_family_modal","modules/clean/payments/validation","modules/clean/account_page/widgets/plan/views/cancellable_notifications_view","modules/clean/account_page/constants","modules/clean/payments/cash","modules/clean/payments/skus/catalog_sku","modules/clean/dbmodal_stack","modules/clean/account_page/widgets/plan/views/individual_inline_payment_method","modules/clean/react/components/modal","modules/clean/analytics","modules/clean/payments/skus/constants","modules/clean/payments/skus/subscription_status","modules/core/i18n","modules/clean/account_page/util","modules/clean/active_user","modules/clean/react/browse/uri_helper","modules/clean/static_urls","modules/clean/react/arbor/aspen/elements/arbor_inputs","modules/clean/react/payments/error/browser_update_required_modal","modules/clean/react/payments/update_individual_billing/update_individual_billing_modal_loader","modules/clean/react/payments/update_individual_billing/update_individual_store_creator","modules/clean/account_page/widgets/plan/views/update_billing_info","modules/clean/payments/three_ds_helper","modules/clean/family/constants","modules/clean/account_page/widgets/plan/views/disband_family_confirmation_modal","modules/clean/payments/skus/sku_content","modules/clean/account_page/widgets/plan/views/change_plan_preview_summary","apiql/client/components/account-gql","dropbox/proto/age_gating_types/status","@apollo/react-hooks","apollo-client","modules/clean/account_page/widgets/plan/api","modules/clean/subscription/tools/amp_logger","modules/clean/account_page/widgets/plan/revenue_api_migration_utils","modules/clean/account_page/widgets/plan/revenue_api_migration_comparisons","modules/clean/account_page/widgets/plan/types","modules/clean/react/campaigns/campaign_events_api","modules/clean/account_page/widgets/plan/strings"],(function(e,t,a,n,i,s,l,o,r,d,c,u,p,m,g,_,f,h,y,b,v,M,S,P,E,C,A,T,I,w,D,N,L,x,k,R,B,O,F,U,q,V,Y,j,H,G,z,Q,W,K,X,Z,J){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ChangePlanModalView=t.ChangePlanOrigin=t.ChangePlanMode=void 0,n=a.__importStar(n),s=a.__importDefault(s),l=a.__importStar(l);const $=[C.ProductPlanType.STANDARD,C.ProductPlanType.PLUS,C.ProductPlanType.PROFESSIONAL,C.ProductPlanType.FAMILY_PAYER,C.ProductPlanType.HS_DBX_PRO_BUNDLE];var ee,te;(function(e){e.DEFAULT="default",e.CONFIRM="confirm"})(ee=t.ChangePlanMode||(t.ChangePlanMode={})),(function(e){e.DEFAULT="default",e.PLUS_TO_FAMILY="plus_to_family",e.ESIGN_UPSELL_V1="esign_upsell_v1",e.ESIGN_UPSELL_V2="esign_upsell_v2",e.ESIGN_SDK_FILE_VIEWER_UPSELL_V1="esign_sdk_file_viewer_upsell_v1"})(te=t.ChangePlanOrigin||(t.ChangePlanOrigin={}));class ae extends s.default.Component{constructor(e){super(e),this._isMounted=null,this._timeModalOpened=null,this._loggedRevAPIChangePlanPreviews={},this.setLoggedRevAPIChangePlanPreviews=e=>{e.forEach(e=>this._loggedRevAPIChangePlanPreviews[e.code]=!1)},this.onLoadTransitionsError=()=>{i.Notify.error(T.intl.formatMessage({id:"HcIX4g",defaultMessage:"Failed to load modal."})),this.modalLogger.logModalError("modal_init"),this.closeModals()},this.logChangePlan=(e,t,a)=>{const{subStatus:n}=this.state;n&&n.subState.billingSchedule&&(this.log("change_plan_modal_change_plan",Object.assign({from_product_plan_type:C.ProductPlanType[e],to_product_plan_type:C.ProductPlanType[t]},a)),this.modalLogger.logModalSuccess())},this.onChangePlanConfirmation=()=>{var e,t;const{subStatus:a,basicSkuQuotaGb:n}=this.state,i=this.getChosenSku();(null===(t=null===(e=null==a?void 0:a.subState)||void 0===e?void 0:e.plan)||void 0===t?void 0:t.productType)===C.ProductPlanType.FAMILY_PAYER&&(null==i?void 0:i.productType)!==C.ProductPlanType.FAMILY_PAYER&&n?(M.DBModalStack.register(U.FAMILY_DISBAND_MODAL_GO_BACK,()=>{ae.showInstance(this.props)}),U.showDisbandModal({confirmChangePlan:this.onAccept,basicSkuQuotaGb:n,displayFamilyRoomCheckbox:this.state.displayFamilyRoomCheckbox})):this.ageGatingCheck()},this.onAccept=(e,t)=>{var a;const{subStatus:s}=this.state;if(!(null==s?void 0:s.subState.plan))return;const o=this.getChosenSku(),r=null===(a=null==s?void 0:s.subState.plan)||void 0===a?void 0:a.productType,d=null==o?void 0:o.productType;let c;switch(d){case C.ProductPlanType.PLUS:case C.ProductPlanType.STANDARD:c=X.PerformPlanTransition.PLUS;break;case C.ProductPlanType.PROFESSIONAL:c=X.PerformPlanTransition.PROFESSIONAL;break;case C.ProductPlanType.FAMILY_PAYER:c=X.PerformPlanTransition.FAMILY_PAYER;break;case C.ProductPlanType.SYNC_EVERYTHING:c=X.PerformPlanTransition.BACKUP;break;case C.ProductPlanType.HS_DBX_PRO_BUNDLE:c=X.PerformPlanTransition.HS_DBX_PRO_BUNDLE}const{campaignContext:u}=this.props;u&&Z.logCampaignClick(u,"change-plan-modal"),this.setState(e=>({showErrors:!0}));const{vat:p,accountPaymentInfo:m,threeDsData:g,handle3DsMessage:_,shouldShowPlusToFamilyModal:f}=this.state;if(!(null==m?void 0:m.vat_country_code)||!this.vatValidator(m.vat_country_code,p))return;if(!(c&&r&&d))return void i.Notify.error(T.intl.formatMessage({id:"WDKLwG",defaultMessage:"There was an error changing the plan!"}));this.setState(e=>({submitting:!0})),this.log("de_change_plan_modal_confirm_change_click",t);const h={transition_change_type:c,browser_info:O.collectBrowserInfo(),three_ds_data:g};this.updateThreeDsData(""),p&&(h.vat=p,this.log("vat_provided_on_upgrade",t)),l.WebRequest({url:"/account/perform_personal_transition",data:h,subject_user:this.getUserId(),success:e=>{const a=JSON.parse(e);if(a.redirect)return n.redirect(a.redirect);i.Notify.success(T.intl.formatMessage({id:"zpOY3S",defaultMessage:"You’ve changed your plan!"})),this.removeShowModalParams(),this.logChangePlan(r,d,t),this.props.transitionPerformed&&this.props.transitionPerformed();const s=V.isPlanChangeUpgrade(r,d);return(null==o?void 0:o.productType)===C.ProductPlanType.PROFESSIONAL&&s?n.redirect("/professional_onboarding"):(null==o?void 0:o.productType)===C.ProductPlanType.FAMILY_PAYER?f?n.redirect(F.FAMILY_INVITE_URI_PATH_SUCCESS):n.redirect(F.FAMILY_INVITE_URI_PATH):(document.dispatchEvent(new Event("db:change_plan_modal:plan_changed")),this.closeModals(),void((null==o?void 0:o.productType)===C.ProductPlanType.HS_DBX_PRO_BUNDLE&&this.props.launchHelloSignDeepIntegration&&this.props.launchHelloSignDeepIntegration()))},error:(t,a,n)=>{e&&e(),this.setState(e=>({submitting:!1}));let s=!1,l=null;try{l=JSON.parse(n)}catch(e){}finally{_&&l&&(s=!0,_(l))}s?this.modalLogger.logModalError("3ds"):(i.Notify.error(T.intl.formatMessage({id:"PMSOip",defaultMessage:"There was an error changing the plan!"})),this.modalLogger.logModalError("modal_submit"),this.closeModals())}})},this.ageGatingCheck=(e,t)=>{const{subStatus:a,ageGatingResult:i}=this.state;if(!(null==a?void 0:a.subState.plan))return;const s=this.getChosenSku(),l=a.subState.plan.productType,o=null==s?void 0:s.productType;if(i===j.age_gating_types.AgeGatingStatus.PENDING_AGE_CAPTURE&&o===C.ProductPlanType.FAMILY_PAYER)g.ConfirmAgeModalView.showInstance({currentPlan:C.ProductPlanType[l],onAccept:this.onAccept,onErrorHandler:e,loggingExtra:t});else{if(i===j.age_gating_types.AgeGatingStatus.WILL_BE_DISABLED)return n.redirect("/age_gating/block");this.onAccept(e,t)}},this.updateThreeDsData=e=>{this.setState({threeDsData:e})},this.onDismiss=()=>{this.log("de_change_plan_modal_cancel_click");const{campaignContext:e}=this.props;e&&Z.logCampaignDismissed(e)},this.closeModals=()=>{P.Modal.close()},this.renderVat=()=>{let e=null;if(!this.vatDisplayEnabled)return e;const{vat:t,accountPaymentInfo:a,showErrors:n}=this.state,i=null==a?void 0:a.vat_country_code;if(i){const a=f.getVatPrefix(i),l=this.getVatErrorMessage(i),o=this.getVatLabel(i);e=s.default.createElement(L.ArborTextInput,{className:"jest-vat-input",name:"vat",placeholderText:a,labelText:o,isValid:!n||this.vatValidator(i,t),errorText:l,value:t,onChange:this.onVatChange})}return e},this.onVatChange=(e,t,a)=>{const n=a;this.setState(e=>({vat:n,showErrors:!1}))},this.renderPaymentMethod=()=>{const{accountPaymentInfo:e}=this.state,{hideUpdateBillingInfo:t}=this.props;if(!this.isPlanScheduledToChange())return s.default.createElement("div",{className:"upgrade-payment-method-link"},s.default.createElement(S.IndividualInlinePaymentMethodView,{accountPaymentInfo:e,paymentErrorMessage:T.intl.formatMessage({id:"qWYni+",defaultMessage:"Please update your billing information to change your plan."}),renderUpdateLink:t?void 0:s.default.createElement(B.UpdateBillingInfoLink,{updateBillingCTA:this.updateBillingInfo})}))},this.updateBillingInfo=e=>{e.stopPropagation(),e.preventDefault(),this.log("de_update_billing_info_click"),this.showUpdateBillingModal()},this.showUpdateBillingModal=()=>{P.Modal.close(),M.DBModalStack.register(R.BILLING_INFO_UPDATED,()=>{z.resetApolloStore(),ae.showInstance(this.props)}),this.props.browserUpdateRequired?x.BrowserUpdateModalLoader.showInstance():k.IndividualUpdateBillingModalLoader.showInstance()},this.handleCancelScheduleAction=e=>{this.handleCancelActions(y.CancellationType.SCHEDULE),e.preventDefault()},this.handleCancelActions=e=>{const{subStatus:t}=this.state,{transitionPerformed:a}=this.props;return t&&m.CancelChangesModalConfirmationView.showInstance({transitionPerformed:a,cancellationType:e,reOpenModalDialogAfterCancellation:!0}),!1},this.transitionPerformedClosure=e=>{if(this.props.transitionPerformed)return this.props.transitionPerformed()},this.state={loadingContent:!0,submitting:!1,type:C.ProductPlanType.STANDARD,showErrors:!1,vat:""},this.modalLogger=Q.getSubscriptionAMPLogger({ns:"personal",modal:Q.ModalTypes.CHANGE_PLAN_MODAL})}getUrlOption(e){let t=e;const a=n.get_href().match(/option=([a-zA-Z_]*)/);if(a&&a.length>1){const n=a[1];"plus"===n&&(t=e===C.ProductPlanType.PROFESSIONAL?C.ProductPlanType.PLUS:e),"pro"===n&&(t=C.ProductPlanType.PROFESSIONAL),"family"===n&&(t=C.ProductPlanType.FAMILY_PAYER),"hellosign_dbx_pro"===n&&(t=C.ProductPlanType.HS_DBX_PRO_BUNDLE)}return t}static showInstance(e){P.Modal.showInstance(s.default.createElement(ae.ChangePlanModal,Object.assign({},e)))}componentDidMount(){this._isMounted=!0,this._timeModalOpened=Date.now(),this.loadPlanTransitions()}componentWillUnmount(){this._isMounted=!1}get productTypeStr(){var e,t,a;return null===(a=null===(t=null===(e=this.state.subStatus)||void 0===e?void 0:e.subState)||void 0===t?void 0:t.plan)||void 0===a?void 0:a.productType.toString()}logTTI(){if(this._timeModalOpened){const e=Date.now()-this._timeModalOpened;this.modalLogger.setProductPlanType(this.productTypeStr),this.modalLogger.logModalTTI(e)}}retrieveViewModel(e,t,a){const n=a?{vat:a}:void 0;l.WebRequest({url:"/account/ajax_change_plan",data:n,subject_user:this.getUserId(),success:t=>{const a=JSON.parse(t);this._isMounted&&(this.log("change_plan_modal_available_plans_data_loaded"),e(a))},error:t})}onLoadPlanTransitions(e){this.setState(t=>{const a=A.SubscriptionStatus.deserialize(e.serializedSubStatus),n=W.convertLegacyPaymentInfo(e.paymentMethod);let s;if(n.active_payment_method_type===Y.AccountPaymentInfoType.Card){s=new O.ThreeDsHandler({updateThreeDsData:this.updateThreeDsData,submitThreeDsChallenge:this.ageGatingCheck,triggerThreeDsChallenge:()=>{},submitThreeDsFingerprint:this.ageGatingCheck,triggerThreeDsFingerprint:()=>{},isDesktop:!1,isSeleniumChangesTest:!1}).handle3DsMessage}const l=a.finalSubState,{admissiblePlans:o,defaultSelectedPlan:r}=this.props;if(!l.billingSchedule||!l.plan)throw"A base plan is required, in order to change it.";let d=this.getUrlOption(r||a.subState.plan.productType);const c=a.subState.planSku.productType===C.ProductPlanType.PLUS||a.subState.planSku.productType===C.ProductPlanType.STANDARD,u=e.availablePlans.map(e=>v.CatalogSku.deserialize(e)).filter(e=>!o||o.includes(e.productType)),p=u.concat([a.finalSubState.planSku]).sort((e,t)=>{if(!e.productType||!t.productType)return 0;return $.indexOf(e.productType)-$.indexOf(t.productType)});p.every(e=>e.productType!==d)&&(d=a.subState.plan.productType);let m=!1;this.props.origin===te.PLUS_TO_FAMILY&&(m=_.shouldShowPlusToFamilyModal(c,p,e.expPlusToFamilyUpsellVariant),m?d=C.ProductPlanType.FAMILY_PAYER:i.Notify.error(T.intl.formatMessage({id:"lBd15f",defaultMessage:"You cannot change plans at this time."})));const f=new q.QuotaFormatter(e.basicSkuQuotaGb),h=e.growthRevapiPaPlanManagementCompareData;return this.setLoggedRevAPIChangePlanPreviews(u),g.reportMetric("change_plan_age_gating",{ageGatingStatus:`${e.ageGatingResult}`}),{loadingContent:!1,subStatus:a,accountPaymentInfo:n,type:d,handle3DsMessage:s,basicSkuQuotaGb:f.spaceShortFormGb(),shouldShowPlusToFamilyModal:m,availablePlans:u,allSubSkus:p,growthRevapiPaPlanManagementCompareData:h,displayFamilyRoomCheckbox:e.displayFamilyRoomCheckbox,ageGatingResult:e.ageGatingResult}},this.logTTI)}loadPlanTransitions(){this.retrieveViewModel(e=>{this.onLoadPlanTransitions(e)},this.onLoadTransitionsError)}getUserId(){let e=null;return e=this.props.userIdOverride?this.props.userIdOverride:w.mustGetActiveUserId(),e}getChosenSku(){if(this.state.allSubSkus)return this.state.allSubSkus.filter(e=>e.productType===this.state.type).pop()}getChosenSkuCode(){const e=this.getChosenSku();return e?e.code:""}get finalPlanType(){const{subStatus:e}=this.state;return e&&e.finalSubState.plan&&e.finalSubState.plan.productType}get hasTypeChanged(){return this.finalPlanType&&this.finalPlanType!==this.state.type}get hasCurrentPlanChanged(){return this.hasTypeChanged}get subStatusScheduleId(){const{subStatus:e}=this.state;return e&&e.finalSubState.billingSchedule?e.finalSubState.billingSchedule.id:C.ScheduleId.MONTHLY}log(e,t){E.ProEventsLogger.log(e,Object.assign(Object.assign({},t),{origin:this.props.origin}))}removeShowModalParams(){const e=n.get_href().match(/modal=([a-zA-Z_]*)/);if(e&&e.length>1){"plan"===e[1]&&window.history.replaceState({},document.title,n.get_href().split("?")[0])}}changeProductPlan(e){this.setState(t=>({type:e}))}changeProductPlanClosure(e){return()=>{this.changeProductPlan(e)}}renderPlanItems(){const{type:e,allSubSkus:t,subStatus:a}=this.state;if(t&&a&&a.subState.billingSchedule&&a.subState.plan&&a.subState.planSku&&a.finalSubState.plan&&a.finalSubState.planSku&&a.scheduledSubState&&a.scheduledSubState.billingSchedule)return t.map((t,n)=>{if(!t||!t.billingSchedule)return;let i,l=!1;const o=a.isOnTrial?a.finalSubState.plan:a.subState.plan;let d;o&&t.productType===o.productType&&(i=T.intl.formatMessage({id:"dhdo+T",defaultMessage:"(current plan)"}),l=!0),t.productType===C.ProductPlanType.TRANSFER||(null==o?void 0:o.productType)===C.ProductPlanType.TRANSFER?d=s.default.createElement("span",null,s.default.createElement("br",null),s.default.createElement("a",{href:"https://help.dropbox.com/accounts-billing/plans-upgrades/dropbox-transfer-plan",target:"_blank",rel:"noreferrer noopener"},T.intl.formatMessage({id:"Vu1ffz",defaultMessage:"See plan details"}))):t.productType===C.ProductPlanType.SYNC_EVERYTHING?d=s.default.createElement("span",null,s.default.createElement("br",null),s.default.createElement("a",{href:"https://help.dropbox.com/accounts-billing/plans-upgrades/dropbox-backup-plan",target:"_blank",rel:"noreferrer noopener"},T.intl.formatMessage({id:"qSkDre",defaultMessage:"See plan details"}))):t.productType!==C.ProductPlanType.HS_DBX_PRO_BUNDLE&&(d=s.default.createElement("span",null,s.default.createElement("br",null),s.default.createElement("a",{href:"/plans",target:"_blank",rel:"noreferrer noopener"},T.intl.formatMessage({id:"wo0qrl",defaultMessage:"See plan details"}))));const u=T.intl.formatMessage({id:"q0DZmp",defaultMessage:"Dropbox {plan_name}"},{plan_name:t.displayName()});let p=void 0;this.props.mode===ee.CONFIRM&&t.productType===C.ProductPlanType.PROFESSIONAL&&(p={variant:r.BadgeVariant.NEW,color:r.BadgeColor.NEON_GREEN});const m=t.productType===(null==o?void 0:o.productType);let g;return m&&this.props.hideDetailsCurrentPlan?d=s.default.createElement(s.default.Fragment,null):g=o&&m?J.getPlanFeatureDescription(o,this.props.getPlanFeatureDescriptionOptions):J.getPlanFeatureDescription(t,this.props.getPlanFeatureDescriptionOptions),s.default.createElement(Y.GetAccountDeprecatedPlanChangePreviewComponent,{key:t.code,skip:l,variables:{vat:this.vatID,sku_code:t.code,country_override:D.getQueryArgs().country_override}},a=>{var n;const o=a.loading,r=null===(n=a.data)||void 0===n?void 0:n.account_deprecated_plan_change_preview,m=(null==r?void 0:r.formatted_base_price)?null==r?void 0:r.formatted_base_price:t.displayCost.toString();return s.default.createElement(c.AdminPricedListItem,{className:`test-plan-item-${t.productType} ${l?"test-current-plan-item":""}`,key:t.code,isSelected:e===t.productType,title:u,titleWarningText:void 0,titleSecondaryText:i,description:g,detailsLink:d,loadingPrice:o,priceString:m,unit:t.billingSchedule.id===C.ScheduleId.MONTHLY?T.intl.formatMessage({id:"YRatzw",defaultMessage:"per month"}):T.intl.formatMessage({id:"4Wu5r9",defaultMessage:"per year"}),onClick:this.changeProductPlanClosure(t.productType),disableItem:this.isPlanScheduledToChange(),badge:p})})})}renderBillingSection(){return s.default.createElement("div",null,s.default.createElement(d.AdminPricedList,null,this.renderPlanItems()),this.renderVat())}getVatErrorMessage(e){return"CA"===e?T.intl.formatMessage({id:"uNWF6T",defaultMessage:"Please enter a valid Tax ID, e.g. {examples}."},{examples:f.getVatExamples(e).join(", ")}):T.intl.formatMessage({id:"1dRSXy",defaultMessage:"Please enter a valid VAT number, e.g. {examples}."},{examples:f.getVatExamples(e).join(", ")})}getVatLabel(e){return"CA"===e?T.intl.formatMessage({id:"XDZLLI",defaultMessage:"Optional Tax ID (ex: GST, HST, QST)"}):T.intl.formatMessage({id:"jabE//",defaultMessage:"VAT number (optional)"})}vatValidator(e,t){return!t||f.validateVat(e,t)}isScheduledToChange(){return this.isPlanScheduledToChange()||this.isBillingScheduleToChange()||this.isEvhScheduledToChange()}isEvhScheduledToChange(){const{subStatus:e}=this.state;return!(!e||!e.scheduledSubState)&&e.subState.quantityForEvhAddOn()!==e.scheduledSubState.quantityForEvhAddOn()}isPlanScheduledToChange(){const{subStatus:e}=this.state;return!!(e&&e.subState.plan&&e.finalSubState.plan)&&e.subState.plan.productType!==e.finalSubState.plan.productType}isBillingScheduleToChange(){const{subStatus:e}=this.state;return!!(e&&e.subState.billingSchedule&&e.finalSubState.billingSchedule)&&e.subState.billingSchedule.id!==e.finalSubState.billingSchedule.id}getPlanNameWithEvhText(e){const{subStatus:t}=this.state;return t&&t.scheduledSubState&&t.scheduledSubState.quantityForEvhAddOn()>0?e+" "+T.intl.formatMessage({id:"NsQt0k",defaultMessage:"+ extended version history"}):e}renderScheduleTransitionText(e){const{subStatus:t}=this.state;if(!t||!t.subState.plan)return;const a=s.default.createElement("a",{href:"#",onClick:this.handleCancelScheduleAction},T.intl.formatMessage({id:"e+rwVi",defaultMessage:"Cancel change"}));if(this.isPlanScheduledToChange())return s.default.createElement("span",{className:"plan-transition"},T.intl.formatMessage({id:"5eLA6l",defaultMessage:"You’ve already requested a change to your plan. If you want to choose a different plan or billing period, first cancel your pending change."})," ",a);let n;if(!this.hasTypeChanged&&t.currentBillingSummary){const{scheduledSubState:e,nextBillingSummary:a,subState:i,currentBillingSummary:l}=t;n=this.isScheduledToChange()?T.intl.formatMessage({id:"EkFAkT",defaultMessage:"Starting on {date}, we’ll bill you once a {schedule_noun} for your Dropbox {plan}. Your new {schedule} total will be {scheduled_total}."},{plan:this.getPlanNameWithEvhText(e.plan.displayName()),date:i.formattedNextBillingDate,schedule:e.billingSchedule.scheduleDescriptionAdjective,schedule_noun:e.billingSchedule.scheduleDescriptionNoun,scheduled_total:b.Cash.formatWithTaxLabels(a.total,a),strong:e=>s.default.createElement("strong",null,e)}):T.intl.formatMessage({id:"H2ofu+",defaultMessage:"Your Dropbox {plan} plan will renew on {date}. Your current {schedule} total is {recurring_total}."},{plan:this.getPlanNameWithEvhText(i.plan.displayName()),schedule:i.billingSchedule.scheduleDescriptionAdjective,recurring_total:b.Cash.formatWithTaxLabels(l.total,l),date:i.formattedNextBillingDate})}if(this.hasTypeChanged&&e){const a=I.logClickAndRedirect("de_cancel_link_click","/help/billing/cancel-dropbox-plus",{from:"change_plan_modal"}),i=I.logClickAndRedirect("de_legal_link_click","/help/billing/plus-refund",{from:"change_plan_modal"});n=s.default.createElement(V.ChangePlanPreviewSummary,{subChangePreview:e,onClickCancel:a,onClickLegal:i,currentSku:t.subState.planSku,chosenSku:this.getChosenSku(),chosenSkuName:this.getPlanNameWithEvhText(this.getChosenSku().displayName())})}return n?s.default.createElement("div",null,e||this.isScheduledToChange()?s.default.createElement("span",{className:"change-summary"},T.intl.formatMessage({id:"eSqPLW",defaultMessage:"Change summary"})):null,s.default.createElement("p",{className:"plan-transition"},n)):void 0}renderChangeFooter(e,t){let a;return t===G.NetworkStatus.loading||t===G.NetworkStatus.setVariables?s.default.createElement("div",{className:"change-plan-modal__loading-indicator"},s.default.createElement("img",{src:N.static_url("/static/images/icons/ajax-loading-small-vfl3Wt7C_.gif"),alt:T.intl.formatMessage({id:"QNTZp/",defaultMessage:"Loading"})})):t===G.NetworkStatus.error?(this.modalLogger.logModalError("change_preview","noncritical"),s.default.createElement("div",{className:"change-plan-modal__loading-indicator"},T.intl.formatMessage({id:"EUUBQX",defaultMessage:"There was an unexpected error. Please try again later or contact support."}))):(this.isPlanScheduledToChange()||(a=this.renderPaymentMethod()),s.default.createElement("div",{className:"plan-footer u-font-meta"},this.renderScheduleTransitionText(e),a))}acceptButtonDisabled(e){const{accountPaymentInfo:t}=this.state,{loadingContent:a,submitting:n}=this.state;return!(!a&&!n&&e&&t)||!this.hasUserSelectedDifferentPlan()}isValidVatCountry(){const{accountPaymentInfo:e}=this.state;return!!((null==e?void 0:e.vat_country_code)&&f.hasVat(e.vat_country_code))}get vatID(){const{accountPaymentInfo:e,vat:t}=this.state;return(null==e?void 0:e.vat_country_code)&&f.validateVat(e.vat_country_code,t)?t:""}shouldShowVatForPlan(e){return[C.ProductPlanType.PROFESSIONAL,C.ProductPlanType.TRANSFER,C.ProductPlanType.HS_DBX_PRO_BUNDLE].includes(e)}hasUserSelectedDifferentPlan(){return!this.isPlanScheduledToChange()&&this.hasTypeChanged}get vatDisplayEnabled(){const{loadingContent:e,submitting:t}=this.state;return!(!p.INDIVIDUAL_INVOICE_MODAL||e||t||!this.hasUserSelectedDifferentPlan()||!this.isValidVatCountry()||!this.finalPlanType||this.shouldShowVatForPlan(this.finalPlanType)||!this.shouldShowVatForPlan(this.state.type))}render(){const{transitionPerformed:e,paymentInfo:t,mode:a}=this.props,{subStatus:n,loadingContent:i,submitting:l,type:o,vat:r,growthRevapiPaPlanManagementCompareData:d,accountPaymentInfo:c,availablePlans:p}=this.state;return s.default.createElement(H.ApolloProvider,{client:z.getApolloClient()},d&&s.default.createElement(K.CompareRevApiAvailablePlans,{upcomingPlanId:n.finalSubState.planSku.code,legacyAvailablePlans:W.convertLegacyAvailablePlansData(p),filterContractLength:Y.AccountPlanFilterArgument.SameAsScheduled,filterProductFamily:Y.AccountPlanFilterArgument.DifferentThanScheduled,context:"change_plan_modal"}),d&&s.default.createElement(K.CompareRevApiPaymentInfo,{legacyPaymentInfo:c}),s.default.createElement(Y.GetAccountDeprecatedPlanChangePreviewComponent,{skip:!this.hasTypeChanged,variables:{vat:this.vatID,sku_code:this.getChosenSkuCode()}},c=>{const p=c.networkStatus,m=c.loading,g=!(c.loading||c.error),f=c.data&&c.data.account_deprecated_plan_change_preview?c.data.account_deprecated_plan_change_preview:void 0,b=W.convertLegacyChangePlanPreviewData(f);let v,S=T.intl.formatMessage({id:"9q9Jhs",defaultMessage:"Change plan"}),E=T.intl.formatMessage({id:"5Dr7st",defaultMessage:"Cancel"}),A=T.intl.formatMessage({id:"X0xlzt",defaultMessage:"Confirm change"});if(i||this.state.shouldShowPlusToFamilyModal&&m)S="",A="",E="",v=s.default.createElement("div",{"data-testid":"loading-indicator",className:"change-plan-modal__loading-indicator"},s.default.createElement("div",{className:"change-plan-modal__loading-indicator__text"},T.intl.formatMessage({id:"IxHAnI",defaultMessage:"Loading account details..."})),s.default.createElement("img",{src:N.static_url("/static/images/icons/ajax-loading-small-vfl3Wt7C_.gif"),alt:T.intl.formatMessage({id:"w1RdJ3",defaultMessage:"Loading"})}));else{let i;n&&e&&(M.DBModalStack.clear(),M.DBModalStack.register(u.CHANGE_IND_PLAN_MODAL_UPDATED,()=>{ae.showInstance(Object.assign(Object.assign({},this.props),{transitionPerformed:this.transitionPerformedClosure}))}),i=s.default.createElement(h.CancellableNotificationsView,{subStatus:n,transitionPerformed:this.transitionPerformedClosure,displaySingleChangeCancellationItem:y.CancellationType.ALL,reOpenModalDialogAfterCancellation:!0,paymentInfo:t,displayNewTotal:!1})),v=s.default.createElement("div",null,i,this.renderBillingSection(),this.renderChangeFooter(b,p)),a===ee.CONFIRM&&n&&(S=T.intl.formatMessage({id:"p+qbry",defaultMessage:"Confirm plan"}),n.finalSubState.plan.productType===o?(A=null,E=T.intl.formatMessage({id:"31Fc4k",defaultMessage:"Confirm"})):(A=T.intl.formatMessage({id:"/ifa0B",defaultMessage:"Upgrade plan"}),E=null))}let I=null;d&&!m&&b&&(I=s.default.createElement(K.CompareRevApiChangePlanPreview,{scheduledPlanID:n.finalSubState.planSku.code,offeringId:this.getChosenSkuCode(),vatId:this.vatID,legacyChangePlanPreviewData:b}));const w=this.state.allSubSkus&&this.state.allSubSkus.find(e=>e&&e.productType===C.ProductPlanType.FAMILY_PAYER);return this.state.shouldShowPlusToFamilyModal&&this.state.subStatus&&w&&b&&this.state.accountPaymentInfo?s.default.createElement(s.default.Fragment,null,I,s.default.createElement(_.PlusToFamilyModal,{subStatus:this.state.subStatus,subChangePreview:b,familySku:w,accountPaymentInfo:this.state.accountPaymentInfo,acceptButtonDisabled:this.acceptButtonDisabled(g),onAccept:this.ageGatingCheck,submitting:l,onUpdateBillingInfo:this.showUpdateBillingModal,shouldShowVatInput:this.vatDisplayEnabled,onVatChange:this.onVatChange,vat:r})):s.default.createElement("div",{"data-testid":"change-plan-modal"},I,s.default.createElement(P.Modal,{acceptButtonDisabled:this.acceptButtonDisabled(g),acceptButtonText:A,className:"change-plan-modal",dismissButtonText:E,autoClose:!1,onAccept:this.onChangePlanConfirmation,onDismiss:this.onDismiss,submitting:l,title:S},v))}))}}t.ChangePlanModalView=ae,ae.ChangePlanModal=o.requireCssWithComponent(ae,["/static/css/teams/admin/widgets/change_plan_modal/change_plan_modal-vfl6DGbEg.css"]),ae.displayName="ChangePlanModalView"})),define("modules/clean/account_page/widgets/plan/views/change_plan_preview_summary",["require","exports","tslib","modules/core/i18n","react","modules/clean/account_page/widgets/plan/constants"],(function(e,t,a,n,i,s){"use strict";function l(e,t){const a=s.planTypeToUpgrades[e];return void 0!==a&&a.includes(t)}function o(e,t){return t?n.intl.formatMessage({id:"QebzyJ",defaultMessage:"{price} (taxes included)"},{price:e}):e}Object.defineProperty(t,"__esModule",{value:!0}),t.priceWithTaxLabel=t.isPlanChangeUpgrade=t.ChangePlanPreviewSummary=void 0,i=a.__importDefault(i),t.ChangePlanPreviewSummary=e=>{if(!e.chosenSku||!e.currentSku)return i.default.createElement("noscript",null);let t;const a={plan:e.chosenSkuName,date:e.subChangePreview.upcoming_bill_date,prorated_price:o(e.subChangePreview.immediate_price||"",e.subChangePreview.tax_included_in_total_amount||!1),schedule_noun:e.chosenSku.billingSchedule.scheduleDescriptionNoun,schedule:e.chosenSku.billingSchedule.scheduleDescriptionAdjective,scheduled_total:o(e.subChangePreview.upcoming_bill_total_price||"",e.subChangePreview.tax_included_in_total_amount||!1),strong:e=>i.default.createElement("strong",null,e),cancelLink:t=>i.default.createElement("a",{"aria-label":n.intl.formatMessage({id:"mRCTvJ",defaultMessage:"CancelLink"}),href:"#",onClick:e.onClickCancel},t),legalLink:t=>i.default.createElement("a",{"aria-label":n.intl.formatMessage({id:"g/nUIt",defaultMessage:"LegalLink"}),href:"#",onClick:e.onClickLegal},t)};return t=l(e.currentSku.productType,e.chosenSku.productType)?n.intl.formatMessage({id:"IYLgtU",defaultMessage:"You’re upgrading your plan to Dropbox {plan}. <strong>We’ll charge you {prorated_price} now</strong>, which is prorated for the current billing period. Starting on {date} and until you <cancelLink>cancel</cancelLink>, we’ll bill you once a {schedule_noun} and your new {schedule} total will be {scheduled_total}. If you cancel, previous charges won’t be refunded <legalLink>unless it’s legally required</legalLink>."},a):n.intl.formatMessage({id:"f5t2Mw",defaultMessage:"Starting on {date}, your plan will be downgraded to Dropbox {plan} and your new {schedule} total will be {scheduled_total}. Charges will continue until you <cancelLink>cancel</cancelLink>, and previous charges won’t be refunded <legalLink>unless it’s legally required</legalLink>."},a),i.default.createElement("div",{className:"test-plan-transition-description"},t)},t.ChangePlanPreviewSummary.displayName="ChangePlanPreviewSummary",t.isPlanChangeUpgrade=l,t.priceWithTaxLabel=o})),define("modules/clean/account_page/widgets/plan/views/confirm_age_modal",["require","exports","tslib","classnames","react","modules/core/notify","modules/core/exception","modules/core/i18n","dig-components/modal","dig-components/typography","dig-components/text_fields","dig-components/buttons","api_v2/user_client","modules/clean/analytics","modules/clean/metrics/index","modules/clean/active_user","modules/clean/react/components/css","modules/core/browser","modules/clean/react/components/modal"],(function(e,t,a,n,i,s,l,o,r,d,c,u,p,m,g,_,f,h,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ConfirmAgeModalView=t.reportMetric=void 0,n=a.__importDefault(n),i=a.__importDefault(i),h=a.__importStar(h),y=a.__importStar(y),t.reportMetric=(e,t)=>{g.getMetricsReporter().createStats({ns:"personal_plan_management",name:e},Object.assign({},t)).record(1)};class b extends i.default.Component{constructor(e){super(e),this.onChange=(e,t)=>{const{target:a}=e,{value:n}=a,i=parseInt(n,10);n&&isNaN(i)||this.setState(e=>Object.assign(Object.assign({},e),{[t]:n,isValid:!0}))},this.onBlur=(e,t)=>{const{target:a}=e,{value:n}=a;if(!n)return;const i=parseInt(n,10);this.setState(e=>Object.assign(Object.assign({},e),{[t]:i.toString().padStart(2,"0")}))},this.onModalCloses=(e,t)=>{t||this.logEvent("age_gate_close"),this.setState(e=>Object.assign(Object.assign({},e),{open:!1}))},this.onAccept=()=>a.__awaiter(this,void 0,void 0,(function*(){const{day:e,month:a,year:n}=this.state,i=new Date(`${a}/${e}/${n}`),r=new Date;if(2!==e.length||2!==a.length||4!==n.length||isNaN(i.getTime())||i>r)return void this.setState(e=>Object.assign(Object.assign({},e),{isValid:!1}));if(i.getMonth()+1!==parseInt(a,10))return void this.setState(e=>Object.assign(Object.assign({},e),{isValid:!1}));const d={success:"true"};let c;try{this.setState(e=>Object.assign(Object.assign({},e),{confirmDisabled:!0})),c=yield this.setBirthdate(i),this.logEvent("age_gate_submit")}catch(e){return s.Notify.error(o.intl.formatMessage({id:"sFDDem",defaultMessage:"There was an error setting your date of birth. Please try again."})),l.reportException({err:new Error("Error setting user date of birth"),severity:l.SEVERITY.NONCRITICAL,tags:["owner:subscription-mgmt","set_birthdate"]}),void(d.success="false")}finally{t.reportMetric("set_birthdate",d),this.setState(e=>Object.assign(Object.assign({},e),{confirmDisabled:!1}))}if("will_be_disabled"===(null==c?void 0:c[".tag"]))return h.redirect("/age_gating/block");const{onAccept:u,onErrorHandler:p,loggingExtra:m}=this.props;u(p,m),this.onModalCloses(void 0,!0)})),this.setBirthdate=e=>a.__awaiter(this,void 0,void 0,(function*(){const t=e.getTime()/1e3;return(new p.UserApiV2Client).ns("age_gating").rpc("set_birthdate",{birthdate_ts:t},{subjectUserId:_.mustGetActiveUserId()}).then(e=>e.gating_status)})),this.logEvent=e=>{const{currentPlan:t}=this.props;m.ProEventsLogger.log(e,{current_plan:t})},this.state={open:!0,day:"",month:"",year:"",isValid:!0,confirmDisabled:!1},this.logEvent("age_gate_view")}static showInstance(e){r.Modal.setAppElement(document.getElementById("embedded-app")||document.body),y.Modal.showInstance(i.default.createElement(t.ConfirmAgeModalView,Object.assign({},e)))}render(){const{open:e,day:t,month:a,year:s,isValid:l,confirmDisabled:p}=this.state,m=o.intl.formatMessage({id:"QIV/Tj",defaultMessage:"Confirm your date of birth"}),g=o.intl.formatMessage({id:"CyX8FV",defaultMessage:"To use Dropbox Family, we need your date of birth."}),_=o.intl.formatMessage({id:"jsBun9",defaultMessage:"Day"}),f=o.intl.formatMessage({id:"5ymFrB",defaultMessage:"Month"}),h=o.intl.formatMessage({id:"brSw8D",defaultMessage:"Year"}),y=o.intl.formatMessage({id:"QQiv4/",defaultMessage:"Confirm"}),b=o.intl.formatMessage({id:"ztOd9D",defaultMessage:"Please enter a valid date of birth."}),v=o.intl.formatMessage({id:"Pxv2Bf",defaultMessage:"Close"}),M=n.default("confirm-age-modal");return i.default.createElement(r.Modal,{open:e,isCentered:!0,withCloseButton:v,shouldCloseOnOverlayClick:!1,overlayClassName:M,onRequestClose:this.onModalCloses},i.default.createElement(r.Modal.Header,{hasBottomSpacing:"title-standard"},i.default.createElement(d.Title,null,m)),i.default.createElement(r.Modal.Body,null,i.default.createElement(d.Text,{size:"large"},g),i.default.createElement("div",{className:"age-container"},i.default.createElement(c.FormRow,null,i.default.createElement(c.FormLabel,{htmlFor:"confirm-age-day"},_),i.default.createElement(c.TextInput,{placeholder:"DD","aria-label":_,id:"confirm-age-day",maxLength:2,onChange:e=>this.onChange(e,"day"),onBlur:e=>this.onBlur(e,"day"),value:t,isInvalid:!l})),i.default.createElement(c.FormRow,null,i.default.createElement(c.FormLabel,{htmlFor:"confirm-age-month"},f),i.default.createElement(c.TextInput,{placeholder:"MM","aria-label":f,id:"confirm-age-month",maxLength:2,onChange:e=>this.onChange(e,"month"),onBlur:e=>this.onBlur(e,"month"),value:a,isInvalid:!l})),i.default.createElement(c.FormRow,null,i.default.createElement(c.FormLabel,{htmlFor:"confirm-age-year"},h),i.default.createElement(c.TextInput,{placeholder:"YYYY","aria-label":h,id:"confirm-age-year",maxLength:4,onChange:e=>this.onChange(e,"year"),value:s,isInvalid:!l}))),!l&&i.default.createElement(d.Text,{color:"error"},b)),i.default.createElement(r.Modal.Footer,null,i.default.createElement(u.Button,{className:"confirm-age-button",variant:"primary",size:"large",onClick:this.onAccept,disabled:p},y)))}}b.displayName="ConfirmAgeModal",t.ConfirmAgeModalView=f.requireCssWithComponent(b,["/static/css/teams/admin/widgets/confirm_age_modal/confirm_age_modal-vflSKFVWn.css"])})),define("modules/clean/account_page/widgets/plan/views/plus_to_family_modal",["require","exports","tslib","modules/core/exception","modules/core/browser","modules/core/i18n","modules/core/uri","react","modules/clean/account_page/util","modules/clean/react/components/modal","dig-components/typography","modules/clean/account_page/widgets/plan/views/individual_inline_payment_method","modules/clean/payments/skus/constants","modules/clean/family/constants","modules/constants/trademark","modules/clean/account_page/widgets/plan/views/update_billing_info","modules/clean/stormcrow/experiment","modules/clean/payments/skus/constants","modules/clean/payments/validation","modules/clean/react/arbor/aspen/elements/arbor_inputs","modules/clean/analytics","modules/clean/account_page/widgets/plan/views/change_plan_preview_summary"],(function(e,t,a,n,i,s,l,o,r,d,c,u,p,m,g,_,f,h,y,b,v,M){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PlusToFamilyModal=t.shouldShowPlusToFamilyModal=t.PLUS_TO_FAMILY_MODAL=void 0,n=a.__importStar(n),i=a.__importStar(i),o=a.__importDefault(o),t.PLUS_TO_FAMILY_MODAL="plus_to_family_modal",t.shouldShowPlusToFamilyModal=function(e,t,a){if(!e)return n.reportException({err:new Error("Plus to Family Modal only available to Plus users"),severity:"non-critical"}),!1;const i=a&&f.Experiment(a).isActive;if(!i)return n.reportException({err:new Error("Plus to Family Modal only available to gated users"),severity:"non-critical"}),!1;const s=1===t.filter(e=>e&&e.productType===h.ProductPlanType.FAMILY_PAYER).length;return s?s&&i:(n.reportException({err:new Error("Family plan not available"),severity:"non-critical"}),!1)};class S extends o.default.Component{constructor(){super(...arguments),this.onDismiss=()=>{v.ProEventsLogger.log("de_change_plan_modal_cancel_click",{from:t.PLUS_TO_FAMILY_MODAL}),this.removeURIModalQueryParam()},this.onAccept=()=>{this.props.onAccept(void 0,{from:t.PLUS_TO_FAMILY_MODAL})},this.updateBillingInfo=()=>{v.ProEventsLogger.log("de_update_billing_info_click",{from:t.PLUS_TO_FAMILY_MODAL}),this.props.onUpdateBillingInfo()},this.renderVatInput=()=>{const{vat:e,accountPaymentInfo:t}=this.props,a=t.vat_country_code;if(this.props.shouldShowVatInput&&a)return o.default.createElement(b.ArborTextInput,{name:"vat",placeholderText:y.getVatPrefix(a),labelText:s.intl.formatMessage({id:"jabE//",defaultMessage:"VAT number (optional)"}),isValid:y.validateVat(a,e),errorText:s.intl.formatMessage({id:"1dRSXy",defaultMessage:"Please enter a valid VAT number, e.g. {examples}."},{examples:y.getVatExamples(a).join(", ")}),value:e,onChange:this.props.onVatChange})}}removeURIModalQueryParam(){const e=i.get_href().match(/modal=(plus_to_family*)/);if(e&&e.length>1){const e=l.URI.parse(i.get_href()).removeQuery("modal");window.history.replaceState({},document.title,e.toString())}}getPlanComparisonText(){const{subStatus:e,familySku:t}=this.props,a=e.finalSubState.plan,n=a.displayCost.toString(),i=t.displayCost.toString();return a.billingSchedule.id===p.ScheduleId.MONTHLY?s.intl.formatMessage({id:"hNT7DA",defaultMessage:"{count, plural, one{{newCost}/month for up to {count} user ({currentPlan} is {currentCost}/month for 1 user)} other {{newCost}/month for up to {count} users ({currentPlan} is {currentCost}/month for 1 user)}}"},{currentPlan:a.displayName(),currentCost:n,newCost:i,count:m.MAX_LICENSES}):s.intl.formatMessage({id:"dlmjiM",defaultMessage:"{count, plural, one{{newCost}/year for up to {count} user ({currentPlan} is {currentCost}/year for 1 user)} other {{newCost}/year for up to {count} users ({currentPlan} is {currentCost}/year for 1 user)}}"},{currentPlan:a.displayName(),currentCost:n,newCost:i,count:m.MAX_LICENSES})}renderPlusToFamilyPlanUpsell(){const{subStatus:e,familySku:a}=this.props,n=e.finalSubState.plan,i=a.content&&a.content.spaceShortFormGbRounded();return o.default.createElement("div",{className:"test-plus-family-plan-modal__content"},o.default.createElement(c.Text,null,s.intl.formatMessage({id:"NI7W3i",defaultMessage:"{count, plural, one{{familyPlan} includes the same features as Dropbox {currentPlan} (your current plan) for up to {count} member.} other{{familyPlan} includes the same features as Dropbox {currentPlan} (your current plan) for up to {count} members.}}"},{familyPlan:g.DROPBOX_FAMILY,currentPlan:n.displayName(),count:m.MAX_LICENSES})),o.default.createElement(c.Text,null,o.default.createElement("ul",null,o.default.createElement("li",null,this.getPlanComparisonText()),o.default.createElement("li",null,s.intl.formatMessage({id:"aE4CAA",defaultMessage:"Share {space} of encrypted cloud storage"},{space:i})),o.default.createElement("li",null,s.intl.formatMessage({id:"OX5PaW",defaultMessage:"Easily create shared spaces for photos, videos, docs, and more"})))),o.default.createElement(c.Text,{size:"small"},s.intl.formatMessage({id:"V3rkGP",defaultMessage:"Questions? Check out the <overview_link>Family plan overview</overview_link>."},{overview_link:e=>o.default.createElement(c.Link,{href:"#","aria-label":s.intl.formatMessage({id:"kc7uwV",defaultMessage:"FamilyPlanOverviewLink"}),onClick:r.logClickAndRedirect("de_family_plan_overview_link_click","/help/accounts-billing/plans-upgrades/dropbox-family-plan",{from:t.PLUS_TO_FAMILY_MODAL})},e)})))}renderFooter(){return o.default.createElement("div",{className:"plus-family-plan-modal__footer"},this.renderVatInput(),o.default.createElement(c.Text,{color:"faint",isBold:!0,tagName:"p"},s.intl.formatMessage({id:"sIclY/",defaultMessage:"Plan change summary"})),o.default.createElement(c.Text,{size:"small",color:"faint"},this.getTransitionText()))}getTransitionText(){var e,a,n,i;const{subStatus:l,subChangePreview:d,familySku:c,accountPaymentInfo:m}=this.props,g=l.finalSubState.plan,f=e=>o.default.createElement("a",{"aria-label":s.intl.formatMessage({id:"mRCTvJ",defaultMessage:"CancelLink"}),href:"#",onClick:r.logClickAndRedirect("de_cancel_link_click","/help/billing/cancel-dropbox-plus",{from:t.PLUS_TO_FAMILY_MODAL})},e),h=e=>o.default.createElement("a",{"aria-label":s.intl.formatMessage({id:"g/nUIt",defaultMessage:"LegalLink"}),href:"#",onClick:r.logClickAndRedirect("de_legal_link_click","/help/billing/plus-refund",{from:t.PLUS_TO_FAMILY_MODAL})},e);let y;const b=M.priceWithTaxLabel(null!==(e=d.upcoming_bill_total_price)&&void 0!==e?e:"",null!==(a=d.tax_included_in_total_amount)&&void 0!==a&&a),v=M.priceWithTaxLabel(null!==(n=d.immediate_price)&&void 0!==n?n:"",null!==(i=d.tax_included_in_total_amount)&&void 0!==i&&i),S=o.default.createElement(u.IndividualInlinePaymentMethodView,{accountPaymentInfo:m,renderUpdateLink:o.default.createElement(_.UpdateBillingInfoLink,{updateBillingCTA:this.updateBillingInfo})});return y=g.billingSchedule.id===p.ScheduleId.MONTHLY?s.intl.formatMessage({id:"5NWG7E",defaultMessage:"If you change from Dropbox {currentPlan} to Dropbox {plan}, we’ll charge you {proratedPrice} now. Starting on {date}, we’ll bill you {scheduledTotal} a month. Charges will continue until you <cancelLink>cancel</cancelLink>, and previous charges won’t be refunded unless it’s <legalLink>legally required</legalLink>. {paymentInfo}"},{currentPlan:l.finalSubState.plan.displayName(),plan:c.displayName(),proratedPrice:v,date:d.upcoming_bill_date,scheduledTotal:b,paymentInfo:S,cancelLink:f,legalLink:h}):s.intl.formatMessage({id:"KUkJyi",defaultMessage:"If you change from Dropbox {currentPlan} to Dropbox {plan}, we’ll charge you {proratedPrice} now. Starting on {date}, we’ll bill you {scheduledTotal} a year. Charges will continue until you <cancelLink>cancel</cancelLink>, and previous charges won’t be refunded unless it’s <legalLink>legally required</legalLink>. {paymentInfo}"},{currentPlan:l.finalSubState.plan.displayName(),plan:c.displayName(),proratedPrice:v,date:d.upcoming_bill_date,scheduledTotal:b,paymentInfo:S,cancelLink:f,legalLink:h}),y}render(){return o.default.createElement(d.Modal,{className:"plus-family-plan-modal",title:g.DROPBOX_FAMILY,acceptButtonDisabled:this.props.acceptButtonDisabled,acceptButtonText:s.intl.formatMessage({id:"e2x8vE",defaultMessage:"Change to {familyPlan} plan"},{familyPlan:g.TRADEMARK_FAMILY}),dismissButtonText:s.intl.formatMessage({id:"dTig7r",defaultMessage:"Cancel"}),autoClose:!1,onAccept:this.onAccept,onDismiss:this.onDismiss,submitting:this.props.submitting},this.renderPlusToFamilyPlanUpsell(),this.renderFooter())}}t.PlusToFamilyModal=S,S.displayName="PlusToFamilyModal"})),define("modules/clean/account_page/widgets/plan/views/change_schedule_modal",["require","exports","tslib","modules/core/browser","react","dig-components/typography","modules/clean/deprecated_ajax/ajax_jquery","modules/clean/analytics","modules/clean/subscription/tools/amp_logger","modules/clean/account_page/widgets/plan/constants","modules/clean/account_page/widgets/plan/views/cancel_changes_modal","modules/clean/account_page/widgets/plan/types","modules/clean/account_page/widgets/plan/views/individual_inline_payment_method","modules/clean/account_page/widgets/plan/views/update_billing_info","modules/clean/account_page/util","modules/clean/active_user","modules/clean/account_page/widgets/plan/views/change_confirmation_modal","modules/clean/dbmodal_stack","modules/clean/payments/cash","modules/clean/payments/skus/constants","modules/clean/payments/skus/subscription_change_plan","modules/clean/payments/skus/subscription_status","modules/clean/react/components/modal","modules/clean/react/payments/error/browser_update_required_modal","modules/clean/react/payments/update_individual_billing/update_individual_billing_modal_loader","modules/clean/react/payments/update_individual_billing/update_individual_store_creator","modules/core/i18n","modules/clean/account_page/constants","modules/core/notify","modules/clean/hql/index","dropbox/proto/hql_events/revenue/revenue","dropbox/proto/hql_events/extensions","dropbox/proto/hql_events/taxonomy","modules/clean/account_page/widgets/plan/revenue_api_migration_utils","modules/clean/account_page/widgets/plan/api","modules/clean/account_page/widgets/plan/revenue_api_migration_comparisons","@apollo/react-hooks","apiql/client/components/account-gql","modules/clean/account_page/widgets/plan/api"],(function(e,t,a,n,i,s,l,o,r,d,c,u,p,m,g,_,f,h,y,b,v,M,S,P,E,C,A,T,I,w,D,N,L,x,k,R,B,O,F){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ChangeScheduleModalView=void 0,n=a.__importStar(n),i=a.__importDefault(i);const U=L.hql_events.TaxonomyAppSurface.AppSurface,q=L.hql_events.TaxonomyActionSurface.ActionSurface;class V extends i.default.Component{constructor(e){super(e),this._timeModalOpened=null,this.closeModals=()=>{this.setState({open:!1})},this.onAccept=()=>{const e=this.getSubChangePlan();let t,a;e&&(e.finalSubState.billingSchedule.id===b.ScheduleId.MONTHLY&&(a=u.PerformPlanTransition.YEARLY,t=u.PerformPlanTransition.MONTHLY),e.finalSubState.billingSchedule.id===b.ScheduleId.YEARLY&&(a=u.PerformPlanTransition.MONTHLY,t=u.PerformPlanTransition.YEARLY),t&&a?(this.setState(e=>(e.submitting=!0,e)),l.WebRequest({url:"/account/perform_personal_transition",data:{transition_change_type:t},subject_user:_.mustGetActiveUserId(),success:e=>{const t=JSON.parse(e);if(t.redirect)return n.redirect(t.redirect);I.Notify.success(A.intl.formatMessage({id:"dVc1qR",defaultMessage:"You’ve changed your billing period!"})),this.logChangeSchedule(),this.modalLogger.logModalSuccess(),this.props.transitionPerformed&&this.props.transitionPerformed(),this.closeModals()},error:()=>{I.Notify.error(A.intl.formatMessage({id:"wiPRXu",defaultMessage:"There was an error changing the billing period!"})),this.modalLogger.logModalError("modal_submit"),this.setState(e=>(e.submitting=!1,e))}})):I.Notify.error(A.intl.formatMessage({id:"wiPRXu",defaultMessage:"There was an error changing the billing period!"})))},this.updateBillingInfo=e=>{o.ProEventsLogger.log("de_update_billing_info_click"),this.closeModals(),h.DBModalStack.register(C.BILLING_INFO_UPDATED,()=>{F.resetApolloStore(),V.showInstance(this.props)}),this.props.browserUpdateRequired?P.BrowserUpdateModalLoader.showInstance():E.IndividualUpdateBillingModalLoader.showInstance()},this.handleCancelScheduleAction=()=>(this.handleCancelActions(T.CancellationType.SCHEDULE),!1),this.handleCancelActions=e=>{const{transitionPerformed:t}=this.props;return c.CancelChangesModalConfirmationView.showInstance({transitionPerformed:t,cancellationType:e,reOpenModalDialogAfterCancellation:!1}),!1},this.transitionPerformedClosure=e=>{if(this.props.transitionPerformed)return this.props.transitionPerformed()},this.onDismissModal=()=>{o.ProEventsLogger.log("de_cancel_billing_change_modal"),this.setState({open:!1})},this.state={loadingContent:!0,subChangePlans:[],submitting:!1,hasLicenseKey:!1,open:!0},this.modalLogger=r.getSubscriptionAMPLogger({ns:"personal",modal:r.ModalTypes.CHANGE_SCHEDULE_MODAL})}get isProfessionalTrialPlan(){const{subStatus:e}=this.state;return!(!e||!e.subState.plan)&&e.subState.plan.productType===b.ProductPlanType.PROFESSIONAL_TRIAL}get isPlusTrialPlan(){var e;const{subStatus:t}=this.state;return(null===(e=null==t?void 0:t.subState.plan)||void 0===e?void 0:e.productType)===b.ProductPlanType.PLUS_TRIAL}get productTypeStr(){var e,t,a;return null===(a=null===(t=null===(e=this.state.subStatus)||void 0===e?void 0:e.subState)||void 0===t?void 0:t.plan)||void 0===a?void 0:a.productType.toString()}static showInstance(e){S.Modal.showInstance(i.default.createElement(V,Object.assign({},e)))}componentDidMount(){this._timeModalOpened=Date.now(),this.logChangeScheduleModalOpen(),this.loadPlanTransitions()}logTTI(){if(this._timeModalOpened){const e=Date.now()-this._timeModalOpened;this.modalLogger.setProductPlanType(this.productTypeStr),this.modalLogger.logModalTTI(e)}}loadPlanTransitions(){l.WebRequest({url:"/account/ajax_change_plan_schedule",subject_user:_.mustGetActiveUserId(),success:e=>{const t=JSON.parse(e);this.setState(e=>{var a;const n=Object.assign({},e);n.loadingContent=!1,n.subStatus=M.SubscriptionStatus.deserialize(t.serializedSubStatus),n.paymentMethod=t.paymentMethod,n.hasLicenseKey=t.hasLicenseKey;const i=n.subStatus.finalSubState;if(!i.billingSchedule||!i.plan)throw"A base plan is required, in order to change it.";return n.subChangePlans=t.serializedSubChangePlans.map(e=>v.SubscriptionChangePlan.deserialize(e)),n.allSubStatuses=n.subChangePlans.map(e=>e),n.allSubStatuses.push(n.subStatus),n.growthRevapiPaPlanManagementCompareData=t.growthRevapiPaPlanManagementCompareData,o.ProEventsLogger.log("de_plan_tab_change_billing_load_modal",{from:(null===(a=n.subStatus.subState.billingSchedule)||void 0===a?void 0:a.id)===b.ScheduleId.MONTHLY?"monthly":"yearly"}),n},this.logTTI)},error:()=>{I.Notify.error(A.intl.formatMessage({id:"C2BKnZ",defaultMessage:"Failed to load modal."})),this.modalLogger.logModalError("modal_init"),this.closeModals()}})}getSubChangePlan(){return this.state.subChangePlans.filter(e=>{const t=e.finalSubState;return!(!t.plan||!t.billingSchedule)&&(t.plan.productType===this.currentPlanType&&t.billingSchedule.id===this.scheduleToSwitchTo)}).pop()}get subStatusScheduleId(){const{subStatus:e}=this.state;return e&&e.finalSubState.billingSchedule?e.finalSubState.billingSchedule.id:b.ScheduleId.MONTHLY}get scheduleToSwitchTo(){if(!this.state.subStatus)return b.ScheduleId.MONTHLY;return this.state.subStatus.subState.billingSchedule.id===b.ScheduleId.MONTHLY?b.ScheduleId.YEARLY:b.ScheduleId.MONTHLY}get currentPlanType(){var e,t;return(null===(t=null===(e=this.state.subStatus)||void 0===e?void 0:e.finalSubState.plan)||void 0===t?void 0:t.productType)||b.ProductPlanType.STANDARD}logChangeScheduleModalOpen(){const{isFromBillingTab:e}=this.props;let t,a;e?(t=q.CENTER_PANE_BILLING_TAB,a="de_billing_tab_change_billing_open_modal"):(t=q.CENTER_PANE_PLAN_TAB,a="de_plan_tab_change_billing_open_modal");const n=N.hql_events.HQLEventIdentity.create({eventClass:N.hql_events.HQLEventIdentity.EventClass.create({className:L.hql_events.TaxonomyClass.ClassName.SEE_AND_CLICK}),legacyEvent:N.hql_events.HQLEventIdentity.LegacyEvent.create({table:"pro_events",name:a}),actionEventId:N.hql_events.HQLEventIdentity.ActionEventIdentity.create({object:"change_billing_schedule_modal",action:L.hql_events.TaxonomyAction.Action.SHOWN})});w.logEvent(D.hql_events.ShownChangeBillingScheduleModal.create({hqlMetadata:N.hql_events.HQLMetadata.create({appSurface:U.WEB,actionSurface:t,identityOverride:n})}))}logChangeSchedule(){const{subStatus:e}=this.state;e&&e.subState.billingSchedule&&o.ProEventsLogger.log("de_change_billing_change_schedule",{from:e.subState.billingSchedule.id===b.ScheduleId.MONTHLY?"monthly":"yearly",to:e.subState.billingSchedule.id===b.ScheduleId.MONTHLY?"yearly":"monthly"})}isBillingScheduleToChange(){const{subStatus:e,hasLicenseKey:t}=this.state;return!t&&(!!(e&&e.subState.billingSchedule&&e.finalSubState.billingSchedule)&&e.subState.billingSchedule.id!==e.finalSubState.billingSchedule.id)}get changesSummaryContent(){const{subStatus:e,paymentMethod:t}=this.state,a=this.getSubChangePlan();if(!e||!e.subState.plan)return;if(e.subState.plan.scheduleId!==e.finalSubState.plan.scheduleId&&!this.isProfessionalTrialPlan)return A.intl.formatMessage({id:"uGbqz6",defaultMessage:"You’ve already requested a change to your billing period. If you want to choose a different billing period, first cancel your pending change. <cancelChangeLink>Cancel change</cancelChangeLink>"},{cancelChangeLink:e=>i.default.createElement(s.Link,{href:"#","aria-label":A.intl.formatMessage({id:"7kgsyk",defaultMessage:"Cancel change"}),className:"change-confirmation-modal__link",onClick:this.handleCancelScheduleAction,variant:"primary",hasNoUnderline:!0},e)});const n={nextBillingDate:e.subState.formattedNextBillingDate,scheduleId:a.finalSubState.billingSchedule.id,totalPrice:y.Cash.formatWithTaxLabels(a.nextBillingSummary.total,a.nextBillingSummary)},l=i.default.createElement(p.IndividualInlinePaymentMethodView,{accountPaymentInfo:x.convertLegacyPaymentInfo(t),renderUpdateLink:i.default.createElement(m.UpdateBillingInfoLink,{updateBillingCTA:this.updateBillingInfo}),transitionDetails:n});return A.intl.formatMessage({id:"pVEqbN",defaultMessage:"{paymentInfo}{br}{br}Charges will continue until you <cancelLink>cancel</cancelLink>, and previous charges won’t be refunded <legalLink>unless it’s legally required</legalLink>."},{br:i.default.createElement("br",null),strong:e=>i.default.createElement("strong",null,e),cancelLink:e=>i.default.createElement(s.Link,{href:"#","aria-label":A.intl.formatMessage({id:"A3cCkZ",defaultMessage:"Cancel link"}),onClick:g.logClickAndRedirect("de_cancel_link_click","/help/billing/cancel-dropbox-plus",{from:"change_plan_modal"}),variant:"primary",hasNoUnderline:!0},e),legalLink:e=>i.default.createElement(s.Link,{href:"#","aria-label":A.intl.formatMessage({id:"5Kyedz",defaultMessage:"Legal link"}),onClick:g.logClickAndRedirect("de_legal_link_click","/help/billing/plus-refund",{from:"change_plan_modal"}),variant:"primary",hasNoUnderline:!0},e),paymentInfo:l})}get acceptButtonDisabled(){const{paymentMethod:e}=this.state,{loadingContent:t,submitting:a}=this.state;return t||a||!e||this.isBillingScheduleToChange()}render(){const{subStatus:e,loadingContent:t,submitting:a,open:n,growthRevapiPaPlanManagementCompareData:s}=this.state,{transitionPerformed:l}=this.props;e&&l&&!this.isProfessionalTrialPlan&&!this.isPlusTrialPlan&&(h.DBModalStack.clear(),h.DBModalStack.register(d.CHANGE_IND_PLAN_MODAL_UPDATED,()=>{V.showInstance({transitionPerformed:this.transitionPerformedClosure})}));const o=A.intl.formatMessage({id:"BKISIV",defaultMessage:"Confirm"}),r=A.intl.formatMessage({id:"d9/SE1",defaultMessage:"Cancel"}),c=this.isBillingScheduleToChange()&&!this.isProfessionalTrialPlan?A.intl.formatMessage({id:"ewZ2I2",defaultMessage:"Change billing period"}):this.scheduleToSwitchTo===b.ScheduleId.YEARLY?A.intl.formatMessage({id:"z17QUa",defaultMessage:"You’re switching to yearly billing"}):A.intl.formatMessage({id:"/tHQbR",defaultMessage:"You’re switching to monthly billing"}),u=i.default.createElement(m.UpdateBillingInfoButton,{updateBillingCTA:this.updateBillingInfo}),p=this.state.subChangePlans.map(e=>e.finalSubState.plan).filter(e=>e);return i.default.createElement(B.ApolloProvider,{client:k.getApolloClient()},s&&i.default.createElement(R.CompareRevApiAvailablePlans,{upcomingPlanId:e.finalSubState.planSku.code,legacyAvailablePlans:x.convertLegacyAvailablePlansData(p),filterContractLength:O.AccountPlanFilterArgument.DifferentThanScheduled,filterProductFamily:O.AccountPlanFilterArgument.SameAsScheduled,context:"change_schedule_modal"}),i.default.createElement(f.ChangeConfirmationModal,{acceptButtonDisabled:this.acceptButtonDisabled,acceptButtonText:o,description:this.changesSummaryContent,dismissButtonText:r,link:u,loadingContent:t,onAccept:this.onAccept,onDismiss:this.onDismissModal,open:n,submitting:a,title:c}))}}t.ChangeScheduleModalView=V,V.displayName="ChangeScheduleModalView"})),define("modules/clean/account_page/widgets/plan/views/disband_family_confirmation_modal",["require","exports","tslib","react","styled-components","dig-components/modal","dig-components/typography","dig-components/controls","modules/core/i18n","modules/clean/react/components/modal","modules/clean/dbmodal_stack","dig-components/buttons","modules/constants/trademark","family/common/links"],(function(e,t,a,n,i,s,l,o,r,d,c,u,p,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.showDisbandModal=t.DisbandFamilyConfirmationModal=t.FAMILY_DISBAND_MODAL_GO_BACK=void 0,n=a.__importDefault(n);const g=(i=a.__importDefault(i)).default.div`
  display: flex;
  margin-bottom: var(--spacing__unit--2);
  &:last-child {
    margin-bottom: 0;
  }
`,_=i.default(o.Checkbox)`
  margin-top: var(--spacing__unit--0_5);
  max-width: 20px;
  flex: 1;
  margin-right: var(--spacing__base_unit);
`,f=i.default.div`
  margin-bottom: var(--spacing__unit--3);
`,h=i.default(l.Text)`
  flex: 2;
`,y=({children:e})=>n.default.createElement(l.Link,{href:m.FAMILY_ROOM_HELP_CENTER_ARTICLE,target:"_blank",rel:"noreferrer",variant:"monochromatic"},e);y.displayName="FamilyRoomHelpCenterArticle",t.FAMILY_DISBAND_MODAL_GO_BACK="disband_family_confirmation_modal:goback",t.DisbandFamilyConfirmationModal=e=>{const{displayFamilyRoomCheckbox:a}=e,[i,o]=n.default.useState(!1),[m,b]=n.default.useState(!1),[v,M]=n.default.useState(!1),[S,P]=n.default.useState(!1),E=!i||!m||a&&!v||S,C=()=>{d.Modal.close()},A=()=>{P(!1)};return n.default.createElement(s.Modal,{open:!0,className:"disband-family-confirmation-modal",overlayClassName:"disband-family-confirmation-modal-overlay",width:"small",onRequestClose:C},n.default.createElement(s.Modal.Header,{hasBottomSpacing:"title-standard"},n.default.createElement(l.Title,{isBold:!0},r.intl.formatMessage({id:"I9CTpA",defaultMessage:"Are you sure you want to change plans?"}))),n.default.createElement(s.Modal.Body,null,n.default.createElement(f,null,n.default.createElement(h,null,r.intl.formatMessage({id:"QDkSaP",defaultMessage:"{dropbox_family} will be canceled, and active members of your {family_plan} plan will have their accounts downgraded to {dropbox_basic}"},{dropbox_family:p.DROPBOX_FAMILY,family_plan:p.TRADEMARK_FAMILY,dropbox_basic:p.DROPBOX_BASIC}))),n.default.createElement(f,null,n.default.createElement(h,{isBold:!0},r.intl.formatMessage({id:"Md6TJX",defaultMessage:"If you still want to change plans, please acknowledge the following:"}))),n.default.createElement(g,null,n.default.createElement(_,{onChange:()=>{o(!i)},checked:i,className:"disband-confirmation-checkbox downgrade-acknowledged"}),n.default.createElement(h,null,r.intl.formatMessage({id:"+E9wLh",defaultMessage:"By proceeding, {family_plan} plan members will be downgraded to a {basic_space_quota} {dropbox_basic} plan."},{family_plan:p.TRADEMARK_FAMILY,dropbox_basic:p.DROPBOX_BASIC,basic_space_quota:e.basicSkuQuotaGb}))),a&&n.default.createElement(g,null,n.default.createElement(_,{onChange:()=>{M(!v)},checked:v,className:"disband-confirmation-checkbox family-shared-folder-acknowledged"}),n.default.createElement(h,null,r.intl.formatMessage({id:"DaDVT1",defaultMessage:"All members will keep a copy of your <link>Family Room folder.</link>"},{link:e=>n.default.createElement(y,null,e)}))),n.default.createElement(g,null,n.default.createElement(_,{onChange:()=>{b(!m)},checked:m,className:"disband-confirmation-checkbox over-quota-acknowledged"}),n.default.createElement(h,null,r.intl.formatMessage({id:"zGHPY9",defaultMessage:"If members are using more than {basic_space_quota} of storage, Dropbox will stop syncing, additional files can’t be uploaded, and files can’t be restored to earlier versions."},{basic_space_quota:e.basicSkuQuotaGb})))),n.default.createElement(s.Modal.Footer,null,n.default.createElement(u.Button,{className:"disband-family-confirmation-modal-back",disabled:S,variant:"transparent",onClick:()=>{d.Modal.close(),c.DBModalStack.trigger(t.FAMILY_DISBAND_MODAL_GO_BACK,{})}},r.intl.formatMessage({id:"lhKaOC",defaultMessage:"Back"})),n.default.createElement(u.Button,{className:"disband-family-confirmation-modal-cancel",disabled:S,variant:"opacity",onClick:C},r.intl.formatMessage({id:"d9/SE1",defaultMessage:"Cancel"})),n.default.createElement(u.Button,{className:"disband-family-confirmation-modal-confirm",variant:"primary",onClick:()=>{P(!0),e.confirmChangePlan(A)},disabled:E},r.intl.formatMessage({id:"ZCkVHN",defaultMessage:"Confirm change"}))))},t.showDisbandModal=function(e){d.Modal.showInstance(n.default.createElement(t.DisbandFamilyConfirmationModal,Object.assign({},e)))}})),define("modules/clean/account_page/widgets/plan/views/license_keys",["require","exports","tslib","modules/core/i18n","modules/core/browser","react","styled-components","modules/clean/account_page/components/account_table","modules/clean/account_page/components/key_value_block","modules/clean/payments/skus/constants"],(function(e,t,a,n,i,s,l,o,r,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LicenseKeys=void 0,i=a.__importStar(i),s=a.__importDefault(s);const c=(l=a.__importDefault(l)).default(o.BodyRow)`
  height: 56px;
  border-top: 1px solid var(--color__faint__border);
`,u=l.default(o.HeaderCell)`
  font-weight: normal;
  text-align: left;
  font-size: var(--type__body__small--fontsize);
  color: var(--color__faint__text);
  width: 240px;
  padding-left: var(--spacing__unit--2);
`,p=l.default(o.HeaderCell)`
  font-weight: normal;
  text-align: left;
  font-size: var(--type__body__small--fontsize);
  color: var(--color__faint__text);
  width: 170px;
  padding-right: var(--spacing__unit--2);
`,m=l.default(o.HeaderRow)`
  height: var(--spacing__unit--5);
  background-color: var(--color__faint__background);
  font-weight: normal;
`,g=l.default(o.Table)`
  width: 100%;
  border-collapse: collapse;
  .activated {
    background-color: var(--color__faint__background);
  }
`,_=l.default(o.TableFooter)`
  width: 100%;
  text-align: center;
  border-top: 1px solid var(--color__faint__border);
`,f=l.default.tr`
  height: 45px;
`,h=l.default(o.BodyCell)`
  color: var(--color__standard__text);
  text-align: left;
`,y=l.default(o.BodyCell)`
  color: var(--color__standard__text);
  text-align: left;
`,b=l.default(o.BodyCell)`
  color: var(--color__standard__text);
  text-align: left;
  width: 170px;
  padding-right: var(--spacing__unit--2);
`,v=l.default(o.BodyCell)`
  color: var(--color__standard__text);
  text-align: left;
  width: 240px;
  padding-left: var(--spacing__unit--2);
`;class M extends s.default.Component{constructor(e){super(e),this.licenseRowsIncrement=3,this.handleRedeemClick=()=>{i.redirect("/pro/redeem_key")},this.buildLicenseFooter=()=>{if(this.state.showViewMore)return s.default.createElement(f,{className:"license-footer-row"},s.default.createElement("td",{colSpan:4},s.default.createElement("a",{onClick:this.showMoreLicense,href:"",rel:"noopener noreferrer"},n.intl.formatMessage({id:"fiL806",defaultMessage:"View more license keys"}))))},this.showMoreLicense=e=>{e.preventDefault(),this.setState((e,t)=>{const a=e.maxShow+this.licenseRowsIncrement;return{maxShow:a,showViewMore:a<t.licenseKeys.length}})},this.buildStatus=e=>e.activated?n.intl.formatMessage({id:"7rnsEt",defaultMessage:"Activated on {activated_date}"},{activated_date:e.activated_date}):n.intl.formatMessage({id:"QJkpjq",defaultMessage:"Scheduled for future use"}),this.buildDuration=e=>e.duration?e.duration:n.intl.formatMessage({id:"CNLpjm",defaultMessage:"N/A"}),this.buildLicenseKeyTable=()=>{const e=this.props.licenseKeys;if(0!==e.length)return s.default.createElement("div",null,s.default.createElement(g,{className:"license-table"},s.default.createElement(o.TableHead,null,s.default.createElement(m,null,s.default.createElement(u,null,n.intl.formatMessage({id:"xn3SDu",defaultMessage:"Key"})),s.default.createElement(o.HeaderCell,null,n.intl.formatMessage({id:"Ncw9cm",defaultMessage:"Redeemed"})),s.default.createElement(o.HeaderCell,null,n.intl.formatMessage({id:"E3AATa",defaultMessage:"Duration"})),s.default.createElement(p,null,n.intl.formatMessage({id:"uufVvn",defaultMessage:"Status"})))),s.default.createElement(_,null,this.buildLicenseFooter()),s.default.createElement(o.TableBody,null,e.map((e,t)=>{if(!(t>=this.state.maxShow))return s.default.createElement(c,{className:"license-body-row "+(e.activated?"activated":"unused"),key:e.key},s.default.createElement(v,null,e.key),s.default.createElement(h,{className:"license-redeemded"},e.redeemed_date),s.default.createElement(y,null,this.buildDuration(e)),s.default.createElement(b,null,this.buildStatus(e)))}))))},this.state={maxShow:3,showViewMore:!1}}componentDidMount(){this.setState((e,t)=>({showViewMore:e.maxShow<t.licenseKeys.length}))}render(){const{productType:e}=this.props;return e===d.ProductPlanType.FAMILY_NONPAYER||e===d.ProductPlanType.FAMILY_PAYER?null:s.default.createElement("div",{className:"license-keys account-plan-section"},s.default.createElement(r.KeyValueBlock,{className:"redeem-license-key",keyText:n.intl.formatMessage({id:"M25rlh",defaultMessage:"License keys"}),linkText:n.intl.formatMessage({id:"dDHqbP",defaultMessage:"Redeem a license key"}),onLinkClick:this.handleRedeemClick,subtext:n.intl.formatMessage({id:"qDYIgp",defaultMessage:"License keys will be applied before any other form of payment method"})}),this.buildLicenseKeyTable())}}t.LicenseKeys=M,M.displayName="LicenseKeys"})),define("modules/clean/account_page/widgets/plan/views/loading_view",["require","exports","tslib","react","modules/core/i18n","modules/clean/static_urls"],(function(e,t,a,n,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LoadingView=void 0,n=a.__importStar(n),t.LoadingView=e=>n.createElement("div",{className:e.className},n.createElement("img",Object.assign({src:s.static_url("/static/images/icons/ajax-loading-small-blue-vflVk_QNP.gif"),alt:i.intl.formatMessage({id:"jybGUg",defaultMessage:"Loading"})},e.imageProps)))})),define("modules/clean/account_page/widgets/plan/views/individual_inline_payment_method",["require","exports","tslib","react","modules/core/i18n","modules/clean/payments/skus/constants","apiql/client/components/account-gql"],(function(e,t,a,n,i,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IndividualInlinePaymentMethodView=void 0,n=a.__importDefault(n);class o extends n.default.Component{renderCreditCard(){const{accountPaymentInfo:e,transitionDetails:t}=this.props;if(e){const a=e.last_digits;let l;if(t){const{nextBillingDate:e,scheduleId:o,totalPrice:r}=t;return l=o===s.ScheduleId.YEARLY?i.intl.formatMessage({id:"IK0bTU",defaultMessage:"Starting <strong>{date}</strong>, we’ll charge you <strong>{scheduled_total}</strong> per year on your card ending in <strong>{last4}</strong>."},{last4:a,date:e,scheduled_total:r,strong:e=>n.default.createElement("strong",null,e)}):i.intl.formatMessage({id:"QRWsYu",defaultMessage:"Starting <strong>{date}</strong>, we’ll charge you <strong>{scheduled_total}</strong> per month on your card ending in <strong>{last4}</strong>."},{last4:a,date:e,scheduled_total:r,strong:e=>n.default.createElement("strong",null,e)}),n.default.createElement("span",null,l," ")}return l=i.intl.formatMessage({id:"GK+TXw",defaultMessage:"We’ll charge your card ending in {last4}."},{last4:a}),n.default.createElement("span",null,l," ",this.props.renderUpdateLink)}return n.default.createElement("span",null)}renderDirectDebit(){const{accountPaymentInfo:e,transitionDetails:t}=this.props;if(e){const a=e.last_digits;let l;if(t){const{nextBillingDate:e,scheduleId:o,totalPrice:r}=t;return l=o===s.ScheduleId.YEARLY?i.intl.formatMessage({id:"5ZcdXx",defaultMessage:"Starting <strong>{date}</strong>, we’ll charge you <strong>{scheduled_total}</strong> per year on your IBAN ending in <strong>{last4}</strong>."},{last4:a,date:e,scheduled_total:r,strong:e=>n.default.createElement("strong",null,e)}):i.intl.formatMessage({id:"j+Ib+Z",defaultMessage:"Starting <strong>{date}</strong>, we’ll charge you <strong>{scheduled_total}</strong> per month on your IBAN ending in <strong>{last4}</strong>."},{last4:a,date:e,scheduled_total:r,strong:e=>n.default.createElement("strong",null,e)}),n.default.createElement("span",null,l," ")}return l=i.intl.formatMessage({id:"RFtAL9",defaultMessage:"We’ll charge your IBAN ending in {last4}."},{last4:a}),n.default.createElement("span",null,l," ",this.props.renderUpdateLink)}return n.default.createElement("span",null)}renderPaypal(){const{renderUpdateLink:e,transitionDetails:t}=this.props;if(t){const{nextBillingDate:e,scheduleId:a,totalPrice:l}=t,o=a===s.ScheduleId.YEARLY?i.intl.formatMessage({id:"GvhVZe",defaultMessage:"Starting <strong>{date}</strong>, we’ll charge you <strong>{scheduled_total}</strong> per year on your PayPal account."},{date:e,scheduled_total:l,strong:e=>n.default.createElement("strong",null,e)}):i.intl.formatMessage({id:"S7Wy/F",defaultMessage:"Starting <strong>{date}</strong>, we’ll charge you <strong>{scheduled_total}</strong> per month on your PayPal account."},{date:e,scheduled_total:l,strong:e=>n.default.createElement("strong",null,e)});return n.default.createElement("span",null,o," ")}return n.default.createElement("span",null,i.intl.formatMessage({id:"aQ9deh",defaultMessage:"We’ll charge your PayPal account."})," ",e)}renderIdeal(){const{renderUpdateLink:e,transitionDetails:t}=this.props;if(t){const{nextBillingDate:e,scheduleId:a,totalPrice:l}=t,o=a===s.ScheduleId.YEARLY?i.intl.formatMessage({id:"TZiYnT",defaultMessage:"Starting <strong>{date}</strong>, we’ll charge you <strong>{scheduled_total}</strong> per year on your iDEAL account."},{date:e,scheduled_total:l,strong:e=>n.default.createElement("strong",null,e)}):i.intl.formatMessage({id:"8MQcfN",defaultMessage:"Starting <strong>{date}</strong>, we’ll charge you <strong>{scheduled_total}</strong> per month on your iDEAL account."},{date:e,scheduled_total:l,strong:e=>n.default.createElement("strong",null,e)});return n.default.createElement("span",null,o," ")}return n.default.createElement("span",null,i.intl.formatMessage({id:"7EJCsH",defaultMessage:"We’ll charge your iDEAL account."})," ",e)}render(){const{accountPaymentInfo:e,paymentErrorMessage:t}=this.props;if(!e&&t)return n.default.createElement("span",null,t," ",this.props.renderUpdateLink);if(!e)return n.default.createElement("span",null);switch(e.active_payment_method_type){case l.AccountPaymentInfoType.Card:return this.renderCreditCard();case l.AccountPaymentInfoType.Sepa:return this.renderDirectDebit();case l.AccountPaymentInfoType.Paypal:return this.renderPaypal();case l.AccountPaymentInfoType.Ideal:return this.renderIdeal();default:return n.default.createElement("span",null)}}}t.IndividualInlinePaymentMethodView=o,o.displayName="IndividualInlinePaymentMethodView"})),define("modules/clean/account_page/widgets/plan/views/npt_billing_schedule_items",["require","exports","tslib","react","modules/core/i18n","modules/clean/teams/admin/widgets/admin_priced_list/admin_priced_list_item","modules/clean/payments/skus/constants","modules/clean/teams/admin/widgets/admin_priced_list/admin_priced_list"],(function(e,t,a,n,i,s,l,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NptBillingScheduleItems=void 0,n=a.__importDefault(n);class r extends n.default.Component{changeProductScheduleTypeClosure(e){return()=>{this.props.changeProductScheduleType(e)}}getScheduleDescription(e,t,a,n){switch(e){case l.ScheduleId.YEARLY:return i.intl.formatMessage({id:"Fd23KZ",defaultMessage:"{plan_name} is {price_per_year} per year. You’ll save {savePercentage} over monthly billing."},{plan_name:this.props.planName,price_per_year:a,savePercentage:n});case l.ScheduleId.MONTHLY:return i.intl.formatMessage({id:"XD9xb9",defaultMessage:"{plan_name} is {price_per_month} per month. You’ll spend {price_per_year} per year."},{plan_name:this.props.planName,price_per_month:t,price_per_year:a})}return""}getBillingItemTitle(e){switch(e){case l.ScheduleId.YEARLY:return i.intl.formatMessage({id:"onubGk",defaultMessage:"Billed yearly"});case l.ScheduleId.MONTHLY:return i.intl.formatMessage({id:"ytUb1D",defaultMessage:"Billed monthly"})}return""}render(){const{trialPriceConversions:e,finalBillingScheduleId:t}=this.props;return n.default.createElement(o.AdminPricedList,null,Object.keys(e).map(a=>{const o=parseInt(a,10),r=o===t,d=e[a];let c=d.advertised_monthly_price,u=i.intl.formatMessage({id:"0OYZsq",defaultMessage:"per month"});return o===l.ScheduleId.YEARLY&&(c=d.advertised_yearly_price,u=i.intl.formatMessage({id:"1BL+ll",defaultMessage:"per year"})),n.default.createElement(s.AdminPricedListItem,{key:d.conversion_token.plan_sku_code,isSelected:r,title:this.getBillingItemTitle(o),titleWarningText:void 0,titleSecondaryText:void 0,description:this.getScheduleDescription(o,d.advertised_monthly_price,d.advertised_yearly_price,d.advertised_yearly_price_savings),price:void 0,priceString:c,detailsLink:void 0,unit:u,onClick:this.changeProductScheduleTypeClosure(o),disableItem:!1,recommended:o===l.ScheduleId.YEARLY})}))}}t.NptBillingScheduleItems=r,r.displayName="NptBillingScheduleItems"})),define("modules/clean/account_page/widgets/plan/views/plan_status",["require","exports","tslib","modules/core/browser","react","styled-components","modules/clean/viewer","modules/core/assert","modules/core/uri","modules/core/i18n","modules/core/exception","modules/clean/react/payments/update_individual_billing/update_individual_billing_modal_loader","modules/clean/account_page/widgets/plan/strings","modules/clean/account_page/widgets/billing/payment_methods_util","modules/clean/payments/billing_instrument/payment_methods_util","modules/clean/payments/billing_instrument/payment_method_constants","modules/clean/static_urls","modules/clean/react/payments/error/browser_update_required_modal","modules/clean/payments/cash","modules/clean/account_page/widgets/plan/views/change_plan_modal","modules/clean/account_page/widgets/plan/views/cancel_subs_warning_modal","modules/clean/payments/skus/constants","modules/clean/analytics","modules/constants/trademark","dig-components/buttons","modules/clean/account_page/widgets/plan/views/basic_plan_status","modules/core/notify","modules/clean/hql/index","dropbox/proto/hql_events/activation/activation","dropbox/proto/hql_events/revenue/revenue","dropbox/proto/hql_events/extensions","dropbox/proto/hql_events/taxonomy","modules/clean/account_page/components/key_value_block","modules/clean/account_page/widgets/plan/views/addons/addon_section","modules/clean/account_page/widgets/plan/views/addons/constants"],(function(e,t,a,n,i,s,l,o,r,d,c,u,p,m,g,_,f,h,y,b,v,M,S,P,E,C,A,T,I,w,D,N,L,x,k){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PlanStatus=void 0,n=a.__importStar(n),i=a.__importDefault(i),s=a.__importDefault(s),c=a.__importStar(c);const R=N.hql_events.TaxonomyAppSurface.AppSurface,B=N.hql_events.TaxonomyActionSurface.ActionSurface,O=s.default(L.KeyValueBlock)`
  .account-key-value-block__value {
    margin-right: 0;
  }
`,F=s.default.div`
  display: flex;

  .plan-status-section__link {
    white-space: nowrap;
    font-size: var(--type__body__standard--fontsize);
  }
`,U=s.default.div`
  flex-grow: 1;
  color: var(--color__faint__text);
  font-size: var(--type__body__small--fontsize);
  line-height: var(--type__body__large--lineheight);
`,q=s.default.h1`
  font-size: var(--type__body__large--fontsize);
  margin-bottom: var(--spacing__unit--2);
  color: var(--color__standard__text);
`,V=s.default.p`
  color: var(--color__faint__text);
  font-size: var(--type__body__standard--fontsize);
  line-height: var(--type__body__standard--lineheight);
  width: 100%;
  max-width: 520px;
  padding-right: 8px;
  box-sizing: border-box;
`,Y=s.default.div`
  flex-basis: 140px;
  text-align: right;
  display: flex;
  flex-direction: column;
  justify-content: center;
  height: var(--spacing__unit--4);
  margin-top: 30px;
`,j=s.default.span`
  font-size: var(--type__body__small--fontsize);
`,H=s.default.a`
  font-style: italic;
`,G=s.default.div`
  width: 36px;
  margin: var(--spacing__base_unit) var(--spacing__unit--2) auto var(--spacing__base_unit);
  height: 69px;
`,z=s.default(E.Button)`
  height: var(--spacing__unit--4);
  margin: 0;
  padding: 0;
`,Q=s.default(E.Button)`
  line-height: var(--type__body__small--lineheight);
  height: auto;
  min-height: var(--spacing__unit--4);
  margin: var(--spacing__unit--2) 0;
  padding: var(--spacing__unit--0_5);
  white-space: normal;
`,W=s.default.p`
  padding: 0;
  margin: 0;
`,K=s.default.div`
  .plan-status-section__try-free-trial {
    position: relative;

    p {
      width: 370px;
      margin: 0;
    }
  }
`;var X,Z;(function(e){e[e.Cancel=0]="Cancel",e[e.Change=1]="Change",e[e.Manage=2]="Manage",e[e.Upgrade=3]="Upgrade"})(X||(X={})),(function(e){e.BUTTON="button",e.QUERY_PARAM="query_param"})(Z||(Z={}));class J extends i.default.Component{constructor(e){super(e),this.isOverQuota=()=>this.usage>this.quota,this.logSeePlanDetails=()=>{const{isTransactionInformationPage:e}=this.props;T.logEvent(I.hql_events.SelectMoreDetails.create({isTransactionInformationPage:Boolean(e),hqlMetadata:D.hql_events.HQLMetadata.create({appSurface:R.WEB,actionSurface:B.CENTER_PANE})})),S.ProEventsLogger.log("de_plan_tab_details_click")},this.cancelPlanClick=()=>{this.props.isPersonalUser?n.redirect("/cancel-subscription"):n.redirect("/team/cancel")},this.hasAddons=()=>{const{addonsInfo:e}=this.props;return!!e&&0!==e.length},this.canShowChangePlan=e=>{var t;const{subStatus:a,eligibleFor1tb:n,addonsLoadingState:i}=this.props,s=[M.ProductPlanType.STANDARD,M.ProductPlanType.PLUS,M.ProductPlanType.PROFESSIONAL,M.ProductPlanType.TRANSFER,M.ProductPlanType.SYNC_EVERYTHING,M.ProductPlanType.HS_DBX_PRO_BUNDLE,M.ProductPlanType.FAMILY_PAYER];e||s.push(M.ProductPlanType.FAMILY_NONPAYER);const l=null===(t=null==a?void 0:a.subState.plan)||void 0===t?void 0:t.productType;return!(!l||-1===s.indexOf(l))&&(!("ready"===i&&this.hasAddons())&&(!(this.props.hasUnusedLicenseKey||!this.isInStandardSchedule()||n)&&!this.isExternallyManagedSubscription))},this.onUpdateBillingClick=e=>{e.preventDefault(),this.props.browserUpdateRequired?h.BrowserUpdateModalLoader.showInstance():u.IndividualUpdateBillingModalLoader.showInstance()},this.logUpgradeButtonClick=()=>{const e=D.hql_events.HQLEventIdentity.create({eventClass:D.hql_events.HQLEventIdentity.EventClass.create({className:N.hql_events.TaxonomyClass.ClassName.SEE_AND_CLICK}),legacyEvent:D.hql_events.HQLEventIdentity.LegacyEvent.create({table:"pro_events",name:"de_plan_tab_upgrade_to_plus_click"}),actionEventId:D.hql_events.HQLEventIdentity.ActionEventIdentity.create({object:"basic_upgrade_button",action:N.hql_events.TaxonomyAction.Action.SELECT})});T.logEvent(w.hql_events.SelectBasicUpgradeButton.create({hqlMetadata:D.hql_events.HQLMetadata.create({appSurface:R.WEB,actionSurface:B.CENTER_PANE_PLAN_TAB,identityOverride:e})}))},this.redirectToUpgrade=()=>{this.logUpgradeButtonClick(),S.ProEventsLogger.log("de_plan_tab_upgrade_to_plus_click");const e=this.isOverQuota()?"acc_plan_upgrade_overquota_btn":"acc_plan_upgrade",t=new r.URI({path:"/upgrade",query:{oqa:e}}).toString();n.redirect(t)},this.purchaseNowClick=()=>{S.ProEventsLogger.log("de_plan_tab_purchase_now_click"),n.redirect("/pro/convert")},this.cancelTrialClick=()=>{S.ProEventsLogger.log("de_plan_tab_cancel_trial_click");const{modalCallbacks:e}=this.props;if(null==e?void 0:e.openIndividualCancelSurvey)return e.openIndividualCancelSurvey();n.redirect("/account/plan?modal=individual_cancel_survey")},this.contactSupportClick=()=>{S.ProEventsLogger.log("de_plan_tab_contact_support_click"),n.redirect("/support")},this.addPaymentClick=()=>{S.ProEventsLogger.log("de_plan_tab_add_payment_method_click"),u.IndividualUpdateBillingModalLoader.showInstance()},this.logOpenChangePlanModal=()=>{var e;const{subStatus:t}=this.props;if((null===(e=null==t?void 0:t.subState.plan)||void 0===e?void 0:e.productClass)===M.ProductClass.PLAN){const e=t.subState.plan.productType;T.logEvent(w.hql_events.ShownChangePlanModal.create({currentProductPlanType:e,hqlMetadata:D.hql_events.HQLMetadata.create({appSurface:R.WEB,actionSurface:B.CENTER_PANE})})),S.ProEventsLogger.log("change_plan_modal_view",{current_product_plan_type:M.ProductPlanType[e]})}else c.reportException({err:new Error("Change plan modal opened without a plan"),severity:"non-critical"})},this.openChangePlanModal=(e,t=Z.BUTTON,a=b.ChangePlanOrigin.DEFAULT)=>{e&&e.preventDefault(),this.props.isLoggedInUser||(this.props.isPersonalUser?n.redirect("/account/plan"):n.redirect("/team/admin/billing/manage"));const{browserUpdateRequired:i,scheduledForDowngrade:s,paymentInfo:l}=this.props;if(s)v.CancelChangesModalConfirmation.showInstance({transitionPerformed:this.props.onAddonUpdate,subStatus:this.props.subStatus,userIdOverride:this.getUserForModal()});else if(this.props.useChangePlanExperience){const e=r.URI.parse(n.get_href()).getQuery().option;e?n.redirect(`/plan-configuration?option=${e}`):n.redirect("/plan-configuration")}else b.ChangePlanModalView.showInstance({browserUpdateRequired:i,transitionPerformed:this.props.onAddonUpdate,paymentInfo:l,origin:a,userIdOverride:this.getUserForModal()}),this.logOpenChangePlanModal()},this.renderContactSupportLink=()=>i.default.createElement("a",{href:"#",className:"plan-status-section__link account-page__link plan-status-section__contact_support_link",onClick:this.contactSupportClick},d.intl.formatMessage({id:"NYuVLU",defaultMessage:"Contact support to change plan"})),this.renderBillingPeriod=()=>{const{paymentInfo:e,scheduledForDowngrade:t,hasUnusedLicenseKey:a,subStatus:n}=this.props;if(this.isFamilyNonPayerPlan())return;if(this.isBackupPlan())return;if(!e||!this.props.showChangeBillingPeriod||a||!n||!n.subState.plan)return;const{gateway_id:s,is_reseller_billing:l,end_date:o,deactivated:r,is_on_trial:c,reseller_name:u,reseller_link:p,schedule_switchable:g}=e;if(!g&&!t&&!this.isProfessionalTrial()||this.isExternallyManagedSubscription){const e=m.getBillingDisabledMessage({gatewayId:s,isResellerBilling:l,resellerName:u,resellerLink:p,dropboxPlan:n.subState.plan.displayName(),endDate:o,deactivated:r,isOnTrial:c});return i.default.createElement(j,{className:"plan-status-section__message"},e)}return this.isPlusTrial()?void 0:e.is_in_grace_period?i.default.createElement("a",{href:"#",className:"plan-status-section__link account-page__link",onClick:this.onUpdateBillingClick},d.intl.formatMessage({id:"iq/tnl",defaultMessage:"Please update your billing information"})):void 0},this.managePlanClick=()=>{n.redirect("/team/admin/billing/manage")},this.createTrialCtaButtons=(e=!0,t=!1)=>t?i.default.createElement(Y,{className:"plan-status-section__upgrade_btn trial-cta"},i.default.createElement(Q,{className:"cancel-button",variant:"outline",onClick:this.cancelTrialClick},d.intl.formatMessage({id:"QJ3PjI",defaultMessage:"Cancel trial"}))):e?i.default.createElement(Y,{className:"plan-status-section__upgrade_btn trial-cta"},i.default.createElement(z,{className:"purchase-button",variant:"primary",onClick:this.purchaseNowClick},d.intl.formatMessage({id:"rki01J",defaultMessage:"Purchase Now"})),i.default.createElement(Q,{className:"cancel-button",variant:"primary",onClick:this.cancelTrialClick},d.intl.formatMessage({id:"QJ3PjI",defaultMessage:"Cancel trial"}))):i.default.createElement(Y,{className:"plan-status-section__upgrade_btn trial-cta"},i.default.createElement(E.Button,{className:"purchase-button",variant:"primary",onClick:this.purchaseNowClick},d.intl.formatMessage({id:"rki01J",defaultMessage:"Purchase Now"}))),this.renderPlanStatusTitle=e=>i.default.createElement(O,{className:"zero_padding plan-status__subscription-summary",keyText:d.intl.formatMessage({id:"oy8WXs",defaultMessage:"Subscriptions"}),valueText:e}),this.renderChangePlanButton=e=>{const{paymentInfo:t,isLoggedInUser:a,isLoggedInAsTransactionOwner:n}=this.props;if(a&&!n)return this.renderLoginInstructions(X.Change);const s=this.getChangePlanButtonText(),l=this.getChangePlanClickHandler(e);return i.default.createElement(Y,{className:"plan-status-section__upgrade_btn"},i.default.createElement(E.Button,{className:"jest-change-plan-button",variant:"primary",onClick:l,disabled:null==t?void 0:t.is_in_grace_period},s))},this.getChangePlanButtonText=()=>this.isFamilyNonPayerPlan()?d.intl.formatMessage({id:"I9CJF0",defaultMessage:"See other plans"}):d.intl.formatMessage({id:"w1kkK2",defaultMessage:"Change plan"}),this.getChangePlanClickHandler=e=>{const{subStatus:t}=this.props;let a;return a=e?()=>{t.subState.plan.isEnterprise?n.redirect("/team/admin/help?role=work"):n.redirect("/team/admin/billing/manage?show_switch_plan")}:this.isFamilyNonPayerPlan()?()=>{S.ProEventsLogger.log("de_plan_tab_see_other_plans_family_member_click"),n.redirect(this.plansURL)}:this.openChangePlanModal,a},this.logUpgradeOverquotaBtn=e=>{S.GrowthEventsLogger.log("acc_plan_upgrade_overquota_btn",{action:e,button_text:"Upgrade now",destination_url:"http://www.dropbox.com/upgrade",location:"in_product",quota_status:"over",upsell_type:"modal"})},this.onUpgradePlanButtonClick=()=>{this.logUpgradeOverquotaBtn("click"),this.redirectToUpgrade()},this.state={addonsInfoMinimized:!0}}componentDidMount(){const e=r.URI.parse(n.get_href()).getQuery().modal;if(e)if("plan"===e||"plus_to_family"===e)if(this.canShowChangePlan(!0)){const t="plan"===e?b.ChangePlanOrigin.DEFAULT:b.ChangePlanOrigin.PLUS_TO_FAMILY;Promise.resolve().then(()=>{this.openChangePlanModal(void 0,Z.QUERY_PARAM,t)})}else A.Notify.error(d.intl.formatMessage({id:"Ruu9sN",defaultMessage:"You cannot change plans at this time."}));else"downgrade"===e&&this.props.scheduledForDowngrade&&v.CancelChangesModalConfirmation.showInstance({transitionPerformed:this.props.onAddonUpdate,subStatus:this.props.subStatus,userIdOverride:this.getUserForModal()})}get plansURL(){const{isLoggedInUser:e,isTransactionInformationPage:t}=this.props,a={oqa:"acc_plan_upgrade"};return t&&!e&&(a.trigger="nr"),this.isTransferPlan()?"https://help.dropbox.com/accounts-billing/plans-upgrades/dropbox-transfer-plan":this.isBackupPlan()?"https://help.dropbox.com/accounts-billing/plans-upgrades/dropbox-backup-plan":new r.URI({path:"/plans",query:a}).toString()}get usage(){const{usageBreakdown:e}=this.props;return e.usage}get quota(){const{usageBreakdown:e}=this.props;return e.quota||.01}get isExternallyManagedSubscription(){const{paymentInfo:e,isExternallyBilled:t}=this.props;return t||e&&m.shouldHideBillingChange(e.gateway_id,e.is_reseller_billing)}renderCancelPlanButton(){return this.props.isLoggedInUser&&!this.props.isLoggedInAsTransactionOwner?this.renderLoginInstructions(X.Cancel):i.default.createElement(Y,{className:"plan-status-section__upgrade_btn"},i.default.createElement(E.Button,{onClick:this.cancelPlanClick,variant:"outline"},d.intl.formatMessage({id:"vQndaY",defaultMessage:"Cancel plan"})))}isTransferPlan(){const{subStatus:e}=this.props;return!(!e||!e.subState.plan)&&e.subState.plan.productType===M.ProductPlanType.TRANSFER}isBackupPlan(){var e,t;return(null===(t=null===(e=this.props.subStatus)||void 0===e?void 0:e.subState.plan)||void 0===t?void 0:t.productType)===M.ProductPlanType.SYNC_EVERYTHING}isHSProPlan(){var e,t;return(null===(t=null===(e=this.props.subStatus)||void 0===e?void 0:e.subState.plan)||void 0===t?void 0:t.productType)===M.ProductPlanType.HS_DBX_PRO_BUNDLE}isFamilyPayerPlan(){var e,t;return(null===(t=null===(e=this.props.subStatus)||void 0===e?void 0:e.subState.plan)||void 0===t?void 0:t.productType)===M.ProductPlanType.FAMILY_PAYER}isFamilyNonPayerPlan(){var e,t;return(null===(t=null===(e=this.props.subStatus)||void 0===e?void 0:e.subState.plan)||void 0===t?void 0:t.productType)===M.ProductPlanType.FAMILY_NONPAYER}isFamilyPlan(){return this.isFamilyPayerPlan()||this.isFamilyNonPayerPlan()}isFreePlusPlan(){const{subStatus:e}=this.props;return!(!e||!e.subState.plan)&&e.subState.plan.productType===M.ProductPlanType.FREE}isInStandardSchedule(){const{subStatus:e}=this.props;if(e&&e.subState&&e.subState.billingSchedule){const t=e.subState.billingSchedule.id;return t===M.ScheduleId.MONTHLY||t===M.ScheduleId.YEARLY}return!1}isTaurusPlan(){const{subStatus:e}=this.props;if(e&&e.subState.plan){const t=e.subState.plan.productType;return t===M.ProductPlanType.PLUS||t===M.ProductPlanType.PLUS_TRIAL||t===M.ProductPlanType.PROFESSIONAL||t===M.ProductPlanType.PROFESSIONAL_TRIAL||t===M.ProductPlanType.PLUS_WITH_SS||t===M.ProductPlanType.PLUS_WITH_SS_TRIAL}return!1}getGatewayId(){const{paymentInfo:e}=this.props;return e?e.gateway_id:_.NOT_APPLICABLE}isTrialPlan(){return this.isPlusTrial()||this.isProfessionalTrial()}isPlusTrial(){const{subStatus:e}=this.props;return!(!e||!e.subState.plan)&&(e.subState.plan.productType===M.ProductPlanType.TRIAL||e.subState.plan.productType===M.ProductPlanType.PLUS_TRIAL)}isProfessionalTrial(){const{subStatus:e}=this.props;return!(!e||!e.subState.plan)&&e.subState.plan.productType===M.ProductPlanType.PROFESSIONAL_TRIAL}isLicensePlan(){const{hasLicenseKey:e,paymentInfo:t}=this.props;return!!t&&(e||g.isLicenseKey(t.gateway_id))}renderLoginInstructions(e){let t,a;return a=this.props.userEmail?this.props.userEmail:d.intl.formatMessage({id:"fZ1ZfV",defaultMessage:"the account user"}),t=e===X.Cancel?d.intl.formatMessage({id:"diOSTv",defaultMessage:"Please login as {email}{br}to cancel your plan."},{br:i.default.createElement("br",null),email:a}):e===X.Change?d.intl.formatMessage({id:"7/qGqI",defaultMessage:"Please login as {email}{br}to change your plan."},{br:i.default.createElement("br",null),email:a}):e===X.Manage?d.intl.formatMessage({id:"yHAcZL",defaultMessage:"Please login as {email}{br}to manage your plan."},{br:i.default.createElement("br",null),email:a}):e===X.Upgrade?d.intl.formatMessage({id:"EYQ0Wr",defaultMessage:"Please login as {email}{br}to upgrade your plan."},{br:i.default.createElement("br",null),email:a}):d.intl.formatMessage({id:"wBh1Uk",defaultMessage:"Please login as {email}."},{email:a}),i.default.createElement("div",{className:"plan-status-section__login-msg"},t)}getUserForModal(){const{isPersonalUser:e,useSpecifiedRole:t,isLoggedInAsTransactionOwner:a}=this.props;let n=null;if(t&&a){const t=l.Viewer.get_viewer();n=e?t.personal_user?t.personal_user.id:null:t.work_user?t.work_user.id:null,o.assert(null!=n,"Could not find user for specified role; modal will fail")}return n}renderDropboxLogo(){return i.default.createElement(G,{className:"plan-status-section__icon u-mar-right-s"},i.default.createElement("img",{src:f.static_url("/static/images/logo_catalog/dropbox-business-icon_m1-vflczuza3.svg"),alt:""}))}getTeamName(){return this.props.isLoggedInAsTransactionOwner&&l.Viewer.get_viewer().team_name?l.Viewer.get_viewer().team_name:this.props.teamName?this.props.teamName:null}renderManagePlanButton(){return this.props.isLoggedInUser&&!this.props.isLoggedInAsTransactionOwner?this.renderLoginInstructions(X.Manage):i.default.createElement(Y,{className:"plan-status-section__upgrade_btn"},i.default.createElement(E.Button,{variant:"primary",onClick:this.managePlanClick},d.intl.formatMessage({id:"RBsGH7",defaultMessage:"Manage plan"})))}renderBusinessPlanSection(){const{subStatus:e,isTeamAdmin:t,scheduledForDowngrade:a,showCancelButton:n,addonsInfo:s,addonsLoadingState:o,browserUpdateRequired:r,onAddonUpdate:c}=this.props;if(e&&e.subState.isDeactivatedTeam)return this.renderBasicPlanSection();if(!e||!e.subState.plan)return;const u=e.subState.plan.productType===M.ProductPlanType.STANDARD;let p=e.subState.plan.displayName(!1,u);u||(p=d.intl.formatMessage({id:"15/NF/",defaultMessage:"{trade_mark} {plan_title}"},{trade_mark:P.TRADEMARK_BUSINESS,plan_title:p}));let m="";const g=this.getTeamName();let _,f;g&&(t?(m=d.intl.formatMessage({id:"TcIDqw",defaultMessage:"You’re an admin of the {team_name} Dropbox account."},{team_name:g}),this.props.isLoggedInAsTransactionOwner||(m=d.intl.formatMessage({id:"J98s/Q",defaultMessage:"This account is an admin of the {team_name} Dropbox account."},{team_name:g}))):(m=d.intl.formatMessage({id:"jgGyr5",defaultMessage:"You’re a member of the {team_name} Dropbox account."},{team_name:g}),this.props.isLoggedInAsTransactionOwner||(m=d.intl.formatMessage({id:"2c6DhA",defaultMessage:"This account is a member of the {team_name} Dropbox account."},{team_name:g}))));const h=l.Viewer.get_viewer(),y=e.subState.plan.isEnterprise;return this.props.isLoggedInUser&&!this.props.isLoggedInAsTransactionOwner?_=this.renderLoginInstructions():y?_=null:t||!this.props.isLoggedInUser?(_=this.renderManagePlanButton(),n&&(_=a?this.renderManagePlanButton():this.renderCancelPlanButton())):!t&&h.is_paired&&(f=i.default.createElement("p",null,d.intl.formatMessage({id:"7bN4Js",defaultMessage:"Looking for details on another plan?"})," ",i.default.createElement(H,{className:"plan-status-section__link plan-status-section__link--inline account-page__link",href:"/account/plan?role=personal"},d.intl.formatMessage({id:"JejsPF",defaultMessage:"Visit your personal account page."})))),i.default.createElement(F,{className:"plan-status-section"},this.renderDropboxLogo(),i.default.createElement(U,{className:"plan-status-section__description"},i.default.createElement(q,{className:"plan-status-section__title"},p),i.default.createElement(V,{className:"plan-status-section__title_description"},m),f,i.default.createElement(x.AddonSection,{addonSectionStatus:k.AddonSectionStatus.CURRENT,addonsInfo:s,addonsLoadingState:o,billingSchedule:e.finalSubState.billingSchedule,formattedSpecQuotaGb:e.subState.plan.formattedSpecQuotaGb,totalQuota:this.quota,onlyShowDescription:!0,browserUpdateRequired:r,onAddonUpdate:c,isPersonalUser:!1})),_)}showBasicPlanWithTrial(){const{trialsConfig:e}=this.props;return e&&e.trialBanner&&e.currentPlan&&e.currentPlan.skuContent&&e.currentPlan.skuContent.name===P.TRADEMARK_BASIC}renderUpgradePlanButton(e){return this.props.trialsConfig&&this.props.trialsConfig.trialBanner?i.default.createElement("div",null):this.props.isLoggedInUser&&!this.props.isLoggedInAsTransactionOwner?this.renderLoginInstructions(X.Upgrade):(this.isOverQuota()&&this.logUpgradeOverquotaBtn("view"),i.default.createElement(Y,{className:"plan-status-section__upgrade_btn"},i.default.createElement(E.Button,{variant:"primary",className:"jest-upgrade-plan-button",onClick:this.onUpgradePlanButtonClick},e)))}renderBasicPlanSection(){var e;const{subStatus:t,isLimitedTeam:a,isLockedTeam:n,isPaidTeam:s}=this.props;let l=P.DROPBOX_BASIC;if(!t)return;n&&(null===(e=t.subState.planSku)||void 0===e?void 0:e.content)?l=p.getLockedTeamPlanName(s,t.subState.planSku.content.dropboxDisplayName()):!this.showBasicPlanWithTrial()&&t.subState.plan&&(l=t.subState.plan.displayName());let o=void 0;if(a||t.subState.isDeactivatedTeam){const e=this.getTeamName();let t=d.intl.formatMessage({id:"jgGyr5",defaultMessage:"You’re a member of the {team_name} Dropbox account."},{team_name:e});this.props.isLoggedInAsTransactionOwner||(t=d.intl.formatMessage({id:"2c6DhA",defaultMessage:"This account is a member of the {team_name} Dropbox account."},{team_name:e})),o=i.default.createElement(W,{className:"plan-status-section__team_desc"},t)}const r=this.isOverQuota()?d.intl.formatMessage({id:"F2lDMN",defaultMessage:"Upgrade now"}):d.intl.formatMessage({id:"IqV88I",defaultMessage:"Upgrade"}),c=this.renderUpgradePlanButton(r);return i.default.createElement(C.BasicPlanStatusSection,{planName:l,plansUrl:this.plansURL,limitedTeam:o,upgradePlanButton:c,hidePlansLink:this.isExternallyManagedSubscription,hideUpgradeButton:n})}renderResellerPlan(){const e=d.intl.formatMessage({id:"mAtx6/",defaultMessage:"Dropbox {plus} 1TB"},{plus:P.TRADEMARK_PLUS});return i.default.createElement(F,{className:"plan-status-section"},this.renderDropboxLogo(),i.default.createElement(U,{className:"plan-status-section__description"},i.default.createElement(q,{className:"plan-status-section__title"},e),i.default.createElement(V,{className:"plan-status-section__title_description"},this.renderBillingPeriod())))}renderPaidPlanSection(){const{subStatus:e,isLimitedTeam:t,hasUnusedLicenseKey:a,paymentInfo:n,scheduledForDowngrade:s,isLoggedInAsTransactionOwner:l,showCancelButton:o,addonsInfo:r,addonsLoadingState:c,eligibleFor1tb:u,browserUpdateRequired:g,onAddonUpdate:_}=this.props;if(!e||!e.scheduledSubState||!e.subState.plan)return;const f=e.subState.plan,h=p.getPaidPlanName(f,!1,this.getGatewayId());let y,b,v,M,S,P;if(m.shouldHideBillingSummary(n,e.subState.plan.productType)||(M=p.getPaidPlanDefaultBillingSummary(e.nextBillingSummary,e.finalSubState.billingSchedule)),a&&(S=l?d.intl.formatMessage({id:"E5PyhP",defaultMessage:"Your license key will be activated and no charge made to your payment method on file."}):d.intl.formatMessage({id:"Yutfxu",defaultMessage:"This account’s license key will be activated and no charge made to the payment method on file."})),!this.isExternallyManagedSubscription){let t="";if(this.isFamilyNonPayerPlan())t=d.intl.formatMessage({id:"w5oksG",defaultMessage:"You’re a member of the {family} plan."},{family:f.displayName()});else if(a)t=S||"";else if(!s&&(v=d.intl.formatMessage({id:"mNB218",defaultMessage:"<strong>{billing_summary}</strong> Renews on {date}."},{date:e.formattedNextBillingDate,billing_summary:M||"",strong:e=>i.default.createElement("strong",null,e)}),t=p.getPlanFeatureDescription(f),this.hasAddons())){t=`${p.getPriceBreakdownByPlan(e.nextBillingSummary,e.finalSubState.billingSchedule,e.scheduledSubState.plan)} ${t}`}y=i.default.createElement("span",{className:"plan-status-section__description-content"},t," ")}if(s){const e=p.getPlanFeatureDescription(f);y=i.default.createElement("span",null,e," ")}if(t){const e=this.getTeamName();let t=d.intl.formatMessage({id:"X0wsLF",defaultMessage:"You’re a member of the {team_name} Dropbox account."},{team_name:e});l||(t=d.intl.formatMessage({id:"/IIBtR",defaultMessage:"This account is a member of the {team_name} Dropbox account."},{team_name:e})),b=i.default.createElement(W,{className:"plan-status-section__team_desc"},t)}return this.canShowChangePlan(!1)&&(P=this.renderChangePlanButton(!1)),o&&!s&&(P=this.renderCancelPlanButton()),i.default.createElement("div",null,this.renderPlanStatusTitle(v),i.default.createElement(F,{className:"plan-status-section"},this.renderDropboxLogo(),i.default.createElement(U,{className:"plan-status-section__description"},i.default.createElement(q,{className:"plan-status-section__title"},h),b,i.default.createElement(V,{className:"plan-status-section__title_description"},y,this.renderPlanDetails(),i.default.createElement("br",null),this.renderBillingPeriod()),i.default.createElement(x.AddonSection,{addonSectionStatus:k.AddonSectionStatus.CURRENT,addonsInfo:r,addonsLoadingState:c,billingSchedule:e.finalSubState.billingSchedule,formattedSpecQuotaGb:e.subState.plan.formattedSpecQuotaGb,totalQuota:this.quota,eligibleFor1tb:u,browserUpdateRequired:g,onAddonUpdate:_,isPersonalUser:!0})),P))}renderPlanDetails(){if(this.isHSProPlan())return;if(this.props.eligibleFor1tb||!this.isExternallyManagedSubscription&&!this.isInStandardSchedule()||this.isFreePlusPlan()||this.props.hasUnusedLicenseKey)return this.renderContactSupportLink();let e=d.intl.formatMessage({id:"GPqIVb",defaultMessage:"What’s included?"});if(this.isFamilyPlan())e=d.intl.formatMessage({id:"um7qHG",defaultMessage:"What’s included?"});else if(this.isTaurusPlan()){if(this.isExternallyManagedSubscription)return;e=d.intl.formatMessage({id:"RuKlo2",defaultMessage:"See plan details"})}else if(this.isBackupPlan())e=d.intl.formatMessage({id:"3hCG9P",defaultMessage:"See plan info"});else{if(this.isExternallyManagedSubscription)return;e=d.intl.formatMessage({id:"VEb96o",defaultMessage:"See available plans"})}return i.default.createElement("a",{className:"plan-status-section__link account-page__link jest-see-plan-details-btn",onClick:this.logSeePlanDetails,href:this.plansURL,target:"_blank",rel:"noopener noreferrer"},e)}renderTrialSection(){const{subStatus:e,paymentInfo:t}=this.props;if(!(e&&e.subState&&e.subState.plan&&t))return;const{gateway_id:a,trial_info:n}=t;if(!n)return;let s=i.default.createElement("noscript",null);g.isIOS(a)||g.isAndroid(a)||(s=this.createTrialCtaButtons(!n.is_trial_overdue,this.isProfessionalTrial()));let l,o=d.intl.formatMessage({id:"625HOw",defaultMessage:"Dropbox {plus}"},{plus:e.subState.plan.displayName(!1,!1,a)});return n.is_trial_overdue&&(o+=" "+d.intl.formatMessage({id:"yI+MEC",defaultMessage:"(Expired)"})),l=this.isProfessionalTrial()?m.getProfessionalTrialPlanDescription(e):m.getTrialDescription(a,n,e.formattedNextBillingDate),i.default.createElement(F,{className:"plan-status-section"},this.renderDropboxLogo(),i.default.createElement(U,{className:"plan-status-section__description"},i.default.createElement(q,{className:"plan-status-section__title"},o),i.default.createElement(V,{className:"plan-status-section__title_description"},l," ",this.isProfessionalTrial()&&i.default.createElement("span",null,this.renderPlanDetails(),i.default.createElement("br",null),this.renderBillingPeriod()))),s)}get hasSelfServablePaymentAfterLicensekey(){const{paymentInfo:e}=this.props;return e&&!g.isLicenseKey(e.gateway_id)&&!m.shouldHidePaymentMethod(e.gateway_id)}renderLicensePlanSection(){const{subStatus:e,isLoggedInAsTransactionOwner:t}=this.props;if(!e||!e.subState||!e.subState.plan)return i.default.createElement("noscript",null);const a=d.intl.formatMessage({id:"625HOw",defaultMessage:"Dropbox {plus}"},{plus:e.subState.plan.displayName()});let n,s=i.default.createElement("noscript",null);if(this.props.hasUnusedLicenseKey){n=t?d.intl.formatMessage({id:"jQ1eDP",defaultMessage:"Your Dropbox {plus} plan was activated with a license key. Your next license key will be activated on {date}."},{plus:P.TRADEMARK_PLUS,date:e.formattedNextBillingDate}):d.intl.formatMessage({id:"yXjZBq",defaultMessage:"This Dropbox {plus} plan was activated with a license key. The next license key will be activated on {date}."},{plus:P.TRADEMARK_PLUS,date:e.formattedNextBillingDate});let a=i.default.createElement("noscript",null);if(this.hasSelfServablePaymentAfterLicensekey)a=i.default.createElement("div",null,d.intl.formatMessage({id:"flOh9z",defaultMessage:"No charge made to your payment method on file."})),this.props.isLoggedInAsTransactionOwner||(a=i.default.createElement("div",null,d.intl.formatMessage({id:"c1bGK9",defaultMessage:"No charge made to the payment method on file."})));else{let e=d.intl.formatMessage({id:"nswDHh",defaultMessage:"You can add your payment information now to have your subscription automatically renew when your keys expire."});this.props.isLoggedInAsTransactionOwner||(e=d.intl.formatMessage({id:"/Xs7Nm",defaultMessage:"The account owner can add payment information now to have this subscription automatically renew when the keys expire."})),a=i.default.createElement("div",null,e,i.default.createElement("br",null),i.default.createElement("a",{href:"#",onClick:this.addPaymentClick},d.intl.formatMessage({id:"2zkZ/z",defaultMessage:"Add payment method."})))}s=i.default.createElement("div",null,n,i.default.createElement("br",null),a)}else if(this.hasSelfServablePaymentAfterLicensekey&&!this.props.scheduledForDowngrade){const t=e.scheduledSubState.billingSchedule.scheduleDescriptionNoun;let a=d.intl.formatMessage({id:"QoelR9",defaultMessage:"Your Dropbox {plus} plan was activated with a license key. The plan will renew on {date}."},{plus:P.TRADEMARK_PLUS,date:e.formattedNextBillingDate}),n=d.intl.formatMessage({id:"DrEa0N",defaultMessage:"{new_total} per {new_period} will be charged to your payment method on file."},{new_total:y.Cash.formatWithTaxLabels(e.nextBillingSummary.total,e.nextBillingSummary),new_period:t});this.props.isLoggedInAsTransactionOwner||(a=d.intl.formatMessage({id:"kQDw1e",defaultMessage:"This Dropbox {plus} plan was activated with a license key. The plan will renew on {date}."},{plus:P.TRADEMARK_PLUS,date:e.formattedNextBillingDate}),n=d.intl.formatMessage({id:"xhxvHj",defaultMessage:"{new_total} per {new_period} will be charged to the payment method on file."},{new_total:y.Cash.formatWithTaxLabels(e.nextBillingSummary.total,e.nextBillingSummary),new_period:t})),s=i.default.createElement("div",null,a,i.default.createElement("br",null),n,i.default.createElement("br",null),this.renderBillingPeriod())}else{let t=d.intl.formatMessage({id:"6ejtCb",defaultMessage:"Your Dropbox {plus} plan was activated with a license key. The plan is active until {date}."},{plus:P.TRADEMARK_PLUS,date:e.formattedNextBillingDate}),a=d.intl.formatMessage({id:"vNTGeR",defaultMessage:"You can add your payment information now to have your subscription automatically renew when it expires."});this.props.isLoggedInAsTransactionOwner||(t=d.intl.formatMessage({id:"uTD2X0",defaultMessage:"This account’s Dropbox {plus} plan was activated with a license key. The plan is active until {date}."},{plus:P.TRADEMARK_PLUS,date:e.formattedNextBillingDate}),a=d.intl.formatMessage({id:"fEZEwT",defaultMessage:"The account owner can add payment information now to have this subscription automatically renew when it expires."})),s=i.default.createElement("div",null,t,i.default.createElement("br",null),a,i.default.createElement("br",null),i.default.createElement("a",{href:"#",onClick:this.addPaymentClick},d.intl.formatMessage({id:"fSZaj1",defaultMessage:"Add payment method."})))}return i.default.createElement(F,{className:"plan-status-section"},this.renderDropboxLogo(),i.default.createElement(U,{className:"plan-status-section__description"},i.default.createElement(q,{className:"plan-status-section__title"},a),i.default.createElement(V,{className:"plan-status-section__title_description"},s),this.renderContactSupportLink()))}renderPlanSection(){const{subStatus:e,isExternallyBilled:t,paymentInfo:a,isLimitedTeam:n}=this.props;return this.showBasicPlanWithTrial()?this.renderBasicPlanSection():t&&void 0!==a&&null!==a.reseller_name?this.renderResellerPlan():t&&n&&void 0!==a&&a.gateway_id===_.NOT_APPLICABLE?void 0:e&&e.subState.plan&&[M.ProductFamily.PRO,M.ProductFamily.FAMILY].includes(e.subState.plan.productFamily)?this.isTrialPlan()?this.renderTrialSection():this.isLicensePlan()?this.renderLicensePlanSection():this.renderPaidPlanSection():this.renderBasicPlanSection()}render(){const{isPersonalUser:e,isLimitedTeam:t}=this.props,a=e||t?this.renderPlanSection():this.renderBusinessPlanSection();return i.default.createElement(K,{className:"plan-status account-plan-section"},a)}}t.PlanStatus=J,J.displayName="PlanStatus"})),define("modules/clean/account_page/widgets/plan/views/resubscribe_plan_upsell",["require","exports","tslib","react","modules/clean/react/components/css","dig-components/buttons","dig-components/typography","dropbox/proto/storefront_platform_js_init_data/types","modules/core/browser","modules/clean/account_page/widgets/plan/strings","modules/clean/analytics"],(function(e,t,a,n,i,s,l,o,r,d,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ResubscribePlanUpsell=void 0,n=a.__importDefault(n),r=a.__importStar(r);var u=o.storefront_platform.StorefrontPlatformContractLengthUnit;class p extends n.default.Component{constructor(){super(...arguments),this.onResubscribeClick=(e,t)=>()=>{c.ProEventsLogger.log("plan_resubscribe_click",{plan_id:e}),r.redirect(t)},this.onPlanDetailsClick=(e,t)=>()=>{c.ProEventsLogger.log("plan_details_click",{plan_id:e}),r.redirect(t)}}render(){const{planProductType:e,planDisplayName:t,planEndedDate:a,planBillingUnitPrice:i,planBillingFrequency:o,purchaseEndpoint:r,productDetailsEndpoint:p}=this.props;if(!(e&&t&&a&&i&&(o===u.MONTH||o===u.YEAR)&&r&&p))return null;c.ProEventsLogger.log("plan_resubscribe_upsell_shown",{plan_id:e});const m=t,g=d.getResubscribeUpsellDescription(t,a,i,o);return n.default.createElement("div",{className:"resubscribe-plan-upsell"},n.default.createElement(l.Title,{size:"small",className:"resubscribe-plan-upsell__header"},m),n.default.createElement(l.Text,{className:"resubscribe-plan-upsell__description"},g),n.default.createElement("div",{className:"resubscribe-plan-upsell-actions"},n.default.createElement(s.Button,{variant:"outline",className:"resubscribe-plan-upsell-actions__resubscribe-button",onClick:this.onResubscribeClick(e,r)},d.getResubscribeUpsellResubscribeButtonText()),n.default.createElement(s.Button,{variant:"transparent",className:"resubscribe-plan-upsell-actions__plan-details-button",onClick:this.onPlanDetailsClick(e,p)},d.getResubscribeUpsellPlanDetailsButtonText())))}}p.displayName="ResubscribePlanUpsellView",t.ResubscribePlanUpsell=i.requireCssWithComponent(p,["/static/css/growth_pages/account_plan_tab/resubscribe_plan_upsell-vflGFC8mz.css"])})),define("modules/clean/account_page/widgets/plan/views/update_billing_info",["require","exports","tslib","react","modules/core/i18n","dig-components/buttons"],(function(e,t,a,n,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UpdateBillingInfoButton=t.UpdateBillingInfoLink=void 0,n=a.__importDefault(n),t.UpdateBillingInfoLink=({className:e,updateBillingCTA:t})=>n.default.createElement("a",{key:"updateBillingInfo",className:e||"",href:"#",onClick:e=>{e.stopPropagation(),e.preventDefault(),t(e)}},i.intl.formatMessage({id:"ipgitK",defaultMessage:"Update billing information"})),t.UpdateBillingInfoLink.displayName="UpdateBillingInfoLink",t.UpdateBillingInfoButton=({updateBillingCTA:e})=>n.default.createElement(s.Button,{variant:"transparent",onClick:t=>{t.stopPropagation(),t.preventDefault(),e(t)}},i.intl.formatMessage({id:"LcZnrF",defaultMessage:"Update billing info"})),t.UpdateBillingInfoButton.displayName="UpdateBillingInfoButton"})),define("modules/clean/react/campaigns/campaign_events_api",["require","exports","tslib","react","modules/core/exception","api_v2/user_client","modules/clean/active_user","modules/clean/react/user_metadata/api"],(function(e,t,a,n,i,s,l,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CampaignContext=t.parseIntOrUndefined=t.reportException=t.logCampaignDismissed=t.setCampaignDismissedInUserMetadata=t.getIsCampaignDismissedInUserMetadata=t.logCampaignClick=t.logCampaignImpressionDeclined=t.logCampaignImpression=t.createMegaphoneCampaignImpressionContextFromMegaphoneImpressionContext=t.createMegaphoneCampaignImpressionContext=t.createMegaphoneCampaignImpressionContextFromEnrichedCampaignImpressionContext=void 0,n=a.__importDefault(n),i=a.__importStar(i);function r(e,t,a){let n=void 0;try{n={campaignId:t,campaignVariantId:a,campaignImpressionId:e,userId:l.mustGetActiveUserId()}}catch(e){reportException({err:e})}return n}function reportException({err:e,severity:t=i.SEVERITY.NONCRITICAL,exc_extra:a={}}){i.reportException({err:e,tags:["megaphone","robe"],severity:t,exc_extra:a})}function d(e,t,a){const n=new s.UserApiV2Client,i={megaphone_impression_id:e.campaignImpressionId,megaphone_request_context:{user_id:e.userId},campaign_event_name:t,campaign_event_info:a,campaign_id:c(e.campaignId),version_id:c(e.campaignVariantId)};return n.ns("megaphone").rpc("log_campaign_event",i,{subjectUserId:e.userId}).catch(a=>{reportException({err:a,exc_extra:{user_id:e.userId,impression_id:e.campaignImpressionId,event_name:t[".tag"]}})})}function c(e){switch(typeof e){case"string":return parseInt(e,10);case"number":return e;default:return}}t.createMegaphoneCampaignImpressionContextFromEnrichedCampaignImpressionContext=function(e){var t,a;return r(e.megaphone_impression_id||"",null===(t=e.campaign_variant_descriptor)||void 0===t?void 0:t.campaign_id,null===(a=e.campaign_variant_descriptor)||void 0===a?void 0:a.variant_id)},t.createMegaphoneCampaignImpressionContext=r,t.createMegaphoneCampaignImpressionContextFromMegaphoneImpressionContext=function(e){var t,a,n,i;if(e.megaphone_impression_id)return r(e.megaphone_impression_id,null===(a=null===(t=e.version_info)||void 0===t?void 0:t.campaign_id)||void 0===a?void 0:a.toString(),null===(i=null===(n=e.version_info)||void 0===n?void 0:n.version_id)||void 0===i?void 0:i.toString())},t.logCampaignImpression=function(e){return d(e,{".tag":"impression"})},t.logCampaignImpressionDeclined=function(e){return d(e,{".tag":"impression_declined"})},t.logCampaignClick=function(e,t){return d(e,{".tag":"click"},{cta_id:t})},t.getIsCampaignDismissedInUserMetadata=function(e){return a.__awaiter(this,void 0,void 0,(function*(){const{campaignId:t,campaignImpressionId:a,userId:n}=e;if(t)try{const{CAMPAIGNS_TOOLKIT_USER_DISMISSED_CAMPAIGNS:e}=yield o.getUserMetadata(["CAMPAIGNS_TOOLKIT_USER_DISMISSED_CAMPAIGNS"],n);return!!e&&new Set(e.split(":")).has(`${t}`)}catch(e){return reportException({err:e,exc_extra:{user_id:n,impression_id:a,campaign_id:t,event_name:"getIsCampaignDismissedInUserMetadata"}}),!0}return!1}))},t.setCampaignDismissedInUserMetadata=function(e){return a.__awaiter(this,void 0,void 0,(function*(){const{campaignId:t,campaignImpressionId:a,userId:n}=e;if(t)try{const{CAMPAIGNS_TOOLKIT_USER_DISMISSED_CAMPAIGNS:e}=yield o.getUserMetadata(["CAMPAIGNS_TOOLKIT_USER_DISMISSED_CAMPAIGNS"],n),a=new Set(e?e.split(":"):"").add(`${t}`),i=Array.from(a).join(":");yield o.setUserMetadata({CAMPAIGNS_TOOLKIT_USER_DISMISSED_CAMPAIGNS:i},n)}catch(e){reportException({err:e,exc_extra:{user_id:n,impression_id:a,campaign_id:t,event_name:"setCampaignDismissedInUserMetadata"}})}}))},t.logCampaignDismissed=function(e){return d(e,{".tag":"dismissed"})},t.reportException=reportException,t.parseIntOrUndefined=c,t.CampaignContext=n.default.createContext(void 0)})),define("modules/clean/family/constants",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MAX_LICENSES=t.getFamilyJoinUrl=t.FAMILY_INVITE_URI_PATH_SUCCESS=t.FAMILY_INVITE_URI_PATH=t.FAMILY_HOME_PATH=void 0,t.FAMILY_HOME_PATH="/h",t.FAMILY_INVITE_URI_PATH="/family/invite",t.FAMILY_INVITE_URI_PATH_SUCCESS="/family/invite?success",t.getFamilyJoinUrl=e=>`/family/join/${e}`,t.MAX_LICENSES=6})),define("modules/clean/react/growth/trials/util",["require","exports","tslib","api_v2/user_client","modules/clean/payments/skus/constants"],(function(e,t,a,n,i){"use strict";function s(e){return{href:e.href,onClickType:e.on_click_type,text:e.text}}var l;Object.defineProperty(t,"__esModule",{value:!0}),t.getTransitionChangeType=t.PerformPlanTransitionForTrials=t.fetchModalConfig=t.formatCtaConfigResult=void 0,t.formatCtaConfigResult=s,t.fetchModalConfig=function(e,t){return a.__awaiter(this,void 0,void 0,(function*(){const a={primaryCTA:{}},i=new n.UserApiV2Client;try{const a=yield i.ns("trials").rpc("get_trials_modal_config",{modal_type:t},{subjectUserId:e}),{description:n,features:l,heading:o,primary_cta:r,secondary_cta:d}=a;return{description:n,features:l,heading:o,primaryCTA:r?s(r):void 0,secondaryCTA:d?s(d):void 0}}catch(e){return a}}))},(function(e){e[e.PLUS=3]="PLUS",e[e.PROFESSIONAL=4]="PROFESSIONAL"})(l=t.PerformPlanTransitionForTrials||(t.PerformPlanTransitionForTrials={})),t.getTransitionChangeType=function(e){if(e.finalSubState.planSku){if(e.finalSubState.planSku.productType===i.ProductPlanType.PLUS)return l.PLUS;if(e.finalSubState.planSku.productType===i.ProductPlanType.PROFESSIONAL)return l.PROFESSIONAL}return null}})),define("modules/clean/react/payments/edit_invoice_address_modal/edit_invoice_address_modal_loader",["require","exports","tslib","modules/core/notify","react","modules/clean/react/components/css","modules/clean/react/sprite","modules/core/uri","modules/core/i18n","modules/clean/react/arbor/aspen/elements/arbor_inputs","modules/clean/payments/validation","modules/clean/react/components/modal","dig-components/modal","dig-components/typography","spectrum/button/index","modules/clean/static_urls","modules/clean/react/tooltip","modules/clean/analytics","modules/clean/deprecated_ajax/ajax_as_promised_jquery","modules/clean/subscription/tools/amp_logger"],(function(e,t,a,n,i,s,l,o,r,d,c,u,p,m,g,_,f,h,y,b){"use strict";function v(e){return t=>null==t||t.length<=e}function M(e,t){return i.default.createElement(f.Tooltip,{position:f.TooltipPosition.RIGHT,tooltip_contents:t},e,i.default.createElement(l.Sprite,{group:"web",name:"info",className:"info-sprite",alt:""}))}Object.defineProperty(t,"__esModule",{value:!0}),t.EditInvoiceAddressModalLoader=void 0,i=a.__importDefault(i),u=a.__importStar(u);const S=r.intl.formatMessage({id:"F5ADP7",defaultMessage:"Country and postal code must match your account’s payment information."}),P=r.intl.formatMessage({id:"XjVAbc",defaultMessage:"Your tax rate on this invoice cannot be updated."}),E={addressName:r.intl.formatMessage({id:"B6dG2q",defaultMessage:"Billing name"}),address:r.intl.formatMessage({id:"fz9og9",defaultMessage:"Billing address"}),city:r.intl.formatMessage({id:"QnFif0",defaultMessage:"City"}),state:r.intl.formatMessage({id:"pyUCBn",defaultMessage:"State"}),zip:M(r.intl.formatMessage({id:"10Ms2o",defaultMessage:"Postal code"}),S),country:M(r.intl.formatMessage({id:"1SPrvR",defaultMessage:"Country"}),S),exclusionId:r.intl.formatMessage({id:"eZAuK1",defaultMessage:"VAT number (optional)"}),exclusionIdWithTooltip:M(r.intl.formatMessage({id:"eZAuK1",defaultMessage:"VAT number (optional)"}),P)};class C extends i.default.Component{constructor(e){super(e),this.disableds={addressName:!1,address:!1,city:!1,state:!1,zip:!0,country:!0,exclusionId:!1,exclusionIdWithTooltip:!1},this.addressNameLength=100,this.addressLength=250,this.cityLength=50,this.stateLength=50,this.vatLength=25,this.undefinedLength=void 0,this.validateHandlers={addressName:v(this.addressNameLength),address:v(this.addressLength),city:v(this.cityLength),state:v(this.stateLength),zip:()=>!0,country:()=>!0,exclusionId:()=>!0,exclusionIdWithTooltip:()=>!0},this.maxLengths={addressName:this.addressNameLength,address:this.addressLength,city:this.cityLength,state:this.stateLength,zip:this.undefinedLength,country:this.undefinedLength,exclusionId:this.vatLength,exclusionIdWithTooltip:this.vatLength},this.errorTexts={addressName:r.intl.formatMessage({id:"M9vy6c",defaultMessage:"Too long"}),address:r.intl.formatMessage({id:"M9vy6c",defaultMessage:"Too long"}),city:r.intl.formatMessage({id:"M9vy6c",defaultMessage:"Too long"}),state:r.intl.formatMessage({id:"M9vy6c",defaultMessage:"Too long"}),zip:"",country:"",exclusionId:"",exclusionIdWithTooltip:""},this.onSave=()=>{const{formState:e}=this.state,{invoice:t}=this.props;if(e)if(this.logActions("edit_billing_address_started"),this.setState({submitting:!0}),this.isInputValid()){const a={address_name:e.addressName,address:e.address,city:e.city,state:e.state,exclusion_id:e.exclusionId};t&&(a.invoice_id=o.URI.parse(t.link).getQuery().id.toString()),this.makeEditBillingAddressRequest(a)}else this.setState({submitting:!1,showErrors:!0})},this.onCancel=()=>{this.logActions("edit_billing_address_cancelled"),this.setState(e=>Object.assign(Object.assign({},e),{open:!1}))},this.state={submitting:!1,showErrors:!1,open:!0},e.isTeam?(this.editUrl="/edit_billing_address",this.viewModelUrl="/edit_billing_address_view_model",this.vatClass="grid__item--1-1",this.modalClass="edit-invoice-modal"):(this.editUrl="/edit_billing_address_individual",this.viewModelUrl="/edit_billing_address_individual_view_model",this.vatClass="grid__item--1-2",this.modalClass="edit-invoice-modal professional-modal")}static showInstance(e,a){const n=i.default.createElement(t.EditInvoiceAddressModalLoader,{invoice:e,isTeam:a});u.Modal.showInstance(n)}static showUpdateTaxProfileModal(e,a){const n=i.default.createElement(t.EditInvoiceAddressModalLoader,{isTeam:e,onUpdated:a});u.Modal.showInstance(n)}componentDidMount(){var e;let t=void 0;this.props.invoice&&(t=null===(e=o.URI.parse(this.props.invoice.link).getQuery().id)||void 0===e?void 0:e.toString(),this.disableds.exclusionIdWithTooltip=!0),this.makeRequest(t)}makeRequest(e){return a.__awaiter(this,void 0,void 0,(function*(){try{const t={invoice_id:e},a=yield y.WebRequest({url:this.viewModelUrl,data:t,dataType:"json"});c.hasVat(a.countryCode)&&(this.errorTexts.exclusionId=r.intl.formatMessage({id:"LW2miv",defaultMessage:"Please enter a valid VAT number, e.g. {examples}."},{examples:c.getVatExamples(a.countryCode).join(", ")}),this.validateHandlers.exclusionId=e=>!e||c.validateVat(a.countryCode,e)),this.setState({formState:a})}catch(e){this.setState(e=>Object.assign(Object.assign({},e),{open:!1}))}}))}render(){const{formState:e,showErrors:t,submitting:a}=this.state,{isTeam:n,invoice:s}=this.props;let l;if(e){let t=null;if(c.hasVat(e.countryCode)){const a=c.getVatPrefix(e.countryCode);t=s?this.renderInput("exclusionIdWithTooltip",this.vatClass):this.renderInput("exclusionId",this.vatClass,a)}l=n?i.default.createElement("div",{className:".type--arbor grid__container grid__container--p-large  grid--x-bookend"},this.renderInstructions(e.countryCode),this.renderInput("addressName","grid__item--1-1"),this.renderInput("address","grid__item--1-1"),this.renderInput("city","grid__item--1-2"),this.renderInput("state","grid__item--11-24"),this.renderInput("zip","grid__item--7-24"),this.renderInput("country","grid__item--2-3"),t):i.default.createElement("div",{className:".type--arbor grid__container grid__container--p-large  grid--x-bookend"},this.renderInput("addressName","grid__item--1-1"),this.renderInput("address","grid__item--1-2"),this.renderInput("city","grid__item--1-4"),this.renderInput("state","grid__item--1-4"),this.renderInput("zip","grid__item--1-2"),this.renderInput("country","grid__item--1-2"),t,this.renderInstructions(e.countryCode))}else l=i.default.createElement("div",{className:"loading-spinner"},i.default.createElement("img",{src:_.static_url("/static/images/icons/ajax-loading-small-vfl3Wt7C_.gif"),alt:r.intl.formatMessage({id:"jybGUg",defaultMessage:"Loading"})}));const o=i.default.createElement(p.Modal.Footer,{hasTopBorder:!n,className:"oq-modal__buttons"},i.default.createElement(g.Button,{className:"edit-invoice-modal__cancel-button",variant:"secondary",onClick:this.onCancel},r.intl.formatMessage({id:"d9/SE1",defaultMessage:"Cancel"})),i.default.createElement(g.Button,{disabled:!e||a||t&&!this.isInputValid(),variant:"primary",onClick:this.onSave},r.intl.formatMessage({id:"F5NZs5",defaultMessage:"Save changes"})));return i.default.createElement(p.Modal,{open:this.state.open,isCentered:!0,withCloseButton:r.intl.formatMessage({id:"bv7A4+",defaultMessage:"Close"}),onRequestClose:this.onCancel,overlayClassName:this.modalClass,shouldCloseOnOverlayClick:!1,onAfterClose:u.Modal.close},i.default.createElement(p.Modal.Header,{hasBottomSpacing:"title-standard"},i.default.createElement(m.Title,{color:"faint",isBold:!1,size:"small"},r.intl.formatMessage({id:"/WFCIJ",defaultMessage:"Edit invoice details"}))),i.default.createElement(p.Modal.Body,null,i.default.createElement("div",{className:"dynamic-content"},l)),o)}logActions(e){this.props.isTeam?h.TeamsWebActionsLogger.log(e):h.UserActivityLogger.log("web",e)}makeEditBillingAddressRequest(e){return a.__awaiter(this,void 0,void 0,(function*(){const{onUpdated:t,isTeam:a}=this.props,i=b.getSubscriptionAMPLogger({ns:a?"team":"personal",modal:b.ModalTypes.EDIT_INVOICE_MODAL});try{const a=this.editUrl;yield y.WebRequest({url:a,data:e}),this.logActions("edit_billing_address_success"),n.Notify.success(r.intl.formatMessage({id:"Il5prr",defaultMessage:"Invoice details updated."})),i.logModalSuccess()}catch(e){this.logActions("edit_billing_address_edit_failure"),i.logModalError("modal_submit")}finally{t&&t(),this.setState(e=>Object.assign(Object.assign({},e),{open:!1}))}}))}renderInstructions(e){const{invoice:t}=this.props;let a;if(a=t?r.intl.formatMessage({id:"Wc4dM+",defaultMessage:"You are editing details for the {date} invoice."},{date:t.date}):r.intl.formatMessage({id:"MhniSh",defaultMessage:"You are editing details for all future invoices. To edit past invoices, click “Edit” on the invoice item instead."}),c.hasVat(e)){let e=r.intl.formatMessage({id:"Qyx8hc",defaultMessage:"Please note that changing your VAT number could impact your applicable tax rate."});t&&(e=r.intl.formatMessage({id:"q3KPUy",defaultMessage:"To add or change a VAT number or request a tax refund, contact support."})),a=a.concat(" ",e)}return i.default.createElement(m.Text,{variant:"paragraph",size:"small",color:"faint",className:"grid__item--1-1 instructions"},a)}renderInput(e,t,a){const{formState:n,showErrors:s}=this.state;let l="";return n&&(l=n[e]),i.default.createElement(d.ArborTextInput,{name:e,id:e,containerClassName:t,isValid:s?!!this.validateHandlers[e](l)&&"":"",labelText:E[e],errorText:this.errorTexts[e],value:l,onChange:this.onChangeFactory(e),disabled:this.disableds[e],placeholderText:a,maxLength:this.maxLengths[e]})}onChangeFactory(e){return(t,a,n)=>{const{formState:i}=this.state;i&&this.setState(t=>(i[e]=n,t))}}isInputValid(){const{formState:e}=this.state;return!!e&&(this.validateHandlers.addressName(e.addressName)&&this.validateHandlers.address(e.address)&&this.validateHandlers.city(e.city)&&this.validateHandlers.state(e.state)&&this.validateHandlers.exclusionId(e.exclusionId))}}C.displayName="EditInvoiceAddressModal",t.EditInvoiceAddressModalLoader=s.requireCssWithComponent(C,["/static/css/payments/edit_invoice_address_modal/edit_invoice_address_modal-vflTqEhcT.css"])})),define("modules/clean/react/payments/downgrade/components/downgrade_family_manager_data",["require","exports","tslib","react","spectrum/checkbox/index","modules/core/i18n","modules/clean/react/components/css","modules/clean/display_format","modules/constants/trademark","modules/clean/react/payments/downgrade/components/downgrade_helpers","dig-components/icons","dig-components/icons/src","modules/clean/dropbox_form","family/common/features"],(function(e,t,a,n,i,s,l,o,r,d,c,u,p,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DowngradeFamilyManagerData=t.DowngradeFamilyManagerHeader=t.DowngradeFamilyManagerFooter=t.DowngradeFamilyFeatureItem=t.DowngradeFamilyManagerDataView=void 0,n=a.__importDefault(n);class g extends n.default.Component{constructor(){super(...arguments),this.state={disbandFamilyAcknowledged:!1,overQuotaAcknowledged:!1,familySharedFolderAcknowledged:!1},this.handleDisbandFamilyAcknowledgment=e=>{this.setState({disbandFamilyAcknowledged:!this.state.disbandFamilyAcknowledged})},this.handleOverQuotaAcknowledgment=e=>{this.setState({overQuotaAcknowledged:!this.state.overQuotaAcknowledged})},this.handleFamilySharedFolderAcknowledgement=e=>{this.setState({familySharedFolderAcknowledged:!this.state.familySharedFolderAcknowledged})},this.hasFamilySharedFolder=()=>{var e;return!!(null===(e=this.props.familyFeatureFlags)||void 0===e?void 0:e[m.FAMILY_FEATURE_FLAGS.HAS_FAMILY_SHARED_FOLDER])},this.renderFamilyAcknowledgements=()=>{const{freeQuota:e}=this.props,t=this.hasFamilySharedFolder(),{overQuotaAcknowledged:a,disbandFamilyAcknowledged:l,familySharedFolderAcknowledged:d}=this.state;return n.default.createElement("div",null,n.default.createElement("div",{className:"family-payer-disband-downgrade"},n.default.createElement(i.Checkbox,{className:"family-payer-disband-downgrade-check disband-acknowledgement",checked:l?"checked":"unchecked",onChange:this.handleDisbandFamilyAcknowledgment}),n.default.createElement("p",null,s.intl.formatMessage({id:"gMMxaZ",defaultMessage:"You and every member of your {trademark_family} plan will be downgraded to {dropbox_basic}, which only allows up to {free_quota} of storage."},{trademark_family:r.TRADEMARK_FAMILY,dropbox_basic:r.DROPBOX_BASIC,free_quota:o.format_bytes(e,0)}))),n.default.createElement("div",{className:"family-payer-disband-downgrade"},n.default.createElement(i.Checkbox,{className:"family-payer-disband-downgrade-check over-quota-acknowledgement",checked:a?"checked":"unchecked",onChange:this.handleOverQuotaAcknowledgment}),n.default.createElement("p",null,s.intl.formatMessage({id:"Uu4dKU",defaultMessage:"If you or a member of your plan are using more than {free_quota} of storage, you’ll be over-quota. That means your files will stop syncing, you won’t be able to upload any new files or folders, and you won’t be able to restore earlier versions of your files."},{free_quota:o.format_bytes(e,0)}))),t&&n.default.createElement("div",{className:"family-payer-disband-downgrade"},n.default.createElement(i.Checkbox,{checked:d?"checked":"unchecked",className:"family-payer-disband-downgrade-check","data-testid":"family-shared-folder-acknowledgement",onChange:this.handleFamilySharedFolderAcknowledgement}),n.default.createElement("p",null,s.intl.formatMessage({id:"jaE2Yv",defaultMessage:"Your Family Room folder will dissolve. All members will receive a copy of the folder in their Dropbox."}))))}}shouldDisableConfirmDowngradeButton(){return!this.state.overQuotaAcknowledged||!this.state.disbandFamilyAcknowledged||!(!this.hasFamilySharedFolder()||this.state.familySharedFolderAcknowledged)}render(){const e=d.createFamilyFeatureList(this.props.currentPlanSpace,this.props.basicDeviceLimit);return n.default.createElement("div",null,n.default.createElement(t.DowngradeFamilyManagerHeader,{handleChangeMindCTA:this.props.handleChangeMindCTA}),n.default.createElement("div",{className:"section section--features family-payer-benefits-section"},n.default.createElement("h3",{className:"type--title-4"},s.intl.formatMessage({id:"R07Z49",defaultMessage:"Without {dropbox_family}, you’ll lose access to the following:"},{dropbox_family:r.DROPBOX_FAMILY})),n.default.createElement("ul",{className:"features-list family-payer-features-list"},e.map((e,a)=>n.default.createElement(t.DowngradeFamilyFeatureItem,{key:a,featureInfo:e}))),n.default.createElement("div",null,n.default.createElement("p",null,s.intl.formatMessage({id:"I5xM/O",defaultMessage:"If you still want to cancel, please acknowledge the following:"})),this.renderFamilyAcknowledgements())),n.default.createElement(t.DowngradeFamilyManagerFooter,{shouldDisableConfirmDowngradeButton:this.shouldDisableConfirmDowngradeButton(),handleContactSupportCTA:this.props.handleContactSupportCTA,handleChangeMindCTA:this.props.handleChangeMindCTA}))}}t.DowngradeFamilyManagerDataView=g,g.displayName="DowngradeFamilyManagerData",t.DowngradeFamilyFeatureItem=e=>{const{header:t,description:a}=e.featureInfo;return n.default.createElement("li",{className:"features-list__item family-payer-features-list-item"},n.default.createElement(c.UIIcon,{src:u.CloseLine}),n.default.createElement("div",{className:"family-payer-downgrade-feature-description"},t,n.default.createElement("div",{className:"features-list__copy"},a)))},t.DowngradeFamilyFeatureItem.displayName="DowngradeFamilyFeatureItem",t.DowngradeFamilyManagerFooter=e=>{const{handleContactSupportCTA:t,handleChangeMindCTA:a,shouldDisableConfirmDowngradeButton:i}=e,l=[d.downgradePageButtonsMap[d.DowngradeButtonTypes.ContactSupport],d.downgradePageButtonsMap[d.DowngradeButtonTypes.StayWithFamily]];return n.default.createElement("section",{className:"section section--buttons family-payer-section-buttons"},n.default.createElement("div",{className:"section-content"},n.default.createElement("div",{className:"buttons"},l.map(e=>{return n.default.createElement("div",{key:e.type,className:"buttons__item"},n.default.createElement("h3",{className:"type--copy-large"},e.header),n.default.createElement(d.DowngradePageButton,{isPrimaryButton:!0,buttonInfo:e,onClickCTA:(i=e.type,i===d.DowngradeButtonTypes.StayWithFamily?a:t)}));var i}),n.default.createElement("div",{className:"buttons__item downgrade-button"},n.default.createElement("h3",{className:"type--copy-large"},s.intl.formatMessage({id:"FkaCY0",defaultMessage:"I’m sure"})),n.default.createElement(p.DropboxForm,{action:"/downgrade/process",method:"post"},n.default.createElement(d.DowngradeConfirmationButton,{shouldDisableButton:i}))))))},t.DowngradeFamilyManagerFooter.displayName="DowngradeFamilyManagerFooter",t.DowngradeFamilyManagerHeader=e=>n.default.createElement("header",{className:"section section--hero family-payer-header-section"},n.default.createElement("div",{className:"section-content"},n.default.createElement("h1",{className:"type--title-2 type--first type--center"},s.intl.formatMessage({id:"TejRDA",defaultMessage:"Are you sure you want to cancel {dropbox_family}?"},{dropbox_family:r.DROPBOX_FAMILY})),n.default.createElement("h2",{className:"type--copy-standard"},s.intl.formatMessage({id:"Gj7aSc",defaultMessage:"You and your family members will lose access to the plan’s storage and features, <span>and your accounts will be downgraded to {dropbox_basic}.</span>"},{dropbox_basic:r.DROPBOX_BASIC,span:e=>n.default.createElement("span",{className:"quota-drop"},e)})),n.default.createElement(d.DowngradePageButton,{isPrimaryButton:!0,buttonInfo:d.downgradePageButtonsMap[d.DowngradeButtonTypes.ChangedMind],onClickCTA:e.handleChangeMindCTA}))),t.DowngradeFamilyManagerHeader.displayName="DowngradeFamilyManagerHeader",t.DowngradeFamilyManagerData=l.requireCssWithComponent(g,["/static/css/pro/pages/downgrade-vfle_vhUD.css"])})),define("modules/clean/react/payments/update_individual_billing/update_individual_billing_modal_loader",["require","exports","tslib","classnames","react","spectrum/button/index","modules/core/notify","modules/core/i18n","modules/clean/analytics","modules/clean/deprecated_ajax/ajax_jquery","modules/clean/react/components/css","modules/clean/react/components/modal","dig-components/modal","dig-components/typography","modules/clean/static_urls","modules/clean/react/payments/unified_module/unified_payment_form_async","modules/clean/subscription/tools/amp_logger","modules/core/uri","modules/core/browser","dig-components/snackbar","dig-components/buttons","dig-components/icons","dig-components/icons/src"],(function(e,t,a,n,i,s,l,o,r,d,c,u,p,m,g,_,f,h,y,b,v,M,S){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IndividualUpdateBillingModalLoader=void 0,n=a.__importDefault(n),i=a.__importDefault(i),d=a.__importStar(d),u=a.__importStar(u),y=a.__importStar(y);class P extends i.default.Component{constructor(){super(...arguments),this.state={submitting:!1,open:!0,showRedirectForAutoConvertSnackbar:!1},this.onAccept=()=>{var e,t;this.unifiedPaymentFormAsync&&this.unifiedPaymentFormAsync.onAccept(),r.UserActivityLogger.log("web","update_billing_modal_started",{isNptBillingModal:null===(e=this.state.loadedProps)||void 0===e?void 0:e.showNptBillingModal,project:null===(t=this.state.loadedProps)||void 0===t?void 0:t.trialProjectType})},this.onDismiss=()=>{var e,t;r.UserActivityLogger.log("web","update_billing_modal_cancelled",{isNptBillingModal:null===(e=this.state.loadedProps)||void 0===e?void 0:e.showNptBillingModal,project:null===(t=this.state.loadedProps)||void 0===t?void 0:t.trialProjectType}),this.setState(e=>Object.assign(Object.assign({},e),{open:!1}))},this.saveUnifiedPaymentFormAsync=e=>{this.unifiedPaymentFormAsync=e},this.setSubmittingStatus=e=>{this.setState(t=>Object.assign(Object.assign({},t),{submitting:e}))},this.onSuccess=()=>{this.setState(e=>Object.assign(Object.assign({},e),{open:!1})),this.modalLogger.logModalSuccess()},this.onError=()=>{this.modalLogger.logModalError("modal_submit")},this.closeRedirectForAutoConvertSnackbar=()=>{this.setState({showRedirectForAutoConvertSnackbar:!1})}}static showInstance(){u.Modal.showInstance(i.default.createElement(t.IndividualUpdateBillingModalLoader,null))}componentDidMount(){this.modalLogger=f.getSubscriptionAMPLogger({ns:"personal",modal:f.ModalTypes.UPDATE_BILLING_MODAL});const e=Date.now();d.WebRequest({url:"/account/unified_payment_view",success:t=>{var a,n;const i=JSON.parse(t),s="auto_convert"===h.URI.parse(y.get_href()).getQuery().reason;this.setState(e=>Object.assign(Object.assign({},e),{loadedProps:{viewModel:i,showNptBillingModal:i.paymentExperiments.showNptBillingModal,trialProjectType:i.paymentExperiments.trialProjectType},showRedirectForAutoConvertSnackbar:s})),r.UserActivityLogger.log("web","update_billing_modal_success",{isNptBillingModal:null===(a=this.state.loadedProps)||void 0===a?void 0:a.showNptBillingModal,project:null===(n=this.state.loadedProps)||void 0===n?void 0:n.trialProjectType});const l=Date.now()-e;this.modalLogger.logModalTTI(l)},error:e=>{l.Notify.error(o.intl.formatMessage({id:"EZm8Rx",defaultMessage:"Failed to load modal."})),r.UserActivityLogger.log("web","update_billing_modal_failure",{request_id:e.getResponseHeader("x-dropbox-request-id"),status:e.status}),this.modalLogger.logModalError("modal_init"),this.setState(e=>Object.assign(Object.assign({},e),{open:!1}))}})}get modalTitle(){var e;let t=o.intl.formatMessage({id:"OyZpYC",defaultMessage:"Update billing information"});return(null===(e=this.state.loadedProps)||void 0===e?void 0:e.showNptBillingModal)&&(t=o.intl.formatMessage({id:"yacDmF",defaultMessage:"Step 1/2: add your billing info"})),t}get primaryButtonText(){var e;let t=o.intl.formatMessage({id:"vBFpIq",defaultMessage:"Save changes"});return(null===(e=this.state.loadedProps)||void 0===e?void 0:e.showNptBillingModal)&&(t=o.intl.formatMessage({id:"1ZUfS7",defaultMessage:"Next"})),t}renderButtons(){const{loadedProps:e,submitting:t}=this.state;return i.default.createElement(p.Modal.Footer,{hasTopBorder:!0,className:"db-modal-buttons"},i.default.createElement(s.Button,{className:"cancel-button",variant:"secondary",onClick:this.onDismiss},o.intl.formatMessage({id:"whhn4M",defaultMessage:"Cancel"})),i.default.createElement(s.Button,{className:"js-save-button",disabled:!e||t,variant:"primary",onClick:this.onAccept},this.primaryButtonText))}renderContent(){const{loadedProps:e}=this.state;return e?i.default.createElement(_.UnifiedPaymentFormAsync,{isSubmittingStatus:this.setSubmittingStatus,onSuccess:this.onSuccess,ref:this.saveUnifiedPaymentFormAsync,isTeam:!1,preloadedViewModel:e.viewModel,onError:this.onError}):i.default.createElement("div",{className:"loading-spinner"},i.default.createElement("img",{src:g.static_url("/static/images/icons/ajax-loading-small-vfl3Wt7C_.gif"),alt:o.intl.formatMessage({id:"oXILe3",defaultMessage:"Loading"})}))}renderRedirectForAutoConvertSnackbar(){return i.default.createElement(b.Snackbar,{open:this.state.showRedirectForAutoConvertSnackbar,timeout:6e3,onRequestClose:this.closeRedirectForAutoConvertSnackbar},i.default.createElement(M.UIIcon,{src:S.WarningLine}),i.default.createElement(b.Snackbar.Message,null,o.intl.formatMessage({id:"SGQt9u",defaultMessage:"Manage your trial billing details on your account page."})),i.default.createElement(b.Snackbar.Actions,null,i.default.createElement(v.Button,{variant:"transparent",inverse:!0,onClick:this.closeRedirectForAutoConvertSnackbar},o.intl.formatMessage({id:"Bs0dLM",defaultMessage:"Got it"}))))}render(){const e=n.default("update-billing-modal");return i.default.createElement(p.Modal,{open:this.state.open,isCentered:!0,withCloseButton:o.intl.formatMessage({id:"Pxv2Bf",defaultMessage:"Close"}),overlayClassName:e,onRequestClose:this.onDismiss,shouldCloseOnOverlayClick:!1,onAfterClose:u.Modal.close,modalBaseIndex:1050},i.default.createElement(p.Modal.Header,{hasBottomSpacing:"title-standard"},i.default.createElement(m.Title,{isBold:!1,size:"small"},this.modalTitle)),i.default.createElement(p.Modal.Body,{hasVerticalSpacing:!0},this.renderContent()),this.renderButtons(),this.renderRedirectForAutoConvertSnackbar())}}P.displayName="UpdateBillingModalLoaderView",t.IndividualUpdateBillingModalLoader=c.requireCssWithComponent(P,["/static/css/pro/components/update_billing_modal_individual-vfljJUHvA.css"])})),define("modules/clean/react/payments/update_individual_billing/update_individual_store_creator",["require","exports","tslib","redux","redux-thunk","modules/clean/redux/unsupported","modules/clean/analytics","modules/clean/dbmodal_stack","modules/clean/react/components/modal","modules/clean/react/payments/common/middleware/payments_ux_logger","modules/clean/react/payments/common/form/middleware/middleware","modules/clean/react/payments/common/payments/state/store_creator","modules/clean/react/payments/common/form_value_factory","modules/clean/react/snackbar","modules/clean/top_notif","modules/core/i18n","modules/core/notify"],(function(e,t,a,n,i,s,l,o,r,d,c,u,p,m,g,_,f){"use strict";function h(e){return e=>a=>{if("SubmitFormSuccess"!==a.type)return e(a);const n=e(a),i=void 0!==a.additionalData&&a.additionalData.showRebillUpsell;return l.ProEventsLogger.log("update_billing_open_save_changes_success"),g.TopNotificationBar.hideById("rebill-bar"),i?(f.Notify.clear(),m.Snackbar.complete(_.intl.formatMessage({id:"jMyZGp",defaultMessage:"Payment method successfully updated."})),o.DBModalStack.trigger(t.BILLING_INFO_UPDATED,{showChangePlanConfirm:!0})):(f.Notify.success(_.intl.formatMessage({id:"p28rXC",defaultMessage:"We’ve successfully updated your account’s billing information."})),r.Modal.close(),o.DBModalStack.trigger(t.BILLING_INFO_UPDATED,null)),n}}function y(e,t,a){const{vat:n,cpf:i,countryCode:s,userInfo:l}=e,{city:o,address:r,phone:d,name:c,paymentMethod:m,countryCode:g,zipCode:_,vat:f,cpf:h,nonce:y,payPalNonce:b,adyenEncryptedCard:v,encryptedCardForNetworkToken:M,applePayToken:S,bin:P,browserInfo:E,threeDsData:C,accountHolderName:A,iban:T,mandateSigned:I,termsAndService:w,idealBankId:D,idealBankName:N}=u.createPaymentFormData(e,t,a);return{city:o,address:r,phone:d,name:c,paymentMethod:m,countryCode:g,zipCode:_,vat:n?p.FormValueFactory.createVat(n,s):f,cpf:i?p.FormValueFactory.createCpf(i):h,cpfName:p.FormValueFactory.createCpfNamePrefill("","",l.displayName),nonce:y,payPalNonce:b,adyenEncryptedCard:v,encryptedCardForNetworkToken:M,applePayToken:S,bin:P,browserInfo:E,threeDsData:C,accountHolderName:A,iban:T,mandateSigned:I,termsAndService:w,idealBankId:D,idealBankName:N}}Object.defineProperty(t,"__esModule",{value:!0}),t.createFormData=t.createBillingStore=t.submitFormSuccessMiddleware=t.BILLING_INFO_UPDATED=void 0,n=a.__importStar(n),i=a.__importDefault(i),t.BILLING_INFO_UPDATED="billing_info_modal:updated",t.submitFormSuccessMiddleware=h,t.createBillingStore=function(e,t){const a=(function(e){const t=(function(e){const{paymentFormSpec:t}=u.createPaymentPageState(e);return{countryToCurrencyMap:e.countryToCurrencyMap,submitSuccess:!1,submitState:null,submitting:!1,submitSeq:0,paypalEmail:"",requestId:e.requestId,paymentFormSpec:t}})(e),a=(function(e){const{countryCode:t,countryCodeLoading:a,hasCurrencyChanged:n,hasTaxChangedWithinCountry:i,loadingPrices:s,requestToken:l,recentLoadEvent:o}=u.createPaymentPricingState(e);return{countryCode:t,countryCodeLoading:a,hasCurrencyChanged:n,hasTaxChangedWithinCountry:i,loadingPrices:s,requestToken:l,recentLoadEvent:o}})(e);return{pricingState:a,pageState:t,formData:y(e,t,a)}})(e);let l=n.applyMiddleware(i.default,c.submitFormErrorMiddleware,h,new d.PaymentsUXLogger(e.requestId).reduxMiddleware);return s.createStore(t,a,l)},t.createFormData=y})),define("modules/clean/subscription/tools/amp_logger",["require","exports","apex-metrics/index","modules/clean/metrics/index"],(function(e,t,a,n){"use strict";var i,s;Object.defineProperty(t,"__esModule",{value:!0}),t.findInitLoggingErrorSeverity=t.logTabError=t.getSubscriptionAMPLogger=t.SubscriptionAMPLogger=t.ModalTypes=void 0,(function(e){e.PERSONAL="personal_plan_management",e.TEAM="team_plan_management"})(i||(i={})),(function(e){e.SUCCESS="modal_success",e.ERROR="modal_error",e.TTI="modal_tti"})(s||(s={})),(function(e){e.CHANGE_LICENSES_MODAL="change_licenses_modal",e.CHANGE_PLAN_MODAL="change_plan_modal",e.CHANGE_PLAN_DUAL_MODAL="change_plan_dual_modal",e.CHANGE_SCHEDULE_MODAL="change_schedule_modal",e.CANCEL_CHANGES_MODAL="cancel_changes_modal",e.CANCEL_SURVEY_MODAL="cancel_survey_modal",e.CANCEL_SUBS_WARNING_MODAL="cancel_subs_warning_modal",e.UPDATE_BILLING_MODAL="update_billing_modal",e.EDIT_INVOICE_MODAL="edit_invoice_modal",e.BLOCKING_CHANGES_MODAL="blocking_changes_modal"})(t.ModalTypes||(t.ModalTypes={}));class l{constructor(e){this.namespace="team"===e.ns?i.TEAM:i.PERSONAL,this.modal=e.modal,this.productPlanType=e.productPlanType||"unknown"}logModalTTI(e){n.getMetricsReporter().createStats({ns:this.namespace,name:s.TTI},{modal:this.modal,productType:this.productPlanType}).recordDuration(e,a.TimeUnit.MILLISECONDS)}logModalSuccess(){this.logModalEvent(s.SUCCESS)}logModalError(e,t){this.logModalEvent(s.ERROR,{errorType:e,errorSeverity:t})}setProductPlanType(e){e&&(this.productPlanType=e)}logModalEvent(e,t={}){const a={modal:this.modal,productType:this.productPlanType};t.errorType&&(a.errorType=t.errorType,a.errorSeverity=t.errorSeverity||"critical"),n.getMetricsReporter().createStats({ns:this.namespace,name:e},a).record(1)}}t.SubscriptionAMPLogger=l,t.getSubscriptionAMPLogger=function(e){return new l(e)},t.logTabError=function(e,t,a="unknown"){const s={tab:e,productType:a,errorType:t};n.getMetricsReporter().createStats({ns:i.PERSONAL,name:"account_tab_error"},s).record(1)},t.findInitLoggingErrorSeverity=function(e){return e&&e.responseText&&e.responseText.indexOf("err:")>-1?"noncritical":e&&e.status&&"success"===(e=e).status?"noncritical":"critical"}})),define("modules/clean/teams/admin/lib/billing_history",["require","exports","modules/clean/teams/admin/types/billing_history"],(function(e,t,a){"use strict";function n(e){const t=e.description;return!!t&&(-1!==t.indexOf("Google")||-1!==t.indexOf("Apple")&&-1===t.indexOf("ApplePay"))}Object.defineProperty(t,"__esModule",{value:!0}),t.getHistoryData=t.SelectedYearTypes=void 0,t.SelectedYearTypes={ALL_TIME:"all-time",YEAR_TO_DATE:"year-to-date"},t.getHistoryData=function(e,i=t.SelectedYearTypes.ALL_TIME){let s=(function(e){const t=[];for(let s=0;s<e.length;s++){const l=e[s];if(s<e.length-1){const i=e[s+1],o=n(i)||n(l);if(l.type===a.BillingRowType.Payment&&i.type===a.BillingRowType.Invoice&&(i.billed===l.paid||i.billed==="("+l.paid+")"||o)&&i.date===l.date){const e={id:s,invoice:i,payment:l,isMobile:o};t.push(e),s++;continue}}l.type===a.BillingRowType.Payment?t.push({id:s,payment:l,isMobile:n(l)}):t.push({id:s,invoice:l,isMobile:(i=l,!!i.billed&&i.billed.indexOf("GPD")>-1)})}var i;return t})(e);const l=(new Date).getFullYear().toString();return i===t.SelectedYearTypes.ALL_TIME||(s=i===t.SelectedYearTypes.YEAR_TO_DATE?s.filter(e=>e.payment?-1!==e.payment.date.indexOf(l):!!e.invoice&&-1!==e.invoice.date.indexOf(l)):s.filter(e=>e.payment?-1!==e.payment.date.indexOf(i):!!e.invoice&&-1!==e.invoice.date.indexOf(i))),s=s.filter(e=>e.invoice&&null!==e.invoice.description||e.payment&&null!==e.payment.description),s}})),define("modules/clean/teams/admin/types/billing_history",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BillingRowType=void 0,(function(e){e[e.Invoice=0]="Invoice",e[e.Payment=1]="Payment",e[e.Legacy=2]="Legacy"})(t.BillingRowType||(t.BillingRowType={}))})),define("modules/clean/teams/admin/widgets/admin_priced_list/admin_priced_list",["require","exports","tslib","react","modules/clean/react/components/css"],(function(e,t,a,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AdminPricedList=void 0,n=a.__importDefault(n);class s extends n.default.Component{render(){return n.default.createElement("div",{className:"admin-priced-list"},n.default.createElement("div",null,this.props.children))}}s.displayName="AdminPricedListView",t.AdminPricedList=i.requireCssWithComponent(s,["/static/css/teams/admin/widgets/admin_priced_list/admin_priced_list-vfl4n4jXj.css"])})),define("modules/clean/teams/admin/widgets/admin_priced_list/admin_priced_list_item",["require","exports","tslib","react","classnames","modules/core/i18n","modules/clean/react/badge","modules/clean/account_page/widgets/plan/views/loading_view"],(function(e,t,a,n,i,s,l,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AdminPricedListItem=void 0,n=a.__importDefault(n),i=a.__importDefault(i);class r extends n.default.Component{constructor(){super(...arguments),this.onChange=()=>{}}renderTitleWarningText(){const{titleWarningText:e}=this.props;if(e)return n.default.createElement("span",{className:"admin-priced-list-item__content_title_warning"}," ",e)}renderTitleSecondaryText(){const{titleSecondaryText:e}=this.props;if(e)return n.default.createElement("span",{className:"admin-priced-list-item__content_title_secondary"}," ",e)}renderRecommendedSign(){const{titleSecondaryText:e,titleWarningText:t,recommended:a}=this.props;if(!e&&!t&&a)return n.default.createElement("div",{className:"admin-priced-list-item__content_title_recommended"},s.intl.formatMessage({id:"430h7a",defaultMessage:"RECOMMENDED"}))}renderEffectiveDate(){const{price:e,priceString:t,effectiveDate:a}=this.props;if(!e&&!t)return n.default.createElement("div",{className:"admin-priced-list-item__content_title_effective_date"},a)}getClickHandler(){if(!this.props.disableItem)return this.props.onClick}render(){const{description:e,price:t,title:a,unit:s,detailsLink:r,disableItem:d,effectiveDate:c,loadingPrice:u}=this.props,p=this.props.className?this.props.className:"";let m,g;u||(this.props.priceString?(m=this.props.priceString,g=s):t?(m=t.toString(),g=s):(m=c?"":"-",g=""));const _=i.default({"admin-priced-list-item":!0,active:!0===this.props.isSelected,[p]:!0,disabled:d});return n.default.createElement("div",{className:_,onClick:this.getClickHandler()},n.default.createElement("div",{className:"admin-priced-list-item__content"},n.default.createElement("div",{className:"admin-priced-list-item__content_title"},n.default.createElement("input",{type:"radio",checked:this.props.isSelected,onChange:this.onChange,disabled:this.props.disableItem}),n.default.createElement("h1",{className:"admin-priced-list-item__content_title_text"},a,this.props.badge&&n.default.createElement(l.Badge,Object.assign({},this.props.badge)),this.renderTitleWarningText(),this.renderTitleSecondaryText()),this.renderRecommendedSign(),this.renderEffectiveDate()),n.default.createElement("div",{className:"admin-priced-list-item__content_description u-font-meta"},e,r)),u?n.default.createElement(o.LoadingView,null):m&&n.default.createElement("div",{className:"admin-priced-list-item__pricing"},n.default.createElement("div",{className:"admin-priced-list-item__pricing_price"},m),n.default.createElement("div",{className:"admin-priced-list-item__pricing_unit"},g)))}}t.AdminPricedListItem=r,r.displayName="AdminPricedListItem"})),define("modules/clean/teams/admin/widgets/billing_history/billing_history_row",["require","exports","tslib","react","modules/core/i18n","modules/clean/react/payments/edit_invoice_address_modal/edit_invoice_address_modal_loader","modules/clean/analytics","modules/clean/react/tooltip","modules/clean/react/sprite","dig-components/buttons"],(function(e,t,a,n,i,s,l,o,r,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BillingHistoryTableRow=void 0,n=a.__importDefault(n);class c extends n.default.Component{constructor(){super(...arguments),this.onEdit=()=>{const{row:e,isTeam:t}=this.props;e.invoice&&s.EditInvoiceAddressModalLoader.showInstance(e.invoice,t)},this.logReceiptLinkClick=()=>{this.props.logAccountBillingTabEvents&&l.ProEventsLogger.log("de_billing_tab_receipt_link_click")},this.logInvoiceLinkClick=()=>{this.props.logAccountBillingTabEvents&&l.ProEventsLogger.log("de_billing_tab_invoice_link_click")}}renderDate(){const{invoice:e,payment:t}=this.props.row;return e&&e.date?e.date:t&&t.date?t.date:null}renderDescription(){const{invoice:e,payment:t,isMobile:a}=this.props.row;let s=null,l=null;return e&&e.description?s=e.description:t&&t.description&&(s=t.description),a&&e&&e.description&&t&&t.description&&(s=`${t.description} | ${e.description}`),(e&&e.isVoided||t&&t.isVoided)&&(l=n.default.createElement("span",null," (",i.intl.formatMessage({id:"Raqf73",defaultMessage:"Voided"}),")")),n.default.createElement("div",null,n.default.createElement("p",{className:"description-line"},n.default.createElement("span",null,s),l))}renderLinks(){let e=[];if(!0===this.props.renderPublicLinks)e=this.renderInvoiceAndReceiptLink(this.props.publicInvoiceLink,this.props.publicReceiptLink);else{const{row:t,showEditInvoiceModal:a,canEditBilling:s}=this.props,{invoice:l,payment:o}=t;let r="",c="";l&&l.link&&(r=l.link),!t.isMobile&&o&&o.link&&(c=o.link),e=this.renderInvoiceAndReceiptLink(r,c),a&&l&&!l.isOpen&&l.isEditable&&s&&e.push(n.default.createElement(d.Button,{variant:"transparent",key:"edit-link",className:"button-as-link",onClick:this.onEdit},i.intl.formatMessage({id:"UwFkjc",defaultMessage:"Edit"}))),e.length||(l&&l.infoTooltip?e.push(this.renderInfoTooltip(l)):o&&o.infoTooltip&&e.push(this.renderInfoTooltip(o)))}return e.length?n.default.createElement("span",null,e):null}renderInvoiceAndReceiptLink(e,t){const a=[];return e&&a.push(n.default.createElement("a",{key:"invoice-link",className:"account-page__link",href:e,target:"_blank",rel:"noopener noreferrer",onClick:this.logInvoiceLinkClick},i.intl.formatMessage({id:"+fOIGM",defaultMessage:"Invoice"}))),t&&a.push(n.default.createElement("a",{key:"payment-link",className:"account-page__link",href:t,target:"_blank",rel:"noopener noreferrer",onClick:this.logReceiptLinkClick},i.intl.formatMessage({id:"9s47b8",defaultMessage:"Receipt"}))),a}renderInfoTooltip(e){return n.default.createElement(o.Tooltip,{position:o.TooltipPosition.TOP,tooltip_contents:e.infoTooltip},n.default.createElement(r.Sprite,{group:"teams",name:"info_active",alt:"",className:"info-sprite"}))}renderPrice(){const{invoice:e,payment:t,isMobile:a}=this.props.row;if(a)return null;let i=null;return e&&t?i=e.isVoided||t.isVoided?n.default.createElement("span",{className:"row-content__price--line-through"},e.billed):e.billed:t?i=t.paid:e&&(i=e.billed),i}render(){const{row:e}=this.props;return e.invoice||e.payment?n.default.createElement("tr",{className:"row-content","data-variant":!0},n.default.createElement("td",{className:"row-content__date"},this.renderDate()),n.default.createElement("td",{className:"row-content__description"},this.renderDescription()),n.default.createElement("td",{className:"row-content__links"},this.renderLinks()),n.default.createElement("td",{className:"row-content__price"},this.renderPrice())):null}}c.defaultProps={canEditBilling:!0},c.displayName="BillingHistoryTableRowComponent",t.BillingHistoryTableRow=c})),define("modules/clean/teams/admin/widgets/billing_history/billing_history_table",["require","exports","tslib","react","styled-components","modules/core/i18n","modules/clean/teams/admin/widgets/billing_history/billing_history_row","modules/clean/account_page/widgets/billing/billing_history/types","dig-components/menu","dig-components/buttons"],(function(e,t,a,n,i,s,l,o,r,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BillingHistoryTable=void 0,n=a.__importDefault(n);const c=(i=a.__importDefault(i)).default.div`
  .billing-table-container {
    border-radius: 0;
    border: 1px solid var(--color__faint__border);
    .billing-history-table {
      width: 100%;
      border-collapse: collapse;

      .row-header {
        background-color: var(--color__faint__background);
        padding: var(--spacing__unit--2) 0;
        color: var(--color__faint__text);
        font-size: var(--type__body__standard--fontsize);
        height: auto;
        font-weight: normal;
      }

      .caret {
        vertical-align: middle;
      }

      .date-header-cell {
        font-weight: normal;
        text-align: left;
        color: var(--color__faint__text);
      }

      .date-row {
        padding-left: var(--spacing__unit--2);
        padding-right: var(--spacing__unit--3);
        width: 80px;
        font-weight: normal;
        text-align: left;
        font-size: var(--type__body__small--fontsize);
        color: var(--color__faint__text);
      }

      .desc-row {
        font-weight: normal;
        text-align: left;
        font-size: var(--type__body__small--fontsize);
        color: var(--color__faint__text);
      }

      .price-row {
        padding-left: var(--spacing__unit--3);
        padding-right: var(--spacing__unit--2);
        width: 100px;
        font-weight: normal;
        text-align: left;
        font-size: var(--type__body__small--fontsize);
        color: var(--color__faint__text);
      }

      .row-content {
        height: 56px;
        border-top: 1px solid var(--color__faint__border);
        color: var(--color__standard__text);
        &__links {
          white-space: nowrap;
          padding: var(--spacing__base_unit);
          text-align: right;
          a,
          button {
            &:not(:first-child) {
              margin-left: var(--spacing__base_unit);
            }
            &:not(:first-child):before {
              content: none;
            }
          }
        }
      }
      .row-content__date {
        padding-left: var(--spacing__unit--2);
        padding-right: var(--spacing__unit--3);
        width: 80px;
        text-align: left;
        color: var(--color__standard__text);
      }

      .row-content__description {
        color: var(--color__standard__text);
        .description-line {
          margin: 0;
        }
      }
      .row-content__price {
        padding-left: var(--spacing__unit--3);
        padding-right: var(--spacing__unit--2);
        width: 100px;
        text-align: left;
        color: var(--color__standard__text);
      }

      .billing-history-row {
        border-top: 1px solid var(--color__faint__border);
      }

      .billing-history-col {
        text-align: center;
        height: ver(--spacing__unit--5);
      }

      .account-page__link {
        color: inherit;
        padding-bottom: var(--spacing__unit--0_5);
        border-bottom: 1px solid var(--color__standard__border);
        font-weight: var(--type__body__standard--fontweight_strong);
        &:hover {
          border-bottom: 1px solid var(--color__standard__text);
        }
      }
    }
  }
`;class u extends n.default.Component{buildFooterIfNecessary(){if(null!==this.props.footer)return n.default.createElement("tfoot",{className:"row-footer"},this.props.footer)}buildHeaderDate(){return n.default.createElement("th",{className:"row-header date-row"},n.default.createElement(r.Menu.Wrapper,{onSelection:this.props.onSelection},({getContentProps:e,getTriggerProps:t})=>n.default.createElement(n.default.Fragment,null,n.default.createElement(d.Button,Object.assign({className:"date-header-cell"},t(),{variant:"transparent",withDropdownIcon:!0,hasNoUnderline:!0}),s.intl.formatMessage({id:"65pLwc",defaultMessage:"Date"})),n.default.createElement(r.Menu.Content,Object.assign({},e()),n.default.createElement(r.Menu.Segment,{withLabel:s.intl.formatMessage({id:"HXV3TA",defaultMessage:"Order"})},n.default.createElement(r.Menu.SelectItem,{value:o.BillingHistoryOrder.ASCENDING,selected:o.BillingHistoryOrder.ASCENDING===this.props.order},s.intl.formatMessage({id:"KyJseU",defaultMessage:"Ascending"})),n.default.createElement(r.Menu.SelectItem,{value:o.BillingHistoryOrder.DESCENDING,selected:o.BillingHistoryOrder.DESCENDING===this.props.order},s.intl.formatMessage({id:"Njd630",defaultMessage:"Descending"}))),n.default.createElement(r.Menu.Segment,{withLabel:s.intl.formatMessage({id:"2X0e4z",defaultMessage:"Show"})},n.default.createElement(r.Menu.SelectItem,{value:"all_time",selected:"all_time"===this.props.filter},s.intl.formatMessage({id:"261J2J",defaultMessage:"All time"})),n.default.createElement(r.Menu.SelectItem,{value:"year_to_date",selected:"year_to_date"===this.props.filter},s.intl.formatMessage({id:"EqTfoU",defaultMessage:"Year-to-date"})),this.renderMenuItems())))))}renderMenuItems(){const e=[],{filters:t,filter:a}=this.props;return t&&t.forEach(t=>{e.push(n.default.createElement(r.Menu.SelectItem,{key:t,value:t,selected:t===a},t))}),e}render(){const{amountLabel:e,canEditBilling:t,displayNoTransactionsOnEmptyRecords:a,showEditInvoiceModal:i,logAccountBillingTabEvents:o,isTeam:r,renderPublicLinks:d,publicInvoiceLink:u,publicReceiptLink:p}=this.props,m=this.props.billingHistoryRecords,g=e||s.intl.formatMessage({id:"PoJI4y",defaultMessage:"Price"});let _;if(a&&0===m.length){const e=this.props.noTransactionLabel?this.props.noTransactionLabel:s.intl.formatMessage({id:"SNLY2j",defaultMessage:"No transactions"});_=n.default.createElement("tr",{className:"row-content"},n.default.createElement("td",{className:"row-content__date"}),n.default.createElement("td",{className:"row-content__description"},e),n.default.createElement("td",{className:"row-content__links"}),n.default.createElement("td",{className:"row-content__price"}))}return n.default.createElement(c,null,n.default.createElement("div",{className:"billing-table-container"},n.default.createElement("table",{className:"billing-history-table",cellSpacing:"0"},n.default.createElement("thead",null,n.default.createElement("tr",null,this.buildHeaderDate(),n.default.createElement("th",{className:"row-header desc-row u-font-meta",colSpan:2},s.intl.formatMessage({id:"VfjryA",defaultMessage:"Description"})),n.default.createElement("th",{className:"row-header price-row u-font-meta"},g))),this.buildFooterIfNecessary(),n.default.createElement("tbody",null,_,m.map((function(e,a){return n.default.createElement(l.BillingHistoryTableRow,{canEditBilling:t,isTeam:r,key:e.id,logAccountBillingTabEvents:o,renderPublicLinks:d,publicInvoiceLink:u,publicReceiptLink:p,row:e,showEditInvoiceModal:i})}))))))}}u.defaultProps={onSelection:()=>{}},u.displayName="BillingHistoryTableComponent",t.BillingHistoryTable=u})),define("modules/clean/teams/admin/widgets/billing_notifications/cancellable_item",["require","exports","tslib","react","modules/core/i18n","classnames","dig-components/buttons"],(function(e,t,a,n,i,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CancellableItemView=void 0,n=a.__importDefault(n),s=a.__importDefault(s);class o extends n.default.Component{render(){const{title:e,description:t,handleAction:a,useCTA:i,CTAText:o}=this.props,r=this.props.className?this.props.className:"",d=s.default("cancellable-item__title",{"cancellable-item__title--alternate":this.props.useAlternateStyle}),c=s.default({"cancellable-item__button":!0,"link-button":!0,"link-button--alternate":this.props.useAlternateStyle,[r]:!0});let u;return i&&(u=n.default.createElement(l.Button,{variant:"transparent",className:c,onClick:a},o)),n.default.createElement("div",{className:"cancellable-item"},n.default.createElement("span",{className:d},e)," ",n.default.createElement("span",{className:"cancellable-item__desc"},t),u)}}t.CancellableItemView=o,o.defaultProps={CTAText:i.intl.formatMessage({id:"7kgsyk",defaultMessage:"Cancel change"}),useCTA:!1},o.displayName="CancellableItemView"})),define("modules/clean/react/growth/trials/requests",["require","exports","tslib","modules/clean/deprecated_ajax/ajax_jquery","modules/core/i18n","modules/clean/react/growth/logging_util","modules/clean/react/growth/trials/util","modules/core/notify","modules/clean/react/growth/trials/types","modules/clean/react/snackbar","api_v2/user_client"],(function(e,t,a,n,i,s,l,o,r,d,c){"use strict";function u(e,t,a,n,l,r){const c=n||i.intl.formatMessage({id:"bLA3rA",defaultMessage:"There was a problem completing this request."});s.logAjaxError(e,t,a,{errorMessage:c}),o.Notify.error(c),r&&d.Snackbar.close(r),l&&l()}function p(e,t,a,n,i){s.logAjaxSuccess(e,t,a),n&&(i?n(i):n())}function m(e,t,n,l,o,r){return a.__awaiter(this,void 0,void 0,(function*(){const a="cancel-trial-notification";d.Snackbar.sync(i.intl.formatMessage({id:"jXr05+",defaultMessage:"Canceling trial..."}),!1,a);const m=()=>{d.Snackbar.complete(i.intl.formatMessage({id:"RBkBP9",defaultMessage:"You’ve successfully canceled your trial."}),a),o&&o()};try{const i=new c.UserApiV2Client,o={trial_sku_code:n,trial_project_type:e},d=yield i.ns("trials").rpc("cancel",o,{subjectUserId:l});d&&"ok"===d.status?p(e,t,s.RequestType.CANCEL_TRIAL,m):u(e,t,s.RequestType.CANCEL_TRIAL,void 0,r,a)}catch(n){u(e,t,s.RequestType.CANCEL_TRIAL,(e=>{if(e.error&&"not_in_trial"===e.error[".tag"])return i.intl.formatMessage({id:"Ui1I/f",defaultMessage:"You’ve already canceled your trial."})})(n),r,a)}}))}function g(e,t,a,l){const o="cancel-trial-notification";d.Snackbar.sync(i.intl.formatMessage({id:"jXr05+",defaultMessage:"Canceling trial..."}),!1,o);const r=s.RequestType.CANCEL_TRIAL,c=()=>{d.Snackbar.complete(i.intl.formatMessage({id:"RBkBP9",defaultMessage:"You’ve successfully canceled your trial."}),o),a&&a()};n.WebRequest({url:"/downgrade/process",data:{trial_project_type:e},success:()=>p(e,t,r,c),error:(a,n,i)=>u(e,t,r,i,l,o)})}Object.defineProperty(t,"__esModule",{value:!0}),t.enableAutoConvert=t.getPriceConversionsForSchedule=t.transitionPlan=t.cancelTransitionTrial=t.cancelPlatformTrial=t.cancelTrial=void 0,n=a.__importStar(n),t.cancelTrial=function(e,t,a,n,i,s,l){return n===r.TrialSource.TRANSITIONS_TRIAL?g(e,t,s,l):n===r.TrialSource.PLATFORM_TRIAL?m(e,t,a,i,s,l):null},t.cancelPlatformTrial=m,t.cancelTransitionTrial=g,t.transitionPlan=function(e,t,a,i,o,r){const d=s.RequestType.TRANSITION_PLAN,c=l.getTransitionChangeType(e);c?n.WebRequest({type:"POST",url:"/account/perform_personal_transition",data:{transition_change_type:c},subject_user:t,success:()=>p(a,i,d,o),error:(e,t,n)=>u(a,i,d,n,r)}):u(a,i,d)},t.getPriceConversionsForSchedule=function(e,t,n,i,l,o){return a.__awaiter(this,void 0,void 0,(function*(){const a=s.RequestType.GET_PRICE_CONVERSIONS_FOR_SCHEDULE;try{const s=new c.UserApiV2Client,r=yield s.ns("trials").rpc("get_price_conversions_for_schedule",i,{subjectUserId:e});r?p(t,n,a,l,r):u(t,n,a,void 0,o)}catch(e){u(t,n,a,void 0,o)}}))},t.enableAutoConvert=function(e,t,n,i,l,o){return a.__awaiter(this,void 0,void 0,(function*(){const a=s.RequestType.ENABLE_AUTO_CONVERT;try{const s=new c.UserApiV2Client,r=yield s.ns("trials").rpc("enable_auto_convert",i,{subjectUserId:e});r&&"ok"===r.status?p(t,n,a,l,r):u(t,n,a,void 0,o)}catch(e){u(t,n,a,void 0,o)}}))}})),define("modules/clean/react/payments/unified_module/unified_actions/unified_submit_action",["require","exports","tslib","modules/clean/payments/payment_form/payment_form_spec","modules/clean/react/payments/common/form/actions/actions","modules/clean/react/payments/unified_module/unified_data_export"],(function(e,t,a,n,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.submitUnifiedForm=void 0,n=a.__importStar(n),t.submitUnifiedForm=function(e,t,a,l={}){return(o,r)=>{const d=r(),c=d.formData.countryCode.formattedValue,u=d.pageState.paymentFormSpec,p=d.formData.paymentMethod.formattedValue,m=s.getPaymentFieldNamesToSubmit(c,u,p);let g;l.payment_method=d.formData.paymentMethod.formattedValue,l.request_id=d.pageState.requestId,l.submit_seq=d.pageState.submitSeq,g=d.pageState.paymentFormSpec.isTeam()?p===n.PaymentMethod.CreditCard?"/team/payments/ajax_update_billing_credit_card":p===n.PaymentMethod.DirectDeposit?"/team/payments/ajax_update_billing_direct_debit":"/team/payments/ajax_update_billing_paypal":p===n.PaymentMethod.CreditCard?"/update_credit_card_billing_info_ajax":p===n.PaymentMethod.DirectDeposit?"/update_direct_debit_billing_info_ajax":p===n.PaymentMethod.Ideal?"/update_ideal_billing_info_ajax":"/paypal_billing_info",o(i.submitForm(g,m,e,l,void 0,t,a))}}})),define("modules/clean/react/payments/unified_module/unified_actions/unified_store",["require","exports","tslib","redux","modules/clean/react/payments/common/form/actions/actions","modules/clean/react/payments/update_team_billing/update_team_actions","modules/clean/react/payments/buy/actions/page_actions","modules/clean/react/payments/unified_module/unified_actions/unified_submit_action","modules/clean/react/payments/checkout/components/payment_method_form/apple_pay"],(function(e,t,a,n,i,s,l,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.bindUnifiedBillingActions=void 0,n=a.__importStar(n),i=a.__importStar(i),s=a.__importStar(s),l=a.__importStar(l),o=a.__importStar(o),t.bindUnifiedBillingActions=function(e){return n.bindActionCreators({applePayAction:r.applePayAction,updateHistory:l.updateHistory,showFormFieldErrors:i.showFormFieldErrors,submitBillingForm:o.submitUnifiedForm,updatePaymentMethod:i.updatePaymentMethod,updateCountryCode:s.updateBillingCountryCode,updateZipCode:i.updateZipCode,updateVat:i.updateVat,updateCpf:i.updateCpf,updateCpfName:i.updateCpfName,updateNonce:i.updateNonce,updatePayPalNonce:i.updatePayPalNonce,updateAdyenEncryptedCard:i.updateAdyenEncryptedCard,updateEncryptedCardForNetworkToken:i.updateEncryptedCardForNetworkToken,updateApplePayToken:i.updateApplePayToken,updateBrowserInfo:i.updateBrowserInfo,updateThreeDsData:i.updateThreeDsData,triggerThreeDsChallenge:i.triggerThreeDsChallenge,triggerThreeDsFingerprint:i.triggerThreeDsFingerprint,updateBIN:i.updateBIN,updateAccountHolderName:i.updateAccountHolderName,updateIBAN:i.updateIBAN,updateMandateSigned:i.updateMandateSigned,updateIdealBank:i.updateIdealBank,blurCCField:i.blurCCField,blurZipCode:i.blurZipCode,blurVat:i.blurVat,blurCpf:i.blurCpf,blurAccountHolderName:i.blurAccountHolderName,blurIBAN:i.blurIBAN},e.dispatch)}})),define("modules/clean/react/payments/unified_module/unified_fields/unified_cpf_field",["require","exports","tslib","react","modules/clean/react/payments/unified_module/unified_fields/unified_fields_base/unified_text_input_field","modules/clean/react/payments/common/form_value_helpers","modules/core/i18n"],(function(e,t,a,n,i,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UnifiedCPFField=void 0,n=a.__importDefault(n);class o extends n.default.Component{constructor(){super(...arguments),this.onCpfChange=e=>{this.props.actions.updateCpf(e.value)},this.onCpfNameChange=e=>{this.props.actions.updateCpfName(e.value)}}cpfErrorString(){const e=this.props.formData.cpf;return!s.FormValueHelper.isValid(e)&&e.showError?l.intl.formatMessage({id:"MQDRWx",defaultMessage:"Please enter a valid CPF number."}):""}render(){const{paymentSpec:e,formData:t}=this.props;let a=null;return e.should_require_cpf(t.countryCode.formattedValue,t.paymentMethod.formattedValue)&&(a=n.default.createElement("div",{className:"grid__item"},n.default.createElement(i.UnifiedTextInputField,{autoSetupForm:t.cpf,name:"cpf",labelText:l.intl.formatMessage({id:"Z1BdZ2",defaultMessage:"CPF/CNPJ"}),errorText:this.cpfErrorString(),onChange:this.onCpfChange}),n.default.createElement(i.UnifiedTextInputField,{labelDivClassName:"billing-cpf grid__item",name:"cpf_name",labelText:l.intl.formatMessage({id:"cJojIg",defaultMessage:"Name"}),value:t.cpfName.rawValue,onChange:this.onCpfNameChange}))),a}}t.UnifiedCPFField=o,o.displayName="UnifiedCPFField"})),define("modules/clean/react/payments/unified_module/unified_fields/unified_vat_field",["require","exports","tslib","classnames","react","modules/clean/react/payments/unified_module/unified_fields/unified_fields_base/unified_text_input_field","modules/clean/react/payments/common/form_value_helpers","modules/core/i18n","modules/clean/payments/validation"],(function(e,t,a,n,i,s,l,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UnifiedVatField=void 0,n=a.__importDefault(n),i=a.__importDefault(i);class d extends i.default.Component{onVatChange(e){this.props.actions.updateVat(e.value)}vatErrorString(){const e=this.props.formData.vat;return!l.FormValueHelper.isValid(e)&&e.showError?o.intl.formatMessage({id:"iRjYtd",defaultMessage:"Please enter a valid VAT number (ex: {examples})."},{examples:r.getVatExamples(this.props.formData.countryCode.formattedValue).join(", ")}):""}render(){const{paymentSpec:e,formData:t}=this.props;let a=null;if(e.should_show_vat_for_country(t.countryCode.formattedValue)){const e=r.getVatPrefix(t.countryCode.formattedValue),l=n.default({"billing-vat":!0,grid__item:!0});a=i.default.createElement(s.UnifiedTextInputField,{labelDivClassName:l,autoSetupForm:t.vat,name:"vat",labelText:o.intl.formatMessage({id:"eZAuK1",defaultMessage:"VAT number (optional)"}),errorText:this.vatErrorString(),placeholder:e,onChange:this.onVatChange.bind(this)})}return a}}t.UnifiedVatField=d,d.displayName="UnifiedVatField"})),define("modules/clean/react/payments/unified_module/unified_fields/unified_fields_base/unified_generic_input",["require","exports","tslib","classnames","dompurify","react"],(function(e,t,a,n,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UnifiedGenericInput=void 0,n=a.__importDefault(n),i=a.__importStar(i),s=a.__importDefault(s);class l extends s.default.Component{render(){const e=n.default({"input__label--errormodal":Boolean(this.props.errorText)},this.props.className,"label-input","input__label");let t=s.default.createElement("label",{className:`label ${this.props.labelClass?this.props.labelClass:""}`,htmlFor:this.props.htmlFor},this.props.labelText),a=null;this.props.labelAfterElement&&(a=t,t=null);let l=null;l=this.props.rightLabelElement?s.default.createElement("div",{className:"grid__item grid--x-bookend"},t,s.default.createElement("div",null,this.props.rightLabelElement)):t;let o=null;this.props.errorText?o=this.props.errorText:this.props.errorHTML&&(o=s.default.createElement("span",{dangerouslySetInnerHTML:{__html:i.sanitize(this.props.errorHTML)}}));const r=s.default.createElement("label",{className:"error-message",htmlFor:this.props.htmlFor},o);return s.default.createElement("div",{className:e},l,this.props.children,a,r)}}t.UnifiedGenericInput=l,l.displayName="UnifiedGenericInput"})),define("modules/clean/react/payments/unified_module/unified_fields/unified_fields_base/unified_select_input_field",["require","exports","tslib","react","react-dom","modules/clean/react/payments/unified_module/unified_fields/unified_fields_base/unified_generic_input"],(function(e,t,a,n,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UnifiedLabeledSelectInput=void 0,n=a.__importDefault(n),i=a.__importStar(i);class l extends n.default.Component{onChange(e){this.props.onChange&&this.props.onChange(i.findDOMNode(this.input))}onClick(e){this.props.onClick&&this.props.onClick(i.findDOMNode(this.input))}componentDidMount(){if(this.props.onChange){const e=i.findDOMNode(this.input),t=e.value;t&&t!==this.props.value&&this.props.onChange(e)}}render(){const{name:e,className:t,labelClass:a,labelText:i,rightLabelElement:l,errorText:o,errorHTML:r,autoComplete:d}=this.props;return n.default.createElement(s.UnifiedGenericInput,{className:t,errorHTML:r,errorText:o,labelClass:a,htmlFor:e,labelText:i,rightLabelElement:l},n.default.createElement("select",{autoComplete:d,className:"option-selector",id:e,name:e,onChange:this.onChange.bind(this),onClick:this.onClick.bind(this),value:this.props.value,ref:e=>{this.input=e}},this.props.children))}}t.UnifiedLabeledSelectInput=l,l.displayName="UnifiedLabeledSelectInput"})),define("modules/clean/react/payments/unified_module/unified_fields/unified_fields_base/unified_text_input_field",["require","exports","tslib","classnames","react","react-dom","modules/clean/react/payments/common/form_value_helpers","modules/clean/react/payments/unified_module/unified_fields/unified_fields_base/unified_generic_input"],(function(e,t,a,n,i,s,l,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UnifiedTextInputField=void 0,n=a.__importDefault(n),i=a.__importDefault(i),s=a.__importStar(s);class r extends i.default.Component{constructor(){super(...arguments),this.onBlur=e=>{this.props.onBlur&&this.props.onBlur(s.findDOMNode(this.refToInput))},this.onFocus=e=>{this.props.onFocus&&this.props.onFocus(s.findDOMNode(this.refToInput))},this.onChange=e=>{this.props.onChange&&this.props.onChange(s.findDOMNode(this.refToInput))}}componentDidMount(){if(this.props.onChange){const e=s.findDOMNode(this.refToInput),t=e.value;t&&t!==this.props.value&&this.props.onChange(e)}}render(){let{labelDivClassName:e,disabled:t,errorText:a,errorHTML:s,labelClass:r,labelText:d,maxLength:c,name:u,placeholder:p,value:m,autoComplete:g,autoSetupForm:_}=this.props;const f=this.props.type||"text";let h=null;if(_){const t=_.errorState&&_.showError;m=m||_.rawValue,s=s||_.serverError,s=t?s:void 0,a=t?a:void 0;const i="billing-"+u+"-input",o=""!==_.formattedValue&&l.FormValueHelper.isValid(_)?"billing-"+u+"-input--valid":"";h=n.default({baseInputClass:i,invalidClass:o});const r="billing-"+u;e=n.default(e,r,{grid__item:!0})}const y=n.default({input__text:!0,"input__text--errormodal":Boolean(a)||Boolean(s)},this.props.inputClassName,h);return i.default.createElement(o.UnifiedGenericInput,{className:e,errorHTML:s,errorText:a,htmlFor:u,labelClass:r,labelText:d},i.default.createElement("input",{autoComplete:g,className:y,type:f,name:u,id:u,ref:e=>{this.refToInput=e},value:null===m?"":m,disabled:t,onBlur:this.onBlur,onChange:this.onChange,onFocus:this.onFocus,maxLength:c,placeholder:p}))}}t.UnifiedTextInputField=r,r.displayName="UnifiedTextInputField"})),define("modules/clean/react/payments/unified_module/unified_address_form",["require","exports","tslib","react","modules/core/i18n","modules/clean/react/payments/common/form_value_helpers","modules/clean/react/payments/common/constants","modules/clean/react/payments/unified_module/unified_fields/unified_fields_base/unified_text_input_field","modules/clean/react/payments/unified_module/unified_fields/unified_fields_base/unified_select_input_field"],(function(e,t,a,n,i,s,l,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UnifiedAddressForms=void 0,n=a.__importDefault(n);class d extends n.default.Component{constructor(){super(...arguments),this.onCountryCodeChange=e=>{this.props.actions.updateCountryCode(e.value)},this.onZipCodeBlur=e=>{this.props.actions.blurZipCode(e.value)},this.onZipCodeChange=e=>{this.props.actions.updateZipCode(e.value)},this.zipCodeErrorString=()=>{const e=this.props.formData.zipCode;return!s.FormValueHelper.isValid(e)&&e.showError?l.ZipCodeErrorMessage:""}}renderCountrySelector(e){let t="grid__item--2-3";!0===e&&(t="grid__item");const a=this.props.countryList.map(e=>{const[t,a]=e;return n.default.createElement("option",{key:`location-${t}`,value:t,"aria-selected":t===this.props.formData.countryCode.formattedValue},a)});return n.default.createElement(r.UnifiedLabeledSelectInput,{autoComplete:"country",className:t,labelText:i.intl.formatMessage({id:"1SPrvR",defaultMessage:"Country"}),name:"country_code",onChange:this.onCountryCodeChange,value:this.props.formData.countryCode.rawValue},a)}renderZipCodeInput(){const e=i.intl.formatMessage({id:"5kJrVX",defaultMessage:"Postal Code"}),t="US"===this.props.formData.countryCode.formattedValue?i.intl.formatMessage({id:"ciLB6A",defaultMessage:"Billing ZIP"}):e,a=!this.props.paymentSpec.allow_zip_code_for_country(this.props.formData.countryCode.formattedValue);return n.default.createElement(o.UnifiedTextInputField,{autoComplete:"postal-code",labelDivClassName:"billing-zip payment-info__zip grid__item grid__item--7-24",disabled:a,errorText:this.zipCodeErrorString(),errorHTML:this.props.formData.zipCode.serverError,labelText:t,name:"zip",onChange:this.onZipCodeChange,value:this.props.formData.zipCode.rawValue,onBlur:this.onZipCodeBlur})}render(){return n.default.createElement(n.default.Fragment,null,this.renderCountrySelector(!1),this.renderZipCodeInput())}}t.UnifiedAddressForms=d,d.displayName="UnifiedAddressForms"})),define("modules/clean/react/payments/unified_module/unified_payment_form_async",["require","exports","tslib","react","modules/core/i18n","modules/clean/react/payments/unified_module/unified_payment_form","modules/clean/react/payments/unified_module/unified_actions/unified_store","modules/clean/react/payments/common/form/actions/actions","modules/clean/react/payments/update_team_billing/update_team_store_creator","modules/clean/react/payments/update_team_billing/reducers","modules/clean/payments/payment_form/payment_form_spec","modules/clean/deprecated_ajax/ajax_jquery","modules/core/notify","modules/clean/static_urls","modules/clean/react/payments/update_individual_billing/update_individual_store_creator","modules/clean/analytics"],(function(e,t,a,n,i,s,l,o,r,d,c,u,p,m,g,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UnifiedPaymentFormAsync=void 0,n=a.__importDefault(n),u=a.__importStar(u);class f extends n.default.Component{constructor(e){super(e),this.calledOnSuccess=!1,this.calledOnError=!1,this.loaded=!1,this.handleLoadSuccess=e=>{if(e.isError)this.setState({}),this.handleLoadFailure();else{const t={countryList:e.countryList,iframeUrl:e.iframeUrl,vat:e.vat,userInfo:e.userInfo,countryToCurrencyMap:e.countryToCurrencyMap,countryCode:e.countryCode,serializedPaymentFormSpec:e.serializedPaymentFormSpec,requestId:e.requestId,submitSeq:0};this.loaded=!0,this.iFrameUrl=e.iframeUrl,this.countryList=e.countryList,this.paymentExperiments=e.paymentExperiments,this.paymentOptionalSettings=e.paymentOptionalSettings,this.props.isTeam?this.store=r.createBillingStore(t,d.BillingReducer):this.store=g.createBillingStore(t,d.BillingReducer),this.setState(this.store.getState()),this.store.subscribe(()=>{const e=this.store.getState();if(!e.pageState.submitSuccess)if(this.props.isSubmittingStatus){const t=this.props.isSubmittingStatus;this.setState(a=>(t(e.pageState.submitting),e))}else this.setState(t=>e);e.pageState.submitSuccess&&!this.calledOnSuccess&&(this.props.onSuccess(),this.calledOnSuccess=!0),"error"===e.pageState.submitState&&this.props.onError&&!this.calledOnError&&(this.props.onError(),this.calledOnError=!0)})}},this.handleLoadFailure=()=>{p.Notify.error(i.intl.formatMessage({id:"gaNMlz",defaultMessage:"Failed to load payment form."}))},this.saveUnifiedPaymentMethodForm=e=>{this.unifiedPaymentForm=e},this.prepareForSubmission=()=>(_.UserActivityLogger.log("web","update_billing_modal_try_submit",{payment_method:c.PaymentMethod[this.state.formData.paymentMethod.rawValue],country_code:this.state.formData.countryCode.rawValue,zip_code:this.state.formData.zipCode.rawValue,isNptBillingModal:this.paymentExperiments.showNptBillingModal,project:this.paymentExperiments.trialProjectType}),this.unifiedPaymentForm.prepareForSubmission()),this.onAccept=(e=o.SubmitFormTriggerType.ButtonClick)=>{this.actions.submitBillingForm(this.prepareForSubmission,this.unifiedPaymentForm.getCreditCardFrame().handle3DsMessage,e,this.generateAdditionalInfo())},this.iFrameUrl=""}componentDidMount(){this.props.preloadedViewModel?this.handleLoadSuccess(this.props.preloadedViewModel):u.WebRequest({url:"/account/unified_payment_view",data:{isTeam:this.props.isTeam},success:e=>{const t=JSON.parse(e);this.handleLoadSuccess(t)},error:()=>{this.handleLoadFailure()}})}get actions(){return l.bindUnifiedBillingActions(this.store)}generateAdditionalInfo(){const e={};return this.paymentOptionalSettings.showRebillUpsell&&(e.showRebillUpsell=this.paymentOptionalSettings.showRebillUpsell),this.paymentOptionalSettings.isScheduledDowngradeToBasic,e}renderLoading(){return n.default.createElement("div",{className:"loading-spinner"},n.default.createElement("img",{src:m.static_url("/static/images/icons/ajax-loading-small-vfl3Wt7C_.gif"),alt:i.intl.formatMessage({id:"jybGUg",defaultMessage:"Loading"})}))}render(){return this.loaded?n.default.createElement("div",{className:"payment-info-section"},n.default.createElement("div",{className:"payment-method-section grid__container"},n.default.createElement(s.UnifiedPaymentForm,{ref:this.saveUnifiedPaymentMethodForm,paymentSpec:this.state.pageState.paymentFormSpec,iframeUrl:this.iFrameUrl,countryList:this.countryList,formData:this.state.formData,actions:this.actions,submitForm:this.onAccept,payment_experiments:this.paymentExperiments,payment_optional_settings:this.paymentOptionalSettings}))):this.renderLoading()}}t.UnifiedPaymentFormAsync=f,f.displayName="UnifiedPaymentFormAsync"})),define("modules/clean/react/payments/unified_module/unified_payment_form",["require","exports","tslib","classnames","modules/clean/analytics","react","modules/core/i18n","modules/clean/react/payments/checkout/components/payment_method_form/credit_card_frame","modules/clean/react/payments/checkout/components/payment_method_form/direct_debit_form","modules/clean/payments/payment_form/payment_form_spec","modules/clean/react/payments/checkout/components/payment_method_form/payment_method_selector","modules/clean/react/payments/unified_module/unified_fields/unified_cpf_field","modules/clean/react/payments/unified_module/unified_fields/unified_vat_field","modules/clean/react/payments/unified_module/unified_address_form","modules/clean/react/payments/unified_module/unified_data_export","modules/clean/react/payments/buy/components/payments/ideal_form","dig-components/typography"],(function(e,t,a,n,i,s,l,o,r,d,c,u,p,m,g,_,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UnifiedPaymentForm=void 0,n=a.__importDefault(n),s=a.__importDefault(s);class h extends s.default.Component{constructor(e){super(e)}getPaymentData(){return g.getDataIfValid(this.props.formData,this.props.paymentSpec,this.prepareForSubmission(),this.props.payment_experiments)}componentDidMount(){const e=this.props.formData.countryCode.formattedValue;i.TeamsWebActionsLogger.log("uj-billing-country",{country:e}),"BR"===e&&i.TeamsWebActionsLogger.log("uj-cpf-viewed-field"),this.props.actions.updateHistory()}prepareForSubmission(){return this.props.formData.paymentMethod.formattedValue===d.PaymentMethod.CreditCard?this.creditCardFrame.tokenize():Promise.resolve(!0)}getCreditCardFrame(){return this.creditCardFrame}renderLocationFields(){var e,t;const{paymentSpec:a,formData:n}=this.props;let i=null,o=l.intl.formatMessage({id:"8vkOAo",defaultMessage:"Please note: changing your billing location could impact your applicable tax rate."});return a.should_show_vat_for_country(n.countryCode.formattedValue)&&(o=l.intl.formatMessage({id:"RCr4JC",defaultMessage:"Please note: changing your billing location or VAT number could impact your applicable tax rate."})),this.props.payment_experiments.showNptBillingModal&&(o=l.intl.formatMessage({id:"C8NyKM",defaultMessage:"You won't be charged until you confirm your purchase on the next screen."})),this.props.paymentSpec.isTeam()||(i=s.default.createElement("div",{className:(null===(e=this.props.payment_optional_settings)||void 0===e?void 0:e.isScheduledDowngradeToBasic)?"disclaimer-message-full-width":"disclaimer-message"},o,(null===(t=this.props.payment_optional_settings)||void 0===t?void 0:t.isScheduledDowngradeToBasic)&&s.default.createElement("span",null," ",l.intl.formatMessage({id:"GweSkC",defaultMessage:"Updating your billing information will cancel your scheduled plan downgrade. If you still wish to downgrade, you will need to schedule it again."})))),s.default.createElement("div",{className:"location-info-fields grid__item grid--x-bookend"},s.default.createElement(m.UnifiedAddressForms,{paymentSpec:this.props.paymentSpec,formData:this.props.formData,actions:this.props.actions,countryList:this.props.countryList}),s.default.createElement(p.UnifiedVatField,{paymentSpec:this.props.paymentSpec,formData:this.props.formData,actions:this.props.actions,payment_experiments:this.props.payment_experiments}),s.default.createElement(u.UnifiedCPFField,{paymentSpec:this.props.paymentSpec,formData:this.props.formData,actions:this.props.actions,payment_experiments:this.props.payment_experiments}),s.default.createElement(f.Text,{size:"small",color:"faint",variant:"paragraph"},i))}render(){const{paymentSpec:e,actions:t,formData:a}=this.props,i=this.renderLocationFields();let l=i;a.paymentMethod.formattedValue===d.PaymentMethod.DirectDeposit?l=s.default.createElement(r.DirectDebitForm,{locationFields:i,formData:a,actions:t}):a.paymentMethod.formattedValue===d.PaymentMethod.Ideal&&(l=s.default.createElement(_.IdealForm,{locationFields:i,formData:a,actions:t,idealBanks:e.idealBanks()}));const u=n.default({grid__item:!0,"payment-form":!0,"payment-form--responsive":!0});return s.default.createElement("div",{className:u},s.default.createElement(c.PaymentMethodSelector,{isTeam:!1,paymentSpec:e,paymentMethod:a.paymentMethod.rawValue,updatePaymentMethod:this.props.actions.updatePaymentMethod,countryCode:a.countryCode.rawValue,zipCode:a.zipCode.rawValue}),s.default.createElement(o.CreditCardFrame,{getHeightFromIframe:!0,iframeUrl:this.props.iframeUrl,isResponsive:!0,hidden:a.paymentMethod.formattedValue!==d.PaymentMethod.CreditCard,actions:this.props.actions,ref:e=>{this.creditCardFrame=e},nonce:a.nonce,bin:a.bin,submitForm:this.props.submitForm}),l)}}t.UnifiedPaymentForm=h,h.displayName="UnifiedPaymentForm"})),define("modules/clean/react/payments/unified_module/unified_data_export",["require","exports","tslib","modules/clean/payments/payment_form/payment_form_spec","modules/clean/react/payments/business/state/business_state","modules/clean/react/payments/common/form_value_helpers"],(function(e,t,a,n,i,s){"use strict";function l(e,t,a){const i=["countryCode"];return t.allow_zip_code_for_country(e)&&i.push("zipCode"),t.should_show_vat_for_country(e)&&i.push("vat"),t.should_require_cpf(e,a)&&(i.push("cpf"),i.push("cpfName")),a===n.PaymentMethod.CreditCard?(i.push("nonce"),i.push("adyenEncryptedCard"),i.push("encryptedCardForNetworkToken"),i.push("bin"),i.push("browserInfo"),i.push("threeDsData")):a===n.PaymentMethod.DirectDeposit?i.push("accountHolderName","iban","mandateSigned"):a===n.PaymentMethod.Ideal?i.push("idealBankId","idealBankName"):a===n.PaymentMethod.ApplePay&&i.push("applePayToken"),i}function o(e,t){return t[e]}Object.defineProperty(t,"__esModule",{value:!0}),t.getPaymentFieldNamesToSubmit=t.getDataIfValid=void 0,n=a.__importStar(n),t.getDataIfValid=function(e,t,a,n){const r=l(e.countryCode.formattedValue,t,e.paymentMethod.formattedValue);return(function(e,t){for(const a of e){const e=o(a,t);if(!s.FormValueHelper.isValid(e))return!1}return!0})(r,e)?a.then(()=>(function(e,t){const a={};for(const n of e)a[i.fieldsToServerProps[n]]=o(n,t).formattedValue;return a})(r,e)):Promise.resolve(null)},t.getPaymentFieldNamesToSubmit=l})),define("modules/clean/react/payments/checkout/components/inputs/radio_input",["require","exports","tslib","react","react-dom"],(function(e,t,a,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RadioInput=void 0,n=a.__importDefault(n),i=a.__importStar(i);class s extends n.default.Component{onChange(e){this.props.onChange&&this.props.onChange(i.findDOMNode(this.input))}componentDidMount(){if(this.props.onChange){const e=i.findDOMNode(this.input),t=e.checked;t&&t!==this.props.checked&&this.props.onChange(e)}}render(){const{name:e,id:t,className:a,checked:i,value:s,disabled:l}=this.props;return n.default.createElement("input",{type:"radio",className:a,name:e,id:t,value:s,checked:i,onChange:this.onChange.bind(this),disabled:l,ref:e=>{this.input=e}})}}t.RadioInput=s,s.displayName="RadioInput"})),define("modules/clean/react/payments/checkout/components/payment_method_form/payment_method_option",["require","exports","tslib","react","modules/core/i18n","classnames","modules/clean/payments/payment_form/payment_form_spec","modules/clean/react/payments/checkout/components/inputs/radio_input","modules/clean/react/payments/pro/components/inputs/inputs"],(function(e,t,a,n,i,s,l,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PaymentMethodOption=void 0,n=a.__importDefault(n),s=a.__importDefault(s);class d extends n.default.Component{onChange(e){this.props.onSelected(this.props.paymentMethod)}render(){const{icons:e,labelText:t,paymentMethod:a}=this.props,d=[],c=["payment-method-option","payment-info__option"];let u,p;if(this.props.isTeam?(c.push("grid__item"),c.push("grid__item--medium--shrink"),c.push("grid--y-middle"),c.push("grid__container--p-micro")):this.props.numberOfPaymentMethods&&this.props.numberOfPaymentMethods>2?c.push("grid__item--medium--1-4"):c.push("grid__item--medium--1-2"),t&&(u="payment-method-label#debit",d.push(n.default.createElement("span",{key:u,className:"debit"},this.props.labelText))),e){if(a===l.PaymentMethod.CreditCard){const t=e.join(", ").replace("_","-"),a=i.intl.formatMessage({id:"IBCGt3",defaultMessage:"Credit card. We accept {payment_methods}"},{payment_methods:t});u="payment-method-label#creditcard",d.push(n.default.createElement("span",{key:u,className:"ax-visually-hidden"},a))}else a===l.PaymentMethod.PayPal&&(u="payment-method-label#paypal",d.push(n.default.createElement("span",{key:u,className:"ax-visually-hidden"},i.intl.formatMessage({id:"RxvBVG",defaultMessage:"Paypal"}))));for(const t of e)u=`payment-method-icon#${t}`,d.push(n.default.createElement("span",{key:u,className:t}))}return p=this.props.isTeam?n.default.createElement("div",{className:s.default(c)},n.default.createElement(o.RadioInput,{name:"payment_method",id:`payment_method_${a}`,value:a.toString(),checked:this.props.selected,onChange:this.onChange.bind(this)}),n.default.createElement("label",{htmlFor:`payment_method_${a}`,className:"payment-method-label"},d)):n.default.createElement("div",{className:s.default(c)},n.default.createElement(r.LabeledRadioInput,{id:`payment_method_${a}`,name:"payment_method",className:"payment-info__payment",value:a.toString(),checked:this.props.selected,onClick:this.onChange.bind(this)}),n.default.createElement("label",{htmlFor:`payment_method_${a}`,className:"payment-info__method-label",onClick:this.onChange.bind(this)},d)),p}}t.PaymentMethodOption=d,d.displayName="PaymentMethodOption"})),define("modules/clean/react/payments/checkout/components/payment_method_form/payment_method_selector",["require","exports","tslib","react","modules/clean/payments/payment_form/payment_form_spec","modules/clean/react/payments/checkout/components/payment_method_form/payment_method_option","modules/core/i18n"],(function(e,t,a,n,i,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PaymentMethodSelector=void 0,n=a.__importDefault(n);class o extends n.default.Component{constructor(){super(...arguments),this.onPaymentMethodSelected=e=>{this.props.updatePaymentMethod(e)}}getLabelForMethodId(e){return e===i.PaymentMethod.CreditCard?n.default.createElement(s.PaymentMethodOption,{key:`payment-method#${e}`,paymentMethod:i.PaymentMethod.CreditCard,selected:this.props.paymentMethod===i.PaymentMethod.CreditCard,onSelected:this.onPaymentMethodSelected,icons:this.props.paymentSpec.supported_credit_cards_for_country(this.props.countryCode),isTeam:this.props.isTeam,numberOfPaymentMethods:this.props.paymentSpec.available_payment_methods_for_country(this.props.countryCode).length}):e===i.PaymentMethod.PayPal?n.default.createElement(s.PaymentMethodOption,{key:`payment-method#${e}`,paymentMethod:i.PaymentMethod.PayPal,selected:this.props.paymentMethod===i.PaymentMethod.PayPal,onSelected:this.onPaymentMethodSelected,icons:["paypal"],isTeam:this.props.isTeam,numberOfPaymentMethods:this.props.paymentSpec.available_payment_methods_for_country(this.props.countryCode).length}):e===i.PaymentMethod.DirectDeposit?n.default.createElement(s.PaymentMethodOption,{key:`payment-method#${e}`,isTeam:this.props.isTeam,labelText:l.intl.formatMessage({id:"H1vHwe",defaultMessage:"Direct Debit"}),numberOfPaymentMethods:this.props.paymentSpec.available_payment_methods_for_country(this.props.countryCode).length,onSelected:this.onPaymentMethodSelected,paymentMethod:i.PaymentMethod.DirectDeposit,selected:this.props.paymentMethod===i.PaymentMethod.DirectDeposit}):e===i.PaymentMethod.Ideal?n.default.createElement(s.PaymentMethodOption,{key:`payment-method#${e}`,isTeam:this.props.isTeam,paymentMethod:i.PaymentMethod.Ideal,selected:this.props.paymentMethod===i.PaymentMethod.Ideal,onSelected:this.onPaymentMethodSelected,icons:["ideal"],numberOfPaymentMethods:this.props.paymentSpec.available_payment_methods_for_country(this.props.countryCode).length,labelText:l.intl.formatMessage({id:"DgNBM/",defaultMessage:"iDEAL"})}):null}render(){const{countryCode:e,paymentSpec:t}=this.props,a=t.available_payment_methods_for_country(e).map(e=>this.getLabelForMethodId(e));return n.default.createElement("div",{className:"payment-method-selector payment-info__selector grid__item"},a)}}t.PaymentMethodSelector=o,o.displayName="PaymentMethodSelector"})),define("modules/clean/react/payments/update_team_billing/reducers",["require","exports","modules/clean/react/payments/common/form/reducers/reducers","modules/clean/react/payments/common/payments/reducers/reducers","modules/clean/react/payments/common/pricing/reducers/reducers"],(function(e,t,a,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BillingReducer=void 0,t.BillingReducer=(function(...e){return e.reduce((e,t)=>(a,n)=>t(e(a,n),n))})((function(e,t){return"SubmitFormSuccess"!==t.type?e:Object.assign(Object.assign({},e),{pageState:Object.assign(Object.assign({},e.pageState),{submitSuccess:!0})})}),a.FormReducer,...n.PaymentMethodReducers,...i.TransitionManagementReducers)})),define("modules/clean/react/payments/update_team_billing/update_team_actions",["require","exports","tslib","modules/core/i18n","modules/core/notify","modules/clean/payments/payment_form/payment_form_spec","modules/clean/react/payments/common/form/actions/actions"],(function(e,t,a,n,i,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.updateBillingCountryCode=t.submitTeamBillingForm=void 0,s=a.__importStar(s),t.submitTeamBillingForm=function(e,t,a){return(n,i)=>{const o=i(),r=o.formData.countryCode.formattedValue,d=o.pageState.paymentFormSpec,c=["countryCode"];let u;d.allow_zip_code_for_country(r)&&c.push("zipCode"),d.should_show_vat_for_country(r)&&c.push("vat"),d.should_require_cpf(r,o.formData.paymentMethod.formattedValue)&&c.push("cpf"),o.formData.paymentMethod.formattedValue===s.PaymentMethod.CreditCard?(c.push("nonce"),c.push("adyenEncryptedCard"),c.push("encryptedCardForNetworkToken"),c.push("bin"),c.push("browserInfo"),c.push("threeDsData"),u="/team/payments/ajax_update_billing_credit_card"):o.formData.paymentMethod.formattedValue===s.PaymentMethod.DirectDeposit?(c.push("accountHolderName","iban","mandateSigned"),u="/team/payments/ajax_update_billing_direct_debit"):u="/team/payments/ajax_update_billing_paypal",n(l.submitForm(u,c,e,{payment_method:o.formData.paymentMethod.formattedValue,request_id:o.pageState.requestId,submit_seq:o.pageState.submitSeq},void 0,t,a))}},t.updateBillingCountryCode=function(e){return(t,a)=>{const s=a(),o=s.pageState.countryToCurrencyMap;!(e in o)&&s.formData.countryCode.formattedValue in o?i.Notify.error(n.intl.formatMessage({id:"K81Lqx",defaultMessage:"You can’t change to a country with a different currency. For help, contact support."}),3):t(l.updateCountryCode(e))}}})),define("modules/clean/react/payments/update_team_billing/update_team_store_creator",["require","exports","tslib","redux","redux-thunk","modules/clean/react/payments/common/middleware/payments_ux_logger","modules/clean/redux/unsupported","modules/clean/analytics","modules/clean/dbmodal_stack","modules/clean/react/components/modal","modules/clean/react/payments/common/form/middleware/middleware","modules/clean/react/payments/common/payments/state/store_creator","modules/clean/react/payments/common/form_value_factory","modules/core/i18n","modules/core/notify","modules/clean/react/payments/update_individual_billing/update_individual_store_creator"],(function(e,t,a,n,i,s,l,o,r,d,c,u,p,m,g,_){"use strict";function f(e){return e=>t=>{if("SubmitFormSuccess"!==t.type)return e(t);const a=e(t);return g.Notify.success(m.intl.formatMessage({id:"w5p44x",defaultMessage:"We’ve successfully updated your team’s billing information."})),o.TeamsWebActionsLogger.log("update_billing_open_save_changes_success"),d.Modal.close(),r.DBModalStack.trigger(_.BILLING_INFO_UPDATED,null),a}}function h(e,t,a){const{vat:n,countryCode:i,userInfo:s}=e,{paymentMethod:l,countryCode:o,zipCode:r,vat:d,cpf:c,nonce:m,payPalNonce:g,adyenEncryptedCard:_,encryptedCardForNetworkToken:f,applePayToken:h,bin:y,browserInfo:b,threeDsData:v,accountHolderName:M,iban:S,mandateSigned:P,termsAndService:E,idealBankId:C,idealBankName:A,city:T,phone:I,name:w,address:D}=u.createPaymentFormData(e,t,a);return{city:T,phone:I,name:w,address:D,paymentMethod:l,countryCode:o,zipCode:r,vat:n?p.FormValueFactory.createVat(n,i):d,cpf:c,cpfName:p.FormValueFactory.createCpfNamePrefill("","",s.displayName),nonce:m,payPalNonce:g,bin:y,browserInfo:b,threeDsData:v,adyenEncryptedCard:_,encryptedCardForNetworkToken:f,applePayToken:h,accountHolderName:M,iban:S,mandateSigned:P,termsAndService:E,idealBankId:C,idealBankName:A}}Object.defineProperty(t,"__esModule",{value:!0}),t.createFormData=t.createBillingStore=t.submitFormSuccessMiddleware=void 0,n=a.__importStar(n),i=a.__importDefault(i),t.submitFormSuccessMiddleware=f,t.createBillingStore=function(e,t){const a=(function(e){const t=(function(e){const{paymentFormSpec:t}=u.createPaymentPageState(e);return{countryToCurrencyMap:e.countryToCurrencyMap,submitState:null,submitSuccess:!1,submitting:!1,submitSeq:0,paypalEmail:"",requestId:e.requestId,paymentFormSpec:t}})(e),a=(function(e){const{countryCode:t,countryCodeLoading:a,hasCurrencyChanged:n,hasTaxChangedWithinCountry:i,loadingPrices:s,recentLoadEvent:l,requestToken:o}=u.createPaymentPricingState(e);return{countryCode:t,countryCodeLoading:a,hasCurrencyChanged:n,hasTaxChangedWithinCountry:i,loadingPrices:s,recentLoadEvent:l,requestToken:o}})(e);return{pricingState:a,pageState:t,formData:h(e,t,a)}})(e);let o=n.applyMiddleware(i.default,c.submitFormErrorMiddleware,f,new s.PaymentsUXLogger(e.requestId).reduxMiddleware);return l.createStore(t,a,o)},t.createFormData=h}));
//# sourceMappingURL=pkg-account_subscription_core.min.js-vflaj-_Hd.map