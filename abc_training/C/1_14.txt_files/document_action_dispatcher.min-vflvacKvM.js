define(["require","exports","modules/clean/react/integrations/pdf_editor/document_message_bus/dispatchers/event_relay"],(function(e,s,t){"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.DefaultDocumentActionDispatcher=void 0;s.DefaultDocumentActionDispatcher=class{constructor(e,s){this.messageChannel=new MessageChannel,this.targetOrigin=e,this.windowMessageEventRelay=new t.WindowMessageEventRelay(e=>this.handleWindowOnMessage(e)),this.messagePortEventRelay=new t.MessagePortEventRelay,s&&this.registerOnReplyHandler(s),this.messageBusInitializedEventRelay=new t.SimpleEventRelay,this.messagePortEventRelay.port=this.messageChannel.port1,this._busInitialized=!1}get busInitialized(){return this._busInitialized}sendDocumentAction(e){switch(e.kind){case"load_document_action":case"insert_document_action":this.messageChannel.port1.postMessage(e,[e.documentData]);break;default:this.messageChannel.port1.postMessage(e)}}registerOnReplyHandler(e){this.messagePortEventRelay.registerHandler(e)}removeOnReplyHandler(e){this.messagePortEventRelay.removeHandler(e)}registerOnInitializedHandler(e){this.messageBusInitializedEventRelay.registerHandler(e)}removeOnInitializedHandler(e){this.messageBusInitializedEventRelay.removeHandler(e)}dispose(){this.windowMessageEventRelay.dispose(),this.messagePortEventRelay.dispose(),this._busInitialized=!1}sendMessageChannelPortMessage(e){if(null===e)return;e.postMessage({kind:"message_channel_port_message"},this.targetOrigin,[this.messageChannel.port2])}handleWindowOnMessage(e){if(e.origin!==this.targetOrigin)return;switch(e.data.kind){case"frame_initialized_message":this.sendMessageChannelPortMessage(e.source);break;case"message_channel_port_ack_message":this._busInitialized=!0,this.messageBusInitializedEventRelay.triggerHandlers(),this.windowMessageEventRelay.dispose()}}}}));
//# sourceMappingURL=document_action_dispatcher.min.js-vflr_u861.map