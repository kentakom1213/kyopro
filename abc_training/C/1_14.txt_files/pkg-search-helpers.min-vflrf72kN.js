define("modules/clean/search/constants",["require","exports","modules/clean/search/types","modules/clean/react/files_view/view_type"],(function(e,t,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.emptyAllSuggestionData=t.defaultSuggestionSectionOrder=t.SearchViewTypes=t.SEARCH_FILES_VIEW_ID=t.SEARCH_CONTACT_SUGGESTION_CAPACITY=t.TIME_TO_INVALIDATE_POPULAR_FILTERS_CACHE=t.TIME_TO_INVALIDATE_QUERY_SUGGESTIONS_CACHE=t.FILE_CATEGORIES_CHECKED=t.FILE_CATEGORIES_UNCHECKED=t.SEARCH_RECENT_HISTORY_STORAGE_KEY=t.SEARCH_RECENT_HISTORY_CAPACITY=t.SearchOriginPathway=t.SearchType=t.SearchLoadingState=t.MaxResults=void 0,t.MaxResults={MAX_SEARCH_SUGGESTIONS:8,MAX_SEARCH_RESULTS:30},(function(e){e.ZERO_QUERY="ZERO_QUERY",e.LOADED="LOADED",e.LOADING_FIRST_PAGE="LOADING_FIRST_PAGE",e.LOADING_ADDITIONAL_PAGE="LOADING_ADDITIONAL_PAGE",e.LOAD_ERROR="LOAD_ERROR"})(t.SearchLoadingState||(t.SearchLoadingState={})),(function(e){e.ALL="all",e.IMAGE="image"})(t.SearchType||(t.SearchType={})),(function(e){e.ASSISTANT="assistant",e.COLLAB_BROWSE="collab_browse",e.WEB="web"})(t.SearchOriginPathway||(t.SearchOriginPathway={})),t.SEARCH_RECENT_HISTORY_CAPACITY=5,t.SEARCH_RECENT_HISTORY_STORAGE_KEY="search_recent_history",t.FILE_CATEGORIES_UNCHECKED={[r.FileCategory.IMAGE]:"unchecked",[r.FileCategory.DOCUMENT]:"unchecked",[r.FileCategory.PDF]:"unchecked",[r.FileCategory.SPREADSHEET]:"unchecked",[r.FileCategory.PRESENTATION]:"unchecked",[r.FileCategory.AUDIO]:"unchecked",[r.FileCategory.VIDEO]:"unchecked",[r.FileCategory.FOLDER]:"unchecked",[r.FileCategory.PAPER]:"unchecked",[r.FileCategory.OTHER]:"unchecked"},t.FILE_CATEGORIES_CHECKED={[r.FileCategory.IMAGE]:"checked",[r.FileCategory.DOCUMENT]:"checked",[r.FileCategory.PDF]:"checked",[r.FileCategory.SPREADSHEET]:"checked",[r.FileCategory.PRESENTATION]:"checked",[r.FileCategory.AUDIO]:"checked",[r.FileCategory.VIDEO]:"checked",[r.FileCategory.FOLDER]:"checked",[r.FileCategory.PAPER]:"checked",[r.FileCategory.OTHER]:"checked"},t.TIME_TO_INVALIDATE_QUERY_SUGGESTIONS_CACHE=6e4,t.TIME_TO_INVALIDATE_POPULAR_FILTERS_CACHE=6e4,t.SEARCH_CONTACT_SUGGESTION_CAPACITY=3,t.SEARCH_FILES_VIEW_ID="search_files_view_id",t.SearchViewTypes=[i.ViewType.Grid,i.ViewType.LargeGrid,i.ViewType.List],t.defaultSuggestionSectionOrder=[r.SuggestionSection.POPULAR,r.SuggestionSection.QUERY,r.SuggestionSection.PEOPLE,r.SuggestionSection.TAGS],t.emptyAllSuggestionData={[r.SuggestionSection.POPULAR]:void 0,[r.SuggestionSection.QUERY]:void 0,[r.SuggestionSection.PEOPLE]:void 0,[r.SuggestionSection.TAGS]:void 0}})),define("modules/clean/search/models",["require","exports","tslib","deep-freeze","modules/clean/react/browse/models"],(function(e,t,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.extractBrowseContext=t.SlimFileSearchResult=void 0,i=r.__importDefault(i);class n{constructor(e){this.fq_path=e.fq_path,this.is_unmounted=e.is_unmounted,this.icon=e.icon,this.filename_highlights=e.filename_highlights,this.highlight_spans=e.highlight_spans,this.ns_id=e.ns_id,this.sjid=e.sjid,this.is_dir=e.is_dir,this.is_symlink=e.is_symlink,this.type=e.type,this.ns_path=e.ns_path,this.match_type=e.match_type,this._mount_access_perms=e.mount_access_perms,this.thumbnail_url_tmpl=e.thumbnail_url_tmpl,this.hover_preview_url=e.hover_preview_url,this.request_id=e.request_id,this.sort_rank=e.sort_rank,i.default(this)}static fromServerObject(e){return new n(e)}}t.SlimFileSearchResult=n,t.extractBrowseContext=function(e){return new s.BrowseContext({isInFolderMode:e.inside_dir,blockHash:e.block_hash})}})),define("modules/clean/search/search_helpers",["require","exports","tslib","sjcl","modules/clean/react/browse/models","modules/clean/react/browse/constants","modules/clean/search/types","modules/clean/react/files_view/sort_types","modules/clean/search/constants","modules/clean/search/models","modules/core/uri","modules/clean/browse_uri_interface","modules/core/cookies","modules/clean/search/types"],(function(e,t,r,i,s,n,o,a,c,l,u,E,S,_){"use strict";function d(e,t=!0){return t||(e=Object.assign(Object.assign({},e),{[o.FileCategory.PAPER]:"unchecked"})),Object.keys(e).every(t=>"unchecked"===e[t])}Object.defineProperty(t,"__esModule",{value:!0}),t.isPeopleSuggestionData=t.isQuerySuggestionData=t.handleTypeaheadSuggestionClicked=t.extractQueryWithoutTags=t.isPopularFiltersSuggestionData=t.updateQueryWithTagsSuggestion=t.normalizeForTagsSuggestions=t.isTagsSuggestionData=t.areSortOrdersEqual=t.reverseOrderToSortDirection=t.sortDirectionToReverseOrder=t.orderByToSortField=t.sortFieldToOrderBy=t.fileCategoriesSet=t.parseDimensionsUrlParam=t.dimensionsToURLParam=t.allDimensionsAreChecked=t.allCategoriesUnchecked=t.allCategoriesChecked=t.fileCategoryStringToLogValue=t.fileCategoriesFromString=t.fileCategoriesToString=t.getSearchCsrfToken=t.shouldHandleClick=t.resultObjectToUrl=t.buildSearchURL=t.isSearchResultFile=void 0,i=r.__importStar(i),t.isSearchResultFile=e=>e instanceof s.File,t.buildSearchURL=function({user:e,searchPath:t,normalizedQuery:r,searchSessionId:i,searchToken:s,qargs:n}){const o=Object.assign({path:t,search_session_id:i,search_token:s,query:r},n);return new u.URI({path:`/search/${e.role}`,query:o})},t.resultObjectToUrl=function(e,t){return e instanceof l.SlimFileSearchResult||e instanceof s.File?E.browse_uri_for_fq_path(t,e.fq_path).toString():e instanceof s.FileSharedWithMe?e.href:e.url},t.shouldHandleClick=function(e){return 0===e.button&&!e.altKey&&!e.ctrlKey&&!e.metaKey},t.getSearchCsrfToken=function(){const e=i.codec.utf8String.toBits(S.Cookies.read("__Host-js_csrf")),t=i.codec.utf8String.toBits("search"),r=new i.misc.hmac(e);return i.codec.base64.fromBits(r.encrypt(t))},t.fileCategoriesToString=function(e){const t=[];return Object.keys(e).forEach(r=>{"checked"===e[r]&&t.push(r)}),t.join(",")},t.fileCategoriesFromString=function(e){const t=Object.assign({},c.FILE_CATEGORIES_UNCHECKED);return e&&e.split(",").forEach(e=>{e in t&&(t[e]="checked")}),t},t.fileCategoryStringToLogValue=function(e){if(!e)return JSON.stringify(["all_unchecked"]);const t=e.split(","),r=t;return 10===t.length?JSON.stringify(["all_checked"]):JSON.stringify(r)},t.allCategoriesChecked=function(e,t=!0){return t||(e=Object.assign(Object.assign({},e),{[o.FileCategory.PAPER]:"checked"})),Object.keys(e).every(t=>"checked"===e[t])},t.allCategoriesUnchecked=d,t.allDimensionsAreChecked=e=>Object.values(_.Dimensions).filter(e=>"number"==typeof e).length===e.length,t.dimensionsToURLParam=e=>e.map(e=>String(e)).join(","),t.parseDimensionsUrlParam=e=>e.split(",").map(e=>Number(e)),t.fileCategoriesSet=function(e,t=!0){return!!e&&!d(e,t)},t.sortFieldToOrderBy=function(e){switch(e){case a.SortField.MODIFIED:return n.SEARCH_ORDER_BY_TYPE.LAST_MODIFIED_TIME;case a.SortField.RELEVANCE:default:return n.SEARCH_ORDER_BY_TYPE.RELEVANCE}},t.orderByToSortField=function(e){switch(e){case n.SEARCH_ORDER_BY_TYPE.LAST_MODIFIED_TIME:return a.SortField.MODIFIED;case n.SEARCH_ORDER_BY_TYPE.RELEVANCE:default:return a.SortField.RELEVANCE}},t.sortDirectionToReverseOrder=function(e){switch(e){case a.SortDirection.ASCENDING:return n.SEARCH_REVERSE_ORDER_TYPE.TRUE;case a.SortDirection.DESCENDING:default:return n.SEARCH_REVERSE_ORDER_TYPE.FALSE}},t.reverseOrderToSortDirection=function(e){switch(e){case n.SEARCH_REVERSE_ORDER_TYPE.TRUE:return a.SortDirection.ASCENDING;case n.SEARCH_REVERSE_ORDER_TYPE.FALSE:default:return a.SortDirection.DESCENDING}},t.areSortOrdersEqual=function(e,t){return!e&&!t||!(!e||!t)&&(e.sortField===t.sortField&&e.sortDirection===t.sortDirection)},t.isTagsSuggestionData=e=>"tag_text"in e,t.normalizeForTagsSuggestions=function(e){const t=e.replace(/\#+/g,"").replace(/\ +/g," ").split(",");return t[t.length-1].trim()},t.updateQueryWithTagsSuggestion=function(e,t){return-1===e.indexOf(",")?`#${t}, `:`${e.substring(0,e.lastIndexOf(","))}, #${t}, `},t.isPopularFiltersSuggestionData=e=>"searchFilter"in e,t.extractQueryWithoutTags=function(e){return e?e.replace(/\#\w*[\s,]?/g,"").trim():""},t.handleTypeaheadSuggestionClicked=(i,s,n,o)=>{if("all"!==i){o&&o({type:i,query:t.extractQueryWithoutTags(s)});const a=s.match(/\#\w+[\s,]?/g);n({query:a?a.join(" "):""}),"metadata"===i&&r.__awaiter(void 0,void 0,void 0,(function*(){const{UserSurvey:t}=yield new Promise((t,r)=>{e(["modules/clean/user_survey/user_survey"],t,r)}).then(r.__importStar);t.trackEvent("organized_search_selected_metadata","search_bar")}))}},t.isQuerySuggestionData=e=>"text"in e,t.isPeopleSuggestionData=e=>"dbx_account_id"in e})),define("modules/clean/search/store_helpers",["require","exports"],(function(e,t){"use strict";function r(e){return e.trim().replace(/\ +/g," ")}function i(e){return!r(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.generateRandomId=t.shouldStartNewSearchSession=t.isBlank=t.normalize=void 0,t.normalize=r,t.isBlank=i,t.shouldStartNewSearchSession=function(e,t){return!(!i(e)||i(t))||(!(i(e)||!i(t))||e.length>=3&&1===t.length)},t.generateRandomId=function(){let e="";for(let t=0;t<32;t++){const t=Math.floor(10*Math.random());e+=String(t)}return e}})),define("modules/clean/search/types",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SuggestionSection=t.SearchFields=t.Dimensions=t.DateTaken=t.SearchBarDropdownHeaderItemType=t.SearchLockupVariants=t.FileCategory=t.TagsSuggestionsLoadingState=t.PopularFiltersSuggestionsLoadingState=t.PeopleSuggestionsLoadingState=t.QuerySuggestionsLoadingState=t.SearchResultTypes=void 0,t.SearchResultTypes={FILE:"FILE",FILE_SHARED_WITH_ME:"FILE_SHARED_WITH_ME",PAPER:"PAPER",PAPER_FOLDER:"PAPER_FOLDER"},(function(e){e.NOT_LOADED="NOT_LOADED",e.LOADING="LOADING",e.LOADED="LOADED",e.DISMISSED="DISMISSED",e.FAILED="FAILED"})(t.QuerySuggestionsLoadingState||(t.QuerySuggestionsLoadingState={})),(function(e){e.NOT_LOADED="NOT_LOADED",e.LOADING="LOADING",e.LOADED="LOADED",e.DISMISSED="DISMISSED",e.FAILED="FAILED"})(t.PeopleSuggestionsLoadingState||(t.PeopleSuggestionsLoadingState={})),(function(e){e.NOT_LOADED="NOT_LOADED",e.LOADING="LOADING",e.LOADED="LOADED",e.DISMISSED="DISMISSED",e.FAILED="FAILED"})(t.PopularFiltersSuggestionsLoadingState||(t.PopularFiltersSuggestionsLoadingState={})),(function(e){e.NOT_LOADED="NOT_LOADED",e.LOADING="LOADING",e.LOADED="LOADED",e.DISMISSED="DISMISSED",e.FAILED="FAILED"})(t.TagsSuggestionsLoadingState||(t.TagsSuggestionsLoadingState={})),(function(e){e.IMAGE="image",e.DOCUMENT="document",e.PDF="pdf",e.SPREADSHEET="spreadsheet",e.PRESENTATION="presentation",e.AUDIO="audio",e.VIDEO="video",e.FOLDER="folder",e.PAPER="paper",e.OTHER="other"})(t.FileCategory||(t.FileCategory={})),(function(e){e.OFF="OFF",e.CONTROL="CONTROL",e.A_V1="A_V1",e.A_V2="A_V2"})(t.SearchLockupVariants||(t.SearchLockupVariants={})),(function(e){e.SEARCH_ALL="SEARCH_ALL",e.SCOPE_CHIPS="SCOPE_CHIPS"})(t.SearchBarDropdownHeaderItemType||(t.SearchBarDropdownHeaderItemType={})),(function(e){e[e.Any=0]="Any",e[e.Today=1]="Today",e[e.Last7Days=2]="Last7Days",e[e.Last30Days=3]="Last30Days",e[e.Last90Days=4]="Last90Days",e[e.LastYear=5]="LastYear"})(t.DateTaken||(t.DateTaken={})),(function(e){e[e.Small=0]="Small",e[e.Medium=1]="Medium",e[e.Large=2]="Large",e[e.XLarge=3]="XLarge"})(t.Dimensions||(t.Dimensions={})),(function(e){e[e.FileName=0]="FileName",e[e.ImageMetadata=1]="ImageMetadata"})(t.SearchFields||(t.SearchFields={})),(function(e){e.PEOPLE="people",e.POPULAR="popular",e.QUERY="query",e.TAGS="tags"})(t.SuggestionSection||(t.SuggestionSection={}))})),define("modules/clean/react/maestro/layout/global_header/events",["require","exports","modules/clean/buffered_event_emitter/buffered_event_emitter"],(function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.globalHeaderBufferedEventEmitter=t.SEARCH_REQUEST_PROPS=t.SEARCH_SET_PROPS=t.NAV_TRIGGER_CLICK=void 0,t.NAV_TRIGGER_CLICK="NAV_TRIGGER_CLICK",t.SEARCH_SET_PROPS="SEARCH_SET_PROPS",t.SEARCH_REQUEST_PROPS="SEARCH_REQUEST_PROPS",window.ensemble&&!window.ensemble.globalHeaderEventEmitter&&(window.ensemble.globalHeaderEventEmitter=new r.BufferedEventEmitter),t.globalHeaderBufferedEventEmitter=window.ensemble&&window.ensemble.globalHeaderEventEmitter?window.ensemble.globalHeaderEventEmitter:new r.BufferedEventEmitter})),define("modules/clean/buffered_event_emitter/buffered_event_emitter",["require","exports","tslib","eventemitter3"],(function(e,t,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BufferedEventEmitter=void 0,i=r.__importDefault(i);class s extends i.default{constructor(){super(),this.allEventBuffers={}}on(e,t){super.on(e,t);const r=this.allEventBuffers[e.toString()];return void 0!==r&&r.forEach(t=>{this.emit(e,t)}),this}emit(e,t){return e=e.toString(),void 0===this.allEventBuffers[e]&&(this.allEventBuffers[e]=[]),this.allEventBuffers[e].push(t),super.emit(e,t)}reset(){this.allEventBuffers={},this.removeAllListeners()}resetBufferForEvent(e){this.allEventBuffers[e]=[],this.removeAllListeners(e)}}t.BufferedEventEmitter=s}));
//# sourceMappingURL=pkg-search-helpers.min.js-vfll-1fMs.map