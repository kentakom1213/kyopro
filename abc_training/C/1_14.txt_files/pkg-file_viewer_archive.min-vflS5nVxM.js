define("modules/clean/react/previews/archive/api",["require","exports","tslib","lodash","modules/clean/react/previews/archive/constants","api_v2/user_client","api_v2/noauth_client","modules/clean/filepath/filepath","modules/core/exception"],(function(e,t,r,o,n,i,s,a,l){"use strict";function c(e){return{name:e.name,size:void 0!==e.size?parseInt(e.size,10):void 0,isDir:e.isDir,children:e.children?(t=e.children,o.keyBy(o.values(t.map(c)),"name")):{}};var t}function d(e){const t=a.file_extension(e);if(!n.COMPRESSED_EXTENSIONS.includes(t))return!1;const r=a.filename_without_extension(e),o=a.file_extension(r);return!n.COMPRESSED_CONTAINER_EXTENSIONS.includes(o)}function u(e){return{isDir:!0,isEncrypted:!1,children:[{isDir:!1,isEncrypted:!1,name:a.filename_without_extension(e)}],name:"/",size:"0"}}Object.defineProperty(t,"__esModule",{value:!0}),t.fetchArchiveFiles=t.fetchRootArchiveEntry=t.generateRootArchiveEntry=t.shouldMockRootArchiveEntry=void 0,o=r.__importStar(o),n=r.__importStar(n),a=r.__importStar(a),l=r.__importStar(l),t.shouldMockRootArchiveEntry=d,t.generateRootArchiveEntry=u,t.fetchRootArchiveEntry=function(e){return new Promise((t,r)=>{const o=e=>{var r;t({rootEntry:c(r=e),isPasswordProtected:!!r.isEncrypted})};if(d(e.filename)){const t=u(e.filename);return void o(t)}const n=new XMLHttpRequest;n.open("GET",e.url),n.withCredentials=!0,n.onreadystatechange=()=>{if(n.readyState===XMLHttpRequest.DONE)if(200===n.status){const{response:e}=n,t=JSON.parse(e);o(t)}else{const e="Failed to retrieve entry tree";l.reportException({err:new Error(e),tags:["archivePreviews"],severity:l.SEVERITY.NONCRITICAL}),r(e)}},n.send()})},t.fetchArchiveFiles=function({rootFile:e,subpathInfos:t,user:r,sharedLinkUrl:n}){const a={root_file_info:{ns_id:e.ns_id,sj_id:e.sjid,url:n},subpaths:t.map(e=>e.subpath),subpath_sizes:t.some(e=>void 0===e.size)?void 0:t.map(e=>e.size)};return(r?(new i.UserApiV2Client).ns("previews").rpc("get_archive_files",a,{subjectUserId:r.id}):(new s.NoAuthApiV2Client).ns("previews").rpc("logged_out/get_archive_files",a,{})).then(e=>{return t=e.archive_files,o.keyBy(t,"subpath");var t})}})),define("modules/clean/react/previews/archive/app",["require","exports","tslib","react","modules/clean/previews/util","modules/clean/loggers/file_preview_logger","modules/clean/react/file_viewer/logging","modules/clean/file_store/utils","modules/clean/react/file_viewer/file_preview_event_emitter","modules/clean/react/file_viewer/constants","modules/clean/file_store/utils","modules/clean/react/file_viewer/location_utils","modules/clean/react/previews/archive/archive_entry_watcher","modules/clean/react/previews/archive/keyboard_binding_connector","modules/clean/react/previews/archive/utils","modules/clean/react/previews/archive/view","modules/clean/web_timing_logger","modules/clean/redux/constants","modules/clean/file_store/utils"],(function(e,t,r,o,n,i,s,a,l,c,d,u,p,m,h,f,_,g,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.App=void 0,o=r.__importDefault(o),a=r.__importStar(a),_=r.__importStar(_);class y extends o.default.Component{constructor(){super(...arguments),this.logger=null,this.onFetchSuccess=()=>{if(this.markWebTiming(),this.logFilePreviewTimeline(c.EventType.FilePreviewDownloadSucceeded),this.logFilePreviewTimeline(c.EventType.FilePreviewRenderSucceeded),this.props.entry){const e=h.scanEntryContents(this.props.entry);this.logArchivePreviewEvent(c.EventType.ArchivePreviewContentsScanned,e)}this.props.setRenderStatusSuccess()},this.onFetchFailure=()=>{this.logFilePreviewTimeline(c.EventType.FilePreviewDownloadFailed),this.props.onError&&this.props.onError()},this.handleEntryRowClick=(e,t)=>{e.preventDefault();const{fileSubpath:r}=this.props;if(t){const e=u.addToFileSubpath(r,t.name);u.updateFileSubpathQuery(e),this.logUserAction(t,c.UserAction.ArchiveNavigation,c.UserActionContext.PreviewContentMain)}}}componentDidMount(){this.setUpLogger(),this.fetchArchiveContents()}componentWillUnmount(){this.teardownLogger(),this.props.resetState(),u.updateFileSubpathQuery(null)}componentDidUpdate(e){if(v.areFilesEqual(e.rootFile,this.props.rootFile)&&e.previewUrl===this.props.previewUrl||(this.props.resetState(),this.fetchArchiveContents()),e.treeApiStatus===g.ApiClientStatus.Fetch)switch(this.props.treeApiStatus){case g.ApiClientStatus.Success:this.onFetchSuccess();break;case g.ApiClientStatus.Error:this.onFetchFailure()}}fetchArchiveContents(){if(this.logFilePreviewTimeline(c.EventType.FilePreviewSupportConfirmed),!this.props.previewUrl)return void(this.props.onError&&this.props.onError());this.logFilePreviewTimeline(c.EventType.FilePreviewDownloadAttempted);const e=h.getPreviewUrl(this.props.previewUrl),t=a.getFilename(this.props.rootFile);this.props.fetchRootArchiveEntry({url:e,filename:t})}setUpLogger(){this.logger&&this.teardownLogger(),this.logger=new i.FilePreviewArchiveLogger,this.logger.listenTo(l.filePreviewEventEmitter)}teardownLogger(){var e;null===(e=this.logger)||void 0===e||e.unlistenTo(l.filePreviewEventEmitter),this.logger=null}logFilePreviewTimeline(e){this.props.filePreviewSession&&this.props.filePreviewSession.recordEvent(e)}logArchivePreviewEvent(e,t={}){l.filePreviewEventEmitter.emit(e,this.props.filePreviewSession,t)}logUserAction(e,t,r){s.logUserAction(t,r,{isDir:e.isDir,extension:e.isDir?"":n.getWhitelistedExtension(e.name)})}markWebTiming(){this.props.filePreviewSession&&this.props.filePreviewSession.markPrimaryEvent(),_.mark_time_to_view(),_.mark_time_to_interactive()}render(){return o.default.createElement("div",null,o.default.createElement(f.View,{entry:this.props.entry,fileExtension:d.getExtension(this.props.rootFile),isPasswordProtected:this.props.isPasswordProtected,onEntryRowClick:this.handleEntryRowClick,rootFile:this.props.rootFile,currentSubpath:this.props.fileSubpath,encryptionOptions:this.props.encryptionOptions,user:this.props.user,sharePermission:this.props.sharePermission,shareToken:this.props.shareToken}),o.default.createElement(p.ArchiveEntryWatcher,{rootFile:this.props.rootFile,fileSubpath:this.props.fileSubpath,sharedLinkUrl:this.props.sharedLinkUrl,user:this.props.user}),o.default.createElement(m.ArchiveKeyboardBindingConnector,{fileSubpath:this.props.fileSubpath}))}}t.App=y,y.displayName="App"})),define("modules/clean/react/previews/archive/archive_entry_watcher",["require","exports","tslib","react","react-redux","modules/clean/react/previews/archive/data/actions","modules/clean/react/previews/archive/data/selectors","modules/clean/react/previews/archive/utils"],(function(e,t,r,o,n,i,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ArchiveEntryWatcher=t.UnconnectedArchiveEntryWatcher=void 0,o=r.__importDefault(o);class l extends o.default.Component{constructor(){super(...arguments),this.fetchArchiveFiles=e=>{const{fetchArchiveFiles:t,rootFile:r,sharedLinkUrl:o,user:n}=this.props;t({rootFile:r,subpathInfos:e,sharedLinkUrl:o,user:n})}}componentDidUpdate(){const{neededSubpathInfos:e}=this.props;e.length&&this.fetchArchiveFiles(e)}render(){return null}}t.UnconnectedArchiveEntryWatcher=l,l.displayName="UnconnectedArchiveEntryWatcher";const c=s.makeGetArchiveEntry();const d={fetchArchiveFiles:i.fetchArchiveFiles};t.ArchiveEntryWatcher=n.connect((function(e,{rootFile:t,fileSubpath:r}){const o=c(e,{fileSubpath:r,rootFile:t});return{neededSubpathInfos:a.getNeededArchiveFileSubpathInfos(r,o).filter(t=>s.getShouldFetchArchiveFiles(e,{subpath:t.subpath}))}}),d)(l)})),define("modules/clean/react/previews/archive/constants",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.COMPRESSED_CONTAINER_EXTENSIONS=t.COMPRESSED_EXTENSIONS=t.MAX_ROW_WIDTH_IN_EMS=t.DEFAULT_NUM_ROWS=void 0,t.DEFAULT_NUM_ROWS=10,t.MAX_ROW_WIDTH_IN_EMS=17,t.COMPRESSED_EXTENSIONS=["bz","bz2","gz","lz","lzma","xz","z"],t.COMPRESSED_CONTAINER_EXTENSIONS=["tar","xar"]})),define("modules/clean/react/previews/archive/data/actions",["require","exports","tslib","lodash","modules/clean/react/previews/archive/api","modules/clean/previews/data/actions"],(function(e,t,r,o,n,i){"use strict";var s;function a(){return{type:s.GetTreeApiFetch}}function l({entry:e,isPasswordProtected:t}){return{type:s.GetTreeApiSuccess,payload:{entry:e,isPasswordProtected:t}}}function c(e){return{type:s.GetTreeApiError,payload:{error:e}}}function d({subpaths:e}){return{type:s.GetArchiveFilesApiFetch,meta:{subpaths:e}}}function u(e){return{type:s.GetArchiveFilesApiSuccess,payload:{archiveFiles:e}}}function p(e,{subpaths:t}){return{type:s.GetArchiveFilesApiError,meta:{subpaths:t},error:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.fetchArchiveFiles=t.fetchRootArchiveEntry=t.resetState=t.getArchiveFilesApiError=t.getArchiveFilesApiSuccess=t.getArchiveFilesApiFetch=t.getTreeApiError=t.getTreeApiSuccess=t.getTreeApiFetch=t.Actions=void 0,n=r.__importStar(n),(function(e){e.ResetState="ArchivePreviewResetState",e.GetTreeApiFetch="ArchivePreviewGetTreeApiFetch",e.GetTreeApiSuccess="ArchivePreviewGetTreeApiSuccess",e.GetTreeApiError="ArchivePreviewGetTreeApiError",e.GetArchiveFilesApiFetch="ArchivePreviewGetArchiveFilesApiFetch",e.GetArchiveFilesApiSuccess="ArchivePreviewGetArchiveFilesApiSuccess",e.GetArchiveFilesApiError="ArchivePreviewGetArchiveFilesApiError"})(s=t.Actions||(t.Actions={})),t.getTreeApiFetch=a,t.getTreeApiSuccess=l,t.getTreeApiError=c,t.getArchiveFilesApiFetch=d,t.getArchiveFilesApiSuccess=u,t.getArchiveFilesApiError=p,t.resetState=function(){return{type:s.ResetState}},t.fetchRootArchiveEntry=function(e){return t=>{t(a()),n.fetchRootArchiveEntry(e).then(({rootEntry:e,isPasswordProtected:r})=>{t(l({entry:e,isPasswordProtected:r}))}).catch(e=>{t(c(e))})}},t.fetchArchiveFiles=function({rootFile:e,sharedLinkUrl:t,subpathInfos:r,user:s}){const a=r.map(e=>e.subpath);return l=>(l(d({subpaths:a})),n.fetchArchiveFiles({rootFile:e,sharedLinkUrl:t,subpathInfos:r,user:s}).then(t=>(l(u(t)),l(i.populateArchivePreviews(e,o.values(t))),t)).catch(e=>(l(p(e,{subpaths:a})),e)))}})),define("modules/clean/react/previews/archive/data/reducer",["require","exports","modules/clean/react/previews/archive/data/actions","modules/clean/redux/constants"],(function(e,t,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.previewArchiveReducer=t.initialState=void 0,t.initialState={archiveFiles:{},rootEntry:void 0,treeApiStatus:void 0,error:void 0},t.previewArchiveReducer=function(e=t.initialState,n){switch(n.type){case r.Actions.GetTreeApiFetch:return Object.assign(Object.assign({},e),{treeApiStatus:o.ApiClientStatus.Fetch});case r.Actions.GetTreeApiSuccess:return Object.assign(Object.assign({},e),{rootEntry:n.payload.entry,isPasswordProtected:n.payload.isPasswordProtected,treeApiStatus:o.ApiClientStatus.Success});case r.Actions.GetTreeApiError:return Object.assign(Object.assign({},e),{treeApiStatus:o.ApiClientStatus.Error,error:n.payload.error});case r.Actions.GetArchiveFilesApiFetch:return Object.assign(Object.assign({},e),{archiveFiles:Object.assign(Object.assign({},e.archiveFiles),n.meta.subpaths.reduce((e,t)=>(e[t]={archiveFile:void 0,apiStatus:o.ApiClientStatus.Fetch},e),{}))});case r.Actions.GetArchiveFilesApiSuccess:const i=n.payload.archiveFiles,s={};for(const e of Object.keys(i))s[e]={archiveFile:i[e],apiStatus:o.ApiClientStatus.Success};return Object.assign(Object.assign({},e),{archiveFiles:Object.assign(Object.assign({},e.archiveFiles),s)});case r.Actions.GetArchiveFilesApiError:return Object.assign(Object.assign({},e),{archiveFiles:Object.assign({},n.meta.subpaths.reduce((e,t)=>(e[t]={archiveFile:void 0,apiStatus:o.ApiClientStatus.Error,error:n.error},e),{}))});case r.Actions.ResetState:return t.initialState;default:return e}}})),define("modules/clean/react/previews/archive/data/selectors",["require","exports","tslib","lodash","reselect","modules/clean/react/previews/archive/data/utils","modules/clean/redux/constants","modules/clean/redux/namespaces"],(function(e,t,r,o,n,i,s,a){"use strict";function l(e){return e[a.PREVIEW_ARCHIVE_NAMESPACE_KEY]}Object.defineProperty(t,"__esModule",{value:!0}),t.getTreeApiStatus=t.isErrorStateForSubpath=t.getShouldFetchArchiveFiles=t.makeGetArchiveEntry=t.getEncryptedStatus=void 0,o=r.__importStar(o),t.getEncryptedStatus=e=>l(e).isPasswordProtected;const c=(e,{subpath:t})=>{const r=((e,t)=>{const r=l(e).archiveFiles;if(r)return r[t]})(e,t);if(r)return r.apiStatus},d=e=>l(e).rootEntry,u=o.flow(l,e=>o.get(e,"archiveFiles",{}));function p(e,t,r){const{fileSubpath:o,rootFile:n}=r;if(!e)return e;const s=o?i.walkEntryTree(e,o):e;return i.getEntryWithArchiveFiles({subpath:o,rootFile:n,entry:s,archiveFilesMap:t})}t.makeGetArchiveEntry=function(){return n.createSelector([d,u,(e,t)=>t],p)},t.getShouldFetchArchiveFiles=(e,{subpath:t})=>{if(!t)return!1;const r=c(e,{subpath:t});return!r||![s.ApiClientStatus.Fetch,s.ApiClientStatus.Error].includes(r)},t.isErrorStateForSubpath=(e,{subpath:t})=>{if(!t)return!1;return c(e,{subpath:t})===s.ApiClientStatus.Error},t.getTreeApiStatus=e=>l(e).treeApiStatus})),define("modules/clean/react/previews/archive/data/store",["require","exports","modules/clean/react/previews/archive/data/reducer","modules/clean/redux/namespaces","modules/clean/redux/store"],(function(e,t,r,o,n){"use strict";let i;Object.defineProperty(t,"__esModule",{value:!0}),t.getStoreForPreviewArchive=void 0,t.getStoreForPreviewArchive=function(){return i||(i=n.getStoreAndRegisterReducers({[o.PREVIEW_ARCHIVE_NAMESPACE_KEY]:r.previewArchiveReducer})),i}})),define("modules/clean/react/previews/archive/data/utils",["require","exports","tslib","lodash","modules/clean/react/file_viewer/location_utils","modules/clean/react/previews/archive/utils"],(function(e,t,r,o,n,i){"use strict";function s({subpath:e,entry:t,rootFile:r,archiveFilesMap:o}){if(t.isDir||!e)return t;const n=o[e]&&o[e].archiveFile;return Object.assign(Object.assign({},t),{file:i.createFileFromEntryAndApi(t,r,n)})}Object.defineProperty(t,"__esModule",{value:!0}),t.getEntryWithArchiveFiles=t.walkEntryTree=void 0,o=r.__importStar(o),t.walkEntryTree=function(e,t){const r=t.substring(1).split("/");let o=e,i="";for(;r.length;){const e=r.shift(),s=e?o.children[e]:void 0;if(!s)return i!==t&&n.updateFileSubpathQuery(i),o;o=s,i+=`/${e}`}return o},t.getEntryWithArchiveFiles=function(e){return e.entry.isDir?(function({subpath:e,entry:t,rootFile:r,archiveFilesMap:i}){const a=o.mapValues(t.children,(t,o)=>s({subpath:n.addToFileSubpath(e,o),entry:t,rootFile:r,archiveFilesMap:i}));return Object.assign(Object.assign({},t),{children:a})})(e):s(e)}})),define("modules/clean/react/previews/archive/entry_row",["require","exports","tslib","react","spectrum/file_icon/index","spectrum/icon_content/index","spectrum/media_table/index","modules/clean/display_format","modules/clean/em_string","modules/clean/react/previews/archive/constants","modules/clean/react/previews/archive/utils","modules/clean/react/thumbnail"],(function(e,t,r,o,n,i,s,a,l,c,d,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EntryRow=void 0,o=r.__importDefault(o);class p extends o.default.Component{constructor(){super(...arguments),this.handleClick=e=>{e.stopPropagation(),this.props.onClick&&this.props.onClick(e,this.props.entry)}}render(){const{entry:e,shouldHideSize:t,topOffset:r}=this.props;return this.props.onClick?o.default.createElement(s.CulledMediaRow,{topOffset:r,onClick:this.handleClick,doubleLine:!0},({isHovered:r})=>m({entry:e,highlight:r,onClick:this.handleClick,shouldHideSize:t})):o.default.createElement(s.CulledMediaRow,{topOffset:r,doubleLine:!0},m({entry:e,shouldHideSize:t}))}}t.EntryRow=p,p.displayName="EntryRow";const m=({entry:e,onClick:t,highlight:r,shouldHideSize:n})=>{const i=l.Emstring.em_snippet(e.name,c.MAX_ROW_WIDTH_IN_EMS),d=[o.default.createElement(s.MediaCell,{key:"rowname",title:t?o.default.createElement("button",{className:"entry-row-button",onClick:t,"aria-label":e.name},i):i,icon:o.default.createElement(h,{displayName:e.name,file:e.file,isDir:e.isDir}),highlight:r})];return e.size&&!n&&d.push(o.default.createElement(s.MediaCell,{key:"rowsize",title:a.format_bytes(e.size)})),d},h=e=>e.isDir?o.default.createElement(i.IconContent,{name:"folder-small"}):e.file&&d.shouldAllowVisualFolderIcons()?o.default.createElement(u.ThumbnailIcon,{className:"entry-row-icon",file:e.file,alt:e.displayName}):o.default.createElement(n.FileIcon,{path:e.displayName})})),define("modules/clean/react/previews/archive/file_entry_view",["require","exports","tslib","react","classnames","modules/clean/react/file_viewer/data/selectors","modules/clean/redux/constants","modules/clean/react/previews/loading_indicator","modules/clean/react/file_viewer/file_preview","modules/clean/react/file_viewer/constants","modules/clean/react/size_class/size_class","modules/clean/react/previews/constants","modules/clean/previews/constants","react-redux","modules/clean/react/previews/archive/data/selectors","modules/clean/react/previews/archive/utils","modules/clean/react/size_class/constants","modules/clean/previews/data/selectors"],(function(e,t,r,o,n,i,s,a,l,c,d,u,p,m,h,f,_,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FileEntryView=t._FileEntryView=t.PreviewTypeWhitelist=void 0,o=r.__importDefault(o),n=r.__importDefault(n),t.PreviewTypeWhitelist=[p.PreviewType.SsrDoc,p.PreviewType.Excel,p.PreviewType.HTML,p.PreviewType.Image,p.PreviewType.RawHTML],t._FileEntryView=({entry:e,extensionsEnabled:r,previewApiData:n,isErrorState:i,isFullscreen:a,isSidebarOpen:d,sidebar:p,sizeClass:m,rootFile:h,encryptionOptions:g})=>{const{file:v}=e,b=m!==_.SizeClass.Small,w={canCopyToDropboxRoles:[],canDownloadRoles:[],canPrintRoles:[],canRemoveLinkUids:[],canSyncToDropboxRoles:[],canViewContextMenuRoles:[],canViewMetadataRoles:[]};return v?o.default.createElement(l.FilePreviewWithLogging,{extensionsEnabled:r,file:v,isFullscreen:a,isSidebarOpen:d,sidebar:p,sourceAction:u.PreviewSourceAction.Click,sourceContext:u.PreviewSourceContext.ArchiveFile,maxFilenameEmLength:c.SizeClassFilenameLengthMap[m],previewTypeWhitelist:t.PreviewTypeWhitelist,sharePermission:w,shouldDisplayToolbar:b,previewApiData:n,sizeClass:m,encryptionOptions:g}):i?o.default.createElement(l.FilePreview,{extensionsEnabled:r,file:f.createFileFromEntry(e,h),previewApiData:{data:void 0,status:s.ApiClientStatus.Error},isFullscreen:a,isSidebarOpen:d,sidebar:p,sourceAction:u.PreviewSourceAction.Click,sourceContext:u.PreviewSourceContext.ArchiveFile,maxFilenameEmLength:c.SizeClassFilenameLengthMap[m],previewTypeWhitelist:t.PreviewTypeWhitelist,sharePermission:w,shouldDisplayToolbar:b,sizeClass:m,encryptionOptions:g}):o.default.createElement(y,null)};const v=d.withSizeClass(t._FileEntryView,{responsiveClassName:"preview-content--full-height"});t.FileEntryView=m.connect((e,t)=>({previewApiData:g.getPreviewForArchiveFile(e,t.entry.file),extensionsEnabled:i.getExtensionsEnabled(e),isFullscreen:i.getIsFullScreen(e),isSidebarOpen:i.getIsSidebarOpen(e),isErrorState:h.isErrorStateForSubpath(e,{subpath:t.currentSubpath}),sidebar:i.getSidebar(e)}))(v);const y=()=>o.default.createElement("div",{className:n.default("preview-content","preview-content--center","preview-content--full-height")},o.default.createElement(a.LoadingIndicator,null))})),define("modules/clean/react/previews/archive/folder_entry_view",["require","exports","tslib","react","classnames","lodash","spectrum/icon_content/index","spectrum/dimensions/index","spectrum/table/index","modules/clean/react/previews/archive/entry_row","modules/clean/react/size_class/size_class","modules/clean/react/size_class/constants","modules/core/i18n","modules/clean/react/file_viewer/file_conversion/utils"],(function(e,t,r,o,n,i,s,a,l,c,d,u,p,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FolderEntryView=void 0,o=r.__importDefault(o),n=r.__importDefault(n),i=r.__importStar(i),t.FolderEntryView=e=>{const{entry:t,onEntryRowClick:r,shouldAllowFileNavigation:n,file:s,user:a,sharePermission:l,shareToken:c}=e,d=i.values(t.children),u=d.length?o.default.createElement(f,{entries:d,onRowClick:r,shouldAllowFileNavigation:n}):o.default.createElement(_,null),p=m.getConversionsForPreview(s,a,c,l);return o.default.createElement(o.default.Fragment,null,p,u)};class h extends o.default.Component{constructor(){super(...arguments),this.renderEntryRow=(e,t,r)=>{const n=this.props.shouldAllowFileNavigation||e.isDir?this.props.onRowClick:void 0;return o.default.createElement(c.EntryRow,{entry:e,onClick:n,shouldHideSize:this.props.sizeClass===u.SizeClass.Small,topOffset:r})}}render(){return o.default.createElement(a.Dimensions,{className:"preview-archive__table"},({width:e,height:t})=>o.default.createElement(l.Table,null,o.default.createElement(l.FixedTableHead,null,o.default.createElement(l.TableHeadCell,null,p.intl.formatMessage({id:"cJojIg",defaultMessage:"Name"})),this.props.sizeClass===u.SizeClass.Small?null:o.default.createElement(l.TableHeadCell,null,p.intl.formatMessage({id:"txUjQq",defaultMessage:"Size"}))),o.default.createElement(l.CulledTableBody,{items:this.props.entries,listItemHeight:72,renderRow:this.renderEntryRow,viewportHeight:t,shouldUseWindowAsScrollContainer:!1})))}}h.displayName="InternalFolderListView";const f=d.withSizeClass(h,{responsiveClassName:"preview-content--full-height"}),_=()=>o.default.createElement("div",{className:n.default("preview-content","preview-content--center","preview-content--column","preview-content--full-height","preview-archive--empty")},o.default.createElement(s.IconContent,{name:"folder-small"}),o.default.createElement("div",{className:"empty-text u-pad-top-s"},p.intl.formatMessage({id:"YLBqRL",defaultMessage:"This folder is empty"})))})),define("modules/clean/react/previews/archive/keyboard_binding_connector",["require","exports","tslib","react","ts-keycode-enum","modules/clean/react/file_viewer/location_utils","modules/clean/react/keyboard_binding/keyboard_binding","modules/clean/react/keyboard_binding/keyboard_binding_connector"],(function(e,t,r,o,n,i,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ArchiveKeyboardBindingConnector=void 0,o=r.__importDefault(o);class l extends o.default.Component{constructor(){super(...arguments),this.handleKeyPress=()=>{const e=i.shortenFileSubpathBy(this.props.fileSubpath,1);return i.updateFileSubpathQuery(e),!0},this.keyboardBindings=[{keyboardEventCriteria:s.generateUnmodifiedKeyboardEventCriteria(n.Key.Escape),callback:this.handleKeyPress}]}render(){return o.default.createElement(a.KeyboardBindingConnector,{keyboardBindings:this.keyboardBindings})}}t.ArchiveKeyboardBindingConnector=l,l.displayName="ArchiveKeyboardBindingConnector"})),define("modules/clean/react/previews/archive/preview_archive",["require","exports","tslib","react","react-redux","modules/clean/react/previews/archive/app","modules/clean/react/previews/archive/data/selectors","modules/clean/react/previews/archive/data/store","modules/clean/react/previews/archive/data/actions","modules/clean/react/components/css"],(function(e,t,r,o,n,i,s,a,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PreviewArchiveForTesting=t.PreviewArchive=void 0,o=r.__importDefault(o);const d=s.makeGetArchiveEntry();const u={fetchRootArchiveEntry:l.fetchRootArchiveEntry,resetState:l.resetState},p=n.connect((function(e,t){return{entry:d(e,{fileSubpath:t.fileSubpath,rootFile:t.rootFile}),isPasswordProtected:s.getEncryptedStatus(e),treeApiStatus:s.getTreeApiStatus(e)}}),u)(i.App);t.PreviewArchiveForTesting=p;const m=a.getStoreForPreviewArchive(),h=c.requireCssWithComponent(e=>o.default.createElement(n.Provider,{store:m},o.default.createElement(p,Object.assign({},e))),["/static/css/preview_archive-vflWyumo_.css"]);t.PreviewArchive=h})),define("modules/clean/react/previews/archive/utils",["require","exports","tslib","lodash","modules/clean/react/file_viewer/location_utils","modules/clean/previews/util","modules/core/uri"],(function(e,t,r,o,n,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getNeededArchiveFileSubpathInfos=t.createFileFromEntryAndApi=t.createFileFromEntry=t.scanEntryContents=t.shouldAllowVisualFolderIcons=t.getPreviewUrl=void 0,o=r.__importStar(o),t.getPreviewUrl=function(e){let t=s.URI.parse(e.toString()).toString();return"//"===t.slice(0,2)&&(t=`https:${t}`),t},t.shouldAllowVisualFolderIcons=()=>!1,t.scanEntryContents=function(e){const t={},r=[e];for(;r.length;){const e=r.shift();if(e.isDir)r.push(...o.values(e.children));else{const r=i.getWhitelistedExtension(e.name);t[r]=++t[r]||1}}return t},t.createFileFromEntry=function(e,t){return{subpath:e.name,is_dir:!1,filename:e.name,ns_id:t.ns_id,sjid:t.sjid,bytes:e.size,sort_key:void 0,href:void 0,ts:void 0,file_id:void 0,revision_id:void 0,is_symlink:!1}},t.createFileFromEntryAndApi=function(e,t,r){if(r)return{bytes:e.size,file_id:void 0,filename:r.filename,href:void 0,is_dir:!1,ns_id:t.ns_id,revision_id:void 0,sjid:t.sjid,sort_key:void 0,subpath:r.subpath,thumbnail_url_tmpl:r.thumbnail_url_tmpl,ts:void 0,is_symlink:!1,preview:r.preview}},t.getNeededArchiveFileSubpathInfos=function(e,t){return t?t.isDir||t.file||!e?o.values(t.children).filter(e=>!e.isDir&&!e.file).map(t=>({subpath:n.addToFileSubpath(e,t.name),size:t.size})):[{subpath:e,size:t.size}]:[]}})),define("modules/clean/react/previews/archive/view",["require","exports","tslib","react","spectrum/media_table_skeleton/index","spectrum/snackbar/index","modules/clean/react/async/loadable","modules/clean/react/previews/archive/folder_entry_view","modules/clean/react/previews/archive/constants","modules/core/i18n"],(function(e,t,r,o,n,i,s,a,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.View=void 0,o=r.__importDefault(o);const d=s.Loadable({loader:()=>new Promise((t,r)=>{e(["modules/clean/react/previews/archive/file_entry_view"],t,r)}).then(r.__importStar).then(({FileEntryView:e})=>e)});t.View=e=>{const{entry:t,rootFile:r,fileExtension:n,isPasswordProtected:s,onEntryRowClick:a,currentSubpath:l,encryptionOptions:d,user:m,sharePermission:h,shareToken:f}=e;return o.default.createElement("div",{className:"preview-archive"},o.default.createElement("div",{className:"preview-archive__content"},t?o.default.createElement(u,{entry:t,rootFile:r,shouldAllowFileNavigation:!s,onEntryRowClick:a,currentSubpath:l,encryptionOptions:d,user:m,sharePermission:h,shareToken:f}):o.default.createElement(p,null),s?o.default.createElement(i.Snackbar,{title:c.intl.formatMessage({id:"xONQyk",defaultMessage:"Can’t preview items in password-protected {extension} files."},{extension:`.${n}`}),variant:"warn"}):null))};const u=e=>e.entry.isDir?o.default.createElement(a.FolderEntryView,{entry:e.entry,onEntryRowClick:e.onEntryRowClick,shouldAllowFileNavigation:e.shouldAllowFileNavigation,file:e.rootFile,user:e.user,sharePermission:e.sharePermission,shareToken:e.shareToken}):o.default.createElement(d,{entry:e.entry,rootFile:e.rootFile,currentSubpath:e.currentSubpath,encryptionOptions:e.encryptionOptions}),p=()=>o.default.createElement("div",{className:"preview-archive__table"},o.default.createElement(n.MediaTableSkeleton,{numRows:l.DEFAULT_NUM_ROWS}))})),define("modules/clean/react/share_download/copy_to_dropbox/actions",["require","exports","tslib","modules/clean/react/share_download/copy_to_dropbox/api","modules/core/browser"],(function(e,t,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.copySharedFile=void 0,o=r.__importStar(o),n=r.__importStar(n),t.copySharedFile=function(e,t){return r.__awaiter(this,void 0,void 0,(function*(){const r=yield o.copySharedFile(e,t);n.redirect(r)}))}})),define("modules/clean/react/share_download/copy_to_dropbox/api",["require","exports","tslib","modules/clean/deprecated_ajax/ajax_as_promised_jquery"],(function(e,t,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.copySharedFile=void 0,o=r.__importStar(o),t.copySharedFile=function(e,t){const r={link_key:e.linkKey,link_type:e.linkType,secure_hash:e.secureHash,subpath:e.subPath,rlkey:e.rlkey};return e.itemId&&(r.item_id=e.itemId),new Promise((e,n)=>o.WebProgressRequest({url:"/sm/c2d",data:r,subject_user:t,success:e}))}})),define("modules/clean/react/share_download/copy_to_dropbox/modal",["require","exports","tslib","react","modules/clean/analytics","modules/clean/em_string","modules/clean/filepath/filepath","modules/clean/react/share_download/copy_to_dropbox/actions","modules/clean/react/components/modal","modules/clean/share_download/types","modules/clean/react/share_download/utils","modules/clean/viewer","modules/core/i18n","modules/core/notify","modules/clean/loggers/folder_preview_logger","modules/clean/react/file_viewer/constants","modules/clean/react/file_viewer/logging"],(function(e,t,r,o,n,i,s,a,l,c,d,u,p,m,h,f,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CopyToDropboxModal=void 0,o=r.__importDefault(o),s=r.__importStar(s);class g extends o.default.Component{constructor(){super(...arguments),this.handleAccept=()=>{var e,t;null===(t=(e=this.props).onAccept)||void 0===t||t.call(e);const r=(function(e){const t=u.Viewer.get_viewer();if(t.is_paired)switch(e){case"personal":return p.intl.formatMessage({id:"9Q/1TS",defaultMessage:"Saving to your personal Dropbox..."});case"work":return p.intl.formatMessage({id:"5wQTp4",defaultMessage:"Saving to your {team_name} Dropbox..."},{team_name:t.team_name})}return p.intl.formatMessage({id:"vFhcfF",defaultMessage:"Saving to your Dropbox..."})})(this.props.role);m.Notify.success(r),a.copySharedFile(this.props.shareToken,this.props.userId),this.props.folderPreviewSession?h.logEvent(f.UserAction.SaveToDropboxApprove,this.props.folderPreviewSession):_.logUserAction(f.UserAction.SaveToDropboxApprove,f.UserActionContext.Unknown)},this.handleDismiss=e=>{var t,r;null===(r=(t=this.props).onDismiss)||void 0===r||r.call(t,e),this.props.folderPreviewSession?h.logEvent(f.UserAction.SaveToDropboxCancel,this.props.folderPreviewSession):_.logUserAction(f.UserAction.SaveToDropboxCancel,f.UserActionContext.Unknown)}}componentDidMount(){n.WebMiscActivityLogger.log("show-c2d-modal")}render(){const{copyable:e,role:t}=this.props,r=d.getCopyableName(e),n=d.getCopyableType(e);return o.default.createElement(l.Modal,{title:v(r,t),acceptButtonText:p.intl.formatMessage({id:"78AHo5",defaultMessage:"Save"}),dismissButtonText:p.intl.formatMessage({id:"d9/SE1",defaultMessage:"Cancel"}),onAccept:this.handleAccept,onDismiss:this.handleDismiss,style:"default-maestro"},o.default.createElement("p",{className:"db-modal-message"},(function(e,t,r){const n=u.Viewer.get_viewer(),a=n.get_user_by_role(t);if(e=i.Emstring.em_snippet(e,15),a&&a.is_cdm_member)return p.intl.formatMessage({id:"3Sb6Ws",defaultMessage:"<strong>{name}</strong> will be saved to the <strong>{cdm_tmf_name}</strong> folder in your {team_name} Dropbox account."},{name:e,cdm_tmf_name:s.filename(a.cdm_tmf_path),team_name:n.team_name,strong:e=>o.default.createElement("strong",null,e)});if(n.is_paired)switch(t){case"personal":return p.intl.formatMessage({id:"nBgj3Q",defaultMessage:"<strong>{name}</strong> will be saved to your personal Dropbox account and synced to any connected devices."},{name:e,strong:e=>o.default.createElement("strong",null,e)});case"work":switch(r){case c.CopyableType.Collection:return p.intl.formatMessage({id:"2yp43H",defaultMessage:"This album will be instantly saved to your {team_name} Dropbox and downloaded to all the computers linked to your {team_name} account."},{team_name:n.team_name});case c.CopyableType.Folder:return p.intl.formatMessage({id:"eJs/IE",defaultMessage:"This folder will be instantly saved to your {team_name} Dropbox and downloaded to all the computers linked to your {team_name} account."},{team_name:n.team_name});default:return p.intl.formatMessage({id:"Kb1en/",defaultMessage:"This file will be instantly saved to your {team_name} Dropbox and downloaded to all the computers linked to your {team_name} account."},{team_name:n.team_name})}}switch(r){case c.CopyableType.Collection:return p.intl.formatMessage({id:"35MZFn",defaultMessage:"This album will be instantly saved to your Dropbox and downloaded to all the computers linked to your account."});case c.CopyableType.Folder:return p.intl.formatMessage({id:"qkudum",defaultMessage:"This folder will be instantly saved to your Dropbox and downloaded to all the computers linked to your account."});default:return p.intl.formatMessage({id:"uGDUlE",defaultMessage:"This file will be instantly saved to your Dropbox and downloaded to all the computers linked to your account."})}})(r,t,n)))}}function v(e,t){const r=u.Viewer.get_viewer(),o=r.get_user_by_role(t);if(o&&o.is_cdm_member)return p.intl.formatMessage({id:"yHgTUN",defaultMessage:"Save to your member folder?"});if(r.is_paired)switch(t){case"personal":return p.intl.formatMessage({id:"fI7sAv",defaultMessage:"Save to your personal Dropbox account?"});case"work":{const t=r.team_name,o=new i.Emstring(t||"").length,n=Math.max(10,15-o);return p.intl.formatMessage({id:"5SXeZ6",defaultMessage:"Save ‘{name}’ to my {team_name} Dropbox"},{name:i.Emstring.em_snippet(e,n),team_name:t})}}return p.intl.formatMessage({id:"ktpG9L",defaultMessage:"Save ‘{name}’ to my Dropbox"},{name:i.Emstring.em_snippet(e,15)})}t.CopyToDropboxModal=g,g.displayName="CopyToDropboxModal"})),define("modules/clean/react/share_download/actions",["require","exports","tslib","react","modules/clean/auth/login_or_register/types","modules/clean/analytics","modules/clean/downloads","modules/clean/react/share_download/copy_to_dropbox/modal","modules/clean/react/components/modal","modules/clean/react/share_download/api","modules/clean/react/share_download/api","modules/core/persistence/storage","modules/clean/viewer","modules/core/assert","modules/core/browser","modules/core/exception","modules/core/i18n","modules/core/notify","spectrum-sharing/utils/sharing_constants"],(function(e,t,r,o,n,i,s,a,l,c,d,u,p,m,h,f,_,g,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.authModalHelpers=t.toDropbox=t.direct=void 0,o=r.__importDefault(o),s=r.__importStar(s),c=r.__importStar(c),h=r.__importStar(h),t.direct=function(e,o,n,i,a){return r.__awaiter(this,void 0,void 0,(function*(){const{downloadTestUrl:r,url:l}=e;if(n||f.reportException({err:new Error("No encryption options provided for direct download action"),severity:"non-critical",tags:["sharing-encryption-options"]}),yield t.authModalHelpers.authenticateForDownload(o||null,n),r)try{yield c.testDownload(r,i)}catch(e){return void(e instanceof d.TooLargeError?g.Notify.error(_.intl.formatMessage({id:"pcsTpL",defaultMessage:"The zip file is too large."})):g.Notify.error(_.intl.formatMessage({id:"pllUQE",defaultMessage:"Failed to download zip file."})))}try{const e=yield c.fetchDownloadUrl(l,i,a);s.get({url:e})}catch(e){g.Notify.error(_.intl.formatMessage({id:"6OUwIN",defaultMessage:"Failed to download."}))}}))},t.toDropbox=function(e,n,s,c,d,u,_,g){return r.__awaiter(this,void 0,void 0,(function*(){let r,y=!1;const b=h.get_href();let w;if(w=e.linkType===v.SharedLinkType.Shmodel?{tkey:e.linkKey,url:b}:{scl_url:b,sckey:e.linkKey,rlkey:e.rlkey,ns_id:(null==u?void 0:u.ns_id)?null==u?void 0:u.ns_id.toString():void 0},"anonymous"===s)d||f.reportException({err:new Error("No encryption options provided for anonymous sharing action"),severity:"non-critical",tags:["sharing-encryption-options"]}),i.ShareTibEventLogger.log_unauth("VIEW_AUTH_PAGE",v.SHARE_ACTION_ORIGIN_TYPE.PREVIEW_PAGE,w),r=yield t.authModalHelpers.authenticateForSaveToDropbox(e.linkType,d,w),y=!0;else{r=c?c.id:-1,m.assert(-1!==r,"role isn't anonymous => user cannot be null or undefined!"),p.Viewer.get_viewer().is_user_signed_in(c)||(d||f.reportException({err:new Error("No encryption options provided for multiaccount sharing action"),severity:"non-critical",tags:["sharing-encryption-options"]}),i.ShareTibEventLogger.log_unauth("VIEW_AUTH_PAGE",v.SHARE_ACTION_ORIGIN_TYPE.PREVIEW_PAGE,w),yield t.authModalHelpers.doMultiAccountAuthentication(s,d))}l.Modal.showInstance(o.default.createElement(a.CopyToDropboxModal,{shareToken:e,copyable:n,userId:r,role:s,onDismiss:e=>{null==g||g(),y&&h.reload(e)},onAccept:()=>{null==_||_()},folderPreviewSession:u}))}))},t.authModalHelpers={authenticateForDownload:(t,i)=>t!==n.LoginOrRegisterKind.DOWNLOAD||u.LocalStorage.get("has_seen_download_signup_modal")?Promise.resolve():new Promise((s,a)=>{const c=()=>{u.LocalStorage.set("has_seen_download_signup_modal",!0),s()},d=()=>{u.LocalStorage.set("has_seen_download_signup_modal",!0),a()};new Promise((t,r)=>{e(["modules/clean/auth/login_or_register/modal"],t,r)}).then(r.__importStar).then(({LoginOrRegisterModal:e})=>{l.Modal.showInstance(o.default.createElement(e,{downloadAction:n.DownloadAction.DIRECT_DOWNLOAD,id:"shared-link-download-signup-modal",initialMode:n.Mode.REGISTER,kind:t,onAuthenticateSuccess:c,onCancel:d,signup_tag:"shmodel_download_register",encryptionOptions:i,loggingExtra:{source:"download_button"}}))})}),authenticateForSaveToDropbox:(t,i,s)=>{const a=t===v.SharedLinkType.Content?"shared_content_link_register":"shmodel_modal_register";return new Promise((t,c)=>{const d=e=>t(e.id);new Promise((t,r)=>{e(["modules/clean/auth/login_or_register/modal"],t,r)}).then(r.__importStar).then(({LoginOrRegisterModal:e})=>{l.Modal.showInstance(o.default.createElement(e,{downloadAction:n.DownloadAction.SAVE_TO_DROPBOX,id:"shared-link-immediate-signup-modal",initialMode:n.Mode.REGISTER,kind:n.LoginOrRegisterKind.DOWNLOAD,onAuthenticateSuccess:d,onCancel:c,signup_tag:a,encryptionOptions:i,additionalLoginData:s,additionalRegisterData:s,loggingExtra:{source:"save_to_dropbox"}}))})})},doMultiAccountAuthentication:(t,n)=>new Promise((i,s)=>{new Promise((t,r)=>{e(["modules/clean/auth/multi_account_login_modal"],t,r)}).then(r.__importStar).then(({MultiAccountLoginModal:e})=>{l.Modal.showInstance(o.default.createElement(e,{onAuthenticateSuccess:i,onCancel:s,role:t,encryptionOptions:n}))})})}})),define("modules/clean/react/share_download/models",["require","exports","tslib","immutable","react","modules/clean/filepath/filepath","modules/clean/react/file_viewer/constants","modules/clean/react/share_download/actions","modules/core/i18n","modules/core/exception","modules/clean/react/flows/conversions/actions/unzip","modules/clean/analytics","modules/core/browser","spectrum-sharing/utils/sharing_constants"],(function(e,t,r,o,n,i,s,a,l,c,d,u,p,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ShareDownloadActionOption=void 0,o=r.__importStar(o),n=r.__importDefault(n),i=r.__importStar(i),a=r.__importStar(a),p=r.__importStar(p);const h={text:void 0,handler:void 0,spriteName:void 0,isDisabled:void 0,userAction:void 0,role:void 0};class f extends(o.Record(h)){static buildDirectOption(e,t,o,n){return o||c.reportException({err:new Error("No encryption options for building direct download option"),severity:"non-critical",tags:["sharing-encryption-options"]}),new f({text:l.intl.formatMessage({id:"n1Nx/q",defaultMessage:"Direct download"}),handler:()=>r.__awaiter(this,void 0,void 0,(function*(){yield a.direct(e,t,o,n,m.SHARE_ACTION_ORIGIN_TYPE.PREVIEW_PAGE)})),spriteName:"download_arrow",userAction:s.UserAction.Download})}static buildToDropboxOption(e,t,r,o,d,u=!1,p,m,h,_){p||c.reportException({err:new Error("No encryption options for building to dropbox option"),severity:"non-critical",tags:["sharing-encryption-options"]});let g=l.intl.formatMessage({id:"l/lvUk",defaultMessage:"Save to my Dropbox"}),v="dropbox",y=s.UserAction.SaveToDropbox;if(o&&o.is_cdm_member){const e=i.filename(o.cdm_tmf_path);g=e.length>12?l.intl.formatMessage({id:"QPvsZL",defaultMessage:"Save to my member folder"}):l.intl.formatMessage({id:"VIDWC/",defaultMessage:"Save to <strong>{cdm_tmf_name}</strong> folder"},{cdm_tmf_name:e,strong:e=>n.default.createElement("strong",null,e)}),r.is_paired&&(v="s_briefcase",y=s.UserAction.SaveToDropboxWork)}else if(r.is_paired)switch(d){case"personal":g=l.intl.formatMessage({id:"S5UJEB",defaultMessage:"Save to personal Dropbox"}),v="s_house",y=s.UserAction.SaveToDropboxPersonal;break;case"work":g=l.intl.formatMessage({id:"76AF1h",defaultMessage:"Save to {team_name} Dropbox"},{team_name:r.team_name}),v="s_briefcase",y=s.UserAction.SaveToDropboxWork}return new f({text:g,handler:()=>{this.logSaveToDropbox(o,e,t),a.toDropbox(e,t,d,o,p,m,h,_)},spriteName:v,isDisabled:u,userAction:y,role:d})}static extractToDropboxOption(e,t,r,o,n=!1){let a=l.intl.formatMessage({id:"IoJAyh",defaultMessage:"Extract to my Dropbox"});const c=s.UserAction.DecompressFile;if(e&&e.is_cdm_member){const t=i.filename(e.cdm_tmf_path);a=t.length>12?l.intl.formatMessage({id:"eN3/4H",defaultMessage:"Extract to my member folder"}):l.intl.formatMessage({id:"J+cK0b",defaultMessage:"Extract to {cdm_tmf_name} folder"},{cdm_tmf_name:t})}return new f({text:a,handler:()=>d.UnzipAction.convert([t],e,{shareToken:o}),spriteName:"dropbox",isDisabled:n,userAction:c,role:r})}}t.ShareDownloadActionOption=f,f.logSaveToDropbox=(e,t,r)=>{let o={};if("ns_id"in r&&"folder_id"in r&&(o=r.shared_folder_id||r.ns_id===r.folder_id?{ns_id:r.shared_folder_id||r.ns_id}:{content_id:r.folder_id}),o=t.linkType===m.SharedLinkType.Content?Object.assign(Object.assign({},o),{sckey:t.linkKey,rlkey:t.rlkey}):Object.assign(Object.assign({},o),{tkey:t.linkKey}),null==e?void 0:e.id)u.ShareTibEventLogger.log(e.id,"SAVE_TO_DROPBOX",m.SHARE_ACTION_ORIGIN_TYPE.PREVIEW_PAGE,o);else{const e=p.get_href();o=t.linkType===m.SharedLinkType.Content?Object.assign(Object.assign({},o),{scl_url:e}):Object.assign(Object.assign({},o),{url:e}),u.ShareTibEventLogger.log_unauth("SAVE_TO_DROPBOX",m.SHARE_ACTION_ORIGIN_TYPE.PREVIEW_PAGE,o)}}})),define("modules/clean/react/share_download/util",["require","exports","tslib","react","modules/clean/react/file_viewer/constants","modules/clean/react/file_viewer/logging","modules/clean/react/file_viewer/utils","modules/clean/react/share_download/models","modules/clean/react/title_bar/overflow_menu","modules/clean/share_download/types","modules/clean/shared_link/types","modules/clean/viewer","modules/clean/loggers/folder_preview_logger","modules/clean/react/flows/conversions/actions/unzip","modules/clean/react/flows/conversions/utils"],(function(e,t,r,o,n,i,s,a,l,c,d,u,p,m,h){"use strict";function f({canCopyToDropboxRoles:e},t,r,o,n,i,s){const l=[];if(e.length>0){const c=u.Viewer.get_viewer(),d=c.get_users(!0),p=(d,u)=>{const p=-1===e.indexOf(u);l.push(a.ShareDownloadActionOption.buildToDropboxOption(t,r,c,d,u,p,o,n,i,s))};d.forEach(e=>{p(e,e.role)}),e.indexOf("anonymous")>-1&&p(void 0,"anonymous")}return l}function _(e,t,r,o,n,i,s,l){const{canDownloadRoles:u}=e,{buildDirectOption:p}=a.ShareDownloadActionOption,_=[];return c.isPendingEntry(o)?_:(u.length>0&&_.push(p(t,n,i)),_.push(...f(e,r,o,i,l)),s&&c.isEntry(o)&&d.isEntrySharedFile(o)&&h.canConvertFile(o,e)&&m.UnzipAction.selector([o])&&_.push(a.ShareDownloadActionOption.extractToDropboxOption(s,o,s.role,r,!1)),_)}function g(e,t,r,o,n){return a=>{o&&o(),e.handler&&e.handler(),r?p.logEvent(e.userAction,r):i.logUserAction(e.userAction,s.getSplitButtonUserActionContext(t,n))}}Object.defineProperty(t,"__esModule",{value:!0}),t.isDownloadAllowed=t.getDownloadOptionsAsPopoverOrMobileItems=t.callOptionHandler=t.getDownloadOptions=t.getToDropboxOptions=void 0,o=r.__importDefault(o),t.getToDropboxOptions=f,t.getDownloadOptions=_,t.callOptionHandler=g,t.getDownloadOptionsAsPopoverOrMobileItems=function(e,t,r,i,s,a){return _(e,t,r,i,null,s,null,a).map(e=>o.default.createElement(l.PopoverOrMobileItem,{key:e.userAction,disabled:e.isDisabled,onSelect:g(e,n.SplitButtonActionLocation.Split,a)},e.text))},t.isDownloadAllowed=function(e){return e.canDownloadRoles.length>0}})),define("modules/clean/react/title_bar/overflow_menu",["require","exports","tslib","react","modules/core/browser_detection","modules/clean/react/title_bubble","modules/core/i18n","dig-components/icons","dig-components/icons/src","spectrum/popover/index","spectrum/mobile_menu/index","modules/clean/react/file_viewer/constants","modules/clean/react/sticky_position"],(function(e,t,r,o,n,i,s,a,l,c,d,u,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PopoverOrMobileItem=t.OverflowMenu=void 0,o=r.__importDefault(o);class m extends o.default.Component{constructor(){super(...arguments),this.handlePopoverSelection=(e,t)=>e&&e(t)}render(){const{children:e,contentWrapperClassName:t,hideOnDisabled:r,direction:a}=this.props,l=(function(e){const t=Array.isArray(e)?e.filter(e=>!!e):e;return null==e||Array.isArray(t)&&0===t.length})(e);if(l&&r)return null;if(n.is_mobile_or_tablet())return o.default.createElement(d.MobileMenu,{trigger:({openMobileMenu:e})=>o.default.createElement(h,{disabled:l,onClick:e})},e);const m=a===u.OverflowMenuDirection.ABOVE?"above":"below",f=a===u.OverflowMenuDirection.ABOVE?p.StickyPosition.TOP:p.StickyPosition.BOTTOM;return o.default.createElement(c.Popover,{className:"more-button-popover",onSelection:this.handlePopoverSelection},o.default.createElement(c.PopoverTrigger,{"aria-label":s.intl.formatMessage({id:"oeNPkV",defaultMessage:"More actions"}),disabled:l},o.default.createElement(i.TitleBubble,{content:s.intl.formatMessage({id:"S6stj+",defaultMessage:"More"}),distanceFromTarget:10,isTargetPositionFixed:!0,position:f},o.default.createElement(h,{disabled:l}))),o.default.createElement("div",{className:t},o.default.createElement(c.PopoverContent,{attachment:"right",position:m},e)))}}function h({disabled:e,onClick:t}){return o.default.createElement("span",{"aria-label":s.intl.formatMessage({id:"S6stj+",defaultMessage:"More"}),className:"u-mar-left-xs more-button",onClick:t},o.default.createElement(a.UIIcon,{src:l.MoreHorizontalLine}))}t.OverflowMenu=m,m.displayName="OverflowMenu";class f extends o.default.Component{constructor(){super(...arguments),this.onSelect=e=>{n.is_mobile_or_tablet()&&e.preventDefault();const{onSelect:t}=this.props;return t&&t(e)}}render(){const e=n.is_mobile_or_tablet(),t=this.props,{onSelect:i}=t,s=r.__rest(t,["onSelect"]);return e?o.default.createElement(d.MobileMenuItem,Object.assign({onSelect:this.onSelect},s)):o.default.createElement(c.PopoverContentItem,Object.assign({value:this.onSelect},s))}}t.PopoverOrMobileItem=f,f.displayName="PopoverOrMobileItem"})),define("modules/clean/share_download/types",["require","exports"],(function(e,t){"use strict";function r(e){return"ns_id"in e}Object.defineProperty(t,"__esModule",{value:!0}),t.isPendingEntry=t.isEntry=t.CopyableType=void 0,(function(e){e[e.Collection=0]="Collection",e[e.File=1]="File",e[e.Folder=2]="Folder"})(t.CopyableType||(t.CopyableType={})),t.isEntry=r,t.isPendingEntry=function(e){return r(e)&&null==e.ns_id}})),define("modules/clean/react/share_download/utils",["require","exports","modules/clean/share_download/types"],(function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCopyableType=t.getCopyableName=void 0,t.getCopyableName=function(e){return r.isEntry(e)?e.filename:e.name},t.getCopyableType=function(e){return r.isEntry(e)?e.is_dir?r.CopyableType.Folder:r.CopyableType.File:r.CopyableType.Collection}})),define("modules/clean/shared_link/types",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isEntrySharedFile=void 0,t.isEntrySharedFile=function(e){return"sjid"in e}})),define("modules/clean/react/shared_link_folder/copy_to_dropbox_button",["require","exports","tslib","react","modules/core/i18n","modules/clean/react/share_download/util","modules/clean/react/share_download/models","dig-components/buttons","modules/clean/react/file_viewer/constants","modules/clean/react/share_download/button_component","modules/clean/react/file_viewer/logging","modules/clean/react/file_viewer/utils","modules/clean/loggers/folder_preview_logger"],(function(e,t,r,o,n,i,s,a,l,c,d,u,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CopyToDropboxButton=void 0,o=r.__importDefault(o);class m extends o.default.Component{componentDidMount(){}onClickedOption(e,t){e.preventDefault(),t.handler(),this.props.folderPreviewSession?p.logEvent(t.userAction,this.props.folderPreviewSession):d.logUserAction(t.userAction,u.getSplitButtonUserActionContext(l.SplitButtonActionLocation.Main,this.props.location))}renderCopyToDropboxButton(){if(0===this.props.sharePermission.canCopyToDropboxRoles.length)return null;const e=n.intl.formatMessage({id:"lHp3ci",defaultMessage:"Save to Dropbox"}),t=i.getToDropboxOptions(this.props.sharePermission,this.props.shareToken,this.props.copyable,this.props.encryptionOptions,this.props.folderPreviewSession);if(this.props.showDownloadOption&&this.props.sharedLinkInfo){const e=s.ShareDownloadActionOption.buildDirectOption(this.props.sharedLinkInfo,null,this.props.encryptionOptions);t.push(e)}return 1===t.length?o.default.createElement(a.Button,{className:"copy-to-dropbox-button",style:{display:"-webkit-box"},variant:this.props.importance,onClick:e=>this.onClickedOption(e,t[0]),"aria-label":e},e):o.default.createElement(c.DownloadDropdown,{targetText:e+" ▾",options:t,onClick:this.props.onClick,location:this.props.location,importance:this.props.importance,title:n.intl.formatMessage({id:"lHp3ci",defaultMessage:"Save to Dropbox"}),isCollapsed:this.props.isCollapsed,isDisabled:!1,folderPreviewSession:this.props.folderPreviewSession})}render(){return o.default.createElement("div",null,this.renderCopyToDropboxButton())}}t.CopyToDropboxButton=m,m.displayName="CopyToDropboxButton"})),define("modules/clean/react/share_download/button_component",["require","exports","tslib","classnames","prop-types","react","dig-components/buttons","modules/clean/filepath/filepath","modules/clean/react/file_viewer/logging","modules/clean/react/file_viewer/constants","modules/clean/react/file_viewer/utils","modules/clean/react/share_download/util","modules/clean/react/share_download/models","modules/clean/react/share_download/util","modules/clean/share_download/types","modules/clean/react/title_bubble","modules/core/i18n","modules/core/browser_detection","modules/clean/react/file_viewer_sidebar/buttons/icon","modules/clean/loggers/folder_preview_logger","modules/clean/react/sticky_position","dig-components/icons","dig-components/icons/src","dig-components/layer","dig-components/menu"],(function(e,t,r,o,n,i,s,a,l,c,d,u,p,m,h,f,_,g,v,y,b,w,S,E,k){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ShareDownloadButton=t.DownloadDropdown=t.DownloadSimpleButton=void 0,o=r.__importDefault(o),n=r.__importDefault(n),i=r.__importDefault(i),a=r.__importStar(a);const M=e=>!g.is_mobile_or_tablet()&&e.title&&e.isCollapsed?i.default.createElement(f.TitleBubble,{content:e.title,isTargetPositionFixed:!0,position:b.StickyPosition.LEFT},e.children):i.default.createElement(i.default.Fragment,null,e.children);class T extends i.default.Component{constructor(e){super(e),this.state={isDisabled:!0}}componentDidMount(){this.setState({isDisabled:this.props.isDisabled})}render(){const e={"download-button":!0,control__button:!0,"control__button--collapsed":this.props.isCollapsed};return this.props.className&&(e[this.props.className]=!0),i.default.createElement(M,{title:this.props.title,isCollapsed:this.props.isCollapsed},i.default.createElement(s.Button,{className:o.default(e),style:{display:"-webkit-box"},variant:this.props.importance,disabled:this.state.isDisabled,onClick:this.props.onClick,"aria-label":this.props.title,withIconLeft:i.default.createElement(w.UIIcon,{src:S.DownloadLine})},this.props.children))}}T.defaultProps={isDisabled:!1,importance:"opacity"},T.displayName="DownloadMainButton";class P extends i.default.Component{render(){return i.default.createElement(T,{isDisabled:this.props.isDisabled,onClick:e=>{e.preventDefault(),this.props.onClick&&this.props.onClick(this.props.option),this.props.option.handler(),this.props.folderPreviewSession?y.logEvent(this.props.option.userAction,this.props.folderPreviewSession):l.logUserAction(this.props.option.userAction,d.getSplitButtonUserActionContext(c.SplitButtonActionLocation.Main,this.props.location))},importance:this.props.importance,isCollapsed:this.props.isCollapsed,title:this.props.title},this.props.isCollapsed?i.default.createElement(v.ButtonIcon,{name:"download-file",isPrimary:"primary"===this.props.importance}):this.props.targetText)}}t.DownloadSimpleButton=P,P.displayName="DownloadSimpleButton";class O extends i.default.Component{constructor(e){super(e),this.onActionMenuSelection=e=>{u.callOptionHandler(e,c.SplitButtonActionLocation.Split,this.props.folderPreviewSession,this.props.onClick,this.props.location)()},this.state={isDisabled:!0}}componentDidMount(){this.setState({isDisabled:this.props.isDisabled})}renderIcon(){return i.default.createElement(v.ButtonIcon,{name:"download-file",isPrimary:"primary"===this.props.importance,"aria-label":this.props.title})}renderActionMenu(){const e=this.props.options.map(e=>i.default.createElement(k.Menu.ActionItem,{"aria-label":e.text,key:e.text,value:e,disabled:e.isDisabled},e.text)),t={"download-button":!0,control__button:!0,"control__button--collapsed":this.props.isCollapsed};return i.default.createElement(k.Menu.Wrapper,{key:"download-dropdown",onSelection:this.onActionMenuSelection,className:o.default(t)},({getContentProps:t,getTriggerProps:r})=>i.default.createElement(i.default.Fragment,null,i.default.createElement(M,{title:this.props.title,isCollapsed:this.props.isCollapsed},i.default.createElement(s.Button,Object.assign({className:"download-title-button"},r(),{variant:this.props.importance,disabled:this.state.isDisabled,"aria-label":this.props.title}),this.props.isCollapsed?this.renderIcon():this.props.targetText)),i.default.createElement(E.LayerContext.Provider,{value:500},i.default.createElement(k.Menu.Content,Object.assign({},t()),i.default.createElement(k.Menu.Segment,null,e)))))}render(){return this.props.isDisabled?i.default.createElement(T,{isDisabled:!0,importance:this.props.importance,title:this.props.title,isCollapsed:this.props.isCollapsed},this.props.isCollapsed?null:this.props.targetText):this.renderActionMenu()}}t.DownloadDropdown=O,O.defaultProps={importance:"secondary"},O.displayName="DownloadDropdown";class A extends i.default.Component{getTargetText(e){if(u.isDownloadAllowed(this.props.sharePermission))return e>1?{title:_.intl.formatMessage({id:"0YRjqy",defaultMessage:"Download ▾"})}:{title:_.intl.formatMessage({id:"pHnJw0",defaultMessage:"Download"})};if(this.props.user&&this.props.user.is_cdm_member){const e=a.filename(this.props.user.cdm_tmf_path);return e.length>25?{title:_.intl.formatMessage({id:"6m85k6",defaultMessage:"Add to my member folder"})}:{label:_.intl.formatMessage({id:"ck1w+U",defaultMessage:"Add to <strong>{cdm_tmf_name}</strong> folder"},{cdm_tmf_name:e,strong:t=>i.default.createElement("strong",{key:e,style:{fontWeight:800}},t)}),title:_.intl.formatMessage({id:"nzqkZQ",defaultMessage:"Add to {cdm_tmf_name} folder"},{cdm_tmf_name:e})}}return{title:_.intl.formatMessage({id:"N8ovVA",defaultMessage:"Add to Dropbox"})}}getTooltipLabel(){return h.isPendingEntry(this.props.copyable)?_.intl.formatMessage({id:"DldXvN",defaultMessage:"Download is unavailable while file is uploading."}):_.intl.formatMessage({id:"gUTeT9",defaultMessage:"Downloads disabled."})}render(){const e=m.getDownloadOptions(this.props.sharePermission,this.props.sharedLinkInfo,this.props.shareToken,this.props.copyable,this.context.authModalKind||null,this.props.encryptionOptions,this.props.user,this.props.folderPreviewSession);if(this.props.downloadOnly){let e=new p.ShareDownloadActionOption({isDisabled:!0}),t=!0;return u.isDownloadAllowed(this.props.sharePermission)&&(e=p.ShareDownloadActionOption.buildDirectOption(this.props.sharedLinkInfo,null,this.props.encryptionOptions,this.props.shareToken.rlkey),t=!1),i.default.createElement(P,{isDisabled:t,targetText:_.intl.formatMessage({id:"pHnJw0",defaultMessage:"Download"}),title:_.intl.formatMessage({id:"pHnJw0",defaultMessage:"Download"}),option:e,onClick:this.props.onClick,location:this.props.location,importance:this.props.importance,isCollapsed:this.props.isCollapsed,folderPreviewSession:this.props.folderPreviewSession})}if(0===e.length)return i.default.createElement(O,{targetText:_.intl.formatMessage({id:"pHnJw0",defaultMessage:"Download"}),isDisabled:!0,options:[new p.ShareDownloadActionOption({isDisabled:!0})],onClick:this.props.onClick,location:this.props.location,title:this.getTooltipLabel(),importance:this.props.importance,isCollapsed:this.props.isCollapsed,folderPreviewSession:this.props.folderPreviewSession});const t=this.getTargetText(e.length);return 1===e.length?i.default.createElement(P,{isDisabled:!1,targetText:t.label||t.title,title:t.title,option:e[0],onClick:this.props.onClick,location:this.props.location,importance:this.props.importance,isCollapsed:this.props.isCollapsed,folderPreviewSession:this.props.folderPreviewSession}):i.default.createElement(O,{targetText:t.label||t.title,options:e,onClick:this.props.onClick,location:this.props.location,isDisabled:!1,importance:this.props.importance,isCollapsed:this.props.isCollapsed,title:_.intl.formatMessage({id:"pHnJw0",defaultMessage:"Download"}),folderPreviewSession:this.props.folderPreviewSession})}}t.ShareDownloadButton=A,A.contextTypes={authModalKind:n.default.oneOf(["immediate","download",null])},A.displayName="ShareDownloadButton"})),define("modules/clean/react/shared_link_folder/page",["require","exports","tslib","classnames","react","modules/clean/analytics","modules/clean/components/loading_indicator","modules/clean/react/browse/sort_helpers","modules/clean/react/components/css","modules/clean/react/async/loadable","modules/clean/em_string","modules/clean/react/open_in_app/banner","modules/clean/react/shared_link_folder/folder_icon","modules/clean/react/shared_link_folder/grid","modules/clean/react/shared_link_folder/list","modules/clean/react/takedown_warning","spectrum-sharing/utils/sharing_constants","modules/clean/web_timing_logger","modules/core/i18n","modules/clean/react/icon/icon_helper","modules/clean/react/size_class/size_class","modules/clean/react/size_class/constants","modules/clean/loggers/folder_preview_logger","modules/clean/react/file_viewer/app_download_interstitial/app_download_interstitial","modules/clean/react/shared_link_folder/folder_title","modules/core/i18n","modules/clean/bug_reporting/routing","typescript/component_libraries/pro-ui/src/components/branding/branding_block/optional_branding_block","modules/clean/react/branding/branding_modal_controller","modules/clean/react/share_sync/button","modules/clean/react/shared_link_folder/copy_to_dropbox_button","modules/clean/react/share_download/button","typescript/component_libraries/retrieval-components/src/view-mode-toggle/index","modules/clean/sharing/ui_util","modules/clean/react/snackbar","modules/clean/react/snackbar_manager","modules/clean/react/previews/sharing_plugin/copy_link_button"],(function(e,t,r,o,n,i,s,a,l,c,d,u,p,m,h,f,_,g,v,y,b,w,S,E,k,M,T,P,O,A,C,F,D,x,R,I,N){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SharedLinkFolderPage=t._SharedLinkFolderPage=void 0,o=r.__importDefault(o),n=r.__importDefault(n),g=r.__importStar(g);const L=c.Loadable({loader:()=>new Promise((t,r)=>{e(["modules/clean/react/shared_link_folder/title_bar"],t,r)}).then(r.__importStar).then(({SharedLinkFolderTitleBar:e})=>e)});class j extends n.default.PureComponent{constructor(){super(...arguments),this.snackbarManager=n.default.createRef(),this.state={openInAppBannerClosed:!1,currentMode:D.ViewMode.LIST},this.shouldShowOpenInAppBanner=()=>{const{folder:e}=this.props,{openInAppBannerClosed:t}=this.state;return e&&e.open_in_app_data&&!t},this.onOpenInAppClosed=()=>{this.setState(e=>({openInAppBannerClosed:!0,currentMode:e.currentMode}))},this.changeViewMode=(e,t)=>{this.setState(t=>({openInAppBannerClosed:t.openInAppBannerClosed,currentMode:e}))},this.onInterstitialClose=()=>{S.logEvent(S.EventType.appDownloadInterstitialClose,this.props.folderPreviewSession),this.props.onAppDownloadInterstitialDismissed()},this.onInterstitialContinue=()=>{S.logEvent(S.EventType.appDownloadInterstitialContinue,this.props.folderPreviewSession),this.props.onAppDownloadInterstitialDismissed()},this.onAppDownload=()=>{S.logEvent(S.EventType.appDownloadInterstitialInstall,this.props.folderPreviewSession)},this.handleBreadcrumbClick=e=>{const{breadcrumbs:t,folderPreviewSession:r}=this.props;r.extra=Object.assign(Object.assign({},r.extra),{origin_breadcrumb:t.length-1,destination_breadcrumb:e}),S.logEvent(S.EventType.breadcrumbClicked,r)}}UNSAFE_componentWillMount(){S.logEvent(S.EventType.attempted,this.props.folderPreviewSession)}componentWillUnmount(){S.logEvent(S.EventType.ended,this.props.folderPreviewSession)}componentDidMount(){R.Snackbar.manager=this.snackbarManager.current,this.ensureWebTimingMarked(),this.logSclTiming(),this.shouldShowAppDownloadInterstitial()&&S.logEvent(S.EventType.appDownloadInterstitialView,this.props.folderPreviewSession),setTimeout(()=>{x.trackReceiverUserLeapEvent(x.ReceiverUserLeapEvent.VIEWED_SHARED_FOLDER)},5e3)}componentDidUpdate(){this.ensureWebTimingMarked()}componentDidCatch(){S.logEvent(S.EventType.renderFailed,this.props.folderPreviewSession)}shouldShowAppDownloadInterstitial(){const{folder:e,appDownloadInterstitialDismissed:t}=this.props;return!t&&e&&e.open_in_app_data}ensureWebTimingMarked(){const{contents:{files:e,folders:t},hasMore:r,webTimer:o}=this.props;(e.length>0||t.length>0||!r)&&(o&&(o.timeToView()||o.markTimeToView(),o.timeToInteractive()||o.markTimeToInteractive()),S.markPrimaryEvent(this.props.folderPreviewSession),S.logEvent(S.EventType.renderSucceeded,this.props.folderPreviewSession))}logSclTiming(){if(!this.props.user)return;if(this.props.folderShareToken.linkType!==_.SharedLinkType.Content)return;const e=(new Date).getTime(),t={ns_id:this.props.folder.shared_folder_id,timing:e-g.start_time()};i.ShareTibEventLogger.log(this.props.user.id,"PREVIEW_RENDER",_.SHARE_ACTION_ORIGIN_TYPE.PREVIEW_PAGE,t)}render(){const{accountMenuOptions:e,brandingInfo:t,breadcrumbs:r,contents:i,folder:a,folderSharePermission:l,folderShareToken:c,folderSharedLinkInfo:p,folderPreviewSession:m,hasMore:h,onFileOpen:_,onFolderOpen:g,outOfQuota:y,showSyncCoachmark:b,sizeClass:S,takedownRequestType:M,user:A,encryptionOptions:C,inCopyLinkButtonOOBPreviews:F}=this.props;m.extra.size_class=S;const x=n.default.createElement(k.FolderTitle,{title:d.Emstring.em_snippet(a.filename,S!==w.SizeClass.Small?35:20),ownerName:p.ownerName,ownerTeamName:p.ownerTeamName,ownerTeamLogo:p.ownerTeamLogo,breadcrumbs:r,onCrumbClick:this.handleBreadcrumbClick}),R=o.default("sl-page-body",{"view-in-app-bar-present":this.shouldShowOpenInAppBanner()});let I;if(this.shouldShowAppDownloadInterstitial()){const e=p.displayName;I=n.default.createElement("div",{"aria-label":e},n.default.createElement(E.AppDownloadInterstitial,{isFolder:!0,fileOrFolderName:e,open_in_app_data:a.open_in_app_data,ownerName:p.ownerName,ownerTeamName:p.ownerTeamName,onClose:this.onInterstitialClose,onContinue:this.onInterstitialContinue,onAppDownload:this.onAppDownload}))}return n.default.createElement(T.RegisterComponentWithBugReporter,{componentId:"web.folder_viewer",componentName:"Shared Folder Viewer"},n.default.createElement("div",null,n.default.createElement("div",{className:"sl-page-container"},n.default.createElement("div",{className:"sl-page-header"},n.default.createElement(L,{accountMenuOptions:e,folder:a,sharedLinkInfo:p,shareToken:c,sharePermission:l,sizeClass:S,title:S===w.SizeClass.Small?x:void 0,user:A,encryptionOptions:C,folderPreviewSession:m}),this.shouldShowOpenInAppBanner()?n.default.createElement(u.OpenInAppBanner,{urls:a.open_in_app_data,onClose:this.onOpenInAppClosed}):null),n.default.createElement("div",{className:R},n.default.createElement(P.OptionalBrandingBlock,{brandingInfo:t,className:"sl-branding-header",sharedLinkInfo:p}),n.default.createElement("div",{className:"sl-header clearfix"},n.default.createElement("h3",{className:"sl-title"},null!=M?n.default.createElement("div",{className:"sl-takedown-warning"},n.default.createElement(f.TakedownWarning,{takedownType:M})):null,S!==w.SizeClass.Small?x:null)),n.default.createElement("div",{className:"sl-buttons"},this.renderCTAButtons(a,y,p,l,c,b,A,C,m,F)),n.default.createElement("div",{className:"sl-toggle-with-body"},n.default.createElement("div",{className:"sl-view-toggle"},n.default.createElement(D.ViewModeToggle,{onSelection:this.changeViewMode,currentMode:this.state.currentMode})),n.default.createElement(V,{files:i.files,folder:a,hasMore:h,sizeClass:S,subfolders:i.folders,onFolderOpen:g,onFileOpen:_,currentMode:this.state.currentMode})),h?n.default.createElement("div",{className:"sl-loading-indicator"},n.default.createElement(s.LoadingIndicator,{style:s.LoadingIndicator.LoadingIndicatorStyle.BLUE_SPINNER})):null)),I||n.default.createElement(O.BrandingModalController,{brandingInfo:t,closeButtonText:v.intl.formatMessage({id:"eC3oZ9",defaultMessage:"View folder"}),sharedLinkInfo:p})))}renderCTAButtons(e,t,r,o,i,s,a,l,c,d){const u=i.linkType!==_.SharedLinkType.Shmodel&&o.canSyncToDropboxRoles.length>0&&""===i.subPath;return n.default.createElement(n.default.Fragment,null,n.default.createElement(I.SnackbarManager,{ref:this.snackbarManager,getParentElement:I.SnackbarManager.getEmbeddedAppPagelet,useDigSnackbars:!0}),u?n.default.createElement(A.ShareSyncButton,{folder:e,outOfQuota:t,sharedLinkInfo:r,sharePermission:o,shareToken:i,showSyncCoachmark:s,user:a,folderPreviewSession:c,encryptionOptions:l}):n.default.createElement(C.CopyToDropboxButton,{shareToken:i,sharedLinkInfo:r,sharePermission:o,copyable:e,encryptionOptions:l,user:a,folderPreviewSession:c,importance:"primary",showDownloadOption:!1}),n.default.createElement(F.ShareDownloadButton,{copyable:e,sharedLinkInfo:r,shareToken:i,sharePermission:o,user:a,downloadOnly:!0,encryptionOptions:l,folderPreviewSession:c}),d&&!this.props.subfolderNavTracking&&!o.isEditFolderLink&&(this.props.parsedSharedCopyLink.doesContainRlKey||this.props.parsedSharedCopyLink.doesContainShmodelLink)&&n.default.createElement(N.CopyLinkButton,{file:e,user:a,parsedLink:this.props.parsedSharedCopyLink,linkAccessLevel:"viewer"}))}}t._SharedLinkFolderPage=j,j.defaultProps={webTimer:g.get_timer()},j.displayName="SharedLinkFolderPage";const U=l.requireCssWithComponent(j,["/static/css/react_title_bar-vflbikD6O.css","/static/css/react_file_viewer-vfl419ufQ.css","/static/js/typescript/component_libraries/pro-ui/src/index.web-vfl7fyKnY.css","/static/css/dig-components/index.web-vflm67Rix.css"]),H=b.withSizeClass(U);t.SharedLinkFolderPage=H;function B(e=[],t=[]){const r=(o=M.case_insensitive_comparator(!0),function(e,t){return a.compare(e.filename,t.filename,1,o)});var o;return[...t,...e].sort(r)}function q(e){return n.default.createElement("div",{className:"sl-body sl-body--empty-folder"},n.default.createElement(p.SharedLinkFolderFolderIcon,{className:"sl-empty-folder-icon",folder:e.folder,size:y.SpectrumIconSize.Large}),n.default.createElement("h3",{className:"sl-empty-folder-message"},v.intl.formatMessage({id:"xOtZlZ",defaultMessage:"This folder is empty"})))}function V(e){const{files:t,folder:r,hasMore:o,sizeClass:i,subfolders:s,onFileOpen:a,onFolderOpen:l,currentMode:c}=e,d=B(t,s);if(!d.length&&!o)return n.default.createElement(q,{folder:r});switch(c){case D.ViewMode.LIST:return n.default.createElement("div",{className:"sl-body"},n.default.createElement(h.SharedLinkFolderList,{key:"list",entries:d,sizeClass:i,onFolderOpen:l,onFileOpen:a}));case D.ViewMode.CONDENSED_LIST:return n.default.createElement("div",{className:"sl-body"},n.default.createElement(h.SharedLinkFolderList,{key:"list",entries:d,sizeClass:i,onFolderOpen:l,onFileOpen:a,smallList:!0}));case D.ViewMode.TILE:return n.default.createElement("div",{className:"sl-body"},n.default.createElement(m.SharedLinkFolderGrid,{key:"grid",entries:d,onFolderOpen:l,onFileOpen:a,largeGrid:!0}));case D.ViewMode.GRID:default:return n.default.createElement("div",{className:"sl-body"},n.default.createElement(m.SharedLinkFolderGrid,{key:"grid",entries:d,onFolderOpen:l,onFileOpen:a}))}}})),define("modules/clean/react/shared_link_folder/app",["require","exports","tslib","lodash","react","redux","react-redux","modules/clean/cloud_docs/open_with_utils","modules/clean/loggers/folder_preview_logger","modules/clean/open_in_app/actions","modules/clean/previews/constants","modules/clean/react/async/loadable","modules/clean/react/file_viewer/data/actions","modules/clean/react/file_viewer/data/selectors","modules/clean/react/file_viewer/location_utils","modules/clean/react/location/with_location","modules/clean/react/file_viewer/url_utils","modules/clean/react/previews/constants","modules/clean/react/shared_link_folder/data/actions","modules/clean/react/shared_link_folder/data/store","modules/clean/react/shared_link_folder/page","modules/clean/viewer","modules/clean/web_timing_logger","modules/constants/python","modules/clean/web_timing_logger","modules/core/persistence/storage","modules/constants/page_load","modules/core/langpack","react-intl","modules/core/i18n","modules/clean/react/shared_link_folder/utils","modules/clean/react/shared_link_folder/data/selectors","modules/clean/csrf","modules/core/browser","modules/clean/react/file_viewer/utils","modules/clean/sharing/clean/util/link_util/parser"],(function(e,t,r,o,n,i,s,a,l,c,d,u,p,m,h,f,_,g,v,y,b,w,S,E,k,M,T,P,O,A,C,F,D,x,R,I){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SharedLinkFolderApp=t._SharedLinkFolderApp=t.AsyncFileCollectionViewer=void 0,o=r.__importStar(o),n=r.__importDefault(n),k=r.__importStar(k),P=r.__importStar(P),I=r.__importStar(I);const N=o.memoize(()=>new Promise((t,r)=>{e(["modules/clean/react/file_viewer/collection_viewer"],t,r)}).then(r.__importStar));t.AsyncFileCollectionViewer=u.Loadable({loader:()=>N().then(({FileCollectionViewer:e})=>e)});const L=e=>({label:e.filename,href:e.href});function j(){let e=k.get_timer();return e.timeToInteractive()&&(e=k.get_timer("shared_link_folder_ajax"),e.initialize({requireTTI:!0,requireTTV:!0,url:"shared_link_folder_ajax"})),e}class U extends n.default.PureComponent{constructor(e){var t;super(e),this.handleOpenFile=e=>{e.preview_type&&e.preview_type===d.PreviewType.CloudDoc&&!a.isShortcut(e)?x.open_tab(e.href):this.previewDataPromise?this.previewDataPromise.then(()=>_.openFile(e)):_.openFile(e)},this.handleOpenFolder=e=>{this.previewDataPromise?this.previewDataPromise.then(()=>C.openFolder(e)):C.openFolder(e)};const r=w.Viewer.get_viewer(),o=r.work_user||r.personal_user,{folderShareToken:n,folderData:i,shouldFetchPreviewData:s}=e,c=C.getSecureHashOrSubPath(n);this.state={folderHierarchyMap:{[c]:i?[i]:[]},pageYOffset:0,previewSourceAction:g.PreviewSourceAction.Visit,user:o},this.folderPreviewSession=l.createSession({subfolder_nav_tracking:e.subfolderNavTracking,use_odyssey:s,folder_id:null===(t=e.folder)||void 0===t?void 0:t.folder.folder_id}),this.webTimer=j(),this.rlkey=n.rlkey}UNSAFE_componentWillMount(){this.webTimer.applicationStart();const{openImmediatelyInApp:e}=this.props;if(e)return this.openImmediatelyInApp()}componentWillUnmount(){this.unsubscribe()}UNSAFE_componentWillReceiveProps(e){var t,r;!this.props.viewingFilename&&e.viewingFilename&&this.setState({pageYOffset:window.pageYOffset}),this.props.viewingFilename!==e.viewingFilename&&this.setState({previewSourceAction:g.PreviewSourceAction.Click});const o=e.folder?e.folder.folder.ns_id:void 0,n=C.getFolderShareTokenWithRlkey(e.folderShareToken,this.rlkey),i=C.getSecureHashOrSubPath(n),s=C.getFolderShareTokenWithRlkey(this.props.folderShareToken,this.rlkey);i!==C.getSecureHashOrSubPath(s)?(this.webTimer=j(),this.webTimer.restart(),this.folderPreviewSession=l.createSession({source_action:g.PreviewSourceAction.Click,subfolder_nav_tracking:e.subfolderNavTracking,has_cached_data:e.folder&&!!e.folder.entries.length,ns_id:o,folder_id:null===(t=e.folder)||void 0===t?void 0:t.folder.folder_id}),this.props.onFolderLoad(n,this.webTimer)):this.props.viewingFilename&&!e.viewingFilename&&(this.folderPreviewSession=l.createSession({source_action:g.PreviewSourceAction.FileViewerExit,subfolder_nav_tracking:e.subfolderNavTracking,has_cached_data:!0,ns_id:o,folder_id:null===(r=e.folder)||void 0===r?void 0:r.folder.folder_id})),e.folder&&e.folder.folder&&C.setPageTitle(e.folder.folder.filename)}componentDidMount(){return r.__awaiter(this,void 0,void 0,(function*(){const{file:e,onFolderPrefetch:t,viewingFilename:r}=this.props,n=C.getFolderShareTokenWithRlkey(this.props.folderShareToken,this.rlkey);r&&window.setTimeout(R.cleanupPrerenderPreview),n&&(this.previewDataPromise=t(n,e)),yield S.waitForTTI(),N();const i=yield this.readFolderHierarchy();this.setState((e,t)=>{const r=C.getFolderShareTokenWithRlkey(t.folderShareToken,this.rlkey),n=C.getSecureHashOrSubPath(r);return{folderHierarchyMap:o.get(i,n)?i:e.folderHierarchyMap}})}))}componentDidUpdate(e){const{viewingFilename:t}=this.props,{pageYOffset:r}=this.state;t!==e.viewingFilename&&(t||window.scrollTo(0,r));const o=C.getFolderShareTokenWithRlkey(e.folderShareToken,this.rlkey),n=C.getSecureHashOrSubPath(o),i=C.getFolderShareTokenWithRlkey(this.props.folderShareToken,this.rlkey),s=C.getSecureHashOrSubPath(i);n!==s&&(this.setState((e,t)=>{if(!t.folder||!C.shouldUpdateFolderHierarchy(e.folderHierarchyMap,o,i)){const{folderHierarchyMap:t}=e;return{folderHierarchyMap:t}}const{folder:r}=t.folder;return{folderHierarchyMap:Object.assign(Object.assign({},e.folderHierarchyMap),{[s]:[...e.folderHierarchyMap[n],r]})}},this.writeFolderHierarchy),C.removeRlkeyFromURL())}getUserStorageKey(){return r.__awaiter(this,void 0,void 0,(function*(){const t=yield new Promise((t,r)=>{e(["sjcl"],t,r)}).then(r.__importStar),o=t.hash.sha256.hash(D.readCsrfToken()||"");return t.codec.base64.fromBits(o)}))}writeFolderHierarchy(){return r.__awaiter(this,void 0,void 0,(function*(){M.SessionStorage.set("shared_folder_hierarchy",{[yield this.getUserStorageKey()]:this.state.folderHierarchyMap})}))}readFolderHierarchy(){return r.__awaiter(this,void 0,void 0,(function*(){return o.get(M.SessionStorage.get("shared_folder_hierarchy"),yield this.getUserStorageKey())}))}openImmediatelyInApp(){const{folder:e}=this.props;if(e)try{e.folder.open_in_app_data&&c.openImmediately(e.folder.open_in_app_data)}catch(e){}}render(){const{accountMenuOptions:e,appDownloadInterstitialDismissed:r,brandingInfo:i,file:s,files:a,fileViewOrigin:l,fileViewTarget:c,folder:d,onAppDownloadInterstitialDismissed:u,outOfQuota:p,showSyncCoachmark:m,subfolders:h,viewingFilename:f,encryptionOptions:v,inCopyLinkButtonOOBPreviews:y}=this.props,{folderHierarchyMap:w,user:S,previewSourceAction:k}=this.state,M=I.parseLink(window.location.href),T=o.get(w,C.getSecureHashOrSubPath(C.getFolderShareTokenWithRlkey(this.props.folderShareToken,this.rlkey)),[]).map(L);if(f&&s){let e=[],r=[],o=[],d=[];return Array.isArray(a)&&a.length?a.forEach(t=>{r.push(t.shareToken),o.push(t.sharedLinkInfo),e.push(t.sharePermission),d.push(t.file)}):(d=[s.file],e=[s.sharePermission],r=[s.shareToken],o=[s.sharedLinkInfo]),n.default.createElement(t.AsyncFileCollectionViewer,{brandingInfo:i,canClose:!0,className:"no-background",file:s.file,files:d,fileViewOrigin:l,fileViewTarget:c,fileViewAction:E.FileViewActionType.CLICK,initialPreviewSourceContext:g.PreviewSourceContext.SharedLinkFolder,initialPreviewSourceAction:k,skipOuterRouting:!0,sharedLinkInfos:o,sharePermissions:e,shareTokens:r,titleBarCloseUrl:_.getCurrentFolderHref(),onCloseViewer:_.closeFile,user:S,encryptionOptions:v})}if(!d)return null;const{shareToken:P,sharedLinkInfo:O,folder:A,sharePermission:F,hasMore:D,takedownRequestType:x}=d,R={files:Array.isArray(a)?a.map(e=>e.file):[],folders:Array.isArray(h)?h.map(e=>e.folder):[]};return A.folder_id&&(this.folderPreviewSession.extra.folder_id=A.folder_id),n.default.createElement(b.SharedLinkFolderPage,{accountMenuOptions:e,appDownloadInterstitialDismissed:r,brandingInfo:i,breadcrumbs:T,contents:R,folder:A,folderPreviewSession:this.folderPreviewSession,folderSharePermission:F,folderShareToken:P,folderSharedLinkInfo:O,hasMore:D,onAppDownloadInterstitialDismissed:u,onFileOpen:this.handleOpenFile,onFolderOpen:this.handleOpenFolder,outOfQuota:p,showSyncCoachmark:m,takedownRequestType:x,user:S,webTimer:this.webTimer,encryptionOptions:v,inCopyLinkButtonOOBPreviews:y,parsedSharedCopyLink:M,subfolderNavTracking:this.props.subfolderNavTracking})}}t._SharedLinkFolderApp=U,U.defaultProps={subfolderNavTracking:!1},U.displayName="SharedLinkFolderApp";const H=s.connect((function(e,t){let r=m.getAppDownloadInterstitial(e);void 0===r&&(r=t.appDownloadInterstitialDismissed);const{viewingFilename:o}=t,n=F.getFolderShareTokenWithState(e,t.folderShareToken),i=C.getSecureHashOrSubPath(n);return{appDownloadInterstitialDismissed:r,file:F.getSharedFilePackageByFilenameForFolderPath(e,i,o||""),folder:F.getFolderByPath(e,i),files:F.getSharedFilePackagesForFolderPath(e,i),subfolders:F.getSubfoldersForFolderPath(e,i)}}),(function(e,t){const{shouldFetchPreviewData:r}=t;return i.bindActionCreators({onAppDownloadInterstitialDismissed:p.dismissAppDownloadInterstitial,onFolderLoad:v.fetchFolder,onFolderPrefetch:r?v.prefetchFolderFromOdyssey:v.prefetchFolder},e)}))(U),B=f.withLocation(H,e=>({folderShareToken:C.getFolderShareTokenFromLocation(e),viewingFilename:h.getFilenameFromLocation(e),subfolderNavTracking:"subfolder_nav_tracking"in e.query}));class q extends n.default.Component{constructor(e){super(e),this.store=y.getStoreForSharedLinkFolder();const t=C.getFolderShareTokenWithRlkey(this.props.folderShareToken,this.store.rlkey);y.hydrateStore(this.store,{initialFolder:this.props.folderData,initialPreview:this.props.preview,folderSharedLinkInfo:this.props.folderSharedLinkInfo,folderSharePermission:this.props.folderSharePermission,folderShareToken:t})}render(){return n.default.createElement(O.IntlProvider,{defaultLocale:"en-US",locale:A.localeToBcp47LangTag(T.USER_LOCALE),messages:P},n.default.createElement(s.Provider,{store:this.store},n.default.createElement(B,Object.assign({},this.props))))}}t.SharedLinkFolderApp=q,q.displayName="SharedLinkFolderAppWithProvider"})),define("spectrum/mobile_menu/index",["require","exports","tslib","spectrum/mobile_menu/mobile_menu","spectrum/mobile_menu/mobile_menu_close_button","spectrum/mobile_menu/mobile_menu_content","spectrum/mobile_menu/mobile_menu_item"],(function(e,t,r,o,n,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r.__exportStar(o,t),r.__exportStar(n,t),r.__exportStar(i,t),r.__exportStar(s,t)})),define("modules/clean/loggers/folder_preview_logger",["require","exports","tslib","modules/clean/deprecated_ajax/ajax_jquery","modules/core/browser","modules/constants/request","modules/clean/react/previews/constants","modules/clean/web_timing_logger","modules/clean/uuid/uuid","modules/clean/loggers/device_type"],(function(e,t,r,o,n,i,s,a,l,c){"use strict";var d;function u(e){return+!!e}function p(e){return JSON.stringify(Object.assign(Object.assign({},e),{has_cached_data:u(e.has_cached_data),folder_preview_timeline:JSON.stringify(e.folder_preview_timeline),subfolder_nav_tracking:u(e.subfolder_nav_tracking),web_timing_data:JSON.stringify(e.web_timing_data)}))}function m(e){const t=Object.assign({},e.extra),r=n.performance();if(null!=r){const e=r.timing;e&&e.fetchStart&&(t.time_to_first_byte=e.responseStart-e.fetchStart,t.web_timing_data=e)}return{device_type:e.deviceType,folder_preview_session_id:e.id,folder_ns_id:e.ns_id||0,web_request_id:e.web_request_id,extra:p(t)}}Object.defineProperty(t,"__esModule",{value:!0}),t.logEvent=t.markPrimaryEvent=t.createSession=t.EventType=void 0,o=r.__importStar(o),n=r.__importStar(n),i=r.__importStar(i),(function(e){e.attempted="preview_attempted",e.renderSucceeded="render_succeeded",e.renderFailed="render_failed",e.ended="preview_session_ended",e.appDownloadInterstitialClose="app_download_interstitial_close",e.appDownloadInterstitialContinue="app_download_interstitial_continue",e.appDownloadInterstitialInstall="app_download_interstitial_install",e.appDownloadInterstitialView="app_download_interstitial_view",e.breadcrumbClicked="breadcrumb_clicked"})(d=t.EventType||(t.EventType={})),t.createSession=function({id:e=l.UUID.v4({allowInsecure:!0}),ns_id:t=0,deviceType:r=c.getDeviceType(),web_request_id:o=i.REQUEST_ID,source_action:d=s.PreviewSourceAction.Visit,subfolder_nav_tracking:u,has_cached_data:p,use_odyssey:m=!1,folder_id:h}={}){return{id:e,ns_id:t,web_request_id:o,deviceType:r,extra:{start_time:d===s.PreviewSourceAction.Visit?a.start_time():n.now(),subfolder_nav_tracking:u,has_cached_data:p,source_action:d,folder_preview_timeline:{},use_odyssey:m,folder_id:h}}},t.markPrimaryEvent=function(e){const{extra:t}=e;if(t.primary_mark_ts)return;const r=n.now();t.primary_mark_ts=r;const{start_time:o}=t;o&&t.primary_mark_ts&&(t.time_to_primary_mark=t.primary_mark_ts-o)},t.logEvent=function(e,t){const{extra:{folder_preview_timeline:r}}=t,i=n.now();if(!r.preview_session_ended_ts){switch(e){case d.attempted:if(r.preview_attempted_ts)return;r.preview_attempted_ts=i;break;case d.ended:if(r.preview_session_ended_ts)return;r.preview_session_ended_ts=i;break;case d.renderSucceeded:if(r.render_succeeded_ts)return;r.render_succeeded_ts=i;break;case d.renderFailed:if(r.render_failed_ts)return;r.render_failed_ts=i}return(function(e,t){return o.SilentBackgroundBeaconRequest({url:"/log/folder_preview",data:Object.assign(Object.assign({},m(t)),{event_name:e})})})(e,t)}}})),define("modules/clean/prefetch/prefetch",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPrefetchData=void 0,t.getPrefetchData=function(e){const t=window[e];if(t)return(function(e){return new Promise((t,r)=>{const o=e.getDataIfAvailable();o?o.payload?t(JSON.parse(o.payload)):r(o.error):e(e=>t(JSON.parse(e)),r)})})(t)}})),define("modules/clean/react/shared_link_folder/api",["require","exports","modules/clean/prefetch/prefetch","modules/clean/deprecated_ajax/ajax_jquery"],(function(e,t,r,o){"use strict";function n(e){return{_mount_access_perms:e._mount_access_perms,filename:e.filename,href:e.href,is_dir:e.is_dir,ns_id:e.ns_id,open_in_app_data:e.open_in_app_data,shared_folder_id:e.shared_folder_id,sort_key:e.sort_key,folder_id:e.folder_id}}function i(e){return{canCopyToDropboxRoles:e.canCopyToDropboxRoles,canDownloadRoles:e.canDownloadRoles,canPrintRoles:e.canPrintRoles,canRemoveLinkUids:e.canRemoveLinkUids,canSyncToDropboxRoles:e.canSyncToDropboxRoles,canViewContextMenuRoles:e.canViewContextMenuRoles,canViewMetadataRoles:e.canViewMetadataRoles,isEditFolderLink:e.isEditFolderLink,syncVarsByRoles:e.syncVarsByRoles}}function s(e){return{itemId:e.itemId,linkKey:e.linkKey,linkType:e.linkType,secureHash:e.secureHash,subPath:e.subPath,rlkey:e.rlkey}}function a(e){const t=[];for(const o of e.entries)o.is_dir?t.push(n(o)):t.push({is_dir:(r=o).is_dir,filename:r.filename,sort_key:r.sort_key,href:r.href,bytes:r.bytes,preview:r.preview,ns_id:r.ns_id,preview_type:r.preview_type?r.preview_type:null,sjid:r.sjid,ts:r.ts,thumbnail_url_tmpl:r.thumbnail_url_tmpl,file_id:r.file_id,revision_id:r.revision_id,is_symlink:!1});var r;const o=e.share_permissions.map(i),a=e.share_tokens.map(s);return{entries:t,folder:n(e.folder),folderSharedLinkInfo:e.folder_shared_link_info,folderSharePermission:i(e.folder_share_permission),folderShareToken:s(e.folder_share_token),hasMoreEntries:e.has_more_entries,nextRequestVoucher:e.next_request_voucher,sharedLinkInfos:e.shared_link_infos,sharePermissions:o,shareTokens:a,takedownRequestType:e.takedown_request_type}}function l(e,t,r){const n={link_key:e.linkKey,link_type:e.linkType,secure_hash:e.secureHash,sub_path:e.subPath||""};return t&&(n.voucher=t),e.rlkey&&(n.rlkey=e.rlkey),new Promise((e,t)=>o.WebRequest({type:"POST",url:"/list_shared_link_folder_entries",data:n,dataType:"json",success:(t,o,n)=>{if(r){const e=n.getResponseHeader("x-dropbox-request-id");r.end(e||void 0)}e(a(t))},error(e,r,o){t(new Error(o))}}))}Object.defineProperty(t,"__esModule",{value:!0}),t.fetchNextPage=t.prefetchFirstPage=t.fetchPreviewAndSharingData=t.fetchPage=t.deserializePage=void 0,t.deserializePage=a,t.fetchPage=l,t.fetchPreviewAndSharingData=function(e){return l(e)},t.prefetchFirstPage=function(e){return(function(){const e=r.getPrefetchData("__REGISTER_SHARED_LINK_FOLDER_PRELOAD_HANDLER");if(e)return e.then(a)})()||l(e)},t.fetchNextPage=function(e,t){return l(e,t)}})),define("modules/clean/react/shared_link_folder/api_odyssey",["require","exports","tslib","modules/clean/prefetch/prefetch","modules/clean/react/shared_link_folder/api","modules/clean/filepath/filepath"],(function(e,t,r,o,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.prefetchFirstPage=t.deserializeFile=t.deserializeFolder=t.deserializeOdysseyResponse=void 0,i=r.__importStar(i);function s(e){const t=[],r=e.paginated?e.first_page.items:e.file_info;for(const e of r)e.is_dir?t.push(a(e)):t.push(l(e));return{entries:t,hasMoreEntries:e.paginated&&e.first_page.has_more_items,nextRequestVoucher:e.paginated?e.first_page.next_request_voucher:void 0}}function a(e){return{_mount_access_perms:e.mount_access_perms,filename:i.filename(e.fq_path),href:"",is_dir:!0,ns_id:e.ns_id,open_in_app_data:void 0,shared_folder_id:void 0,sort_key:[e.sort_key]}}function l(e){return{bytes:e.bytes,file_id:e.file_id,filename:i.filename(e.fq_path),href:"",is_dir:!1,is_symlink:e.is_symlink,ns_id:e.ns_id,revision_id:e.revision_id,sjid:e.sjid,sort_key:[e.sort_key],ts:e.ts}}t.deserializeOdysseyResponse=s,t.deserializeFolder=a,t.deserializeFile=l,t.prefetchFirstPage=function(e){return(function(){const e=o.getPrefetchData("__REGISTER_ODYSSEY_SHARED_LINK_FOLDER_PRELOAD_HANDLER");if(e)return e.then(s)})()||n.fetchPage(e)}})),define("modules/clean/react/shared_link_folder/data/actions",["require","exports","tslib","modules/clean/file_store/actions","modules/clean/react/shared_link_folder/api","modules/clean/react/shared_link_folder/api_odyssey","modules/clean/react/shared_link_folder/data/types","modules/clean/file_store/utils","modules/clean/previews/data/actions","modules/clean/redux/constants","modules/clean/react/shared_link_folder/utils"],(function(e,t,r,o,n,i,s,a,l,c,d){"use strict";function u(e,t){const{file:o,fileMetadata:n}=(function(e){if(!e)return{file:void 0,fileMetadata:void 0};const{file:t}=e;return{file:t,fileMetadata:r.__rest(e,["file"])}})(t),i=o&&a.getFileStoreId(o);return{type:s.Actions.HydrateSharedFolder,payload:{fileId:i,fileMetadata:n,folderPackage:Object.assign(Object.assign({},e),{entries:e.entries.length?e.entries:i?[{type:"file",id:i}]:[]})}}}function p(e,t){const r=d.getSecureHashOrSubPath(e),o=[],n={};for(const e of t)if(e.is_dir){const t=e.filename;o.push({type:"folder",id:t}),n[t]={folder:e,entries:[],hasMore:!0}}else o.push({type:"file",id:a.getFileRevisionId(e)});return{type:s.Actions.HydrateEntries,payload:{secureHashOrSubPath:r,entries:o,folderPackageMap:n}}}function m(e){return{type:s.Actions.FetchPageRequest,payload:e}}function h(e,t){return{type:s.Actions.FetchPageSuccess,payload:{fileMetadata:e,folderPackage:t}}}function f(e,t){return function r(i,l=0){const{files:c,fileMetadata:u,folderPackage:p}=(function(e,t,r=0){const{entries:o,hasMoreEntries:n,sharedLinkInfos:i,sharePermissions:l,shareTokens:c,takedownRequestType:u}=e,p={},m={[t]:{entries:[],fromIndex:r,hasMore:n,takedownRequestType:u,folder:e.folder,sharedLinkInfo:e.folderSharedLinkInfo,sharePermission:e.folderSharePermission,shareToken:e.folderShareToken}},h=[];return o.forEach((e,r)=>{if(s.isFile(e)){const o=a.getFileStoreId(e);h.push(e),p[o]={sharedLinkInfo:i[r],sharePermission:l[r],shareToken:c[r]},m[t].entries.push({type:"file",id:o})}else{const o=d.getSecureHashOrSubPath(c[r]);m[t].entries.push({type:"folder",id:o}),m[o]={folder:e,fromIndex:0,hasMore:!0,sharedLinkInfo:i[r],sharePermission:l[r],shareToken:c[r]}}}),{files:h,fileMetadata:p,folderPackage:m}})(i,d.getSecureHashOrSubPath(t),l);e(o.putFiles(c)),e(h(u,p)),i.hasMoreEntries&&i.nextRequestVoucher&&n.fetchNextPage(t,i.nextRequestVoucher).then(e=>r(e,l+i.entries.length))}}function _(e,t){return r=>{const{entries:n,sharedLinkInfos:i,sharePermissions:u,shareTokens:p}=t;if(!n)return;const m=[],h={},f={},_=[];n.forEach((e,t)=>{if(s.isFile(e)){const r=a.getFileStoreId(e);h[r]={sharedLinkInfo:i[t],sharePermission:u[t],shareToken:p[t]},m.push(e),_.push({type:"file",id:a.getFileRevisionId(e)})}else{const r=d.getSecureHashOrSubPath(p[t]);f[r]={entries:[],folder:e,fromIndex:0,hasMore:!0,sharedLinkInfo:i[t],sharePermission:u[t],shareToken:p[t]},_.push({type:"folder",id:r})}}),r(o.putFiles(m)),r(l.updatePreviewData(l.buildPreviewData(m,c.ApiClientStatus.Success))),r({type:s.Actions.HydratePreviewAndSharingData,payload:{parentSecureHashOrSubPath:e,parentFolderEntries:_,fileMetadataMap:h,folderPackageMap:f}})}}Object.defineProperty(t,"__esModule",{value:!0}),t.hydratePreviewAndSharingData=t.fetchFolder=t.prefetchFolderFromOdyssey=t.prefetchFolder=t.fetchPageSuccess=t.hydrateEntries=t.hydrateSharedFolderAndFile=void 0,n=r.__importStar(n),i=r.__importStar(i),t.hydrateSharedFolderAndFile=function(e,t){return r=>{t&&r(o.putFile(t.file)),r(u(e,t))}},t.hydrateEntries=p,t.fetchPageSuccess=h,t.prefetchFolder=function(e,t){return t=>{t(m(e));const r=n.prefetchFirstPage(e);return r.then(f(t,e)),r}},t.prefetchFolderFromOdyssey=function(e,t){return r=>{const u=n.fetchPreviewAndSharingData(e);return r(m(e)),i.prefetchFirstPage(e).then(n=>{const{files:i,entries:m}=(function(e,t){const r=e.entries,o=t?t.file:void 0;return{files:r.filter(s.isFile).map(e=>o&&a.areFilesEqual(o,e)?o:e),entries:r}})(n,t);r(o.putFiles(i)),r(l.updatePreviewData(l.buildPreviewData(i,c.ApiClientStatus.Request))),r(p(e,m)),u.then(t=>{const o=d.getSecureHashOrSubPath(e);r(_(o,t)),f(r,e)(t)})}),u}},t.fetchFolder=function(e,t){return r=>(r(m(e)),n.fetchPage(e,void 0,t).then(f(r,e)))},t.hydratePreviewAndSharingData=_})),define("modules/clean/react/shared_link_folder/data/reducer",["require","exports","tslib","lodash","modules/clean/react/shared_link_folder/data/types","modules/clean/react/shared_link_folder/utils","modules/clean/react/shared_link_folder/utils"],(function(e,t,r,o,n,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sharedLinkFolderReducer=void 0,o=r.__importStar(o);const a={fileMetadata:{},folderPackage:{},rlkey:""};t.sharedLinkFolderReducer=function(e=a,t){switch(t.type){case n.Actions.FetchPageRequest:{const{payload:r}=t,o=r.rlkey?r.rlkey:e.rlkey,n=s.getSecureHashOrSubPath(r),i=e.folderPackage[n];return i?Object.assign(Object.assign({},e),{folderPackage:Object.assign(Object.assign({},e.folderPackage),{[n]:Object.assign(Object.assign({},i),{hasMore:!0})}),rlkey:o}):e}case n.Actions.HydrateSharedFolder:{const{fileId:r,fileMetadata:o,folderPackage:n}=t.payload,i=s.getSecureHashOrSubPath(n.shareToken),a=null!=r?{[r]:o}:{};return Object.assign(Object.assign({},e),{fileMetadata:Object.assign(Object.assign({},e.fileMetadata),a),folderPackage:Object.assign(Object.assign({},e.folderPackage),{[i]:Object.assign(Object.assign({},n),{hasMore:!0})})})}case n.Actions.HydrateEntries:{const{secureHashOrSubPath:r,entries:o,folderPackageMap:n}=t.payload,i=e.folderPackage[r];return Object.assign(Object.assign({},e),{folderPackage:Object.assign(Object.assign(Object.assign({},e.folderPackage),n),{[r]:Object.assign(Object.assign({},i),{entries:o})})})}case n.Actions.FetchPageSuccess:{const{fileMetadata:o,folderPackage:n}=t.payload,s={};return Object.keys(n).forEach(t=>{const o=e.folderPackage[t]||{},a=n[t],{fromIndex:l}=a,c=r.__rest(a,["fromIndex"]);s[t]=Object.assign(Object.assign(Object.assign({},o),c),{entries:i.mergeFolderEntries(o.entries,c.entries,l,!c.hasMore)})}),Object.assign(Object.assign({},e),{fileMetadata:Object.assign(Object.assign({},e.fileMetadata),o),folderPackage:Object.assign(Object.assign({},e.folderPackage),s)})}case n.Actions.HydratePreviewAndSharingData:{const{fileMetadataMap:r,folderPackageMap:n,parentSecureHashOrSubPath:i,parentFolderEntries:s}=t.payload,a=o.values(n).map(e=>e.folder.filename),l=Object.keys(e.folderPackage).filter(e=>-1===a.indexOf(e)).reduce((t,r)=>(t[r]=e.folderPackage[r],t),{});return Object.assign(Object.assign({},e),{fileMetadata:Object.assign(Object.assign({},e.fileMetadata),r),folderPackage:Object.assign(Object.assign(Object.assign({},l),n),{[i]:Object.assign(Object.assign({},e.folderPackage[i]),{entries:s})})})}}return e}})),define("modules/clean/react/shared_link_folder/data/selectors",["require","exports","tslib","lodash","modules/clean/redux/namespaces","modules/clean/file_store/selectors","modules/clean/react/shared_link_folder/utils"],(function(e,t,r,o,n,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getFolderShareTokenWithState=t.getSharedFilePackageByFilenameForFolderPath=t.getSharedFilePackagesForFolderPath=t.getSubfoldersForFolderPath=t.getFolderByPath=void 0,o=r.__importStar(o);const a=e=>e[n.SHARED_LINK_FOLDER_NAMESPACE_KEY];t.getFolderByPath=(e,t)=>{const{folderPackage:r}=a(e);return r[t]};const l=(e,r)=>{const o=t.getFolderByPath(e,r);return o?o.entries.filter(e=>"file"===e.type).map(e=>e.id):[]};function c(e,t){const r=i.getFile(e,t);if(!r)return;const o=((e,t)=>a(e).fileMetadata[t])(e,t);return Object.assign(Object.assign({},o),{file:r})}t.getSubfoldersForFolderPath=(e,r)=>{const o=t.getFolderByPath(e,r);if(o)return o.entries.filter(e=>"folder"===e.type).map(t=>((e,t)=>a(e).folderPackage[t])(e,t.id))},t.getSharedFilePackagesForFolderPath=(e,t)=>l(e,t).map(t=>c(e,t)).filter(Boolean),t.getSharedFilePackageByFilenameForFolderPath=(e,t,r)=>{const n=((e,t,r)=>{if(!r)return;const n=l(e,t);return o.find(n,t=>{const o=i.getFile(e,t);return void 0!==o&&o.filename===r})})(e,t,r);if(n)return c(e,n)},t.getFolderShareTokenWithState=(e,t)=>{const r=a(e).rlkey,o=r||t.rlkey;return s.getFolderShareTokenWithRlkey(t,o)}})),define("modules/clean/react/shared_link_folder/data/store",["require","exports","tslib","lodash","modules/clean/file_store/reducer","modules/clean/react/file_viewer/data/reducer","modules/clean/react/shared_link_folder/data/actions","modules/clean/react/shared_link_folder/data/reducer","modules/clean/redux/store","modules/clean/redux/namespaces"],(function(e,t,r,o,n,i,s,a,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.hydrateStore=t.getStoreForSharedLinkFolder=void 0,o=r.__importStar(o),t.getStoreForSharedLinkFolder=o.once(()=>{const e={[c.FILE_NAMESPACE_KEY]:n.fileNamespaceReducer,[c.FILE_VIEWER_NAMESPACE_KEY]:i.fileViewerReducer,[c.SHARED_LINK_FOLDER_NAMESPACE_KEY]:a.sharedLinkFolderReducer};return l.getStoreAndRegisterReducers(e)}),t.hydrateStore=function(e,{initialPreview:t,initialFolder:r,folderSharedLinkInfo:o,folderSharePermission:n,folderShareToken:i}){const a={folder:r,sharedLinkInfo:o,sharePermission:n,shareToken:i,hasMore:!0,entries:[]};e.dispatch(s.hydrateSharedFolderAndFile(a,t))}})),define("modules/clean/react/shared_link_folder/data/types",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TakedownType=t.Actions=t.isFile=void 0,t.isFile=function(e){return!e.is_dir},(function(e){e.HydrateSharedFolder="SHARED_FOLDER/HYDRATE",e.HydrateEntries="SHARED_FOLDER/HYDRATE_ENTRIES",e.HydratePreviewAndSharingData="SHARED_FOLDER/HYDRATE_PREVIEW_AND_SHARING_DATA",e.FetchPageSuccess="SHARED_FOLDER/FETCH_SUCCESS",e.FetchPageRequest="SHARED_FOLDER/FETCH_REQUEST"})(t.Actions||(t.Actions={})),(function(e){e[e.DMCA=1]="DMCA",e[e.MALWARE=2]="MALWARE",e[e.ILLEGAL=3]="ILLEGAL",e[e.OTHER=4]="OTHER",e[e.SPAM=5]="SPAM",e[e.TERROR=6]="TERROR",e[e.CSAI=7]="CSAI",e[e.PHISHING=8]="PHISHING"})(t.TakedownType||(t.TakedownType={}))})),define("modules/clean/react/shared_link_folder/folder_icon",["require","exports","tslib","react","modules/clean/react/shared_link_folder/utils","spectrum/icon_content/index","modules/clean/react/icon/icon_helper"],(function(e,t,r,o,n,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SharedLinkFolderFolderIcon=void 0,o=r.__importDefault(o),t.SharedLinkFolderFolderIcon=({className:e,folder:t,size:r})=>o.default.createElement(i.IconContent,{className:e,name:s.spectrumFolderIcon({size:r,isConfidential:n.isNoAccessFolder(t)})})})),define("modules/clean/react/shared_link_folder/folder_title",["require","exports","tslib","react","modules/constants/trademark","modules/core/uri","modules/core/i18n","modules/clean/react/shared_link_folder/utils","modules/clean/react/async/loadable"],(function(e,t,r,o,n,i,s,a,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ContentOwner=t.FolderTitle=void 0,o=r.__importDefault(o);const c=l.Loadable({loader:()=>new Promise((t,r)=>{e(["modules/clean/react/breadcrumb/trail"],t,r)}).then(r.__importStar).then(({BreadcrumbTrail:e})=>e)});class d extends o.default.PureComponent{constructor(){super(...arguments),this.handleCrumbClick=(e,t,r)=>{const{onCrumbClick:o}=this.props;e.preventDefault(),a.navigateToFolderHref(t.href),o&&o(r)}}render(){const{breadcrumbs:e,ownerName:r,ownerTeamLogo:n,ownerTeamName:i,title:s}=this.props;return o.default.createElement("div",{className:"sl-folder-title"},e&&e.length>0?o.default.createElement(c,Object.assign({},(e=>{let t,r;return e.length<=2?t=e:(t=e.slice(e.length-1),r=e.slice(0,e.length-1)),{inlineCrumbs:t,overflowCrumbs:r}})(e),{onChange:this.handleCrumbClick})):s,i?o.default.createElement(t.ContentOwner,{ownerName:r,ownerTeamName:i,ownerTeamLogo:n}):null)}}t.FolderTitle=d,d.displayName="FolderTitle";const u=new i.URI({path:"/business",query:{src:"schmodel"}}).toString();t.ContentOwner=({ownerName:e,ownerTeamName:t,ownerTeamLogo:r})=>o.default.createElement("div",{className:"sl-subtitle"},null!=e?s.intl.formatMessage({id:"V1gDEG",defaultMessage:"from {owner} ({team})"},{owner:e,team:t}):s.intl.formatMessage({id:"mL9XU3",defaultMessage:"from {team}"},{team:t}),null!=r?o.default.createElement("span",null," ","via ",o.default.createElement("a",{href:u},n.TRADEMARK_BUSINESS)):null)})),define("modules/clean/react/shared_link_folder/grid",["require","exports","tslib","react","classnames","modules/clean/em_string","modules/clean/previews/constants","modules/clean/react/icon/icon_helper","modules/clean/react/shared_link_folder/folder_icon","modules/clean/react/file_viewer/url_utils","modules/clean/react/thumbnail","spectrum/tooltip/index","modules/core/i18n"],(function(e,t,r,o,n,i,s,a,l,c,d,u,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FolderCell=t.FileCell=t.SharedLinkFolderGrid=t.FileTitle=void 0,o=r.__importDefault(o),n=r.__importDefault(n);function m({label:e,filename:t}){const r=o.default.createElement("span",{className:"sl-grid-filename"},e);return t===e?r:o.default.createElement(u.Tooltip,{positioning:"below",tooltipContent:t,wrapperClassName:"sl-grid-tooltip-wrapper"},r)}function h({entry:e,onFolderOpen:t,onFileOpen:r,largeGrid:n}){const s=i.Emstring.em_snippet(e.filename,16);return e.is_dir?o.default.createElement(_,{folder:e,label:s,onOpen:t,largeGrid:n}):o.default.createElement(f,{file:e,label:s,onOpen:r,largeGrid:n})}t.FileTitle=m,t.SharedLinkFolderGrid=function({entries:e,onFileOpen:t,onFolderOpen:r,largeGrid:n}){let i="sl-grid-cell";return n&&(i+="-lg"),o.default.createElement("div",{className:"sl-grid"},o.default.createElement("div",{className:"sl-grid-header clearfix"},o.default.createElement("div",{className:"sl-grid-header-column sl-grid-header-column--sort"},p.intl.formatMessage({id:"gTD7Ga",defaultMessage:"Sorted by name"}))),o.default.createElement("ol",{className:"sl-grid-body"},e.map(e=>o.default.createElement("li",{className:i,key:e.filename},o.default.createElement(h,{entry:e,onFolderOpen:r,onFileOpen:t,largeGrid:n})))))};class f extends o.default.PureComponent{constructor(){super(...arguments),this.handleClick=c.linkClickHandler(e=>{e.preventDefault();const{file:t,onOpen:r}=this.props;r(t)})}isVideo(){return this.props.file.preview_type===s.PreviewType.Video}render(){const{file:e,label:t,largeGrid:r}=this.props,i=n.default("sl-link sl-link--file",{"sl-link--disabled":""===e.href});let s="sl-grid-thumbnail-container",l="sl-grid-thumbnail";return r&&(s="sl-grid-thumbnail-container-lg",l="sl-grid-thumbnail-lg"),o.default.createElement("a",{href:e.href,onClick:this.handleClick,className:i},o.default.createElement("div",{className:s},o.default.createElement(d.ThumbnailIcon,{alt:e.filename,className:l,file:e,iconSize:a.SpectrumIconSize.Large}),this.isVideo()?o.default.createElement("div",{className:"sl-video-watermark"}):null),o.default.createElement(m,{label:t,filename:e.filename}))}}t.FileCell=f,f.displayName="FileCell";class _ extends o.default.PureComponent{constructor(){super(...arguments),this.handleClick=c.linkClickHandler(e=>{e.preventDefault();const{folder:t,onOpen:r}=this.props;r(t)})}render(){const{folder:e,label:t,largeGrid:r}=this.props,i=n.default("sl-link sl-link--folder",{"sl-link--disabled":""===e.href});let s="sl-grid-thumbnail-container",c="sl-grid-thumbnail";return r&&(s="sl-grid-thumbnail-container-lg",c="sl-grid-thumbnail-lg"),o.default.createElement("a",{href:e.href,onClick:this.handleClick,className:i},o.default.createElement("div",{className:s},o.default.createElement(l.SharedLinkFolderFolderIcon,{className:c,folder:e,size:a.SpectrumIconSize.Large})),o.default.createElement(m,{label:t,filename:e.filename}))}}t.FolderCell=_,_.displayName="FolderCell"})),define("modules/clean/react/shared_link_folder/list",["require","exports","tslib","react","classnames","spectrum/table/index","spectrum/media_table/index","modules/clean/datetime/datetime","modules/clean/em_string","modules/clean/react/shared_link_folder/folder_icon","modules/clean/react/thumbnail","modules/core/i18n","modules/core/uri","modules/clean/react/size_class/constants","modules/clean/react/file_viewer/url_utils","modules/clean/display_format"],(function(e,t,r,o,n,i,s,a,l,c,d,u,p,m,h,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SharedLinkFolderList=void 0,o=r.__importDefault(o),n=r.__importDefault(n);const _=["1 1 50%","1 1 30%","1 1 20%"];function g({entry:e,sizeClass:t,onFolderOpen:r,onFileOpen:n,smallList:i}){return e.is_dir?o.default.createElement(y,{folder:e,sizeClass:t,onOpen:r,smallList:i}):o.default.createElement(b,{file:e,sizeClass:t,onOpen:n,smallList:i})}function v({icon:e,lastModified:t,name:r,fileSize:i,sizeClass:c,onClick:d,href:u,smallList:p}){const _=h.linkClickHandler(e=>{e.preventDefault(),"function"==typeof d&&d()}),g=n.default("sl-list-row",{"sl-list-row--disabled":""===u});return o.default.createElement(s.MediaRow,{className:g},o.default.createElement(s.MediaCell,{className:"sl-list-column--filename",icon:e,title:l.Emstring.em_snippet(r,40)},o.default.createElement("a",{href:u,"aria-label":r,onClick:_})),c!==m.SizeClass.Small?o.default.createElement(s.MediaCell,{className:"sl-list-column--modified",title:t?a.format_date(t,a.localized_datetime_format):"--"}):null,p?o.default.createElement(s.MediaCell,{className:"sl-list-column--size",title:i?f.format_bytes(i):"--"}):null)}function y({folder:e,sizeClass:t,onOpen:r,smallList:n}){let i="";if(""!==e.href){i=p.URI.parse(e.href).updateQuery({lst:""}).toString()}return o.default.createElement(v,{icon:o.default.createElement(c.SharedLinkFolderFolderIcon,{className:"sl-list-icon",folder:e}),href:i,name:e.filename,onClick:()=>r(e),sizeClass:t,smallList:n})}function b({file:e,sizeClass:t,onOpen:r,smallList:n}){return o.default.createElement(v,{icon:o.default.createElement(d.ThumbnailIcon,{alt:e.filename,className:"sl-list-icon",file:e}),lastModified:new Date(1e3*e.ts),name:e.filename,fileSize:e.bytes,href:e.href,onClick:()=>r(e),sizeClass:t,smallList:n})}t.SharedLinkFolderList=function({entries:e,sizeClass:t,onFileOpen:r,onFolderOpen:s,smallList:a}){return o.default.createElement(i.Table,{columnFlex:_,className:n.default("sl-list-container",{"sl-list-container-condensed-list":a})},o.default.createElement(i.TableHead,null,o.default.createElement(i.TableHeadCell,null,u.intl.formatMessage({id:"cJojIg",defaultMessage:"Name"})),t!==m.SizeClass.Small?o.default.createElement(i.TableHeadCell,null,u.intl.formatMessage({id:"wqMlXT",defaultMessage:"Modified"})):null,a?o.default.createElement(i.TableHeadCell,null,u.intl.formatMessage({id:"QG1cgy",defaultMessage:"Size"})):null),o.default.createElement(i.TableBody,null,e.map(e=>o.default.createElement(g,{key:e.filename,entry:e,sizeClass:t,onFileOpen:r,onFolderOpen:s,smallList:a}))))}})),define("modules/clean/react/shared_link_folder/utils",["require","exports","tslib","modules/core/uri","modules/clean/history","modules/core/notify","modules/core/i18n","spectrum-sharing/utils/sharing_constants","modules/clean/viewer"],(function(e,t,r,o,n,i,s,a,l){"use strict";function c(e){const{_mount_access_perms:t}=e;return null!=t&&!t.includes("can_view")}function d(e,t=!1){const r=o.URI.parse(e);"lst"in n.default.get_uri().getQuery()&&r.updateQuery({lst:""}),t&&r.updateQuery({subfolder_nav_tracking:"1"}),(function(e){let t=e.getPath();try{t=decodeURIComponent(t)}catch(e){}n.default.push_state(o.URI.encode_parts(t),e.getQuery())})(r)}function u(e){return e.linkType===a.SharedLinkType.Content?e.subPath.startsWith("/")?e.subPath:`/${e.subPath}`:e.secureHash}function p(e){return l.Viewer.get_viewer().is_signed_in?s.intl.formatMessage({id:"dbYCaa",defaultMessage:"{folder_name} - Dropbox"},{folder_name:e}):s.intl.formatMessage({id:"3J1lxt",defaultMessage:"Dropbox - {folder_name} - Simplify your life"},{folder_name:e})}function m(e,t,r=0,o=!1){if(!Array.isArray(t))return e||[];if(!t.length)return[];if(!Array.isArray(e))return t;const n=[...e];return n.splice(r,t.length,...t),o?n.slice(0,r+t.length):n}Object.defineProperty(t,"__esModule",{value:!0}),t.mergeFolderEntries=t.mergeListChunk=t.setPageTitle=t.generatePageTitle=t.shouldUpdateFolderHierarchy=t.getSecureHashOrSubPath=t.getFolderShareTokenWithRlkey=t.getFolderShareTokenFromLocation=t.removeRlkeyFromURL=t.openFolder=t.navigateToFolderHref=t.isNoAccessFolder=void 0,n=r.__importDefault(n),t.isNoAccessFolder=c,t.navigateToFolderHref=d,t.openFolder=function(e){c(e)?i.Notify.error(s.intl.formatMessage({id:"IzGklK",defaultMessage:"Can’t open {folder_name}. Ask your admin for access."},{folder_name:e.filename})):d(e.href,!0)},t.removeRlkeyFromURL=function(){n.default.remove_query_param("rlkey")},t.getFolderShareTokenFromLocation=function(e){let t=e.path;const r=e.query;let o="";r&&r.rlkey&&(o=r.rlkey.toString());let n=a.SharedLinkType.Shmodel;"/sh"===t.substr(0,3)?(n=a.SharedLinkType.Shmodel,t=t.substring(4,t.length)):"/scl/fo"===t.substr(0,7)&&(n=a.SharedLinkType.Content,t=t.substring(8,t.length));const[i,s,...l]=t.split("/");return{linkKey:i,linkType:n,secureHash:s,subPath:l.join("/"),rlkey:o}},t.getFolderShareTokenWithRlkey=function(e,t){return Object.assign(Object.assign({},e),{rlkey:t||e.rlkey})},t.getSecureHashOrSubPath=u,t.shouldUpdateFolderHierarchy=function(e,t,r){if(t.linkType===a.SharedLinkType.Content&&r.linkType===a.SharedLinkType.Content){return!e[u(r)]}const{secureHash:o,subPath:n}=r,{secureHash:i,subPath:s}=t;return!e[o]||n.startsWith(s)&&e[i].length>=e[o].length},t.generatePageTitle=p,t.setPageTitle=function(e){document.title=p(e)},t.mergeListChunk=m,t.mergeFolderEntries=m})),define("modules/clean/react/share_sync/actions",["require","exports","tslib","modules/clean/sharing/shared_content_link_mount_folder","modules/clean/sharing/ui_notifications_util","modules/core/i18n","modules/clean/viewer"],(function(e,t,r,o,n,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.syncToDropbox=void 0,o=r.__importStar(o),t.syncToDropbox=function(t,a,l,c,d,u,p){if(d&&u){let o;if("anonymous"!==a){o=s.Viewer.get_viewer().get_uid_by_role(a)}o||(o=-1);const l={activeUserId:o,accessLevel:u.access_level,folderName:u.sync_folder_name,folderSize:u.sync_folder_size,nsId:t,role:a,previewUrl:null==u?void 0:u.sync_preview_url,outOfQuotaQP:null==u?void 0:u.sync_out_of_quota_qp,clickOutToClose:!0,fromLinkAccess:d,encryptionOptions:c,rlkey:p};new Promise((t,r)=>{e(["modules/clean/sharing/shared_content_link_sync_modal"],t,r)}).then(r.__importStar).then(e=>{e.showSharedContentLinkSyncModal(l)}).catch(()=>{n.sharingNotificationError(i.intl.formatMessage({id:"WWCt7I",defaultMessage:"Something went wrong, please try again."}))})}else o.mountSharedFolder(t,a,l,!0,!1,null,void 0,c,d,p)}})),define("modules/clean/react/share_sync/button",["require","exports","tslib","react","modules/clean/filepath/filepath","modules/clean/react/share_sync/models","spectrum-sharing/utils/sharing_constants","spectrum-sharing/utils/sharing_constants","modules/clean/sharing/views/sync_coachmark","modules/clean/viewer","modules/core/i18n","modules/constants/payments","modules/clean/analytics","dig-components/buttons","dig-components/menu"],(function(e,t,r,o,n,i,s,a,l,c,d,u,p,m,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ShareSyncButton=void 0,o=r.__importDefault(o),n=r.__importStar(n),s=r.__importStar(s),u=r.__importStar(u);class f extends o.default.Component{render(){const e=this.props.options.map(e=>o.default.createElement(h.Menu.ActionItem,{value:e,key:e.text,disabled:e.isDisabled},e.text));return o.default.createElement(h.Menu.Wrapper,{onSelection:e=>e.handler()},({getTriggerProps:t,getContentProps:r})=>o.default.createElement(o.default.Fragment,null,o.default.createElement(m.Button,Object.assign({},t(),{variant:"primary"}),this.props.targetText),o.default.createElement(h.Menu.Content,Object.assign({},r()),o.default.createElement(h.Menu.Segment,null,e))))}}f.displayName="SyncOptionsDropdown";class _ extends o.default.Component{constructor(){super(...arguments),this.logShareFolderPreviewUpgradeBtn=e=>{p.GrowthEventsLogger.log("wb_nq_pre_fo_up_b",{action:e,button_text:"Upgrade to Add Folder",destination_url:"http://www.dropbox.com/low-space",location:"top",quota_status:"near",upsell_type:"button"})},this.handleUpgradeButtonClick=()=>{this.logShareFolderPreviewUpgradeBtn("click"),this.logToTiburon("OUT_OF_QUOTA_UPGRADE_BUTTON_CLICK")}}componentDidUpdate(e){this.props.outOfQuota&&!this.props.shareToken.subPath&&e.shareToken.subPath&&this.logToTiburon("OUT_OF_QUOTA_UPGRADE_BUTTON_RENDER")}componentDidMount(){this.props.outOfQuota&&(this.logShareFolderPreviewUpgradeBtn("view"),this.logToTiburon("OUT_OF_QUOTA_UPGRADE_BUTTON_RENDER"))}logToTiburon(e){p.ShareTibEventLogger.log(this.props.user.id,e,a.SHARE_ACTION_ORIGIN_TYPE.PREVIEW_PAGE,{rlkey:this.props.shareToken.rlkey,ns_id:this.props.folder.shared_folder_id})}onClickedOption(e,t){e.preventDefault(),t.handler()}getSyncOptions(){const e=this.props.sharePermission.canSyncToDropboxRoles,t=c.Viewer.get_viewer(),r=e.map(e=>{const r=this.props.sharePermission.isEditFolderLink?this.props.sharePermission.syncVarsByRoles[e]:void 0;return i.ShareSyncActionOption.buildOption(this.props.folder,t,e,s.SHARE_ACTION_ORIGIN_TYPE.PREVIEW_PAGE,this.props.folderPreviewSession,this.props.shareToken.linkType,this.props.encryptionOptions,this.props.sharePermission.isEditFolderLink,this.props.shareToken.rlkey,r)});return 0!==t.get_users(!0).length||this.props.sharePermission.isEditFolderLink||r.push(i.ShareSyncActionOption.buildOption(this.props.folder,null,"anonymous",s.SHARE_ACTION_ORIGIN_TYPE.PREVIEW_PAGE,this.props.folderPreviewSession,this.props.shareToken.linkType,this.props.encryptionOptions,this.props.sharePermission.isEditFolderLink,this.props.shareToken.rlkey)),r}renderSyncCoachmark(){const e=this.props.sharePermission.canSyncToDropboxRoles.length>0;return this.props.showSyncCoachmark&&e?o.default.createElement("div",{className:"sync-button__coachmark-container"},o.default.createElement(l.SharingSyncCoachmark,null)):null}renderSyncButton(){var e;if(""!==this.props.shareToken.subPath)return null;const t="control__button sync-button";if(this.props.outOfQuota){const e=`${u.OUT_OF_SPACE_URL}?oqa=wb_oq_pre_fo_up_b`;return o.default.createElement("a",{className:t,href:e,onClick:this.handleUpgradeButtonClick},d.intl.formatMessage({id:"JhDJcU",defaultMessage:"Upgrade to Add Folder"}))}{let r;const i=this.getSyncOptions();if((null===(e=this.props.user)||void 0===e?void 0:e.is_cdm_member)&&1===i.length){const e=n.filename(this.props.user.cdm_tmf_path);r=e.length>25?d.intl.formatMessage({id:"6m85k6",defaultMessage:"Add to my member folder"}):d.intl.formatMessage({id:"nzqkZQ",defaultMessage:"Add to {cdm_tmf_name} folder"},{cdm_tmf_name:e})}else r=d.intl.formatMessage({id:"N8ovVA",defaultMessage:"Add to Dropbox"});if(1===i.length)return o.default.createElement(m.Button,{className:t,variant:"primary",style:{display:"-webkit-box"},onClick:e=>this.onClickedOption(e,i[0])},r);if(i.length>1){const e=r+" ▾";return o.default.createElement(f,{targetText:e,folder:this.props.folder,shareToken:this.props.shareToken,options:i})}return null}}render(){return o.default.createElement("div",null,this.renderSyncCoachmark(),this.renderSyncButton())}}t.ShareSyncButton=_,_.displayName="ShareSyncButton"})),define("modules/clean/react/share_sync/models",["require","exports","tslib","immutable","react","modules/clean/filepath/filepath","modules/clean/react/share_sync/actions","modules/core/i18n","modules/clean/loggers/folder_preview_logger","modules/clean/react/file_viewer/constants","spectrum-sharing/utils/sharing_constants","modules/clean/analytics","modules/core/browser"],(function(e,t,r,o,n,i,s,a,l,c,d,u,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ShareSyncActionOption=void 0,o=r.__importStar(o),n=r.__importDefault(n),i=r.__importStar(i),s=r.__importStar(s),p=r.__importStar(p);const m={text:void 0,handler:void 0,isDisabled:!1,spriteName:void 0};class h extends(o.Record(m)){static buildOption(e,t,r,o,m,f,_,g,v,y){let b,w=a.intl.formatMessage({id:"nlZiMz",defaultMessage:"Add to my Dropbox"}),S="dropbox";if(null!==t&&null!==r&&(b=t.get_user_by_role(r)),b&&b.is_cdm_member){const e=i.filename(b.cdm_tmf_path);w=e.length>12?a.intl.formatMessage({id:"6m85k6",defaultMessage:"Add to my member folder"}):a.intl.formatMessage({id:"ck1w+U",defaultMessage:"Add to <strong>{cdm_tmf_name}</strong> folder"},{cdm_tmf_name:e,strong:e=>n.default.createElement("strong",null,e)}),(null==t?void 0:t.is_paired)&&(S="s_briefcase")}else if(null==t?void 0:t.is_paired)switch(r){case"personal":w=a.intl.formatMessage({id:"temGiX",defaultMessage:"Add to personal Dropbox"}),S="s_house";break;case"work":w=a.intl.formatMessage({id:"m4EGX2",defaultMessage:"Add to {team_name} Dropbox"},{team_name:t.team_name}),S="s_briefcase"}return new h({text:w,handler:()=>{f===d.SharedLinkType.Shmodel&&l.logEvent(c.UserAction.AddToDropbox,m),b?u.ShareTibEventLogger.log(b.id,"ADD_TO_DROPBOX",d.SHARE_ACTION_ORIGIN_TYPE.PREVIEW_PAGE,{ns_id:e.shared_folder_id,rlkey:v}):u.ShareTibEventLogger.log_unauth("ADD_TO_DROPBOX",d.SHARE_ACTION_ORIGIN_TYPE.PREVIEW_PAGE,{ns_id:e.shared_folder_id,rlkey:v,scl_url:p.get_uri().toString()}),s.syncToDropbox(e.shared_folder_id,r,o,_,g,y,v)},spriteName:S})}}t.ShareSyncActionOption=h})),define("modules/clean/auth/multi_account_login_modal",["require","exports","tslib","react","modules/clean/auth/login/form","modules/clean/react/components/modal","modules/clean/viewer","modules/core/assert","modules/core/i18n","spectrum/modal/index"],(function(e,t,r,o,n,i,s,a,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TestOnlyMultiAccountLoginModal=t.TestOnlyAssumePersonalLockedModal=t.MultiAccountLoginModal=void 0,o=r.__importDefault(o);class d extends o.default.PureComponent{constructor(e){super(e),this.getUser=()=>{const{user:e,userId:t,role:r}=this.props;let o;return null!=e?o=e:null!=t?o=this.viewer.get_user_by_id(t,!0):null!=r&&(o=this.viewer.get_user_by_role(r,!0)),o},this.onLoginSuccess=e=>{this.viewer._sign_in_all_users(),this.props.onAuthenticateSuccess&&!this.props.continuationUrl&&this.props.onAuthenticateSuccess(),this.closeModal()},this.closeModal=e=>{e&&e.stopPropagation(),this.props.onCancel&&this.props.onCancel(),i.Modal.close()},a.assert(null!==e.onAuthenticateSuccess&&void 0!==e.onAuthenticateSuccess||null!==e.continuationUrl&&void 0!==e.continuationUrl,"onAuthenticateSuccess and continuationUrl are mutually exclusive"),this.viewer=s.Viewer.get_viewer()}render(){if(this.viewer.is_team_assume_user_session)return o.default.createElement(p,{displayName:this.viewer.display_name,onRequestClose:this.closeModal,open:!0,teamName:this.viewer.team_name});const e=this.getUser();return a.assert(null!=e,"invalid user"),a.assert(!this.viewer.is_user_signed_in(e),"called multi-account login for a user that's already signed in"),o.default.createElement(u,{onRequestClose:this.closeModal,onAuthenticateSuccess:this.onLoginSuccess,open:!0,continuationUrl:this.props.continuationUrl,teamName:this.viewer.team_name||"",user:e,encryptionOptions:this.props.encryptionOptions})}}t.MultiAccountLoginModal=d,d.displayName="MultiAccountLoginModal";const u=e=>{const{role:t}=e.user;if(!t)return null;const r="personal"===t?l.intl.formatMessage({id:"DCfdq9",defaultMessage:"Sign in to your personal Dropbox"}):l.intl.formatMessage({id:"L5lWSy",defaultMessage:"Sign in to your {team_name} Dropbox"},{team_name:e.teamName});return o.default.createElement(c.Modal,{appElement:document.body,ariaLabel:l.intl.formatMessage({id:"lggZdA",defaultMessage:"Multi-account login modal"}),bodyClassName:"multiaccount-login-modal",bodyId:"multiaccount-login-modal",className:"mc-util-modal",displayCloseButton:!0,onRequestClose:e.onRequestClose,open:e.open,overlayClassName:"file-viewer-modal-overlay"},o.default.createElement("div",{className:"mc-util-modal-header"},r),o.default.createElement("div",{className:"mc-util-modal-body"},o.default.createElement(n.LoginForm,{canRedirect:!!e.continuationUrl,continuationUrl:e.continuationUrl||void 0,emailProps:{initialValue:e.user.email,readonly:!0},googleLoginProps:{positionBelow:!1},maestroStyle:!0,onLoginSuccess:e.onAuthenticateSuccess,rememberMeCheckboxProps:{checked:!0},type:"multi",encryptionOptions:e.encryptionOptions})))};t.TestOnlyMultiAccountLoginModal=u;const p=e=>{const{displayName:t,onRequestClose:r,teamName:n}=e;return o.default.createElement(c.UtilityModal,{appElement:document.body,ariaLabel:l.intl.formatMessage({id:"XTU3gF",defaultMessage:"Personal account locked modal"}),className:"team-assume-user-modal",displayCloseButton:!0,onRequestClose:r,open:e.open,primaryAction:l.intl.formatMessage({id:"u/p3Pl",defaultMessage:"Close"}),title:l.intl.formatMessage({id:"YcDQxL",defaultMessage:"Personal account not accessible"})},o.default.createElement("div",null,l.intl.formatMessage({id:"9uHtUs",defaultMessage:"{display_name}’s personal account isn’t managed by the {team_name} team, so its contents aren’t accessible to admins."},{display_name:t,team_name:n})))};t.TestOnlyAssumePersonalLockedModal=p})),define("modules/clean/sharing/shared_content_link_mount_folder",["require","exports","tslib","react","modules/clean/browse_interface","modules/clean/react/components/modal","modules/clean/auth/multi_account_login_modal","modules/clean/sharing/api/client","api_v2/user_client","modules/clean/sharing/ui_notifications_util","modules/clean/viewer","modules/core/browser","modules/core/assert","modules/core/i18n","modules/clean/flux/dispatcher","modules/clean/sharing/share_page/action_types","modules/clean/auth/login_or_register/types","modules/clean/auth/login_or_register/modal","modules/clean/sharing/ui_util","spectrum-sharing/utils/sharing_constants","modules/clean/analytics","modules/clean/sharing/access_level"],(function(e,t,r,o,n,i,s,a,l,c,d,u,p,m,h,f,_,g,v,y,b,w){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mountSharedFolder=void 0,o=r.__importDefault(o),n=r.__importStar(n),u=r.__importStar(u),t.mountSharedFolder=function e(t,r,S,E,k=!1,M=null,T,P,O,A){const C=d.Viewer.get_viewer();let F;if("anonymous"===r){const e=e=>u.reload;return void i.Modal.showInstance(o.default.createElement(g.LoginOrRegisterModal,{downloadAction:_.DownloadAction.SAVE_TO_DROPBOX,id:"shared-link-immediate-signup-modal",initialMode:_.Mode.REGISTER,kind:_.LoginOrRegisterKind.DOWNLOAD,onAuthenticateSuccess:e,onCancel:u.reload,signup_tag:"shmodel_modal_register",encryptionOptions:P}))}if(r&&(C.is_role_signed_in(r)||i.Modal.showInstance(o.default.createElement(s.MultiAccountLoginModal,{encryptionOptions:P,role:r,onAuthenticateSuccess:()=>{e(t,r,S,E,!1,null,T)}}))),r){const e=C.get_uid_by_role(r);p.assert(!!e,"selected role should have corresponding uid"),F=e||-1}else p.assert(!C.is_paired,"role can not be unspecified for paired viewer"),F=C.get_user_ids()[0];let D=m.intl.formatMessage({id:"Zd8jt8",defaultMessage:"Adding to your Dropbox..."});C.is_paired&&(D=C.get_user_by_id(F).is_team?m.intl.formatMessage({id:"PTGTT4",defaultMessage:"Adding to your {team_name} Dropbox..."},{team_name:C.team_name}):m.intl.formatMessage({id:"IVdsoO",defaultMessage:"Adding to your personal Dropbox..."})),c.sharingNotificationInProgress(D,!1);const x=new a.FolderShareApiClient({userId:F,client:new l.UserApiV2Client});h.Dispatcher.dispatch({type:f.SharePageActionTypes.MOUNT_FOLDER_REQUEST,metadata:T,user:C.get_user_by_id(F),shared_folder_id:t}),(e=>e?x.addMembers({accessLevel:w.ACCESS_LEVEL.WRITER,contentId:t,members:[{".tag":"email",email:C.get_email_by_role(r)}],quiet:!0}):Promise.resolve())(O).then(()=>{x.mount({contentId:t}).then(e=>{(function(e){if(!e)return;let o=e;(null==M?void 0:M.ns_path)&&(o+=M.ns_path);const i=C.get_user_by_id(F),s=n.browse_uri_for_fq_path(i,o),a=k?"1":"0";s.updateQuery({from_scl_sync_modal:a});const l={role:r,file_id:M?M.file_id:null,ns_id:M?M.ns_id:t};b.ShareTibEventLogger.log(F,"BROWSE_SUCCESS",y.SHARE_ACTION_ORIGIN_TYPE.SYNC_MODAL,l),u.redirect(s.toString())})(e.path_lower)}).catch(e=>{const r=e&&e.error&&e.error[".tag"],o=y.SHARE_ACTION_ORIGIN_TYPE.PREVIEW_PAGE;b.ShareTibEventLogger.log(F,"ADD_TO_DROPBOX_MOUNT_ERROR",o,{ns_id:t,rlkey:A,error_tag:r,error_summary:e&&e.summary}),e&&e.error&&"insufficient_quota"===e.error[".tag"]?c.sharingNotificationError(m.intl.formatMessage({id:"jENkzW",defaultMessage:"Can’t add folder. Your Dropbox account is full."})):v.isTotalMountsExceededError(e)?c.failSnackbarWithHelpCenter(v.getTotalMountsExceededMountFoldersMsg(e),"/support"):v.isTreeSizeExceededError(e)?c.failSnackbarWithHelpCenter(v.getTreeSizeExceededMountFoldersMsg(e),"/support"):v.isHomeMountsExceededError(e)?c.failSnackbarWithHelpCenter(v.getHomeMountsExceededMountFoldersMsg(e),"/support"):c.sharingNotificationError(m.intl.formatMessage({id:"EQfnGr",defaultMessage:"We were unable to complete your request."}))})}).catch(e=>{const r=e&&e.error&&e.error[".tag"],o=y.SHARE_ACTION_ORIGIN_TYPE.PREVIEW_PAGE;b.ShareTibEventLogger.log(F,"ADD_TO_DROPBOX_ADD_MEMBER_ERROR",o,{ns_id:t,rlkey:A,error_tag:r}),c.sharingNotificationError(m.intl.formatMessage({id:"EQfnGr",defaultMessage:"We were unable to complete your request."}))})}})),define("spectrum/backdrop/index",["require","exports","tslib","spectrum/backdrop/backdrop"],(function(e,t,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r.__exportStar(o,t)})),define("spectrum/backdrop/backdrop",["require","exports","tslib","classnames","react"],(function(e,t,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Backdrop=void 0,o=r.__importDefault(o),n=r.__importStar(n),t.Backdrop=e=>{var{className:t,isVisible:i}=e,s=r.__rest(e,["className","isVisible"]);return i?n.createElement("div",Object.assign({className:o.default("mc-backdrop",t)},s)):null},t.Backdrop.displayName="Backdrop"})),define("spectrum/mobile_menu/mobile_menu",["require","exports","tslib","react","classnames","focus-trap-react","spectrum/backdrop/index","spectrum/mobile_menu/mobile_menu_content","spectrum/mobile_menu/mobile_menu_close_button","spectrum/portal/index","spectrum/scroll_locker/index"],(function(e,t,r,o,n,i,s,a,l,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MobileMenu=void 0,o=r.__importStar(o),n=r.__importDefault(n),i=r.__importDefault(i);class u extends o.Component{constructor(){super(...arguments),this.initBodyPadding="0",this.state={isVisible:!1},this.openMobileMenu=()=>{this.initBodyPadding=d.getBodyPadding(),this.setState({isVisible:!0},d.lockScroll)},this.closeMobileMenu=()=>{this.setState({isVisible:!1},()=>d.unlockScroll(this.initBodyPadding))},this.handleKeyDown=e=>{const t=e.key;if("Escape"===t)return void this.closeMobileMenu();const r=e.target;if("ArrowUp"===t||"ArrowLeft"===t){const e=r.previousElementSibling;e&&e.focus()}if("ArrowDown"===t||"ArrowRight"===t){const e=r.nextElementSibling;e&&e.focus()}}}render(){const e=this.props,{children:t,className:d,closeButton:u,trigger:p}=e,m=r.__rest(e,["children","className","closeButton","trigger"]);return o.createElement("div",Object.assign({className:n.default("mc-mobile-menu",d)},m),p({openMobileMenu:this.openMobileMenu}),this.state.isVisible?o.createElement(c.Portal,{isShowInitially:!0},o.createElement(i.default,{focusTrapOptions:{returnFocusOnDeactivate:!0}},o.createElement("div",{className:"mc-mobile-menu-container",onKeyDown:this.handleKeyDown},o.createElement(s.Backdrop,{onClick:this.closeMobileMenu,isVisible:!0}),o.createElement(a.MobileMenuContent,{closeMobileMenu:this.closeMobileMenu},o.createElement("div",{className:"mc-mobile-menu-section"},t),o.createElement("div",{className:"mc-mobile-menu-section"},u?u({closeMobileMenu:this.closeMobileMenu}):o.createElement(l.MobileMenuCloseButton,null)))))):null)}}t.MobileMenu=u})),define("spectrum/mobile_menu/mobile_menu_close_button",["require","exports","tslib","react","spectrum/mobile_menu/mobile_menu_item"],(function(e,t,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MobileMenuCloseButton=void 0,o=r.__importStar(o),t.MobileMenuCloseButton=()=>o.createElement(n.MobileMenuItem,{className:"mc-mobile-menu-close-button",shouldCloseMenuOnSelect:!0},"Close"),t.MobileMenuCloseButton.displayName="MobileMenuCloseButton"})),define("spectrum/mobile_menu/mobile_menu_content",["require","exports","tslib","react","classnames","prop-types"],(function(e,t,r,o,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MobileMenuContent=void 0,o=r.__importStar(o),n=r.__importDefault(n),i=r.__importDefault(i);class s extends o.Component{getChildContext(){return{closeMobileMenu:this.props.closeMobileMenu}}render(){const e=this.props,{className:t,children:i,closeMobileMenu:s}=e,a=r.__rest(e,["className","children","closeMobileMenu"]);return o.createElement("div",Object.assign({className:n.default("mc-mobile-menu-content",t)},a),i)}}t.MobileMenuContent=s,s.childContextTypes={closeMobileMenu:i.default.func}})),define("spectrum/mobile_menu/mobile_menu_item",["require","exports","tslib","react","classnames","prop-types","react-touch-events"],(function(e,t,r,o,n,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MobileMenuItem=void 0,o=r.__importStar(o),n=r.__importDefault(n),i=r.__importDefault(i),s=r.__importDefault(s);class a extends o.Component{constructor(){super(...arguments),this.handleSelect=e=>{const{shouldCloseMenuOnSelect:t,shouldPreventDefaultOnSelectItem:r,onSelect:o}=this.props;t&&this.context.closeMobileMenu(),r&&e.preventDefault(),o&&o(e)}}render(){const e=this.props,{className:t,shouldCloseMenuOnSelect:i,children:a,onSelect:l,shouldPreventDefaultOnSelectItem:c}=e,d=r.__rest(e,["className","shouldCloseMenuOnSelect","children","onSelect","shouldPreventDefaultOnSelectItem"]);return o.createElement(s.default,{onTap:this.handleSelect},o.createElement("button",Object.assign({},d,{className:n.default("mc-mobile-menu-item",t),onClick:this.handleSelect}),a))}}t.MobileMenuItem=a,a.contextTypes={closeMobileMenu:i.default.func},a.defaultProps={shouldCloseMenuOnSelect:!0,shouldPreventDefaultOnSelectItem:!0}})),define("modules/clean/sharing/views/sync_coachmark",["require","exports","tslib","react","modules/clean/deprecated_ajax/ajax_jquery","modules/clean/react/bubble","modules/clean/react/components/css","modules/clean/react/image","modules/clean/static_urls","modules/core/i18n"],(function(e,t,r,o,n,i,s,a,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SharingSyncCoachmark=void 0,o=r.__importDefault(o),n=r.__importStar(n),i=r.__importDefault(i);class d extends o.default.Component{constructor(){super(...arguments),this.state={show:!0},this.hideSyncCoachmark=()=>{this.setState({show:!1})}}componentWillMount(){n.BackgroundRequest({url:"/sharing/seen_sync_coachmark"})}render(){return this.state.show?o.default.createElement(i.default,{arrow:i.default.ARROW.TOP_LEFT,className:"sync-coachmark u-pad-s"},o.default.createElement(a.Image,{className:"u-l-ib",src:l.static_url("/static/images/sharing/sync_coachmark-vflvg8Oy0.png"),srcHiRes:l.static_url("/static/images/sharing/sync_coachmark@2x-vflhX3Mhx.png")}),o.default.createElement("div",{className:"u-l-ib u-pad-left-s sync-coachmark__content"},o.default.createElement("h2",null,c.intl.formatMessage({id:"utNf/m",defaultMessage:"Stay in sync"})),o.default.createElement("p",null,c.intl.formatMessage({id:"SIGEzu",defaultMessage:"For easy access to this folder in the future, add it to your Dropbox."})),o.default.createElement("button",{className:"c-btn c-btn--secondary",onClick:this.hideSyncCoachmark},c.intl.formatMessage({id:"W4An+g",defaultMessage:"Got it"})))):o.default.createElement("div",null)}}d.displayName="SharingSyncCoachmark",t.SharingSyncCoachmark=s.requireCssWithComponent(d,["/static/css/sharing/sync_coachmark-vflHD6MS5.css"])})),define("modules/clean/react/welcome_modal",["require","exports","tslib","react","modules/clean/growth/experiments/logger","modules/clean/react/components/css","modules/clean/react/image","modules/clean/react/components/modal","modules/clean/static_urls","modules/core/browser","modules/core/i18n","spectrum/button/index","spectrum/modal/index"],(function(e,t,r,o,n,i,s,a,l,c,d,u,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WelcomeModal=t.TestOnlyWelcomeModal=void 0,o=r.__importStar(o),n=r.__importDefault(n),c=r.__importStar(c);const m=e=>{const t=e=>{e&&e.stopPropagation(),a.Modal.close(),c.reload()};return o.createElement(p.Modal,{appElement:document.body,ariaLabel:"Welcome to Dropbox modal",bodyClassName:"welcome-modal-body",bodyId:e.id||"welcome-modal",className:"welcome-modal",displayCloseButton:!0,onRequestClose:t,open:!0,overlayClassName:"file-viewer-modal-overlay"},o.createElement("div",{className:"welcome-modal-illo"},o.createElement(s.Image,{src:l.static_url("/static/images/growth/dropbox_files-vfl7phztL.png"),srcHiRes:l.static_url("/static/images/growth/dropbox_files@2x-vflABjXqu.png")})),o.createElement("h1",{className:"welcome-modal-title"},d.intl.formatMessage({id:"qoqdPt",defaultMessage:"Welcome to Dropbox!"})),o.createElement("div",{className:"welcome-modal-text"},d.intl.formatMessage({id:"LgDSr+",defaultMessage:"Now it’s easy to securely back up your files and photos, access them from any device, and share them with others."})),o.createElement(u.Button,{className:"go-to-dropbox-button",fullWidth:!0,href:e.redirect_url||"/home",onClick:()=>{n.default.log("sharing","shared_link_welcome_modal_button_click")},tagName:"a",variant:"primary"},d.intl.formatMessage({id:"Dkf+Pc",defaultMessage:"Go to my Dropbox"})),o.createElement("div",{className:"welcome-modal-no-thanks"},o.createElement(u.Button,{className:"button-as-link",fullWidth:!0,onClick:t,variant:"styleless"},d.intl.formatMessage({id:"ZZs8no",defaultMessage:"No thanks, stay on this page"}))))};t.TestOnlyWelcomeModal=m;const h=i.requireCssWithComponent(m,["/static/css/welcome_modal-vfl8PUD8a.css"]);t.WelcomeModal=h})),define("modules/clean/auth/login_or_register/modal",["require","exports","tslib","react","classnames","lodash","modules/clean/auth/login_or_register/logging_util","modules/clean/auth/login/form","modules/clean/auth/login_or_register/types","modules/clean/auth/register/form","modules/clean/auth/register/types","modules/clean/growth/experiments/logger","dig-components/typography","modules/clean/react/comments2/data/logger","modules/clean/react/components/css","modules/clean/react/components/modal","modules/clean/react/welcome_modal","modules/core/browser","modules/core/assert","modules/core/i18n","modules/core/notify","spectrum/button/index","spectrum/modal/index","modules/clean/react/maestro_nav/shared_code/dropbox_logo","react-intl"],(function(e,t,r,o,n,i,s,a,l,c,d,u,p,m,h,f,_,g,v,y,b,w,S,E,k){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LoginOrRegisterModal=t.TestOnlyLoginOrRegisterModal=t.TestOnlyCommentsHeader=t.TestOnlyCommentTextVariantCssClass=t.PIINotificationText=t.ExperimentalToggleMessage=t.DefaultHeaderContent=void 0,o=r.__importDefault(o),n=r.__importDefault(n),u=r.__importDefault(u),m=r.__importStar(m),g=r.__importStar(g);const M={[l.CommentTextVariant.DEFAULT]:"default-variant",[l.CommentTextVariant.POST]:"post-comment-variant",[l.CommentTextVariant.SUBSCRIBE]:"subscribe-variant"};t.TestOnlyCommentTextVariantCssClass=M,t.DefaultHeaderContent=({mode:e})=>o.default.createElement("div",{className:"modal-header"},o.default.createElement(E.DropboxLogo,{className:"modal-header__dropbox-logo"}),o.default.createElement("span",null,y.intl.formatMessage(e===l.Mode.LOGIN?k.defineMessage({id:"nOuyMw",defaultMessage:"Save it for later in your Dropbox account"}):k.defineMessage({id:"eUpi8/",defaultMessage:"Save it for later in Dropbox"})))),t.ExperimentalToggleMessage=({mode:e,onHeaderLinkClick:t})=>{const r=e===l.Mode.LOGIN?k.defineMessage({id:"vHTAAQ",defaultMessage:"Sign in or <a>create an account</a>"}):k.defineMessage({id:"+OG7LA",defaultMessage:"Sign up or <a>sign in to your account</a>"});return o.default.createElement(o.default.Fragment,null,y.intl.formatMessage(r,{a:e=>o.default.createElement(w.Button,{className:"button-as-link toggle-form-link",onClick:t,variant:"styleless"},e)}))};const T=({className:e,commentTextVariant:t,mode:r})=>{let n;switch(t){case l.CommentTextVariant.POST:n=r===l.Mode.LOGIN?y.intl.formatMessage({id:"KXgMVH",defaultMessage:"To post your comment, sign in to Dropbox."}):y.intl.formatMessage({id:"LakyAx",defaultMessage:"To post your comment, create a free Dropbox account."});break;case l.CommentTextVariant.SUBSCRIBE:n=r===l.Mode.LOGIN?y.intl.formatMessage({id:"oHZbXS",defaultMessage:"To subscribe to this file, sign in to Dropbox."}):y.intl.formatMessage({id:"fy/9XT",defaultMessage:"To subscribe to this file, create a free Dropbox account."});break;default:n=r===l.Mode.LOGIN?y.intl.formatMessage({id:"3qW+D4",defaultMessage:"To continue, sign in to Dropbox."}):y.intl.formatMessage({id:"uMjLqH",defaultMessage:"To continue, create a free Dropbox account."})}return o.default.createElement("div",{className:`text-variant ${e}`},n)};t.TestOnlyCommentsHeader=T,t.PIINotificationText=()=>o.default.createElement(p.Text,{variant:"label",size:"xsmall",tagName:"p",color:"faint",className:"pii-notification"},y.intl.formatMessage(k.defineMessage({id:"KgnCKc",defaultMessage:"People with access to this folder will see your name, email, and folder activity."})));class P extends o.default.PureComponent{constructor(e){super(e),this.logWebActivityOnce=i.once(()=>s.logModalMiscActivity(this.props.kind,this.props.downloadAction)),this.renderHeader=()=>{if(this.state.isThirdPartyRegistrationContinuation)return o.default.createElement("div",{className:"mc-util-modal-header center"},o.default.createElement("h1",null,y.intl.formatMessage({id:"Ft3ikL",defaultMessage:"Create account and continue"})));const{commentParams:e,customHeaderContent:r,kind:n}=this.props;if(r){const e=r;return o.default.createElement(e,{mode:this.state.mode,changeMode:this.toggleMode})}return o.default.createElement("div",{className:"mc-util-modal-header center"},n===l.LoginOrRegisterKind.COMMENT?o.default.createElement(T,{className:M[e.variant],commentTextVariant:e.variant,mode:this.state.mode}):o.default.createElement(t.DefaultHeaderContent,{mode:this.state.mode}))},this.renderFooter=()=>{const{customFooterContent:e}=this.props;if(e){const t=e;return o.default.createElement(t,null)}return null},this.toggleMode=e=>{e.preventDefault(),this.setState(e=>{if(this.props.kind===l.LoginOrRegisterKind.COMMENT){const t=e.mode===l.Mode.LOGIN?"sign_up_modal_toggle_to_sign_up":"sign_up_modal_toggle_to_sign_in";m.logEvent(t,{stream:this.props.commentParams.stream})}return{mode:e.mode===l.Mode.LOGIN?l.Mode.REGISTER:l.Mode.LOGIN}},()=>s.logAuthIntent(this.state.mode))},this.onAuthenticateSuccess=(e,t)=>{const{mode:r}=this.state,{downloadAction:n,kind:i}=this.props;if(r===l.Mode.LOGIN?b.Notify.success(y.intl.formatMessage({id:"Ye/4Vz",defaultMessage:"Successfully signed in to Dropbox"})):b.Notify.success(y.intl.formatMessage({id:"4wqmq+",defaultMessage:"Successfully signed up for Dropbox"})),this.props.kind===l.LoginOrRegisterKind.COMMENT){const e=r===l.Mode.LOGIN?"sign_up_modal_sign_in_success":"sign_up_modal_sign_up_success";m.logEvent(e,{stream:this.props.commentParams.stream})}const s=t&&this.shouldRedirectToTeamDiscoveryPage(t);if(s)return g.redirect(s);if(this.props.onAuthenticateSuccess&&this.props.onAuthenticateSuccess(e),i===l.LoginOrRegisterKind.IMMEDIATE||i===l.LoginOrRegisterKind.SIDEBAR||n===l.DownloadAction.DIRECT_DOWNLOAD)if(r===l.Mode.REGISTER){if(t&&t.force_redirect_url&&t.redirect_url)return g.redirect(t.redirect_url);u.default.log("sharing","shared_link_welcome_modal_view"),f.Modal.showInstance(o.default.createElement(_.WelcomeModal,{id:"shared-link-welcome-modal"}))}else r===l.Mode.LOGIN&&g.reload();else this.closeModal()},this.onCancel=e=>{var t;e&&e.stopPropagation(),s.logModalDismissed(this.state.mode,null!==(t=this.props.kind)&&void 0!==t?t:void 0),this.props.onCancel&&this.props.onCancel(),this.closeModal()},this.closeModal=e=>{e&&e.stopPropagation(),f.Modal.close()},this.state={mode:e.initialMode||l.Mode.LOGIN,isThirdPartyRegistrationContinuation:!1},v.assert(!(e.kind===l.LoginOrRegisterKind.COMMENT&&!e.commentParams),"Comment parameters must be provided if calling this modal from comments code")}componentDidMount(){var e;s.logAuthIntent(this.state.mode),s.logModalShown(this.state.mode,null!==(e=this.props.kind)&&void 0!==e?e:void 0,this.props.loggingExtra),this.logWebActivityOnce()}render(){var e;const{mode:r}=this.state,{id:i,signup_tag:s,showGoogleRegistration:u,showPIINotification:p,googleRegisterProps:m,customHeaderContent:h,customFooterContent:f,loginContinuationUrl:_,additionalLoginData:v,additionalRegisterData:y}=this.props;return o.default.createElement(S.Modal,{ariaLabel:"Login or register modal",appElement:document.body,bodyId:i,className:n.default("mc-util-modal mc-util-modal-regular login-or-register-modal","conversion-experiment"),displayCloseButton:!0,onRequestClose:this.onCancel,open:!0,overlayClassName:null!==(e=this.props.modalOverlayClassName)&&void 0!==e?e:"file-viewer-modal-overlay",width:400},this.renderHeader(),o.default.createElement("div",{className:"mc-util-modal-body"},!h&&o.default.createElement(t.ExperimentalToggleMessage,{mode:this.state.mode,onHeaderLinkClick:this.toggleMode}),r===l.Mode.LOGIN&&o.default.createElement(a.LoginForm,{canRedirect:!1,continuationUrl:_||g.get_href(),className:"login-form-wrapper",googleLoginProps:{positionBelow:!0,signupTag:s},appleLoginProps:{positionBelow:!0},onLoginSuccess:this.onAuthenticateSuccess,rememberMeCheckboxProps:{checked:!0},encryptionOptions:this.props.encryptionOptions,additionalData:Object.assign(Object.assign({},v),{signup_tag:s||void 0})}),r===l.Mode.REGISTER&&o.default.createElement(c.RegisterForm,{additionalParams:Object.assign(Object.assign({},y),{signup_tag:s||void 0}),canRedirect:!1,className:"register-form-wrapper",onRegisterSuccess:this.onAuthenticateSuccess,tosCheckboxProps:{inline:!1},marketingOptInProps:{show:!!this.props.showMarketingOptIn,checked:!1},googleRegisterProps:u?Object.assign(Object.assign({},m||{}),{position:"BOTTOM"}):void 0,onRegisterFormEvent:e=>{e===d.RegisterFormEvent.GOOGLE_REGISTER_SUCCESS&&this.setState({isThirdPartyRegistrationContinuation:!0})}}),p&&o.default.createElement(t.PIINotificationText,null)),f&&this.renderFooter())}shouldRedirectToTeamDiscoveryPage(e){const{mode:t}=this.state,{kind:r}=this.props;if(r===l.LoginOrRegisterKind.SIDEBAR&&t===l.Mode.REGISTER&&e.force_redirect_url&&e.redirect_url&&e.redirect_url.indexOf("/team/discover/suggest")>-1)return e.redirect_url}}t.TestOnlyLoginOrRegisterModal=P,P.defaultProps={showGoogleRegistration:!0},P.displayName="LoginOrRegisterModal";const O=h.requireCssWithComponent(P,["/static/css/spectrum/index.web-vfliw9181.css","/static/css/components/login_or_register_modal-vflUe5qth.css","/static/css/legacy_packages/components-vfl9706n8.css","/static/css/components/button-vfllw60O5.css","/static/css/scooter/scooter-scoped-vflpl9JSl.css","/static/css/recaptcha_challenge-vflrcf67y.css","/static/css/recaptcha_v2_challenge-vflYEW-GO.css"]);t.LoginOrRegisterModal=O})),define("modules/clean/react/previews/sharing_plugin/copy_link_button",["require","exports","tslib","modules/clean/sharing/ui_notifications_util","modules/clean/sharing/clean/util/link_util/parser","modules/clean/clipboard_v3","dig-components/buttons","react","modules/core/i18n"],(function(e,t,r,o,n,i,s,a,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CopyLinkButton=void 0,n=r.__importStar(n),a=r.__importDefault(a),t.CopyLinkButton=function(e){var t;const r=l.intl.formatMessage({id:"8QMEOE",defaultMessage:"Copy link"});return a.default.createElement(s.Button,{className:"copy-link-button",variant:null!==(t=e.variant)&&void 0!==t?t:"opacity",onClick:()=>{i.copyToClipboard(n.getCleanedSharingUrl(e.parsedLink),()=>{o.showCopyLinkSuccessSnackbar(n.getCleanedSharingUrl(e.parsedLink),e.linkAccessLevel)},()=>{o.showCopyLinkErrorSnackbar(n.getCleanedSharingUrl(e.parsedLink))})}},r)}})),define("modules/clean/sharing/clean/util/link_util/parser",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCleanedSharingUrl=t.parseLink=void 0,t.parseLink=e=>{const t=new URL(e),r=null!=t.searchParams.get("rlkey"),o=t.pathname.startsWith("/s/")||t.pathname.startsWith("/sh/");return{protocol:t.protocol,hostname:t.hostname,pathname:t.pathname,searchParams:t.searchParams,doesContainRlKey:r,doesContainShmodelLink:o}},t.getCleanedSharingUrl=e=>{const t=e.searchParams,r=new URLSearchParams;let o="";return t.get("dl")&&(o="?",r.append("dl",t.get("dl"))),t.get("rlkey")&&(o="?",r.append("rlkey",t.get("rlkey"))),o+=r.toString(),e.protocol+"//"+e.hostname+e.pathname+o}})),define("prod_assets_web_modules/react-touch-events",["./common/_commonjsHelpers","react"],(function(e,t){"use strict";var r,o,n=(function(e){return e&&e.__esModule?e:{default:e}})(t),i={exports:{}};return r=i,e.commonjsGlobal,o=function(e){return(function(e){var t={};function r(o){if(t[o])return t[o].exports;var n=t[o]={i:o,l:!1,exports:{}};return e[o].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=e,r.c=t,r.i=function(e){return e},r.d=function(e,t,o){r.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:o})},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=8)})([function(e,t,r){function o(e){return function(){return e}}var n=function(){};n.thatReturns=o,n.thatReturnsFalse=o(!1),n.thatReturnsTrue=o(!0),n.thatReturnsNull=o(null),n.thatReturnsThis=function(){return this},n.thatReturnsArgument=function(e){return e},e.exports=n},function(e,t,r){var o;o=function(e){if(void 0===e)throw new Error("invariant requires an error message argument")},e.exports=function(e,t,r,n,i,s,a,l){if(o(t),!e){var c;if(void 0===t)c=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var d=[r,n,i,s,a,l],u=0;(c=new Error(t.replace(/%s/g,(function(){return d[u++]})))).name="Invariant Violation"}throw c.framesToPop=1,c}}},function(e,t,r){var o,n=r(0);o=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),o=1;o<t;o++)r[o-1]=arguments[o];var n=0,i="Warning: "+e.replace(/%s/g,(function(){return r[n++]}));"undefined"!=typeof console&&console.error(i);try{throw new Error(i)}catch(e){}},n=function(e,t){if(void 0===t)throw new Error("`warning(condition, format, ...args)` requires a warning message argument");if(0!==t.indexOf("Failed Composite propType: ")&&!e){for(var r=arguments.length,n=Array(r>2?r-2:0),i=2;i<r;i++)n[i-2]=arguments[i];o.apply(void 0,[t].concat(n))}},e.exports=n},function(e,t,r){e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},function(e,t,r){var o="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103;e.exports=r(7)((function(e){return"object"==typeof e&&null!==e&&e.$$typeof===o}),!0)},function(t,r){t.exports=e},function(e,t,r){var o=r(1),n=r(2),i=r(3),s={};e.exports=function(e,t,r,a,l){for(var c in e)if(e.hasOwnProperty(c)){var d;try{o("function"==typeof e[c],"%s: %s type `%s` is invalid; it must be a function, usually from React.PropTypes.",a||"React class",r,c),d=e[c](t,c,a,r,null,i)}catch(e){d=e}if(n(!d||d instanceof Error,"%s: type specification of %s `%s` is invalid; the type checker function must return `null` or an `Error` but returned a %s. You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument).",a||"React class",r,c,typeof d),d instanceof Error&&!(d.message in s)){s[d.message]=!0;var u=l?l():"";n(!1,"Failed %s type: %s%s",r,d.message,null!=u?u:"")}}}},function(e,t,r){var o=r(0),n=r(1),i=r(2),s=r(3),a=r(6);e.exports=function(e,t){var r="function"==typeof Symbol&&Symbol.iterator,l="<<anonymous>>",c={array:m("array"),bool:m("boolean"),func:m("function"),number:m("number"),object:m("object"),string:m("string"),symbol:m("symbol"),any:p(o.thatReturnsNull),arrayOf:function(e){return p((function(t,r,o,n,i){if("function"!=typeof e)return new u("Property `"+i+"` of component `"+o+"` has invalid PropType notation inside arrayOf.");var a=t[r];if(!Array.isArray(a))return new u("Invalid "+n+" `"+i+"` of type `"+f(a)+"` supplied to `"+o+"`, expected an array.");for(var l=0;l<a.length;l++){var c=e(a,l,o,n,i+"["+l+"]",s);if(c instanceof Error)return c}return null}))},element:p((function(t,r,o,n,i){var s=t[r];return e(s)?null:new u("Invalid "+n+" `"+i+"` of type `"+f(s)+"` supplied to `"+o+"`, expected a single ReactElement.")})),instanceOf:function(e){return p((function(t,r,o,n,i){if(!(t[r]instanceof e)){var s=e.name||l;return new u("Invalid "+n+" `"+i+"` of type `"+((a=t[r]).constructor&&a.constructor.name?a.constructor.name:l)+"` supplied to `"+o+"`, expected instance of `"+s+"`.")}var a;return null}))},node:p((function(e,t,r,o,n){return h(e[t])?null:new u("Invalid "+o+" `"+n+"` supplied to `"+r+"`, expected a ReactNode.")})),objectOf:function(e){return p((function(t,r,o,n,i){if("function"!=typeof e)return new u("Property `"+i+"` of component `"+o+"` has invalid PropType notation inside objectOf.");var a=t[r],l=f(a);if("object"!==l)return new u("Invalid "+n+" `"+i+"` of type `"+l+"` supplied to `"+o+"`, expected an object.");for(var c in a)if(a.hasOwnProperty(c)){var d=e(a,c,o,n,i+"."+c,s);if(d instanceof Error)return d}return null}))},oneOf:function(e){return Array.isArray(e)?p((function(t,r,o,n,i){for(var s=t[r],a=0;a<e.length;a++)if(d(s,e[a]))return null;return new u("Invalid "+n+" `"+i+"` of value `"+s+"` supplied to `"+o+"`, expected one of "+JSON.stringify(e)+".")})):(i(!1,"Invalid argument supplied to oneOf, expected an instance of array."),o.thatReturnsNull)},oneOfType:function(e){return Array.isArray(e)?p((function(t,r,o,n,i){for(var a=0;a<e.length;a++)if(null==(0,e[a])(t,r,o,n,i,s))return null;return new u("Invalid "+n+" `"+i+"` supplied to `"+o+"`.")})):(i(!1,"Invalid argument supplied to oneOfType, expected an instance of array."),o.thatReturnsNull)},shape:function(e){return p((function(t,r,o,n,i){var a=t[r],l=f(a);if("object"!==l)return new u("Invalid "+n+" `"+i+"` of type `"+l+"` supplied to `"+o+"`, expected `object`.");for(var c in e){var d=e[c];if(d){var p=d(a,c,o,n,i+"."+c,s);if(p)return p}}return null}))}};function d(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}function u(e){this.message=e,this.stack=""}function p(e){var r={},o=0;function a(a,c,d,p,m,h,f){if(p=p||l,h=h||d,f!==s)if(t)n(!1,"Calling PropTypes validators directly is not supported by the `prop-types` package. Use `PropTypes.checkPropTypes()` to call them. Read more at http://fb.me/use-check-prop-types");else if("undefined"!=typeof console){var _=p+":"+d;!r[_]&&o<3&&(i(!1,"You are manually calling a React.PropTypes validation function for the `%s` prop on `%s`. This is deprecated and will throw in the standalone `prop-types` package. You may be seeing this warning due to a third-party PropTypes library. See https://fb.me/react-warning-dont-call-proptypes for details.",h,p),r[_]=!0,o++)}return null==c[d]?a?null===c[d]?new u("The "+m+" `"+h+"` is marked as required in `"+p+"`, but its value is `null`."):new u("The "+m+" `"+h+"` is marked as required in `"+p+"`, but its value is `undefined`."):null:e(c,d,p,m,h)}var c=a.bind(null,!1);return c.isRequired=a.bind(null,!0),c}function m(e){return p((function(t,r,o,n,i,s){var a=t[r];return f(a)!==e?new u("Invalid "+n+" `"+i+"` of type `"+(function(e){var t=f(e);if("object"===t){if(e instanceof Date)return"date";if(e instanceof RegExp)return"regexp"}return t})(a)+"` supplied to `"+o+"`, expected `"+e+"`."):null}))}function h(t){switch(typeof t){case"number":case"string":case"undefined":return!0;case"boolean":return!t;case"object":if(Array.isArray(t))return t.every(h);if(null===t||e(t))return!0;var o=(function(e){var t=e&&(r&&e[r]||e["@@iterator"]);if("function"==typeof t)return t})(t);if(!o)return!1;var n,i=o.call(t);if(o!==t.entries){for(;!(n=i.next()).done;)if(!h(n.value))return!1}else for(;!(n=i.next()).done;){var s=n.value;if(s&&!h(s[1]))return!1}return!0;default:return!1}}function f(e){var t=typeof e;return Array.isArray(e)?"array":e instanceof RegExp?"object":(function(e,t){return"symbol"===e||"Symbol"===t["@@toStringTag"]||"function"==typeof Symbol&&t instanceof Symbol})(t,e)?"symbol":t}return u.prototype=Error.prototype,c.checkPropTypes=a,c.PropTypes=c,c}},function(e,t,r){var o=(function(){function e(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,r,o){return r&&e(t.prototype,r),o&&e(t,o),t}})();function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var s=r(5),a=r(4);function l(e){return e.touches[0].clientX}function c(e){return e.touches[0].clientY}var d=(function(e){function t(){var e,r,o;n(this,t);for(var s=arguments.length,a=Array(s),d=0;d<s;d++)a[d]=arguments[d];return r=o=i(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),o.handleTouchStart=function(e){o.touchStarted||(o.touchStarted=!0,o.touchMoved=!1,o.swipeOutBounded=!1,o.startX=l(e),o.startY=c(e),o.currentX=0,o.currentY=0)},o.handleTouchMove=function(e){if(o.currentX=l(e),o.currentY=c(e),o.touchMoved){if(!o.swipeOutBounded){var t=o.props.swipeTolerance;o.swipeOutBounded=Math.abs(o.startX-o.currentX)>t&&Math.abs(o.startY-o.currentY)>t}}else{var r=o.props.tapTolerance;o.touchMoved=Math.abs(o.startX-o.currentX)>r||Math.abs(o.startY-o.currentY)>r}},o.handleTouchCancel=function(){o.touchStarted=o.touchMoved=!1,o.startX=o.startY=0},o.handleTouchEnd=function(e){if(o.touchStarted=!1,o.touchMoved){if(!o.swipeOutBounded&&o.props.onSwipe){var t,r=o.props.swipeTolerance;t=Math.abs(o.startX-o.currentX)<r?o.startY>o.currentY?"top":"bottom":o.startX>o.currentX?"left":"right",o.props.onSwipe(t,e)}}else o.props.onTap&&o.props.onTap(e)},i(o,r)}return(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)})(t,e),o(t,[{key:"render",value:function(){var e=this.props.children,t=e?s.Children.only(e):s.createElement("button",null);return s.cloneElement(t,{onTouchStart:this.handleTouchStart,onTouchMove:this.handleTouchMove,onTouchCancel:this.handleTouchCancel,onTouchEnd:this.handleTouchEnd})}}]),t})(s.Component);d.defaultProps={tapTolerance:10,swipeTolerance:30},d.propTypes={children:a.node,tapTolerance:a.number,swipeTolerance:a.number,onTap:a.func,onSwipe:a.func},e.exports=d}])},r.exports=o(n.default),e.getDefaultExportFromCjs(i.exports)}));
//# sourceMappingURL=pkg-file_viewer_archive.min.js-vflk9wYe2.map