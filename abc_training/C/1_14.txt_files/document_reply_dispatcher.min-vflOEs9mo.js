define(["require","exports","modules/clean/react/integrations/pdf_editor/document_message_bus/dispatchers/event_relay"],(function(e,s,t){"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.DefaultDocumentReplyDispatcher=void 0;s.DefaultDocumentReplyDispatcher=class{constructor(e,s){this.targetOrigin=e,this.windowMessageEventRelay=new t.WindowMessageEventRelay(e=>this.handleWindowOnMessage(e)),this.messagePortEventRelay=new t.MessagePortEventRelay,s&&this.registerOnActionHandler(s),this.messageBusInitializedEventRelay=new t.SimpleEventRelay,this.sendFrameInitializedMessage(),this._busInitialized=!1}get busInitialized(){return this._busInitialized}sendDocumentReply(e){if(this.port)switch(e.kind){case"extract_document_reply":this.port.postMessage(e,[e.documentData]);break;case"create_document_page_thumbnail_reply":this.port.postMessage(e,[e.thumbnailImageData]);break;default:this.port.postMessage(e)}}registerOnActionHandler(e){this.messagePortEventRelay.registerHandler(e)}removeOnActionHandler(e){this.messagePortEventRelay.removeHandler(e)}registerOnInitializedHandler(e){this.messageBusInitializedEventRelay.registerHandler(e)}removeOnInitializedHandler(e){this.messageBusInitializedEventRelay.removeHandler(e)}dispose(){this.windowMessageEventRelay.dispose(),this.messagePortEventRelay.dispose(),this._busInitialized=!1}sendFrameInitializedMessage(){window.parent.postMessage({kind:"frame_initialized_message"},this.targetOrigin)}sendMessageChannelPortAckMessage(){window.parent.postMessage({kind:"message_channel_port_ack_message"},this.targetOrigin)}handleWindowOnMessage(e){if(e.origin!==this.targetOrigin)return;"message_channel_port_message"===e.data.kind&&(this.port=e.ports[0],this.messagePortEventRelay.port=this.port,this.sendMessageChannelPortAckMessage(),this._busInitialized=!0,this.messageBusInitializedEventRelay.triggerHandlers(),this.windowMessageEventRelay.dispose())}}}));
//# sourceMappingURL=document_reply_dispatcher.min.js-vfliJyC-a.map