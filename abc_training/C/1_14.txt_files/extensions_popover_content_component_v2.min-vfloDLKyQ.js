define(["require","exports","tslib","dig-components/icons","dig-components/icons/src","dig-components/menu","modules/clean/file_store/utils","modules/clean/react/app_actions/redirect","modules/clean/react/components/css","modules/clean/react/extensions/cloud_docs_compat","modules/clean/react/extensions/common","modules/clean/react/extensions/data/helpers","modules/clean/react/extensions/extensions_mini_directory_modal","modules/clean/react/extensions/menu_survey","modules/clean/react/extensions/unity_and_cloud_editors","modules/clean/react/extensions/utils","modules/clean/react/file_viewer/constants","modules/clean/react/file_viewer/open_button/types","modules/clean/react/file_viewer/unity/with_unity","modules/clean/static_urls","modules/core/i18n","react","modules/clean/react/file_viewer/file_conversion/file_conversion_options"],(function(e,t,n,o,i,s,r,c,a,l,p,u,d,m,f,A,h,_,g,y,O,E,w){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExtensionsPopoverV2NoUnity=t.ExtensionsPopoverV2WithUnity=void 0,E=n.__importDefault(E);class v extends E.default.Component{constructor(e){super(e),this.createAppActionClickHandler=e=>()=>{const{file:t,user:n,featureFlags:o,telemetryContext:i,updateLinkState:s}=this.props;if(c.redirectToActionOrShowAuth(n,[t],e,o,i,s),"redirect"===e.handler[".tag"]){const t=p.getAppActionExtras(e);p.logEvent(this.props.currentSession,"select_action",Object.assign({menu_version:2},t))}else if("cloud_editor"===e.handler[".tag"]){const t=l.isWopiAction(e)?_.OpenButtonAction.OPEN_WITH:_.OpenButtonAction.OPEN_WITH_CLOUD_DOC;p.logEvent(this.props.currentSession,"select_legacy_action",{type:t})}},this.wrapperForAction=e=>({appAction:e,handler:this.createAppActionClickHandler(e),userAction:h.UserAction.OpenWithAppAction,actionName:e.description}),this.renderActionRow=e=>{const t=e.icon;let n;n=t.is_static?y.static_url("/static/images/generic_app_icon-vflIPYT1H.png"):t.url;const o=e.description,i=this.props.isInActionBar?A.toActionBarValue(this.wrapperForAction(e)):this.wrapperForAction(e);return E.default.createElement(s.Menu.ActionItem,{key:e.id,value:i,withLeftAccessory:E.default.createElement("img",{alt:"",src:n,width:24,height:24})},o)},this.renderUnpromotedActions=(e,t)=>{const{user:n,file:r,categoryIdToInfos:c,featureFlags:a,currentSession:l,telemetryContext:u,updateLinkState:m,isInActionBar:f}=this.props,h=e.length>0,_={handler:()=>{const o=[...e,...t];d.showExtensionsMiniDirectoryModal(O.intl.formatMessage({id:"KVD2SP",defaultMessage:"Open or edit with these apps"}),n,r,o,c,a,m,u,l),p.logEvent(l,h?"select_show_more":"select_add_app",{surface:u&&u.surface})}},g=f?A.toActionBarValue(_):_;return E.default.createElement(s.Menu.ActionItem,{key:O.intl.formatMessage({id:"R/67N/",defaultMessage:"Show more"}),value:g,withLeftAccessory:h&&!f?null:E.default.createElement(o.UIIcon,{src:i.AddCircleLine})},h?O.intl.formatMessage({id:"Gevpqz",defaultMessage:"Connect more apps"}):O.intl.formatMessage({id:"XFA09U",defaultMessage:"Connect apps"}))}}render(){const{user:e,appActions:t,openOptions:n,bylines:o,currentSession:i,isInActionBar:r}=this.props,c=p.getOpenOptionsWithLogging(n,i),{unityOptions:a,cloudEditorOptions:l,previewOption:d,openInReplayOption:A,openInDesktopOption:h,goToFolderOption:_,openInNewTabOption:g}=u.partitionOptions(c),{cloudEditors:y,installedActions:O,unpromotedActions:v}=u.partitionActions(t),x=O.length>0,I=v.length>0;return E.default.createElement(E.default.Fragment,null,E.default.createElement(w.FileConversionOptions,{openOptions:c,currentSession:i,wrapValuesForActionBar:!!r}),E.default.createElement(f.UnityAndCloudEditors,{isInActionBar:r,unityOptions:a,legacyCloudEditorOptions:l,cloudEditorAppActions:y.map(e=>this.wrapperForAction(e)),bylines:o,currentSession:i,previewOption:d,openInReplayOption:A,openInNewTabOption:g,openInDesktopOption:h,goToFolderOption:_,wrapValuesForActionBar:!!r}),r&&(x||I)&&E.default.createElement(s.Menu.Segment,null,O.map(e=>this.renderActionRow(e)),this.renderUnpromotedActions(O,v)),!r&&x&&E.default.createElement(s.Menu.Segment,{key:"installed-actions"},O.map(e=>this.renderActionRow(e))),!r&&I&&E.default.createElement(s.Menu.Segment,null,this.renderUnpromotedActions(O,v)),E.default.createElement(m.OpenMenuSurvey,{userId:e.id,session:i}))}}v.displayName="ExtensionsPopoverV2Component",t.ExtensionsPopoverV2WithUnity=e=>r.isBrowseFile(e.file)?E.default.createElement(g.WithUnity,{file:e.file,user:e.user,render:t=>E.default.createElement(v,Object.assign({},e,{unityInfo:t}))}):null,t.ExtensionsPopoverV2NoUnity=a.requireCssWithComponent(v,["/static/css/app_actions/index-vflb8K3Re.css","/static/css/extensions/index-vflTeCGSU.css"])}));
//# sourceMappingURL=extensions_popover_content_component_v2.min.js-vflpmMks6.map