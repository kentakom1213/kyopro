define("typescript/libraries/file-viewer/src/core/middlewares/analytics",["require","exports","tslib","typescript/libraries/file-viewer/src/core/logging/actions","typescript/libraries/file-viewer/src/core/logging/constants","typescript/libraries/file-viewer/src/core/logging/session","typescript/libraries/file-viewer/src/core/data/actions","typescript/libraries/file-viewer/src/core/data/modes/types","typescript/libraries/file-viewer/src/core/extension_constants","typescript/libraries/file-viewer/src/core/data/selectors","typescript/libraries/file-viewer/src/core/utils/index","lodash"],(function(e,i,t,r,n,a,o,s,l,c,d,p){"use strict";function u(e){return Object.keys(e).reduce((i,t)=>{const r=e[t];return"string"==typeof r||"number"==typeof r?i[t]=String(r):"boolean"==typeof r?i[t]=String(+r):"object"==typeof r&&r&&(i[t]=JSON.stringify(r)),i},{})}function f(e){return Object.assign(Object.assign({},e),{file_extension:l.getWhitelistedFileExtension(e.file_extension||""),extra:u(e.extra)})}Object.defineProperty(i,"__esModule",{value:!0}),i.analyticsMiddleware=i.MAPPED_USER_ACTIONS=void 0,p=t.__importDefault(p);const v={[o.Action.ZoomIn]:n.UserAction.ZoomIn,[o.Action.ZoomOut]:n.UserAction.ZoomOut,[o.Action.CloseDocSidebar]:n.UserAction.CloseDocSidebar,[o.Action.OpenDocSidebar]:n.UserAction.OpenDocSidebar,[o.Action.ZoomToggleOriginalOrFit]:n.UserAction.ZoomToggleOriginalOrFit,[o.Action.ChangeMode]:n.UserAction.ModeChange,[o.Action.UpdateDocCurrentPageIndex]:n.UserAction.PageJump,[o.Action.PageDown]:n.UserAction.PageDown,[o.Action.PageUp]:n.UserAction.PageUp,[o.Action.Share]:n.UserAction.Share,[o.Action.Restore]:n.UserAction.Restore,[o.Action.OpenWith]:n.UserAction.OpenWith,[o.Action.OpenWebPreview]:n.UserAction.OpenWebPreview,[o.Action.FlipToNextFile]:n.UserAction.FlipNext,[o.Action.FlipToPreviousFile]:n.UserAction.FlipPrevious,[o.Action.CloseViewer]:n.UserAction.CloseViewer,[o.Action.OpenFullscreenPreview]:n.UserAction.OpenFullscreenPreview,[o.Action.OpenVersionHistory]:n.UserAction.OpenVersionHistory,[o.Action.OpenSidebar]:n.UserAction.ToggleSidebarOn,[o.Action.CloseSidebar]:n.UserAction.ToggleSidebarOff,[o.Action.SwitchWorkbookTab]:n.UserAction.SwitchWorkbookTab,[o.Action.CopyToDropbox]:n.UserAction.SaveToDropbox,[o.Action.DownloadFile]:n.UserAction.Download,[o.Action.Print]:n.UserAction.Print,[o.Action.EnterFullScreen]:n.UserAction.ToggleFullscreenOn,[o.Action.ExitFullScreen]:n.UserAction.ToggleFullscreenOff,[o.Action.ClickDropboxLogo]:n.UserAction.ClickDropboxLogo,[o.Action.SetActiveRightRailPlugin]:n.UserAction.SidebarPaneSelected};i.MAPPED_USER_ACTIONS=p.default(v);i.analyticsMiddleware=function(e){return({getState:t})=>p=>w=>{switch(w.type){case r.Action.LogSessionEvent:return p(((e,i,t)=>{const{payload:{event:n,fileViewerId:o,previewSessionId:s,extra:l}}=t;let c=i.loggingSession[o];return s===c.file_preview_session_id&&(c=a.recordEvent(i.loggingSession[o],n,l),e.log(n,f(c)),c=a.updateSessionLastEvent(c,n)),r.updateSession(c)})(e,t(),w));case r.Action.Log:return p(((e,i,t)=>{const{payload:n}=t,{event:a,fileViewerId:o}=n,s=i.loggingSession[o];return e.log(a,f(Object.assign(Object.assign({},s),{extra:Object.assign(Object.assign({},(null==s?void 0:s.extra.source_context)&&{source_context:s.extra.source_context}),n.extra)}))),r.updateSession(s)})(e,t(),w));case r.Action.LogVideo:return void 0!==e.logVideo?p(((e,i,t)=>{const{payload:n}=t,{eventName:a,fileViewerId:o,previewSessionId:s}=n,l=i.loggingSession[o],c=l.file_preview_session_id;return void 0!==e.logVideo&&s===c&&e.logVideo(a,(e=>{const{previewSessionId:i,videoFormat:t,videoDuration:r,videoTruncated:n,extra:a}=e;return{file_preview_session_id:i,video_format:t,video_duration_seconds:r,video_truncated:n,extra:a}})(n)),r.updateSession(l)})(e,t(),w)):p(w);case r.Action.LogUserAction:return p(((e,t,r)=>{const{payload:a}=r,{userAction:o,actionContext:s,fileViewerId:l}=a,c=t.loggingSession[l];return o in i.MAPPED_USER_ACTIONS?console.warn(`WARNING: ${o} is automatically logged when it's in USER_ACTION_MAP. No need to call logUserAction for it.`):e.log(n.EventType.UserAction,f(Object.assign(Object.assign({},c),{extra:Object.assign(Object.assign(Object.assign({},(null==c?void 0:c.extra.source_context)&&{source_context:c.extra.source_context}),a.extra),{action:o,context:s})}))),r})(e,t(),w));case r.Action.LogTTI:return p(((e,i,t)=>{let n=null;return n=a.markTTI(i.loggingSession[t.payload]),e.logTTI(),r.updateSession(n)})(e,t(),w));case r.Action.LogTTV:return p(((e,i,t)=>{const n=i.loggingSession[t.payload];return e.logTTV(),r.updateSession(n)})(e,t(),w));case o.Action.ExcelSheetRenderFailed:case o.Action.ExcelSheetRenderSucceeded:case o.Action.FetchExcelSheetLayoutData:case o.Action.FetchExcelSheetLayoutDataResult:return p(((e,i,t)=>{const{fileViewerId:r,sheetIndex:a}=t.payload,s=i.loggingSession[r],l=f(Object.assign(Object.assign({},s),{extra:u({tab_index:a,ts:Date.now()})}));switch(t.type){case o.Action.FetchExcelSheetLayoutData:e.log(n.EventType.ExcelSheetDownloadAttempted,l);break;case o.Action.FetchExcelSheetLayoutDataResult:null!=t.error?e.log(n.EventType.ExcelSheetDownloadFailed,l):e.log(n.EventType.ExcelSheetDownloadSucceeded,l);break;case o.Action.ExcelSheetRenderFailed:e.log(n.EventType.ExcelSheetRenderFailed,l);break;case o.Action.ExcelSheetRenderSucceeded:e.log(n.EventType.ExcelSheetRenderSucceeded,l)}return t})(e,t(),w));case o.Action.UpdateArchiveFileCurrentPath:return p(((e,i,t)=>{const{fileViewerId:r,currentPath:a,isDir:o}=t.payload;if(void 0!==o){const t=i.loggingSession[r],s=f(Object.assign(Object.assign({},t),{extra:u({action:n.UserAction.ArchiveNavigation,context:n.UserActionContext.PreviewContentMain,isDir:String(o),extension:o?"":l.getWhitelistedFileExtension(d.getFileExtension(a[a.length-1]))})}));e.log(n.EventType.UserAction,s)}return t})(e,t(),w))}return w.type in v?p(((e,i,t)=>{const{fileViewerId:r,sourceContext:a}=t.payload,{loggingSession:l,modes:d}=i,p=l[r],w=d[r]?d[r].mode:s.FileViewerMode.Default,g=c.isSidebarOpen(i,{fileViewerId:r}),m={context:a,action:v[t.type],mode:w,right_sidebar_state:g?"opened":"collapsed"};return t.type===o.Action.ChangeMode?m.next_mode=t.payload.mode:t.type===o.Action.SwitchWorkbookTab?m.tab_index=t.payload.tabIndex:t.type===o.Action.SetActiveRightRailPlugin&&(m.selected_pane=t.payload.pluginId),e.log(n.EventType.UserAction,f(Object.assign(Object.assign({},p),{extra:u(m)}))),t})(e,t(),w)):p(w)}}})),define("typescript/libraries/file-viewer/src/file_viewer/bootstrap",["require","exports","typescript/libraries/file-viewer/src/core/middlewares/plugins","redux","typescript/libraries/file-viewer/src/core/data/reducer","typescript/libraries/file-viewer/src/core/logging/constants","api_v2/redux/previews","typescript/libraries/file-viewer/src/core/middlewares/riviera_data","typescript/libraries/file-viewer/src/core/config","typescript/libraries/file-viewer/src/core/middlewares/analytics","typescript/libraries/file-viewer/src/core/middlewares/ui_action_redispatcher","typescript/libraries/file-viewer/src/core/middlewares/local_cache_data","api_v2/redux/files","api_v2/redux/users","typescript/libraries/file-viewer/src/core/middlewares/file_system","typescript/libraries/file-viewer/src/core/middlewares/full_screen","typescript/libraries/file-viewer/src/core/middlewares/navigation","typescript/libraries/file-viewer/src/core/middlewares/native_apps","typescript/libraries/file-viewer/src/core/middlewares/network_state","typescript/libraries/file-viewer/src/core/middlewares/print","typescript/libraries/file-viewer/src/core/middlewares/url","typescript/libraries/file-viewer/src/core/middlewares/cloud_docs","api_v2/redux/seen_state","api_v2/redux/flows","api_v2/redux/sharing","typescript/libraries/file-viewer/src/file_viewer/file_viewer","typescript/libraries/file-viewer/src/core/middlewares/asset_url_rewrite","typescript/libraries/file-viewer/src/pass/index","typescript/libraries/file-viewer/src/preview_excel/tab_selection_handler","typescript/libraries/file-viewer/src/core/middlewares/preferences","typescript/libraries/file-viewer/src/core/middlewares/report_exception"],(function(e,i,t,r,n,a,o,s,l,c,d,p,u,f,v,w,g,m,h,b,y,_,E,A,P,S,I,M,C,O,T){"use strict";function x(e){const{middlewares:i=[],initialState:t,additionalReducers:a={}}=e,o="undefined"!=typeof window&&window.__REDUX_DEVTOOLS_EXTENSION__?r.compose(r.applyMiddleware(...i),window.__REDUX_DEVTOOLS_EXTENSION__({name:"File Viewer SDK"})):r.applyMiddleware(...i),s=Object.assign(Object.assign(Object.assign({},n.reducers),M.reducers),a);return r.createStore(r.combineReducers(s),t,o)}Object.defineProperty(i,"__esModule",{value:!0}),i.createFileViewerFactory=i.createSDKStore=void 0,i.createSDKStore=x,i.createFileViewerFactory=function(e){var i;const{batteries:r,callbacks:n,featureConfig:D,unsafe_reduxExtensions:F,initData:R,platformConfig:V}=e,{middlewares:B=[],additionalReducers:N={},initialState:k}=null!=F?F:{},{accountId:L,deviceType:j}=R,{optionalIOClients:U,coreIOClients:K,logger:z,intl:W}=r,{rivieraIOClient:q,apiv2ClientBase:H}=K,{fileSystemClient:$,fullScreenClient:G,localCacheClient:Y,nativeAppsIOClient:Z,navigationClient:X,presenceBeaconIOClient:Q,printClient:J,transformAssetUrl:ee,urlClient:ie,preferencesClient:te,cloudDocsClient:re,reportExceptionClient:ne}=U,ae=e.pluginLoaders||{},oe=x({middlewares:[...Z?[m.middleware(Z)]:[],...Y?[p.localCacheMiddleware(Y)]:[],...X?[g.middleware(X)]:[],h.middleware,s.rivieraDataMiddleware(q),o.middleware(H.ns("previews")),u.middleware(H.ns("files")),f.middleware(H.ns("users")),d.uiActionRedispatcher,I.assetUrlRewrite(ee),...ie?[y.middleware(ie)]:[],t.pluginsMiddleware(()=>Object.keys(ae)),...Q?[M.beaconMiddleware(Q)]:[],P.middleware(H.ns("sharing")),...(null==D?void 0:D.excel_support)?[C.tabSelectionHandler]:[],...$?[v.middleware($)]:[],...G?[w.middleware(G)]:[],...J?[b.middleware(J)]:[],E.middleware(H.ns("seen_state")),A.middleware(H.ns("flows")),...te?[O.preferencesMiddleware(te)]:[],...re?[_.middleware(re)]:[],...ne?[T.reportExceptionMiddleware(ne)]:[],...B,...z?[c.analyticsMiddleware(z)]:[]],initialState:k,additionalReducers:N});let se=l.DEFAULT_CONFIG;D&&(se=Object.assign(Object.assign({},se),D));const le=r.optionalIOClients.showAuthModal,ce=!!(null===(i=r.optionalIOClients.navigationClient)||void 0===i?void 0:i.closeViewer);return{createFileViewer:S.createFileViewer(()=>({callbacks:n,intl:W,store:oe,accountId:L,showAuthModal:le,canCloseViewer:ce,deviceType:j||a.DeviceType.desktop,config:se,platformConfig:Object.assign(Object.assign({},S.defaultPlatformConfig),V)}),H,ae),registerPlugin(e,i){ae[e]=i},registerPlugins(e){Object.assign(ae,e)}}}})),define("typescript/libraries/file-viewer/src/core/middlewares/local_cache_data",["require","exports","tslib","api_v2/redux/previews","typescript/libraries/file-viewer/src/core/logging/session","typescript/libraries/file-viewer/src/core/logging/actions"],(function(e,i,t,r,n,a){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.localCacheMiddleware=void 0,i.localCacheMiddleware=function(e){return({getState:i,dispatch:o})=>s=>l=>t.__awaiter(this,void 0,void 0,(function*(){if(l.type==r.Action.GetPreviewDataBatch&&e.previewDataCacheClient){const t=yield e.previewDataCacheClient.getByFileIds(l.payload.arg.files.map(e=>e.file_id).filter(e=>"string"==typeof e));if(Array.isArray(t.results)&&t.results.length>0){const e={arg:l.payload.arg,result:t};if(l.meta&&l.meta.fileViewerId){const e=n.recordExtra(i().loggingSession[l.meta.fileViewerId],{preview_data_cache_hit:"1"});o(a.updateSession(e))}const s=r.getPreviewDataBatchResultAction(e,l.meta);return o(s)}if(l.meta&&l.meta.fileViewerId){const e=n.recordExtra(i().loggingSession[l.meta.fileViewerId],{preview_data_cache_hit:"0"});o(a.updateSession(e))}}return s(l)}))}})),define("typescript/libraries/file-viewer/src/core/middlewares/network_state",["require","exports","typescript/libraries/file-viewer/src/core/data/actions"],(function(e,i,t){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.middleware=void 0,i.middleware=({dispatch:e})=>{function i(){e(t.setNetworkConnectivityState({isOffline:!navigator.onLine}))}return r=>n=>{if("undefined"==typeof window)return r(n);switch(n.type){case t.Action.InitializeFilePreviewSession:e(t.setNetworkConnectivityState({isOffline:!navigator.onLine}));break;case t.Action.SubscribeNetworkState:window.addEventListener("offline",i);break;case t.Action.UnsubscribeNetworkState:window.removeEventListener("offline",i)}return r(n)}}})),define("typescript/libraries/file-viewer/src/core/middlewares/riviera_data",["require","exports","tslib","typescript/libraries/file-viewer/src/core/data/actions","typescript/libraries/file-viewer/src/core/data/riviera/api","typescript/libraries/file-viewer/src/core/data/riviera/transform","typescript/libraries/file-viewer/src/core/invariant","typescript/libraries/file-viewer/src/core/errors","typescript/libraries/file-viewer/src/core/utils/index","typescript/libraries/file-viewer/src/core/data/utils","typescript/libraries/file-viewer/src/core/constants","typescript/libraries/file-viewer/src/core/urls","typescript/libraries/file-viewer/src/core/data/selectors","typescript/libraries/file-viewer/src/core/data/preview_key"],(function(e,i,t,r,n,a,o,s,l,c,d,p,u,f){"use strict";function v(e){const{previewKey:i,fileViewerId:t}=e.payload;return{previewKey:i,fileViewerId:t}}Object.defineProperty(i,"__esModule",{value:!0}),i.rivieraDataMiddleware=void 0,i.rivieraDataMiddleware=function(e){const i=new n.RivieraClientBase(e);return({getState:e,dispatch:n})=>w=>g=>t.__awaiter(this,void 0,void 0,(function*(){var t,m;const h=e();switch(g.type){case r.Action.FetchRivieraData:{const{fileViewerId:e,previewKey:i,config:t}=g.payload,a=u.getRivieraData(h,i);if(a&&Object.keys(a).length)return;const l=u.getPreviewMetadata(h,i);if(!l||!l.content)throw new s.FVError(s.FVErrorCode.MalformedPreviewsDataApiResponse,"Missing `content` from preview data api payload");const c=[];switch(l.content[".tag"]){case"ssr_doc":case"cloud_doc":const{text_url_tmpl:a,image_url_tmpl:u}=l.content,f="cloud_doc"===l.content[".tag"]?l.content.exit_url:void 0;if(o.invariant(!("cloud_doc"!==l.content[".tag"]&&!a&&!u),s.FVErrorCode.MissingContentMetadata,"Content metadata is not present"),!f&&null!=a&&null!=u){const o=n(r.fetchPageDataWithMetadata({fileViewerId:e,previewKey:i,textUrlTmpl:a,startPage:0,endPage:t.partial_prewarm_allowed?d.TEXT_FIRST_BATCH_SIZE:50,loadPartialPages:!0}));c.push(o);const s="ssr_doc"===l.content[".tag"]?Math.min(...(l.content.supported_widths||[]).concat([480])):void 0;n(r.prewarmUnifiedPreviewAsset({fileViewerId:e,previewKey:i,assetUrl:p.imageUrl(u,0,0,s)}))}break;case"video":{const{metadata_url:e}=l.content;e&&n(r.fetchMediaMetadata({metadataUrl:e,previewKey:i}));break}case"audio":{const e=l.content.waveform_url;e&&n(r.fetchWaveformData({url:e,previewKey:i}));break}case"linkfile":{const e=l.content.url,t=l.content.authenticated;e&&n(r.fetchLinkfileData({url:e,authenticated:!!t,previewKey:i}));break}case"excel":{if("excel2"!==t.excel_support)break;const{content:{workbook_data_url_tmpl:a}}=l;o.invariant(!!a,s.FVErrorCode.MissingContentMetadata,"Content metadata is not present"),null!=a&&c.push(n(r.fetchExcelSheetLayoutData({fileViewerId:e,previewKey:i,sheetIndex:0,workbookDataUrlTmpl:a})));break}case"archive":o.invariant(!!l.preview_url,s.FVErrorCode.MissingContentMetadata,"Content metadata is not present"),l.preview_url&&(n(r.fetchArchiveTopLevelData({fileViewerId:e,previewKey:i,contentUrl:l.preview_url})),c.push(n(r.setupArchiveFileCurrentPath({fileViewerId:e,previewKey:i}))))}return yield Promise.all(c)}case r.Action.FetchPageDataWithMetadata:{const{textUrlTmpl:e,startPage:t,endPage:n,loadPartialPages:l}=g.payload,{previewKey:c,fileViewerId:d}=v(g),p=u.getPreviewMetadata(h,c);try{const u=yield i.fetchDocMetadata(e,!0,t,n);o.invariant(!!p,s.FVErrorCode.InvalidFileInfo,`Preview Data for ${c.serialized} should have been available`);const{image_url_tmpl:f,supported_widths:v}=p.content,{metadata:g}=u;o.invariant(!!g,s.FVErrorCode.MalformedRivieraData,"Response from riviera ssr_doc has no metadata and we also have no existing metadata");const m=g.page_count,[h,b]=l?[t,n]:[0,m];return w(r.fetchPageDataWithMetadataResult({fileViewerId:d,previewKey:c,data:{metadata:g,pages:a.processTextAndUrl(f,g.dimensions,m,u,v,h,Math.min(null!=b?b:m,m))}}))}catch(e){return w(r.fetchPageDataWithMetadataResult({fileViewerId:g.payload.fileViewerId,previewKey:c,data:void 0},e))}}case r.Action.FetchMediaMetadata:{const e=g.payload.previewKey;if(f.isNestedArchiveFilePreviewKey(e))return w(g);try{const t=yield i.fetchMediaMetadata(g.payload.metadataUrl);return o.invariant(!!h.previewData[e.serialized],s.FVErrorCode.InvalidFileInfo,`Preview Data for ${e.serialized} should have been available`),w(r.fetchMediaMetadataResult({data:{is_truncated:t.is_truncated},previewKey:e}))}catch(i){return n(r.fetchMediaMetadataResult({data:{is_truncated:void 0},previewKey:e},i))}}case r.Action.FetchWaveformData:{const e=g.payload.previewKey;if(f.isNestedArchiveFilePreviewKey(e))return w(g);try{const t=yield i.fetchWaveformData(g.payload.url);return o.invariant(!!h.previewData[e.serialized],s.FVErrorCode.InvalidFileInfo,`Preview Data for ${e.serialized} should have been available`),w(r.fetchWaveformDataResult({data:{waveformHeights:t.waveformHeights},previewKey:e}))}catch(i){return n(r.fetchWaveformDataResult({data:{waveformHeights:void 0},previewKey:e},i))}}case r.Action.FetchLinkfileData:{const e=g.payload.previewKey;try{const t=yield i.fetchLinkfileData(g.payload.url,g.payload.authenticated);return o.invariant(!!h.previewData[e.serialized],s.FVErrorCode.InvalidFileInfo,`Preview Data for ${e.serialized} should have been available`),w(r.fetchLinkfileDataResult({data:{uri:t.uri},previewKey:e}))}catch(i){return n(r.fetchLinkfileDataResult({data:{uri:void 0},previewKey:e},i))}}case r.Action.RefreshBlob:{const{previewKey:e,fileViewerId:a}=v(g),d=u.getPreviewMetadata(h,e);try{const p=yield i.refreshDocBlob(g.payload.refreshUrl,g.payload.password);if(w(r.refreshBlobSuccessAction({previewKey:e,preview:p})),o.invariant(!!d,s.FVErrorCode.InvalidFileInfo,`Preview Data for ${e.serialized} should have been available`),g.payload.password)return n(r.fetchPageDataWithMetadata({fileViewerId:a,previewKey:e,textUrlTmpl:p.text_url_tmpl}));const f=u.getFilePreviewUi(h,{fileViewerId:g.payload.fileViewerId},e),v=null!==(m=null===(t=c.filterDocFilePreviewUiState(f))||void 0===t?void 0:t.currentPageIndex)&&void 0!==m?m:0,b=l.calculatePageRange(v);return n(r.fetchPageDataWithMetadata({fileViewerId:a,previewKey:e,textUrlTmpl:p.text_url_tmpl,startPage:b[0],endPage:b[1]}))}catch(i){return w(r.fetchPageDataWithMetadataResult({fileViewerId:a,previewKey:e,data:void 0},i))}}case r.Action.FetchExcelSheetLayoutData:{const{previewKey:e,fileViewerId:t}=v(g);w(g);const{sheetIndex:a,workbookDataUrlTmpl:o}=g.payload;try{const s=yield i.fetchExcelWorkbookLayoutData(o,a);return n(r.fetchExcelSheetLayoutDataResult({fileViewerId:t,previewKey:e,sheetIndex:a,data:s}))}catch(i){return n(r.fetchExcelSheetLayoutDataResult({fileViewerId:t,previewKey:e,sheetIndex:a,data:void 0},i))}}case r.Action.FetchArchiveTopLevelData:{const{previewKey:e,fileViewerId:t}=v(g);w(g);try{const{contentUrl:a}=g.payload,l=yield i.fetchArchiveTopLevelData(a);return o.invariant(!!l,s.FVErrorCode.MalformedRivieraData,"Response from riviera archive has no data"),n(r.fetchArchiveTopLevelDataResult({fileViewerId:t,previewKey:e,data:l}))}catch(i){return n(r.fetchArchiveTopLevelDataResult({fileViewerId:t,previewKey:e,data:void 0},i))}}}return w(g)}))}})),define("typescript/libraries/file-viewer/src/core/middlewares/ui_action_redispatcher",["require","exports","typescript/libraries/file-viewer/src/core/data/actions","typescript/libraries/file-viewer/src/core/data/models","typescript/libraries/file-viewer/src/core/data/utils","typescript/libraries/file-viewer/src/core/data/selectors"],(function(e,i,t,r,n,a){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.uiActionRedispatcher=void 0,i.uiActionRedispatcher=({getState:e})=>i=>o=>{const s=e(),{filePreviewUi:l,rivieraData:c}=s,{previewKey:d,fileViewerId:p}=o.payload;if(!d)return i(o);const u=a.getPreviewMetadata(s,d),f=c[d.serialized];if(!l[p]||!u||!u.content)return i(o);if(!l[p][d.serialized])return i(o);switch(o.type){case t.Action.ZoomIn:return i(t.zoomIn(Object.assign(Object.assign({},o.payload),{previewType:"ssr_doc"===u.content[".tag"]?r.PreviewType.SsrDoc:r.PreviewType.Image})));case t.Action.ZoomOut:return i(t.zoomOut(Object.assign(Object.assign({},o.payload),{previewType:"ssr_doc"===u.content[".tag"]?r.PreviewType.SsrDoc:r.PreviewType.Image})));case t.Action.UpdateDocCurrentPageIndex:if((u.content[".tag"]===r.PreviewType.SsrDoc||u.content[".tag"]===r.PreviewType.CloudDoc)&&n.isDocPreviewRivieraData(f)&&f.metadata)return i(t.updateDocCurrentPageIndex(Object.assign(Object.assign({},o.payload),{pageCount:f.metadata.page_count})));break;case t.Action.PageDown:if((u.content[".tag"]===r.PreviewType.SsrDoc||u.content[".tag"]===r.PreviewType.CloudDoc)&&n.isDocPreviewRivieraData(f)&&f.metadata)return i(t.pageDown(Object.assign(Object.assign({},o.payload),{pageCount:f.metadata.page_count})))}return i(o)}})),define("typescript/libraries/file-viewer/src/file_viewer/file_viewer",["require","exports","tslib","react","react-dom","typescript/libraries/file-viewer/src/core/data/actions","typescript/libraries/file-viewer/src/app","typescript/libraries/file-viewer/src/core/uuid","typescript/libraries/file-viewer/src/core/config","api_v2/redux/previews","api_v2/redux/users","typescript/libraries/file-viewer/src/core/invariant","typescript/libraries/file-viewer/src/core/data/models","typescript/libraries/file-viewer/src/core/utils/index","typescript/libraries/file-viewer/src/core/logging/actions","typescript/libraries/file-viewer/src/core/logging/constants","typescript/libraries/file-viewer/src/core/errors","typescript/libraries/file-viewer/src/core/data/riviera/types","typescript/libraries/file-viewer/src/core/constants","typescript/libraries/file-viewer/src/plugins/index","typescript/libraries/file-viewer/src/plugins/queries","typescript/libraries/file-viewer/src/plugins/context","typescript/libraries/file-viewer/src/plugins/selectors/index","typescript/libraries/file-viewer/src/plugins/navigation","typescript/libraries/file-viewer/src/core/data/store_utils","typescript/libraries/file-viewer/src/plugins/sidebar","api_v2/redux/seen_state","typescript/libraries/file-viewer/src/pass/index","api_v2/redux/files","typescript/libraries/file-viewer/src/core/data/preview_key","typescript/libraries/file-viewer/src/core/data/selectors","typescript/libraries/file-viewer/src/preview_audio_video/helper/browser_detection"],(function(e,i,t,r,n,a,o,s,l,c,d,p,u,f,v,w,g,m,h,b,y,_,E,A,P,S,I,M,C,O,T,x){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.createFileViewer=i.FileViewer=i.defaultPlatformConfig=void 0,r=t.__importStar(r),n=t.__importStar(n),i.defaultPlatformConfig={osModifierKey:"ctrlKey"};class D{constructor(e,i,_){this.mounted=!1,this.sessionActive=!1,this.loadPreviewMetadata=e=>t.__awaiter(this,void 0,void 0,(function*(){const e=this.store,i=this.id,{file_id:t,url:r,previewKey:n}=T.getCurrentFile(e.getState(),i),{config:o}=this.getPlatformProps(),s=[];s.push(e.dispatch(C.getFileContentMetadataAction({arg:{file_path_or_id:t,url:r}}))),s.push(e.dispatch(a.fetchRivieraData({fileViewerId:this.id,previewKey:n,config:o}))),yield Promise.all(s)})),this.selectDefaultPlugin=()=>t.__awaiter(this,void 0,void 0,(function*(){var e,i;const t=yield this.plugins.promisedInstances,r=Object.keys(t),n=this.store.getState(),{previewKey:o}=T.getCurrentFile(n,this.id);this.store.dispatch(a.setActiveRightRailPlugin({fileViewerId:this.id,previewKey:o,sourceContext:w.UserActionContext.Sidebar,pluginId:null!==(i=null!==(e=this.defaultPlugin)&&void 0!==e?e:this.plugins.initialDefaultPlugin)&&void 0!==i?i:r[0]}))})),this.exitPluginEditMode=()=>t.__awaiter(this,void 0,void 0,(function*(){const{config:e}=this.getPlatformProps(),i=this.store.getState(),{previewKey:t}=T.getCurrentFile(i,this.id);e.preview_page_revamp?this.store.dispatch(a.setActiveEditPlugin({fileViewerId:this.id,previewKey:t,sourceContext:w.UserActionContext.Sidebar,pluginId:void 0})):this.selectDefaultPlugin()})),this.reinitializeFileViewer=e=>t.__awaiter(this,void 0,void 0,(function*(){let i;switch(e.userAction){case"click":i=w.SourceAction.Click;break;case"double_click":i=w.SourceAction.DoubleClick;break;case"visit":i=w.SourceAction.Visit}const t=this.store.getState(),r=O.getPreviewKey(e.fileId,e.nsId,e.sjId),{fileConfig:n}=T.getFileMetadata(t,r);let a;switch(e.sourceContext){case"workflow":a=w.SourceContext.Workflow}this.selectDefaultPlugin(),this.initialize({fileSize:e.fileSize,sourceSession:{source_action:i,source_context:a},fileMetadata:{file_id:e.fileId,file_name:e.fileName},fileInfo:{ns_id:e.nsId,sj_id:e.sjId,file_id:e.fileId},fileConfig:n})})),this.resolveFilePreview=(e,i)=>t.__awaiter(this,void 0,void 0,(function*(){var t;let r;p.invariant(!(!e.url&&!e.file_id),g.FVErrorCode.InvalidFileInfo,"You have to either provide a file ID or shared link url to fetch the preview data");const n=null!==(t=e.url)&&void 0!==t?t:i;r=n?{url:n,file_id:e.file_id}:e.ns_id&&e.sj_id?{ns_id:e.ns_id,sj_id:e.sj_id}:{file_id:e.file_id},yield this.store.dispatch(c.getPreviewDataBatchAction({arg:{files:[r],include_dimensions:!0},params:{}},{fileViewerId:this.id}))})),this.initialize=e=>t.__awaiter(this,void 0,void 0,(function*(){yield this.initializeInternalState(e)})),this.initializeInternalState=({fileMetadata:e,fileSize:i,fileInfo:r,fileConfig:n,previewMetadata:o,sourceSession:s,defaultRightRailPlugin:c,pluginParams:d={},supportedPreviewTypes:b=h.DEFAULT_SUPPORTED_PREVIEW_TYPES,sharedLinkInfo:y,unsafe_onPreviewInitialized:_=(()=>{})})=>t.__awaiter(this,void 0,void 0,(function*(){const{file_name:t}=e,h=r.file_id,E=r.sj_id,A=r.ns_id,{store:P,config:S,deviceType:C,accountId:D}=this.getPlatformProps(),F=f.getFileExtension(t),R=this.id,V=f.getFileExtension(t),B=()=>P.getState().networkConnectivity.isOffline,N=T.getCurrentFile(P.getState(),R);N&&this.mounted&&(yield this.doTeardown()),this.store.dispatch(a.setCurrentFilePreview({fileViewerId:this.id,fileInfo:r}));const k=Object.assign(Object.assign({},l.DEFAULT_FILE_CONFIG),null!=n?n:{});let L=void 0;e.file_id&&(L=O.getPreviewKey(e.file_id,A,E)),L&&(P.dispatch(a.setFileMetadata(Object.assign(Object.assign({},e),{fileConfig:k,size:i,previewKey:L}))),o&&k.enable_prefetch_metadata_usage&&P.dispatch(a.setPreviewMetadata(Object.assign(Object.assign({},o),{previewKey:L})))),this.sessionActive=!0,P.dispatch(a.initializeFilePreviewSession({fileViewerId:R,fileId:h,sjId:E,nsId:A,deviceType:C,fileExtension:V,sourceSession:s}));const j=P.getState().loggingSession[this.id].file_preview_session_id;P.dispatch(v.logSessionEvent({event:w.SessionEventType.FilePreviewAttemptStarted,fileViewerId:R,previewSessionId:j}));try{yield this.triggerPluginsPreviewWillInitialize(r,y,void 0===D)}catch(e){P.dispatch(v.logSessionEvent({event:w.SessionEventType.LifecycleFailure,fileViewerId:this.id,previewSessionId:j,extra:{e:e}}))}try{p.invariant(!!F,g.FVErrorCode.NoExtension,"Missing file extension"),p.invariant(!!r.url||!!r.file_id,g.FVErrorCode.InvalidFileInfo,"You have to either provide a file ID or shared link url to fetch the preview data");try{if(L&&T.getPreviewData(P.getState(),L)||(yield this.resolveFilePreview(r,null==y?void 0:y.url)),B())throw new g.FVError(g.FVErrorCode.UserOffline,"There is a network connectivity issue")}catch(e){throw g.isFVError(e)?e:new g.FVError(g.FVErrorCode.PreviewsDataApiFailure,e.message)}const e=T.getCurrentFile(P.getState(),R),{file_id:n,url:o,ns_id:s,sj_id:l,previewKey:h}=e;if(y&&P.dispatch(a.setSharedLinkInfo(Object.assign(Object.assign({},y),{previewKey:h}))),P.dispatch(a.fetchNativeApps({fileId:n})),p.invariant(!!n,g.FVErrorCode.MalformedPreviewsDataApiResponse,"Missing `file_id` in `file_info`"),p.invariant(!(r.url&&o!==r.url||r.file_id&&n!==r.file_id),g.FVErrorCode.FileSwitched,"We have flipped to another file"),yield this.setDefaultActivePlugin(h,c),null==N){const e={fileViewerId:this.id,previewKey:h,sourceContext:w.UserActionContext.Initialization};P.dispatch(a.initializeSidebar(Object.assign(Object.assign({},e),{forceOpen:Boolean(d.shouldFocusApproval)}))),P.dispatch(a.initializeDocSidebar({fileViewerId:this.id,previewKey:h,sourceContext:w.UserActionContext.Initialization})),P.dispatch(a.initializeVolumeAndMuted(e))}const E=T.getPreviewData(P.getState(),h),A=f.resolvePreviewType(E);P.dispatch(a.initializeFilePreview({fileViewerId:R,fileInfo:{file_id:n,size:i,ns_id:s,sj_id:l,previewKey:h},fileExtension:V,fileName:t,previewType:A,fileConfig:k})),p.invariant(A!==u.PreviewType.Error,g.FVErrorCode.MalformedPreviewsDataApiResponse,"Preview Type got resolved to PreviewType.Error, possibly because of missing `content`"),p.invariant(b.includes(A),g.FVErrorCode.UnsupportedPreviewType,"Unsupported preview type"),p.invariant(f.fileSizeSupported(t,i,A,S),g.FVErrorCode.FileTooLarge,"Unsupported file size"),P.dispatch(v.logSessionEvent({event:w.SessionEventType.FilePreviewSupportConfirmed,fileViewerId:R,previewSessionId:j,extra:{preview_type:A}})),P.dispatch(v.logSessionEvent({event:w.SessionEventType.FilePreviewDownloadAttempted,fileViewerId:R,previewSessionId:j,extra:{preview_type:A}})),yield this.loadPreviewMetadata(r).catch(e=>{throw g.isFVError(e)?e:new g.FVError(g.FVErrorCode.RivieraDataFetchFailure,e.message)});const C=P.getState().rivieraData[h.serialized];let O;if(C&&(O=C.error,O&&(null==O?void 0:O.statusCode)!==m.RivieraStatus.PasswordProtected)){if(null==(null==O?void 0:O.statusCode)||B())throw new g.FVError(g.FVErrorCode.UserOffline,"There is a network connectivity issue");throw new g.FVError(g.FVErrorCode.RivieraDataFetchFailure,`Riviera Failure, status code "${O.statusCode}"`)}if(P.dispatch(v.logSessionEvent({event:w.SessionEventType.FilePreviewDownloadSucceeded,fileViewerId:R,previewSessionId:j,extra:{preview_type:A}})),P.dispatch(a.setBootstrappedFile({fileViewerId:R,previewKey:h})),S.log_views_to_pass){const e={file_views:[{file_info:{file_identifier:n,shared_link_details:y?{url:y.url}:void 0},platform_type:{".tag":x.is_android()&&x.is_supported_mobile_browser()?"mobile_android":x.iphone?"mobile_ios":"web"}}]};D?P.dispatch(I.logFileViewAction({arg:e})):P.dispatch(I.loggedOutLogFileViewAction({arg:e}))}try{_(this,n),M.initializePASSPresence(P,n,j),k.enable_pass&&M.initializePASS(P,n),yield this.triggerPluginsPreviewDidInitialize(d)}catch(e){P.dispatch(v.logSessionEvent({event:w.SessionEventType.LifecycleFailure,fileViewerId:this.id,previewSessionId:j,extra:{e:e}}))}this.subscribeToPluginActivation(j)}catch(e){switch(g.isFVError(e)||(e=new g.FVError(g.FVErrorCode.Unknown)),e.type){case g.FVErrorCode.PreviewsDataApiFailure:case g.FVErrorCode.NoExtension:case g.FVErrorCode.InvalidFileInfo:case g.FVErrorCode.UnsupportedPreviewType:case g.FVErrorCode.MalformedPreviewsDataApiResponse:P.dispatch(v.logSessionEvent({event:w.SessionEventType.FilePreviewSupportDenied,fileViewerId:this.id,previewSessionId:j,extra:{error_code:g.FVErrorCode[e.type]}}));break;case g.FVErrorCode.RivieraDataFetchFailure:P.dispatch(v.logSessionEvent({event:w.SessionEventType.FilePreviewDownloadFailed,fileViewerId:this.id,previewSessionId:j,extra:{error_code:g.FVErrorCode[e.type]}}))}const{previewKey:i}=T.getCurrentFile(P.getState(),R);P.dispatch(a.setErroredFile({fileViewerId:R,previewKey:i,error:e})),this.triggerPluginsPreviewDidError(e)}})),this.triggerPluginsPreviewDidRender=()=>t.__awaiter(this,void 0,void 0,(function*(){const e=yield this.plugins.promisedInstances;for(const i of Object.values(e))i.lifecycle.previewDidRender&&i.lifecycle.previewDidRender()})),this.render=(e,i,t,a)=>{var s;this.container=e;const{store:l,intl:c,config:d,platformConfig:p,callbacks:u}=this.getPlatformProps(),f=this.id,{registerSidebarPanesFn:v,renderSidebarControlsFn:w,renderSidebarCallToActionsFn:g}=null!==(s=null==i?void 0:i(this.getPlatformProps))&&void 0!==s?s:{},m=this.plugins.instances;if(null==m)return null;const h=Object.entries(m).reduce((e,[i,t])=>{const r=b.parseRightRailPluginInstance(t);return null==r?e:Object.assign(Object.assign({},e),{[i]:r})},{}),y={rightRailPluginInstances:h,pluginNavigation:this.plugins.navigation,pluginQueryBus:this.plugins.queryBus,getRuntimeDisabledPlugins:()=>E.getRuntimeDisabledPlugins(this.store.getState(),{fileViewerId:this.id})},_=Object.keys(m).length>0,A=null!=v?v:_?S.registerSidebarPanesFn(y):void 0,P=null!=w?w:_?S.renderSidebarControlsFn(y):void 0;return n.render(r.createElement(o.AppWithProvider,{store:l,intl:c,id:f,callbacks:u,config:d,pluginInstances:m,rightRailPluginInstances:h,pluginQueryBus:this.plugins.queryBus,pluginNavigation:this.plugins.navigation,registerSidebarPanesFn:A,renderSidebarControlsFn:P,renderSidebarCallToActionsFn:g,onDestroy:this.handleAppDestroy,onMount:this.handleAppMount,osModifierKey:p.osModifierKey,viewport:t},a),e,this.triggerPluginsPreviewDidRender)},this.doTeardown=()=>t.__awaiter(this,void 0,void 0,(function*(){const{store:e}=this.getPlatformProps(),i=e.getState().loggingSession[this.id].file_preview_session_id;this.endSession();try{this.triggerPluginDidDeactivateForCurrent()}catch(t){e.dispatch(v.logSessionEvent({event:w.SessionEventType.LifecycleFailure,fileViewerId:this.id,previewSessionId:i,extra:{e:t}}))}this.unsubscribeFromPluginActivation&&this.unsubscribeFromPluginActivation();try{yield this.triggerPluginsPreviewWillTeardown()}catch(t){e.dispatch(v.logSessionEvent({event:w.SessionEventType.LifecycleFailure,fileViewerId:this.id,previewSessionId:i,extra:{e:t}}))}})),this.endSession=()=>{if(this.sessionActive){this.sessionActive=!1;const{store:e}=this.getPlatformProps(),i=e.getState().loggingSession[this.id].file_preview_session_id,t=T.getCurrentFile(e.getState(),this.id);e.dispatch(v.logSessionEvent({event:w.SessionEventType.FilePreviewSessionEnded,fileViewerId:this.id,previewSessionId:i})),(null==t?void 0:t.file_id)&&M.teardownPASSPresence(e,t.file_id)}},this.handleAppDestroy=()=>t.__awaiter(this,void 0,void 0,(function*(){this.mounted=!1,yield this.doTeardown()})),this.handleAppMount=()=>{this.mounted=!0},this.unmount=()=>{this.container&&(n.unmountComponentAtNode(this.container),window.removeEventListener("beforeunload",this.endSession))};const P=this.id=i||s.v4();this.getPlatformProps=e;const{store:D,deviceType:F=w.DeviceType.desktop,showAuthModal:R,canCloseViewer:V}=e();this.store=D;const B=_?Object.keys(_)[0]:void 0;this.plugins={navigation:A.makeNavigation({store:D,fileViewerId:P,reinitializeFileViewer:this.reinitializeFileViewer,exitPluginEditMode:this.exitPluginEditMode,showAuthModal:R,canCloseViewer:V}),instances:null,promisedInstances:this.loadPlugins(_),count:null==_?0:Object.keys(_).length,queryBus:new y.PluginQueryBus({getPageForSelection:()=>{}}),initialDefaultPlugin:B},this.defaultPlugin=void 0,D.dispatch(a.initializeFileViewer({fileViewerId:P,deviceType:F})),D.dispatch(d.getCurrentAccountAction({arg:void 0,params:{}})),D.dispatch(d.getRootInfoAction({arg:void 0})),window.addEventListener("beforeunload",this.endSession,{once:!0})}loadPlugins(e={}){const i={},{config:r}=this.getPlatformProps();return Promise.all(Object.keys(e).map(n=>t.__awaiter(this,void 0,void 0,(function*(){const t=e[n],a=yield t(),o=_.makePluginContext({store:this.store,sdkConfig:r,fileViewerId:this.id,pluginId:n,reinitializeFileViewer:this.reinitializeFileViewer,exitPluginEditMode:this.exitPluginEditMode});return i[n]=new a(o),i})))).then(()=>(this.plugins.instances=Object.keys(e).reduce((e,t)=>Object.assign(Object.assign({},e),{[t]:i[t]}),{}),i))}get unstable_pluginInstances(){if(null==this.plugins.instances)throw new Error("Attempted to access plugin instances before initialization");return this.plugins.instances}getPluginByName(e){return e&&this.plugins.instances&&this.plugins.instances[e]?this.plugins.instances[e]:null}getActivePluginInstance(){const e=E.getActivePluginId(this.store.getState(),{fileViewerId:this.id});return this.getPluginByName(e)}setDefaultActivePlugin(e,i){return t.__awaiter(this,void 0,void 0,(function*(){var t;if(this.defaultPlugin=i,E.getSelectedPluginId(this.store.getState(),{fileViewerId:this.id}))return;const r=yield this.plugins.promisedInstances,n=Object.keys(r);0!==n.length&&this.store.dispatch(a.setActiveRightRailPlugin({fileViewerId:this.id,previewKey:e,sourceContext:w.UserActionContext.Initialization,pluginId:null!==(t=null!=i?i:this.plugins.initialDefaultPlugin)&&void 0!==t?t:n[0]}))}))}triggerPluginDidDeactivateForCurrent(){const e=this.getActivePluginInstance();e&&e.lifecycle&&e.lifecycle.pluginDidDeactivate&&e.lifecycle.pluginDidDeactivate()}triggerPluginsPreviewWillInitialize({file_id:e,ns_id:i,sj_id:r,url:n},a,o){return t.__awaiter(this,void 0,void 0,(function*(){let t;if(null!=e)t={fileId:e};else if(null!=i&&null!=r)t={nsId:i,sjId:r};else{if(null==n)throw new Error("Expected file_id, ns_id/sj_id, or url to be present");t={sharedLinkUrl:n}}const s=yield this.plugins.promisedInstances;for(const{lifecycle:{previewWillInitialize:e}}of Object.values(s))null!=e&&e(t,a,o)}))}subscribeToPluginActivation(e){return t.__awaiter(this,void 0,void 0,(function*(){const i=this.id;this.unsubscribeFromPluginActivation=P.observeStore(this.store,e=>E.getActivePluginId(e,{fileViewerId:i}),(i,t)=>{const r=this.getPluginByName(i);if(r&&r.lifecycle&&r.lifecycle.pluginDidDeactivate)try{r.lifecycle.pluginDidDeactivate()}catch(i){this.store.dispatch(v.logSessionEvent({event:w.SessionEventType.LifecycleFailure,fileViewerId:this.id,previewSessionId:e,extra:{e:i}}))}const n=this.getPluginByName(t);if(n&&r!==n&&n.lifecycle&&n.lifecycle.pluginDidActivate)try{n.lifecycle.pluginDidActivate()}catch(i){this.store.dispatch(v.logSessionEvent({event:w.SessionEventType.LifecycleFailure,fileViewerId:this.id,previewSessionId:e,extra:{e:i}}))}})}))}triggerPluginsPreviewDidInitialize(e){return t.__awaiter(this,void 0,void 0,(function*(){const i=yield this.plugins.promisedInstances;for(const t of Object.values(i))null!=t.lifecycle.previewDidInitialize&&t.lifecycle.previewDidInitialize(e)}))}triggerPluginsPreviewWillTeardown(){return t.__awaiter(this,void 0,void 0,(function*(){const e=yield this.plugins.promisedInstances;for(const i of Object.values(e))i.lifecycle.previewWillTeardown&&i.lifecycle.previewWillTeardown()}))}triggerPluginsPreviewDidError(e){return t.__awaiter(this,void 0,void 0,(function*(){const i=yield this.plugins.promisedInstances;for(const t of Object.values(i))t.lifecycle.previewDidError&&t.lifecycle.previewDidError(e)}))}}i.FileViewer=D,i.createFileViewer=function(e,i,r={}){return n=>{const{intl:a}=e(),o={};for(const e of Object.keys(r)){const n=r[e];o[e]=()=>t.__awaiter(this,void 0,void 0,(function*(){return n({intl:a,apiv2ClientBase:i})}))}return new D(e,n,o)}}})),define("typescript/libraries/file-viewer/src/preview_archive/archive_snack_bar",["require","exports","tslib","react","dig-components/snackbar","dig-components/progress_indicators","dig-components/icons","dig-components/icons/src","dig-components/buttons","typescript/libraries/file-viewer/src/css/preview-archive.css","typescript/libraries/file-viewer/src/core/data/actions"],(function(e,i,t,r,n,a,o,s,l,c,d){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.ArchiveSnackBar=void 0,r=t.__importStar(r),c=t.__importStar(c),i.ArchiveSnackBar=e=>{const i=e.filePreviewUiData.extractAllSnackbarState,{intl:t,fileViewerId:p,previewKey:u,dispatch:f}=e,v=r.useMemo(()=>()=>f(d.updateArchiveExtractAllSnackbarState({extractAllSnackbarState:null,fileViewerId:p,previewKey:u})),[f,p,u]);if(!i)return null;let w;if("pending"===i.state)w=r.createElement(n.Snackbar,{open:!0,timeout:0},r.createElement(a.Spinner,{"aria-valuetext":"Loading",size:"small",inverse:!0}),r.createElement(n.Snackbar.Message,null,t.formatMessage({id:"Cdmrh0",defaultMessage:"Extracting files..."})));else if("loaded"===i.state){const e=()=>{f(d.openFileURL({fqPath:i.data}))};w=r.createElement(n.Snackbar,{open:!0,timeout:0},r.createElement(o.UIIcon,{src:s.CheckmarkCircleLine}),r.createElement(n.Snackbar.Message,null,t.formatMessage({id:"Qs0be2",defaultMessage:"Files extracted to {folder} in your main Dropbox folder"},{folder:i.data})),r.createElement(n.Snackbar.Actions,null,r.createElement(l.Button,{variant:"transparent",inverse:!0,onClick:e},t.formatMessage({id:"SliIKT",defaultMessage:"Open"})),r.createElement(l.Button,{variant:"transparent",inverse:!0,onClick:v},t.formatMessage({id:"1dhg8/",defaultMessage:"Close"}))))}else w=r.createElement(n.Snackbar,{open:!0,timeout:0},r.createElement(o.UIIcon,{src:s.FailLine}),r.createElement(n.Snackbar.Message,null,t.formatMessage({id:"Jh3TK7",defaultMessage:"Couldn't extract files"})),r.createElement(n.Snackbar.Actions,null,r.createElement(l.Button,{variant:"transparent",inverse:!0,onClick:v},t.formatMessage({id:"1dhg8/",defaultMessage:"Close"}))));return r.createElement("div",{className:c.snackBar},w)}})),define("typescript/libraries/file-viewer/src/preview_error/index",["require","exports","tslib","react","typescript/libraries/file-viewer/src/css/preview-error.css","dig-components/buttons","typescript/libraries/file-viewer/src/core/logging/constants","typescript/libraries/file-viewer/src/open_with_native/index","typescript/libraries/file-viewer/src/sidebar/download_dropdown","typescript/libraries/file-viewer/src/core/data/preview_key","typescript/libraries/file-viewer/src/preview_archive/archive_snack_bar","typescript/libraries/file-viewer/src/toolbar/toolbar_v2","typescript/libraries/file-viewer/src/core/data/actions","typescript/libraries/file-viewer/src/core/errors","typescript/libraries/file-viewer/src/core/i18n","typescript/libraries/file-viewer/src/core/utils/index","typescript/libraries/file-viewer/src/plugins/types"],(function(e,i,t,r,n,a,o,s,l,c,d,p,u,f,v,w,g){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.PreviewError=i.TestOnlyErrorPage=i.UserOffline=i.FileUploading=i.FileTooLarge=i.NoExtension=i.DataFetchFailure=i.Unavailable=i.ArchiveFilePasswordProtected=i.PasswordProtected=i.ArchiveNestedFiletypeNotSupported=i.FiletypeNotSupported=void 0,r=t.__importStar(r),n=t.__importStar(n);const m=(e,i)=>{const n=r.lazy(()=>t.__awaiter(void 0,void 0,void 0,(function*(){const{[i]:t}=yield e();return{default:t}}))),a=()=>r.createElement(r.Suspense,{fallback:null},r.createElement(n,null));return a.displayName=`Async${i}`,a},h=m(()=>new Promise((i,t)=>{e(["dig-illustrations/spot/look-view"],i,t)}).then(t.__importStar),"LookViewSpot"),b=m(()=>new Promise((i,t)=>{e(["dig-illustrations/spot/traffic-duck-crossing"],i,t)}).then(t.__importStar),"TrafficDuckCrossingSpot"),y=m(()=>new Promise((i,t)=>{e(["dig-illustrations/spot/team-ants"],i,t)}).then(t.__importStar),"TeamAntsSpot"),_=m(()=>new Promise((i,t)=>{e(["dig-illustrations/spot/passcode-lock"],i,t)}).then(t.__importStar),"PasscodeLockSpot");function E({title:e,message:i,illustration:t,children:a}){return r.createElement("article",{className:n.container},r.createElement("div",{className:n.illustrationContainer},t),r.createElement("header",{className:n.header},r.createElement("h1",null,e)),i?r.createElement("p",{className:n.message},i):null,a)}const A=({fileConfig:e,intl:i,dispatch:t,fileViewerId:a,previewKey:o,extractConfig:d={canExtract:!1}})=>{var p,u,f,v,w,g;const m=c.isFileIdPreviewKey(o)?o.fileId:null;return(null===(p=null==e?void 0:e.download_button)||void 0===p?void 0:p.enable_download_button)&&m?r.createElement(l.DownloadDropdown,{intl:i,dispatch:t,fileViewerId:a,fileId:m,previewKey:o,copyTargets:null!==(f=null===(u=null==e?void 0:e.download_button)||void 0===u?void 0:u.copy_targets)&&void 0!==f?f:[],canDownload:null!==(w=null===(v=null==e?void 0:e.download_button)||void 0===v?void 0:v.can_download)&&void 0!==w&&w,useTextButton:!0,useOutlineButton:!0,extractConfig:d}):(null===(g=null==e?void 0:e.download_button)||void 0===g?void 0:g.enable_open_with_button)?r.createElement(s.OpenWithButton,{variant:"outline",collapsed:!1,dispatch:t,intl:i,fileViewerId:a,className:n.ctaSecondary}):null};A.displayName="DownloadOrOpenWithButton",i.FiletypeNotSupported=({fileViewerId:e,fileMetadata:i,previewKey:t,intl:s,dispatch:l,extractConfig:c,fileConfig:d})=>r.createElement(E,{illustration:r.createElement(h,null),title:s.formatMessage({id:"73IpwD",defaultMessage:"{extension} files can’t currently be previewed."},{extension:w.getFileExtension(i?i.file_name:"")}),fileName:i?i.file_name:""},r.createElement(A,{previewKey:t,fileViewerId:e,intl:s,dispatch:l,extractConfig:c,fileConfig:d}),r.createElement(a.Button,{variant:"transparent",onClick:()=>l(u.openWebPreview({fileViewerId:e,previewKey:t,sourceContext:o.UserActionContext.PreviewError})),className:n.ctaLink},s.formatMessage({id:"qLPMn5",defaultMessage:"View on dropbox.com"}))),i.FiletypeNotSupported.displayName="FiletypeNotSupported",i.ArchiveNestedFiletypeNotSupported=({fileName:e,fileSize:i,intl:t})=>{const n=w.getFileExtension(e),a=n?t.formatMessage({id:"x+ecOm",defaultMessage:"{extension} files can’t be previewed from an archive file."},{extension:n}):t.formatMessage({id:"SQjtty",defaultMessage:"This file cannot be previewed. Please check to see if your file extension is correct."});return r.createElement(E,{illustration:r.createElement(h,null),title:a,fileName:e,message:t.formatMessage({id:"WF66bN",defaultMessage:"{filename} · {filesize}"},{filename:e,filesize:v.formatBytes(i,t)})})},i.ArchiveNestedFiletypeNotSupported.displayName="ArchiveNestedFiletypeNotSupported",i.ArchiveNestedFiletypeNotSupported.displayName="ArchiveNestedFiletypeNotSupported",i.PasswordProtected=({fileName:e,intl:i})=>r.createElement(E,{illustration:r.createElement(_,null),title:i.formatMessage({id:"tzyBCT",defaultMessage:"This {extension} file is password-protected"},{extension:w.getFileExtension(e)}),fileName:e}),i.PasswordProtected.displayName="PasswordProtected",i.ArchiveFilePasswordProtected=({fileName:e,intl:i})=>r.createElement(E,{illustration:r.createElement(_,null),title:i.formatMessage({id:"eO6mPw",defaultMessage:"Can't preview items inside password protected {extension} files."},{extension:w.getFileExtension(e)}),fileName:e}),i.ArchiveFilePasswordProtected.displayName="ArchiveFilePasswordProtected",i.ArchiveFilePasswordProtected.displayName="ArchiveFilePasswordProtected",i.Unavailable=({fileMetadata:e,previewKey:i,fileConfig:t,intl:n,fileViewerId:a,dispatch:o,extractConfig:s})=>{var l;const c=n.formatMessage({id:"w0q1CU",defaultMessage:"Couldn’t preview this file"}),d=null!==(l=null==e?void 0:e.file_name)&&void 0!==l?l:"";return r.createElement(E,{illustration:r.createElement(h,null),title:c,fileName:d},r.createElement(A,{previewKey:i,fileViewerId:a,intl:n,dispatch:o,extractConfig:s,fileConfig:t}))},i.Unavailable.displayName="Unavailable",i.DataFetchFailure=({fileMetadata:e,intl:i})=>{let t,n;return e?(t=i.formatMessage({id:"ejp+g5",defaultMessage:"{extension} files are supported but something went wrong."},{extension:w.getFileExtension(e.file_name)}),n=e.file_name):(t=i.formatMessage({id:"0ljH1z",defaultMessage:"This file cannot be previewed"}),n=""),r.createElement(E,{illustration:r.createElement(h,null),title:t,fileName:n})},i.DataFetchFailure.displayName="DataFetchFailure",i.NoExtension=({fileMetadata:e,intl:i,dispatch:t,fileViewerId:n,previewKey:a,extractConfig:o,fileConfig:s})=>r.createElement(E,{illustration:r.createElement(h,null),title:i.formatMessage({id:"vbytsy",defaultMessage:"Files without extensions cannot be previewed"}),fileName:e?e.file_name:""},r.createElement(A,{previewKey:a,fileViewerId:n,intl:i,dispatch:t,extractConfig:o,fileConfig:s})),i.NoExtension.displayName="NoExtension",i.FileTooLarge=({fileMetadata:e,previewKey:i,previewMetadata:t,intl:n,dispatch:a,fileViewerId:o,config:s,fileConfig:l,extractConfig:c={canExtract:!1}})=>r.createElement(E,{illustration:r.createElement(y,null),title:n.formatMessage({id:"Jap7oN",defaultMessage:"This file is too big to preview"}),message:n.formatMessage({id:"CaboZW",defaultMessage:"The maximum size for {extension} files is {size}"},{extension:e?w.getFileExtension(e.file_name):"",size:v.formatBytes(w.getFileSizeLimit(e?e.file_name:"",w.resolvePreviewType(t),s),n)}),fileName:e?e.file_name:""},r.createElement(A,{previewKey:i,fileViewerId:o,intl:n,dispatch:a,extractConfig:c,fileConfig:l})),i.FileTooLarge.displayName="FileTooLarge",i.FileUploading=({fileMetadata:e,intl:i,dispatch:t,fileViewerId:n,previewKey:a,extractConfig:o,fileConfig:s})=>r.createElement(E,{illustration:r.createElement(b,null),title:i.formatMessage({id:"fz7GLr",defaultMessage:"File is uploading"}),fileName:e?e.file_name:""},r.createElement(A,{previewKey:a,fileViewerId:n,intl:i,dispatch:t,extractConfig:o,fileConfig:s})),i.FileUploading.displayName="FileUploading",i.UserOffline=({dispatch:e,fileMetadata:i,fileViewerId:t,intl:n,previewKey:a,extractConfig:o,fileConfig:s})=>r.createElement(E,{illustration:r.createElement(h,null),title:n.formatMessage({id:"jZUA7r",defaultMessage:"This file cannot be previewed because you are offline"}),fileName:i?i.file_name:""},r.createElement(A,{previewKey:a,fileViewerId:t,intl:n,dispatch:e,extractConfig:o,fileConfig:s})),i.UserOffline.displayName="UserOffline";const P=e=>{switch(e.error.type){case f.FVErrorCode.UnsupportedPreviewType:return r.createElement(i.FiletypeNotSupported,Object.assign({},e));case f.FVErrorCode.NoExtension:return r.createElement(i.NoExtension,Object.assign({},e));case f.FVErrorCode.FileTooLarge:return r.createElement(i.FileTooLarge,Object.assign({},e));case f.FVErrorCode.PasswordProtected:return r.createElement(i.PasswordProtected,{intl:e.intl,fileName:e.fileMetadata?e.fileMetadata.file_name:""});case f.FVErrorCode.FileUploading:return r.createElement(i.FileUploading,Object.assign({},e));case f.FVErrorCode.UserOffline:return r.createElement(i.UserOffline,Object.assign({},e));case f.FVErrorCode.RivieraDataFetchFailure:return r.createElement(i.DataFetchFailure,Object.assign({},e));case f.FVErrorCode.PreviewsDataApiFailure:case f.FVErrorCode.MalformedPreviewsDataApiResponse:case f.FVErrorCode.MalformedRivieraData:case f.FVErrorCode.Unknown:case f.FVErrorCode.FileSwitched:case f.FVErrorCode.InvalidFileInfo:case f.FVErrorCode.InvalidLoggingOrder:case f.FVErrorCode.InvalidLoggingSession:case f.FVErrorCode.MissingContentMetadata:return r.createElement(i.Unavailable,Object.assign({},e))}};i.TestOnlyErrorPage=P,P.displayName="ErrorPage",i.PreviewError=e=>{var i;const{extractConfig:t,fileMetadata:n,intl:a,previewKey:o,fileViewerId:s,dispatch:l,rootArchiveFileInformation:c,config:u,coreFileViewerUiData:f,filePreviewUiData:v,toolbarPlugins:w,snackbarManagerPluginInstance:m,width:h,responsiveSize:b}=e,y=(null==t?void 0:t.canExtract)&&n?r.createElement(d.ArchiveSnackBar,{filePreviewUiData:t.filePreviewUiData,intl:a,previewKey:o,fileViewerId:s,dispatch:l}):null,_=null===(i=n)||void 0===i?void 0:i.fileConfig;return r.createElement(r.Fragment,null,y,r.createElement(P,Object.assign({},e,{fileConfig:_})),e.config.preview_page_revamp&&r.createElement(p.ConfigurableToolbarV2,{featureConfig:u,rootArchiveFileInformation:c,fileViewerId:s,previewKey:o,intl:a,filePreviewUi:v,fileMetadata:n,fileViewerUi:f,previewType:g.PreviewType.Error,plugins:w,snackbarManagerPluginInstance:m,previewWidth:h,responsiveSize:b}))},i.PreviewError.displayName="PreviewError"})),define("typescript/libraries/file-viewer/src/preview_doc/renderer/index",["require","exports","tslib","react","typescript/libraries/file-viewer/src/preview_doc/renderer/ppt","typescript/libraries/file-viewer/src/preview_doc/renderer/pdf","typescript/libraries/file-viewer/src/core/logging/constants","typescript/libraries/file-viewer/src/preview_doc/data_transform","typescript/libraries/file-viewer/src/css/preview-doc.css","typescript/libraries/file-viewer/src/css/preview-core.css","typescript/libraries/file-viewer/src/css/doc-sidebar.css","typescript/libraries/file-viewer/src/preview_doc/password_modal","typescript/libraries/file-viewer/src/preview_error/index","typescript/libraries/file-viewer/src/keyboard/index","typescript/libraries/file-viewer/src/preview_doc/layers","typescript/libraries/file-viewer/src/core/utils/index","typescript/libraries/file-viewer/src/toolbar/toolbar","typescript/libraries/file-viewer/src/modes/sidebar/utils","typescript/libraries/file-viewer/src/core/constants","typescript/libraries/file-viewer/src/toolbar/toolbar_v2","typescript/libraries/file-viewer/src/core/data/actions","typescript/libraries/file-viewer/src/core/data/riviera/types","typescript/libraries/file-viewer/src/core/errors","typescript/libraries/file-viewer/src/file_extension/extension_constants","typescript/libraries/file-viewer/src/plugins/types","typescript/libraries/file-viewer/src/core/invariant"],(function(e,i,t,r,n,a,o,s,l,c,d,p,u,f,v,w,g,m,h,b,y,_,E,A,P,S){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.PreviewDoc=void 0,r=t.__importStar(r);const I=parseInt(l.pageMargin,10),M=parseInt(l.pageMarginTop,10),C=parseInt(l.pageMarginLeft,10),O=parseInt(d.sidebarWidth,10),T=[".docx",".pptx"];class x extends r.PureComponent{constructor(e){super(e),this.state={failedPasswordAttempt:0,passwordDismissed:!1,transformedData:this.props.rivieraData?s.transformData(this.props.rivieraData):this.props.data},this.handlePageChange=(e,i)=>{this.props.dispatch(y.updateDocCurrentPageIndex({fileViewerId:this.props.fileViewerId,previewKey:this.props.previewKey,pageIndex:e,sourceContext:i}))},this.handlePdfPageChange=e=>{this.handlePageChange(e,o.UserActionContext.MouseWheel)},this.handlePasswordSubmit=e=>{const{fileViewerId:i,previewKey:t,previewMetadata:r}=this.props;if(!r||!r.content)return;const{refresh_url:n,text_url_tmpl:a,image_url_tmpl:o}=r.content;S.invariant(!!n,E.FVErrorCode.MalformedRivieraData,"Cannot send password! Missing refresh_url from preview metadata"),this.props.dispatch(y.refreshBlobAction({fileViewerId:i,previewKey:t,refreshUrl:n,oldPreview:{text_url_tmpl:a,image_url_tmpl:o},password:e}))},this.handlePasswordDismiss=()=>{this.setState({passwordDismissed:!0})},this.fetchPageDataWithMetadata=(e,i,t)=>{const[r,n]=this.metadataBatchPageRange=w.calculatePageRange(e,this.props.config.partial_prewarm_allowed);i&&this.props.dispatch(y.fetchPageDataWithMetadata({fileViewerId:this.props.fileViewerId,previewKey:t,textUrlTmpl:i.content.text_url_tmpl,startPage:r,endPage:n}))},this.onRenderSucceeded=()=>{this.props.onRenderSucceeded(),this.fetchPageDataWithMetadata(this.props.filePreviewUiData.currentPageIndex,this.props.previewMetadata,this.props.previewKey)},this.zoomIn=()=>{const{dispatch:e,fileViewerId:i,previewKey:t}=this.props;e(y.zoomIn({fileViewerId:i,previewKey:t,sourceContext:o.UserActionContext.Keyboard}))},this.zoomOut=()=>{const{dispatch:e,fileViewerId:i,previewKey:t}=this.props;e(y.zoomOut({fileViewerId:i,previewKey:t,sourceContext:o.UserActionContext.Keyboard}))},this.keyboardBindings=f.getZoomInOutBindings({zoomIn:this.zoomIn,zoomOut:this.zoomOut}),e.config.partial_prewarm_allowed?this.metadataBatchPageRange=[0,h.TEXT_FIRST_BATCH_SIZE]:this.metadataBatchPageRange=[0,50]}recalculateFitScaleFactor(e=this.props){const{rivieraData:i,fileViewerId:t,previewKey:r,width:n,height:a,dispatch:o}=e;if(!i||!i.metadata)return;const s=b.shouldShowDocSidebar(n)&&this.props.config.enable_navigation_bar,l=Math.max(0,n-I-C-(s?O:0)-15),c=Math.max(0,a-I-M),{scaleToFit:d,maxWidth:p}=this.props.config.preview_types[P.PreviewType.SsrDoc],u=null!=p?Math.min(l,p):l,f=c,{dimensions:v}=i.metadata;if(0===v.length)return 1;const w=v.reduce((e,[i,t])=>Math.min(e,u/i,"width_and_height"===d?f/t:Number.POSITIVE_INFINITY),Number.POSITIVE_INFINITY);o(y.updateFitScaleFactor({fileViewerId:t,previewKey:r,fitScaleFactor:w}))}componentDidMount(){this.props.fileMetadata&&T.includes(w.getFileExtension(this.props.fileMetadata.file_name))&&this.props.dispatch(y.triggerDynamicRoutingModalCheck()),this.recalculateFitScaleFactor()}UNSAFE_componentWillReceiveProps(e){const{rivieraData:i,previewMetadata:t}=e;e.previewKey.serialized!==this.props.previewKey.serialized?this.setState({failedPasswordAttempt:0,passwordDismissed:!1}):i&&i!==this.props.rivieraData&&i.error&&i.error.statusCode===_.RivieraStatus.PasswordProtected&&this.setState({failedPasswordAttempt:this.state.failedPasswordAttempt+1}),i!==this.props.rivieraData&&this.setState({transformedData:i?s.transformData(i):e.data});const{currentPageIndex:r}=e.filePreviewUiData,[n,a]=this.metadataBatchPageRange;!(r>=n&&r<a)&&i&&t&&w.canPreviewInPreviewDoc(t)&&this.fetchPageDataWithMetadata(r,t,e.previewKey),this.recalculateFitScaleFactor(e)}render(){var e,i;const{config:t,coreFileViewerUiData:o,dispatch:s,previewKey:l,fileMetadata:d,filePreviewUiData:h,fileViewerId:y,fileConfig:S,height:M,intl:T,rootArchiveFileInformation:x,rivieraData:D,width:F,toolbarPlugins:R,snackbarManagerPluginInstance:V}=this.props,{failedPasswordAttempt:B,transformedData:N,passwordDismissed:k}=this.state,L=d?d.file_name:"";if(null===(e=this.props.rivieraData)||void 0===e?void 0:e.error)return this.props.rivieraData.error.statusCode!==_.RivieraStatus.PasswordProtected?r.createElement(u.PreviewError,Object.assign({},this.props,{rivieraData:void 0,data:void 0,error:new E.FVError(E.FVErrorCode.RivieraDataFetchFailure,this.props.rivieraData.error.message)})):k||B>3?r.createElement(r.Fragment,null,r.createElement(u.PasswordProtected,{fileName:L,intl:T}),t.preview_page_revamp&&r.createElement(b.ConfigurableToolbarV2,{previewKey:l,fileConfig:S,fileViewerId:y,featureConfig:t,intl:T,showDocSidebar:b.shouldShowDocSidebar(this.props.width),previewType:P.PreviewType.Error,rootArchiveFileInformation:x,fileViewerUi:o,filePreviewUi:h,fileMetadata:d,plugins:R,snackbarManagerPluginInstance:V,previewWidth:F})):r.createElement(p.PasswordModal,{enteredWrongPassword:!!B,intl:T,onSubmit:this.handlePasswordSubmit,onDismiss:this.handlePasswordDismiss,fileName:L});const j=I+C,U=Math.round(100*(F-j-O)/window.innerWidth/window.devicePixelRatio),K=Object.assign(Object.assign({},h),{viewportWidth:U}),z=Object.assign(Object.assign({},this.props),{onRenderSucceeded:this.onRenderSucceeded,filePreviewUiData:K,data:(N||[]).filter(e=>e),onPageChange:this.handlePdfPageChange,layerRenderFn:v.defaultLayerRenderFn,pageNavigation:h.pageNavigation});return r.createElement("div",{className:c.app,style:{width:F,height:M}},A.PRESENTATION_EXTS.includes(w.getFileExtension(L))?r.createElement(n.PreviewPPT,Object.assign({},z,{onPageChange:this.handlePageChange})):r.createElement(a.PreviewPDF,Object.assign({},z,{isEditMode:m.isPluginEditMode(null===(i=this.props.activePluginInstance)||void 0===i?void 0:i.mode)})),!t.preview_page_revamp&&r.createElement(g.ConfigurableToolbarV1,{className:c.toolbar,previewKey:l,fileConfig:S,fileViewerId:y,featureConfig:t,intl:T,previewType:P.PreviewType.SsrDoc,dispatch:s,rootArchiveFileInformation:x,fileViewerUi:o,filePreviewUi:h,fileMetadata:d,fileRivieraData:D}),r.createElement(f.KeyboardBindingConnector,{keyboardBindings:this.keyboardBindings}))}}i.PreviewDoc=x,x.displayName="PreviewDoc"})),define("typescript/libraries/file-viewer/src/preview_doc/index",["require","exports","typescript/libraries/file-viewer/src/preview_doc/sidebar","typescript/libraries/file-viewer/src/preview_doc/links_layer","typescript/libraries/file-viewer/src/preview_doc/text_transform","typescript/libraries/file-viewer/src/preview_doc/img_layer","typescript/libraries/file-viewer/src/preview_doc/text_layer","typescript/libraries/file-viewer/src/preview_doc/text_transform","typescript/libraries/file-viewer/src/preview_doc/error_snackbar","typescript/libraries/file-viewer/src/preview_doc/types","typescript/libraries/file-viewer/src/preview_doc/renderer/index","typescript/libraries/file-viewer/src/preview_doc/renderer/page","typescript/libraries/file-viewer/src/preview_doc/renderer/pdf_pages","typescript/libraries/file-viewer/src/preview_doc/renderer/pdf","typescript/libraries/file-viewer/src/preview_doc/renderer/ppt","typescript/libraries/file-viewer/src/preview_doc/password_modal","typescript/libraries/file-viewer/src/preview_doc/layers"],(function(e,i,t,r,n,a,o,s,l,c,d,p,u,f,v,w,g){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.defaultLayerRenderFn=i.PasswordModal=i.PreviewPPT=i.PreviewPDF=i.PdfPages=i.Page=i.PreviewDoc=i.TextDir=i.TextNodeType=i.ErrorSnackbar=i.transformText=i.TextLayer=i.ImgLayer=i.normalizeUrl=i.isLinkUrl=i.LinksLayer=i.SIDEBAR_WIDTH=i.Sidebar=void 0,Object.defineProperty(i,"Sidebar",{enumerable:!0,get:function(){return t.Sidebar}}),Object.defineProperty(i,"SIDEBAR_WIDTH",{enumerable:!0,get:function(){return t.SIDEBAR_WIDTH}}),Object.defineProperty(i,"LinksLayer",{enumerable:!0,get:function(){return r.LinksLayer}}),Object.defineProperty(i,"isLinkUrl",{enumerable:!0,get:function(){return r.isLinkUrl}}),Object.defineProperty(i,"normalizeUrl",{enumerable:!0,get:function(){return n.normalizeUrl}}),Object.defineProperty(i,"ImgLayer",{enumerable:!0,get:function(){return a.ImgLayer}}),Object.defineProperty(i,"TextLayer",{enumerable:!0,get:function(){return o.TextLayer}}),Object.defineProperty(i,"transformText",{enumerable:!0,get:function(){return s.transform}}),Object.defineProperty(i,"ErrorSnackbar",{enumerable:!0,get:function(){return l.ErrorSnackbar}}),Object.defineProperty(i,"TextNodeType",{enumerable:!0,get:function(){return c.TextNodeType}}),Object.defineProperty(i,"TextDir",{enumerable:!0,get:function(){return c.TextDir}}),Object.defineProperty(i,"PreviewDoc",{enumerable:!0,get:function(){return d.PreviewDoc}}),Object.defineProperty(i,"Page",{enumerable:!0,get:function(){return p.Page}}),Object.defineProperty(i,"PdfPages",{enumerable:!0,get:function(){return u.PdfPages}}),Object.defineProperty(i,"PreviewPDF",{enumerable:!0,get:function(){return f.PreviewPDF}}),Object.defineProperty(i,"PreviewPPT",{enumerable:!0,get:function(){return v.PreviewPPT}}),Object.defineProperty(i,"PasswordModal",{enumerable:!0,get:function(){return w.PasswordModal}}),Object.defineProperty(i,"defaultLayerRenderFn",{enumerable:!0,get:function(){return g.defaultLayerRenderFn}})})),define("typescript/libraries/file-viewer/src/sidebar_v2/right_rail",["require","exports","tslib","react","typescript/component_libraries/files_components/src/right-rail/right_rail","react-redux","typescript/libraries/file-viewer/src/plugins/types","typescript/libraries/file-viewer/src/css/right_rail/right_rail.css","typescript/libraries/file-viewer/src/plugins/data","typescript/libraries/file-viewer/src/plugins/props","typescript/libraries/file-viewer/src/plugins/selectors/active_plugin","typescript/libraries/file-viewer/src/core/data/selectors","typescript/libraries/file-viewer/src/core/data/actions"],(function(e,i,t,r,n,a,o,s,l,c,d,p,u){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.PreviewRightRail=i.NOOP=void 0,r=t.__importStar(r),s=t.__importStar(s),i.NOOP=()=>{},i.PreviewRightRail=r.default.memo(({fileViewerId:e,previewKey:t,fileName:f,intl:v,pluginInstances:w,pluginNavigation:g,pluginQueryBus:m,height:h})=>{const b=a.useDispatch(),y=a.useSelector(i=>p.isSidebarOpen(i,{fileViewerId:e})),_=a.useSelector(i=>l.getPluginData(i,{fileViewerId:e,navigation:g})),E=a.useSelector(i=>c.makePluginProps(i,e,_,m)),A=a.useSelector(i=>c.makePluginControlProps(i,e,_,m)),P=a.useSelector(i=>{var t;return d.getSelectedRightRailPluginId(i,{fileViewerId:e})||(null===(t=Object.keys(w))||void 0===t?void 0:t[0])}),S=r.default.useCallback(i=>{i===P&&y||b(u.setActiveRightRailPlugin({pluginId:i,fileViewerId:e,previewKey:t,sourceContext:o.UserActionContext.Sidebar}))},[b,e,t,P,y]),I=r.default.useCallback(()=>{const i={fileViewerId:e,previewKey:t,sourceContext:o.UserActionContext.Sidebar};b(u.openSidebar(i))},[b,e,t]),M=r.useCallback(()=>{const i={fileViewerId:e,previewKey:t,sourceContext:o.UserActionContext.Sidebar};b(u.closeSidebar(i))},[b,e,t]),C=r.default.useCallback(e=>{S(e),I()},[S,I]);return E&&P?r.default.createElement("div",{style:{height:h},className:s.previewRightRailWrapper},y?r.default.createElement(n.RightRail.ExpandedWrapper,{withTitle:f,withCollapseButton:v.formatMessage({id:"BgMbCS",defaultMessage:"Close details pane"}),onCollapse:M,expandedBlade:P,className:s.rightRailContainer,onExpandBlade:S},r.default.createElement(n.RightRail.Content,null,Object.entries(w).map(([e,{rightRailUI:{Sidebar:i}}])=>r.default.createElement(i,Object.assign({},E,{key:`plugin-sidebar-${e}`}))))):r.default.createElement(n.RightRail.CollapsedWrapper,{onExpand:I,withExpandButton:v.formatMessage({id:"J5TC1D",defaultMessage:"Open details pane"}),className:s.rightRailContainer,onExpandBlade:C},A&&Object.entries(w).map(([e,{rightRailUI:{Control:t}}])=>r.default.createElement(t,Object.assign({},A,{isSelectedPlugin:e===P,onClick:i.NOOP,key:`plugin-control-${e}`}))))):null}),i.PreviewRightRail.displayName="PreviewRightRail",i.PreviewRightRail.displayName="PreviewRightRail"})),define("typescript/libraries/file-viewer/src/sidebar/download_button",["require","exports","tslib","react","dig-components/buttons","dig-components/tooltips","dig-components/icons","dig-components/icons/src","typescript/libraries/file-viewer/src/core/data/modes/types"],(function(e,i,t,r,n,a,o,s,l){"use strict";function c({onClick:e,title:i}){return r.createElement(a.Tooltip,{placement:"left",title:i},r.createElement(n.IconButton,{onClick:e,variant:"transparent",title:i},r.createElement(o.UIIcon,{src:s.DownloadLine})))}Object.defineProperty(i,"__esModule",{value:!0}),i.DownloadButton=i.DownloadIconButton=void 0,r=t.__importStar(r),i.DownloadIconButton=c,i.DownloadButton=({onClick:e,intl:i,fileViewerUiData:t})=>{const a=i.formatMessage({id:"Mran8D",defaultMessage:"Download"});return t.sidebar.visibility===l.SidebarVisibility.Closed?r.createElement(c,{onClick:e,title:a}):r.createElement(n.Button,{onClick:e,variant:"primary"},a)},i.DownloadButton.displayName="DownloadButton"})),define("typescript/libraries/file-viewer/src/sidebar/download_dropdown",["require","exports","tslib","react","dig-components/buttons","dig-components/menu","dig-components/tooltips","dig-components/icons","dig-components/icons/src","typescript/libraries/file-viewer/src/core/logging/constants","typescript/libraries/file-viewer/src/core/data/actions","typescript/libraries/file-viewer/src/core/data/utils"],(function(e,i,t,r,n,a,o,s,l,c,d,p){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.DownloadDropdown=i.normalize=void 0,r=t.__importStar(r);function u(e){return e?("/"!==e.charAt(0)&&(e=`/${e}`),"/"===e.charAt(e.length-1)?e.substr(0,e.length-1):e):""}i.normalize=u,i.DownloadDropdown=({dispatch:i,fileViewerId:v,fileId:w,previewKey:g,intl:m,canDownload:h,copyTargets:b,useTextButton:y,extractConfig:_,useOutlineButton:E})=>{var A,P;const S=()=>{i(d.downloadFile({previewKey:g,fileViewerId:v,sourceContext:c.UserActionContext.Sidebar}))},I=e=>()=>{i(d.copyToDropbox({previewKey:g,fileViewerId:v,sourceContext:c.UserActionContext.Sidebar,role:e}))},M=m.formatMessage({id:"Mran8D",defaultMessage:"Download"}),C=()=>t.__awaiter(void 0,void 0,void 0,(function*(){i(d.updateArchiveExtractAllSnackbarState({extractAllSnackbarState:p.makePendingLoadableData(),fileViewerId:v,previewKey:g}));const{unzipAction:r}=yield new Promise((i,t)=>{e(["api_v2/redux/flows"],i,t)}).then(t.__importStar);i(r({arg:{file:{identifier:{file_id:w,".tag":"file_id"}}}},{previewKey:g,fileViewerId:v}))})),O=_.canExtract&&h?(e=>{let i;switch(null==e?void 0:e[".tag"]){case"cdm_team":const t=(function(e,i){const t=(e=u(e)).split("/").pop();return t||(i||"Dropbox")})(e.home_path);i=t.length>12?m.formatMessage({id:"TAv+z6",defaultMessage:"Extract to my member folder"}):m.formatMessage({id:"53+pL4",defaultMessage:"Extract to {cdm_tmf_name} folder"},{cdm_tmf_name:t});break;case"not_on_cdm_team":default:i=m.formatMessage({id:"v021UF",defaultMessage:"Extract to my Dropbox"})}return{text:i,value:C,disabled:!1,key:"decompress"}})(_.rootInfo):void 0,T=[h?{text:M,value:S,disabled:!1,key:"download"}:void 0,...b.map(({text:e,isDisabled:i,role:t})=>({text:e,value:I(t),disabled:i,key:e})),O].filter(Boolean);if(1===T.length)return r.createElement(n.Button,{onClick:null===(A=T[0])||void 0===A?void 0:A.value,variant:"outline"},null===(P=T[0])||void 0===P?void 0:P.text);const x=T.map(e=>e?r.createElement(a.Menu.ActionItem,{id:"download-menu-item",key:e.key,value:e.value,disabled:e.disabled},e.text):null);return y?r.createElement(n.SplitButton,{variant:E?"outline":"primary",renderMenu:f(x),onClick:S},M):r.createElement(a.Menu.Wrapper,{key:"download-dropdown-menu",onSelection:e=>{e()}},({getContentProps:e,getTriggerProps:i,triggerRef:t})=>r.createElement(r.Fragment,null,r.createElement(o.Tooltip,{placement:"left",title:M,triggerRef:t},r.createElement(n.IconButton,Object.assign({},i(),{variant:"transparent",title:M}),r.createElement(s.UIIcon,{src:l.DownloadLine}))),r.createElement(a.Menu.Content,Object.assign({},e()),r.createElement(a.Menu.Segment,null,x))))},i.DownloadDropdown.displayName="DownloadDropdown";const f=e=>({buttonProps:i})=>r.createElement(a.Menu.Wrapper,{key:"download-dropdown-menu",onSelection:e=>{e()}},({getContentProps:t,getTriggerProps:o})=>r.createElement(r.Fragment,null,r.createElement(n.Button,Object.assign({},o(),i)),r.createElement(a.Menu.Content,Object.assign({},t()),r.createElement(a.Menu.Segment,null,e))));i.DownloadDropdown.displayName="DownloadDropdown"})),define("typescript/libraries/file-viewer/src/title_bar_v2/index",["require","exports","typescript/libraries/file-viewer/src/title_bar_v2/title_bar_v2"],(function(e,i,t){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.TitleBarV2=i.TITLE_BAR_BACK_AND_HELP_ICONS=i.TITLE_BAR_V2_HEIGHT=void 0,Object.defineProperty(i,"TITLE_BAR_V2_HEIGHT",{enumerable:!0,get:function(){return t.TITLE_BAR_V2_HEIGHT}}),Object.defineProperty(i,"TITLE_BAR_BACK_AND_HELP_ICONS",{enumerable:!0,get:function(){return t.TITLE_BAR_BACK_AND_HELP_ICONS}}),Object.defineProperty(i,"TitleBarV2",{enumerable:!0,get:function(){return t.TitleBarV2}})})),define("typescript/component_libraries/retrieval-components/src/simple-action-bar/index",["require","exports","typescript/component_libraries/retrieval-components/src/simple-action-bar/action_bar","typescript/component_libraries/retrieval-components/src/simple-action-bar/inline_action_bar","typescript/component_libraries/retrieval-components/src/simple-action-bar/inline_overflow_menu"],(function(e,i,t,r,n){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.InlineOverflowMenu=i.InlineActionBar=i.ActionBar=void 0,Object.defineProperty(i,"ActionBar",{enumerable:!0,get:function(){return t.ActionBar}}),Object.defineProperty(i,"InlineActionBar",{enumerable:!0,get:function(){return r.InlineActionBar}}),Object.defineProperty(i,"InlineOverflowMenu",{enumerable:!0,get:function(){return n.InlineOverflowMenu}})})),define("typescript/component_libraries/retrieval-components/src/simple-action-bar/action_bar",["require","exports","tslib","react","typescript/component_libraries/retrieval-components/src/simple-action-bar/action_bar_action","typescript/component_libraries/retrieval-components/src/simple-action-bar/action_bar_overflow_menu","typescript/component_libraries/retrieval-components/src/simple-action-bar/action_bar_types","typescript/component_libraries/retrieval-components/src/hooks/resize_observer","classnames"],(function(e,i,t,r,n,a,o,s,l){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.ActionBar=void 0,r=t.__importStar(r),l=t.__importDefault(l);const c={previousActions:{},offsetRight:[]};function d(e){return null!=e}i.ActionBar=function(e){const{actionHandler:i,actions:t,className:p,intl:u,handleOverflowMenuToggle:f,hideOverflowMenu:v,responsive:w,responsiveSize:g,accessibilityConfig:m,hideIcons:h,overflowMenuOpenRequest:b,overflowMenuCloseRequest:y,overflowMenuCoordinates:_,resolveOverflowMenuOpenRequest:E,overflowMenuTitle:A,expActionBarRedesignVariant:P,hideOverflowMenuHeader:S,canShowSelectionIndicatorInToolbar:I,createMenuOpenRequest:M,resolveCreateMenuOpenRequest:C}=e,O="OFF"!==P&&"CONTROL"!==P,T=w&&(g===o.ResponsiveSize.MOBILE||g===o.ResponsiveSize.TABLET),x=w&&g===o.ResponsiveSize.MOBILE,[D]=s.useResizeObserver();let F=void 0;D.current&&(F=I?D.current.offsetLeft+D.current.offsetWidth-48:D.current.offsetLeft+D.current.offsetWidth);const R=r.useRef(null),V=r.useRef(null),B=r.useRef(null),N=r.useRef(null),[k,L]=r.useState(c);r.useLayoutEffect(()=>{L({previousActions:t,offsetRight:[R,V,B,N].map(e=>e.current&&e.current.offsetLeft+e.current.offsetWidth).filter(d)})},[t]);const{alwaysAtTopLevel:j,atTopLevelIfSpace:U,alwaysInOverflow:K,hasActions:z}=r.useMemo(()=>{var e,i,r;return t.atTopLevelIfSpace&&!O&&(t.alwaysInOverflow=t.alwaysInOverflow?t.alwaysInOverflow:[[]],t.alwaysInOverflow[0]=t.atTopLevelIfSpace.concat(t.alwaysInOverflow[0])),{alwaysAtTopLevel:t.alwaysAtTopLevel,atTopLevelIfSpace:t.atTopLevelIfSpace,alwaysInOverflow:t.alwaysInOverflow,hasActions:(null===(e=t.alwaysAtTopLevel)||void 0===e?void 0:e.length)||(null===(i=t.atTopLevelIfSpace)||void 0===i?void 0:i.length)||(null===(r=t.alwaysInOverflow)||void 0===r?void 0:r.length)}},[t]),{previousActions:W,offsetRight:q}=k,H=w&&F&&t===W?q.filter(e=>e+43<F).length:4,$=l.default("rc-action-bar-container",p,{"rc-action-bar-container--responsive":w});if(!z)return r.createElement("div",{className:$});const G=[R,V,B,N],Y=!v&&(null==K?void 0:K.some(e=>e.length>0));return r.createElement("div",{ref:D,className:$,style:{width:e.fixedWidth}},!!(null==j?void 0:j.length)&&r.createElement(r.Fragment,null,j.map((e,t)=>r.createElement("div",{ref:G[t],key:`action-bar-action-${t}`},r.createElement(n.ActionBarAction,Object.assign({},e,{buttonVariant:0===t?"primary":"opacity",actionHandler:i,intl:u,accessibilityConfig:m,hideIcons:T||h,expActionBarRedesignEnabled:O,createMenuOpenRequest:M,resolveCreateMenuOpenRequest:C})))),(!!(null==U?void 0:U.length)||Y)&&r.createElement("div",{className:l.default("rc-action-bar-separator",{"rc-action-bar-separator-small":T})})),!!(null==U?void 0:U.length)&&(null==U?void 0:U.slice(0,H).map((e,t)=>r.createElement("div",{ref:G[t],key:`action-bar-action-${t}`},r.createElement(n.ActionBarAction,Object.assign({},e,{buttonVariant:"opacity",actionHandler:i,intl:u,accessibilityConfig:m,hideIcons:T||h,expActionBarRedesignEnabled:O,createMenuOpenRequest:M,resolveCreateMenuOpenRequest:C}))))),Y&&r.createElement(a.ActionBarOverflowMenu,{actions:{alwaysAtTopLevel:j,atTopLevelIfSpace:U,alwaysInOverflow:K},actionHandler:i,buttonVariant:O?"opacity":"transparent",overflowMenuTitle:A||"",expActionBarRedesignVariant:P||"OFF",intl:u,onToggle:f,accessibilityConfig:m,overflowMenuOpenRequest:b,overflowMenuCloseRequest:y,overflowMenuCoordinates:_,resolveOverflowMenuOpenRequest:E,isMobile:!!x,hideOverflowMenuHeader:S}))}})),define("typescript/component_libraries/retrieval-components/src/simple-action-bar/action_bar_action",["require","exports","tslib","react","typescript/component_libraries/retrieval-components/src/simple-action-bar/action_bar_action_button","typescript/component_libraries/retrieval-components/src/simple-action-bar/action_bar_action_menu","typescript/component_libraries/retrieval-components/src/simple-action-bar/action_bar_split_button","typescript/component_libraries/retrieval-components/src/simple-action-bar/action_bar_utils","typescript/component_libraries/retrieval-components/src/simple-action-bar/action_bar_types"],(function(e,i,t,r,n,a,o,s,l){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.ActionBarAction=void 0,r=t.__importStar(r);class c extends r.Component{constructor(){super(...arguments),this.handleMenuSelection=(e,i)=>{const t=s.createActionBarActionEventInfo(e,l.ActionBarActionEventSource.BUTTON_MENU,i);void 0!==t&&this.props.actionHandler.handleAction(t)},this.handleMenuToggle=({isOpen:e})=>{this.props.actionHandler.handleMenuToggle&&this.props.actionHandler.handleMenuToggle({type:this.props.actionType,isOpen:e})},this.handleActionClick=e=>{this.props.actionHandler.handleAction({type:this.props.actionType,event:e,source:l.ActionBarActionEventSource.BUTTON},!1)}}render(){const{menu:e,isEnabled:i,intl:t,variant:c,accessibilityConfig:d,icon:p,hideIcons:u,tooltip:f,disabledTooltip:v,menuMinWidth:w,actionType:g,className:m,dropdownButtonClassName:h,buttonVariant:b,expActionBarRedesignEnabled:y,createMenuOpenRequest:_,resolveCreateMenuOpenRequest:E}=this.props,A=this.props.labelOverride||t.formatMessage(this.props.text),P=s.getAccessibilityLabel(t,A,"primary"===c?null==d?void 0:d.primaryActionContext:null==d?void 0:d.secondaryActionsContext);if(this.props.renderButton)return this.props.renderButton(u||!1);if(this.props.button)return this.props.button;if((null==e?void 0:e.type)===l.ActionBarMenuType.DROPDOWN){const t=g===l.ActionBarActionTypes.CREATE;return r.createElement(a.ActionBarActionMenu,{disabled:!i,value:A,onSelection:this.handleMenuSelection,onToggle:this.handleMenuToggle,icon:u?void 0:p,variant:b,ariaLabel:P,tooltip:f,minWidth:w,actionType:g,className:m,dropdownButtonClassName:h,menuOpenRequest:t?_:void 0,resolveOpenRequest:t?E:void 0},r.createElement(a.ActionBarActionMenuContent,{menuSections:e.menuSections,expActionBarRedesignEnabled:y}))}return(null==e?void 0:e.type)===l.ActionBarMenuType.CUSTOM_DROPDOWN?r.createElement(a.ActionBarActionMenu,{disabled:!i,value:A,onSelection:this.handleMenuSelection,onToggle:this.handleMenuToggle,icon:u?void 0:p,variant:b,ariaLabel:P,tooltip:f,actionType:g,className:m,dropdownButtonClassName:h,expActionBarRedesignEnabled:y},e.menuContent):(null==e?void 0:e.type)===l.ActionBarMenuType.SPLIT_BUTTON?r.createElement(o.ActionBarSplitButton,{disabled:!i,onClick:this.handleActionClick,onSelection:this.handleMenuSelection,onToggle:this.handleMenuToggle,value:A,intl:t,icon:u?void 0:p,ariaLabel:P,menuSections:e.menuSections,className:m,expActionBarRedesignEnabled:y}):r.createElement(n.ActionBarActionButton,{disabled:!i,value:A,onClick:this.handleActionClick,icon:u?void 0:p,variant:b,ariaLabel:P,tooltip:f,disabledTooltip:v,className:m})}}i.ActionBarAction=c,c.displayName="ActionBarAction"})),define("typescript/component_libraries/retrieval-components/src/simple-action-bar/action_bar_action_button",["require","exports","tslib","react","dig-components/buttons","dig-components/tooltips","typescript/component_libraries/retrieval-components/src/simple-action-bar/action_bar_icon"],(function(e,i,t,r,n,a,o){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.ActionBarActionButton=void 0,r=t.__importStar(r),i.ActionBarActionButton=({variant:e,disabled:i,value:t,onClick:s,icon:l,ariaLabel:c,tooltip:d,disabledTooltip:p,className:u})=>{const f=r.createElement(n.Button,{variant:e,disabled:i,onClick:s,withIconLeft:l?r.createElement(o.ActionBarIcon,{icon:l}):void 0,"aria-label":c,className:u},t),[v,w]=r.useState(!1),[g,m]=r.useState("bottom"),h=r.createRef(),b=()=>{w(!0)},y=()=>{w(!1)},_=e=>m(e);return i&&p?r.createElement(r.Fragment,null,r.createElement("span",{tabIndex:0,onMouseEnter:b,onMouseLeave:y,onFocus:b,onBlur:y,"aria-describedby":v&&v?"tooltip-button":void 0},r.createElement(n.Button,{variant:e,disabled:!0,onClick:s,withIconLeft:l?r.createElement(o.ActionBarIcon,{icon:l}):void 0,"aria-label":c,ref:h,className:u},t)),r.createElement(a.Tooltip.Control,{id:"tooltip-button",triggerRef:h,open:v,auto:!0,placement:g,onChangePlacement:_},p)):d?r.createElement(a.Tooltip,{title:d,id:"tooltip-button"},f):f},i.ActionBarActionButton.displayName="ActionBarActionButton"})),define("typescript/component_libraries/retrieval-components/src/simple-action-bar/action_bar_action_menu",["require","exports","tslib","react","classnames","dig-components/buttons","dig-components/menu","dig-components/tooltips","typescript/component_libraries/retrieval-components/src/simple-action-bar/action_bar_icon","typescript/component_libraries/retrieval-components/src/simple-action-bar/action_bar_types"],(function(e,i,t,r,n,a,o,s,l,c){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.ActionBarActionMenuContentItem=i.ActionBarActionMenuContent=i.ActionBarActionMenu=void 0,r=t.__importStar(r),n=t.__importDefault(n),i.ActionBarActionMenu=({variant:e,disabled:i,value:t,onSelection:n,onToggle:c,icon:p,children:u,ariaLabel:f,tooltip:v,minWidth:w,className:g,dropdownButtonClassName:m,expActionBarRedesignEnabled:h,menuOpenRequest:b,resolveOpenRequest:y})=>{const _=void 0!==w?{minWidth:w}:{};return r.createElement(o.Menu.Wrapper,{onSelection:n,onToggle:c,className:g},({getTriggerProps:n,getContentProps:c,triggerRef:w,openMenu:g})=>{const E=r.createElement(a.Button,Object.assign({className:m,variant:e,withDropdownIcon:!0,disabled:i,withIconLeft:p?r.createElement(l.ActionBarIcon,{icon:p}):void 0,"aria-label":f},n()),t);return r.createElement(d,{openMenu:g,menuOpenRequest:b,resolveOpenRequest:y},r.createElement(r.Fragment,null,v?r.createElement(s.Tooltip,{title:v,triggerRef:w,id:"tooltip-button"},E):E,r.createElement(o.Menu.Content,Object.assign({},c(),{style:_,className:h?"rc-action-bar-submenu-content":""}),u)))})},i.ActionBarActionMenu.displayName="ActionBarActionMenu";const d=({openMenu:e,menuOpenRequest:i,resolveOpenRequest:t,children:n})=>(r.useEffect(()=>{i&&(e(i),t&&t())},[i,t]),n);i.ActionBarActionMenuContent=({menuSections:e,expActionBarRedesignEnabled:t})=>r.createElement(r.Fragment,null,e.map((e,n)=>r.createElement(o.Menu.Segment,{key:`${n}-section`,withLabel:e.label},e.menuItems.map((e,a)=>r.createElement(i.ActionBarActionMenuContentItem,{menuItem:e,key:c.isActionBarActionMenuSubmenu(e)?`${n}-${a}-submenu`:`${n}-${a}-action-item`,expActionBarRedesignEnabled:t}))))),i.ActionBarActionMenuContent.displayName="ActionBarActionMenuContent",i.ActionBarActionMenuContentItem=({menuItem:e,key:t,expActionBarRedesignEnabled:a,highlightedTextElement:d})=>{const p=!1===e.isEnabled;if(c.isActionBarActionMenuSubmenu(e))return r.createElement(o.Menu.Submenu,{key:t,withTriggerContent:d||e.description,withLeftAccessory:e.icon&&r.createElement(l.ActionBarIcon,{icon:e.icon}),contentClassName:a?"rc-action-bar-submenu-content":"",disabled:p},r.createElement(i.ActionBarActionMenuContent,{menuSections:e.submenuSections,expActionBarRedesignEnabled:a}));if(c.isActionBarCustomMenuAction(e))return e.menuItem;const u={nodeType:"dropdown",actionType:e.value.type,menuItem:e.value};return p&&e.disabledTooltip?r.createElement(s.Tooltip,{title:e.disabledTooltip,placement:"left",id:"tooltip-item"},r.createElement(o.Menu.ActionItem,{key:t,className:n.default(e.className,{"visuallyDisabled-see-DSYS-1278":p}),value:"NOOP_SEE_DSYS-1278",disabled:!1,withLeftAccessory:e.icon&&r.createElement(l.ActionBarIcon,{icon:e.icon})},e.description)):r.createElement(o.Menu.ActionItem,{key:t,className:e.className,value:u,disabled:p,withLeftAccessory:e.icon&&r.createElement(l.ActionBarIcon,{icon:e.icon})},d||e.description)},i.ActionBarActionMenuContentItem.displayName="ActionBarActionMenuContentItem"})),define("typescript/component_libraries/retrieval-components/src/simple-action-bar/action_bar_overflow_menu",["require","exports","tslib","react","classnames","dig-components/buttons","dig-components/icons/src","dig-components/menu","dig-components/tooltips","dig-components/typography","dig-components/truncate","typescript/component_libraries/retrieval-components/src/simple-action-bar/action_bar_action_menu","typescript/component_libraries/retrieval-components/src/simple-action-bar/action_bar_icon","typescript/component_libraries/retrieval-components/src/simple-action-bar/action_bar_utils","typescript/component_libraries/retrieval-components/src/simple-action-bar/action_bar_types"],(function(e,i,t,r,n,a,o,s,l,c,d,p,u,f,v){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.ActionBarOverflowMenuItem=i.ActionBarOverflowMenu=void 0,r=t.__importStar(r),n=t.__importDefault(n),i.ActionBarOverflowMenu=e=>{const{actions:t,buttonVariant:p,intl:g,onToggle:m,showTooltip:h,accessibilityConfig:b,size:y,overflowMenuOpenRequest:_,overflowMenuCloseRequest:E,resolveOverflowMenuOpenRequest:A,resolveOverflowMenuCloseRequest:P,inverse:S,overflowMenuTitle:I,expActionBarRedesignVariant:M,isMobile:C,overflowMenuCoordinates:O,hideOverflowMenuHeader:T}=e,x=r.useRef(new class{constructor(){this.position=[0,0]}getBoundingClientRect(){return{height:0,width:0,top:this.position[1],right:this.position[0],bottom:this.position[1],left:this.position[0]}}}),D=e=>{e.stopPropagation()},F=e.intl.formatMessage(f.MORE_MENU_STRING),R=f.getAccessibilityLabel(g,F,null==b?void 0:b.secondaryActionsContext);return r.createElement(s.Menu.Wrapper,{onSelection:(i,t)=>{const r=f.createActionBarActionEventInfo(i,v.ActionBarActionEventSource.OVERFLOW_MENU,t),n=void 0!==O;void 0!==r?e.actionHandler.handleAction(r,n):(null==i?void 0:i.handler)&&i.handler()},onToggle:e=>{null==m||m(e)},closeOnBlurWhenDefaultPrevented:!1,slideSubmenu:!!C,shouldPropagateClickOutsideMouseEvents:!!O,onContextMenu:e=>{e.preventDefault(),e.stopPropagation()}},({getTriggerProps:v,getContentProps:m,triggerRef:b,openMenu:C,closeMenu:F})=>{var V;const B=r.createElement(a.IconButton,Object.assign({variant:p},v(),{"aria-label":R,"data-testid":"action-bar-overflow",size:y,inverse:S}),r.createElement(u.ActionBarIcon,{icon:o.MoreHorizontalLine})),N="OFF"!==M&&"CONTROL"!==M;return r.createElement(w,{openMenu:C,overflowMenuOpenRequest:_,resolveOverflowMenuOpenRequest:A,resolveOverflowMenuCloseRequest:P,overflowMenuCloseRequest:E,closeMenu:F,overflowMenuCoordinates:O,virtualTriggerRef:x},r.createElement(r.Fragment,null,h?r.createElement(l.Tooltip,{title:g.formatMessage(f.MORE_TOOLTIP_STRING),triggerRef:b},B):B,r.createElement(s.Menu.Content,Object.assign({},m(),{triggerRef:O?x:b,className:N?"rc-action-bar-overflow-menu-content":"",onClick:D}),r.createElement("div",{className:N?"rc-action-bar-overflow-menu-container":""},N&&!T&&r.createElement(s.Menu.Segment,{className:"rc-action-bar-overflow-menu-header"},r.createElement(s.Menu.Row,{interactive:!1},r.createElement(s.Menu.RowTitle,null,r.createElement(c.Text,{isBold:!0},r.createElement(d.Truncate,{location:.5,tooltipControlProps:{placement:"top",openDelay:500}},I))))),r.createElement(s.Menu.Segment,{className:n.default("rc-action-bar-overflow-menu-bottom-container",{"rc-action-bar-overflow-menu-bottom-container--redesign":N})},null===(V=t.alwaysInOverflow)||void 0===V?void 0:V.map((t,n)=>!!t.length&&r.createElement(s.Menu.Segment,{key:n,className:"rc-action-bar-overflow-menu-segment"},t.map((t,n)=>r.createElement(i.ActionBarOverflowMenuItem,{key:`action-bar-overflow-menu-item-${n}`,action:t,intl:g,actionHandler:e.actionHandler,closeMenu:F,expActionBarRedesignEnabled:N,isRightClickMenu:!!O,logEsignShown:e.logEsignShown})))))))))})},i.ActionBarOverflowMenu.displayName="ActionBarOverflowMenu";const w=({openMenu:e,closeMenu:i,overflowMenuOpenRequest:t,resolveOverflowMenuOpenRequest:n,children:a,overflowMenuCloseRequest:o,resolveOverflowMenuCloseRequest:s,overflowMenuCoordinates:l,virtualTriggerRef:c})=>(r.useEffect(()=>{t&&(e(t),n&&n())},[t,n]),r.useEffect(()=>{o&&(i(o),s&&s())},[o,s]),r.useLayoutEffect(()=>{if(l&&c){const[e,i]=l;c.current.position=[e,i]}},[l]),a);i.ActionBarOverflowMenuItem=({action:e,intl:i,actionHandler:t,closeMenu:n,expActionBarRedesignEnabled:a,highlightedTextElement:o,isRightClickMenu:c,logEsignShown:d})=>{var f;const w=!e.isEnabled,g=o||e.labelOverride||i.formatMessage(e.text),m=r.useRef(null),h=e=>{t.handleAction({type:v.ActionBarActionTypes.SHARE_COPY_LINK,event:e,source:v.ActionBarActionEventSource.OVERFLOW_MENU,anchorRef:m,onActionFlowComplete:()=>n({})},c)};if(r.useEffect(()=>{59===e.actionType&&(null==d||d())},[]),e.overflowItem)return e.overflowItem;switch(null===(f=e.menu)||void 0===f?void 0:f.type){case v.ActionBarMenuType.DROPDOWN:case v.ActionBarMenuType.SPLIT_BUTTON:return r.createElement(s.Menu.Submenu,{disabled:w,withTriggerContent:g,withLeftAccessory:r.createElement(u.ActionBarIcon,{icon:e.icon}),contentClassName:a?"rc-action-bar-submenu-content":""},r.createElement(p.ActionBarActionMenuContent,{menuSections:e.menu.menuSections,expActionBarRedesignEnabled:a}));case v.ActionBarMenuType.CUSTOM_DROPDOWN:return r.createElement(s.Menu.Submenu,{disabled:w,withTriggerContent:g,withLeftAccessory:r.createElement(u.ActionBarIcon,{icon:e.icon}),contentClassName:a?"rc-action-bar-submenu-content":""},e.menu.menuContent);default:const i={nodeType:"action",actionType:e.actionType},t={key:e.actionType,value:i,withLeftAccessory:r.createElement(u.ActionBarIcon,{icon:e.icon}),disabled:w},n={interactive:!0,disabled:w,ref:m,withLeftAccessory:r.createElement(u.ActionBarIcon,{icon:e.icon}),onClick:h},o=r.createElement(s.Menu.ActionItem,Object.assign({},t),g),c=r.createElement(s.Menu.Row,Object.assign({},n),g);return e.disabledTooltip&&w?r.createElement(l.Tooltip,{title:e.disabledTooltip,placement:"left",id:"tooltip-item"},r.createElement(s.Menu.ActionItem,Object.assign({},t,{value:"NOOP_SEE_DSYS-1278",disabled:!1,className:w?"visuallyDisabled-see-DSYS-1278":""}),g)):e.actionType===v.ActionBarActionTypes.SHARE_COPY_LINK?c:e.tooltip?r.createElement(l.Tooltip,{title:e.tooltip,placement:"left",id:"tooltip-item"},o):o}},i.ActionBarOverflowMenuItem.displayName="ActionBarOverflowMenuItem"})),define("typescript/component_libraries/retrieval-components/src/simple-action-bar/action_bar_utils",["require","exports","react-intl"],(function(e,i,t){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.createActionBarActionEventInfo=i.getAccessibilityLabel=i.ACTION_ARIAL_LABEL=i.MORE_TOOLTIP_STRING=i.MORE_MENU_STRING=void 0,i.MORE_MENU_STRING=t.defineMessage({id:"3kB3s4",defaultMessage:"More menu"}),i.MORE_TOOLTIP_STRING=t.defineMessage({id:"06UTVR",defaultMessage:"More"}),i.ACTION_ARIAL_LABEL=t.defineMessage({id:"XyseuH",defaultMessage:"{action}, applies to {noOfFiles, plural, one{{fileName}} other{{noOfFiles} selected files}}"}),i.getAccessibilityLabel=function(e,t,r){return r?e.formatMessage(i.ACTION_ARIAL_LABEL,{action:t,noOfFiles:r.noOfEntries,fileName:r.firstEntryAccessibilityHint}):t},i.createActionBarActionEventInfo=(e,i,t)=>{try{switch((e=e).nodeType){case"action":return{type:e.actionType,event:t,source:i};case"dropdown":return{type:e.actionType,menuItem:e.menuItem,event:t,source:i};default:return}}catch(e){return}}})),define("typescript/component_libraries/retrieval-components/src/simple-action-bar/action_bar_split_button",["require","exports","tslib","react","dig-components/buttons","dig-components/menu","typescript/component_libraries/retrieval-components/src/simple-action-bar/action_bar_action_menu","typescript/component_libraries/retrieval-components/src/simple-action-bar/action_bar_icon"],(function(e,i,t,r,n,a,o,s){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.ActionBarSplitButton=void 0,r=t.__importStar(r),i.ActionBarSplitButton=({disabled:e,value:i,intl:t,onClick:l,onSelection:c,onToggle:d,icon:p,ariaLabel:u,menuSections:f,className:v,expActionBarRedesignEnabled:w})=>{const g=r.useMemo(()=>({withIconLeft:p?r.createElement(s.ActionBarIcon,{icon:p}):void 0}),[p]);return r.createElement(n.SplitButton,Object.assign({variant:"opacity",disabled:e,renderMenu:({buttonProps:e})=>r.createElement(a.Menu.Wrapper,{onSelection:c,onToggle:d,className:v},({getTriggerProps:s,getContentProps:l})=>r.createElement(r.Fragment,null,r.createElement(n.Button,Object.assign({"aria-label":t.formatMessage({id:"y4xCgb",defaultMessage:"Expand menu for {action}"},{action:i})},e,s())),r.createElement(a.Menu.Content,Object.assign({},l(),{placement:"bottom-end"}),r.createElement(o.ActionBarActionMenuContent,{menuSections:f,expActionBarRedesignEnabled:w})))),onClick:l,className:"rc-action-bar-split-button","aria-label":u},g),i)},i.ActionBarSplitButton.displayName="ActionBarSplitButton"})),define("typescript/component_libraries/retrieval-components/src/simple-action-bar/action_bar_icon",["require","exports","tslib","react","dig-components/icons"],(function(e,i,t,r,n){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.ActionBarIcon=void 0,r=t.__importStar(r),i.ActionBarIcon=({icon:e})=>r.isValidElement(e)?e:r.createElement(n.UIIcon,{src:e}),i.ActionBarIcon.displayName="ActionBarIcon"})),define("typescript/component_libraries/retrieval-components/src/simple-action-bar/inline_action_bar",["require","exports","tslib","classnames","react","dig-components/buttons","dig-components/tooltips","typescript/component_libraries/retrieval-components/src/simple-action-bar/action_bar_icon","typescript/component_libraries/retrieval-components/src/simple-action-bar/action_bar_overflow_menu","typescript/component_libraries/retrieval-components/src/simple-action-bar/action_bar_types","typescript/component_libraries/retrieval-components/src/highlighted-truncated-string/em-string"],(function(e,i,t,r,n,a,o,s,l,c,d){"use strict";function p({action:e,actionHandler:i,intl:t,useCopyLinkTextVariant:r}){function l(t){i.handleAction({type:e.actionType,event:t,source:c.ActionBarActionEventSource.BUTTON,anchorRef:p})}const d=t.formatMessage(e.text),p=n.useRef(null);return r&&e.actionType===c.ActionBarActionTypes.SHARE_COPY_LINK?n.createElement(o.Tooltip,{title:e.tooltip,triggerRef:p},n.createElement(a.Button,{variant:"opacity",onClick:l,disabled:!e.isEnabled},d)):n.createElement(o.Tooltip,{title:d,triggerRef:p},n.createElement(a.IconButton,{"aria-label":d,variant:"transparent",onClick:l,disabled:!e.isEnabled},n.createElement(s.ActionBarIcon,{icon:e.icon})))}Object.defineProperty(i,"__esModule",{value:!0}),i.InlineActionBar=void 0,r=t.__importDefault(r),n=t.__importStar(n),i.InlineActionBar=function(e){const{actionHandler:i,actions:t,className:a,handleOverflowMenuToggle:o,highlighted:s,intl:u,overflowMenuTitle:f,expActionBarRedesignVariant:v,isMobile:w,overflowMenuOpenRequest:g,overflowMenuCloseRequest:m,overflowMenuCoordinates:h,resolveOverflowMenuOpenRequest:b,hideOverflowMenuHeader:y,logEsignShown:_,useCopyLinkTextVariant:E,resetOverflowMenuCoordinates:A}=e,{atTopLevelIfSpace:P,alwaysInOverflow:S}=n.useMemo(()=>{var e;return{atTopLevelIfSpace:(null===(e=t.alwaysAtTopLevel)||void 0===e?void 0:e.filter(e=>e.actionType===c.ActionBarActionTypes.SHARE_MODAL||e.actionType===c.ActionBarActionTypes.SHARE_COPY_LINK||e.actionType===c.ActionBarActionTypes.MANAGE_FOLDER_RULES||e.actionType===c.ActionBarActionTypes.STAR||e.actionType===c.ActionBarActionTypes.UNSTAR))||[],alwaysInOverflow:t.alwaysInOverflow||[]}},[t]);let I=-(24+40*(P.length+1));const M=E&&P.filter(e=>e.actionType===c.ActionBarActionTypes.SHARE_COPY_LINK)[0];if(M){const e=u.formatMessage(M.text);I-=12*new d.Emstring(e).length}return n.createElement("div",{className:r.default("rc-inline-action-bar-container",a,{"rc-inline-action-bar-container--highlighted":s}),style:{marginLeft:`${I}px`},onClick:()=>{h&&A&&A()}},!!P.length&&P.map((e,t)=>n.createElement(p,{key:`inline-action-bar-button-${t}`,action:e,actionHandler:i,intl:u,useCopyLinkTextVariant:E})),(null==S?void 0:S.some(e=>e.length>0))&&n.createElement(l.ActionBarOverflowMenu,{actions:{atTopLevelIfSpace:P,alwaysInOverflow:S},actionHandler:i,buttonVariant:"transparent",intl:u,onToggle:o,showTooltip:!0,overflowMenuTitle:f,expActionBarRedesignVariant:v,isMobile:w,overflowMenuOpenRequest:g,overflowMenuCloseRequest:m,overflowMenuCoordinates:h,resolveOverflowMenuOpenRequest:b,hideOverflowMenuHeader:y,logEsignShown:_}))}})),define("typescript/component_libraries/retrieval-components/src/simple-action-bar/inline_overflow_menu",["require","exports","tslib","react","typescript/component_libraries/retrieval-components/src/simple-action-bar/action_bar_overflow_menu"],(function(e,i,t,r,n){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.InlineOverflowMenu=void 0,r=t.__importStar(r),i.InlineOverflowMenu=function(e){const{actionHandler:i,actions:t,handleOverflowMenuToggle:a,intl:o,className:s,size:l,inverse:c,overflowMenuTitle:d,expActionBarRedesignVariant:p,isMobile:u,hideOverflowMenuHeader:f}=e,{alwaysAtTopLevel:v,atTopLevelIfSpace:w,alwaysInOverflow:g}=r.useMemo(()=>({alwaysAtTopLevel:t.alwaysAtTopLevel,atTopLevelIfSpace:t.atTopLevelIfSpace,alwaysInOverflow:t.alwaysInOverflow}),[t]);return r.createElement("div",{className:s},!!(null==g?void 0:g.length)&&r.createElement(n.ActionBarOverflowMenu,{actions:{alwaysAtTopLevel:v,atTopLevelIfSpace:w,alwaysInOverflow:g},actionHandler:i,buttonVariant:"transparent",intl:o,onToggle:a,showTooltip:!0,size:l,inverse:c,overflowMenuTitle:d,expActionBarRedesignVariant:p,isMobile:u,hideOverflowMenuHeader:f}))}})),define("typescript/component_libraries/retrieval-components/src/hooks/resize_observer",["require","exports","tslib","react","resize-observer-polyfill"],(function(e,i,t,r,n){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.useResizeObserver=void 0,n=t.__importDefault(n),i.useResizeObserver=function(){const e=r.useRef(null),i=r.useRef(),[t,a]=r.useState(),o=r.useCallback(()=>{i.current=new n.default(([e])=>a(e)),(null==e?void 0:e.current)&&i.current.observe(e.current)},[e.current]);return r.useLayoutEffect(()=>(o(),()=>{var e;return null===(e=i.current)||void 0===e?void 0:e.disconnect()}),[o]),[e,t]}})),define("modules/clean/logging/hive/schemas/web-file_previews",["require","exports"],(function(e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.WebFilePreviewsLoggingRow=void 0;i.WebFilePreviewsLoggingRow=class{constructor(e){this.category="web-file_previews",this.active_user_id=null,this.anon_ip=null,this.authed_user_ids=null,this.identity_gid=null,this.locale_browser_header=null,this.locale_user_selected=null,this.referrer=null,this.session_id=null,this.team_id=null,this.team_type=null,this.ua_browser_name=null,this.ua_browser_version=null,this.ua_dist_name=null,this.ua_dist_version=null,this.ua_os_name=null,this.ua_os_version=null,this.user_agent=null,this.user_id=null,this.device_type=e.device_type,this.event_name=e.event_name,this.extra=e.extra,this.file_extension=e.file_extension,this.file_last_edit_ts=e.file_last_edit_ts,this.file_obj_id=e.file_obj_id,this.file_preview_session_id=e.file_preview_session_id,this.file_preview_size=e.file_preview_size,this.file_sf_status=e.file_sf_status,this.file_size=e.file_size,this.file_viewer_session_id=e.file_viewer_session_id,this.is_starred=e.is_starred,this.ns_id=e.ns_id,this.sj_id=e.sj_id,this.x_dropbox_path=e.x_dropbox_path,this.timestamp=Date.now()/1e3|0,Object.seal(this)}}}));var __createBinding=this&&this.__createBinding||(Object.create?function(e,i,t,r){void 0===r&&(r=t),Object.defineProperty(e,r,{enumerable:!0,get:function(){return i[t]}})}:function(e,i,t,r){void 0===r&&(r=t),e[r]=i[t]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(e,i){Object.defineProperty(e,"default",{enumerable:!0,value:i})}:function(e,i){e.default=i}),__importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var i={};if(null!=e)for(var t in e)"default"!==t&&Object.prototype.hasOwnProperty.call(e,t)&&__createBinding(i,e,t);return __setModuleDefault(i,e),i};define("modules/clean/react/async_fileops_modals",["require","exports"],(function(e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.showNamingConventionsModal=i.showTidyUpDialog=i.showMoveDialog=i.showAdminUpload=void 0,i.showAdminUpload=function(i){var t;t=({showAdminUpload:e})=>e(i),new Promise((i,t)=>{e(["modules/clean/react/fileops_modals"],i,t)}).then(__importStar).then(t)},i.showMoveDialog=function(i){new Promise((i,t)=>{e(["modules/clean/react/folder_dialog/move_dialog_modal"],i,t)}).then(__importStar).then(({MoveDialogModal:e})=>e.show(i))},i.showTidyUpDialog=function(i){new Promise((i,t)=>{e(["modules/clean/react/tidy_up/modal/tidy_up_modal"],i,t)}).then(__importStar).then(({showTidyUpModal:e})=>e(i))},i.showNamingConventionsModal=function(i){new Promise((i,t)=>{e(["modules/clean/react/naming_conventions/naming_conventions_modal"],i,t)}).then(__importStar).then(({showNamingConventionsModal:e})=>e(i))}}));
//# sourceMappingURL=pkg-fvsdk-common.min.js-vflkg7uLq.map