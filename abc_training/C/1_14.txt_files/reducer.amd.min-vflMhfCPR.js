define(["require","exports","typescript/libraries/file-viewer/src/pass/actions","api_v2/redux/seen_state","api_v2/redux/sharing","typescript/libraries/file-viewer/src/core/data/actions","typescript/libraries/file-viewer/src/pass/types"],(function(e,i,s,t,r,a,n){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.reducers=i.DEFAULT_STATE=i.DEFAULT_VIEWING_USER_IDS=i.DEFAULT_FILE_MEMBERS=i.DEFAULT_FILE_MEMBER_COUNTS=i.DEFAULT_SEEN_STATES=void 0,i.DEFAULT_SEEN_STATES={order:[],infos:{}},i.DEFAULT_FILE_MEMBER_COUNTS={count:0,exceeds_limit:!1},i.DEFAULT_FILE_MEMBERS={order:[],users:{},invitees:{}},i.DEFAULT_VIEWING_USER_IDS=[],i.DEFAULT_STATE={seenState:{},fileMemberCounts:{},fileMembers:{},viewingUserIds:{}};function l(e){return!!e.user||"email"===e.invitee[".tag"]}i.reducers={seenState:(e=i.DEFAULT_STATE.seenState,s)=>s.type!==a.Action.InitializeFilePreview||e[s.payload.fileInfo.file_id]?s.type===t.Action.GetSeenStateInfoResult&&s.payload.result?Object.assign(Object.assign({},e),s.payload.result.reduce((e,i)=>{const{seen_states:s}=i.seen_state_info;return e[i.file_info.file_identifier||""]={order:s.map(e=>e.seen_state_user.user_id),infos:s.reduce((e,i)=>(e[i.seen_state_user.user_id]=i,e),{})},e},{})):e:Object.assign(Object.assign({},e),{[s.payload.fileInfo.file_id]:i.DEFAULT_SEEN_STATES}),fileMemberCounts:(e=i.DEFAULT_STATE.fileMemberCounts,s)=>{if(s.type===a.Action.InitializeFilePreview&&!e[s.payload.fileInfo.file_id])return Object.assign(Object.assign({},e),{[s.payload.fileInfo.file_id]:i.DEFAULT_FILE_MEMBER_COUNTS});if(s.type===r.Action.GetFileMemberCountsResult&&s.payload.result){const i=s.payload.arg.file;return Object.assign(Object.assign({},e),{[i]:s.payload.result})}return e},fileMembers:(e=i.DEFAULT_STATE.fileMembers,s)=>{if(s.type===a.Action.InitializeFilePreview&&!e[s.payload.fileInfo.file_id])return Object.assign(Object.assign({},e),{[s.payload.fileInfo.file_id]:i.DEFAULT_FILE_MEMBERS});if(s.type===r.Action.ListFileMembersResult&&s.payload.result){const i=s.payload.arg.file,{users:t,invitees:r}=s.payload.result,a=r.filter(l),n={order:[...t.map(e=>e.user.account_id),...a.map(e=>e.user?e.user.account_id:e.invitee.email)],users:t.reduce((e,i)=>(e[i.user.account_id]=i,e),{}),invitees:a.reduce((e,i)=>(e[i.user?i.user.account_id:i.invitee.email]=i,e),{})};return Object.assign(Object.assign({},e),{[i]:n})}return e},viewingUserIds:(e=i.DEFAULT_STATE.viewingUserIds,t)=>t.type!==a.Action.InitializeFilePreview||e[t.payload.fileInfo.file_id]?t.type===s.Action.UpdateViewingUsers?Object.assign(Object.assign({},e),Object.keys(t.payload).reduce((e,i)=>(e[i]=t.payload[i].filter(e=>e.info.status!==n.PresenceStatus.offline).map(e=>e.agent.userId),e),{})):t.type===s.Action.UpdateViewingUsersWithDelta?Object.assign(Object.assign({},e),Object.keys(t.payload).reduce((i,s)=>{const r=e[s]||[];for(const e of t.payload[s])e.info.status===n.PresenceStatus.offline?i[s]=r.filter(i=>i!==e.agent.userId):r.includes(e.agent.userId)||(i[s]=[...r,e.agent.userId]);return i},{})):e:Object.assign(Object.assign({},e),{[t.payload.fileInfo.file_id]:i.DEFAULT_VIEWING_USER_IDS})}}));
//# sourceMappingURL=reducer.amd.min.js-vflanv9Rd.map