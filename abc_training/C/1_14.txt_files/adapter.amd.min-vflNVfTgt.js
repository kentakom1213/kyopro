define(["require","exports","lodash","typescript/component_libraries/files_components/src/blades/comments/data/uuid","typescript/component_libraries/files_components/src/blades/comments/data/actions","typescript/libraries/comments2/src/mentions/index","api_v2/redux/comments2","typescript/component_libraries/files_components/src/blades/comments/data/transform","typescript/libraries/comments2/src/components/utils/thread_utils","typescript/libraries/comments2/src/transforms/index","typescript/component_libraries/flows/src/components/approval-forms/index"],(function(e,o,r,t,n,a,i,d,l,s,m){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.READ_ONLY_SETTINGS=o.ENABLED_SETTINGS=o.getCommentsActionsAdapter=void 0,o.getCommentsActionsAdapter=function({dispatch:e,getAccount:o,getFileId:c,getSharedLinkInfo:u,getCommentsBladeId:v,onEditorFocused:h,showAuthModal:p,approvalIOClient:A,onClickAnnotation:f}){const C=(r,t)=>{var a;const i=o();if(i){const o=(null===(a=u())||void 0===a?void 0:a.url)||c();e(n.addAndCommitComment(d.accountToCommentStreamUser(i),o,r,t)),e(m.setApprovalForm({[o]:{}}))}else{if(!p)throw new Error("showAuthModal or stream is not defined");p()}};return{onThreadCreated(r,n){var a;const l=o();if(l)e(i.addCommentAction({arg:{stream:d.createStreamFromFileOrSharedLink(c(),null===(a=u())||void 0===a?void 0:a.url),comment:s.iCommentContentToUserSubmittedComment({content:r,annotation:n}),source:{".tag":"editor"}}},{tempThreadId:t.v4(),content:r,annotation:n,author:d.accountToCommentStreamUser(l),fileViewerId:v()}));else{if(!p)throw new Error("showAuthModal or stream is not defined");p()}},onThreadActivated(o){var r;e(n.activateThread({fileId:c(),sharedLinkURL:null===(r=u())||void 0===r?void 0:r.url,fileViewerId:v(),threadId:o.id,isThirdParty:o.isThirdParty}))},onAllThreadsDeactivated(){e(n.deactivateAllThreads({fileViewerId:v()})),e(n.focusThread(v(),null))},onThreadMouseEnter(o){e(n.hoverThread(v(),o))},onThreadMouseLeave(){e(n.hoverThread(v(),null))},onThreadFocus(o){e(n.focusThread(v(),o))},onThreadBlur(){e(n.focusThread(v(),null))},onThreadRepliedTo(r,t){var n;const a=o();if(a)e(i.addCommentAction({arg:{stream:d.createStreamFromFileOrSharedLink(c(),null===(n=u())||void 0===n?void 0:n.url),thread_id:r,comment:s.iCommentContentToUserSubmittedComment({content:t})}},{content:t,author:d.accountToCommentStreamUser(a),fileViewerId:v()}));else{if(!p)throw new Error("showAuthModal or stream is not defined");p()}},onThreadMarkedAsRead(o){var r;e(i.markThreadReadAction({arg:{id:o,stream:d.createStreamFromFileOrSharedLink(c(),null===(r=u())||void 0===r?void 0:r.url)}}))},onThreadMarkedAsUnread(o){var r;e(i.markThreadUnreadAction({arg:{id:o,stream:d.createStreamFromFileOrSharedLink(c(),null===(r=u())||void 0===r?void 0:r.url)}}))},onThreadResolved(r){var t;if(o())e(i.resolveThreadAction({arg:{id:r,stream:d.createStreamFromFileOrSharedLink(c(),null===(t=u())||void 0===t?void 0:t.url)}}));else{if(!p)throw new Error("showAuthModal or stream is not defined");p()}},onThreadUnresolved(r){var t;if(o())e(i.unresolveThreadAction({arg:{id:r,stream:d.createStreamFromFileOrSharedLink(c(),null===(t=u())||void 0===t?void 0:t.url)}}));else{if(!p)throw new Error("showAuthModal or stream is not defined");p()}},onCommentEdited(o,r,t){var n;e(i.editCommentAction({arg:{id:o,stream:d.createStreamFromFileOrSharedLink(c(),null===(n=u())||void 0===n?void 0:n.url),comment:s.iCommentContentToUserSubmittedComment({content:r})}},{threadId:t,content:r}))},onEnableComments(){var o;e(i.enableCommentingAction({arg:{stream:d.createStreamFromFileOrSharedLink(c(),null===(o=u())||void 0===o?void 0:o.url)}}))},onDisableComments(){var o;e(i.disableCommentingAction({arg:{stream:d.createStreamFromFileOrSharedLink(c(),null===(o=u())||void 0===o?void 0:o.url)}}))},onCommentDeleted(o,r){var t;e(i.deleteCommentAction({arg:{id:o,stream:d.createStreamFromFileOrSharedLink(c(),null===(t=u())||void 0===t?void 0:t.url)}},{threadId:r}))},onMentionsQueryUpdated(o){e(a.searchContacts(o))},onCommentDraftCancel(){e(n.cancelAnnotating(v()))},onEditorFocused(){e(n.editorDidFocus(v())),null==h||h()},onClickAnnotation(e){null==f||f(e)},onSubscribe(){var o;e(i.subscribeAction({arg:{stream:d.createStreamFromFileOrSharedLink(c(),null===(o=u())||void 0===o?void 0:o.url)}}))},onUnsubscribe(){var o;e(i.unsubscribeAction({arg:{stream:d.createStreamFromFileOrSharedLink(c(),null===(o=u())||void 0===o?void 0:o.url)}}))},onClickOlderInfo:r.noop,onEditorStateChange:r.noop,onApproverRespond(o){var r;const t=(null===(r=u())||void 0===r?void 0:r.url)||c();null==A||A.getLogger().logRespondClick(c(),o),e(m.setApprovalForm({[t]:{activeForm:"respond",threadId:o}}))},onEditApproval(o,r){var t;const n=(null===(t=u())||void 0===t?void 0:t.url)||c();"approver"==r.approvalMetadata.actor?(null==A||A.getLogger().logEditApprovalResponseClick(c(),o,r.commentId),e(m.setApprovalForm({[n]:{activeForm:"response_edit",threadId:o,editArgs:r}}))):"requester"==r.approvalMetadata.actor&&(null==A||A.getLogger().logEditApprovalRequestClick(c(),o,r.commentId),e(m.setApprovalForm({[n]:{activeForm:"request_edit",threadId:o,editArgs:r}})))},onDeleteApprovalComment(r,t,a){var i;if(!A)return;const l=o();if(l){const o=(null===(i=u())||void 0===i?void 0:i.url)||c(),s=()=>{e(n.deleteAndCommitComment(d.accountToCommentStreamUser(l),o,t,r))};A.showApprovalDeleteCommentModal(c(),r,a,s)}else{if(!p)throw new Error("showAuthModal or stream is not defined");p()}},onAddApprovalSuccess(e,o){C(e,o)},onEditApprovalSuccess(r,t,a){var i;const l=o();if(l){const o=(null===(i=u())||void 0===i?void 0:i.url)||c();e(n.editAndCommitComment(d.accountToCommentStreamUser(l),o,t,r,a)),e(m.setApprovalForm({[o]:{}}))}else{if(!p)throw new Error("showAuthModal or stream is not defined");p()}},onResubmitApprovalFocus(o){var r;const t=(null===(r=u())||void 0===r?void 0:r.url)||c();null==A||A.getLogger().logResubmitRequestClick(c(),o),e(m.setApprovalForm({[t]:{activeForm:"request_resubmit",threadId:o}}))},onResubmitApprovalBlur(){var o;const r=(null===(o=u())||void 0===o?void 0:o.url)||c();e(m.setApprovalForm({[r]:{}}))},onResubmitApprovalRequest(e,o){if(!A)return;const r=c();A.resubmitApprovalRequest(r,e,o.text).then(t=>{A.getLogger().logResubmitRequestSuccess(r,e,o.text.length,t.comment_id),C(o,e)})},onRemoveApprovalThread(r){var t;if(!A)return;const a=o();if(a){const o=(null===(t=u())||void 0===t?void 0:t.url)||c(),i=()=>{e(n.deleteAndCommitThread(d.accountToCommentStreamUser(a),o,r))};A.showApprovalDeleteThreadModal(c(),r,i)}else{if(!p)throw new Error("showAuthModal or stream is not defined");p()}},onCommentActivated(o,r){var t;const a=l.findCommentThread(r,o);a&&e(n.activateThread({fileId:c(),sharedLinkURL:null===(t=u())||void 0===t?void 0:t.url,fileViewerId:v(),threadId:a.thread.id,isThirdParty:a.thread.isThirdParty}))}}},o.ENABLED_SETTINGS={canComment:!0,canModifyThreads:!0,canShowEditor:!0,canShowEditorMeatball:!1},o.READ_ONLY_SETTINGS={canComment:!1,canModifyThreads:!1,canShowEditor:!1,canShowEditorMeatball:!1}}));
//# sourceMappingURL=adapter.amd.min.js-vfliMSeSI.map