define(["require","exports","tslib","react","typescript/libraries/file-viewer/src/plugins/types","modules/clean/react/integrations/pdf_editor/redux/store","modules/clean/react/integrations/pdf_editor/utils/iframe_url_util","modules/clean/react/integrations/pdf_editor/components/layer","dig-components/icons/src","react-intl","modules/clean/react/integrations/pdf_editor/redux/features/application/application_slice","modules/clean/react/integrations/pdf_editor/redux/features/document_actions/document_actions_slice","modules/clean/react/integrations/pdf_editor/redux/features/logging/logging_actions_slice","modules/clean/logging/hive/schemas/web-edit_mode","modules/clean/react/integrations/pdf_editor/plugin/show_plugin_util","modules/clean/react/integrations/pdf_editor/utils/shared_link_url"],(function(e,t,i,s,o,n,r,a,l,d,c,u,g,h,f,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PdfEditorPluginBase=void 0,s=i.__importDefault(s);const m=d.defineMessage({id:"pTN+nR",defaultMessage:"Edit"});t.PdfEditorPluginBase=class{constructor(e,t,i,d,v){this.fullscreenLayer=e=>s.default.createElement(a.Layer,{file:e.file,intl:this.adapter.intl,exitEditMode:()=>{this.store.dispatch(g.logUserAction({eventName:h.PDFEditingEventNames.DISMISS_SAVE_PDF})),this.context.getPluginData().navigation.exitEditMode()},store:this.store}),this.buttonIcon=l.EditLine,this.buttonText="",this.lifecycle={previewWillInitialize:()=>{const{file:e}=this.getActiveFile();f.showEditPlugin(e)?this.context.enableSelf():this.context.disableSelf()},previewDidInitialize:()=>{0},previewDidError:()=>{this.context.disableSelf()},pluginDidActivate:()=>{var e,t,i,s,a;const l=r.generateIframeOrigin(this.nonce),d=r.generateIframeUrl(l);this.store=n.createStore({iframeOrigin:l,iframeUrl:d}),this.store.dispatch(g.setFileIdForLogging(null===(e=this.context.getPluginData().file)||void 0===e?void 0:e.fileId)),this.store.dispatch(g.setEditViewForLogging(h.PDFEditingEditView.LIST)),this.store.dispatch(u.setFileId(null===(t=this.context.getPluginData().file)||void 0===t?void 0:t.fileId)),this.store.dispatch(u.setFilePath(null===(i=this.context.getPluginData().file)||void 0===i?void 0:i.fqPath)),this.store.dispatch(u.setAPIV2ClientBase(this.adapter.apiv2ClientBase));const f=this.context.getPluginData(),m=f.account;if("loaded"===m.state&&m.data&&this.store.dispatch(u.setUser(this.user)),f.previewType===o.PreviewType.SsrDoc){const e=!!(null===(s=f.file)||void 0===s?void 0:s.isPasswordProtected);this.store.dispatch(c.setDocumentIsPasswordProtected(e))}if(f.file&&this.store.dispatch(u.setFileSizeInBytes(f.file.size)),null===(a=f.file)||void 0===a?void 0:a.url){const e=p.transformFileViewerSdkUrlToDownloadUrl(f.file.url);this.store.dispatch(u.setFileSharedLinkUrl(e))}this.store.dispatch(g.logUserAction({eventName:h.PDFEditingEventNames.SELECT_EDIT_MODE}))}},this.adapter=e,this.context=t,this.buttonText=this.adapter.intl.formatMessage(m),this.nonce=i,this.getActiveFile=d,this.user=v}}}));
//# sourceMappingURL=plugin.min.js-vfl3bcmop.map