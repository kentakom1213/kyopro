define("modules/clean/clipboard_v2",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ClipboardV2=void 0;t.ClipboardV2=class{constructor(e,t){this.do_copy=this.do_copy.bind(this),this.onSuccess=e,this.onError=t}do_copy(){document.execCommand("copy",!1)?this.onSuccess():this.onError()}}})),define("modules/clean/react/file_viewer/collection_viewer",["require","exports","tslib","lodash","react","react-redux","modules/clean/file_store/utils","modules/clean/react/file_viewer/utils","modules/clean/react/file_viewer/file_viewer","modules/clean/previews/data/selectors","modules/clean/react/file_viewer/data/actions","modules/clean/react/file_viewer/data/store","modules/clean/react/file_viewer/data/selectors","modules/clean/react/keyboard_binding/keyboard_binding_provider","modules/clean/react/keyboard_binding/keyboard_binding_connector","ts-keycode-enum","modules/clean/react/keyboard_binding/keyboard_binding","modules/clean/react/file_viewer/logging","modules/clean/react/file_viewer/constants","modules/clean/integrations/zoom_share_dialog/async_modal","modules/core/uri","modules/clean/history","modules/constants/file_viewer","modules/clean/react/file_viewer/sdk_file_viewer/async_file_viewer","modules/clean/react/file_viewer/sdk_file_viewer/utils","modules/constants/python","modules/clean/react/previews/constants"],(function(e,t,s,n,i,a,r,o,l,d,c,h,p,u,m,g,_,f,S,E,M,C,b,I,v,y,T){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FileCollectionViewer=t._FileCollectionViewer=void 0,n=s.__importStar(n),i=s.__importDefault(i),C=s.__importDefault(C);const k=h.getStoreForFileViewer();function w({file:e,files:t,sharedLinkInfos:s,sharePermissions:i,shareTokens:a,oldIndex:l}){const d=(function(e,t,s){const i=t.filter(e=>!e.is_dir),a=r.getFileRevisionId(e);let l=n.find(i,e=>r.getFileRevisionId(e)===a);if(!l){const t=e.file_id;l=n.find(i,e=>e.file_id===t)}if(!l&&o.isPreviewPageRevampEnabled()&&i.length>0&&void 0!==s){let e=s;return s>=i.length&&(e=i.length>1?i.length-1:0),{file:i[e],files:i,newIndex:e}}l||(l=e);const d=i.indexOf(l);return-1===d?{file:l,files:[l],newIndex:0}:{file:l,files:i,newIndex:d}})(e,t,l);return{collection:{file:d.file,files:d.files,sharedLinkInfos:s,sharePermissions:i,shareTokens:a},currentIndex:d.newIndex}}class A extends i.default.Component{constructor(e){super(e),this.updateFileViewer=()=>{const{file:e}=this.props;this.openFile(e)},this.handleFlipNext=n.throttle(()=>{const{isFlippingEnabled:e}=this.props,{collection:t,currentIndex:s}=this.state;if(!e)return;this.props.onFlipNext&&this.props.onFlipNext();const n=s+1===t.files.length?0:s+1;this.switchFile(n)},100),this.handleFlipPrevious=n.throttle(()=>{const{isFlippingEnabled:e}=this.props,{collection:t,currentIndex:s}=this.state;if(!e)return;this.props.onFlipPrevious&&this.props.onFlipPrevious();const n=0===s?t.files.length-1:s-1;this.switchFile(n)},100),this.switchFile=e=>{const{collection:t}=this.state;this.setState({currentIndex:e});const s=t.files[e];this.updatePreviewUrl(s),this.openFile(s)},this.flipKeybindings=[_.hydrateKeyboardBinding({keyboardEventCriteria:{which:g.Key.RightArrow},callback:()=>{this.handleFlipNext(),f.logUserAction(S.UserAction.FlipNext,S.UserActionContext.Keyboard)}}),_.hydrateKeyboardBinding({keyboardEventCriteria:{which:g.Key.LeftArrow},callback:()=>{this.handleFlipPrevious(),f.logUserAction(S.UserAction.FlipPrevious,S.UserActionContext.Keyboard)}})],this.closeViewer=()=>{const{onCloseViewer:e}=this.props;e&&e(),c.closeFile()},this.renderInSdk=e=>{switch(e){case y.FileViewOriginType.BROWSE:case y.FileViewOriginType.HOME:case y.FileViewOriginType.HELLOSIGN:case y.FileViewOriginType.RECENTS:case y.FileViewOriginType.STARRED:case y.FileViewOriginType.SEARCH:case y.FileViewOriginType.VERSION_HISTORY:case y.FileViewOriginType.SHARED_LINK_PAGE:case y.FileViewOriginType.COLLECTIONS:return o.isPreviewPageRevampEnabled();case y.FileViewOriginType.SHARED_CONTENT_LINK_PAGE:return b.INBAND_FVSDK_LINKS;case y.FileViewOriginType.PHOTOS:return o.isPreviewPageRevampEnabled()&&b.WEB_PHOTOS_REFRESH;case y.FileViewOriginType.COMMERCE:return o.isPreviewPageRevampEnabled()&&b.ENABLE_FVSDK_COMMERCE;case y.FileViewOriginType.TRANSFER:return o.isPreviewPageRevampEnabled()&&b.ENABLE_FVSDK_TRANSFER;default:return!1}},this.state=w(e)}UNSAFE_componentWillMount(){this.updateFileViewer()}componentDidMount(){const{collection:e,currentIndex:t}=this.state,{previewApiDataMap:s,shouldPresentInZoom:n,user:i,file:a}=this.props,l=e.files.map(e=>{const t=r.getFileRevisionId(e);return s[t]&&s[t].data});o.preloadImages(l,t),this.setupPreviewUrl(a),i&&n&&E.asyncShowModal(i.id,a.file_id,"file-viewer-modal-overlay")}UNSAFE_componentWillReceiveProps(e){if((function(e,t){const{file:s,files:n,sharedLinkInfos:i,sharePermissions:a,shareTokens:r}=e;return s!==t.file||n!==t.files||i!==t.sharedLinkInfos||a!==t.sharePermissions||r!==t.shareTokens})(this.props,e)){const t=this.state.currentIndex,s=e.file,n=w(Object.assign(Object.assign({},e),{file:s,oldIndex:t}));this.setState(n,()=>{t!==n.currentIndex&&this.switchFile(n.currentIndex)})}}componentWillUnmount(){const{closeFile:e,onClose:t}=this.props;e(),t&&t(),this.teardownPreviewUrl()}openFile(e){this.props.openFile(e)}setupPreviewUrl(e){this.props.skipOuterRouting||this.setPreviewUrl(e)}updatePreviewUrl(e){this.setPreviewUrl(e,!1)}teardownPreviewUrl(){this.props.skipOuterRouting||this.setPreviewUrl(null)}setPreviewUrl(e,t=!0){if(this.props.disableRouting)return;const s=M.URI.parse(C.default.get_url()),n=M.URI.encode_parts(s.getPath());let i=s.removeQuery("select").removeQuery("page");if(null==e)i=i.removeQuery("preview");else{const t=r.getFilename(e);i=i.updateQuery({preview:t})}const a=i.getQuery();t?C.default.push_state(n,a,{immediatelyRestoreState:!1}):C.default.replace_state(n,a)}renderSDKSurface(){const{fileViewOrigin:e,hidePageChrome:t,user:s,browseContext:a,browseExceptions:r,canRestoreRevision:o,onRestoreRevision:l,brandingInfo:d,initialPreviewSourceContext:c,shouldFocusApproval:h,shouldFocusComment:p,activeCommentThreadId:u,appDownloadInterstitialDismissed:m,containerId:g,usePreloadedMetadata:_}=this.props,{collection:f,currentIndex:S}=this.state,E=n.get(f.sharedLinkInfos,S),M=n.get(f.sharePermissions,S),C=n.get(f.shareTokens,S);switch(e){case y.FileViewOriginType.BROWSE:case y.FileViewOriginType.VERSION_HISTORY:case y.FileViewOriginType.HOME:case y.FileViewOriginType.HELLOSIGN:case y.FileViewOriginType.PHOTOS:case y.FileViewOriginType.STARRED:case y.FileViewOriginType.RECENTS:case y.FileViewOriginType.SEARCH:case y.FileViewOriginType.COLLECTIONS:if(!s)throw new Error("User is required to browse files");let b;switch(e){case y.FileViewOriginType.VERSION_HISTORY:b=v.SDKPreviewSurface.VERSION_HISTORY;break;case y.FileViewOriginType.HOME:b=v.SDKPreviewSurface.HOME;break;case y.FileViewOriginType.HELLOSIGN:b=v.SDKPreviewSurface.HELLOSIGN;break;case y.FileViewOriginType.STARRED:b=v.SDKPreviewSurface.STARRED;break;case y.FileViewOriginType.RECENTS:b=v.SDKPreviewSurface.RECENTS;break;case y.FileViewOriginType.SEARCH:b=v.SDKPreviewSurface.SEARCH;break;case y.FileViewOriginType.PHOTOS:b=v.SDKPreviewSurface.PHOTOS;break;case y.FileViewOriginType.COLLECTIONS:b=v.SDKPreviewSurface.COLLECTIONS;break;default:b=v.SDKPreviewSurface.BROWSE}return i.default.createElement(I.AsyncFileViewer,{file:n.get(f.files,S),fileIndex:S,fileCount:f.files.length,flipToNextFile:this.handleFlipNext,flipToPreviousFile:this.handleFlipPrevious,sharedLinkInfo:E,sharePermission:M,shareToken:C,brandingInfo:d,user:s,closeFile:this.closeViewer,previewSurface:b,canRestoreRevision:o,onRestoreRevision:l,browseContext:a,browseExceptions:r,previewContentOnly:t,canShowFileFlippers:b===v.SDKPreviewSurface.SEARCH||b===v.SDKPreviewSurface.BROWSE||b===v.SDKPreviewSurface.COLLECTIONS,shouldFocusApproval:h,shouldFocusComment:p,activeCommentThreadId:u,hideOpenInAppInterstitial:!!m});case y.FileViewOriginType.SHARED_LINK_PAGE:if(!E||!M||!C)throw new Error("Missing required data to view");return i.default.createElement(I.AsyncFileViewer,{file:n.get(f.files,S),fileIndex:S,fileCount:f.files.length,flipToNextFile:this.handleFlipNext,flipToPreviousFile:this.handleFlipPrevious,sharedLinkInfo:E,sharePermission:M,shareToken:C,brandingInfo:d,closeFile:this.closeViewer,previewSurface:v.SDKPreviewSurface.SHARED_LINK,user:s,canShowFileFlippers:c===T.PreviewSourceContext.SharedLinkFolder||c===T.PreviewSourceContext.SharedLinkCollection,previewContentOnly:t,hideOpenInAppInterstitial:!!m});case y.FileViewOriginType.SHARED_CONTENT_LINK_PAGE:if(!E||!M||!C)throw new Error("Missing required data to view");if(!s)throw new Error("user required");return i.default.createElement(I.AsyncFileViewer,{file:n.get(f.files,S),fileIndex:S,fileCount:f.files.length,flipToNextFile:this.handleFlipNext,flipToPreviousFile:this.handleFlipPrevious,sharedLinkInfo:E,sharePermission:M,shareToken:C,brandingInfo:d,closeFile:this.closeViewer,previewSurface:v.SDKPreviewSurface.SHARED_CONTENT_LINK,user:s,canShowFileFlippers:!1,previewContentOnly:t,hideOpenInAppInterstitial:!!m});case y.FileViewOriginType.COMMERCE:case y.FileViewOriginType.TRANSFER:return i.default.createElement(I.AsyncFileViewer,{file:n.get(f.files,S),fileIndex:S,fileCount:f.files.length,flipToNextFile:this.handleFlipNext,flipToPreviousFile:this.handleFlipPrevious,sharedLinkInfo:E,sharePermission:M,shareToken:C,brandingInfo:d,closeFile:this.closeViewer,previewSurface:v.SDKPreviewSurface.COMMERCE,user:s,canShowFileFlippers:!1,previewContentOnly:t,hideOpenInAppInterstitial:!!m,containerId:g,usePreloadedMetadata:_});default:return null}}render(){const e=this.props,{files:t,fileViewOrigin:a,isOverflowZoomMode:r,onFlipNext:o,onFlipPrevious:d,sharedLinkInfos:c,shareTokens:h,sharePermissions:p,skipOuterRouting:g,user:_,browseContext:f,canRestoreRevision:S,onRestoreRevision:E}=e,M=s.__rest(e,["files","fileViewOrigin","isOverflowZoomMode","onFlipNext","onFlipPrevious","sharedLinkInfos","shareTokens","sharePermissions","skipOuterRouting","user","browseContext","canRestoreRevision","onRestoreRevision"]),{currentIndex:C,collection:b}=this.state,I=this.renderInSdk(a);return i.default.createElement(u.KeyboardBindingProvider,null,i.default.createElement("div",null,I||r?null:i.default.createElement(m.KeyboardBindingConnector,{keyboardBindings:this.flipKeybindings}),I?this.renderSDKSurface():i.default.createElement(l.FileViewer,Object.assign({},M,{user:_,fileViewOrigin:a,fileIndex:C,fileCount:b.files.length,onFlipNext:this.handleFlipNext,onFlipPrevious:this.handleFlipPrevious,sharedLinkInfo:n.get(b.sharedLinkInfos,C),shareToken:n.get(b.shareTokens,C),sharePermission:n.get(b.sharePermissions,C),canRestoreRevision:S,onRestoreRevision:E}))))}}t._FileCollectionViewer=A,A.defaultProps={isFlippingEnabled:!0},A.displayName="_FileCollectionViewer";const N=a.connect((e,t)=>({isFlippingEnabled:p.getIsFlippingEnabled(e),previewApiDataMap:d.getApiDataForFiles(e,t.files),isOverflowZoomMode:p.isOverflowZoomMode(e)}),{closeFile:c.closeFile,openFile:c.openFile})(A);class L extends i.default.Component{render(){return i.default.createElement(a.Provider,{store:k},i.default.createElement(N,Object.assign({},this.props)))}}t.FileCollectionViewer=L,L.displayName="FileCollectionViewerWithProvider"})),define("modules/clean/react/file_viewer/controller",["require","exports","tslib","react","react-dom","modules/clean/react/file_viewer/data/store","modules/clean/previews/data/store","modules/clean/react/file_viewer/utils","modules/core/browser_detection","modules/clean/react/file_viewer/collection_viewer","modules/clean/react/file_viewer/url_utils","modules/clean/react/previews/constants","modules/clean/react/extensions/data/store","modules/clean/previews/data/selectors","modules/clean/file_store/utils"],(function(e,t,s,n,i,a,r,o,l,d,c,h,p,u,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.updateProps=t.render=t.isShown=t.close=t.updateFiles=t.open=t.prewarmPreviewData=void 0,n=s.__importDefault(n),i=s.__importDefault(i);let g=null,_="";function f(e,t){const s=a.getStoreForFileViewer();r.fetchPreviewDataUpdateStore(s,e,t)}t.prewarmPreviewData=function(e,t){f(e,t)};function S(){(function(){const e=document.getElementById(_);i.default.unmountComponentAtNode(e),(function(e){const t=document.getElementById(e);if(t){const e=t.getAttribute("data-preview-created-container");e&&"true"===e&&document.body.removeChild(t)}})(_),g=null})()}function E(e){const t=document.getElementById(_);g=i.default.render(n.default.createElement(d.FileCollectionViewer,Object.assign({},e)),t)}t.open=function(e,t,n,i,d,g){_=i,(function(e){let t=document.getElementById(e);t||(t=document.createElement("div"),t.setAttribute("data-preview-created-container","true"),t.id=e,document.body.insertBefore(t,document.body.children[0]))})(_);const f=(function(e){let{initialPreviewSourceAction:t,initialPreviewSourceContext:n,sharedLinkInfos:i,sharePermissions:a,shareTokens:r}=e,d=s.__rest(e,["initialPreviewSourceAction","initialPreviewSourceContext","sharedLinkInfos","sharePermissions","shareTokens"]);d.canClose=!0,null==n&&(n=o.getSourceContext(d.fileViewOrigin)||h.PreviewSourceContext.Browse);null==t&&(t=o.getSourceAction());const c=l.is_supported_mobile_browser();d.isMobileUserAgent=c,c&&(d.hideComments=!0);const{onCloseViewer:p}=d;return d.onCloseViewer=()=>(S(),"function"==typeof p?p():void 0),Object.assign({initialPreviewSourceAction:t,initialPreviewSourceContext:n},d)})(d);g||(function(e,t){const s=a.getStoreForFileViewer();a.hydrateFileViewerNamespace(s,{},t),r.hydrateFileStoreAndPreviewStore(s,e,t),t&&p.initializeStore(t,e)})(e,n);const M=a.getStoreForFileViewer(),C=u.getApiDataForFiles(M.getState(),e),b=e.map(e=>{var t;return Object.assign(Object.assign({},e),{preview:e.preview||(null===(t=C[m.getFileRevisionId(e)])||void 0===t?void 0:t.data)})});E(Object.assign(Object.assign({},f),{containerId:i,titleBarCloseUrl:c.getCurrentFolderHref(),files:b,file:b[t],sharedLinkInfos:d.sharedLinkInfos,shareTokens:d.shareTokens,sharePermissions:d.sharePermissions,user:n,shouldPresentInZoom:d.shouldPresentInZoom}))},t.updateFiles=function(e){if(g){(function(e){const t=a.getStoreForFileViewer();a.updateFileStore(t,e)})(e);const t=g.props;f(e,t.user),E(Object.assign(Object.assign({},t),{files:e}))}},t.close=S,t.isShown=function(){return null!=g},t.render=E,t.updateProps=function(e){if(g){const t=g.props;E(Object.assign(Object.assign({},t),e))}}})),define("modules/clean/react/pass/action_timestamps",["require","exports","tslib","modules/clean/react/pass/constants","modules/core/exception"],(function(e,t,s,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ActionTimestampsTracker=void 0,i=s.__importStar(i);const a=[n.LoggingActions.PRESENCE_RECEIVE,n.LoggingActions.TRANSMITTER_TOKEN_BEGIN,n.LoggingActions.TRANSMITTER_TOKEN_RECEIVE,n.LoggingActions.RECEIVER_TOKEN_BEGIN,n.LoggingActions.RECEIVER_TOKEN_RECEIVE,n.LoggingActions.SEEN_STATE_USERS_BEGIN,n.LoggingActions.SEEN_STATE_USERS_RECEIVE];t.ActionTimestampsTracker=new class{constructor(){this.allTimestamps={}}record(e,t){if(!t)return;const s=(new Date).getTime()/1e3;this.allTimestamps[t]=this.allTimestamps[t]||{};const n=this.allTimestamps[t];n.hasOwnProperty(e)?this.reportStackForRepeatedAction(n,e,t,s):n[e]=s}get(e){return e&&this.allTimestamps[e]||{}}reportStackForRepeatedAction(e,t,s,n){if(a.indexOf(t)>=0)return;const r=e[t];i.reportStack("Attempted to record action for which there existed a previous record",{severity:i.SEVERITY.NONCRITICAL,tags:["pass:actionTimestampsTracker"],exc_extra:{preview_session_id:s,action:t,oldTimestamp:r,newTimestamp:n}})}}})),define("modules/clean/react/pass/actions",["require","exports","modules/clean/flux/dispatcher","modules/clean/react/pass/constants"],(function(e,t,s,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PassActions=void 0;t.PassActions=class{static passPermissionRequest(e){s.Dispatcher.dispatch({type:n.ActionTypes.PASS_PERMISSION_REQUEST,data:{fileId:e}})}static updatePermissions(e,t){s.Dispatcher.dispatch({type:n.ActionTypes.UPDATE_PERMISSIONS,data:{fileId:e,partialPermission:t}})}static fetchPassError(e){s.Dispatcher.dispatch({type:n.ActionTypes.FETCH_PASS_ERROR,data:{fileId:e}})}static fetchPassConcluded(e){s.Dispatcher.dispatch({type:n.ActionTypes.FETCH_PASS_CONCLUDED,data:{fileId:e}})}static receivePresenceDelta(e,t,i,a){s.Dispatcher.dispatch({type:n.ActionTypes.RECEIVE_PRESENCE_DELTA,data:{userId:e,fileId:t,onlineUniqueUsers:i,offlineUniqueUsers:a}})}static receivePresenceSnapshot(e,t,i){s.Dispatcher.dispatch({type:n.ActionTypes.RECEIVE_PRESENCE_SNAPSHOT,data:{userId:e,fileId:t,onlineUniqueUsers:i}})}static resetPassInfo(e){s.Dispatcher.dispatch({type:n.ActionTypes.RESET_PASS_INFO,data:{fileId:e}})}static updateSeenStateInfo(e,t,i){s.Dispatcher.dispatch({type:n.ActionTypes.UPDATE_SEEN_STATE_INFO,data:{fileId:e,seenStateInfo:t,seenStateCursor:i}})}static updateUserTeamInteractionInfo(e,t){s.Dispatcher.dispatch({type:n.ActionTypes.UPDATE_USER_TEAM_INTERACTION_INFO,data:{fileId:e,userTeamInteractionInfo:t}})}static updateSeenStateInfoContinue(e,t,i){s.Dispatcher.dispatch({type:n.ActionTypes.UPDATE_SEEN_STATE_INFO_CONTINUE,data:{fileId:e,seenStateInfo:t,seenStateCursor:i}})}static discontinueSeenStateInfo(e){s.Dispatcher.dispatch({type:n.ActionTypes.DISCONTINUE_SEEN_STATE_INFO,data:{fileId:e}})}static updateSeenStateUnavailable(e,t){s.Dispatcher.dispatch({type:n.ActionTypes.UPDATE_SEEN_STATE_UNAVAILABLE,data:{userId:e,fileId:t}})}}})),define("modules/clean/react/pass/beacon_presence_helpers",["require","exports","tslib","lodash","api_v2/user_client","api_v2/noauth_client","modules/clean/beacon","modules/clean/react/pass/action_timestamps","modules/clean/react/pass/seen_state_helpers","modules/clean/react/pass/actions","modules/clean/react/pass/constants","modules/clean/uuid/uuid","modules/clean/viewer","modules/constants/python"],(function(e,t,s,n,i,a,r,o,l,d,c,h,p,u){"use strict";function m(e){d.PassActions.resetPassInfo(e),d.PassActions.fetchPassError(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.BeaconPresenceHelpers=void 0,n=s.__importStar(n),r=s.__importStar(r);class g{static resetClassState(){delete this.receiverData,delete this.transmitterData,delete this.lastFileIdForReceiverTokenRequest,delete this.lastFileIdForTransmitterTokenRequest}static shutdown({beaconFileData:e,user:t,async:s,shouldWritePresence:n=!0}){if(delete this.lastFileIdForReceiverTokenRequest,delete this.lastFileIdForTransmitterTokenRequest,this.transmitterData){const{beaconUserId:i,context:a,identifier:r}=this.transmitterData;this.transmitterData.transmitter.stop(),delete this.transmitterData,!p.Viewer.get_viewer().is_assume_user_session&&n&&l.SeenStateHelpers.updateSeenStateOnResign(t,e,s,i,r,a)}this.receiverData&&this.receiverData.receiver&&(this.receiverData.receiver.stop(),delete this.receiverData)}static receiveBeaconData({beaconFileData:e,user:t,previewSessionId:n,onUpdate:i}){return s.__awaiter(this,void 0,void 0,(function*(){const{fileId:s}=e;o.ActionTimestampsTracker.record(c.LoggingActions.RECEIVER_TOKEN_BEGIN,n),this.lastFileIdForReceiverTokenRequest=s;const a=yield this.fetchReceiverToken(t,e);if(this.lastFileIdForReceiverTokenRequest!==s)return;if(a.beacon_presence_error)return d.PassActions.updatePermissions(s,{canReadPresence:!1}),void("no_permission"===a.beacon_presence_error[".tag"]||m(s));d.PassActions.updatePermissions(s,{canReadPresence:!0}),o.ActionTimestampsTracker.record(c.LoggingActions.RECEIVER_TOKEN_RECEIVE,n);const l=[new r.PresenceParams(r.PresenceType.Context,t.account_id,this.APP,a.beacon_presence_info.context,a.beacon_presence_info.token)];this.receiverData&&this.receiverData.receiver&&this.receiverData.receiver.stop(),this.receiverData={authKey:a.beacon_presence_info.auth_key,receiver:new r.Receiver(l,s=>{o.ActionTimestampsTracker.record(c.LoggingActions.PRESENCE_RECEIVE,n);const a=this.parseBeaconUpdates(s[0]);i(a,t.id,e)},()=>this.receiveBeaconData({user:t,beaconFileData:e,previewSessionId:n,onUpdate:i})),context:a.beacon_presence_info.context},this.receiverData.receiver.start()}))}static fetchReceiverToken(e,t){const{fileId:s,url:n}=t,a={file_info:_(s,n)};return(new i.UserApiV2Client).ns("file_presence").rpc("get_pass_receiver_token",a,{subjectUserId:e.id})}static isOnline(e){return this.HARMONY_ONLINE_STATUSES.includes(e)||e===u.BEACON_ONLINE_STATUS}static parseBeaconUpdates(e){var t;const s={},n={},i=e.delta?"delta":"snapshot",a=null!==(t=e.delta||e.snapshot)&&void 0!==t?t:[];for(const e of a){const t=e.agent,i=t.user_id,a=t.source.identifier;this.isOnline(e.status)?(i in s||(s[i]={}),s[i][a]=!0):(i in n||(n[i]={}),n[i][a]=!0)}return{onlineUniqueUsers:s,offlineUniqueUsers:n,type:i}}static transmitBeaconData({user:e,beaconFileData:t,prevBeaconFileData:i,previewSessionId:a}){return s.__awaiter(this,void 0,void 0,(function*(){const{fileId:s}=t;this.transmitterData&&i&&(this.transmitterData.transmitter.add_or_update_agents([this.getAgentStatusForFile(this.transmitterData.beaconUserId,this.transmitterData.identifier,this.transmitterData.authKey,this.transmitterData.context,u.BEACON_OFFLINE_STATUS)]),setTimeout(()=>{this.transmitterData.transmitter.stop()},1)),o.ActionTimestampsTracker.record(c.LoggingActions.TRANSMITTER_TOKEN_BEGIN,a),this.lastFileIdForTransmitterTokenRequest=s;const l=yield this.fetchTransmitterToken(e,t);if(this.lastFileIdForTransmitterTokenRequest===s){if(l.beacon_presence_error)return d.PassActions.updatePermissions(s,{canWritePresence:!1}),void("no_permission"===l.beacon_presence_error[".tag"]||m(s));d.PassActions.updatePermissions(s,{canWritePresence:!0}),o.ActionTimestampsTracker.record(c.LoggingActions.TRANSMITTER_TOKEN_RECEIVE,a),this.transmitterData={identifier:h.UUID.v4({allowInsecure:!0}),beaconUserId:l.beacon_presence_info.beacon_user_id,authKey:l.beacon_presence_info.auth_key,transmitter:new r.Transmitter(l.beacon_presence_info.token,()=>this.transmitBeaconData({user:e,beaconFileData:t,prevBeaconFileData:null,previewSessionId:a}),n.noop),context:l.beacon_presence_info.context},this.transmitterData.transmitter.add_or_update_agents([this.getAgentStatusForFile(this.transmitterData.beaconUserId,this.transmitterData.identifier,this.transmitterData.authKey,this.transmitterData.context,u.BEACON_ONLINE_STATUS)]),this.transmitterData.transmitter.start()}}))}static getAgentStatusForFile(e,t,s,n,i){const a=new r.Source(this.PLATFORM,this.SURFACE,t),o=new r.Agent(e,this.APP,n,a);return new r.AgentStatus(o,i,s)}static fetchTransmitterToken(e,t){const{fileId:s,url:n}=t,r={file_info:_(s,n)};return e?(new i.UserApiV2Client).ns("file_presence").rpc("get_pass_transmitter_token",r,{subjectUserId:e.id}):(new a.NoAuthApiV2Client).ns("file_presence").rpc("logged_out/get_pass_transmitter_token",r,{})}}function _(e,t){return t?{".tag":"shared_link_details",url:t}:{".tag":"file_identifier",file_identifier:e}}t.BeaconPresenceHelpers=g,g.APP="harmony",g.PLATFORM=r.Platforms.WEB,g.SURFACE="file_viewer",g.HARMONY_ONLINE_STATUSES=["modifier","viewer"]})),define("modules/clean/react/pass/pass_helpers",["require","exports","tslib","jquery","modules/clean/react/file_viewer/utils","modules/clean/react/previews/constants","modules/clean/react/file_viewer/models","modules/clean/react/pass/actions","modules/clean/react/pass/beacon_presence_helpers","modules/clean/react/pass/seen_state_helpers","modules/clean/react/pass/types","modules/clean/react/pass/constants","modules/clean/sharing/actions/sharing_actions","modules/clean/viewer"],(function(e,t,s,n,i,a,r,o,l,d,c,h,p,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PassHelpers=void 0,n=s.__importDefault(n);const m=h.MAX_FACES_NORMAL+h.MAX_OVERFLOW_BUTTON_INDICATOR+1;class g{static setup({user:e,fileData:t,prevFileData:s,shouldWritePresence:n=!0,skipSharingEndpoints:i=!1,limit:a=150}){const r=t.file.file_id;this.shouldInitializePass(e,r,n)&&setTimeout(()=>{o.PassActions.passPermissionRequest(r),g.makeAllRequests({user:e,fileData:t,prevFileData:s,shouldWritePresence:n,skipSharingEndpoints:i,limit:a})},0)}static teardown({user:e,fileData:t,async:s,shouldWritePresence:i=!0}){const{file:a,url:r}=t,o=a.file_id;if(this.shouldInitializePass(e,o,i)){n.default(window).off("beforeunload.passpresence");const t=new c.BeaconFileData(o,r);l.BeaconPresenceHelpers.shutdown({beaconFileData:t,user:e,async:s,shouldWritePresence:i})}}static shouldInitializePass(e,t,s){return i.getSourceContext()!==a.PreviewSourceContext.SharedLinkCollection&&(null!==e||s)&&t}static onBeaconUpdate(e,t,s){const n=s.fileId;"delta"===e.type?o.PassActions.receivePresenceDelta(t,n,e.onlineUniqueUsers,e.offlineUniqueUsers):"snapshot"===e.type&&o.PassActions.receivePresenceSnapshot(t,n,e.onlineUniqueUsers)}static makeAllRequests({user:e,fileData:t,prevFileData:s,limit:i=150,shouldWritePresence:a=!0,skipSharingEndpoints:h=!1}){const g=r.FilePreviewSession.currentSession&&r.FilePreviewSession.currentSession.id,{file:_,url:f}=t,{file_id:S,fq_path:E}=_,M=S||E,C=new c.BeaconFileData(_.file_id,f);e?(M&&!h&&(p.SharingActions.fetchFileMemberCount({user:e,contentId:M,limit:m,countGroupsAsMembers:!1,url:f,previewSessionId:g,runViewerInfoChecks:!0}),p.SharingActions.listMembers({user:e,contentId:M,isFolder:!1,limit:6,url:f,previewSessionId:g,includeSeenState:!1})),d.SeenStateHelpers.fetchSeenStateInfo(e,S,i,f,g),l.BeaconPresenceHelpers.receiveBeaconData({beaconFileData:C,user:e,previewSessionId:g,onUpdate:this.onBeaconUpdate})):o.PassActions.updatePermissions(S,{canReadPresence:!1,canReadSeenState:!1});const b=u.Viewer.get_viewer().is_assume_user_session;if(!a||b)o.PassActions.updatePermissions(S,{canWritePresence:!1});else{const i=s&&new c.BeaconFileData(s.file,s.url);l.BeaconPresenceHelpers.transmitBeaconData({user:e,beaconFileData:C,prevBeaconFileData:i,previewSessionId:g}),n.default(window).off("beforeunload.passpresence"),n.default(window).on("beforeunload.passpresence",s=>{this.teardown({user:e,fileData:t,async:!1,shouldWritePresence:!0}),s.returnValue=void 0})}}}t.PassHelpers=g})),define("modules/clean/react/pass/seen_state_helpers",["require","exports","tslib","api_v2/transport/fetch","api_v2/user_client","api_v2/noauth_client","api_v2/error","api_v2/types","modules/clean/react/file_viewer/models","modules/clean/react/pass/action_timestamps","modules/clean/react/pass/actions","modules/clean/react/pass/constants"],(function(e,t,s,n,i,a,r,o,l,d,c,h){"use strict";function p(e){c.PassActions.resetPassInfo(e),c.PassActions.fetchPassError(e)}function u(e,t){return{file_identifier:e,shared_link_details:t?{url:t}:void 0}}var m;Object.defineProperty(t,"__esModule",{value:!0}),t.SeenStateHelpers=t.APITransport=void 0,(function(e){e.create=function(e){return e?new n.FetchAsyncTransport:new n.FetchSyncTransport}})(m=t.APITransport||(t.APITransport={}));t.SeenStateHelpers=class{static constructFakeSeenStateInfo(e,t,s){const n=s.seen_states,i=[];for(const e of n)i.push(e.seen_state_user.user_id);for(const s of e)if(!i.includes(s.user_id)){s.sharing_access_type&&(s.sharing_access_type=this.convertToUnion(s.sharing_access_type));const e={seen_state_user:s,when_last_seen:t,seen_events:[]};n.unshift(e)}return s.seen_states=n,s}static convertToUnion(e){return e?o.Union.parse(e):null}static parseSeenStatePassPlatform(e){if(e){switch(o.Union.parse(e).type){case"web":return h.PassPlatform.WEB;case"mobile":return h.PassPlatform.MOBILE;case"desktop":return h.PassPlatform.DESKTOP}}return h.PassPlatform.UNKNOWN}static fetchSeenStateUsers(e,t,n,a,o){return s.__awaiter(this,void 0,void 0,(function*(){const s=Date.now()/1e3,m=l.FilePreviewSession.currentSession&&l.FilePreviewSession.currentSession.id;d.ActionTimestampsTracker.record(h.LoggingActions.SEEN_STATE_USERS_BEGIN,m);const g=yield(new i.UserApiV2Client).ns("seen_state").rpc("get_seen_state_users",{user_ids:n,file_info:u(a,o)},{subjectUserId:e}).catch(r.catchApiError(()=>(p(a),Promise.reject(void 0))));d.ActionTimestampsTracker.record(h.LoggingActions.SEEN_STATE_USERS_RECEIVE,m);const _=this.constructFakeSeenStateInfo(g,s,t);c.PassActions.updateSeenStateInfo(a,_)}))}static processAndUpdateSeenStateInfo(e,t,s,n){const{seen_state_info:i,seen_state_error:a,seen_state_cursor:r}=s[0];if(a)if(n)c.PassActions.discontinueSeenStateInfo(t);else{if("no_permission"===o.Union.parse(a).type)return;p(t)}else{for(const e of i.seen_states)e.seen_state_user.sharing_access_type=this.convertToUnion(e.seen_state_user.sharing_access_type),e.platform_type=this.parseSeenStatePassPlatform(e.platform_type);n?c.PassActions.updateSeenStateInfoContinue(t,i,r):c.PassActions.updateSeenStateInfo(t,i,r)}}static fetchSeenStateInfo(e,t,n,a,o){return s.__awaiter(this,void 0,void 0,(function*(){d.ActionTimestampsTracker.record(h.LoggingActions.SEEN_STATE_BEGIN,o);const s=yield(new i.UserApiV2Client).ns("seen_state").rpc("get_seen_state_info",{file_infos:[u(t,a)],limit:n},{subjectUserId:e.id}).catch(r.catchApiError(()=>(p(t),Promise.reject(void 0))));let l=!0;const{seen_state_info:m,seen_state_error:g}=s[0];l=!(!m||g),c.PassActions.updatePermissions(t,{canReadSeenState:l}),l||c.PassActions.updateSeenStateUnavailable(e.id,t),l&&d.ActionTimestampsTracker.record(h.LoggingActions.SEEN_STATE_RECEIVE,o),this.processAndUpdateSeenStateInfo(e,t,s,!1),l&&this.fetchRemainingSeenStateInfo(e,t,s,a)}))}static fetchRemainingSeenStateInfo(e,t,s,n){const i=s[0].seen_state_cursor;if(i&&i.has_next){const s=i.cursor_state;s&&this.fetchSeenStateInfoContinue(e,t,s,1e5,n)}}static fetchSeenStateInfoContinue(e,t,n,a,o){return s.__awaiter(this,void 0,void 0,(function*(){const s=yield(new i.UserApiV2Client).ns("seen_state").rpc("get_seen_state_info/continue",{file_infos:[u(t,o)],cursor:n,limit:a},{subjectUserId:e.id}).catch(r.catchApiError(()=>(c.PassActions.discontinueSeenStateInfo(t),Promise.reject(void 0))));this.processAndUpdateSeenStateInfo(e,t,s,!0)}))}static updateSeenStateOnResign(e,t,s,n,r,o){const l=m.create(s);return(function(e,t,s,n,r){return e?t(new i.UserApiV2Client(r).ns("seen_state"),n,{subjectUserId:e.id}):s(new a.NoAuthApiV2Client(r).ns("seen_state"),n,{})})(e,(e,t,s)=>e.rpc("update_timestamps_and_mark_offline",t,s),(e,t,s)=>e.rpc("logged_out/mark_offline",t,s),{beacon_infos:[{beacon_user_id:n,context:o,shared_link_url:t.url,identifier:r}]},l)}}})),define("modules/clean/react/pass/types",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BeaconFileData=t.FacepileInfo=t.UserInfo=void 0;t.UserInfo=class{constructor(e,t,s,n,i,a,r,o,l,d,c,h,p){this.key=e,this.displayName=t,this.isActive=s,this.isViewer=n,this.incrementOverflowBasis=i,this.email=a,this.accessLevel=r,this.whenLastSeen=o,this.photoUrl=l,this.userId=d,this.platformType=c,this.same_team=h,this.is_guest=p}};class s{constructor(e,t){this.isLoaded=e,this.data=t}static create(e){return new s(!0,e)}static createNotLoaded(){return new s(!1,null)}}t.FacepileInfo=s;t.BeaconFileData=class{constructor(e,t){this.fileId=e,this.url=t}}})),define("modules/clean/react/teams/modals/limited_team_share_folder_modal",["require","exports","tslib","create-react-class","react","prop-types","react-addons-pure-render-mixin","modules/clean/analytics","modules/clean/filepath/filepath","modules/clean/react/components/modal","modules/core/browser","modules/core/i18n","modules/core/uri"],(function(e,t,s,n,i,a,r,o,l,d,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.showModalInstance=void 0,n=s.__importDefault(n),i=s.__importDefault(i),a=s.__importDefault(a),r=s.__importDefault(r),l=s.__importStar(l),c=s.__importStar(c);const u=e=>o.TeamsWebActionsLogger.log(e,null,null,null,!1,o.TeamsWebActionsLogger.LOG_CATEGORY.TEAM_INFO),m=n.default({mixins:[r.default],displayName:"LimitedTeamShareFolderModal",propTypes:{fqPath:a.default.string.isRequired},_navigateToTeam:()=>(u("team_folder_share_invite"),c.redirect(new p.URI({path:"/team",query:{invite_members:"",tk:"team_folder_share_invite",_camp:"modal"}}))),render(){const e=l.filename(this.props.fqPath);return i.default.createElement(d.Modal,{title:h.intl.formatMessage({id:"lTRVQL",defaultMessage:"Share {folder_name}"},{folder_name:e}),acceptButtonText:h.intl.formatMessage({id:"sTZgnw",defaultMessage:"Invite"}),onAccept:this._navigateToTeam,showButtonDivider:!0},i.default.createElement("div",null,h.intl.formatMessage({id:"4BBW2C",defaultMessage:"To share the {folder_name} with someone, invite them to join your team!"},{folder_name:e})))}});t.showModalInstance=function(e){const t=d.Modal.showInstance(i.default.createElement(m,Object.assign({},e)));return u("team_folder_share"),t}})),define("modules/clean/sharing/action_types",["require","exports","modules/clean/flux/action_type"],(function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SharingActionTypes=t.ShareModalActionTypes=void 0,t.ShareModalActionTypes=s.withActionNamespace("share-modal-actions",{SHARE_MODAL_OPEN:"share-modal-open",SHARE_MODAL_CLOSE:"share-modal-close",RESET_MODAL_STATE:"reset-modal-state",OPEN_LINK_SETTINGS_MODAL:"open-link-settings-modal",OPEN_FOLDER_SETTINGS_MODAL:"open-folder-settings-modal",OPEN_SHARED_LINK_MODAL:"open-shared-link-modal",CLOSE_LINK_SETTINGS_MODAL:"close-link-settings-modal",CLOSE_FOLDER_SETTINGS_MODAL:"close-folder-settings-modal",CLOSE_SHARED_LINK_MODAL:"close-shared-link-modal",CLEAR_METADATA:"clear-metadata",FETCH_METADATA_REQUEST:"metadata-request",FETCH_METADATA_SUCCESS:"metadata-success",FETCH_METADATA_FAILURE:"metadata-failure",CLEAR_LINK_METADATA:"clear-link-metadata",FETCH_LINK_METADATA_REQUEST:"link-metadata-request",FETCH_LINK_METADATA_SUCCESS:"link-metadata-success",FETCH_LINK_METADATA_FAILURE:"link-metadata-failure",CLEAR_SHARING_PREFS:"clear-sharing-prefs",FETCH_SHARING_PREFS_REQUEST:"sharing-prefs-request",FETCH_SHARING_PREFS_SUCCESS:"sharing-prefs-success",FETCH_SHARING_PREFS_FAILURE:"sharing-prefs-failure",ERROR_MESSAGE:"error-message",ERROR_MESSAGE_CLEAR:"error-message-clear",CLEAR_FILE_MEMBERSHIP:"clear-file-membership",FETCH_FILE_MEMBERSHIP_REQUEST:"fetch-file-membership-request",FETCH_FILE_MEMBERSHIP_SUCCESS:"fetch-file-membership-success",FETCH_FILE_MEMBERSHIP_FAILURE:"fetch-file-membership-failure",CLEAR_FOLDER_MEMBERSHIP:"clear-folder-membership",FETCH_FOLDER_MEMBERSHIP_REQUEST:"fetch-folder-membership-request",FETCH_FOLDER_MEMBERSHIP_SUCCESS:"fetch-folder-membership-success",FETCH_FOLDER_MEMBERSHIP_FAILURE:"fetch-folder-membership-failure",FETCH_USER_ACCOUNTS_REQUEST:"fetch-user-accounts-request",FETCH_USER_ACCOUNTS_SUCCESS:"fetch-user-accounts-success",FETCH_USER_ACCOUNTS_FAILURE:"fetch-user-accounts-failure",FETCH_USER_ACCOUNTS_CONTINUED_REQUEST:"fetch-user-accounts-continued-request",FETCH_USER_ACCOUNTS_CONTINUED_SUCCESS:"fetch-user-accounts-continued-success",CLEAR_FILE_MEMBERSHIP_LAST_SEEN_INFO:"clear-file-membership-last-seen-info",FETCH_FILE_MEMBER_COUNT_REQUEST:"fetch-file-member-count-request",FETCH_FILE_MEMBER_COUNT_SUCCESS:"fetch-file-member-count-success",CHANGE_RECIPIENTS:"change-recipients",CHANGE_RECIPIENT_MESSAGE:"change-recipient-message",CHANGE_RECIPIENT_ACCESS:"change-recipient-access",UPDATE_RECIPIENT_VALIDATION:"update-recipient-validation",CREATE_LINK_REQUEST:"create-link-request",CREATE_LINK_SUCCESS:"create-link-success",CREATE_LINK_FAILURE:"create-link-failure",DISPLAY_CONTENT_NAME_INFO:"display-content-name-info",SEND_SHARE_REQUEST:"send-share-request",SEND_SHARE_SUCCESS:"send-share-success",SEND_SHARE_FAILURE:"send-share-failure",SHARE_FOLDER_REQUEST:"share-folder-request",SHARE_FOLDER_SUCCESS:"share-folder-success",SHARE_FOLDER_FAILURE:"share-folder-failure",SEND_FOLDER_SHARE_REQUEST:"send-folder-share-request",SEND_FOLDER_SHARE_SUCCESS:"send-folder-share-success",SEND_FOLDER_SHARE_FAILURE:"send-folder-share-failure",CHANGE_MEMBER_ACCESS_REQUEST:"change-member-access-request",CHANGE_MEMBER_ACCESS_SUCCESS:"change-member-access-success",CHANGE_MEMBER_ACCESS_FAILURE:"change-member-access-failure",MEMBER_ACTION_PENDING:"member-action-pending",MEMBER_ACTION_COMPLETE:"member-action-complete",REMOVE_MEMBER_SUCCESS:"remove-member-success",REMOVE_MEMBER_KEEP_ACCESS:"remove-member-keep-access",TRANSFER_OWNER_SUCCESS:"transfer-owner-success",FETCH_CURRENT_ACCOUNT_REQUEST:"fetch-current-account-request",FETCH_CURRENT_ACCOUNT_SUCCESS:"fetch-current-account-success",FETCH_MEMBER_COUNTS_REQUEST:"fetch-member-counts-request",FETCH_MEMBER_COUNTS_SUCCESS:"fetch-member-counts-success",HANDLE_CONTENT_NAME_CHANGE:"handle-content-name-change",VALIDATE_CONTENT_NAME_SUCCESS:"validate-content-name-success",VALIDATE_CONTENT_NAME_ERROR:"validate-content-name-error",CHANGE_LINK_AUDIENCE_REQUEST:"change-link-audience-request",CHANGE_LINK_AUDIENCE_SUCCESS:"change-link-audience-success",CHANGE_LINK_AUDIENCE_FAILURE:"change-link-audience-failure",UNBLOCK_MEMBER_LIST_ON_PASS_LOAD:"unblock-member-list-on-pass-load",UPDATE_SHARING_SETTINGS_SUCCESS:"update-sharing-settings-success",DELETE_LINK_METADATA_SUCCESS:"delete-link-metadata-success",CHANGE_CREATE_COMMENT_CHECKBOX:"change-create-comment-checkbox",SET_UPSELL_COUNTER_PREF:"set-upsell-counter-pref",SET_UPSELL_COUNTER_PREF_SUCCESS:"set-upsell-counter-pref-success",CHANGE_LINK_AUDIENCE_SELECTION:"change-link-audience-selection",REMOVE_LINK_AUDIENCE_SELECTION:"remove-link-audience-selection"}),t.SharingActionTypes=s.withActionNamespace("sharing-actions",{CLEAR_EVERYTHING:"clear-everything",FETCH_METADATA_BATCH_ATTEMPT:"fetch-metadata-batch-attempt",FETCH_METADATA_BATCH_SUCCESS:"fetch-metadata-batch-success",FETCH_METADATA_BATCH_FAIL:"fetch-metadata-batch-fail"})})),define("modules/clean/sharing/actions/share_modal",["require","exports","tslib","react","modules/clean/analytics","api_v2/error","modules/clean/browse_interface","modules/clean/contacts/contact","modules/clean/contacts/types","modules/clean/em_string","modules/clean/filepath/filepath","modules/clean/flux/dispatcher","modules/clean/react/browse/constants","modules/clean/react/components/modal","modules/clean/react/pass/actions","spectrum-sharing/utils/sharing_constants","modules/clean/react/pass/constants","modules/clean/react/pass/pass_helpers","modules/clean/react/pass/store","modules/clean/sharing/sharing_settings_util","modules/clean/sharing/action_types","modules/clean/sharing/actions/sharing_actions","modules/clean/sharing/api","modules/clean/sharing/api/types/metadata","modules/clean/sharing/api/util/types","modules/clean/sharing/confirmation_modals/member_access_change_confirmation_modal","modules/clean/sharing/confirmation_modals/relinquish_membership_confirmation_modal","modules/clean/sharing/sharing_settings_modal","modules/clean/sharing/access_level","modules/clean/sharing/parent_folder_access_modal","modules/clean/sharing/share_page/action_types","modules/clean/sharing/stores/sharing_info","modules/clean/sharing/stores/sharing_info_util","spectrum-sharing/share_modal/sharing_settings/utils/sharing_settings_constants","spectrum-sharing/utils/logging","spectrum-sharing/utils/logging","modules/clean/sharing/ui_util","modules/clean/sharing/ui_notifications_util","modules/clean/sharing/views/inherited_members","modules/clean/web_user_action_logger","modules/clean/web_user_action_events","modules/clean/deprecated_ajax/ajax_form_extract_errors","modules/core/browser","modules/core/i18n","modules/clean/react/snackbar","modules/clean/sharing/actions/contact_validators","spectrum-sharing/utils/sharing_constants","modules/clean/sharing/views/share_modal_evolution/utils/logging","modules/clean/sharing/sharing_questionnaire/content/constants","modules/clean/sharing/sharing_questionnaire/util","modules/clean/sharing/views/constants","dig-components/icons","dig-components/icons/src","modules/clean/sharing/views/rich_snackbar/exp_esign_snackbar","modules/clean/sharing/views/constants"],(function(e,t,s,n,i,a,r,o,l,d,c,h,p,u,m,g,_,f,S,E,M,C,b,I,v,y,T,k,w,A,N,L,P,O,F,R,x,D,U,B,H,V,j,q,G,W,K,z,Y,Q,Z,$,X,J,ee){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ShareModalActionHandler=t.incompleteInbandShare=void 0,n=s.__importDefault(n),r=s.__importStar(r),l=s.__importDefault(l),j=s.__importStar(j);const te=n.default.createElement;var se;t.incompleteInbandShare=new Set,(function(e){e.copy="copy",e.share="share"})(se||(se={}));t.ShareModalActionHandler=class{constructor(o,l,d,c,m,_){this.groupSeenStateInfo=null,this.linkSeenStateInfo=null,this.presentAccountIds=null,this.hasLoggedSet={},this.setUrl=null,this.haveTrackedEsignUpsell=!1,this.changeAccess=(e,t,s=!1)=>{let n=Promise.resolve({});const i=e.memberId(),a=this.getContentInfo(),r=a.id,o=this.sharingInfo.isNonUserRelativeContext();if(t===g.MEMBER_ACTION.REMOVE)i!==this.user.account_id||o?n=(a.isFileFolder()?this.client.getParentFolderAccess({contentId:this.sharingInfo.parentSharedFolderId(),memberId:i}):this.removeMember(r,e,s,a.isFolder())).then(t=>{this.showParentFolderAccessModalIfQualified("remove",e,t)}):this.relinquishMembership(r,s);else if(t===w.ACCESS_LEVEL.OWNER)n=this.client.transferContent({contentId:r,memberId:i}).then(()=>{this.dispatch(M.ShareModalActionTypes.TRANSFER_OWNER_SUCCESS),D.sharingNotificationSuccess(q.intl.formatMessage({id:"sAxJWH",defaultMessage:"Made {name} the owner"},{name:e.displayName()})),this.fetchDataAndShowShareModal()});else{let s;if(a.isFileFolder()&&t===w.ACCESS_LEVEL.READER)s=this.client.getParentFolderAccess({contentId:this.sharingInfo.parentSharedFolderId(),memberId:i,accessLevel:t});else{const n=this.getContentInfo().isFileFolder();n&&this.dispatch(M.ShareModalActionTypes.MEMBER_ACTION_PENDING,{member:e}),s=this.shareIfFileFolder(q.intl.formatMessage({id:"xYinYM",defaultMessage:"Updating member access..."})).then(()=>(n&&this.dispatch(M.ShareModalActionTypes.MEMBER_ACTION_COMPLETE,{member:e}),this.changeMemberAccess(this.getContentInfo().id,e,t))).catch(t=>{this.reportShareFailure(t),n&&this.dispatch(M.ShareModalActionTypes.MEMBER_ACTION_COMPLETE,{member:e})})}n=s.then(t=>{this.fetchInitialData(),this.handleShowUpdatedMembers(e,t)})}return n.then(this.refreshSharedWithColumnContentData)},this.handleShowUpdatedMembers=(e,t)=>{this.isMemberAccessLevelQualified(t)?this.showParentFolderAccessModal("update",e,t):G.Snackbar.complete(q.intl.formatMessage({id:"x5Je3g",defaultMessage:"Member access updated."}),"sharing-notification")},this.changeRecipientAccess=e=>s.__awaiter(this,void 0,void 0,(function*(){this.dispatch(M.ShareModalActionTypes.CHANGE_RECIPIENT_ACCESS,{newAccess:e}),yield this.validateContacts(this.getSharingInfo().recipientTokens())})),this.changeRecipientMessage=e=>{this.dispatch(M.ShareModalActionTypes.CHANGE_RECIPIENT_MESSAGE,{message:e})},this.changeCreateCommentCheckbox=e=>{this.dispatch(M.ShareModalActionTypes.CHANGE_CREATE_COMMENT_CHECKBOX,{checked:e})},this.enableNamespaceCreation=e=>"ON"===this.getSharingInfo().sharingPrefs().create_edit_folder_link_variant&&this.getContentInfo().isFileFolder()&&"editor"===e&&this.getSharingInfo().fetchMetadataStatus()!==Z.FETCH_METADATA_STATUS.FAIL,this.createNamespaceIfNeeded=e=>{if(!this.enableNamespaceCreation(e))return Promise.resolve({});if(this.sharingInfo.shareFolderPromise())return this.sharingInfo.shareFolderPromise();let t=void 0;return null!=this.sharingInfo.shouldSyncThisFolder()&&(t=this.sharingInfo.shouldSyncThisFolder()?"default":"not_synced"),this.shareFolderSimple(this.getFqPath(),this.sharingInfo.shareAsConfidential(),t)},this.getCreateSharedLinkTTI=e=>Date.now()-e,this.buildExtraFieldForCreateSharedLinkEvents=(e,t,s)=>({is_alpha:!0,access:s,include_ns_creation:e,timing:this.getCreateSharedLinkTTI(t)}),this.createSharedLink=(e,t)=>{const s=Date.now(),n=this.enableNamespaceCreation(e),i=e||"viewer";return this.log(F.TiburonEventName.ClickTibCreateLink),this.log(F.TiburonEventName.AttemptCreateSharedLinkWithSettings,{access:i}),this.dispatch(M.ShareModalActionTypes.CREATE_LINK_REQUEST),"editor"===e?G.Snackbar.sync(q.intl.formatMessage({id:"OvEApa",defaultMessage:"Creating edit link..."}),!1,"sharing-notification",void 0,this.exp_getUpsellSnackbarProps(se.copy)):G.Snackbar.sync(q.intl.formatMessage({id:"8PPImn",defaultMessage:"Creating view link..."}),!1,"sharing-notification",void 0,this.exp_getUpsellSnackbarProps(se.copy)),this.createNamespaceIfNeeded(e).catch(e=>(this.reportCreatingNamespaceError(e),this.log(F.TiburonEventName.FailCreateSharedLinkWithSettings,Object.assign({http_status_code:e.raw&&e.raw.status,error_tag:e.error&&e.error[".tag"]||"undefined_error",error_summary:e&&e.summary,fail_at:"ns_creation"},this.buildExtraFieldForCreateSharedLinkEvents(n,s,i))),this.dispatch(M.ShareModalActionTypes.CREATE_LINK_FAILURE),Promise.reject(e))).then(()=>{const r={};e&&(r.access=e),t&&(r.audience=t);const o=this.getContentInfo(),l=o.fileId()||o.displayPath();return this.client.createSharedLink({fileIdOrPath:l,settings:r}).then(t=>{this.dispatch(M.ShareModalActionTypes.CREATE_LINK_SUCCESS,{linkMetadata:t}),this.refreshSharedWithColumnLinkData(),this.log(F.TiburonEventName.SucceedCreateSharedLinkWithSettings,Object.assign(Object.assign({http_status_code:200,response_status:"success"},this.buildExtraFieldForCreateSharedLinkEvents(n,s,i)),z.buildExtraFromLinkMetadata(t))),"editor"===e?G.Snackbar.complete(q.intl.formatMessage({id:"JtONmB",defaultMessage:"Edit link created."}),"sharing-notification",void 0,this.exp_getUpsellSnackbarProps(se.copy)):G.Snackbar.complete(q.intl.formatMessage({id:"ufl8ka",defaultMessage:"View link created."}),"sharing-notification",void 0,this.exp_getUpsellSnackbarProps(se.copy))}).catch(a.catchApiError(e=>(e instanceof a.AppError&&e.error&&"access_denied"===e.error[".tag"]?this.getContentInfo().isFolder()?D.sharingNotificationError(q.intl.formatMessage({id:"/ivxG2",defaultMessage:"You don’t have permission to create a link to this folder"})):D.sharingNotificationError(q.intl.formatMessage({id:"p1EB+W",defaultMessage:"You don’t have permission to create a link to this file"})):this.showStandardError(e),e.error&&"shared_link_already_exists"===e.error[".tag"]?this.log(F.TiburonEventName.SucceedCreateSharedLinkWithSettings,Object.assign({http_status_code:e.raw&&e.raw.status,response_status:"success"},this.buildExtraFieldForCreateSharedLinkEvents(n,s,i))):this.log(F.TiburonEventName.FailCreateSharedLinkWithSettings,Object.assign({http_status_code:e.raw&&e.raw.status,error_tag:e.error&&e.error[".tag"]||"undefined_error",error_summary:e&&e.summary,fail_at:"link_creation"},this.buildExtraFieldForCreateSharedLinkEvents(n,s,i))),this.dispatch(M.ShareModalActionTypes.CREATE_LINK_FAILURE),Promise.reject(e))))})},this.fetchMetadataForFile=e=>C.SharingActions.loadFileMetadata({user:this.user,contentId:e.id,sourceUrl:e.url(),client:this.client}).catch(a.catchApiError(t=>{this.handleLoadingError(t,e)})),this.fetchMetadataForFileFolder=e=>{const t=g.MEMBER_ACTION.ALL,n=g.VALIDATE_PATH_PERMISSIONS_CONFIDENTIAL_AWARE,i={actions:Object.keys(n),listMembersArg:{actions:t},shouldParseMetadataFromError:!0};let r,o;const l=!!this.sharingInfo.isNonUserRelativeContext();return l&&!this.user.is_cdm_member?(r=e=>s.__awaiter(this,void 0,void 0,(function*(){const t=this.contentManagerValidateFolderPath(e);return this.client.validatePathContinue(t,!1)})),o={nsId:e.nsId(),nsPath:e.nsPath()}):(r=this.client.validateFqPath,o={fqPath:e.displayPath(),shareAsConfidential:this.sharingInfo.shareAsConfidential()}),r(Object.assign(Object.assign({},o),i)).then(({metadata:e,inheritedMembers:t})=>{this.handleGetMetadataSuccess(e);const s=this.getContentInfo();this.listMembers({contentId:s.id,url:s.url(),members:s.isFileFolder()&&t||void 0,isNonUserRelativeContext:l})}).catch(a.catchApiError(t=>{this.handleLoadingError(t,e)}))},this.fetchMetadataForSharedFolder=e=>this.client.getMetadata({contentId:e.id,isInSharedFolder:e.isInSharedFolder(),actions:Object.keys(g.ALPHA_FOLDER_METADATA_PERMISSIONS)}).then(this.handleGetMetadataSuccess).catch(a.catchApiError(t=>{this.handleLoadingError(t,e)})),this.handleSetConfidentialClick=(e,t)=>{u.Modal.showInstance(n.default.createElement(U.SetInheritedMembersUIConfidentialModal,{actionHandler:this,initialIsConfidentialFolder:e,contentInfo:this.getContentInfo(),teamName:t,onCancel:this.openShareModal,userId:this.user.id}))},this.handleInheritedMemberAccessChange=(e,t,s,i)=>{const a=this.getContentInfo(),r=this.getSharingInfo();u.Modal.showInstance(n.default.createElement(U.SingleInheritedUserAccessChangeModal,{actionHandler:this,member:e,teamName:t,userId:this.user.id,isSharedFolder:a.isSharedFolder(),parentFolderName:r.parentFolderName(),currentFolderName:r.name(),isUserSelf:e.memberId()===this.user.account_id,isDowngrading:s,newAccessLevel:i}))},this.handleMemberAccessChange=(e,t)=>{const s=e.displayName();if(t===g.MEMBER_ACTION.REMOVE||t===w.ACCESS_LEVEL.OWNER){const n=t===g.MEMBER_ACTION.REMOVE&&e.memberId()===this.user.account_id,i=this.getContentInfo().isFolder(),a=this.getContentInfo().isNestedSharedFolder(),r=e.permissions.leave_a_copy&&e.permissions.leave_a_copy.allow,o=s=>{this.changeAccess(e,t,!0===s)},l=this.openManageAccessModal,d=()=>{u.Modal.close(void 0,y.CONFIRM_WITH_OPTION_MODAL_ID)},c=this.getSharingInfo().parentFolderName(),h=this.getSharingInfo().isConfidentialFolder(),p=e.type()===I.MembershipType.GROUPS,m=this.getSharingInfo().isNonUserRelativeContext(),_=this.getSharingInfo().isFolderInsideTeamFolderTree(),f=t===g.MEMBER_ACTION.REMOVE&&e.is_inherited;n?T.showRelinquishMembershipConfirmationModal(i,a,o,l,r,h):f&&i&&!_?this.changeAccess(e,t):y.showMemberAccessChangeConfirmationModal(s,t,i,a,r,o,d,h,m,c,p)}else this.changeAccess(e,t)},this.handleGetMetadataSuccess=e=>{this.dispatch(M.ShareModalActionTypes.FETCH_METADATA_SUCCESS,{metadata:e}),h.Dispatcher.dispatch({type:N.SharePageActionTypes.FETCH_METADATA_SUCCESS,metadata:e,user:this.user})},this.handleLinkSettingsClick=(e={isLinkOnly:!0,linkAccessLevel:"viewer"})=>{i.TeamsWebActionsLogger.log("open_link_settings_modal");let t=O.VIEW_LINK_SETTINGS,s=void 0;"editor"===e.linkAccessLevel&&(t=O.EDIT_LINK_SETTINGS),this.log(F.TiburonEventName.OpenLinkSettingsModal,{settings_tab:t}),e.isLinkOnly||(s=this.sharingInfo.isFolder()?this.sharingInfo.folderPolicy():this.sharingInfo.filePolicy()),u.Modal.showInstance(n.default.createElement(k.SharingSettingsModal,{actionHandler:this,sharingInfo:this.sharingInfo,sharingPrefs:this.sharingInfo.sharingPrefs(),client:this.client,currentTab:t,currentPolicy:s,folderName:this.sharingInfo.name(),isFolder:this.sharingInfo.isFolder(),isSharedFolder:this.getContentInfo().isSharedFolder(),isFolderInsideTeamFolderTree:this.sharingInfo.isFolderInsideTeamFolderTree(),isInContentManager:this.getSharingInfo().isNonUserRelativeContext(),isTeamSharedFolder:this.sharingInfo.isTeamSharedFolder(),isUserOnOwnerTeam:this.sharingInfo.isUserOnOwnerTeam(),linkMetadata:this.sharingInfo.linkMetadata(),onDismiss:()=>u.Modal.close(),permissions:this.sharingInfo.permissions(),ownerTeam:this.sharingInfo.ownerTeam(),user:this.user}))},this.handleLoadingError=(e,t)=>{var s,n,i;if(e instanceof a.AppError){if("not_a_member"===(null===(s=e.error)||void 0===s?void 0:s[".tag"])||"no_access"===(null===(n=e.error)||void 0===n?void 0:n[".tag"]))D.sharingNotificationError(q.intl.formatMessage({id:"O4CWz2",defaultMessage:"You don’t have permission to share this folder"})),u.Modal.close();else if("invalid_id"===(null===(i=e.error)||void 0===i?void 0:i[".tag"]))D.sharingNotificationError(q.intl.formatMessage({id:"4GGEvb",defaultMessage:"This folder can’t be shared"})),u.Modal.close();else if(e.error&&e.error.too_many_mounts&&t.isFolder()&&!t.extras.exists){const t="/help/9259";e.error.too_many_mounts[".tag"]===ee.NS_LIMIT_ERROR.TOTAL_MOUNTS_EXCEEDED?D.failSnackbarWithHelpCenter(x.totalMountsExceededFailSnackbarMsg(e),t):e.error.too_many_mounts[".tag"]===ee.NS_LIMIT_ERROR.HOME_MOUNTS_EXCEEDED?D.failSnackbarWithHelpCenter(x.homeMountsExceededFailSnackbarMsg(e),t):e.error.too_many_mounts[".tag"]===ee.NS_LIMIT_ERROR.TREE_SIZE_EXCEEDED&&D.failSnackbarWithHelpCenter(x.treeSizeExceededFailSnackbarMsg(e),t),u.Modal.close()}const a=e.error&&e.error.bad_path&&e.error.bad_path[".tag"],r=e.error&&e.error.too_many_mounts&&e.error.too_many_mounts[".tag"];this.dispatch(M.ShareModalActionTypes.FETCH_METADATA_FAILURE,{reason:a||r,countExceedNsLimit:r&&x.getExceededCountInfo(e)})}else this.showStandardError(e),u.Modal.close()},this.handleSetConfidential=(e,t=!1)=>{const s=this.getContentInfo(),n=s.isSharedFolder()?s.sharedFolderId().toString():void 0,i=e=>(this.handleGetMetadataSuccess(e),e),r=(e,t,s)=>this.client.setConfidentiality({contentId:e,confidential:t,keepInheritedMembers:s}).then(i);return n?r(n,e,t):this.client.share({fqPath:this.getFqPath(),confidential:e}).then(i).catch(s=>{if(s instanceof a.AppError&&s.error&&s.error.bad_path&&"already_shared"===s.error.bad_path[".tag"]){const n=v.folderMetadataApiToRecord(s.error.bad_path);this.handleGetMetadataSuccess(n);const i=this.getContentInfo().sharedFolderId();return r(i.toString(),e,t)}return Promise.reject(s)})},this.openSharingQuestionnaire=(e=K.SHARE_SCREEN,t)=>{const s=this.getSharingInfo(),n=s.getShowSharingQuestionnaire();if(n){u.Modal.close();const i=s.user();n(({file:s})=>({file:s,user:i,sharingQuestionnaireId:Y.SharingQuestionnaireId.BTS_M1,variant:Q.getFileBtsM1Variant(s),onAbort:()=>{this.showScreen(e,t)},entryPoint:Y.SharingQuestionnaireEntryPoints.SHARE_MODAL_FOOTER}))}},this.openShareModal=()=>{u.Modal.showInstance(te(this.shareModalClass,{actionHandler:this}))},this.openSharingSettingsModal=e=>{u.Modal.showInstance(te(this.shareModalClass,{actionHandler:this,initialScreen:K.SETTINGS_SCREEN,initialCurrentTab:e}))},this.showScreen=(e,t)=>{switch(e){case K.SHARE_SCREEN:this.openShareModal();break;case K.SETTINGS_SCREEN:{const e=this.getSharingInfo().isFolder()?O.FOLDER_SETTINGS:O.FILE_SETTINGS,s=t||e;this.openSharingSettingsModal(s);break}case K.MANAGE_SCREEN:this.openManageAccessModal();break;default:this.openShareModal()}},this.openManageAccessModal=()=>{u.Modal.showInstance(te(this.shareModalClass,{actionHandler:this,initialScreen:K.MANAGE_SCREEN}))},this.recipientsChange=(e,t="")=>Promise.resolve({}).then(()=>this.dispatch(M.ShareModalActionTypes.CHANGE_RECIPIENTS,{recipientTokens:e,recipientRawInput:t})).then(()=>this.validateContacts(e)),this.redirectToPath=(t,n)=>{if(null!=this.setUrl&&this.getSharingInfo().getInitialProps().content&&this.getSharingInfo().fqPath()){const i=t=>{n&&new Promise((t,s)=>{e(["modules/clean/sharing/share_modal_util"],t,s)}).then(s.__importStar).then(({showShareModal:e})=>e(this.user,t,{origin:g.SHARE_ACTION_ORIGIN_TYPE.PARENT_FOLDER_MODAL},this.setUrl))};t!==this.getSharingInfo().fqPath()?(this.setUrl({path:t,qargs:{share:!0}}),j.reload()):i(this.getSharingInfo().getInitialProps().content)}else{const e=r.browse_uri_for_fq_path(this.user,t);n&&e.updateQuery({shareoptions:"1"}),j.redirect(e.toString())}},this.refreshSharedWithColumnContentData=()=>{this.getContentInfo().isFolder()?h.Dispatcher.dispatch({type:p.SharedWithActionType.SIGNAL_SHARED_FOLDER_DATA_OUT_OF_DATE,data:{}}):h.Dispatcher.dispatch({type:p.SharedWithActionType.SIGNAL_SHARED_FILE_DATA_OUT_OF_DATE,data:{fileIds:[this.getContentInfo().id]}})},this.handleShareClick=e=>this.sharingInfo.contentInfo().pathExists()?this.sendShare(e):this.setContentNameAndSendShare(e),this.shareIfFileFolder=(e,t)=>{if(this.getSharingInfo().shouldCloseImmediately()?u.Modal.close():G.Snackbar.sync(e,!0,"sharing-notification",void 0,this.exp_getUpsellSnackbarProps(se.share)),!this.getContentInfo().isFileFolder())return Promise.resolve({});if(this.sharingInfo.shareFolderPromise())return this.sharingInfo.shareFolderPromise();let s=void 0;return null!=this.sharingInfo.shouldSyncThisFolder()&&(s=this.sharingInfo.shouldSyncThisFolder()?"default":"not_synced"),this.shareFolderSimple(this.getFqPath(),this.sharingInfo.shareAsConfidential(),s,t)},this.reportCreatingNamespaceError=e=>{e instanceof a.RateLimitError?G.Snackbar.fail(q.intl.formatMessage({id:"+v688d",defaultMessage:"Folder updates in progress. Try again in a few minutes."}),"sharing-notification"):e instanceof a.AppError&&"too_many_files"===e.error[".tag"]?G.Snackbar.fail(q.intl.formatMessage({id:"XIuX+L",defaultMessage:"Couldn’t create link. Too many files in this folder."}),"sharing-notification"):x.isTotalMountsExceededError(e)?D.failSnackbarWithHelpCenter(x.totalMountsExceededFailSnackbarMsg(e),"/support"):x.isTreeSizeExceededError(e)?D.failSnackbarWithHelpCenter(x.treeSizeExceededFailSnackbarMsg(e),"/support"):x.isHomeMountsExceededError(e)?D.failSnackbarWithHelpCenter(x.homeMountsExceededFailSnackbarMsg(e),"/support"):G.Snackbar.fail(q.intl.formatMessage({id:"15YAHw",defaultMessage:"There was a problem completing this request."}),"sharing-notification")},this.reportShareFailure=e=>{e instanceof a.RateLimitError?D.failSnackbarWithHelpCenter(q.intl.formatMessage({id:"/sRvdA",defaultMessage:"Folder updates in progress — please try again later."}),"/help/9259"):e instanceof a.AppError&&"too_many_files"===e.error[".tag"]?D.failSnackbarWithHelpCenter(q.intl.formatMessage({id:"Js1Gcw",defaultMessage:"Couldn’t share. If this folder has a lot of files, try sharing fewer files."}),"/support",x.getContactSupportMessage()):e instanceof a.AppError&&"internal_error"===e.error[".tag"]?D.failSnackbarWithHelpCenter(q.intl.formatMessage({id:"7/f5Vp",defaultMessage:"Couldn’t share, but it might work if you reload the page and try again."}),"/support",x.getContactSupportMessage()):x.isTotalMountsExceededError(e)?D.failSnackbarWithHelpCenter(x.totalMountsExceededFailSnackbarMsg(e),"/support"):x.isTreeSizeExceededError(e)?D.failSnackbarWithHelpCenter(x.treeSizeExceededFailSnackbarMsg(e),"/support"):x.isHomeMountsExceededError(e)?D.failSnackbarWithHelpCenter(x.homeMountsExceededFailSnackbarMsg(e),"/support"):G.Snackbar.fail(x.convertIfHTML(x.genAddMemberErrorMessage(e)),"sharing-notification")},this.showParentFolderAccessModalIfQualified=(e,t,s)=>{this.isMemberAccessLevelQualified(s)&&this.showParentFolderAccessModal(e,t,s)},this.showParentFolderAccessModal=(e,t,s)=>{this.log(F.TiburonEventName.OpenParentFolderAccessModal,{num_parent_folders:s.parentFolders&&s.parentFolders.length||0}),u.Modal.showInstance(n.default.createElement(A.ParentFolderAccessModal,{contentInfo:this.getContentInfo(),memberAccessLevelResult:s,memberDisplayName:t.displayName()||"",originalAction:e,isInContentManager:this.sharingInfo.isNonUserRelativeContext(),onClose:this.openShareModal,onParentFolderClicked:this.redirectToPath}))},this.parseParentFolderAccessError=e=>{let t=e.error;if("member_error"===e.error[".tag"]&&(t=e.error.member_error),"no_explicit_access"===t[".tag"])return v.memberAccessLevelApiToRecord(this.user.id,t);this.showStandardError(e)},this.changeLinkAudienceSelection=(e,t)=>{this.dispatch(M.ShareModalActionTypes.CHANGE_LINK_AUDIENCE_SELECTION,{accessLevel:e,audience:t})},this.removeLinkAudienceSelection=e=>{this.dispatch(M.ShareModalActionTypes.REMOVE_LINK_AUDIENCE_SELECTION,{accessLevel:e})},this.updateLinkAudience=(e,t)=>{const s=E.getLinkPolicy(e).set("audience",t),n=E.getLinkPolicy(e),i=E.getModifiedSettings(e,s,n);return i&&i.settings?(this.log(F.TiburonEventName.ChangeSharedLinkAudience,Object.assign({old_audience:n.audience,new_audience:t,screen:R.ScreenName.ShareScreen},z.buildExtraFromLinkMetadata(e))),this.updateLinkSettings([i])):Promise.reject(`Error getting modified settings for audience ${t}`)},this.updateLinkSettings=e=>Promise.all(e.map(e=>this.client.modifySharedLinkSettings(e))).then(e=>{D.sharingNotificationSuccess(q.intl.formatMessage({id:"8TOykk",defaultMessage:"Settings saved."}));const t=[];for(const s of this.sharingInfo.sharedLinks()){const n=e.find(e=>(s.link_permissions.link_access_level||"viewer")===(e.link_permissions.link_access_level||"viewer"));t.push(n||s)}this.setSharedLinks(t),this.refreshSharedWithColumnLinkData()}).catch(()=>(D.sharingNotificationError(q.intl.formatMessage({id:"bLA3rA",defaultMessage:"There was a problem completing this request."})),Promise.reject())),this.waitForAllMembersLoaded=()=>{if(this.sharingInfo.areMembersFullyLoaded())return Promise.resolve({});const e=this.sharingInfo.fetchingMembersRequest();return e&&e.promise||Promise.resolve({})},this.onPageNavigationAttempt=e=>{if(t.incompleteInbandShare.size>0)return this.log(F.TiburonEventName.AttemptNavigateAwayDuringShare),e.preventDefault(),e.returnValue="",""},this.onPageNavigationAway=e=>{t.incompleteInbandShare.size>0&&this.log(F.TiburonEventName.SucceedNavigateAwayDuringShare)},this.client=o,this.asyncContactValidator=new W.AsyncContactValidator(this.client),this.user=l,this.shareModalClass=d,this.setUrl=c||null,this.contentManagerValidateFolderPath=m,this.openSettingsFromTheExternalSharePageQuickActions=_}initializeShareModal(e,t={}){const s=e.contentInfo;return h.Dispatcher.dispatch({type:M.ShareModalActionTypes.SHARE_MODAL_OPEN,data:{initialProps:t,shareModalInfoAttrs:e},contentIds:P.getContentIdsForContentInfo(s),user:this.user}),this.sharingInfo=L.sharingInfoStore.getSharingInfo(this.user.id,s.id),this.fetchInitialData()}fetchDataAndShowShareModal(){this.fetchInitialData(),this.openShareModal()}fetchInitialData(){const e=this.sharingInfo.contentInfo(),t=this.sharingInfo.isNonUserRelativeContext();this.beginTime=Date.now(),this.fetchPassInfo();const s=[];return e.isFileFolder()?s.push(this.fetchMetadataForFileFolder(e)):(s.push(this.listMembers({contentId:e.id,url:e.url(),isNonUserRelativeContext:t})),e.isFile()?s.push(this.fetchMetadataForFile(e)):e.isSharedFolder()&&s.push(this.fetchMetadataForSharedFolder(e))),s.push(this.fetchMemberCounts()),s.push(this.fetchCurrentAccount()),s.push(this.fetchSharingPrefs()),this.sharingInfo.shouldFetchLinkMetadata()&&s.push(this.fetchLinkMetadata()),Promise.all(s)}fetchPassInfo(){this.sharingInfo.shouldBlockMemberListOnPassLoad()&&setTimeout(()=>this.dispatch(M.ShareModalActionTypes.UNBLOCK_MEMBER_LIST_ON_PASS_LOAD),4e3);const{shouldFetchPass:e,fileId:t}=this.getPassFetchingInfo();if(!e||!t)return;this.clearCachedPassInfo();const s=S.passStore.passFetchingStatus(t);if(_.fetchingStatusIsSuccessful(s)){const{groupSeenStateInfo:e,linkSeenStateInfo:s}=S.passStore.getLinkAndGroupSeenStateInfo(t);this.groupSeenStateInfo=e,this.linkSeenStateInfo=s,this.presentAccountIds=S.passStore.presence(t)}else s===_.PassFetchingStatus.NOT_YET_KNOWN&&f.PassHelpers.setup({user:this.user,fileData:this.getFileData(),prevFileData:null,shouldWritePresence:!1,skipSharingEndpoints:!0})}getAsyncContactValidator(){return this.asyncContactValidator}getSharingInfo(){return this.sharingInfo}clearCachedPassInfo(){[this.groupSeenStateInfo,this.linkSeenStateInfo,this.presentAccountIds]=[null,null,null]}getPassInfo(){const e=this.getContentInfo();if(e.isFolder())return{groupSeenStateInfo:{},linkSeenStateInfo:[],presentAccountIds:[],passFetchingStatus:_.PassFetchingStatus.ERROR};if(this.groupSeenStateInfo&&this.linkSeenStateInfo&&this.presentAccountIds)return{groupSeenStateInfo:this.groupSeenStateInfo,linkSeenStateInfo:this.linkSeenStateInfo,presentAccountIds:this.presentAccountIds,passFetchingStatus:_.PassFetchingStatus.PASS_SUCCESS};{const t=this.getPassFetchingInfo().fileId;if(!t)return[this.groupSeenStateInfo,this.presentAccountIds]=[{},[],[]],{groupSeenStateInfo:{},linkSeenStateInfo:[],presentAccountIds:[],passFetchingStatus:_.PassFetchingStatus.ERROR};const s=S.passStore.getPassPermissions(t),n=S.passStore.passFetchingStatus(t);if(!_.fetchingStatusIsComplete(n))return{groupSeenStateInfo:{},linkSeenStateInfo:[],presentAccountIds:[],passFetchingStatus:_.PassFetchingStatus.FETCHING};if(null==s||!s.canReadPresence)return{groupSeenStateInfo:{},linkSeenStateInfo:[],presentAccountIds:[],passFetchingStatus:_.PassFetchingStatus.ERROR};const{linkSeenStateInfo:i,groupSeenStateInfo:a}=S.passStore.getLinkAndGroupSeenStateInfo(t);return this.linkSeenStateInfo=i,this.groupSeenStateInfo=a,this.presentAccountIds=[...S.passStore.presence(t)||[]],this.isContentInfoForFilePreview(e)&&this.presentAccountIds.indexOf(this.user.account_id)<0&&this.presentAccountIds.push(this.user.account_id),{groupSeenStateInfo:this.groupSeenStateInfo,linkSeenStateInfo:this.linkSeenStateInfo,presentAccountIds:this.presentAccountIds,passFetchingStatus:n}}}getPassFetchingInfo(){const e=this.getContentInfo();if(e.extras.origin&&["BROWSE_FILE_ACTIONS","BROWSE_FILE_FACEPILE","BROWSE_FILE_ROW","PREVIEW_PAGE","PREVIEW_PAGE_FACEPILE","PAPER_INTEGRATION","GOOGLE_DSS"].indexOf(e.extras.origin)>=0&&e.isFile()){const{fileId:t}=e.extras,s=this.isContentInfoForFilePreview(e);return{shouldFetchPass:!!t&&!s&&e.isFile(),fileId:t}}return{shouldFetchPass:!1}}getUrl(){const e=this.sharingInfo.linkMetadata();return e?e.url:void 0}getFileData(e){const{fileId:t=null}=this.getPassFetchingInfo();return{file:{file_id:t},url:e}}getContentInfo(){return this.sharingInfo.contentInfo()}getOpenSettingsFromTheExternalSharePageQuickActions(){return this.openSettingsFromTheExternalSharePageQuickActions}dispatch(e,t={}){h.Dispatcher.dispatch({type:e,data:t,contentIds:[this.getContentInfo().id],user:this.user})}changeMemberAccessSimple(e,t,s){return this.client.updateMember({contentId:e,memberId:t,accessLevel:s})}changeMemberAccess(e,t,s){const n=t.access_type;return this.log(F.TiburonEventName.SelectChangeMemberPermission,{new_access:s,old_access:n}),this.dispatch(M.ShareModalActionTypes.CHANGE_MEMBER_ACCESS_REQUEST,{member:t,newAccess:s}),this.changeMemberAccessSimple(e,t.memberId(),s).then(e=>{if(this.log(F.TiburonEventName.SucceedChangeMemberPermission,{http_status_code:200,response_status:"success",is_alpha:!1}),e.access_level&&e.warning)return this.dispatch(M.ShareModalActionTypes.CHANGE_MEMBER_ACCESS_FAILURE,{member:t,prevAccess:e.access_level}),e}).catch(a.catchApiError(e=>{const s=e.error&&e.error[".tag"];return this.log(F.TiburonEventName.FailChangeMemberPermission,{http_status_code:e.raw&&e.raw.status,error_tag:s||"undefined",is_alpha:!1}),this.dispatch(M.ShareModalActionTypes.CHANGE_MEMBER_ACCESS_FAILURE,{member:t,prevAccess:n}),this.parseParentFolderAccessError(e)}))}_constructSearchResults(e){return e.map(e=>{if("group_id"in e)return new o.Contact({type:l.default.NEW_STYLE_GROUP,group_id:e.group_id,name:e.name,members:e.members,on_team:e.dbx_team_id===this.user.team_dbtid,group_size:e.group_size});if("dbx_account_id"in e)return new o.Contact({type:l.default.EMAIL,dbx_account_id:e.dbx_account_id,dbx_team_id:e.dbx_team_id,name:e.name,email:e.email,photo_url:e.photo_url,on_team:e.dbx_team_id===this.user.team_dbtid});throw new Error("Could not parse contact result.")})}suggestTargets(e,t){return this.client.targetsSearch(e,t).then(e=>{this.log(F.TiburonEventName.AttemptTargetSearch);const t=this._constructSearchResults(e.entries);return this.log(F.TiburonEventName.SucceedTargetSearch),t}).catch(a.catchApiError(e=>{t&&t.aborted||(this.log(F.TiburonEventName.AttemptTargetSearch),this.log(F.TiburonEventName.FailTargetSearch,{error:e.message}),this.showStandardError(e))})).catch(e=>{this.log(F.TiburonEventName.FailTargetSearch,{error:e.message})})}validateContacts(e){return s.__awaiter(this,void 0,void 0,(function*(){return yield this._validateContacts(e,!1)}))}resetContactValidations(){return s.__awaiter(this,void 0,void 0,(function*(){return yield this._validateContacts(this.getSharingInfo().recipientTokens(),!0)}))}_validateContacts(e,t=!1){return s.__awaiter(this,void 0,void 0,(function*(){const s=this.getSharingInfo(),n=s.recipientAccess(),i=s.recipientValidation()[n]||{},a=t?e:e.filter(e=>!i[e.getKey()]);if(0===a.length)return;let r={};if(s.sharingPrefs().in_server_side_contact_validation_settings){const e=s.contentInfo(),t=e.isFileFolder()?this.getFqPath():String(e.id);r=yield this.getAsyncContactValidator().validate(this.user.id,t,e,s.recipientAccess(),a)}else r=this.localValidation(a);this.dispatch(M.ShareModalActionTypes.UPDATE_RECIPIENT_VALIDATION,{recipientValidation:{[n]:r},resetCurrentValidations:t})}))}localValidation(e){const t=this.getSharingInfo(),s={};return e.forEach(e=>s[e.getKey()]=x.validateContact(e,this.user,t.ownerTeam(),t.folderPolicy(),t.isTeamSharedFolder(),t.isFolderInsideTeamFolderTree(),t.memberCountWithRecipients())),s}fetchLinkMetadata(){return"/"!==this.getContentInfo().displayPath()?(this.dispatch(M.ShareModalActionTypes.FETCH_LINK_METADATA_REQUEST),this.client.sharedLinkInfo({fileIdOrPath:this.getContentInfo().idForLink()}).then(e=>{this.dispatch(M.ShareModalActionTypes.FETCH_LINK_METADATA_SUCCESS,{sharedLinks:e})}).catch(()=>{this.dispatch(M.ShareModalActionTypes.FETCH_LINK_METADATA_FAILURE),this.isContentInfoForPaper(this.getContentInfo())||this.sharingInfo.isNonUserRelativeContext()||(this.showStandardError(),u.Modal.close())})):Promise.resolve({})}fetchMemberCounts(){const e=this.getContentInfo();return e.isFile()?C.SharingActions.fetchFileMemberCount({user:this.user,contentId:e.id,limit:g.FETCH_FILE_MEMBER_COUNT_LIMIT}):e.isSharedFolder()||e.isFolder()&&e.isInSharedFolder()?C.SharingActions.fetchFolderMemberCount({user:this.user,contentId:e.isSharedFolder()?e.sharedFolderId():e.nsId(),client:this.client}):Promise.resolve({})}fetchSharingPrefs(){return this.dispatch(M.ShareModalActionTypes.FETCH_SHARING_PREFS_REQUEST),this.client.getSharingPrefs().then(e=>{this.dispatch(M.ShareModalActionTypes.FETCH_SHARING_PREFS_SUCCESS,{sharingPrefs:e})})}setSeenUpsellCounterPref(e){return this.dispatch(M.ShareModalActionTypes.SET_UPSELL_COUNTER_PREF),this.client.setSharingPrefs({has_seen_share_modal_upsell_premium_sharing_counter:e}).then(()=>{this.dispatch(M.ShareModalActionTypes.SET_UPSELL_COUNTER_PREF_SUCCESS)})}setHasSeenPostSharingEsignPref(){return this.client.setSharingPrefs({has_seen_esign_post_sharing:!0})}setLastSeenPostSharingEsignTsPref(){return this.client.setSharingPrefs({is_in_esign_post_sharing_exclusion_period:!0})}onShareModalUnmount(e){this.teardownPass();const t=e&&e.serializeInputData()||{};this.dispatch(M.ShareModalActionTypes.SHARE_MODAL_CLOSE,t);const s=this.getSharingInfo().getInitialProps();s.onClose&&s.onClose()}fetchCurrentAccount(){return this.dispatch(M.ShareModalActionTypes.FETCH_CURRENT_ACCOUNT_REQUEST),this.client.getCurrentAccountCached().then(e=>{this.dispatch(M.ShareModalActionTypes.FETCH_CURRENT_ACCOUNT_SUCCESS,{teamPolicy:e.team&&e.team.sharing_policies,isFamilyUser:e.is_family_user})})}handleContentNameChange(e){const t="SIMPLIFIED_WIZARD_UI::CONTENT_NAME_CHANGE";this.hasLoggedSet[t]||(this.sharingExperimentsLog(t),this.hasLoggedSet[t]=!0),this.dispatch(M.ShareModalActionTypes.HANDLE_CONTENT_NAME_CHANGE,{name:e})}handleUpdateFilePolicy(e,t){this.handleUpdateSharingSettings(e);const s=this.getSharingInfo().filePolicy(),{fileId:n}=this.getPassFetchingInfo();if(n)if(s.viewer_info_policy===I.ViewerInfoPolicy.disabled&&t.viewer_info_policy===I.ViewerInfoPolicy.enabled)this.clearCachedPassInfo(),m.PassActions.resetPassInfo(n),m.PassActions.fetchPassError(n),this.dispatch(M.ShareModalActionTypes.CLEAR_FILE_MEMBERSHIP_LAST_SEEN_INFO);else{const e=s.audience===I.LinkAudience.members!=(t.audience===I.LinkAudience.members),i=s.viewer_info_policy===I.ViewerInfoPolicy.enabled&&t.viewer_info_policy===I.ViewerInfoPolicy.disabled;if(e||i){this.clearCachedPassInfo();const e=this.getUrl();i&&this.listMembers({contentId:n,url:e,isNonUserRelativeContext:this.sharingInfo.isNonUserRelativeContext()});const t=this.isContentInfoForFilePreview(this.getContentInfo());f.PassHelpers.setup({user:this.user,fileData:this.getFileData(e),prevFileData:null,shouldWritePresence:t,skipSharingEndpoints:!0})}}}handleUpdateSharingSettings(e){this.dispatch(M.ShareModalActionTypes.UPDATE_SHARING_SETTINGS_SUCCESS,{metadata:e})}listMembers({contentId:e,url:t,members:s,isNonUserRelativeContext:n=!1}){return C.SharingActions.listMembers({user:this.user,contentId:e,isFolder:this.sharingInfo.isFolder(),url:t,members:s,client:this.client,isNonUserRelativeContext:n})}addMembers(e,t,s=!1,n){const i=e.map(e=>({member:v.createUnionScalar(e.contactType(),e.contactId()),access_level:v.accessLevelConstToApi(e.access_type)}));return this.client.addMembersWithAccessLevel({contentId:t,members:i,customMessage:n,quiet:s})}isContentInfoForFilePreview(e){return("PREVIEW_PAGE"===e.extras.origin||"PREVIEW_PAGE_FACEPILE"===e.extras.origin)&&!e.isFolder()}isContentInfoForPaper(e){return e.extras&&"PAPER_INTEGRATION"===e.extras.origin}log(e,t={}){x.logTiburonEvent(this.getContentInfo(),this.user.id,e,t)}logIfHaventBefore(e,t={},s=!0){this.hasLoggedSet[e]||(this.hasLoggedSet[e]=!0,s&&(t.timing=Date.now()-this.beginTime),this.log(e,t))}onClickX(e){e&&e.finishLogging(!0),u.Modal.close()}redirectToBrowseUrl(e){if(null!=this.setUrl)this.setUrl({path:e});else{const t=r.browse_uri_for_fq_path(this.user,e);j.redirect(t.toString())}}redirectToUpgrade(){j.redirect("/upgrade?oqa=spw")}refreshSharedWithColumnLinkData(){h.Dispatcher.dispatch({type:p.SharedWithActionType.SIGNAL_SHARED_LINK_DATA_OUT_OF_DATE,data:{fileFqPaths:[this.getContentInfo().displayPath()]}})}relinquishMembershipSimple(e,t){return this.client.relinquishMembership({contentId:e,leaveACopy:t}).then(()=>{u.Modal.close(),this.redirectToBrowseUrl("/")})}relinquishMembership(e,t){const s=this.getContentInfo();return this.relinquishMembershipSimple(e,t).then(()=>{s.isFolder()?D.sharingNotificationSuccess(q.intl.formatMessage({id:"CD+ZYc",defaultMessage:"Folder access removed."})):D.sharingNotificationSuccess(q.intl.formatMessage({id:"GTNg67",defaultMessage:"File access removed."}))})}removeMemberSimple(e,t,s){return this.client.removeMember({contentId:e,memberId:t,leaveACopy:s})}removeMember(e,t,s,n){return this.dispatch(M.ShareModalActionTypes.MEMBER_ACTION_PENDING,{member:t}),this.removeMemberSimple(e,t.memberId(),s).then(e=>this.fetchInitialData().then(()=>{if(e&&null!=e.access_level&&null!=e.warning)return this.dispatch(M.ShareModalActionTypes.REMOVE_MEMBER_KEEP_ACCESS,{member:t,access:e.access_level}),e;n?D.sharingNotificationSuccess(q.intl.formatMessage({id:"CD+ZYc",defaultMessage:"Folder access removed."})):D.sharingNotificationSuccess(q.intl.formatMessage({id:"GTNg67",defaultMessage:"File access removed."})),this.dispatch(M.ShareModalActionTypes.REMOVE_MEMBER_SUCCESS,{member:t}),this.fetchMemberCounts()})).catch(a.catchApiError(e=>(this.dispatch(M.ShareModalActionTypes.MEMBER_ACTION_COMPLETE,{member:t}),this.parseParentFolderAccessError(e))))}setContentNameAndSendShare(e){const t=this.sharingInfo.contentNameInputValue(),s=c.parent_dir(this.sharingInfo.fqPath()),n=x.getNewFolderPathFromContentName(t,s);let i=!this.sharingInfo.isNonUserRelativeContext();this.getSharingInfo().shouldSuppressRedirectToBrowse()&&(i=!1);let a=i;return this.getSharingInfo().shouldCloseImmediately()&&(a=!0),new Promise((s,o)=>{new b.SharingApi(this.user).validate_new_sf_path(t,n,()=>{this.dispatch(M.ShareModalActionTypes.VALIDATE_CONTENT_NAME_SUCCESS,{newFolderPath:n}),this.sendShare(e,{keepModalOpen:i,suppressSuccessSnackbar:a}).then(()=>{if(this.sharingInfo.shareAsConfidential()&&B.WebUserActionLog.log(this.user.id,H.WebUserActionLogEvent.CONF_BY_CREATE_CONFIDENTIAL_FOLDER,{ns_id:this.sharingInfo.contentId(),who_has_access:H.WebUserActionLogExtraValue.SPECIFIC_PEOPLE,location:this.sharingInfo.isNonUserRelativeContext()?H.WebUserActionLogExtraValue.CONTENT_MANAGER:H.WebUserActionLogExtraValue.BROWSE}),i){const e=r.browse_uri_for_fq_path(this.user,n);e.updateQuery("show_share_success_snackbar","1"),j.redirect(e.toString())}s()})},e=>{this.sharingExperimentsLog("SIMPLIFIED_WIZARD_UI::INVALID_CONTENT_NAME");const t=V.extractErrors(e.responseText),s=t.folder_name&&t.folder_name.message_text;this.dispatch(M.ShareModalActionTypes.VALIDATE_CONTENT_NAME_ERROR,{errorMsg:s}),o(s)})})}setSharedLinks(e){this.dispatch(M.ShareModalActionTypes.FETCH_LINK_METADATA_SUCCESS,{sharedLinks:e})}deleteLinkMetadata(e){this.dispatch(M.ShareModalActionTypes.DELETE_LINK_METADATA_SUCCESS,{deletedLink:e})}enableImmediateModalClose(e){const{inviteEligibleNotSeenContacts:t}=this.sharingInfo.getEligibleInviteAfterSharingContacts(),s=this.sharingInfo.sharingPrefs().invite_after_sharing_modal_variant;return e||0===t.length||t.length>1&&this.isBasicUserRequestModal(s)||"not_enabled"===s}sendShare(e,s={keepModalOpen:!1,suppressSuccessSnackbar:!1}){const i=this.getSharingInfo().getInitialProps(),r=this.sharingInfo.contentInfo().id;i.onShareClick&&i.onShareClick(this.getSharingInfo().recipientTokens(),this.getSharingInfo().recipientAccess());const o=t.incompleteInbandShare.has(r);this.log(F.TiburonEventName.ClickInbandShareButton,{in_progress:o});const l=Date.now();let h;return this.recipientsChange(e.getContacts()).then(()=>this.validateContacts(this.sharingInfo.recipientTokens())).then(()=>{if(this.sharingInfo.contactsError().level===x.ContactsErrorLevel.Error)return this.log(F.TiburonEventName.FailInbandShare,{error_tag:"contacts_error"}),Promise.reject({});this.enableImmediateModalClose(s.keepModalOpen)&&(u.Modal.close(),this.log(F.TiburonEventName.CloseShareModal,{time_modal_opened:Date.now()-l})),window.addEventListener("beforeunload",this.onPageNavigationAttempt),window.addEventListener("unload",this.onPageNavigationAway),t.incompleteInbandShare.add(r),this.dispatch(M.ShareModalActionTypes.SEND_SHARE_REQUEST),h=v.contactsToMembers(this.sharingInfo.recipientTokens());const e=this.sharingInfo.contentInfo().extras.origin;return e!==g.SHARE_ACTION_ORIGIN_TYPE.BROWSE_GLOBAL_ACTIONS&&e!==g.SHARE_ACTION_ORIGIN_TYPE.WIZARD||B.WebUserActionLog.log(this.user.id,H.WebUserActionLogEvent.NEW_FOLDER_ADD_MEMBER,{num_invites:h.length}),this.shareIfFileFolder(q.intl.formatMessage({id:"lhzBKS",defaultMessage:"Sharing <st>{folder_name}</st>..."},{st:e=>n.default.createElement("strong",null,e),folder_name:d.Emstring.em_snippet(this.sharingInfo.name(),g.SNIPPET_SIZES.FILENAME)}))}).then(()=>this.client.addMembers({accessLevel:this.sharingInfo.recipientAccess(),contentId:this.sharingInfo.contentInfo().id,customMessage:this.sharingInfo.recipientMessage(),members:h,addMessageAsComment:!!this.sharingInfo.recipientMessage()&&this.sharingInfo.isShareMessageAsCommentChecked()&&this.sharingInfo.permissionsObj().canShareMessageAsComment()})).catch(e=>{if(e instanceof a.ApiError){const t=e.error&&e.error[".tag"];this.dispatch(M.ShareModalActionTypes.SEND_SHARE_FAILURE),this.reportShareFailure(e),this.log(F.TiburonEventName.FailInbandShare,{http_status_code:e.raw&&e.raw.status,error_tag:t||"undefined",error_summary:"summary"in e?e.summary:"message"in e?e.message:"undefined",timing:Date.now()-l,num_recipients:h.length})}else this.log(F.TiburonEventName.FailInbandShare,{error_message:e.message});return Promise.reject({})}).then(()=>{this.log(F.TiburonEventName.SucceedInbandShare,{timing:Date.now()-l,num_recipients:h.length}),this.dispatch(M.ShareModalActionTypes.SEND_SHARE_SUCCESS),this.fetchMemberCounts();const e=this.sharingInfo.contentInfo().extras.origin;if(!s.suppressSuccessSnackbar){const t=this.sharingInfo.name(),s=c.file_extension(t);if(["pdf","doc","docx"].includes(s)&&"DSV1"===this.sharingInfo.coreO21nDndMomentPdfWordVariant()||["ppt","pptx","key"].includes(s)&&"DSV1"===this.sharingInfo.coreO21nDndMomentPptKeynoteVariant())D.showInBandShareSuccessDocSendSnackbar(t,this.user.id);else if(this.shouldShowEsignDiscoveryUpsell()){const e=this.sharingInfo.hasSeenEsignPostSharing();e||this.setHasSeenPostSharingEsignPref(),J.showInBandShareSuccessEsignSnackbar(t,D.formatSuccessMessageForFolder(t),this.sharingInfo.fqPath(),this.user.id,Number(this.sharingInfo.contentId()),e,()=>{this.setLastSeenPostSharingEsignTsPref()})}else D.showInBandShareSuccessSnackbar(this.sharingInfo.name(),this.exp_getUpsellSnackbarProps(se.share));x.trackUserLeapEvent(x.SharingUserLeapEvent.SHARE_SUCCESS,e)}if(e!==g.SHARE_ACTION_ORIGIN_TYPE.BROWSE_GLOBAL_ACTIONS&&e!==g.SHARE_ACTION_ORIGIN_TYPE.WIZARD||B.WebUserActionLog.log(this.user.id,H.WebUserActionLogEvent.NEW_SHARED_FOLDER_SUCCESS,{}),i.onSuccessSharing&&i.onSuccessSharing(),this.refreshSharedWithColumnContentData(),this.sharingInfo.showOffTeamSharingSurvey(),!s.keepModalOpen){const{inviteEligibleNotSeenContacts:t,inviteEligibleSeenContacts:s}=this.sharingInfo.getEligibleInviteAfterSharingContacts(),n=this.getSharingInfo().sharingPrefs().invite_after_sharing_modal_variant,i=t.length>0&&(this.isAdminInviteModal(n)||this.isMemberInviteModal(n)),a=this.isBasicUserRequestModal(n)&&1===t.length;if(i||a){u.Modal.close();const i=this.getInviteAfterSharingUsers(t,s);if("admin_invite_expand_eligibility"===n){const t=Date.now();this.loadShowAdminInviteAfterSharingModal().then(s=>{s({eligibleUsers:i,adminModalVariant:n,modalOrigin:e,modalLoadingStartTime:t})})}else if(this.isMemberInviteModal(n)){const t=Date.now();this.loadShowMemberInviteAfterSharingModal().then(s=>{s({eligibleUsers:i,memberModalVariant:n,sharingOrigin:e,modalLoadingStartTime:t})})}else if(this.isBasicUserRequestModal(n)){const e=this.convertContactsToRequestAfterSharingUserEmail(t),s=Date.now();this.loadShowRequestJoinAfterSharingModal().then(t=>{t({receiverEmail:e,modalLoadingStartTime:s})})}}else this.exp_shouldShowFamilyUpsellV1(se.share)?this.exp_showFamilyUpsellModal():u.Modal.close()}return Promise.resolve()}).finally(()=>{t.incompleteInbandShare.delete(r)})}loadShowAdminInviteAfterSharingModal(){return s.__awaiter(this,void 0,void 0,(function*(){const{showAdminInviteAfterSharingModal:t}=yield new Promise((t,s)=>{e(["modules/clean/teams/invite/modals/invite_after_sharing/admin_invite_after_sharing_modal"],t,s)}).then(s.__importStar);return t}))}loadShowMemberInviteAfterSharingModal(){return s.__awaiter(this,void 0,void 0,(function*(){const{showMemberInviteAfterSharingModal:t}=yield new Promise((t,s)=>{e(["modules/clean/teams/invite/modals/invite_after_sharing/member_invite_after_sharing_modal"],t,s)}).then(s.__importStar);return t}))}loadShowRequestJoinAfterSharingModal(){return s.__awaiter(this,void 0,void 0,(function*(){const{showRequestJoinAfterSharingModal:t}=yield new Promise((t,s)=>{e(["modules/clean/teams/invite/modals/invite_after_sharing/request_join_after_sharing_modal"],t,s)}).then(s.__importStar);return t}))}getInviteAfterSharingUsers(e,t){return[...this.convertContactsToInviteAfterSharingUsers(e,!0),...this.convertContactsToInviteAfterSharingUsers(t,!1)]}convertContactsToRequestAfterSharingUserEmail(e){return this.convertContactsToInviteAfterSharingUsers(e,!0)[0].email}convertContactsToInviteAfterSharingUsers(e,t){return e.filter(e=>void 0!==e.email).map(e=>({email:e.email,checkForInvite:t}))}shareFolderSimple(e,t=!1,s,n){const i=e=>{this.dispatch(M.ShareModalActionTypes.SHARE_FOLDER_SUCCESS,{metadata:e}),h.Dispatcher.dispatch({type:N.SharePageActionTypes.FETCH_METADATA_SUCCESS,metadata:e,user:this.user})},r={fqPath:e,confidential:t,syncSetting:s,folderPolicy:n},o=this.client.share(r);return this.dispatch(M.ShareModalActionTypes.SHARE_FOLDER_REQUEST,{promise:o}),o.then(i).catch(e=>{if(e instanceof a.AppError&&e.error&&e.error.bad_path&&"already_shared"===e.error.bad_path[".tag"]){const t=v.folderMetadataApiToRecord(e.error.bad_path);return i(t)}return this.dispatch(M.ShareModalActionTypes.SHARE_FOLDER_FAILURE),Promise.reject(e)})}getFqPath(){let e;return e=this.sharingInfo.isNonUserRelativeContext()&&!this.user.is_cdm_member?`ns:${this.getContentInfo().nsId()}${this.getContentInfo().nsPath()}`:this.getContentInfo().displayPath(),e}isMemberAccessLevelQualified(e){return null!=e}sharingExperimentsLog(e,t={}){const s=this.getContentInfo().extras.modalSessionId;t.modalSessionId=t.modalSessionId||s,i.SharingExperimentsLogger.log(this.user.id,e,t)}teardownPass(){this.clearCachedPassInfo(),this.getPassFetchingInfo().shouldFetchPass&&f.PassHelpers.teardown({user:this.user,fileData:this.getFileData(),async:!0,shouldWritePresence:!1})}showStandardError(e){const t=e&&e.message;D.sharingNotificationError(t||q.intl.formatMessage({id:"+iNJRS",defaultMessage:"There was a problem completing this request."}))}shouldShowEsignDiscoveryUpsell(){return["pdf","doc","docx"].includes(c.file_extension(this.sharingInfo.name()))&&"HSV1"===this.sharingInfo.pgEsignDiscoveryVariant()&&!this.sharingInfo.isInEsignPostSharingExclusionPeriod()}exp_shouldShowFamilyUpsellV1(e){return this.exp_shouldShowFamilyUpsell("V1",e)}exp_shouldShowFamilyUpsellV2(e){return this.exp_shouldShowFamilyUpsell("V2",e)}exp_shouldShowFamilyUpsell(e,t){return(t!==se.share||!this.shouldShowEsignDiscoveryUpsell())&&this.sharingInfo.familySharingUpsellGating()===e}exp_trackInitialShow(){return s.__awaiter(this,void 0,void 0,(function*(){if(this.haveTrackedEsignUpsell)return;const{GrowthUserActionTracker:t}=yield new Promise((t,s)=>{e(["modules/clean/growth/user_action/tracker"],t,s)}).then(s.__importStar);new class extends t{constructor(){super(...arguments),this.project="pg_family_sharing_contextual_upsell"}}(this.user.id).track("show",{}),this.haveTrackedEsignUpsell=!0,i.ProEventsLogger.log("pg_snackbar_family_compare_plans_upsell_show",{variant:this.sharingInfo.familySharingUpsellGating(),user_id:this.user.id})}))}exp_showFamilyUpsellModal(){return s.__awaiter(this,void 0,void 0,(function*(){const[{CreateFamilyUpsellModal:t}]=yield Promise.all([new Promise((t,s)=>{e(["modules/clean/sharing/upsells/family_upsell_modal"],t,s)}).then(s.__importStar),this.exp_trackInitialShow()]);u.Modal.showInstance(n.default.createElement(t,null))}))}exp_afterCopy(){this.exp_shouldShowFamilyUpsellV1(se.copy)&&this.exp_showFamilyUpsellModal()}exp_getUpsellSnackbarProps(e){if(this.exp_shouldShowFamilyUpsellV2(e))return this.exp_trackInitialShow(),{richSnackbarProps:{actions:[{name:"family_compare_plans",dataUxaLog:"pg_snackbar_family_compare_plans_upsell_cta",text:q.intl.formatMessage({id:"eXMGp+",defaultMessage:"Compare plans"}),onClick(){j.unsafe_open_tab("/plans?trigger=nr")}}],helperText:n.default.createElement(n.default.Fragment,null,n.default.createElement($.UIIcon,{className:"share_modal_snackbar--family_upsell__icon",src:X.PersonMultipleLine}),n.default.createElement("div",{className:"share_modal_snackbar--family_upsell__line"}),n.default.createElement("div",{className:"share_modal_snackbar--family_upsell__text"},n.default.createElement("b",null,"Save money with Dropbox Family.")," Share 2 TB (2,000 GB) with up to 6 people and connect in the Family Room.")),clickHandlerArgs:{experiment:"pg_family_sharing_contextual_upsell",userId:this.user.id,filePath:"",ns_id:-1}},timeoutDelayMs:1e5}}isMemberInviteModal(e){return["member_invite","member_suggestion","member_invite_expand_eligibility","member_suggestion_expand_eligibility"].includes(e)}isAdminInviteModal(e){return["admin_invite_after_move","admin_invite_expand_eligibility"].includes(e)}isBasicUserRequestModal(e){return"basic_user_request_to_join"===e}}})),define("modules/clean/sharing/actions/sharing_actions",["require","exports","modules/clean/flux/dispatcher","modules/clean/react/pass/action_timestamps","modules/clean/react/pass/constants","modules/clean/sharing/action_types","modules/clean/sharing/api/client","spectrum-sharing/utils/sharing_constants","modules/clean/sharing/share_page/action_types","modules/clean/sharing/stores/sharing_info","modules/core/assert"],(function(e,t,s,n,i,a,r,o,l,d,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SharingActions=void 0,t.SharingActions={loadFileMetadataBatch:(e,t)=>new r.FileShareApiClient({userId:e.id}).getMetadataBatchAlpha({contentIds:t,actions:Object.keys(o.ALPHA_FILE_METADATA_PERMISSIONS)}).then(t=>s.Dispatcher.dispatch({type:a.SharingActionTypes.FETCH_METADATA_BATCH_SUCCESS,user:e,data:t})),loadFileMetadata:({user:e,contentId:t,sourceUrl:n,client:i})=>{const c=d.sharingInfoStore.getSharingInfo(e.id,t);if(c&&c.fetchingMetadataPromise())return c.fetchingMetadataPromise();const h=(i=i||new r.FileShareApiClient({userId:e.id})).getMetadataAlpha({contentId:t,actions:Object.keys(o.ALPHA_FILE_METADATA_PERMISSIONS),sourceURL:n}).then(t=>{s.Dispatcher.dispatch({type:a.SharingActionTypes.FETCH_METADATA_BATCH_SUCCESS,user:e,data:[t]}),s.Dispatcher.dispatch({type:l.SharePageActionTypes.FETCH_METADATA_SUCCESS,metadata:t,user:e})});return s.Dispatcher.dispatch({type:a.ShareModalActionTypes.FETCH_METADATA_REQUEST,contentIds:[t],data:{promise:h},user:e}),h},listMembers:({user:e,contentId:t,isFolder:o,limit:l,url:h,members:p,client:u,previewSessionId:m=null,includeSeenState:g=!0,isNonUserRelativeContext:_=!1})=>{c.assert(!l||l<=100,"listMembers not implemented for limit > 100");const f=l||9999999,S=d.sharingInfoStore.getSharingInfo(e.id,t);if(S){const e=S.fetchingMembersRequest();if(e&&f<=e.limitNonNull)return e.promise;if(S.hasDisplayableMembers()&&f<S.members().getMemberCount())return Promise.resolve({})}const E=Math.random().toString(),M=!o;u||(u=o?new r.FolderShareApiClient({userId:e.id,isNonUserRelativeContext:_}):new r.FileShareApiClient({userId:e.id,isNonUserRelativeContext:_}));const C=n=>n?(s.Dispatcher.dispatch({type:a.ShareModalActionTypes.FETCH_USER_ACCOUNTS_CONTINUED_REQUEST,contentIds:[t],user:e}),u.listMembersContinue({cursor:n,url:h,isAlpha:M}).then(n=>{s.Dispatcher.dispatch({type:a.ShareModalActionTypes.FETCH_USER_ACCOUNTS_CONTINUED_SUCCESS,contentIds:[t],data:{members:n,requestId:E},user:e}),C(n.cursor)})):Promise.resolve({});let b;return n.ActionTimestampsTracker.record(i.LoggingActions.LIST_MEMBERS_BEGIN,m),b=p?Promise.resolve(p):u.listMembers({contentId:t,url:h,limit:l,isAlpha:M,includeSeenState:g}),b=b.then(r=>{n.ActionTimestampsTracker.record(i.LoggingActions.LIST_MEMBERS_RECEIVE,m),s.Dispatcher.dispatch({type:a.ShareModalActionTypes.FETCH_USER_ACCOUNTS_SUCCESS,contentIds:[t],data:{members:r,requestId:E},user:e}),l||C(r.cursor)}),s.Dispatcher.dispatch({type:a.ShareModalActionTypes.FETCH_USER_ACCOUNTS_REQUEST,contentIds:[t],data:{limitNonNull:f,requestId:E,promise:b},user:e}),b},fetchFileMemberCount:({user:e,contentId:t,limit:o,url:l,client:d,countGroupsAsMembers:c=!1,previewSessionId:h=null,runViewerInfoChecks:p=!1})=>{d=d||new r.FileShareApiClient({userId:e.id}),n.ActionTimestampsTracker.record(i.LoggingActions.MEMBER_COUNTS_BEGIN,h);const u=d.getMemberCounts({contentId:t,limit:o,url:l,countGroupsAsMembers:c,runViewerInfoChecks:p});return s.Dispatcher.dispatch({type:a.ShareModalActionTypes.FETCH_FILE_MEMBER_COUNT_REQUEST,contentIds:[t],user:e}),u.then(r=>{n.ActionTimestampsTracker.record(i.LoggingActions.MEMBER_COUNTS_RECEIVE,h),s.Dispatcher.dispatch({type:a.ShareModalActionTypes.FETCH_FILE_MEMBER_COUNT_SUCCESS,contentIds:[t],data:r,user:e})})},fetchFolderMemberCount:({user:e,contentId:t,client:n})=>(s.Dispatcher.dispatch({type:a.ShareModalActionTypes.FETCH_MEMBER_COUNTS_REQUEST,data:{},contentIds:[t],user:e}),n.getMemberCounts({contentId:t}).then(n=>{s.Dispatcher.dispatch({type:a.ShareModalActionTypes.FETCH_MEMBER_COUNTS_SUCCESS,data:{memberCounts:n},contentIds:[t],user:e})}))}})),define("modules/clean/sharing/actions/contact_validators",["require","exports","tslib","modules/clean/sharing/api/util/types","lodash","modules/clean/sharing/ui_util","modules/core/exception","modules/clean/js_client_stopwatch","modules/clean/contacts/contact_token_state","spectrum-sharing/utils/logging"],(function(e,t,s,n,i,a,r,o,l,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AsyncContactValidator=void 0,i=s.__importStar(i);const c={state:l.ContactTokenState.invalid,msg:a.CONTACT_ERROR_MESSAGES.SINGLE_INVALID};t.AsyncContactValidator=class{constructor(e){this.validationStopWatchName="async_contact_server_side_validation",this.client=e,o.JSStopwatch.create_stopwatch_if_not_exist(this.validationStopWatchName)}validate(e,t,i,l,h){return s.__awaiter(this,void 0,void 0,(function*(){const s={};h.filter(e=>e.invalid).forEach(e=>s[e.getKey()]=c);const p=h.filter(e=>!e.invalid);if(0===p.length)return s;const u=o.JSStopwatch.startSpan("validation",{stopwatchName:this.validationStopWatchName,async:!0});let m=void 0;try{a.logTiburonEvent(i,e,d.TiburonEventName.AttemptTargetValidation),m=yield this.client.validateMembers({contentId:t,accessLevel:l,members:n.contactsToMembers(p,!0)})}catch(t){a.logTiburonEvent(i,e,d.TiburonEventName.FailTargetValidation,{error:t.error?t.error[".tag"]:"unknown server error"}),r.reportStack("server error in contact validation",{severity:r.SEVERITY.NONCRITICAL,tags:["sharing"]})}if(!m)return s;a.logTiburonEvent(i,e,d.TiburonEventName.SucceedTargetValidation);const{results:g}=m,_={};return h.forEach(e=>{_[this.selectorToScalarKey(n.contactToMember(e,!0))]=e.getKey()}),g.forEach(e=>{const t=_[this.selectorToScalarKey(e.member)],n=e.target_invite_eligibility;s[t]=Object.assign(Object.assign({},this.calculateValidation(e.result)),{inviteAfterSharingEligibility:n})}),o.JSStopwatch.endSpan("validation",{stopwatchName:this.validationStopWatchName,spanId:u}),setTimeout(()=>o.JSStopwatch.flush_current_data(),0),s}))}selectorToScalarKey(e){const t=e[".tag"];return`${t}-${i.get(e,t)}`}calculateValidation(e){const t=e[".tag"];switch(t){case"allowed":const s=e.allowed[".tag"];switch(s){case"no_warning":return{state:l.ContactTokenState.ok,msg:null};case"outside_of_team":return{state:l.ContactTokenState.warn,msg:a.CONTACT_ERROR_MESSAGES.SINGLE_OUT_OF_TEAM};default:return r.reportStack("New allowed warning type without handling",{tags:["sharing"],severity:r.SEVERITY.CRITICAL,exc_extra:{warning:s}}),{state:l.ContactTokenState.ok,msg:null}}case"disallowed":const n=e.disallowed[".tag"];switch(n){case"invalid_member":return{state:l.ContactTokenState.invalid,msg:a.CONTACT_ERROR_MESSAGES.SINGLE_INVALID};case"outside_of_team":return{state:l.ContactTokenState.invalid,msg:a.CONTACT_ERROR_MESSAGES.SINGLE_OUT_OF_TEAM};case"target_is_individual":return{state:l.ContactTokenState.invalid,msg:a.CONTACT_ERROR_MESSAGES.NONGROUP_INVITEE};case"no_permission":return{state:l.ContactTokenState.invalid,msg:a.CONTACT_ERROR_MESSAGES.NO_PERMISSION};default:return r.reportStack("New disallowed error type without handling",{tags:["sharing"],severity:r.SEVERITY.CRITICAL,exc_extra:{error:n}}),{state:"invalid",msg:a.CONTACT_ERROR_MESSAGES.NO_PERMISSION}}default:const i="Unpredicted state in client validation API response";throw r.reportStack(i,{tags:["sharing"],severity:r.SEVERITY.CRITICAL,exc_extra:{state:t}}),new Error(i)}}}})),define("modules/clean/sharing/api",["require","exports","tslib","jquery","modules/clean/deprecated_ajax/ajax_jquery"],(function(e,t,s,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SharingApi=void 0,n=s.__importDefault(n);class a{constructor(e){this.user=e}get_sync_vars_for_ns_id(e,t,s){const n={ns_id:e,sub_path:t};this._make_request("/sharing/get_sync_vars_for_ns_id",n,s,null,!0)}validate_new_sf_path(e,t,s,n){const i={share_type:"new",folder_name:e,path:t};this._make_request("/share_ajax/validate_folder",i,s,n,!0)}validate_shareable_existing_sf_path(e,t,s){const n={share_type:"shareable_existing",path:e};this._make_request("/share_ajax/validate_folder",n,t,s,!0)}_make_request(e,t,s,r,o=!1,l=!0){const d={url:e,data:t,success(i,r,o){s(o),n.default(document).trigger(a.REQUEST_SUCCEEDED_EVENT,{request_url:e,ns_id:t.ns_id||null})},error(e){r&&r(e)}};l&&(d.subject_user=this.user.id),o?i.FormWebRequest(d):i.WebRequest(d)}}t.SharingApi=a,a.REQUEST_SUCCEEDED_EVENT="db:sharing_api:request_succeeded"})),define("modules/clean/sharing/cdm_new_folder_modal_components",["require","exports","tslib","classnames","react","dig-components/icons","dig-components/icons/src","dig-components/modal","dig-components/text_fields","dig-components/typography","spectrum/icon_content/index","spectrum/input/index","modules/clean/filepath/filepath","modules/clean/react/flag","modules/clean/sharing/views/hover_close_button","modules/core/i18n"],(function(e,t,s,n,i,a,r,o,l,d,c,h,p,u,m,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FolderNameInput=t.FolderNameDefaultWarningMessage=t.FolderNameDefaultErrorMessage=t.FolderNameDefaultWarningValidator=t.FolderNameDefaultErrorValidator=t.FolderNameHeader=void 0,n=s.__importDefault(n),i=s.__importStar(i),m=s.__importDefault(m),t.FolderNameHeader=e=>{const{isCreateViaUpload:t,folderPath:s,handleClickCloseButton:n,useDigModal:a}=e,r=t&&s?p.filename(s):g.intl.formatMessage({id:"5Z9j+l",defaultMessage:"Create folder"});return a?i.createElement(o.Modal.Header,{className:"cdm-create-folder-modal__header--dig",hasBottomSpacing:"title-small"},i.createElement(c.IconContent,{name:"folder-small"}),i.createElement(d.Title,{className:"cdm-create-folder-modal__header-title--dig",size:"small"},r)):i.createElement("div",null,i.createElement(u.Flag,{rightAttachment:n?i.createElement(m.default,{onClick:n}):void 0,leftAttachment:i.createElement(c.IconContent,{name:"folder-small"}),spacing:"s"},r))},t.FolderNameHeader.displayName="FolderNameHeader",t.FolderNameDefaultErrorValidator=e=>_(e,["\\","/",":"]),t.FolderNameDefaultWarningValidator=e=>_(e,['"',"*","<",">","?","|"]);const _=(e,t)=>{if(!e)return!1;for(const s of t)if(e.indexOf(s)>=0)return!1;return!0};t.FolderNameDefaultErrorMessage=g.intl.formatMessage({id:"LAZfR0",defaultMessage:'Folder names can’t contain: " \\ / :'}),t.FolderNameDefaultWarningMessage=g.intl.formatMessage({id:"Vf5SED",defaultMessage:"Warning: To avoid potential sync issues, name should not contain \" * '<' '>' ? |"});class f extends i.PureComponent{constructor(){super(...arguments),this.inputRef=i.createRef()}componentDidMount(){this.props.focusOnMount&&this.inputRef.current&&this.inputRef.current.focus()}render(){if(this.props.isCreateViaUpload)return null;const e=this.props.errorText||this.props.warningText;return this.props.useDig?i.createElement("div",{className:n.default("cdm-create-folder-modal__name-input--dig",this.props.className)},i.createElement(l.FormLabel,{htmlFor:"new_folder_name_input"},g.intl.formatMessage({id:"cJojIg",defaultMessage:"Name"})),i.createElement(l.TextInput,{ref:this.inputRef,id:"new_folder_name_input",placeholder:g.intl.formatMessage({id:"ss4CO0",defaultMessage:"Folder name"}),onChange:this.props.handleFolderNameChange,onKeyDown:this.props.onKeyDown,isInvalid:!!e,"aria-describedby":"new_folder_name_message",defaultValue:this.props.defaultInputFolderName}),this.props.errorText&&i.createElement(l.FormHelperText,{isInvalid:!0,id:"new_folder_name_message"},i.createElement(a.UIIcon,{src:r.FailLine,size:"small"})," ",this.props.errorText),this.props.warningText&&i.createElement(l.FormHelperText,{id:"new_folder_name_message"},i.createElement(a.UIIcon,{src:r.WarningLine,size:"small"})," ",this.props.warningText)):i.createElement("div",{className:n.default("u-pad-vertical-s",this.props.className,{"u-mar-bottom-s":!e})},i.createElement("div",{className:"cdm-create-folder-modal__header u-pad-bottom-xs u-font-meta"},g.intl.formatMessage({id:"cJojIg",defaultMessage:"Name"})),i.createElement(h.Input,{forwardedRef:this.inputRef,placeholder:g.intl.formatMessage({id:"ss4CO0",defaultMessage:"Folder name"}),id:"new_folder_name_input",onChange:this.props.handleFolderNameChange,className:n.default("cdm-create-folder-modal__content-name",this.props.inputClassName,{valid:this.props.isValid,invalid:!this.props.isValid}),onKeyDown:this.props.onKeyDown,defaultValue:this.props.defaultInputFolderName}),i.createElement("label",{style:{display:"none"},htmlFor:"new_folder_name_input"},g.intl.formatMessage({id:"ss4CO0",defaultMessage:"Folder name"})),!e&&i.createElement("div",{className:"new-folder-empty-status"}),this.props.errorText&&i.createElement("span",{className:"new-folder-error-text"},this.props.errorText),this.props.warningText&&i.createElement("span",{className:"new-folder-warning-text"},this.props.warningText))}}t.FolderNameInput=f,f.displayName="FolderNameInput"})),define("modules/clean/sharing/confirmation_modals/confirm_recursive_policy_change_modal",["require","exports","tslib","react","dompurify","modules/clean/react/components/modal","modules/core/i18n","spectrum/modal/index"],(function(e,t,s,n,i,a,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.confirmRecursivePolicyChange=void 0,n=s.__importStar(n),i=s.__importStar(i),t.confirmRecursivePolicyChange=function(e){const t=e.isTeamSharedFolder?i.sanitize(r.intl.formatMessage({id:"p4X4PM",defaultMessage:"Your changes will be applied to this team folder and any folders inside it."})):i.sanitize(r.intl.formatMessage({id:"ImAPkp",defaultMessage:"Your changes will be applied to this folder and any folders inside it."}));a.Modal.showInstance(n.createElement(o.UtilityModal,{ariaLabel:r.intl.formatMessage({id:"SoVWmf",defaultMessage:"Save settings?"}),title:r.intl.formatMessage({id:"SoVWmf",defaultMessage:"Save settings?"}),overlayClickClose:!0,primaryAction:r.intl.formatMessage({id:"kTq6n5",defaultMessage:"Save settings"}),secondaryAction:r.intl.formatMessage({id:"d9/SE1",defaultMessage:"Cancel"}),onPrimaryAction:e.onConfirm,onSecondaryAction:e.onCancel,open:!0,onRequestClose:e.onCancel},t))}})),define("modules/clean/sharing/confirmation_modals/member_access_change_confirmation_modal",["require","exports","tslib","react","modules/clean/em_string","modules/clean/sharing/confirmation_modals/confirm_with_option_modal","spectrum-sharing/utils/sharing_constants","modules/clean/react/components/modal","modules/core/browser","modules/core/i18n"],(function(e,t,s,n,i,a,r,o,l,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.showMemberAccessChangeConfirmationModal=t.CONFIRM_WITH_OPTION_MODAL_ID=void 0,n=s.__importDefault(n),l=s.__importStar(l),t.CONFIRM_WITH_OPTION_MODAL_ID="confirm-with-option-modal";t.showMemberAccessChangeConfirmationModal=function(e="",s,c,h,p=!1,u,m,g=!1,_,f,S=!1){let E,M,C,b,I;const v=i.Emstring.em_snippet(e,40);let y=null;if(s===r.MEMBER_ACTION.REMOVE){if(C=d.intl.formatMessage({id:"sIVZG2",defaultMessage:"Remove {name}?"},{name:v}),c){E=h&&!g?f?d.intl.formatMessage({id:"ru4Qhg",defaultMessage:"If you remove <strong>{name}</strong>, they won’t be able to see future changes to this shared folder. Keep in mind that anyone who can access <strong>{parentname}</strong> will still be able to access this folder."},{strong:e=>n.default.createElement("strong",null,e),name:v,parentname:f}):d.intl.formatMessage({id:"8rlotY",defaultMessage:"If you remove <strong>{name}</strong>, they won’t be able to see future changes to this shared folder. Keep in mind that anyone who can access the parent folder will still be able to access this folder."},{strong:e=>n.default.createElement("strong",null,e),name:v}):d.intl.formatMessage({id:"03tbWi",defaultMessage:"If you remove <strong>{name}</strong>, they won’t be able to see future changes to this shared folder."},{strong:e=>n.default.createElement("strong",null,e),name:v}),p&&(y=d.intl.formatMessage({id:"RB9i4M",defaultMessage:"Let {name} keep a copy of this shared folder"},{name:v}))}else E=S?d.intl.formatMessage({id:"D0n7tP",defaultMessage:"Keep in mind, if group members have a shared link to this file, they might still be able to view or edit it."}):d.intl.formatMessage({id:"nAwKbF",defaultMessage:"Keep in mind, if they have a shared link to this file, they might still be able to view or edit it."}),b=d.intl.formatMessage({id:"S+RxKh",defaultMessage:"More about links"}),I=()=>l.open_tab("https://help.dropbox.com/files-folders/share/remove-link");M=d.intl.formatMessage({id:"6WOQfa",defaultMessage:"Remove"})}else C=d.intl.formatMessage({id:"B01nan",defaultMessage:"Make {name} the owner of this folder and all contained files and folders?"},{name:v}),E=_?d.intl.formatMessage({id:"gek9SL",defaultMessage:"Settings for this folder will now be managed by {name}. Keep in mind, if they’re not on your Dropbox team, you won’t be able to manage this folder here anymore."},{name:v}):d.intl.formatMessage({id:"OhU3GK",defaultMessage:"Only <strong>{name}</strong> will be able to unshare this folder or change folder settings."},{strong:e=>n.default.createElement("strong",null,e),name:v}),M=d.intl.formatMessage({id:"+ZJXxL",defaultMessage:"Make owner"});return o.Modal.showInstance(n.default.createElement(a.ConfirmWithOptionModal,{autoClose:!1,confirmText:M,cancelText:d.intl.formatMessage({id:"d9/SE1",defaultMessage:"Cancel"}),link:b,onConfirm:u,onCancel:m,onClickLink:I,optionLabel:y,showOption:null!=y,title:C},E),!0,t.CONFIRM_WITH_OPTION_MODAL_ID)}})),define("modules/clean/sharing/content_info",["require","exports","tslib","immutable"],(function(e,t,s,n){"use strict";function i(e){const t=(e.isFolder?e.targetNsId:e.fileId)||e.fqPath;if(null===t)throw new Error("Not enough fields provided for extras");return t}Object.defineProperty(t,"__esModule",{value:!0}),t.ContentInfoExtras=t.ContentInfo=void 0,n=s.__importStar(n);class a extends(n.Record({extras:null,id:null},"ContentInfo")){static createFromParams(e){const t=new r(e);return new a({extras:t,id:i(t)})}setNsId(e){const t=this.setIn(["extras","targetNsId"],e);return t.set("id",i(t.extras))}setFQPath(e){const t=this.setIn(["extras","fqPath"],e);return t.set("id",i(t.extras))}isFolder(){return this.extras.isFolder}isFile(){return!this.isFolder()}isFileFolder(){return this.isFolder()&&!this.isSharedFolder()}isSharedFolder(){return Boolean(this.extras.targetNsId)}isTeamSharedFolder(){return this.extras.isTeamSharedFolder}isFolderInsideTeamFolderTree(){return this.extras.isFolderInsideTeamFolderTree}isInSharedFolder(){return Boolean(this.extras.nsId&&this.extras.nsId!==this.extras.userHomeNs)}isNestedSharedFolder(){return this.isInSharedFolder()&&this.isSharedFolder()}isMounted(){return!this.extras.url}url(){return this.extras.url}pathExists(){return Boolean(this.extras.exists)}name(){return this.displayPath()?this.displayPath().split("/").pop():this.filename()}idForLink(){const e=this.extras.fileId||this.extras.fqPath;if(!e)throw new Error("No identifiers for getting links");return e}sharedFolderId(){const e=this.extras.targetNsId;if(!e)throw new Error("No shared folder ID");return e}displayPath(){return this.extras.fqPath}fileId(){return this.extras.fileId}filename(){return this.extras.filename}nsId(){if(!this.extras.nsId)throw new Error("Can't determine nsId");return this.extras.nsId}nsPath(){if(null===this.extras.nsPath)throw new Error("Can't determine nsPath");return this.extras.nsPath}sjid(){return this.extras.sjid}teamGroupInfo(){return this.extras&&this.extras.teamGroupInfo}}t.ContentInfo=a;class r extends(n.Record({exists:!0,fileId:null,filename:null,fqPath:null,isFolder:null,isTeamSharedFolder:!1,isFolderInsideTeamFolderTree:!1,modalSessionId:null,nsId:null,nsPath:null,origin:null,sjid:null,targetNsId:null,url:null,userHomeNs:null,teamGroupInfo:null},"ContentInfoExtras")){}t.ContentInfoExtras=r})),define("modules/clean/sharing/delete_link_modal",["require","exports","tslib","modules/clean/deprecated_ajax/ajax_jquery","react","modules/clean/em_string","modules/clean/react/components/modal","spectrum-sharing/utils/sharing_constants","modules/clean/sharing/ui_notifications_util","spectrum/modal/index","modules/core/i18n","spectrum-sharing/utils/sharing_constants"],(function(e,t,s,n,i,a,r,o,l,d,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.deleteLinkWithConfirmLegacy=t.deleteLinkWithConfirm=void 0,n=s.__importStar(n),i=s.__importDefault(i),o=s.__importStar(o);t.deleteLinkWithConfirm=function({client:e,url:t,contentName:s,onDeleteLink:n,onCancel:p,actionHandler:u}){s=a.Emstring.em_snippet(s,o.SNIPPET_SIZES.FILENAME);const m=c.intl.formatMessage({id:"gbccCU",defaultMessage:"Delete link to “{name}”?"},{name:s}),g=()=>{r.Modal.close(),p&&p()};r.Modal.showInstance(i.default.createElement(d.UtilityModal,{ariaLabel:m,title:m,overlayClickClose:!0,primaryAction:c.intl.formatMessage({id:"9v2+SN",defaultMessage:"Delete"}),secondaryAction:c.intl.formatMessage({id:"d9/SE1",defaultMessage:"Cancel"}),onPrimaryAction:()=>{const a=c.intl.formatMessage({id:"NEH57K",defaultMessage:"Deleting link to <st>{name}</st>..."},{st:e=>i.default.createElement("strong",null,e),name:s});l.sharingNotificationInProgress(a,!0),e.revokeSharedLink({url:t}).then(()=>{const e=c.intl.formatMessage({id:"gfG7zK",defaultMessage:"Deleted link to <st>{name}</st>."},{st:e=>i.default.createElement("strong",null,e),name:s});u?l.showDeleteLinkSuccessSnackbar(e,()=>u.showScreen(h.MANAGE_SCREEN),"sharing-notification"):l.sharingNotificationSuccess(e),r.Modal.close(),n&&n()})},onSecondaryAction:g,open:!0,onRequestClose:g,overlayClassName:"file-viewer-modal-overlay"},c.intl.formatMessage({id:"poEviS",defaultMessage:"If you want to further restrict access, check the list of people who still have access."})))};t.deleteLinkWithConfirmLegacy=function({client:e,tkey:t,contentName:s,onDeleteLink:i,onCancel:d}){if(s=a.Emstring.em_snippet(s,o.SNIPPET_SIZES.FILENAME),null===t)return void r.Modal.close();return r.SimpleModal.show({autoclose:!1,body_html:c.intl.formatMessage({id:"xuc+Bh",defaultMessage:"This link will no longer work for anyone who has it."}),cancel_completed_callback:d,cancel_text:c.intl.formatMessage({id:"d9/SE1",defaultMessage:"Cancel"}),confirm_callback:()=>n.WebRequest({url:`/sm/disable/${t}`,type:"POST",data:{tkey:t},subject_user:e.userId,success(){const e=c.intl.formatMessage({id:"Rfyu6S",defaultMessage:"Deleted link to “{name}”"},{name:s});l.sharingNotificationSuccess(e),r.Modal.close(),i&&i()}}),confirm_text:c.intl.formatMessage({id:"9v2+SN",defaultMessage:"Delete"}),title_text:c.intl.formatMessage({id:"gbccCU",defaultMessage:"Delete link to “{name}”?"},{name:s}),style:"default-maestro"})}})),define("modules/clean/sharing/member_constructors",["require","exports","modules/clean/sharing/api/types/metadata","modules/clean/sharing/access_level","modules/clean/react/pass/utils","modules/core/i18n","modules/core/user_i18n"],(function(e,t,s,n,i,a,r){"use strict";function o(){const e=new s.PermissionSetting({allow:!1});return new s.MemberPermissions({make_editor:e,make_viewer:e,make_owner:e,remove:e})}Object.defineProperty(t,"__esModule",{value:!0}),t.constructLinkMembers=t.constructGuests=void 0,t.constructGuests=function(e){const t=i.AnonymousViewerUtils.getAnonymousUserIds(e),n=a.intl.formatMessage({id:"+s6D7j",defaultMessage:"Guest"});return t.map(e=>new s.UserMembershipInfo({access_type:"reader",account:new s.BasicAccount({account_id:e,display_name:n,familiar_name:n,given_name:n,surname:""}),account_id:e,initials:i.AnonymousViewerUtils.getAnonymousViewerInitials(n),is_inherited:!1,permissions:o(),same_team:!1,time_last_seen:null}))},t.constructLinkMembers=function(e){return e?e.map(e=>{const{seen_state_user:{user_id:t,display_name:i,email:a,photo_circle_url:l,sharing_access_type:d},when_last_seen:c}=e;let h=n.ACCESS_LEVEL.READER;return d&&"edit_link_access"===d.type&&(h=n.ACCESS_LEVEL.WRITER),new s.UserMembershipInfo({access_type:h,account:new s.BasicAccount({account_id:t,display_name:i,email:a,email_verified:!0,familiar_name:"",given_name:"",profile_photo_url:l,surname:""}),account_id:t,initials:r.getInitials(i),is_inherited:!1,permissions:o(),same_team:!0,time_last_seen:c?new Date(1e3*c):null})}):[]}})),define("modules/clean/sharing/parent_folder_access_modal",["require","exports","tslib","react","react-intl","modules/clean/em_string","modules/clean/react/flag","modules/clean/react/components/modal","modules/clean/sharing/access_level","spectrum-sharing/utils/sharing_constants","modules/core/i18n","modules/clean/react/icon/folder_icon"],(function(e,t,s,n,i,a,r,o,l,d,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ParentFolderAccessModal=void 0,n=s.__importDefault(n),r=s.__importStar(r);class p extends n.default.Component{constructor(){super(...arguments),this.dismissModal=()=>{o.Modal.close(),this.handleDismissed()},this.handleDismissed=()=>{this.props.onClose&&this.props.onClose()},this.handleNavigateToParentFolder=e=>()=>{o.Modal.close(),this.props.onParentFolderClicked&&this.props.onParentFolderClicked(e.path,this.arePermissionsAllowed(e.permissions))},this.arePermissionsAllowed=e=>e.some(e=>e&&e.allow),this.memberCanEdit=()=>[l.ACCESS_LEVEL.OWNER,l.ACCESS_LEVEL.WRITER].indexOf(this.props.memberAccessLevelResult.access_level)>-1,this.getInfoStr=e=>"remove"===this.props.originalAction?this.props.contentInfo.isFolder()?c.intl.formatMessage({id:"tEArbp",defaultMessage:"{count, plural, one{As a member of the parent folder listed below, {member_name} can still access the contents of “{content_name}”.} other{As a member of the parent folders listed below, {member_name} can still access the contents of “{content_name}”.}}"},Object.assign({count:this.props.memberAccessLevelResult.parentFolders.length},e)):c.intl.formatMessage({id:"P/dkL3",defaultMessage:"{count, plural, one{As a member of the parent folder listed below, {member_name} can still access “{content_name}”.} other{As a member of the parent folders listed below, {member_name} can still access “{content_name}”.}}"},Object.assign({count:this.props.memberAccessLevelResult.parentFolders.length},e)):this.props.contentInfo.isFolder()?this.memberCanEdit()?c.intl.formatMessage({id:"vGWLOq",defaultMessage:"{count, plural, one{As a member of the parent folder listed below, {member_name} can still edit the contents of “{content_name}”.} other{As a member of the parent folders listed below, {member_name} can still edit the contents of “{content_name}”.}}"},Object.assign({count:this.props.memberAccessLevelResult.parentFolders.length},e)):c.intl.formatMessage({id:"r+xJ//",defaultMessage:"{count, plural, one{As a member of the parent folder listed below, {member_name} can still view the contents of “{content_name}”.} other{As a member of the parent folders listed below, {member_name} can still view the contents of “{content_name}”.}}"},Object.assign({count:this.props.memberAccessLevelResult.parentFolders.length},e)):this.memberCanEdit()?c.intl.formatMessage({id:"VcTut+",defaultMessage:"{count, plural, one{As a member of the parent folder listed below, {member_name} can still edit “{content_name}”.} other{As a member of the parent folders listed below, {member_name} can still edit “{content_name}”.}}"},Object.assign({count:this.props.memberAccessLevelResult.parentFolders.length},e)):c.intl.formatMessage({id:"7bObr8",defaultMessage:"{count, plural, one{As a member of the parent folder listed below, {member_name} can still view “{content_name}”.} other{As a member of the parent folders listed below, {member_name} can still view “{content_name}”.}}"},Object.assign({count:this.props.memberAccessLevelResult.parentFolders.length},e)),this.renderParentFolderContent=()=>n.default.createElement("div",null,this.getInfoStr({member_name:a.Emstring.em_snippet(this.props.memberDisplayName,d.SNIPPET_SIZES.DISPLAY_NAME),content_name:a.Emstring.em_snippet(this.props.contentInfo.name()||"",d.SNIPPET_SIZES.FILENAME)}),n.default.createElement("div",{className:"parent-folder-access-modal__folder-list u-mar-top-s"},n.default.createElement("ul",{className:"o-list-ui o-list-ui--dividers"},this.props.memberAccessLevelResult.parentFolders.map(this.renderParentFolder)))),this.renderParentFolder=e=>n.default.createElement("li",null,n.default.createElement("div",{className:"parent-folder-access-modal__parent-folder u-pad-vertical-xs u-pad-horizontal-s",onClick:this.handleNavigateToParentFolder(e)},n.default.createElement(r.Flag,{leftAttachment:n.default.createElement(h.SharedFolderIcon,null),rightAttachment:this.renderFolderLink(e),spacing:"xs"},n.default.createElement("span",{className:"parent-folder-access-modal__folder-name"},a.Emstring.em_snippet(e.name,d.SNIPPET_SIZES.FILENAME))))),this.renderFolderLink=e=>n.default.createElement("button",{className:"button-as-link",onClick:this.handleNavigateToParentFolder(e),type:"button"},this.arePermissionsAllowed(e.permissions)?c.intl.formatMessage({id:"kH07jA",defaultMessage:"Manage membership"}):c.intl.formatMessage({id:"GW4cXr",defaultMessage:"View folder"})),this.renderSimpleContent=()=>n.default.createElement("div",null,n.default.createElement("span",{className:"parent-folder-access-modal__warning"},this.props.memberAccessLevelResult.warning),n.default.createElement("div",{className:"u-mar-top-m clearfix"},n.default.createElement("div",{className:"u-l-fr"},n.default.createElement("button",{className:"c-btn c-btn--primary confirm-button",onClick:this.dismissModal},c.intl.formatMessage({id:"nOO9Qi",defaultMessage:"OK"}))))),this.getTitleStr=()=>"remove"===this.props.originalAction?this.props.contentInfo.isFolder()?i.defineMessage({id:"kzDJ/C",defaultMessage:"{member_name} can still access this folder"}):i.defineMessage({id:"11DRm6",defaultMessage:"{member_name} can still access this file"}):this.props.contentInfo.isFolder()?this.memberCanEdit()?i.defineMessage({id:"lElTYu",defaultMessage:"{member_name} can still edit this folder"}):i.defineMessage({id:"orL+7x",defaultMessage:"{member_name} can still view this folder"}):this.memberCanEdit()?i.defineMessage({id:"3ux07n",defaultMessage:"{member_name} can still edit this file"}):i.defineMessage({id:"dkDAAI",defaultMessage:"{member_name} can still view this file"})}render(){const e=this.getTitleStr();return n.default.createElement(o.Modal,{autoClose:!1,className:"parent-folder-access-modal",buttonComponent:n.default.createElement("span",null),onDismissCompleted:this.handleDismissed,title:c.intl.formatMessage(e,{member_name:a.Emstring.em_snippet(this.props.memberDisplayName,d.SNIPPET_SIZES.DISPLAY_NAME)})},n.default.createElement("div",{className:"parent-folder-access-modal__contents"},this.props.memberAccessLevelResult.parentFolders&&!this.props.isInContentManager?this.renderParentFolderContent():this.renderSimpleContent()))}}t.ParentFolderAccessModal=p,p.displayName="ParentFolderAccessModal"})),define("modules/clean/sharing/share_modal/store/modal_info/reducer",["require","exports","tslib","immutable","modules/clean/sharing/content_info","modules/clean/cloud_docs/constants","modules/clean/sharing/action_types","modules/clean/sharing/views/constants","modules/clean/sharing/access_level"],(function(e,t,s,n,i,a,r,o,l){"use strict";function d(e,t){return t.shared_folder_id?e.setNsId(t.shared_folder_id):e}Object.defineProperty(t,"__esModule",{value:!0}),t.modalInfoReducer=t.initialModalInfoState=void 0,n=s.__importStar(n),t.initialModalInfoState={canRelinquishMembership:!1,contentInfo:i.ContentInfo.createFromParams({fqPath:"",isFolder:!1}),contentNameInputValue:"",contentNameMessageLevel:o.CONTENT_NAME_MESSAGE_LEVELS.INFO,initialProps:{},initialRecipientTokens:[],isContentNameFocused:!1,pendingMemberAction:n.Set(),recipientMessage:"",recipientRawInput:"",recipientTokens:[],recipientValidation:{},shareAsConfidential:!1,uiMode:o.MODES.MEMBERSHIP,fetchMetadataStatus:o.FETCH_METADATA_STATUS.FETCHING},t.modalInfoReducer=(e,s)=>{const n=s.payload;switch(s.type){case r.ShareModalActionTypes.CHANGE_CREATE_COMMENT_CHECKBOX:return Object.assign(Object.assign({},e),{isShareMessageAsCommentExplicitlyChecked:n.checked});case r.ShareModalActionTypes.CHANGE_RECIPIENTS:{const t=n.recipientTokens,s=n.recipientRawInput;let i=e.uiMode;return t.length>0||s.length>0?i===o.MODES.MEMBERSHIP&&(i=o.MODES.SHARE):i===o.MODES.SHARE&&(i=o.MODES.MEMBERSHIP),Object.assign(Object.assign({},e),{recipientTokens:t,recipientRawInput:s,uiMode:i})}case r.ShareModalActionTypes.CHANGE_RECIPIENT_ACCESS:return Object.assign(Object.assign({},e),{recipientAccess:n.newAccess});case r.ShareModalActionTypes.CHANGE_RECIPIENT_MESSAGE:return Object.assign(Object.assign({},e),{recipientMessage:n.message});case r.ShareModalActionTypes.UPDATE_RECIPIENT_VALIDATION:const s=n.recipientValidation,i=n.resetCurrentValidations?{}:e.recipientValidation,c={};return l.ACCESS_VALUES.forEach(e=>{const t=i[e]||{},n=s[e]||{};c[e]=Object.assign(Object.assign({},t),n)}),Object.assign(Object.assign({},e),{recipientValidation:c});case r.ShareModalActionTypes.FETCH_METADATA_FAILURE:return Object.assign(Object.assign({},e),{uiMode:o.MODES.LINK_ONLY,linkOnlyReason:e.linkOnlyReason!==o.LINK_ONLY_REASON.LINKS_PAGE?n.reason:e.linkOnlyReason,fetchMetadataStatus:o.FETCH_METADATA_STATUS.FAIL,countsExceedNsLimit:n.countExceedNsLimit});case r.ShareModalActionTypes.FETCH_METADATA_SUCCESS:{const t=n.metadata,s=t.path_lower&&a.isPointerByExtension(t.path_lower)?o.MODES.POINTER:e.uiMode;return Object.assign(Object.assign({},e),{uiMode:s,contentInfo:d(e.contentInfo,t),fetchMetadataStatus:o.FETCH_METADATA_STATUS.SUCCESS})}case r.ShareModalActionTypes.HANDLE_CONTENT_NAME_CHANGE:return Object.assign(Object.assign({},e),{contentNameInputValue:n.name,contentNameMessageLevel:o.CONTENT_NAME_MESSAGE_LEVELS.INFO,contentNameMessage:""===n.name?o.CONTENT_NAME_EMPTY_TOOLTIP:void 0});case r.ShareModalActionTypes.HANDLE_CONTENT_NAME_FOCUS_CHANGE:return Object.assign(Object.assign({},e),{isContentNameFocused:n.focus});case r.ShareModalActionTypes.MEMBER_ACTION_COMPLETE:return Object.assign(Object.assign({},e),{pendingMemberAction:e.pendingMemberAction.delete(n.member.memberKey())});case r.ShareModalActionTypes.MEMBER_ACTION_PENDING:return Object.assign(Object.assign({},e),{pendingMemberAction:e.pendingMemberAction.add(n.member.memberKey())});case r.ShareModalActionTypes.REMOVE_MEMBER_KEEP_ACCESS:case r.ShareModalActionTypes.REMOVE_MEMBER_SUCCESS:return Object.assign(Object.assign({},e),{pendingMemberAction:e.pendingMemberAction.delete(n.member.memberKey())});case r.ShareModalActionTypes.SEND_SHARE_FAILURE:return Object.assign(Object.assign({},e),{uiMode:o.MODES.SHARE});case r.ShareModalActionTypes.SEND_SHARE_REQUEST:return Object.assign(Object.assign({},e),{uiMode:o.MODES.SHARE_SENDING});case r.ShareModalActionTypes.SEND_SHARE_SUCCESS:return Object.assign(Object.assign({},e),{uiMode:o.MODES.SHARE});case r.ShareModalActionTypes.SHARE_FOLDER_SUCCESS:return Object.assign(Object.assign({},e),{contentInfo:d(e.contentInfo,n.metadata)});case r.ShareModalActionTypes.SHARE_MODAL_OPEN:{const s=n.shareModalInfoAttrs.contentInfo,i=n.shareModalInfoAttrs.inLinksPage,r=s.isFolder()&&!s.pathExists(),l=r&&!n.initialProps.initialContentName;let d,c=t.initialModalInfoState.uiMode;return a.isPointerByExtension(s.displayPath()||"")?c=o.MODES.POINTER:r?c=o.MODES.SHARE:i&&(c=o.MODES.LINK_ONLY,d=o.LINK_ONLY_REASON.LINKS_PAGE),Object.assign(Object.assign({},e),{contentInfo:s,linkOnlyReason:d,uiMode:c,contentNameInputValue:n.initialProps.initialContentName,contentNameMessage:l?o.CONTENT_NAME_EMPTY_TOOLTIP:"",initialProps:n.initialProps,initialRecipientTokens:n.shareModalInfoAttrs.initialRecipientTokens||[],isContentNameFocused:l,onCreateGroupCallback:n.initialProps.onCreateGroupCallback,recipientAccess:void 0,recipientMessage:n.initialProps.recipientMessage||"",recipientTokens:[],recipientValidation:{},showSharingQuestionnaire:n.initialProps.showSharingQuestionnaire,experiments:n.initialProps.experiments})}case r.ShareModalActionTypes.SHARE_MODAL_CLOSE:return Object.assign(Object.assign({},e),{initialRecipientTokens:n.tokens||e.initialRecipientTokens||[]});case r.ShareModalActionTypes.VALIDATE_CONTENT_NAME_ERROR:return Object.assign(Object.assign({},e),{contentNameMessage:n.errorMsg,contentNameMessageLevel:o.CONTENT_NAME_MESSAGE_LEVELS.ERROR});case r.ShareModalActionTypes.VALIDATE_CONTENT_NAME_SUCCESS:return Object.assign(Object.assign({},e),{contentInfo:e.contentInfo.setFQPath(n.newFolderPath)});default:return e}}})),define("modules/clean/sharing/share_modal/store/sharing_info/reducer",["require","exports","modules/clean/sharing/action_types","modules/clean/sharing/api/types/metadata"],(function(e,t,s,n){"use strict";function i(e,t){const s=e.metadata,n=t.permissions||s&&s.permissions;return t.set("permissions",n)}Object.defineProperty(t,"__esModule",{value:!0}),t.sharingInfoReducer=t.initialSharingInfoState=void 0,t.initialSharingInfoState={areMembersFullyLoaded:!1,areSharingPrefsLoaded:!1,hasDisplayableMembers:!1,isLinkMetadataLoaded:!1,isCurrentAccountLoaded:!1,shouldBlockMemberListOnPassLoad:!0,memberCounts:new n.MemberCounts,members:new n.SharingMembership,sharingPrefs:new n.SharingPrefs,sharedLinks:[],selectedAudienceByAccessLevel:{}},t.sharingInfoReducer=(e=t.initialSharingInfoState,a)=>{const r=a.payload;switch(a.type){case s.ShareModalActionTypes.CHANGE_MEMBER_ACCESS_FAILURE:return Object.assign(Object.assign({},e),{members:e.members.setIn([r.member.type(),r.member.memberKey(),"access_type"],r.prevAccess)});case s.ShareModalActionTypes.CHANGE_MEMBER_ACCESS_REQUEST:return Object.assign(Object.assign({},e),{members:e.members.setIn([r.member.type(),r.member.memberKey(),"access_type"],r.newAccess)});case s.ShareModalActionTypes.CLEAR_FILE_MEMBERSHIP_LAST_SEEN_INFO:return Object.assign(Object.assign({},e),{members:e.members.update("users",e=>e.map(e=>e.set("time_last_seen",null)))});case s.ShareModalActionTypes.CREATE_LINK_SUCCESS:return Object.assign(Object.assign({},e),{hasCreatedLink:!0,linkMetadata:r.linkMetadata,sharedLinks:e.sharedLinks.concat(r.linkMetadata)});case s.ShareModalActionTypes.FETCH_MEMBER_COUNTS_SUCCESS:return Object.assign(Object.assign({},e),{memberCounts:r.memberCounts});case s.ShareModalActionTypes.FETCH_METADATA_FAILURE:return Object.assign(Object.assign({},e),{fetchingMetadataPromise:void 0});case s.ShareModalActionTypes.FETCH_METADATA_REQUEST:return Object.assign(Object.assign({},e),{fetchingMetadataPromise:r.promise});case s.ShareModalActionTypes.FETCH_METADATA_SUCCESS:return Object.assign(Object.assign({},e),{metadata:i(e,r.metadata),fetchingMetadataPromise:void 0});case s.ShareModalActionTypes.FETCH_SHARING_PREFS_REQUEST:return Object.assign({},e);case s.ShareModalActionTypes.FETCH_SHARING_PREFS_SUCCESS:return Object.assign(Object.assign({},e),{areSharingPrefsLoaded:!0,sharingPrefs:r.sharingPrefs});case s.ShareModalActionTypes.FETCH_LINK_METADATA_FAILURE:return Object.assign(Object.assign({},e),{isLinkMetadataLoaded:!0,linkMetadata:void 0,sharedLinks:[]});case s.ShareModalActionTypes.FETCH_LINK_METADATA_SUCCESS:return Object.assign(Object.assign({},e),{isLinkMetadataLoaded:!0,linkMetadata:r.sharedLinks.length>0?r.sharedLinks[0]:null,sharedLinks:r.sharedLinks,selectedAudienceByAccessLevel:{}});case s.ShareModalActionTypes.DELETE_LINK_METADATA_SUCCESS:{const t=[];for(const s of e.sharedLinks)s.url!==r.deletedLink.url&&t.push(s);return Object.assign(Object.assign({},e),{hasCreatedLink:!1,hasIncrementedUpsellCounter:!1,linkMetadata:t[0]?t[0]:null,sharedLinks:t})}case s.ShareModalActionTypes.FETCH_USER_ACCOUNTS_REQUEST:return Object.assign(Object.assign({},e),{fetchingMembersRequest:{limitNonNull:r.limitNonNull,promise:r.promise,requestId:r.requestId}});case s.ShareModalActionTypes.FETCH_USER_ACCOUNTS_SUCCESS:return e.fetchingMembersRequest&&e.fetchingMembersRequest.requestId!==r.requestId?e:e.hasDisplayableMembers&&e.fetchingMembersRequest&&e.fetchingMembersRequest.limitNonNull<e.members.getMemberCount()?e:Object.assign(Object.assign({},e),{hasDisplayableMembers:!0,areMembersFullyLoaded:!r.members.cursor,fetchingMembersRequest:r.members.cursor?e.fetchingMembersRequest:void 0,members:r.members});case s.ShareModalActionTypes.FETCH_USER_ACCOUNTS_CONTINUED_SUCCESS:return e.fetchingMembersRequest&&e.fetchingMembersRequest.requestId!==r.requestId?e:Object.assign(Object.assign({},e),{areMembersFullyLoaded:!r.members.cursor,fetchingMembersRequest:r.members.cursor?e.fetchingMembersRequest:void 0,members:e.members.mergeDeep(r.members)});case s.ShareModalActionTypes.FETCH_CURRENT_ACCOUNT_REQUEST:return Object.assign(Object.assign({},e),{isCurrentAccountLoaded:!1});case s.ShareModalActionTypes.FETCH_CURRENT_ACCOUNT_SUCCESS:return Object.assign(Object.assign({},e),{isCurrentAccountLoaded:!0,isFamilyUser:r.isFamilyUser,teamPolicy:r.teamPolicy});case s.ShareModalActionTypes.FETCH_FILE_MEMBER_COUNT_SUCCESS:return Object.assign(Object.assign({},e),{memberCounts:new n.MemberCounts({total_unique_users:r.count,users_outside_team:0,exceeds_count:r.exceeds_limit})});case s.ShareModalActionTypes.REMOVE_MEMBER_KEEP_ACCESS:return Object.assign(Object.assign({},e),{members:e.members.setIn([r.member.type(),r.member.memberKey(),"access_type"],r.access)});case s.ShareModalActionTypes.REMOVE_MEMBER_SUCCESS:return Object.assign(Object.assign({},e),{members:e.members.deleteIn([r.member.type(),r.member.memberKey()])});case s.ShareModalActionTypes.SHARE_FOLDER_FAILURE:return Object.assign(Object.assign({},e),{shareFolderPromise:void 0});case s.ShareModalActionTypes.SHARE_FOLDER_REQUEST:return Object.assign(Object.assign({},e),{shareFolderPromise:r.promise});case s.ShareModalActionTypes.SHARE_FOLDER_SUCCESS:return Object.assign(Object.assign({},e),{metadata:i(e,r.metadata),shareFolderPromise:r.promise});case s.ShareModalActionTypes.TRANSFER_OWNER_SUCCESS:return Object.assign(Object.assign({},e),{metadata:void 0,isLinkMetadataLoaded:!1,hasDisplayableMembers:!1});case s.ShareModalActionTypes.UNBLOCK_MEMBER_LIST_ON_PASS_LOAD:return Object.assign(Object.assign({},e),{shouldBlockMemberListOnPassLoad:!1});case s.ShareModalActionTypes.UPDATE_SHARING_SETTINGS_SUCCESS:return Object.assign(Object.assign({},e),{metadata:i(e,r.metadata)});case s.ShareModalActionTypes.SET_UPSELL_COUNTER_PREF_SUCCESS:return Object.assign(Object.assign({},e),{hasIncrementedUpsellCounter:!0});case s.ShareModalActionTypes.CHANGE_LINK_AUDIENCE_SELECTION:const t=e.selectedAudienceByAccessLevel;return t[r.accessLevel]=r.audience,Object.assign(Object.assign({},e),{selectedAudienceByAccessLevel:t});case s.ShareModalActionTypes.REMOVE_LINK_AUDIENCE_SELECTION:if(e.selectedAudienceByAccessLevel){const t=Object.keys(e.selectedAudienceByAccessLevel).reduce((t,s)=>(e.selectedAudienceByAccessLevel&&s!==r.accessLevel&&(t[s]=e.selectedAudienceByAccessLevel[s]),t),{});return Object.assign(Object.assign({},e),{selectedAudienceByAccessLevel:t})}return e;case s.ShareModalActionTypes.SHARE_MODAL_OPEN:return Object.assign(Object.assign({},e),{selectedAudienceByAccessLevel:{}});default:return e}}})),define("modules/clean/sharing/share_modal",["require","exports","tslib","immutable","react","classnames","modules/clean/flux/store_listener","modules/clean/react/pass/constants","spectrum-sharing/share_modal/sharing_settings/utils/sharing_settings_constants","spectrum-sharing/utils/logging","modules/clean/react/pass/store","spectrum-sharing/utils/sharing_constants","modules/clean/sharing/views/constants","ts-key-enum","modules/clean/sharing/member_constructors","modules/clean/sharing/stores/sharing_info","modules/clean/sharing/ui_util","modules/clean/sharing/gating_util","modules/clean/sharing/sharing_settings_modal","modules/clean/sharing/views/modal_content_spectrum","modules/clean/viewer","spectrum/modal/index","modules/core/i18n","modules/clean/ux_analytics/utils","modules/clean/sharing/api/client","modules/clean/stormcrow/stormcrow_exposure_logger"],(function(e,t,s,n,i,a,r,o,l,d,c,h,p,u,m,g,_,f,S,E,M,C,b,I,v,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ShareModal=void 0,n=s.__importStar(n),i=s.__importDefault(i),a=s.__importDefault(a);class T extends i.default.Component{constructor(e){super(e),this.spectrumModalClassName="scl-share-modal",this.handleKeyDown=e=>{e.key===u.Key.Escape&&this.onModalCloseClick()},this.preventEventBubbling=e=>e.stopPropagation(),this.onModalCloseClick=()=>{const{onCancel:e}=this.props;e&&e();const t=this.getTokenizer();t&&t.finishLogging(!1),this.setState({open:!1}),I.dispatchModalClosed(),this.props.sharingInfo.showOffTeamSharingSurvey(this.props.contactsError),_.trackUserLeapEvent(_.SharingUserLeapEvent.SHARE_MODAL_CLOSE,this.props.contentInfo.extras.origin),_.logTiburonEvent(this.props.contentInfo,this.props.user.id,d.TiburonEventName.CloseShareModal)},this.getSpectrumModalElement=()=>document.getElementsByClassName(this.spectrumModalClassName)[0],this.onModalReady=()=>{I.dispatchModalOpened();const e=this.getSpectrumModalElement();e&&e.addEventListener("keypress",this.preventEventBubbling,!1)},this.handleDismiss=()=>{this.showPreviousScreen(),this.props.openSettingsFromTheExternalSharePageQuickActions&&this.onModalCloseClick()},this.showPreviousScreen=()=>{this.setState({currentScreen:this.state.previousScreen})},this.onSettingsClick=()=>{_.logTiburonEvent(this.props.contentInfo,this.props.user.id,this.props.sharingInfo.isFolder()?d.TiburonEventName.OpenFolderSettingsModal:d.TiburonEventName.OpenFileSettingsModal),this.setState({currentTab:this.props.sharingInfo.isFolder()?l.FOLDER_SETTINGS:l.FILE_SETTINGS,previousScreen:this.state.currentScreen,currentScreen:h.SETTINGS_SCREEN})},this.onLinkSettingsClick=()=>{let e=l.VIEW_LINK_SETTINGS;this.props.sharingInfo.permissionsObj().canCreateEditLink()&&(e=l.EDIT_LINK_SETTINGS),_.logTiburonEvent(this.props.contentInfo,this.props.user.id,d.TiburonEventName.OpenLinkSettingsModal,{settings_tab:e}),this.setState({currentTab:e,previousScreen:this.state.currentScreen,currentScreen:h.SETTINGS_SCREEN})},this.state={open:!0,currentScreen:e.initialScreen?e.initialScreen:h.SHARE_SCREEN,currentTab:e.initialCurrentTab,previousScreen:h.SHARE_SCREEN}}componentDidMount(){var e;document.addEventListener("keydown",this.handleKeyDown,!1);const t=new y.StormcrowExposureLogger,s=null===(e=this.props.sharingInfo.getExperiments())||void 0===e?void 0:e.sharingOneClickCopyLink;s&&t.logExposure("sharing_one_click_copy_link",s)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown,!1);const e=this.getTokenizer();this.props.actionHandler.onShareModalUnmount(e);const t=this.getSpectrumModalElement();t&&t.removeEventListener("keypress",this.preventEventBubbling,!1)}getTokenizer(){return this.refs.content&&this.refs.content.getWrappedComponent()&&this.refs.content.getWrappedComponent().refs.tokenizer}getClient(){return this.props.sharingInfo.isFolder()?new v.FolderShareApiClient({userId:this.props.user.id,isNonUserRelativeContext:this.props.isInContentManager}):new v.FileShareApiClient({userId:this.props.user.id})}getIsPassEnabled(){const e=c.passStore.getPassPermissions(this.props.contentInfo.extras.fileId);return!!e&&e.canReadPresence}isPassInfoLoaded(){return o.fetchingStatusIsComplete(this.props.passFetchingStatus)}shouldRenderMainLoading(){if(this.props.sharingInfo.fetchMetadataStatus()===p.FETCH_METADATA_STATUS.FAIL)return!1;const e=this.props.isLinkMetadataLoaded||!this.props.sharingInfo.shouldFetchLinkMetadata(),t=this.props.sharingInfo.isMetadataLoaded()&&this.props.sharingInfo.areSharingPrefsLoaded(),s=this.props.sharingInfo.hasNonSelfMembers()||this.props.areMembersFullyLoaded,n=!this.getIsPassEnabled()||this.isPassInfoLoaded(),i=this.props.shouldBlockMemberListOnPassLoad&&!n;return!t||!s||i||!e}getFinalUIMode(){return this.props.uiMode===p.MODES.POINTER?p.MODES.POINTER:this.shouldRenderMainLoading()?p.MODES.LOADING:this.shouldRenderShareME()?p.MODES.EVOLUTION:this.props.uiMode}render(){let e;if(e=this.props.sharingInfo.isFolder()?this.props.sharingInfo.folderPolicy():this.props.sharingInfo.filePolicy(),this.state.currentScreen===h.SETTINGS_SCREEN&&e)return i.default.createElement(S.SharingSettingsModal,{className:this.spectrumModalClassName,actionHandler:this.props.actionHandler,sharingInfo:this.props.sharingInfo,sharingPrefs:this.props.sharingPrefs,client:this.getClient(),currentTab:this.state.currentTab,currentPolicy:e,folderName:this.props.sharingInfo.name(),isFolder:this.props.sharingInfo.isFolder(),isSharedFolder:this.props.contentInfo.isSharedFolder(),isFolderInsideTeamFolderTree:this.props.isFolderInsideTeamFolderTree,isInContentManager:this.props.isInContentManager,isTeamSharedFolder:this.props.isTeamSharedFolder,isUserOnOwnerTeam:this.props.isUserOnOwnerTeam,linkMetadata:this.props.linkMetadata,ownerTeam:this.props.ownerTeam,permissions:this.props.permissions,user:this.props.user,onDismiss:this.handleDismiss,onSuccessSharing:this.props.onSuccessSharing});{const e=a.default(this.spectrumModalClassName,{"scl-share-modal--overflow-visible":this.getFinalUIMode()===p.MODES.EVOLUTION});return i.default.createElement(C.Modal,{appElement:document.getElementById("embedded-app")||document.body,ariaLabel:b.intl.formatMessage({id:"RQGLnS",defaultMessage:"Sharing Modal"}),className:e,bodyClassName:"scl-share-modal-content uxa-modal",bodyId:"unified-share-modal",displayCloseButton:!1,open:this.state.open,width:540,overlayClassName:"file-viewer-modal-overlay",overlayClickClose:!0,onReady:this.onModalReady,onRequestClose:this.onModalCloseClick},this.renderModalContent())}}renderModalContent(){const e=!!(this.props.contentInfo.isFile()?this.props.filePolicy&&this.props.filePolicy.viewer_info_policy:this.props.folderPolicy&&this.props.folderPolicy.viewer_info_policy),t={currentScreen:this.state.currentScreen,headerId:"unified-share-modal-title",isCreatingNewFolder:this.isCreatingNewFolder(),isLimitedTeam:this.props.viewer.team_is_limited,isPassEnabled:this.getIsPassEnabled(),mode:this.getFinalUIMode(),showContentManagerBridge:this.shouldRenderContentManagerBridge(),showPassFileSettings:e,onLinkSettingsClick:this.onLinkSettingsClick,onModalCloseClick:this.onModalCloseClick,onSettingsClick:this.onSettingsClick},s=Object.assign(Object.assign({},this.props),t);return i.default.createElement(E.ShareModalContentSpectrum,Object.assign({},s))}shouldRenderContentManagerBridge(e=!1){return!this.props.isInContentManager&&(!!f.GoldenGate.hasContentManagerAndSuperAdmin(this.props.user.id)&&(!!this.props.isTeamSharedFolder||!(!this.props.isFolderInsideTeamFolderTree||!this.props.isUserOnOwnerTeam)&&(e||!this.props.sharingPermissions.canInviteEditor())))}isCreatingNewFolder(){const e=this.props.contentInfo;return e.isFolder()&&!e.extras.exists}notRenderShareME(){return this.props.sharingInfo.fetchMetadataStatus()===p.FETCH_METADATA_STATUS.FAIL||!this.props.sharingInfo.shouldFetchLinkMetadata()}shouldRenderShareME(){return!this.notRenderShareME()}}T.displayName="ShareModal",t.ShareModal=r.listenToStores(T,{sharingInfoStore:g.sharingInfoStore,passStore:c.passStore},e=>{const t=e.actionHandler.getSharingInfo(),s=t.getInitialProps(),{groupSeenStateInfo:i,linkSeenStateInfo:a,presentAccountIds:r,passFetchingStatus:o}=e.actionHandler.getPassInfo();return{sharingInfo:t,actionHandler:e.actionHandler,areMembersFullyLoaded:t.areMembersFullyLoaded(),areSharingPrefsLoaded:t.areSharingPrefsLoaded(),canChangeOptions:t.permissionsObj().canChangeOptions(),canEdit:t.permissionsObj().canEdit(),canRelinquishMembership:t.permissionsObj().canRelinquishMembership(),canShareLink:t.canShareLink(),canUnshareFile:t.permissionsObj().canUnshare(),canUnshareFolder:t.permissionsObj().canUnshare(),canUpdateConfidentiality:t.permissionsObj().canUpdateConfidentiality(),contactsError:t.contactsError(),contentInfo:t.contentInfo(),contentNameMessage:t.contentNameMessage(),contentNameMessageLevel:t.contentNameMessageLevel(),filePolicy:t.filePolicy(),folderPolicy:t.folderPolicy(),guestMembers:m.constructGuests(r),groupSeenStateInfo:i,hasDisplayableMembers:t.hasDisplayableMembers(),hasParentSharedFolder:t.hasParentSharedFolder(),initialContentName:s.initialContentName,initialRecipientTokens:t.initialRecipientTokens(),sharingPrefs:t.sharingPrefs(),isConfidentialFolder:t.isConfidentialFolder(),isContentNameFocused:t.isContentNameFocused(),isFolderInsideTeamFolderTree:t.isFolderInsideTeamFolderTree(),isInContentManager:s.isInContentManager,isLinkMetadataLoaded:t.isLinkMetadataLoaded(),isMetadataLoaded:t.isMetadataLoaded(),isOwner:t.isOwner(),isCurrentAccountLoaded:t.isCurrentAccountLoaded(),isTeamSharedFolder:t.isTeamSharedFolder(),isTokenizerEmpty:t.isTokenizerEmpty(),isUserOnOwnerTeam:t.isUserOnOwnerTeam(),linkMembers:m.constructLinkMembers(a),linkMetadata:t.linkMetadata(),linkOnlyReason:t.linkOnlyReason(),memberCounts:t.memberCounts(),memberCountWithRecipients:t.memberCountWithRecipients(),members:t.members(),metadata:t.metadata(),ownerTeam:t.ownerTeam(),passFetchingStatus:o,pendingMemberAction:t.pendingMemberAction(),permissions:t.permissions(),sharingPermissions:t.permissionsObj(),presentAccountIds:n.Set(r),recipientMessage:t.recipientMessage(),recipientTokens:t.recipientTokens(),shareButtonLabelOverride:s.shareButtonLabelOverride,shareFolderPromise:t.shareFolderPromise(),shouldBlockMemberListOnPassLoad:t.shouldBlockMemberListOnPassLoad(),initialScreen:e.initialScreen,initialCurrentTab:e.initialCurrentTab,teamPolicy:t.teamPolicy(),uiMode:t.uiMode(),user:t.user(),onCancel:s.onCancel,onCreateGroupCallback:t.onCreateGroupCallback(),onDeleteLink:s.onDeleteLink,onSetContentNameAndSendShareFail:s.onSetContentNameAndSendShareFail,onShareClick:s.onShareClick,onSuccessSharing:s.onSuccessSharing,teamGroupInfo:s.teamGroupInfo,viewer:M.Viewer.get_viewer(),focusOnMount:s.focusOnMount,showSharingQuestionnaire:t.getShowSharingQuestionnaire(),openSettingsFromTheExternalSharePageQuickActions:e.actionHandler.getOpenSettingsFromTheExternalSharePageQuickActions()}})})),define("modules/clean/sharing/share_modal_icon",["require","exports","tslib","react","spectrum/icon_content/index","modules/clean/filetypes","modules/clean/react/icon/file_icon","modules/clean/react/icon/icon_helper"],(function(e,t,s,n,i,a,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ShareModalIcon=void 0,n=s.__importDefault(n);class l extends n.default.Component{render(){return this.props.isFolder?this.renderFolder():this.renderFile()}renderFile(){const e={file:{type:a.FileTypes.FILE,fq_path:this.props.filename},className:this.props.className,variant:"small"};return n.default.createElement(r.FileIcon,Object.assign({},e))}renderFolder(){let e=a.FileTypes.FOLDER;this.props.pathExists&&(this.props.isTeamSharedFolder?e=a.FileTypes.TEAM_SHARED_FOLDER:this.props.isSharedFolder&&(e=a.FileTypes.SHARED_FOLDER));const t=o.spectrumFolderIcon({fileType:e,isViewOnly:this.props.isViewOnly,isInTeamFolderTree:this.props.isFolderInsideTeamFolderTree,size:o.SpectrumIconSize.Small,isConfidential:this.props.isConfidentialFolder||!1,iconPostfix:this.props.isConfidentialFolder?"_admin_view":""});return n.default.createElement(i.IconContent,{name:t,"aria-label":this.props.alt,role:"img",className:this.props.className})}}t.ShareModalIcon=l,l.displayName="ShareModalIcon"})),define("modules/clean/sharing/share_modal_util",["require","exports","tslib","modules/clean/account/email","modules/clean/account/email_verify_reasons","modules/clean/contacts/contact","modules/clean/contacts/types","modules/clean/filetypes","modules/clean/react/browse/action_logger","modules/clean/react/browse/models","modules/clean/react/teams/modals/limited_team_share_folder_modal","modules/clean/sharing/actions/share_modal","modules/clean/sharing/api/client","spectrum-sharing/utils/sharing_constants","modules/clean/sharing/content_info","modules/clean/sharing/public_folder/public_folder","modules/clean/sharing/share_modal","modules/clean/sharing/ui_util","modules/clean/viewer","spectrum-sharing/utils/logging","spectrum-sharing/utils/sharing_constants"],(function(e,t,s,n,i,a,r,o,l,d,c,h,p,u,m,g,_,f,S,E,M){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.showPrefilledShareModal=t.showNewFolderShareModal=t.getShareModalInfo=t.showFastrakShareModalIfAllowed=t.showShareModal=t.getSharingInfo=t.generateModalSessionId=void 0,r=s.__importDefault(r),l=s.__importStar(l),c=s.__importStar(c),t.generateModalSessionId=()=>(new Date).getTime().toString(),t.getSharingInfo=function(e,s,n={}){let i=null;"number"==typeof e&&(e=S.Viewer.get_viewer().get_user_by_id(e)),null==n.userHomeNs&&(n.userHomeNs=e.home_ns_id);let a=t.getShareModalInfo(s),r=null;if(null!=a){if(a=Object.assign(Object.assign({},a),n),a.modalSessionId||(a.modalSessionId=t.generateModalSessionId()),void 0===n.logShareModalView||n.logShareModalView){const{nsId:t,sjid:s,fileId:n,filename:i,fqPath:r}=a;l.logViewShareModal({uid:e.id,modal_session_id:a.modalSessionId||"",file_nsid:t,file_sjid:s,file_id:n,file_name:i,file_path:r})}try{i=m.ContentInfo.createFromParams(a)}catch(e){i=null}r=s instanceof d.BrowseContext?s:a.browseContext}return{browseContext:r,contentInfo:i,shareModalInfo:a,user:e}},t.showShareModal=function(e,s,a={},r,o,l=!0){let d,c,m;if(({browseContext:d,contentInfo:c,shareModalInfo:m,user:e}=t.getSharingInfo(e,s,a)),null==c||null==m)return!1;if(f.logTiburonEvent(c,e.id,E.TiburonEventName.BeginShareFlow),m&&t.showFastrakShareModalIfAllowed(e,m,d))return!0;if(!m.skipPublicFolderCheck&&c&&d){const t=g.makePublicFolderLink(e.id,d.config,c.displayPath(),c.isFolder());if(t)return g.showPublicFolderLinkModal(t),!0}const S=(null!=d?d.isNonUserRelativeContext:void 0)||m.isNonUserRelativeContext;let C=i.EmailVerificationReasons.SHMODAL;if(m.origin===u.SHARE_ACTION_ORIGIN_TYPE.PREVIEW_PAGE&&(C=i.EmailVerificationReasons.SHARE_FILEVIEWER),S||n.EmailVerification.get_for_user(e).verified_or_show(C,m.onCancel)){const t=new(c.isFolder()?p.FolderShareApiClient:p.FileShareApiClient)({userId:e.id,isNonUserRelativeContext:S}),n=new h.ShareModalActionHandler(t,e,_.ShareModal,r,o,a.openSettingsFromTheExternalSharePageQuickActions),{inLinksPage:i}=m,d=m.prefillContacts,u=n.initializeShareModal({contentInfo:c,initialRecipientTokens:d,inLinksPage:i},{client:t,content:s,user:e,onDeleteLink:m.onDeleteLink,teamGroupInfo:c.teamGroupInfo(),isInContentManager:!!S,onSuccessSharing:m.onSuccessSharing,shareAsConfidential:!!m.shareAsConfidential,initialContentName:m.initialContentName,shouldSyncThisFolder:m.shouldSyncThisFolder,recipientMessage:m.recipientMessage,onCreateGroupCallback:m.onCreateGroupCallback,onShareClick:m.onShareClick,shouldSuppressRedirectToBrowse:m.shouldSuppressRedirectToBrowse,shouldCloseImmediately:m.shouldCloseImmediately,onCancel:m.onCancel,onClose:m.onClose,onSetContentNameAndSendShareFail:m.onSetContentNameAndSendShareFail,shareButtonLabelOverride:m.shareButtonLabelOverride,focusOnMount:l,showSharingQuestionnaire:m.showSharingQuestionnaire,experiments:m.experiments});a.openLinkSettings?u.then(()=>n.handleLinkSettingsClick()):a.initialScreen&&a.initialScreen===M.MANAGE_SCREEN?n.showScreen(M.MANAGE_SCREEN):n.openShareModal()}else f.logTiburonEvent(c,e.id,E.TiburonEventName.ShareModalEmailUnverified);return!0},t.showFastrakShareModalIfAllowed=function(e,t,s){return!(!t.isTeamSharedFolder||!S.Viewer.get_viewer().team_is_limited)&&(c.showModalInstance({fqPath:t.fqPath}),!0)},t.getShareModalInfo=function(e){if(e instanceof d.File){const t=[o.FileTypes.FILE,o.FileTypes.PACKAGE].indexOf(e.type)>-1;return{exists:!e.isDeleted,fileId:e.file_id,fqPath:e.fq_path,isFolder:!t,isTeamSharedFolder:e.type===o.FileTypes.TEAM_SHARED_FOLDER,isFolderInsideTeamFolderTree:e.is_in_team_folder_tree,sjid:e.sjid,nsId:e.ns_id,nsPath:e.ns_path,targetNsId:e.target_ns}}return e instanceof d.BrowseContext?C(e):e};const C=function(e){return e.isInFolderMode?e.isInsideSharedFolder?e.currentNSPath?{fqPath:e.currentFQPath,isFolder:!0,nsId:e.currentNSID,nsPath:e.currentNSPath,targetNsId:null}:{fqPath:e.currentMountPoint,isFolder:!0,nsId:null,nsPath:e.currentMountPoint,targetNsId:e.currentNSID}:{fqPath:e.currentFQPath,isFolder:!0,nsId:e.currentNSID,nsPath:e.currentNSPath,targetNsId:null}:{fqPath:e.currentFQPath,isFolder:!1,nsId:e.currentNSID,nsPath:e.currentNSPath,targetNsId:null}};t.showNewFolderShareModal=function(e,s=null,n=null,i=null,a=!1,r=!1,o=null,l,d,c,h,p=null,m=null,g,_,S,E,M=!0,C){s||(s=t.generateModalSessionId());const b={fqPath:(function(){let e="";const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(let s=1;s<=100;s++)e+=t.charAt(Math.floor(Math.random()*t.length));return f.getNewFolderPathFromContentName(e,n||"")})(),isFolder:!0,exists:!1,origin:u.SHARE_ACTION_ORIGIN_TYPE.WIZARD,modalSessionId:s,isNonUserRelativeContext:r,isTeamSharedFolder:!1,initialContentName:i,shareAsConfidential:a,shouldSyncThisFolder:o,shouldSuppressRedirectToBrowse:p,shouldCloseImmediately:m,onCancel:g,onClose:_,onSetContentNameAndSendShareFail:S,shareButtonLabelOverride:E,logShareModalView:M,experiments:C},I={};return c&&(I.onSuccessSharing=c),h&&(I.onShareClick=h),t.showShareModal(e,b,I,l,d)},t.showPrefilledShareModal=function({user:e,sharePrefillEmails:s,content:n,setUrl:i,contentManagerValidateFolderPath:o,extras:l}){let d,c;return s&&s.length>0?(d=u.SHARE_ACTION_ORIGIN_TYPE.GRANT_ACCESS,c=s.map(e=>new a.Contact({type:r.default.EMAIL,email:e,name:"",query:e,pending:!0}))):(d=u.SHARE_ACTION_ORIGIN_TYPE.DESKTOP_CLIENT,c=[]),t.showShareModal(e,n,Object.assign({origin:d,prefillContacts:c},l),i,o)}})),define("modules/clean/sharing/share_modal_dropdown_util",["require","exports","modules/clean/sharing/access_level","spectrum-sharing/utils/sharing_constants","modules/clean/sharing/strings","modules/core/i18n"],(function(e,t,s,n,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getMemberActionInfo=t.shouldShowMemberAction=void 0,t.shouldShowMemberAction=function(e,t,s,i,a){return t===s||i&&i.get(e)&&i.get(e).allow||t===n.MEMBER_ACTION.REMOVE&&a},t.getMemberActionInfo=function(e){return[[n.MEMBER_ACTION.MAKE_EDITOR,{value:s.ACCESS_LEVEL.WRITER,title:i.ACCESS_NAME[s.ACCESS_LEVEL.WRITER],folder_description:i.MEMBER_ACTION_FOLDER[n.MEMBER_ACTION.MAKE_EDITOR],file_description:i.MEMBER_ACTION_FILE[n.MEMBER_ACTION.MAKE_EDITOR]}],[n.MEMBER_ACTION.MAKE_VIEWER,{value:s.ACCESS_LEVEL.READER,title:i.ACCESS_NAME[s.ACCESS_LEVEL.READER],folder_description:i.MEMBER_ACTION_FOLDER[n.MEMBER_ACTION.MAKE_VIEWER],file_description:i.MEMBER_ACTION_FILE[n.MEMBER_ACTION.MAKE_VIEWER]}],[n.MEMBER_ACTION.MAKE_VIEWER_NO_COMMENT,{value:s.ACCESS_LEVEL.READER_NO_COMMENT,title:i.ACCESS_NAME[s.ACCESS_LEVEL.READER_NO_COMMENT],folder_description:i.MEMBER_ACTION_FOLDER[n.MEMBER_ACTION.MAKE_VIEWER_NO_COMMENT],file_description:i.MEMBER_ACTION_FILE[n.MEMBER_ACTION.MAKE_VIEWER_NO_COMMENT]}],[n.MEMBER_ACTION.MAKE_OWNER,{value:s.ACCESS_LEVEL.OWNER,title:a.intl.formatMessage({id:"+ZJXxL",defaultMessage:"Make owner"})}],[n.MEMBER_ACTION.REMOVE,{value:"remove",title:e?a.intl.formatMessage({id:"eTtbKw",defaultMessage:"Remove my access"}):a.intl.formatMessage({id:"6WOQfa",defaultMessage:"Remove"})}],[n.MEMBER_ACTION.MANAGE_LINK_ACCESS,{value:"manage_link_access",title:a.intl.formatMessage({id:"qG3VMJ",defaultMessage:"Manage access"})}]]}})),define("modules/clean/sharing/sharing_settings_dropdown",["require","exports","tslib","react","spectrum/dropdown_menu/index","spectrum/dropdown_menu/index","spectrum-sharing/components/sharing_dropdown_menu/index"],(function(e,t,s,n,i,a,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SettingDropdown=void 0,n=s.__importDefault(n);class o extends n.default.Component{constructor(){super(...arguments),this.handleSelection=e=>{this.props.onValueSelected(e)}}render(){return n.default.createElement(r.SharingDropdownMenu,{disabled:this.props.disabled,onSelection:this.handleSelection,position:"right"},this.renderButton(),n.default.createElement(a.Menu,null,this.renderMenuItems()))}renderButton(){return n.default.createElement(i.DropdownMenuButton,{className:"sharing-settings-dropdown__button",disabled:this.props.disabled},this.props.optionsDict[this.props.currentValue].label)}renderMenuItems(){return this.props.valuesList.map(e=>n.default.createElement(r.SharingDropdownMenuItem,{key:e,value:e,label:this.props.optionsDict[e].label,description:this.props.optionsDict[e].description,selected:e===this.props.currentValue}))}}t.SettingDropdown=o,o.displayName="SettingDropdown"})),define("modules/clean/sharing/sharing_settings_modal",["require","exports","tslib","react","classnames","modules/core/browser","modules/clean/sharing/share_page/action_types","modules/clean/flux/dispatcher","modules/clean/react/browse/constants","modules/clean/em_string","modules/clean/filepath/filepath","modules/clean/react/components/css","spectrum-sharing/components/fixed_tabbed_container/index","spectrum/modal/index","spectrum/button/index","modules/clean/react/components/modal","spectrum-sharing/components/sharing_modal_banner/index","spectrum-sharing/utils/sharing_constants","modules/clean/sharing/sharing_settings_util","modules/clean/react/util","modules/clean/sharing/ui_notifications_util","modules/clean/sharing/content_manager","api_v2/error","modules/constants/trademark","modules/clean/sharing/delete_link_modal","modules/clean/sharing/gating_util","modules/clean/react/snackbar","modules/core/i18n","spectrum-sharing/utils/logging","modules/clean/sharing/ui_util","modules/clean/sharing/api/types/metadata","modules/clean/sharing/views/share_modal/inform_owner_update_section","modules/clean/sharing/views/sharing_settings_file_folder_policy_view","modules/clean/sharing/views/sharing_settings_link_section","modules/clean/sharing/confirmation_modals/confirm_recursive_policy_change_modal","modules/clean/sharing/confirmation_modals/reset_access_modal","spectrum-sharing/share_modal/sharing_settings/utils/sharing_settings_constants","modules/clean/sharing/sharing_tracked_element","modules/clean/sharing/views/share_modal/sharing_modal_upsell_premium_sharing","modules/clean/sharing/views/share_modal_evolution/utils/logging","spectrum-sharing/share_modal/sharing_settings/utils/sharing_settings_util","spectrum-sharing/components/sharing_modal_downgrade_banner/index","react-intl","modules/clean/sharing/access_level"],(function(e,t,s,n,i,a,r,o,l,d,c,h,p,u,m,g,_,f,S,E,M,C,b,I,v,y,T,k,w,A,N,L,P,O,F,R,x,D,U,B,H,V,j,q){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SharingSettingsModal=t.SharingSettingsModalUnstyled=void 0,n=s.__importDefault(n),i=s.__importDefault(i),a=s.__importStar(a),c=s.__importStar(c);const G=n.default.createElement;class W extends n.default.Component{constructor(e){super(e),this.handleSaveLinkSettings=()=>{for(const e of this.props.sharingInfo.sharedLinks()){const t=S.getLinkPolicy(e),s=this.state.updatedLinkPolicies[e.url]||t;t.audience!==s.audience&&A.logTiburonEvent(this.props.sharingInfo.contentInfo(),this.props.user.id,w.TiburonEventName.ChangeSharedLinkAudience,Object.assign({old_audience:t.audience,new_audience:s.audience,screen:w.ScreenName.SettingsScreen},B.buildExtraFromLinkMetadata(e)))}this.saveLinkSettings()},this.saveLinkSettings=()=>{const e=this.getLinkSettingsToUpdate();e.errors||this.setState({isSubmitting:!0},()=>{this.props.actionHandler.updateLinkSettings(e.requests).then(()=>{this.setState({isSubmitting:!1}),this.props.onDismiss&&this.props.onDismiss()}).catch(()=>{this.setState({isSubmitting:!1})})})},this.saveFileSettings=()=>{const e=S.getPolicyDiff(this.state.desiredPolicy,this.props.currentPolicy);e&&E.setStatePromise(this,{isSubmitting:!0}).then(()=>this.props.client.updatePolicy({contentId:this.props.sharingInfo.contentId(),newPolicy:e,actions:Object.keys(f.ALPHA_FILE_METADATA_PERMISSIONS)})).catch(b.catchApiError(e=>{this.setState({isSubmitting:!1});const t=e&&e.message;return M.sharingNotificationError(t||k.intl.formatMessage({id:"+iNJRS",defaultMessage:"There was a problem completing this request."})),Promise.reject()})).then(e=>{M.sharingNotificationSuccess(k.intl.formatMessage({id:"Hpq9jD",defaultMessage:"File settings updated."})),this.setState({isSubmitting:!1}),this.props.currentPolicy&&this.props.actionHandler.handleUpdateFilePolicy(e,this.props.currentPolicy),this.props.onDismiss&&this.props.onDismiss()}).then(()=>this.props.actionHandler.resetContactValidations())},this.handleSetFolderPolicy=()=>{const e=S.getPolicyDiff(this.state.desiredPolicy,this.props.currentPolicy),t=t=>{T.Snackbar.complete(k.intl.formatMessage({id:"wGHIQR",defaultMessage:"Folder settings updated."}),"set-folder-policy"),null!=t&&(t.policy.shared_link_policy!==this.props.currentPolicy.shared_link_policy&&(this.props.actionHandler.fetchLinkMetadata(),o.Dispatcher.dispatch({type:l.SharedWithActionType.SIGNAL_SHARED_LINK_DATA_OUT_OF_DATE,data:{fileFqPaths:[this.props.sharingInfo.displayPath()]}})),this.props.actionHandler.handleUpdateSharingSettings(t),o.Dispatcher.dispatch({type:r.SharePageActionTypes.FETCH_FOLDER_POLICY_SUCCESS,user:this.props.user,sharedFolderMetadata:t,policyUpdate:e}),this.props.onSuccessSharing&&this.props.onSuccessSharing()),this.props.onDismiss&&this.props.onDismiss()},s=this.props.sharingInfo.metadata()&&this.props.sharingInfo.metadata().shared_folder_id;if(s)return this.props.client.updatePolicyAlpha({contentId:s,newPolicy:e,url:null!=this.props.linkMetadata?this.props.linkMetadata.url:void 0}).then(t).then(()=>this.props.actionHandler.resetContactValidations());{const s=e=>this.props.actionHandler.reportShareFailure(e);return this.props.actionHandler.shareIfFileFolder(k.intl.formatMessage({id:"AKdTOF",defaultMessage:"Updating folder settings..."}),e).then(t).then(()=>this.props.actionHandler.resetContactValidations()).catch(s)}},this.saveFolderSettings=()=>{this.props.isTeamSharedFolder||this.props.hasParentSharedFolder?F.confirmRecursivePolicyChange({isTeamSharedFolder:this.props.isTeamSharedFolder,onConfirm:this.handleSetFolderPolicy,onCancel:g.Modal.close}):E.setStatePromise(this,{isSubmitting:!0}).then(()=>{this.handleSetFolderPolicy().then(()=>{this.setState({isSubmitting:!1})}).catch(b.catchApiError(()=>this.setState({isSubmitting:!1})))})},this.handleUnshareFolder=()=>{if(A.logTiburonEvent(this.props.sharingInfo.contentInfo(),this.props.user.id,w.TiburonEventName.AttemptRemoveAllMembers),this.props.sharingInfo.metadata()&&null!=this.props.sharingInfo.metadata().shared_folder_id&&this.props.sharingInfo.permissionsObj().canUnshare()){const e=e=>(T.Snackbar.sync(k.intl.formatMessage({id:"2h4tij",defaultMessage:"Unsharing <st>{folder_name}</st>..."},{st:e=>n.default.createElement("strong",null,e),folder_name:d.Emstring.em_snippet(this.props.folderName,f.SNIPPET_SIZES.FILENAME)}),!0,"unshare-folder-notification"),this.props.client.unshare({contentId:this.props.sharingInfo.metadata()&&this.props.sharingInfo.metadata().shared_folder_id,leaveACopy:e}).then(()=>(A.logTiburonEvent(this.props.sharingInfo.contentInfo(),this.props.user.id,w.TiburonEventName.SucceedRemoveAllMembers,{http_status_code:200,response_status:"success"}),T.Snackbar.complete(k.intl.formatMessage({id:"tKbyJ8",defaultMessage:"Unshared <st>{folder_name}</st>."},{st:e=>n.default.createElement("strong",null,e),folder_name:d.Emstring.em_snippet(this.props.folderName,f.SNIPPET_SIZES.FILENAME)}),"unshare-folder-notification"),this.props.actionHandler.refreshSharedWithColumnContentData(),g.Modal.close(),o.Dispatcher.dispatch({type:r.SharePageActionTypes.UNSHARE_FOLDER_SUCCESS,metadata:this.props.sharingInfo.metadata(),user:this.props.user}))).catch(e=>(A.logTiburonEvent(this.props.sharingInfo.contentInfo(),this.props.user.id,w.TiburonEventName.FailRemoveAllMembers,{http_status_code:e.raw&&e.raw.status,error_message:e.error[".tag"]?e.error[".tag"]:"undefined_error"}),"too_many_files"===e.error[".tag"]?this.tooManyFilesSnackbar():M.sharingNotificationError(e.message),o.Dispatcher.dispatch({type:r.SharePageActionTypes.UNSHARE_FOLDER_ERROR,metadata:this.props.sharingInfo.metadata(),user:this.props.user}))));return R.confirmResetAccess({allowLeaveACopy:this.props.sharingInfo.permissionsObj().canLeaveACopy(),contentName:this.props.folderName,isFolder:!0,isNestedSharedFolder:!!this.props.hasParentSharedFolder,onCancel:()=>g.Modal.close(),onConfirm:e})}},this.onSaveSettings=()=>{switch(this.getCurrentTab()){case x.FILE_SETTINGS:return this.saveFileSettings();case x.FOLDER_SETTINGS:return this.saveFolderSettings();case x.EDIT_LINK_SETTINGS:case x.VIEW_LINK_SETTINGS:return this.handleSaveLinkSettings();default:throw new Error("Unknown tab")}},this.onDeleteLink=e=>{this.props.actionHandler.refreshSharedWithColumnLinkData(),this.props.actionHandler.deleteLinkMetadata(e),this.props.onDismiss&&this.props.onDismiss(),this.props.actionHandler.openSharingSettingsModal(this.getCurrentTab())},this.onCancelDeleteLink=()=>{this.props.actionHandler.openSharingSettingsModal(this.getCurrentTab())},this.handleUnshareLink=()=>{const e=this.props.linkMetadata;if(e){const t=this.props.sharingInfo.getInitialProps().onDeleteLink||this.onDeleteLink;v.deleteLinkWithConfirm({client:this.props.client,url:e.url,contentName:e.name,onDeleteLink:()=>{t(e)},onCancel:this.onCancelDeleteLink,actionHandler:this.props.actionHandler})}},this.onUnshare=()=>{switch(this.getCurrentTab()){case x.FILE_SETTINGS:this.handleUnshareFile();break;case x.FOLDER_SETTINGS:this.handleUnshareFolder();break;case x.EDIT_LINK_SETTINGS:case x.VIEW_LINK_SETTINGS:this.handleUnshareLink();break;default:throw new Error("Unknown tab")}},this.renderPrimaryAction=()=>n.default.createElement(m.Button,{className:"confirm-button u-mar-left-s",variant:"primary",disabled:!this.allowSaveSettings()||this.state.isSubmitting,onClick:this.onSaveSettings},this.state.isSubmitting?k.intl.formatMessage({id:"rn6IdR",defaultMessage:"Saving..."}):k.intl.formatMessage({id:"78AHo5",defaultMessage:"Save"})),this.handlePolicyUpdate=(e,t)=>{this.setState({desiredPolicy:this.state.desiredPolicy.set(e,t)})},this.onTabSelected=e=>{this.setState({currentTab:e}),A.logTiburonEvent(this.props.sharingInfo.contentInfo(),this.props.user.id,w.TiburonEventName.ViewSettingsTab,{settings_tab:e})},this.getCurrentTab=()=>this.state.currentTab||this.getTabs()[0].id,this.handleLinkPolicyUpdate=(e,t)=>{const s=this.state.updatedLinkPolicies;if(s[e.url]=t,this.props.sharingInfo.editRighteousLink()){const e=S.getLinkPolicy(this.props.sharingInfo.editRighteousLink()).audience;q.isLinkAudienceLowerAccess(t.audience,e)&&this.setState({showDowngradeBanner:!0}),this.setState({showAdvancedSettingsWarning:!!t.expires||!!t.require_password})}this.setState({updatedLinkPolicies:s})},this.hideDowngradeBanner=()=>{this.setState({showDowngradeBanner:!1})},this.openManageAccess=e=>{e.preventDefault(),this.saveAndManageAccess()},this.saveAndManageAccess=()=>{for(const e of this.props.sharingInfo.sharedLinks()){const t=S.getLinkPolicy(e),s=this.state.updatedLinkPolicies[e.url]||t;t.audience!==s.audience&&A.logTiburonEvent(this.props.sharingInfo.contentInfo(),this.props.user.id,w.TiburonEventName.ChangeSharedLinkAudience,Object.assign({old_audience:t.audience,new_audience:s.audience,screen:w.ScreenName.SettingsScreen},B.buildExtraFromLinkMetadata(e)))}const e=this.getLinkSettingsToUpdate();e.errors||this.setState({isSubmitting:!0},()=>{this.props.actionHandler.updateLinkSettings(e.requests).then(()=>{this.setState({isSubmitting:!1}),this.props.actionHandler.showScreen(f.MANAGE_SCREEN)}).catch(()=>{this.setState({isSubmitting:!1})})})},this.state={currentTab:e.currentTab,isSubmitting:!1,updatedLinkPolicies:{},desiredPolicy:e.currentPolicy,showDowngradeBanner:!1,showAdvancedSettingsWarning:void 0}}componentDidMount(){return s.__awaiter(this,void 0,void 0,(function*(){this.setState({isSubmitting:!1}),A.logTiburonEvent(this.props.sharingInfo.contentInfo(),this.props.user.id,w.TiburonEventName.ViewSettingsScreen,{settings_tab:this.getCurrentTab()}),A.logTiburonEvent(this.props.sharingInfo.contentInfo(),this.props.user.id,w.TiburonEventName.ViewSettingsTab,{settings_tab:this.getCurrentTab()})}))}getLinkSettingsToUpdate(){const e={errors:!1,requests:[]};for(const t of this.props.sharingInfo.sharedLinks()){const s=S.getLinkPolicy(t),n=this.state.updatedLinkPolicies[t.url]||s,i=S.getModifiedSettings(t,n,s);if(i&&i.settings)e.requests.push(i);else if(null===i){e.errors=!0;break}}return e}tooManyFilesSnackbar(){return T.Snackbar.show(G(T.Snackbar,{actionButtonText:k.intl.formatMessage({id:"gk12sS",defaultMessage:"Learn more"}),closeButtonText:k.intl.formatMessage({id:"u/p3Pl",defaultMessage:"Close"}),onActionClick:()=>a.open_tab("/help/files-folders/unshare-folder#foldersize"),title:k.intl.formatMessage({id:"DWcV9y",defaultMessage:"Unsharing unsuccessful. This folder has too many files."}),variant:"fail"}))}render(){const e=this.getTabInfo(this.getCurrentTab());return n.default.createElement(u.UtilityModal,{className:i.default(this.props.className,"scl-settings-modal"),ariaLabel:this.renderTitle(),title:this.renderTitle(),overlayClickClose:!0,primaryAction:this.renderPrimaryAction,secondaryAction:k.intl.formatMessage({id:"d9/SE1",defaultMessage:"Cancel"}),onPrimaryAction:this.onSaveSettings,onSecondaryAction:this.props.onDismiss,onLink:this.onUnshare,link:this.renderUnshareButton(),open:!0,onRequestClose:this.props.onDismiss,bodyClassName:"sharing-settings-utility-modal",overlayClassName:"file-viewer-modal-overlay"},n.default.createElement(p.FixedTabbedContainer,{className:"sharing-settings-modal",tabs:this.getTabs(),activeTabId:this.getCurrentTab(),onTabSelected:this.onTabSelected},n.default.createElement("div",{className:"sharing-settings-modal__banners"},e.banner,e.description),n.default.createElement("div",{className:"sharing-settings-modal__tab-content"},e.content)))}renderTitle(){let e;const t={file_or_folder_name:d.Emstring.em_snippet(this.props.folderName,f.SNIPPET_SIZES.FILENAME)};return e=k.intl.formatMessage({id:"NHPru6",defaultMessage:"Settings for “{file_or_folder_name}”"},t),e}handleUnshareFile(){A.logTiburonEvent(this.props.sharingInfo.contentInfo(),this.props.user.id,w.TiburonEventName.AttemptRemoveAllMembers);R.confirmResetAccess({allowLeaveACopy:!1,contentName:this.props.folderName,isFolder:!1,isNestedSharedFolder:!1,onConfirm:()=>(T.Snackbar.sync(k.intl.formatMessage({id:"JopplL",defaultMessage:"Unsharing <st>{file_name}</st>..."},{st:e=>n.default.createElement("strong",null,e),file_name:this.props.folderName}),!0,"unshare-file-notification"),this.props.client.unshare({contentId:this.props.sharingInfo.contentId()}).then(()=>{A.logTiburonEvent(this.props.sharingInfo.contentInfo(),this.props.user.id,w.TiburonEventName.SucceedRemoveAllMembers,{http_status_code:200,response_status:"success"}),o.Dispatcher.dispatch({type:l.SharedWithActionType.SIGNAL_SHARED_FILE_DATA_OUT_OF_DATE,data:{fileIds:[this.props.sharingInfo.contentId()]}}),T.Snackbar.complete(k.intl.formatMessage({id:"4fsv5F",defaultMessage:"Unshared <st>{file_name}</st>."},{st:e=>n.default.createElement("strong",null,e),file_name:this.props.folderName}),"unshare-file-notification"),g.Modal.close()}).catch(e=>{A.logTiburonEvent(this.props.sharingInfo.contentInfo(),this.props.user.id,w.TiburonEventName.FailRemoveAllMembers,{http_status_code:e.raw&&e.raw.status,error_message:e.error[".tag"]?e.error[".tag"]:"undefined_error"})})),onCancel:()=>g.Modal.close()})}renderUnshareButton(){let e;return this.props.sharingInfo.permissionsObj().canUnshare()&&(!this.props.isFolder||!this.props.isInContentManager&&this.props.isSharedFolder)&&(e=this.props.isFolder?this.props.isFolderInsideTeamFolderTree?k.intl.formatMessage({id:"rHXOII",defaultMessage:"Reset membership"}):k.intl.formatMessage({id:"z/VsbM",defaultMessage:"Unshare folder"}):k.intl.formatMessage({id:"IRyrtr",defaultMessage:"Unshare file"})),e}getTabs(){let e=[];const t={id:x.FILE_SETTINGS,label:k.intl.formatMessage({id:"vTaaOS",defaultMessage:"File settings"})},s={id:x.FOLDER_SETTINGS,label:k.intl.formatMessage({id:"3QmSF8",defaultMessage:"Folder settings"})};this.props.currentPolicy&&(e=this.props.isFolder?[s]:[t]);const n={id:x.EDIT_LINK_SETTINGS,label:k.intl.formatMessage({id:"/0odKW",defaultMessage:"Link for editing"})},i={id:x.VIEW_LINK_SETTINGS,label:k.intl.formatMessage({id:"O2aovx",defaultMessage:"Link for viewing"})};return this.showEditLinkSettingsTab()&&e.push(n),this.showViewLinkSettingsTab()&&e.push(i),e}showEditLinkSettingsTab(){return!!this.props.sharingInfo.editRighteousLink()||(this.props.isFolder?"ON"===this.props.sharingPrefs.create_edit_folder_link_variant&&this.props.sharingInfo.permissionsObj().canInviteEditor()&&!this.props.isTeamSharedFolder&&!this.props.isInContentManager:!this.props.isInContentManager&&this.props.sharingInfo.permissionsObj().canCreateEditLink())}showViewLinkSettingsTab(){return!this.props.isTeamSharedFolder&&!this.props.isInContentManager}isTeamFolderTree(){return this.props.isTeamSharedFolder||this.props.isFolderInsideTeamFolderTree}getFolderSettingsDescription(){let e;if(this.props.sharingInfo.permissionsObj().canChangeOptions()&&!this.props.user.is_team_admin)return e=this.isTeamFolderTree()?k.intl.formatMessage({id:"fYsGwY",defaultMessage:"Only team admins can change these settings."}):k.intl.formatMessage({id:"hLLslJ",defaultMessage:"Only the owner can change these settings."}),n.default.createElement(_.SharingModalBanner,{className:"sharing-settings-modal__banner",type:"default",message:e})}getFileSettingsDescription(){if(this.props.sharingInfo.permissionsObj().canChangeOptions())return n.default.createElement(_.SharingModalBanner,{className:"sharing-settings-modal__banner",type:"default",message:k.intl.formatMessage({id:"JK63j9",defaultMessage:"Anyone with edit access can change these settings."})})}getFileSettingsBanner(){if(this.props.sharingInfo.permissionsObj().canChangeOptions())return;let e;return this.props.currentPolicy&&this.props.permissions&&(e=S.getPassDenyReason(this.props.currentPolicy,this.props.permissions)),e||(e=k.intl.formatMessage({id:"lxNU0Z",defaultMessage:"You don’t have permission to change the settings on this file."})),n.default.createElement(_.SharingModalBanner,{className:"sharing-settings-modal__banner",type:"error",message:e})}shouldRenderContentManagerBridge(){return!this.props.isInContentManager&&(!!y.GoldenGate.hasContentManagerAndSuperAdmin(this.props.user.id)&&(!!this.props.isTeamSharedFolder||!(!this.props.isFolderInsideTeamFolderTree||!this.props.isUserOnOwnerTeam)&&(this.props.currentTab===x.FOLDER_SETTINGS||!this.props.sharingInfo.permissionsObj().canInviteEditor())))}getFolderSettingsBanner(){let e;const t=k.intl.formatMessage({id:"PXwJ3O",defaultMessage:"These settings will apply to all folders inside “{folder_name}”."},{folder_name:this.props.folderName});if(this.props.isInContentManager&&this.isTeamFolderTree())e=t;else if(this.shouldRenderContentManagerBridge()){const t=c.parent_dir(this.props.sharingInfo.fqPath()),s=C.genContentManagerBridgeUri({containingFolder:t,filenameToSelect:this.props.folderName}),i=k.intl.formatMessage({id:"+XzGBK",defaultMessage:"These settings will apply to all folders inside “{folder_name}”. You can change these settings in the Admin Console."},{folder_name:this.props.folderName});e=n.default.createElement("div",null,i+" ",n.default.createElement("div",null,n.default.createElement("a",{href:s.toString(),target:"_blank"},k.intl.formatMessage({id:"hwq/Wo",defaultMessage:"Go to Admin Console."}))))}else if(this.isTeamFolderTree())e=n.default.createElement("div",null,t+" ",n.default.createElement("div",null,n.default.createElement("a",{href:"/team",target:"_blank"},k.intl.formatMessage({id:"RgAHdC",defaultMessage:"To edit, ask your admin."}))));else{if(this.props.sharingInfo.permissionsObj().canChangeOptions())return this.props.isInContentManager&&!this.isTeamFolderTree()?n.default.createElement(L.InformOwnerUpdateSection,{isInSharingSettingsModal:!0}):void 0;e=k.intl.formatMessage({id:"84NDsw",defaultMessage:"You don’t have permission to change the settings on this folder."})}return n.default.createElement(_.SharingModalBanner,{className:"sharing-settings-modal__banner",type:"error",message:e})}linkControlPolicyWarning(e){const t=this.getCurrentLink(e);if(!t)return;const{link_permissions:s}=t,i=S.getLinkPolicy(t),a=this.state.updatedLinkPolicies[t.url]||i,r=H.getLinkControlPolicyWarningText(i,a,s,k.intl);return r?n.default.createElement(_.SharingModalBanner,{className:"sharing-settings-modal__banner",type:"warn",message:r}):void 0}editFolderLinkSettingWarning(e){if("editor"!==e||!this.props.sharingInfo.isFolder())return;const t=this.getCurrentLink(e);if(t){if(void 0===this.state.showAdvancedSettingsWarning){if(!t.link_permissions.require_password&&!t.expires)return}else if(!this.state.showAdvancedSettingsWarning)return;return n.default.createElement(_.SharingModalBanner,{className:"sharing-settings-modal__banner",type:"warn",message:k.intl.formatMessage({id:"pL1I+c",defaultMessage:"This setting won't apply to people who add this folder to their Dropbox account."}),descriptionLinkUrl:"https://help.dropbox.com/files-folders/share/set-link-permissions",descriptionLinkText:k.intl.formatMessage({id:"TV9B2p",defaultMessage:"Learn More"})})}}getCurrentLink(e){let t=void 0;return"editor"===e?t=this.props.sharingInfo.editRighteousLink():(t=this.props.sharingInfo.viewRighteousLink(),t||(t=this.props.sharingInfo.shmodelLink())),t}getLinkSettingsBanner(e){let t=!1;const s=this.getCurrentLink(e);if(!s)return;if(s.isRighteousLink())!1===s.link_permissions.can_use_extended_sharing_controls&&(t=!0);else{const e=s.link_permissions;t=e.audience_options.filter(e=>e.disallowed_reason===N.LinkAudienceDisallowedReason.UserAccountType).length>0||!1===e.can_disallow_download}if(this.props.sharingInfo&&this.props.sharingInfo.isFamilyUser()&&(t=!1),!t)return;let i,a;1===this.props.user.is_team?(i="/team/upgrade",a=k.intl.formatMessage({id:"TfYT+f",defaultMessage:"Upgrade to {trademark_business} to enable all link settings."},{trademark_business:I.TRADEMARK_BUSINESS})):(i="/upgrade?oqa=sfp&_tk=sg_pro_bundle_header",this.props.sharingInfo&&"OFF"!==this.props.sharingInfo.shareModalUpsellPremiumSharingVariant()&&(i=U.getCTALink(this.props.user,this.props.sharingInfo.shareModalUpsellPremiumSharingVariant(),"sg_pro_bundle_header")),a=k.intl.formatMessage({id:"VvOgoh",defaultMessage:"Upgrade to Dropbox {trademark_professional} to enable all link settings."},{trademark_professional:I.TRADEMARK_PROFESSIONAL}));const r=n.default.createElement("div",null,n.default.createElement(D.TrackedLink,{trackingId:"link_settings_pro_upsell",user:this.props.user,contentInfo:this.props.sharingInfo&&this.props.sharingInfo.contentInfo(),href:i,target:"_blank",rel:"noopener noreferrer"},a));return n.default.createElement(_.SharingModalBanner,{className:"sharing-settings-modal__banner",type:"default",message:r})}getFolderSettingPolicies(){const e=[];return Boolean(this.props.ownerTeam)&&e.push(x.MEMBER_POLICY),e.push(x.ACL_UPDATE_POLICY),Boolean(this.props.ownerTeam)&&e.push(x.FOLDER_LINK_AUDIENCE_POLICY),this.props.currentPolicy&&(this.props.currentPolicy instanceof N.FilePolicy||this.props.currentPolicy instanceof N.FolderPolicy)&&null!=this.props.currentPolicy.viewer_info_policy&&!this.shouldRenderContentManagerBridge()&&e.push(x.VIEWER_INFO_POLICY),e}getFileSettingPolicies(){const e=[];return this.props.currentPolicy&&(this.props.currentPolicy instanceof N.FilePolicy||this.props.currentPolicy instanceof N.FolderPolicy)&&null!=this.props.currentPolicy.viewer_info_policy&&e.push(x.VIEWER_INFO_POLICY),e}getTabInfo(e){switch(e){case x.FILE_SETTINGS:return{title:k.intl.formatMessage({id:"vTaaOS",defaultMessage:"File settings"}),banner:this.getFileSettingsBanner(),description:this.getFileSettingsDescription(),content:this.getFileFolderSettingsContent(this.getFileSettingPolicies())};case x.FOLDER_SETTINGS:return{title:k.intl.formatMessage({id:"3QmSF8",defaultMessage:"Folder settings"}),banner:this.getFolderSettingsBanner(),description:this.getFolderSettingsDescription(),content:this.getFileFolderSettingsContent(this.getFolderSettingPolicies())};case x.EDIT_LINK_SETTINGS:return{title:k.intl.formatMessage({id:"/0odKW",defaultMessage:"Link for editing"}),banner:this.getLinkSettingsBannerAndWarning("editor"),description:null,content:this.renderLinkSettings("editor")};case x.VIEW_LINK_SETTINGS:return{title:k.intl.formatMessage({id:"O2aovx",defaultMessage:"Link for viewing"}),banner:this.getLinkSettingsBannerAndWarning("viewer"),description:null,content:this.renderLinkSettings("viewer")};default:throw new Error("tabName not found")}}getFileFolderSettingsContent(e){const t=S.getPolicyDiff(this.state.desiredPolicy,this.props.currentPolicy);return n.default.createElement(P.SharingSettingsFileFolderPolicyView,{policies:e,policyUpdate:t,isFolder:this.props.isFolder,isTeamSharedFolder:this.props.isTeamSharedFolder,isFolderInsideTeamFolderTree:this.props.isFolderInsideTeamFolderTree,teamPolicy:this.props.teamPolicy,ownerTeam:this.props.ownerTeam,onPolicyUpdate:this.handlePolicyUpdate,currentPolicy:this.props.currentPolicy,showContentManagerBridge:this.shouldRenderContentManagerBridge(),permissions:this.props.permissions})}renderLinkSettings(e){if(this.props.sharingInfo)return n.default.createElement("div",null,this.state.showDowngradeBanner&&this.renderDowngradeBanner(),n.default.createElement(O.SharingSettingsLinkSection,{client:this.props.client,sharingInfo:this.props.sharingInfo,sharingPrefs:this.props.sharingPrefs,updatedLinkPolicies:this.state.updatedLinkPolicies,onDeleteLink:this.onDeleteLink,onCancelDeleteLink:this.onCancelDeleteLink,onPolicyUpdate:this.handleLinkPolicyUpdate,actionHandler:this.props.actionHandler,accessLevel:e}))}renderDowngradeBanner(){return n.default.createElement(V.SharingModalDowngradeBanner,{header:k.intl.formatMessage(K.downgradeBannerHeader),subheader:k.intl.formatMessage(K.downgradeBannerSubheader),outlineButtonLabel:k.intl.formatMessage(K.downgradeBannerGotIt),transparentButtonLabel:k.intl.formatMessage(K.downgradeBannerManageLinks),onClickOutlineButton:this.hideDowngradeBanner,onClickCloseButton:this.hideDowngradeBanner,onClickTransparentButton:this.openManageAccess,showCloseButton:!0})}allowSaveSettings(){return[x.EDIT_LINK_SETTINGS,x.VIEW_LINK_SETTINGS].includes(this.getCurrentTab())?Object.keys(this.state.updatedLinkPolicies).length>0:!this.state.desiredPolicy.equals(this.props.currentPolicy)}getLinkSettingsBannerAndWarning(e){const t=this.linkControlPolicyWarning(e),s=this.editFolderLinkSettingWarning(e),i=this.getLinkSettingsBanner(e);if(s||t||i)return n.default.createElement("div",null,s,t,i)}}t.SharingSettingsModalUnstyled=W,W.displayName="SharingSettingsModal";const K=j.defineMessages({downgradeBannerHeader:{id:"V2Zurn",defaultMessage:"People who have used this link might still have access"},downgradeBannerSubheader:{id:"rqdCog",defaultMessage:"You can check the list of people with access and remove them."},downgradeBannerGotIt:{id:"YCTkuR",defaultMessage:"Got It"},downgradeBannerManageLinks:{id:"UBFEXr",defaultMessage:"Who still has access?"}});t.SharingSettingsModal=h.requireCssWithComponent(W,["/static/css/sharing/share_modal-vfllczqU5.css","/static/css/modal-vflp8UKYY.css","/static/js/spectrum-sharing/index.web-vflcBM29v.css"])})),define("modules/clean/sharing/sharing_settings_util",["require","exports","tslib","modules/clean/previews/util","lodash","modules/clean/sharing/api/types/metadata","spectrum-sharing/share_modal/sharing_settings/utils/sharing_settings_constants","modules/clean/sharing/ui_notifications_util","spectrum-sharing/share_modal/sharing_settings/utils/sharing_settings_util","modules/core/i18n"],(function(e,t,s,n,i,a,r,o,l,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.requiresChangeAudienceConfirmation=t.shouldRenderNoPreviewFileWarning=t.getModifiedSettings=t.getLinkPolicy=t.getEffectivePolicyValue=t.getPolicyDiff=t.isCommonSharingSettingsPolicy=t.getPassDenyReason=t.denyReasonToDenyString=t.canChangePolicy=void 0,n=s.__importStar(n),i=s.__importStar(i);const c={shared_folder_member_policy:"team"},h={shared_folder_member_policy:"team"},p={member_policy:"shared_folder_member_policy"};function u(e,t,s,n){switch(e){case r.VIEWER_INFO_POLICY:return!n&&(!!s&&(t&&"enabled"===t.get(r.VIEWER_INFO_POLICY)?!!s.disable_viewer_info&&s.disable_viewer_info.allow:!!s.enable_viewer_info&&s.enable_viewer_info.allow));default:return!1}}function m(e){switch(e){case"restricted_by_parent_folder":return d.intl.formatMessage({id:"98DfV5",defaultMessage:"This setting is turned off for all files in this folder."});case"restricted_by_team":return d.intl.formatMessage({id:"AGa70V",defaultMessage:"Your admin has disabled this setting."});default:return}}function g(e){return-1!==[r.VIEWER_INFO_POLICY].indexOf(e)}t.canChangePolicy=u,t.denyReasonToDenyString=m,t.getPassDenyReason=function(e,t){return"enabled"===e.get(r.VIEWER_INFO_POLICY)?t.disable_viewer_info?m(t.disable_viewer_info.reason):void 0:t.enable_viewer_info?m(t.enable_viewer_info.reason):void 0},t.isCommonSharingSettingsPolicy=g,t.getPolicyDiff=function(e,t){let s;return s=t instanceof a.FilePolicy?new a.FilePolicy:t instanceof a.FolderPolicy?new a.FolderPolicy:new a.LinkPolicy,e.keySeq().toArray().map(n=>{const a=e.get(n),r=t.get(n);("object"==typeof a?i.isEqual(a,r):a===r)||(s=s.set(n,a))}),s},t.getEffectivePolicyValue=function(e,t,s,n,i,a){let r;const o=p[e];null!=o&&null!=i&&(r=i.get(o));let l=null!=(null!=t?t.get(e):void 0)?null!=t?t.get(e):void 0:s.get(e),d=null!=a.change_options&&a.change_options.allow;return null!=r&&c[o]===r&&(d=!1,l=h[o]),g(e)&&(d=u(e,s,a,n)),n&&(d=!1),[l,d]};const _=l.SharingSettingsUtil(d.intl);t.getLinkPolicy=e=>new a.LinkPolicy(_.getLinkPolicy(e)),t.getModifiedSettings=(e,t,s)=>{const n=_.getModifiedSettings(e,t,s);if(n)return n.error?(o.sharingNotificationError(n.error),null):{url:n.url,settings:n.settings,remove_expiration:n.remove_expiration}},t.shouldRenderNoPreviewFileWarning=function(e,t){if(!e)return!1;if(null!=(null!=t?t.preview_type:void 0)){const{preview_type:e}=t;if(Array.from(n.VALID_PREVIEW_TYPES).includes(e))return!1}return!0},t.requiresChangeAudienceConfirmation=function(e,t){const s=l.getAudienceForLink(e.link_permissions);return"password"===t&&"public"===s||"team"===t&&["public","password"].includes(s)||"no_one"===t&&["public","password","team"].includes(s)}})),define("modules/clean/sharing/stores/sharing_info",["require","exports","tslib","modules/constants/python","modules/clean/flux/base_store","modules/clean/sharing/action_types","modules/clean/sharing/api/types/metadata","modules/clean/sharing/share_modal/store/modal_info/reducer","modules/clean/sharing/share_modal/store/sharing_info/reducer","modules/clean/sharing/access_level","modules/clean/sharing/stores/sharing_info_util","modules/clean/sharing/ui_util","modules/clean/user_survey/user_survey","modules/core/assert","lodash"],(function(e,t,s,n,i,a,r,o,l,d,c,h,p,u,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SharingInfo=t.Permissions=t.sharingInfoStore=void 0,n=s.__importStar(n),m=s.__importStar(m);const g=(e,t)=>((t=String(t)).startsWith("id:")||(t=t.toLowerCase()),`${e}::${t}`);class _ extends i.Store{constructor(){super(),this.sharingInfoMap={}}getSharingInfo(e,t){return t?this.sharingInfoMap[g(e,t)]:null}mapContentIdsToSharingInfo(e,t,s){for(const n of t)n&&(this.sharingInfoMap[g(e,n)]=s)}_new_payload(e){if(e&&e.action&&e.action.type)switch(e.action.type){case a.SharingActionTypes.CLEAR_EVERYTHING:this.sharingInfoMap={};break;case a.SharingActionTypes.FETCH_METADATA_BATCH_SUCCESS:{const t=e.action.user;e.action.data.forEach(e=>{this._new_payload_for_single_content(a.ShareModalActionTypes.FETCH_METADATA_SUCCESS,t,c.getContentIdsForMetadata(e),{metadata:e})}),this.emit_change();break}default:if(!e.action.contentIds)return;this._new_payload_for_single_content(e.action.type,e.action.user,e.action.contentIds,e.action.data),this.emit_change()}}_new_payload_for_single_content(e,t,s,n){let i;u.assert(Boolean(t.id),"valid user needed"),u.assert(s.length>0,"contentIds cannot be empty");for(const e of s){const s=g(t.id,e);if(s in this.sharingInfoMap){i=this.sharingInfoMap[s];break}}i||(i=new S(t));const a={type:e,payload:n,user:t};return i.setState(o.modalInfoReducer(i.modalInfoState(),a),l.sharingInfoReducer(i.sharingInfoState(),a)),s.push(i.fqPath()),this.mapContentIdsToSharingInfo(t.id,s,i),i}}t.sharingInfoStore=new _;class f{constructor(e){this.change_options=m.get(e,"change_options.allow",!1),this.edit_contents=m.get(e,"edit_contents.allow",!1),this.invite_editor=m.get(e,"invite_editor.allow",!1),this.invite_viewer=m.get(e,"invite_viewer.allow",!1),this.relinquish_membership=m.get(e,"relinquish_membership.allow",!1),this.leave_a_copy=m.get(e,"leave_a_copy.allow",!1),this.create_edit_link=m.get(e,"create_edit_link.allow"),this.create_view_link=m.get(e,"create_view_link.allow",!1),this.unshare=m.get(e,"unshare.allow",!1),this.update_confidentiality=m.get(e,"update_confidentiality.allow",!1),this.is_file_permissions=e instanceof r.FilePermissions,this.share_message_as_comment=m.get(e,"share_message_as_comment.allow",!1)}canChangeOptions(){return this.change_options}canEdit(){return this.edit_contents}canInviteEditor(){return this.invite_editor}canInviteViewer(){return this.invite_viewer}canInvite(){return this.canInviteViewer()||this.canInviteEditor()}canRelinquishMembership(){return this.relinquish_membership}canCreateEditLink(){return this.is_file_permissions&&this.create_edit_link}canCreateViewLink(){return this.is_file_permissions&&this.create_view_link}canUnshare(){return this.unshare}canUpdateConfidentiality(){return this.update_confidentiality}canLeaveACopy(){return this.leave_a_copy}canShareMessageAsComment(){return this.share_message_as_comment}}t.Permissions=f;class S{constructor(e){this._user=e,this.setState(o.initialModalInfoState,l.initialSharingInfoState)}setState(e,s){this._modalInfo=e,this._sharingInfoState=s,s.metadata&&t.sharingInfoStore.mapContentIdsToSharingInfo(this._user.id,c.getContentIdsForMetadata(s.metadata),this)}sharingInfoState(){return this._sharingInfoState}modalInfoState(){return this._modalInfo}user(){return this._user}hasNonSelfMembers(){const e=this.members(),t=e&&e.getMemberCount();if(!t)return!1;if(1===t&&1===e.users.count()){return e.users.first().account_id!==this._user.account_id}return!0}hasNonOwnerMembers(){return this.hasNonSelfMembers()&&this.isOwner()}hasOutsideTeamMembers(){const e=this.memberCounts();return(e?e.users_outside_team:0)>0}memberNum(){const e=this.memberCounts(),t=this.members();return e&&e.total_unique_users?e.total_unique_users:t?t.getMemberCount():void 0}memberCountWithRecipients(){return(this.memberNum()||0)+h.getMemberCountForTokens(this.recipientTokens())}getInitialProps(){return this.modalInfoState().initialProps}areMembersFullyLoaded(){return this.sharingInfoState().areMembersFullyLoaded}areSharingPrefsLoaded(){return this.sharingInfoState().areSharingPrefsLoaded}sharingPrefs(){return this.sharingInfoState().sharingPrefs}canShareLink(){return!this.isConfidentialFolder()&&!this.isTeamSharedFolder()&&this.contentInfo().pathExists()&&this.contentInfo().isMounted()}canDeleteLink(){const e=this.linkMetadata();return Boolean(e&&e.link_permissions.can_revoke)}contactsError(){return h.validateContacts(this.recipientTokens(),this._user,this.recipientValidation()[this.recipientAccess()]||{},this.folderPolicy(),this.isTeamSharedFolder(),this.isFolderInsideTeamFolderTree(),this.memberCountWithRecipients())}contentId(){return this.contentInfo().id}contentInfo(){return this.modalInfoState().contentInfo}contentNameInputValue(){return this.modalInfoState().contentNameInputValue}contentNameMessage(){return this.modalInfoState().contentNameMessage}contentNameMessageLevel(){return this.modalInfoState().contentNameMessageLevel}displayPath(){const e=this.metadata();return this.contentInfo().displayPath()||e&&e.path_display||""}parentFolderName(){const e=this.metadata();if(e&&e instanceof r.SharedFileMetadata){const t=e.path_display;if(t){const e=t.split("/");if(e.length>1)return e[e.length-2]}}return e&&e instanceof r.SharedFolderMetadata&&e.parent_folder_name||""}fetchingMembersRequest(){return this.sharingInfoState().fetchingMembersRequest}fetchingMetadataPromise(){return this.sharingInfoState().fetchingMetadataPromise}filePolicy(){const e=this.metadata();return e&&e.file_policy}folderPolicy(){const e=this.metadata();return e&&e.policy}fqPath(){return this.contentInfo().displayPath()}hasDisplayableMembers(){return this.sharingInfoState().hasDisplayableMembers}hasParentSharedFolder(){const e=this.metadata();return!!e&&e.is_inside_team_folder}initialRecipientTokens(){return this.modalInfoState().initialRecipientTokens}isNonUserRelativeContext(){return this.getInitialProps().isInContentManager}isFolder(){return this.contentInfo().isFolder()}isConfidentialFolder(){const e=this.metadata();return Boolean(e&&e.is_confidential)}isContentNameFocused(){return this.modalInfoState().isContentNameFocused}isFolderInsideTeamFolderTree(){const e=this.metadata();return!!e&&e.is_inside_team_folder}isInsideSharedFolder(){const e=this.metadata();return Boolean(e&&e.parent_shared_folder_id||this.contentInfo().isInSharedFolder())}isLinkMetadataLoaded(){return this.sharingInfoState().isLinkMetadataLoaded}isMetadataLoaded(){return Boolean(this.metadata())}isOwner(){const e=this.metadata();return Boolean(e&&e.access_type===d.ACCESS_LEVEL.OWNER)}isOSXPackage(){const e=this.displayPath(),t=e.substr(e.lastIndexOf("."));return n.PACKAGE_EXTS.indexOf(t)>=0}isShareModalUpsellPremiumSharing(){return this.sharingPrefs().in_share_modal_upsell_premium_sharing}shareModalUpsellPremiumSharingVariant(){return this.sharingPrefs().in_share_modal_upsell_premium_sharing_variant}hasSeenUpsellCounter(){return this.sharingPrefs().has_seen_share_modal_upsell_premium_sharing_counter}hasCreatedLink(){return this.sharingInfoState().hasCreatedLink}hasIncrementedUpsellCounter(){return this.sharingInfoState().hasIncrementedUpsellCounter}inviteAfterSharingModalVariant(){return this.sharingPrefs().invite_after_sharing_modal_variant}coreO21nBetterTeamSharingVariant(){return this.sharingPrefs().exp_core_o21n_better_team_sharing}getShowSharingQuestionnaire(){return this.modalInfoState().showSharingQuestionnaire}getExperiments(){return this.modalInfoState().experiments}getExpTeamSpace3OffteamSharingSprigSurvey(){return this.sharingPrefs().team_space_3_offteam_sharing_sprig_survey}coreO21nDndMomentPdfWordVariant(){return this.sharingPrefs().exp_core_o21n_dnd_moment_pdf_word}coreO21nDndMomentPptKeynoteVariant(){return this.sharingPrefs().exp_core_o21n_dnd_moment_ppt_keynote}pgEsignDiscoveryVariant(){return this.sharingPrefs().exp_pg_esign_discovery_variant}hasSeenEsignPostSharing(){return this.sharingPrefs().has_seen_esign_post_sharing}familySharingUpsellGating(){return this.sharingPrefs().exp_pg_family_sharing_upsell_gating}isInEsignPostSharingExclusionPeriod(){return this.sharingPrefs().is_in_esign_post_sharing_exclusion_period}isUserOnOwnerTeam(){const e=this.metadata();return Boolean(e&&e.owner_team&&e.owner_team.id===this._user.team_dbtid)}isCurrentAccountLoaded(){return this.sharingInfoState().isCurrentAccountLoaded}isTeamSharedFolder(){const e=this.metadata();return Boolean(e&&e.is_team_folder||this.contentInfo().isTeamSharedFolder())}isTokenizerEmpty(){return 0===this.recipientRawInput().length&&0===this.recipientTokens().length}linkMetadata(){return this.sharingInfoState().linkMetadata}sharedLinks(){return this.sharingInfoState().sharedLinks||[]}shmodelLink(){return this.sharedLinks().filter(e=>!e.isRighteousLink())[0]}editRighteousLink(){return this.sharedLinks().filter(e=>"editor"===e.link_permissions.link_access_level)[0]}viewRighteousLink(){return this.sharedLinks().filter(e=>"viewer"===e.link_permissions.link_access_level)[0]}linkOnlyReason(){return this.modalInfoState().linkOnlyReason}countsExceedNsLimit(){return this.modalInfoState().countsExceedNsLimit}memberCounts(){return this.sharingInfoState().memberCounts}members(){return this.sharingInfoState().members}metadata(){return this.sharingInfoState().metadata}name(){const e=this.contentInfo(),t=this.metadata();return e&&e.name()||t&&t.name||""}ownerTeam(){const e=this.metadata();return e&&e.owner_team}parentSharedFolderId(){const e=this.metadata();return e&&e.parent_shared_folder_id}pendingMemberAction(){return this.modalInfoState().pendingMemberAction}permissionsObj(){return new f(this.permissions())}permissions(){const e=this.metadata();return e&&e.permissions}recipientAccess(){const e=this.modalInfoState();return e.recipientAccess?e.recipientAccess:this.permissionsObj().canInviteEditor()||this.permissionsObj().canCreateEditLink()||this.editRighteousLink()?d.ACCESS_LEVEL.WRITER:d.ACCESS_LEVEL.READER}recipientMessage(){return this.modalInfoState().recipientMessage}onCreateGroupCallback(){return this.modalInfoState().onCreateGroupCallback}recipientRawInput(){return this.modalInfoState().recipientRawInput}recipientTokens(){return this.modalInfoState().recipientTokens}recipientValidation(){return this.modalInfoState().recipientValidation}shareAsConfidential(){return Boolean(this.getInitialProps().shareAsConfidential)}shareFolderPromise(){return this.sharingInfoState().shareFolderPromise}shouldBlockMemberListOnPassLoad(){return this.sharingInfoState().shouldBlockMemberListOnPassLoad}shouldSyncThisFolder(){return this.getInitialProps()?this.getInitialProps().shouldSyncThisFolder:null}teamPolicy(){return this.sharingInfoState().teamPolicy}isFamilyUser(){return this.sharingInfoState().isFamilyUser}uiMode(){return this.modalInfoState().uiMode}isCloudDoc(){const e=this.metadata();return!(!e||!e.is_cloud_doc)}fetchMetadataStatus(){return this.modalInfoState().fetchMetadataStatus}isShareMessageAsCommentChecked(){const e=this.modalInfoState().isShareMessageAsCommentExplicitlyChecked;return void 0===e?this.permissionsObj().canShareMessageAsComment():e}shouldSuppressRedirectToBrowse(){return this.getInitialProps()?this.getInitialProps().shouldSuppressRedirectToBrowse:null}shouldCloseImmediately(){return this.getInitialProps()?this.getInitialProps().shouldCloseImmediately:null}shouldFetchLinkMetadata(){return this.canShareLink()&&!this.isNonUserRelativeContext()&&this.contentInfo().isMounted()}showOffTeamSharingSurvey(e){this.getExpTeamSpace3OffteamSharingSprigSurvey()&&(e||(e=this.contactsError()),(null==e?void 0:e.level)===h.ContactsErrorLevel.Warn&&(null==e?void 0:e.message)===h.CONTACT_ERROR_MESSAGES.GENERAL_OUT_OF_TEAM&&p.UserSurvey.trackEvent("attempting_offteam_share","sharing"))}getSelectedAudienceByAccessLevel(e){return this.sharingInfoState().selectedAudienceByAccessLevel[e]}getEligibleInviteAfterSharingContacts(){return c.getEligibleInviteAfterSharingContactsImpl(this.recipientTokens(),this.recipientValidation())}}t.SharingInfo=S})),define("modules/clean/sharing/stores/sharing_info_util",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getEligibleInviteAfterSharingContactsImpl=t.getContentIdsForContentInfo=t.getContentIdsForMetadata=void 0,t.getContentIdsForMetadata=e=>[e.shared_folder_id,e.id,e.path_lower].filter(e=>!!e),t.getContentIdsForContentInfo=e=>{const t=[];return e.isSharedFolder()?t.push(e.sharedFolderId()):(e.extras.fileId&&t.push(e.extras.fileId),e.extras.nsId&&e.extras.nsPath&&t.push(`ns:${e.nsId()}${e.nsPath()}`)),e.displayPath()&&t.push(e.displayPath()),t},t.getEligibleInviteAfterSharingContactsImpl=(e,t)=>{const s=new Set(e.filter(e=>!e.invalid).map(e=>e.getKey())),n=Object.values(t),i=new Set,a=new Set;for(const e of n)for(const t in e)if(e.hasOwnProperty(t)&&s.has(t)){const s=e[t];if(s&&s.inviteAfterSharingEligibility){const e=s.inviteAfterSharingEligibility[".tag"];"eligible_not_seen"===e?i.add(t):"eligible_seen"===e&&a.add(t)}}return{inviteEligibleNotSeenContacts:e.filter(e=>i.has(e.getKey())&&!e.invalid),inviteEligibleSeenContacts:e.filter(e=>a.has(e.getKey())&&!e.invalid)}}})),define("modules/clean/sharing/strings",["require","exports","modules/clean/sharing/access_level","spectrum-sharing/utils/sharing_constants","modules/core/i18n"],(function(e,t,s,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MEMBER_ACTION_FILE_NO_COMMENT=t.MEMBER_ACTION_FOLDER_NO_COMMENT=t.MEMBER_ACTION_CLOUD_DOC=t.MEMBER_ACTION_FILE=t.MEMBER_ACTION_FOLDER=t.ACCESS_NAME_NO_COMMENT=t.ACCESS_NAME=void 0;const a={[s.ACCESS_LEVEL.OWNER]:i.intl.formatMessage({id:"if8xIl",defaultMessage:"Owner"}),[s.ACCESS_LEVEL.WRITER]:i.intl.formatMessage({id:"ywqz2g",defaultMessage:"Can edit"}),[s.ACCESS_LEVEL.READER]:i.intl.formatMessage({id:"Gz5ABt",defaultMessage:"Can view"}),[s.ACCESS_LEVEL.READER_NO_COMMENT]:i.intl.formatMessage({id:"vQquJX",defaultMessage:"View-only"})};t.ACCESS_NAME=a;const r={[s.ACCESS_LEVEL.OWNER]:i.intl.formatMessage({id:"if8xIl",defaultMessage:"Owner"}),[s.ACCESS_LEVEL.WRITER]:i.intl.formatMessage({id:"ywqz2g",defaultMessage:"Can edit"}),[s.ACCESS_LEVEL.READER]:i.intl.formatMessage({id:"Cgg/GQ",defaultMessage:"Can comment"}),[s.ACCESS_LEVEL.READER_NO_COMMENT]:i.intl.formatMessage({id:"Gz5ABt",defaultMessage:"Can view"})};t.ACCESS_NAME_NO_COMMENT=r;const o={[n.MEMBER_ACTION.MAKE_EDITOR]:i.intl.formatMessage({id:"l98l5t",defaultMessage:"People can edit, delete, comment, and add the files to their Dropbox"}),[n.MEMBER_ACTION.MAKE_VIEWER]:i.intl.formatMessage({id:"b2gULy",defaultMessage:"People can view, download, and comment"}),[n.MEMBER_ACTION.MAKE_VIEWER_NO_COMMENT]:i.intl.formatMessage({id:"SS1NPa",defaultMessage:"People can only view and download the files"})};t.MEMBER_ACTION_FOLDER=o;const l={[n.MEMBER_ACTION.MAKE_EDITOR]:i.intl.formatMessage({id:"p1FXFw",defaultMessage:"People can edit, delete, comment, and add the file to their Dropbox"}),[n.MEMBER_ACTION.MAKE_VIEWER]:i.intl.formatMessage({id:"b2gULy",defaultMessage:"People can view, download, and comment"}),[n.MEMBER_ACTION.MAKE_VIEWER_NO_COMMENT]:i.intl.formatMessage({id:"EYJ3Li",defaultMessage:"People can only view and download the file"})};t.MEMBER_ACTION_FILE=l;const d={[n.MEMBER_ACTION.MAKE_EDITOR]:i.intl.formatMessage({id:"65RS70",defaultMessage:"People can edit and comment"}),[n.MEMBER_ACTION.MAKE_VIEWER]:i.intl.formatMessage({id:"9zXodW",defaultMessage:"People can view and comment"})};t.MEMBER_ACTION_CLOUD_DOC=d;const c={[n.MEMBER_ACTION.MAKE_EDITOR]:i.intl.formatMessage({id:"UFB0OU",defaultMessage:"Lets them view, comment, and edit."}),[n.MEMBER_ACTION.MAKE_VIEWER]:i.intl.formatMessage({id:"dLWWVm",defaultMessage:"Lets them view and comment, but not edit."}),[n.MEMBER_ACTION.MAKE_VIEWER_NO_COMMENT]:i.intl.formatMessage({id:"Fp+s39",defaultMessage:"Lets them view only. They can’t see comments."})};t.MEMBER_ACTION_FOLDER_NO_COMMENT=c;const h={[n.MEMBER_ACTION.MAKE_EDITOR]:i.intl.formatMessage({id:"UFB0OU",defaultMessage:"Lets them view, comment, and edit."}),[n.MEMBER_ACTION.MAKE_VIEWER]:i.intl.formatMessage({id:"dLWWVm",defaultMessage:"Lets them view and comment, but not edit."}),[n.MEMBER_ACTION.MAKE_VIEWER_NO_COMMENT]:i.intl.formatMessage({id:"Fp+s39",defaultMessage:"Lets them view only. They can’t see comments."})};t.MEMBER_ACTION_FILE_NO_COMMENT=h})),define("modules/clean/sharing/sharing_tracked_element",["require","exports","tslib","react","modules/clean/sharing/ui_util","modules/clean/react/components/helpers","dig-components/typography","spectrum-sharing/utils/logging"],(function(e,t,s,n,i,a,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TrackedLink=t.withSharingTracking=void 0,n=s.__importDefault(n);const l=["trackingId","href"];function d(){return e=>{class t extends n.default.Component{constructor(){super(...arguments),this.getWhitelistedExtras=()=>{const e={};return l.forEach(t=>{this.props.hasOwnProperty(t)&&(e[`element_${t}`]=this.props[t])}),e},this.onClick=()=>{i.logTiburonEvent(this.props.contentInfo,this.props.user.id,o.TiburonEventName.ElementClick,this.getWhitelistedExtras())}}componentDidMount(){i.logTiburonEvent(this.props.contentInfo,this.props.user.id,o.TiburonEventName.ElementView,this.getWhitelistedExtras())}render(){return n.default.createElement(e,Object.assign({onClick:this.onClick},this.props))}}return t.displayName=`withSharingTracking(${a.getDisplayName(e)}`,t}}t.withSharingTracking=d;class c extends n.default.Component{render(){return n.default.createElement(r.Link,Object.assign({},this.props),this.props.children)}}c.displayName="TrackedLinkElement",t.TrackedLink=d()(c)})),define("modules/clean/sharing/views/share_modal/contacts_error_banner",["require","exports","tslib","react","modules/clean/sharing/ui_util","spectrum-sharing/components/sharing_modal_banner/index"],(function(e,t,s,n,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ContactsErrorBanner=void 0,n=s.__importDefault(n),t.ContactsErrorBanner=function({level:e="defaultLevel",message:t}){if(!t)return null;const s={[i.ContactsErrorLevel.Error]:"error",[i.ContactsErrorLevel.Warn]:"warn",defaultLevel:"default"}[e];return n.default.createElement(a.SharingModalBanner,{className:"contacts-error-banner",type:s,message:t})}})),define("modules/clean/sharing/views/share_modal/inform_owner_update_section",["require","exports","tslib","react","spectrum-sharing/components/sharing_modal_banner/index","modules/core/i18n"],(function(e,t,s,n,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InformOwnerUpdateSection=void 0,n=s.__importDefault(n);class r extends n.default.Component{render(){const e=a.intl.formatMessage({id:"jxjvN9",defaultMessage:"We’ll let the owner know whenever you change these settings"});return n.default.createElement(i.SharingModalBanner,{className:this.props.isInSharingSettingsModal?"sharing-settings-modal__banner":void 0,type:"dark",message:e})}}t.InformOwnerUpdateSection=r,r.displayName="InformOwnerUpdateSection"})),define("modules/clean/sharing/views/share_modal/sharing_modal_no_permissions_section",["require","exports","tslib","react","spectrum-sharing/components/sharing_modal_banner/index","modules/core/i18n","lodash"],(function(e,t,s,n,i,a,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SharingModalNoPermissionsSection=void 0,n=s.__importDefault(n),r=s.__importStar(r);class o extends n.default.Component{constructor(){super(...arguments),this.getNoPermissionMessage=()=>this.props.isTeamSharedFolder?this.getTeamSharedFolderMessage():this.props.isFolder?a.intl.formatMessage({id:"7nUdHD",defaultMessage:"You don’t have permission to manage membership of this folder"}):a.intl.formatMessage({id:"Bg4C2n",defaultMessage:"You don’t have permission to manage membership of this file"})}render(){return n.default.createElement(i.SharingModalBanner,{message:this.getNoPermissionMessage()})}getTeamSharedFolderMessage(){return this.renderTeamFolderNoPermissionMessage()?a.intl.formatMessage({id:"Ia9tjc",defaultMessage:"This folder is automatically shared with all members of {team_name}"},{team_name:this.props.teamName}):a.intl.formatMessage({id:"6Vgz8b",defaultMessage:"Only <admin_link>admins</admin_link> and <group_link>group managers</group_link> can change team folder membership."},{admin_link:e=>n.default.createElement("a",{href:"/team?_tk=left_nav_team",target:"_blank",rel:"noreferrer"},e),group_link:e=>n.default.createElement("a",{href:"/help/7232#transfer",target:"_blank",rel:"noreferrer"},e)})}renderTeamFolderNoPermissionMessage(){return r.get(this.props,"members.groups",{}).some(e=>"team"===e.group_type&&r.get(e,"permissions.make_editor.allow")&&r.get(e,"permissions.make_viewer.allow"))}}t.SharingModalNoPermissionsSection=o,o.displayName="SharingModalNoPermissionsSection"})),define("modules/clean/sharing/views/share_modal/sharing_modal_upsell_premium_sharing",["require","exports","tslib","react","spectrum-sharing/components/banner/index","modules/clean/sharing/sharing_tracked_element","dig-components/typography","modules/core/i18n","modules/core/exception"],(function(e,t,s,n,i,a,r,o,l){"use strict";function d(e,s,n){return"M1V2"===s||"M1V2_LINK_SETTINGS"===s?1===e.paid?`/buy/professional?_tk=${n}`:`/pro/try?_tk=${n}`:(["M1V1","OFF","CONTROL"].indexOf(s)<0&&l.reportException({err:new Error(`Variant is ${s}`),tags:[t.SHARE_MODAL_UPSELL_PREMIUM_SHARING_EXCLOG_TAG],severity:l.SEVERITY.NONCRITICAL}),`/upgrade?oqa=sfp&_tk=${n}`)}Object.defineProperty(t,"__esModule",{value:!0}),t.SharingModalUpsellPremiumSharing=t.getCTALink=t.SHARE_MODAL_UPSELL_PREMIUM_SHARING_EXCLOG_TAG=void 0,n=s.__importDefault(n),t.SHARE_MODAL_UPSELL_PREMIUM_SHARING_EXCLOG_TAG="share_modal_upsell_premium_sharing",t.getCTALink=d;class c extends n.default.Component{componentDidMount(){this.props.hasIncrementedCounter||void 0===this.props.hasSeenCounter||this.props.onSetSeenCounter(this.props.hasSeenCounter+1)}getCTAText(){return 1===this.props.user.paid?o.intl.formatMessage({id:"vFDLgh",defaultMessage:"Try it with Professional"}):o.intl.formatMessage({id:"iPDKbr",defaultMessage:"Try free with Professional"})}render(){return n.default.createElement(i.Banner,{showTopCaret:!0},n.default.createElement(r.Text,{size:"small",className:"scl-banner__text"},o.intl.formatMessage({id:"R2FTNc",defaultMessage:"Secure this link with a password and expiration."})," ",n.default.createElement(a.TrackedLink,{trackingId:"share_modal_pro_upsell_footer",user:this.props.user,contentInfo:this.props.contentInfo,href:d(this.props.user,this.props.variant,"sharing_modal_upsell"),target:"_blank",rel:"noopener",hasNoUnderline:!0},this.getCTAText())))}}t.SharingModalUpsellPremiumSharing=c,c.displayName="SharingModalUpsellPremiumSharing"})),define("modules/clean/sharing/views/share_modal_evolution/manage/header_section",["require","exports","tslib","react","spectrum-sharing/components/sharing_modal_header/index","modules/core/i18n","modules/clean/sharing/views/share_modal_evolution/utils/context","spectrum-sharing/utils/logging"],(function(e,t,s,n,i,a,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HeaderSection=void 0,n=s.__importDefault(n);class l extends n.default.Component{constructor(){super(...arguments),this.handleSettingsButtonClick=e=>{e.preventDefault(),this.props.onSettingsButtonClick(),this.context.logEvent(o.TiburonEventName.ClickSettingsGear,void 0,{screen:o.ScreenName.ManageAccessScreen})}}render(){return n.default.createElement(i.SharingModalHeaderWithBackButton,{autoFocus:!0,closeButtonVisible:!0,settingsButtonVisible:!0,onClickBackButton:this.props.onBackButtonClick,onClickCloseButton:this.props.onCloseButtonClick,onClickSettingsButton:this.handleSettingsButtonClick,label:a.intl.formatMessage({id:"oMWVkR",defaultMessage:"Back"})})}}t.HeaderSection=l,l.displayName="HeaderSection",l.contextType=r.ShareModalEvolutionContext})),define("modules/clean/sharing/views/share_modal_evolution/manage/main_section",["require","exports","tslib","react","modules/clean/em_string","modules/core/i18n","modules/clean/react/components/css","spectrum-sharing/utils/sharing_constants","modules/clean/sharing/views/member_list","modules/clean/sharing/views/share_modal/sharing_modal_no_permissions_section","spectrum-sharing/components/action_container/index","spectrum-sharing/components/sharing_modal_downgrade_banner/index","react-intl"],(function(e,t,s,n,i,a,r,o,l,d,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ShareModalEvolutionManageAccessMainSection=t.MainSection=void 0,n=s.__importDefault(n);const u=p.defineMessages({downgradeBannerHeader:{id:"YBKCoS",defaultMessage:"People who can view could still edit via link"},removeBannerHeader:{id:"w/RnTZ",defaultMessage:"People might still have access via link"},downgradeBannerSubheader:{id:"iYhJt/",defaultMessage:"You can delete the link to further restrict access."},downgradeBannerGotIt:{id:"YCTkuR",defaultMessage:"Got It"},downgradeBannerManageLinks:{id:"J9wEBS",defaultMessage:"Manage Links"}});class m extends n.default.Component{constructor(e){super(e),this.enableSecurityBanner=e=>{this.setState({showSecurityBanner:!0,securityBannerType:e})},this.hideSecurityBanner=()=>{this.setState({showSecurityBanner:!1})},this.openLinkSettings=e=>{e.preventDefault(),this.props.actionHandler.openSharingSettingsModal("edit_link_settings")},this.state={showSecurityBanner:!1,securityBannerType:l.SecurityBannerType.DowngradeAccess}}render(){return n.default.createElement(c.ActionContainer,{header:this.getTitle(),headerSize:"small",banner:this.renderBanner(),showBorder:!0},n.default.createElement(l.SharingMemberList,Object.assign({},this.props.memberListProps,{onShowSecurityBanner:this.enableSecurityBanner})))}getTitle(){const e={fileName:i.Emstring.em_snippet(this.props.fileName,o.SNIPPET_SIZES.SHARE_ME_MANAGE_ACCESS_FILE_FOLDER_TITLE)};return a.intl.formatMessage({id:"IQ37US",defaultMessage:"Who can access <s>{fileName}</s>"},{fileName:e.fileName,s:e=>n.default.createElement("span",null,e)})}noPermissionsSectionProps(){return{isFolder:this.props.isFolder,isTeamSharedFolder:this.props.isTeamSharedFolder,members:this.props.membership,teamName:this.props.ownerTeamName}}renderBanner(){if(!this.props.canInviteMembers)return n.default.createElement(d.SharingModalNoPermissionsSection,Object.assign({},this.noPermissionsSectionProps()));if(this.props.editLinkExists&&this.state.showSecurityBanner){let e;switch(this.state.securityBannerType){case l.SecurityBannerType.RemoveAccess:e=u.removeBannerHeader;break;case l.SecurityBannerType.DowngradeAccess:default:e=u.downgradeBannerHeader}return n.default.createElement(h.SharingModalDowngradeBanner,{header:a.intl.formatMessage(e),subheader:a.intl.formatMessage(u.downgradeBannerSubheader),outlineButtonLabel:a.intl.formatMessage(u.downgradeBannerGotIt),transparentButtonLabel:a.intl.formatMessage(u.downgradeBannerManageLinks),onClickOutlineButton:this.hideSecurityBanner,onClickTransparentButton:this.openLinkSettings})}}}t.MainSection=m,m.displayName="MainSection",t.ShareModalEvolutionManageAccessMainSection=r.requireCssWithComponent(m,["/static/css/sharing/share_modal_evolution-vflu7uQ9A.css"])})),define("modules/clean/sharing/views/share_modal_evolution/manage/manage_access_page",["require","exports","tslib","react","modules/clean/react/components/css","modules/clean/sharing/views/share_modal_evolution/manage/header_section","modules/clean/sharing/views/share_modal_evolution/manage/main_section","modules/clean/sharing/views/share_modal_evolution/utils/context","spectrum-sharing/utils/logging"],(function(e,t,s,n,i,a,r,o,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ManageAccessModal=t.ManageAccessPage=t.baseClassName=void 0,n=s.__importDefault(n),t.baseClassName="share-modal-evolution__manage-access-page";class d extends n.default.Component{componentDidMount(){this.context.logEvent(l.TiburonEventName.ViewManageAccessScreen)}render(){return n.default.createElement("div",{className:t.baseClassName},n.default.createElement(a.HeaderSection,{onBackButtonClick:this.props.onBackButtonClick,onCloseButtonClick:this.props.onCloseButtonClick,onSettingsButtonClick:this.props.onSettingsButtonClick}),n.default.createElement(r.MainSection,{canInviteMembers:this.props.canInviteMembers,fileName:this.props.fileName,isFolder:this.props.isFolder,isTeamSharedFolder:this.props.isTeamSharedFolder,memberListProps:this.props.memberListProps,membership:this.props.membership,ownerTeamName:this.props.ownerTeamName,actionHandler:this.props.actionHandler,editLinkExists:this.props.editLinkExists}))}}t.ManageAccessPage=d,d.displayName="ManageAccessModal",d.contextType=o.ShareModalEvolutionContext,t.ManageAccessModal=i.requireCssWithComponent(d,["/static/css/sharing/share_modal_evolution-vflu7uQ9A.css"])})),define("modules/clean/sharing/views/share_modal_evolution/share_modal_evolution",["require","exports","tslib","react","dig-components/layer","modules/clean/react/components/css","spectrum-sharing/utils/sharing_constants","modules/clean/sharing/views/share_modal_evolution/utils/context","modules/clean/sharing/views/share_modal_evolution/utils/logging","modules/clean/sharing/views/share_modal_evolution/manage/manage_access_page","modules/clean/sharing/views/share_modal_evolution/share/share_screen"],(function(e,t,s,n,i,a,r,o,l,d,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ShareModalEvolution=t.ShareModalEvolutionComponent=void 0,n=s.__importDefault(n);class h extends n.default.Component{constructor(){super(...arguments),this.handleManageAccessClick=()=>{this.props.showScreen(r.MANAGE_SCREEN)},this.handleBackButtonClick=()=>{this.props.showScreen(r.SHARE_SCREEN)},this.handleLogEvent=(e,t,s)=>{const{contentMetadata:n,user:i}=this.props;this.props.logTiburonEvent(e,i.id,Object.assign(Object.assign({},l.buildExtraFromMetadata(n,t)),s))}}render(){return n.default.createElement(i.LayerContext.Provider,{value:1e3},n.default.createElement(o.ShareModalEvolutionContextProvider,{logEvent:this.handleLogEvent,experiments:this.props.actionHandler.getSharingInfo().getExperiments()},n.default.createElement("div",{className:"share-modal-evolution"},this.renderActiveScreen())))}renderActiveScreen(){return this.props.currentScreen===r.MANAGE_SCREEN?n.default.createElement(d.ManageAccessModal,Object.assign({},this.manageAccessPageProps())):n.default.createElement(c.ShareScreen,Object.assign({},this.getShareScreenProps()))}manageAccessPageProps(){const{isFolder:e,isTeamSharedFolder:t,onSettingsButtonClick:s,sharingInfo:n,onCloseButtonClick:i,actionHandler:a}=this.props;return{canInviteMembers:n.permissionsObj().canInvite(),fileName:n.name(),isFolder:e,isTeamSharedFolder:t,memberListProps:this.props.memberListProps,membership:n.members(),onBackButtonClick:this.handleBackButtonClick,onCloseButtonClick:i,onSettingsButtonClick:s,ownerTeamName:this.props.ownerTeam?this.props.ownerTeam.name:void 0,actionHandler:a,editLinkExists:!!n.editRighteousLink()}}getShareScreenProps(){return{actionHandler:this.props.actionHandler,contactsError:this.props.contactsError,contentMetadata:this.props.contentMetadata,isEmailSending:this.props.isEmailSending,handleManageAccessClick:this.handleManageAccessClick,handleMessageChanged:this.props.handleMessageChanged,initialTypeaheadTokens:this.props.initialTypeaheadTokens,isTeamSharedFolder:this.props.isTeamSharedFolder,isTokenizerEmpty:this.props.isTokenizerEmpty,onCloseButtonClick:this.props.onCloseButtonClick,onSettingsButtonClick:this.props.onSettingsButtonClick,recipientMessage:this.props.recipientMessage,sharingInfo:this.props.sharingInfo,user:this.props.user,guestMembers:this.props.guestMembers,linkMembers:this.props.linkMembers,showPassFileSettings:this.props.showPassFileSettings}}}t.ShareModalEvolutionComponent=h,h.displayName="ShareModalEvolution",t.ShareModalEvolution=a.requireCssWithComponent(h,["/static/css/sharing/share_modal_evolution-vflu7uQ9A.css","/static/css/dig-components/index.web-vflm67Rix.css"])})),define("modules/clean/sharing/views/share_modal_evolution/share/footer_section",["require","exports","tslib","react","dig-components/typography","dig-components/tooltips","dig-components/buttons","modules/core/i18n","spectrum-sharing/components/sharing_modal_footer_link/index","modules/clean/sharing/sharing_questionnaire/util","modules/clean/growth/user_action/trackers/sharing_questionnaire_tracker","modules/clean/react/components/css"],(function(e,t,s,n,i,a,r,o,l,d,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FooterSection=void 0,n=s.__importDefault(n);const p=o.intl.formatMessage({id:"jSxg71",defaultMessage:"Show sharing options"}),u=o.intl.formatMessage({id:"e1es+b",defaultMessage:"Show sharing options"}),m=o.intl.formatMessage({id:"Kavfj2",defaultMessage:"Explore the different ways to share files and folders."}),g=o.intl.formatMessage({id:"MCymMg",defaultMessage:"Got it"}),_=({actionHandler:e})=>{const[t,o]=n.default.useState(!1),h=n.default.useRef(null);n.default.useEffect(()=>{s.__awaiter(void 0,void 0,void 0,(function*(){const e=yield d.fetchHasPerformedSharingQuestionnaireAction(c.SharingQuestionnaireActions.SHARE_MODAL_TOOLTIP_VIEW);o(!e)}))},[]);const _=n.default.createElement(n.default.Fragment,null,n.default.createElement(r.Button,{ref:h,variant:"transparent",onClick:()=>{e.openSharingQuestionnaire()}},p),n.default.createElement(a.Tooltip.Control,{variant:"rich",open:t,triggerRef:h,onDisplayed:()=>{d.trackSharingQuestionnaireAction(c.SharingQuestionnaireActions.SHARE_MODAL_TOOLTIP_VIEW)},placement:"left"},n.default.createElement(i.Title,{size:"standard",inverse:!0},u),n.default.createElement(i.Text,{tagName:"p",color:"standard",inverse:!0},m),n.default.createElement("div",{className:"share-modal-evolution-share-screen-footer__tooltip-dismiss-wrapper"},n.default.createElement(r.Button,{variant:"primary",inverse:!0,onClick:()=>{o(!1)},autoFocus:!0},g))));return n.default.createElement(l.SharingModalFooterLink,{body:_,isIconHidden:!0})};_.displayName="FooterSectionComponent",t.FooterSection=h.requireCssWithComponent(_,["/static/css/sharing/share_modal_evolution-vflu7uQ9A.css"])})),define("modules/clean/sharing/views/share_modal_evolution/share/header_section",["require","exports","tslib","react","dig-components/typography","spectrum-sharing/components/sharing_modal_header/index","spectrum-sharing/utils/sharing_constants","modules/clean/em_string","modules/clean/sharing/share_modal_icon","modules/core/i18n","modules/clean/sharing/views/share_modal_evolution/utils/context","spectrum-sharing/utils/logging"],(function(e,t,s,n,i,a,r,o,l,d,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HeaderSection=void 0,n=s.__importDefault(n);class p extends n.default.Component{constructor(){super(...arguments),this.handleSettingsButtonClick=e=>{e.preventDefault(),this.props.onSettingsButtonClick(e),this.context.logEvent(h.TiburonEventName.ClickSettingsGear,void 0,{screen:h.ScreenName.ShareScreen})}}render(){const e=this.getSubTitle();return n.default.createElement(a.SharingModalHeaderTitle,{closeButtonVisible:!0,icon:this.getIcon(),subTitle:e,onClickCloseButton:this.props.onCloseButtonClick,onClickSettingsButton:this.handleSettingsButtonClick,settingsButtonVisible:this.props.contentInfo.isFolder()||this.props.showPassFileSettings,title:this.getHeaderTitle()})}getHeaderTitle(){return o.Emstring.em_snippet(this.props.sharingInfo.name(),r.SNIPPET_SIZES.FILENAME)}getIcon(){const{contentInfo:e}=this.props;return n.default.createElement(l.ShareModalIcon,{alt:"",filename:this.props.sharingInfo.name(),isSharedFolder:e.isSharedFolder(),isFolder:e.isFolder(),isTeamSharedFolder:this.props.isTeamSharedFolder,isFolderInsideTeamFolderTree:this.props.isFolderInsideTeamFolderTree,isViewOnly:!this.props.canEdit,isConfidentialFolder:this.props.isConfidentialFolder,pathExists:e.pathExists()})}getNumberOfPeopleShared(){const{membership:e,linkMembers:t,guestMembers:s}=this.props,{total_unique_users:n}=this.props.sharingInfo.memberCounts();return(n||e.getTotalMemberCount([]))+t.length+s.length}canViewInheritedMembers(){return!this.props.contentInfo.isFile()||this.props.membership.hasInheritedUsers()}getHeaderSubTitleDescription(){const e=this.props.sharingInfo.memberCounts(),t=e&&e.exceeds_count,s=t?this.props.sharingInfo.memberNum():this.getNumberOfPeopleShared();return this.canViewInheritedMembers()?0===s||1===s?d.intl.formatMessage({id:"8yAvwd",defaultMessage:"Only you have access"}):d.intl.formatMessage({id:"McYFO5",defaultMessage:"{count, plural, one{1 person has access} other{{count} people have access}}"},{count:s+(t?"+":"")}):d.intl.formatMessage({id:"DlYP8J",defaultMessage:"Shared with other people"})}showManageAccessLink(){return this.getNumberOfPeopleShared()>1&&this.props.showManageAccessLink}getSubTitle(){const e=this.getHeaderSubTitleDescription();return n.default.createElement(i.Text,{color:"faint",size:"small"},this.showManageAccessLink()?n.default.createElement(i.Link,{href:"#",hasNoUnderline:!0,onClick:e=>{e.preventDefault(),this.props.onManageAccessClick()}},e):n.default.createElement("span",null,e))}}t.HeaderSection=p,p.displayName="HeaderSection",p.contextType=c.ShareModalEvolutionContext,p.defaultProps={showManageAccessLink:!0}})),define("modules/clean/sharing/views/share_modal_evolution/share/main_section/email_share",["require","exports","tslib","react","classnames","spectrum-sharing/components/action_section/index","spectrum-sharing/components/form_validation_message/index","dig-components/tooltips","dig-components/buttons","modules/clean/sharing/ui_util","modules/clean/sharing/views/share_contacts_tokenizer","dig-components/text_fields","modules/core/i18n","modules/clean/sharing/views/share_modal_evolution/utils/context","spectrum-sharing/share_modal/sharing_settings/utils/index","spectrum-sharing/utils/logging","spectrum-sharing/components/checkbox_with_label/index","modules/clean/sharing/views/share_modal_evolution/share/main_section/copy_or_create_link_section"],(function(e,t,s,n,i,a,r,o,l,d,c,h,p,u,m,g,_,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EmailShare=t.baseClassName=void 0,n=s.__importDefault(n),i=s.__importDefault(i),t.baseClassName="share-modal-evolution-contacts-field";const S={[d.ContactsErrorLevel.Error]:"error",[d.ContactsErrorLevel.Warn]:"warn",defaultLevel:"default"};class E extends n.default.Component{constructor(e){super(e),this.finishLogging=e=>this.shareContactsTokenizerRef.finishLogging(e),this.onTypeaheadTokensChange=e=>{this.setState({typeaheadTokens:e}),this.props.emailCountChangeCallback(e.length)},this.setShareContactsTokenizerRef=e=>{this.shareContactsTokenizerRef=e},this.filterContacts=e=>this.props.isTeamSharedFolder?!!e.group_id:e.email!==this.props.user.email,this.footerContent=()=>{let e=this.props.accessLevel,t=this.props.sharedLink,s=this.props.canCreateLink;return this.props.isFolder&&!t&&"ON"!==this.props.createEditFolderLinkExpVariant&&(e="viewer",t=this.props.viewLinkForFolder,s=this.props.canCreateViewLinkForFolder),n.default.createElement(n.default.Fragment,null,this.shouldRenderPostNoteAsComment()&&this.renderPostNoteAsComment(),n.default.createElement(f.CopyOrCreateLinkSection,{size:"standard",accessLevel:e,actionHandler:this.props.actionHandler,modalClose:this.props.modalClose,sharedLink:t,getEmailTokenCountFn:this.props.getEmailTokenCountFn,canCreateLink:s,createEditFolderLinkExpVariant:this.props.createEditFolderLinkExpVariant,isFolder:this.props.isFolder}))},this.onEmailLinkButtonClick=()=>(this.logClickShareButtonLinkSettingsStatus(),this.props.actionHandler.sendShare(this)),this.onCheckboxToggled=()=>{this.props.actionHandler.changeCreateCommentCheckbox(!this.props.isPostNoteAsCommentChecked)},this.state={typeaheadTokens:[]}}getContacts(){return this.shareContactsTokenizerRef.getContacts()}getMessageType(){const e=this.props.contactsError.level||"defaultLevel";return S[e]}render(){const{contactsError:e,disabledContactsInput:s}=this.props,r=i.default([s?`${t.baseClassName}__typeahead--disabled`:`${t.baseClassName}__typeahead`,e&&e.level===d.ContactsErrorLevel.Error?"contacts-input-error":void 0]);return n.default.createElement(a.ActionSection,{footerContent:this.footerContent(),footerActions:n.default.createElement("span",{className:"scl-sharing-modal-footer"},n.default.createElement(l.Button,{disabled:this.shouldDisableShareButton(),onClick:this.onEmailLinkButtonClick,variant:"primary",className:"email-link-button","data-uxa-log":"sharing-modal-footer-button-send-email"},this.getShareButtonText())),isHeaderBold:!1},this.renderContactTokenizer(r),this.shouldRenderMessageField()&&this.renderMessageField())}shouldRenderMessageField(){return this.state.typeaheadTokens.length>0||this.props.recipientMessage.length>0}shouldDisableShareButton(){return this.props.isEmailSending||this.props.isTokenizerEmpty||this.props.contactsError&&this.props.contactsError.level===d.ContactsErrorLevel.Error}shouldRenderPostNoteAsComment(){return this.props.showPostNoteAsComment&&this.props.recipientMessage.length>0&&this.shouldRenderMessageField()}getTypeaheadPlaceholder(){return this.props.isTeamSharedFolder?p.intl.formatMessage({id:"VMGE6I",defaultMessage:"Group names"}):this.props.user.is_team?p.intl.formatMessage({id:"+nKRfb",defaultMessage:"Add an email, name, or group"}):p.intl.formatMessage({id:"bdV6O3",defaultMessage:"Add an email or name"})}getShareButtonText(){const e=p.intl.formatMessage({id:"vJGcTi",defaultMessage:"Share file"}),t=p.intl.formatMessage({id:"cHEg6H",defaultMessage:"Share folder"}),s=p.intl.formatMessage({id:"Qd1iC2",defaultMessage:"Sharing..."}),n=this.props.isFolder?t:e;return this.props.isEmailSending?s:n}renderContactTokenizer(e){const t=n.default.createElement(n.default.Fragment,null,n.default.createElement(c.ShareContactsTokenizer,{className:e,ref:this.setShareContactsTokenizerRef,actionHandler:this.props.actionHandler,disabledInput:this.props.disabledContactsInput,focusOnMount:!this.props.disabledContactsInput,initialTypeaheadTokens:this.props.initialTypeaheadTokens,typeaheadTokens:this.state.typeaheadTokens,onTypeaheadTokensChange:this.onTypeaheadTokensChange,shouldLogContactSearch:!0,typeaheadPlaceholder:this.getTypeaheadPlaceholder(),user:this.props.user,showContactImport:!this.props.isTeamSharedFolder,teamGroupInfo:this.props.teamGroupInfo,filterContacts:this.filterContacts}),n.default.createElement(r.FormValidationMessage,{message:this.props.contactsError.message,variant:this.getMessageType()}));return this.props.disabledContactsInput?n.default.createElement(o.Tooltip,{id:"tooltip-button",title:p.intl.formatMessage({id:"E3Ydgf",defaultMessage:"You can only copy this link"})},n.default.createElement("div",{id:"contact_tokenizer_with_tooltip"},t)):t}renderMessageField(){return n.default.createElement("div",null,n.default.createElement(h.TextArea,{placeholder:p.intl.formatMessage({id:"30bVmM",defaultMessage:"Add a note"}),"aria-label":p.intl.formatMessage({id:"30bVmM",defaultMessage:"Add a note"}),onChange:this.props.handleMessageChanged,value:this.props.recipientMessage}))}renderPostNoteAsComment(){const e=p.intl.formatMessage({id:"Jfn0Wa",defaultMessage:"Post this note as a comment"});return n.default.createElement(_.CheckboxWithLabel,{onCheckboxToggled:this.onCheckboxToggled,isChecked:this.props.isPostNoteAsCommentChecked,label:e,isCheckboxDisabled:""===this.props.recipientMessage,fontSize:"small"})}logClickShareButtonLinkSettingsStatus(){let e=!1,t=!1,s=!1;if(this.props.sharedLink){const n=m.getAudienceForLink(this.props.sharedLink.link_permissions);e=this.props.sharedLink.link_permissions.require_password||"password"===n,t=!!this.props.sharedLink.expires,s=!this.props.sharedLink.link_permissions.allow_download}this.context.logEvent(g.TiburonEventName.ClickShareButtonLinkSettingsStatus,this.props.sharedLink,{password:e,expiration:t,disable_download:s})}}t.EmailShare=E,E.contextType=u.ShareModalEvolutionContext,E.displayName="EmailShare"})),define("modules/clean/sharing/views/share_modal_evolution/share/share_screen",["require","exports","tslib","react","modules/clean/sharing/views/share_modal_evolution/share/header_section","modules/clean/sharing/views/share_modal_evolution/share/main_section/main_section","modules/clean/sharing/views/share_modal_evolution/share/footer_section","modules/clean/react/components/css"],(function(e,t,s,n,i,a,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ShareScreen=void 0,n=s.__importDefault(n);class l extends n.default.Component{constructor(){super(...arguments),this.shouldRenderFooter=()=>"V1"===this.props.sharingInfo.coreO21nBetterTeamSharingVariant()&&this.props.sharingInfo.getShowSharingQuestionnaire()&&this.props.user.is_team}render(){const{actionHandler:e,contactsError:t,contentMetadata:s,isEmailSending:o,handleManageAccessClick:l,handleMessageChanged:d,initialTypeaheadTokens:c,isTeamSharedFolder:h,isTokenizerEmpty:p,sharingInfo:u,showPassFileSettings:m,onCloseButtonClick:g,onSettingsButtonClick:_,recipientMessage:f,user:S,guestMembers:E,linkMembers:M}=this.props;return n.default.createElement("div",{className:"share-modal-evolution-share-screen"},n.default.createElement(i.HeaderSection,{canEdit:u.permissionsObj().canEdit(),isConfidentialFolder:u.isConfidentialFolder(),isTeamSharedFolder:u.isTeamSharedFolder(),isFolderInsideTeamFolderTree:u.isFolderInsideTeamFolderTree(),showPassFileSettings:m,contentInfo:u.contentInfo(),guestMembers:E,linkMembers:M,membership:u.members(),onCloseButtonClick:g,onManageAccessClick:l,onSettingsButtonClick:_,sharingInfo:u}),n.default.createElement(a.MainSection,{actionHandler:e,closeModalHandler:g,contactsError:t,contentMetadata:s,isEmailSending:o,handleMessageChanged:d,initialTypeaheadTokens:c,isTeamSharedFolder:h,isTokenizerEmpty:p,onManageAccessClick:l,recipientMessage:f,sharingInfo:u,user:S,selectedAccessLevel:"writer"===this.props.sharingInfo.recipientAccess()?"editor":"viewer"}),this.shouldRenderFooter()&&n.default.createElement(r.FooterSection,{actionHandler:e}))}}l.displayName="ShareScreen",t.ShareScreen=o.requireCssWithComponent(l,["/static/css/sharing/share_modal_evolution-vflu7uQ9A.css"])})),define("modules/clean/sharing/views/share_modal_evolution/share/main_section/access_level_dropdown",["require","exports","tslib","react","classnames","dig-components/buttons","dig-components/menu","dig-components/typography","modules/clean/sharing/views/share_modal_evolution/utils/access_level","modules/clean/sharing/views/share_modal_evolution/utils/audience"],(function(e,t,s,n,i,a,r,o,l,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AccessLevelDropdown=void 0,n=s.__importDefault(n),i=s.__importDefault(i);const c="share-modal-evolution-access-level-dropdown";class h extends n.default.Component{constructor(){super(...arguments),this.renderDropdownOptions=e=>e.map(e=>n.default.createElement(r.Menu.SelectItem,{key:e.label,value:e.link_access_level,selected:this.props.selectedAccessLevel===e.link_access_level,disabled:!e.allowed},l.getAccessLevelDescription(this.props.selectedAudience,e.link_access_level))),this.handleSelectedAccessLevelChange=e=>{this.props.selectedAccessLevel!==e&&this.props.onSelectedAccessLevelChange(e)}}render(){const e=this.props.linkAccessLevelOptions,t=1===e.length?" ":": ",s=i.default([`${c}`,e.length>1?`${c}__with-menu`:void 0]);return n.default.createElement("div",{className:s},n.default.createElement(o.Text,{className:`${c}__audience-text`},this.getAudienceText(),t),1===e.length?this.getCurrentAccessLevelText():this.renderAccessMenu(e))}getAudienceText(){const{contentMetadata:e,selectedAudience:t}=this.props;return d.getAudienceText(t,e.owner_team)}getCurrentAccessLevelText(){return n.default.createElement(o.Text,{className:`${c}__audience-text`,isBold:!0},l.getAccessLevelDescription(this.props.selectedAudience,this.props.selectedAccessLevel))}renderAccessMenu(e){return n.default.createElement(r.Menu.Wrapper,{onSelection:this.handleSelectedAccessLevelChange,isPortaled:!1,className:`${c}__unportaled-menu`},({getContentProps:t,getTriggerProps:s})=>n.default.createElement(n.default.Fragment,null,n.default.createElement(a.Button,Object.assign({},s(),{variant:"transparent",withDropdownIcon:!0}),l.getAccessLevelDescription(this.props.selectedAudience,this.props.selectedAccessLevel)),n.default.createElement(r.Menu.Content,Object.assign({},t(),{placement:"bottom-end"}),n.default.createElement(r.Menu.Segment,null,this.renderDropdownOptions(e)))))}}t.AccessLevelDropdown=h,h.displayName="AccessLevelDropdown"})),define("modules/clean/sharing/views/share_modal_evolution/share/main_section/access_level_section",["require","exports","tslib","react","modules/core/i18n","dig-components/typography","modules/clean/sharing/views/share_modal_evolution/share/main_section/access_level_dropdown","modules/clean/sharing/views/share_modal_evolution/utils/audience","modules/clean/sharing/views/share_modal_evolution/utils/context","spectrum-sharing/components/action_section/index","spectrum-sharing/utils/logging"],(function(e,t,s,n,i,a,r,o,l,d,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AccessLevelSection=void 0,n=s.__importDefault(n);class h extends n.default.Component{constructor(){super(...arguments),this.handleSettingsButtonClick=e=>{let t;e.preventDefault(),"editor"===this.props.selectedAccessLevel?(this.props.openSharingSettingsModal("edit_link_settings"),t=c.SettingsTabName.EditLinkSettingsTab):(this.props.openSharingSettingsModal("view_link_settings"),t=c.SettingsTabName.ViewLinkSettingsTab),this.context.logEvent(c.TiburonEventName.ClickSettingsText,this.props.sharedLink,{settings_tab:t})}}render(){const{canCreateLink:e,contentMetadata:t,linkAccessLevelOptions:s,onSelectedAccessLevelChange:i,selectedAccessLevel:l,selectedAudience:c,sharedLink:h,teamPolicy:p}=this.props,u=this.enableSettingsButton();return n.default.createElement(d.ActionSection,{layout:"columns"},n.default.createElement(r.AccessLevelDropdown,{selectedAccessLevel:l,linkAccessLevelOptions:s,contentMetadata:t,selectedAudience:o.getSelectedAudience(e,c,h,p,t.policy),onSelectedAccessLevelChange:i}),n.default.createElement(a.Text,{size:"standard",color:u?"standard":"disabled"},this.renderSettingsButton(u)))}enableSettingsButton(){return this.props.canCreateLink||void 0!==this.props.sharedLink}renderSettingsButton(e){const t=i.intl.formatMessage({id:"Q8t9EL",defaultMessage:"Settings"});return e?n.default.createElement(a.Link,{href:"#",hasNoUnderline:!0,onClick:this.handleSettingsButtonClick,"aria-label":i.intl.formatMessage({id:"5Uwag4",defaultMessage:"Link Settings"})},t):n.default.createElement(n.default.Fragment,null,t)}}t.AccessLevelSection=h,h.displayName="AccessLevelSection",h.contextType=l.ShareModalEvolutionContext})),define("modules/clean/sharing/views/share_modal_evolution/share/main_section/copy_link_section",["require","exports","tslib","react","modules/core/i18n","modules/clean/clipboard_v2","dig-components/typography","dig-components/icons/src","modules/clean/sharing/ui_notifications_util","dig-components/icons","spectrum-sharing/share_modal_evolution/copy_link/copy_link_education_tooltip","modules/clean/sharing/views/share_modal_evolution/utils/context","spectrum-sharing/utils/logging","spectrum-sharing/share_modal_evolution/utils/link_description","spectrum-sharing/share_modal/sharing_settings/utils/index","dig-components/icons/src","dig-components/text_fields"],(function(e,t,s,n,i,a,r,o,l,d,c,h,p,u,m,g,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CopyLinkSection=void 0,n=s.__importDefault(n);const f="share-modal-evolution-share-screen";class S extends n.default.Component{constructor(e){super(e),this.linkRef=n.default.createRef(),this.copyToClipboard=e=>{const t=document.createElement("input");t.value=e,document.body.appendChild(t),t.select(),this.clipboard.do_copy(),document.body.removeChild(t)},this.handleCopyLinkClicked=e=>{e.preventDefault();const t=this.props.getEmailTokenCountFn();this.context.logEvent(p.TiburonEventName.CopySharedLink,this.props.sharedLink,{tokenized_contact_count:t}),this.copyToClipboard(this.props.sharedLink.url),this.props.exp_afterCopy&&this.props.exp_afterCopy()},this.renderCopyLink=e=>n.default.createElement("div",{className:"sharing-modal-footer-link-div"},n.default.createElement(c.CopyLinkEducationTooltip,{key:"copy-link-education-tooltip",intl:i.intl,sharedLink:this.props.sharedLink,linkRef:this.linkRef},n.default.createElement(r.Text,{size:this.props.size},n.default.createElement(r.Link,{key:"linkCopyToClipboard",href:"#",hasNoUnderline:!0,className:"copy-link-button",onClick:this.handleCopyLinkClicked,isBold:!0,ref:this.linkRef,"data-uxa-log":"sharing-modal-footer-copy-link"},n.default.createElement(d.UIIcon,{src:o.LinkLine,size:this.props.size,"aria-label":""}),e))),this.renderBanner()),this.renderBanner=()=>{const e=this.getLinkRestrictions();return e?n.default.createElement(r.Text,{color:"faint"},n.default.createElement("span",{className:"sharing-modal-footer-link-margin"},e),n.default.createElement("span",{className:"sharing-modal-footer-restrictions-margin"},"·"),n.default.createElement(r.Link,{className:"sharing-modal-footer-restrictions-text",inverse:!0,href:"#",onClick:this.props.handleSettingsButtonClick},u.getModifyText(i.intl))):""},this.focusOnInput=()=>{this.inputRef.current&&this.inputRef.current.select()},this.handleCopyLink=()=>{const e=this.props.getEmailTokenCountFn();this.context.logEvent(p.TiburonEventName.CopySharedLink,this.props.sharedLink,{tokenized_contact_count:e}),this.copyToClipboard(this.props.sharedLink.url),this.props.exp_afterCopy&&this.props.exp_afterCopy()},this.renderViewedLinkCopiedText=()=>{var e,t,s;const a=null!==(t=null===(e=this.context.experiments)||void 0===e?void 0:e.sharingOneClickCopyLink)&&void 0!==t?t:"OFF",o="ON"===this.props.createEditFolderLinkExpVariant&&this.props.isFolder&&"editor"===this.props.accessLevel,l=!this.props.isFolder&&"editor"===this.props.accessLevel;return n.default.createElement("div",{className:`${f}-footer-link__link-copied`},n.default.createElement(d.UIIcon,{className:`${f}-footer-link__link-copied-icon`,src:g.CheckmarkCircleLine}),n.default.createElement(r.Text,{tagName:"p",isBold:!0},o||l?i.intl.formatMessage({id:"dmwGjM",defaultMessage:"Edit link copied"}):i.intl.formatMessage({id:"opUQcS",defaultMessage:"View link copied"})),"VIEW_LINK_COPIED_TEXTBOX"===a&&n.default.createElement(_.TextInput,{wrapperProps:{className:`${f}-footer-link__link-copied-input`},size:"standard","aria-label":"Link for copy link click",value:null===(s=this.props.sharedLink)||void 0===s?void 0:s.url,readOnly:!0,onClick:this.focusOnInput,ref:this.inputRef}))},this.inputRef=n.default.createRef()}componentDidMount(){this.setupCopy()}componentDidUpdate(){var e,t;const s=null!==(t=null===(e=this.context.experiments)||void 0===e?void 0:e.sharingOneClickCopyLink)&&void 0!==t?t:"OFF";this.setupCopy(),this.props.createdLink&&this.props.sharedLink&&("VIEW_LINK_COPIED"===s||"VIEW_LINK_COPIED_TEXTBOX"===s)&&this.handleCopyLink()}render(){var e,t;const s=i.intl.formatMessage({id:"t0Frp1",defaultMessage:"Copy link"}),n=null!==(t=null===(e=this.context.experiments)||void 0===e?void 0:e.sharingOneClickCopyLink)&&void 0!==t?t:"OFF";return this.props.createdLink&&("VIEW_LINK_COPIED"===n||"VIEW_LINK_COPIED_TEXTBOX"===n)?this.renderViewedLinkCopiedText():this.renderCopyLink(s)}setupCopy(){var e,t;const s=null!==(t=null===(e=this.context.experiments)||void 0===e?void 0:e.sharingOneClickCopyLink)&&void 0!==t?t:"OFF";this.clipboard=new a.ClipboardV2(()=>("VIEW_LINK_COPIED"!==s&&"VIEW_LINK_COPIED_TEXTBOX"!==s&&this.props.modalClose(),l.showCopyLinkSuccessSnackbar(this.props.sharedLink.url,this.props.accessLevel,this.props.exp_copySnackbarProps)),()=>{this.context.logEvent(p.TiburonEventName.CopySharedLinkFailure,this.props.sharedLink,{tokenized_contact_count:this.props.getEmailTokenCountFn(),error:"failed_copy_to_clipboard"}),l.showCopyLinkErrorSnackbar(this.props.sharedLink.url,this.props.accessLevel)})}getLinkRestrictions(){const e=this.props.sharedLink,t=m.getAudienceForLink(e.link_permissions),s=e.link_permissions.require_password||"password"===t,n=e.expires;return s&&n?u.getRestrictionsApplyText(i.intl):s?u.getPasswordRequiredText(i.intl):n?u.getExpirationEnabledText(i.intl,e):void 0}}t.CopyLinkSection=S,S.displayName="CopyLinkSection",S.contextType=h.ShareModalEvolutionContext})),define("modules/clean/sharing/views/share_modal_evolution/share/main_section/create_link_section",["require","exports","tslib","react","modules/core/i18n","dig-components/typography","dig-components/icons/src","dig-components/icons","spectrum-sharing/components/sharing_spinner/index","modules/clean/sharing/views/share_modal_evolution/share/main_section/create_link_help_text","modules/clean/sharing/views/share_modal_evolution/utils/context"],(function(e,t,s,n,i,a,r,o,l,d,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CreateLinkSection=void 0,n=s.__importDefault(n);class h extends n.default.Component{constructor(e){super(e),this.handleCreateLinkClick=e=>{e.preventDefault(),this.setState({isCreatingLink:!0},()=>{this.props.onCreateLinkClick().catch(()=>{this.setState({isCreatingLink:!1})})})},this.state={isCreatingLink:!1}}render(){return this.state.isCreatingLink?this.renderCreatingLinkLoading():this.renderCreateLink()}renderCreatingLinkLoading(){return n.default.createElement(l.SharingSpinner,{ariaValue:"Loading xsmall",message:i.intl.formatMessage({id:"g7It2O",defaultMessage:"Creating link..."}),textSize:this.props.size})}renderCreateLink(){var e,t;const{canCreateLink:s}=this.props,l=null!==(t=null===(e=this.context.experiments)||void 0===e?void 0:e.sharingOneClickCopyLink)&&void 0!==t?t:"OFF",c=e=>n.default.createElement(a.Link,{key:"toCreateALink",href:"#",hasNoUnderline:!0,onClick:this.handleCreateLinkClick,"aria-label":i.intl.formatMessage({id:"lCKMha",defaultMessage:"Create link"})},e);return s?n.default.createElement(a.Text,{size:this.props.size,isBold:!0},n.default.createElement(o.UIIcon,{src:r.LinkLine,size:this.props.size,"aria-label":""}),"VIEW_LINK_COPIED"===l||"VIEW_LINK_COPIED_TEXTBOX"===l?i.intl.formatMessage({id:"DW0r0G",defaultMessage:"<link>Create</link> and copy link"},{link:c}):i.intl.formatMessage({id:"M7I8En",defaultMessage:"<link>Create</link> then copy link"},{link:c})):n.default.createElement(d.CreateLinkHelpText,{size:this.props.size})}}t.CreateLinkSection=h,h.displayName="CreateLinkSection",h.contextType=c.ShareModalEvolutionContext})),define("modules/clean/sharing/views/share_modal_evolution/share/main_section/create_link_help_text",["require","exports","tslib","react","modules/core/i18n","dig-components/icons","dig-components/icons/src","dig-components/typography","spectrum-sharing/components/help_info/index"],(function(e,t,s,n,i,a,r,o,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CreateLinkHelpText=void 0,n=s.__importDefault(n),t.CreateLinkHelpText=function(e){return n.default.createElement(o.Text,{size:e.size,color:"disabled",isBold:!0},n.default.createElement(a.UIIcon,{src:r.LinkLine,size:e.size,"aria-label":""}),i.intl.formatMessage({id:"t0Frp1",defaultMessage:"Copy link"}),n.default.createElement(l.HelpInfo,{id:"cannotCopyLinkInfo",text:i.intl.formatMessage({id:"CqPhXv",defaultMessage:"You can only email this link"})}))}})),define("modules/clean/sharing/views/share_modal_evolution/share/main_section/copy_or_create_link_section",["require","exports","tslib","react","modules/clean/sharing/views/share_modal_evolution/share/main_section/copy_link_section","modules/clean/sharing/views/share_modal_evolution/share/main_section/create_link_section","spectrum-sharing/utils/logging","modules/clean/sharing/views/share_modal_evolution/utils/context"],(function(e,t,s,n,i,a,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CopyOrCreateLinkSection=void 0,n=s.__importDefault(n);class l extends n.default.Component{constructor(e){super(e),this.handleCreateLinkClick=()=>this.props.actionHandler.createSharedLink(this.props.accessLevel,this.props.selectedAudience),this.handleSettingsButtonClick=e=>{let t;e.preventDefault(),"editor"===this.props.accessLevel?(this.props.actionHandler.openSharingSettingsModal("edit_link_settings"),t=r.SettingsTabName.EditLinkSettingsTab):(this.props.actionHandler.openSharingSettingsModal("view_link_settings"),t=r.SettingsTabName.ViewLinkSettingsTab),this.context.logEvent(r.TiburonEventName.OpenLinkSettingsModal,this.props.sharedLink,{settings_tab:t})},this.state={createdLink:!1}}componentDidUpdate(e){!e.sharedLink&&this.props.sharedLink&&(this.setState({createdLink:!0}),setTimeout(()=>{this.setState({createdLink:!1})},5e3))}render(){var e,t;return this.props.sharedLink?n.default.createElement(i.CopyLinkSection,{accessLevel:this.props.accessLevel,modalClose:this.props.modalClose,sharedLink:this.props.sharedLink,getEmailTokenCountFn:this.props.getEmailTokenCountFn,size:this.props.size,handleSettingsButtonClick:this.handleSettingsButtonClick,exp_afterCopy:()=>{var e,t;return null===(t=(e=this.props.actionHandler).exp_afterCopy)||void 0===t?void 0:t.call(e)},exp_copySnackbarProps:null===(t=(e=this.props.actionHandler).exp_getCopySnackbarProps)||void 0===t?void 0:t.call(e),createdLink:this.state.createdLink,createEditFolderLinkExpVariant:this.props.createEditFolderLinkExpVariant,isFolder:this.props.isFolder}):n.default.createElement(a.CreateLinkSection,{onCreateLinkClick:this.handleCreateLinkClick,canCreateLink:this.props.canCreateLink,size:this.props.size})}}t.CopyOrCreateLinkSection=l,l.defaultProps={size:"small"},l.contextType=o.ShareModalEvolutionContext,l.displayName="CopyOrCreateLinkSection"})),define("modules/clean/sharing/views/share_modal_evolution/share/main_section/share_link_section",["require","exports","tslib","react","modules/clean/sharing/views/share_modal_evolution/share/main_section/email_share","modules/clean/sharing/views/share_modal_evolution/utils/context"],(function(e,t,s,n,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ShareLinkSection=void 0,n=s.__importDefault(n);class r extends n.default.Component{constructor(e){super(e),this.state={numEmailTokens:this.props.initialTypeaheadTokens.length}}render(){return n.default.createElement(i.EmailShare,{actionHandler:this.props.actionHandler,contactsError:this.props.contactsError,isEmailSending:this.props.isEmailSending,disabledContactsInput:!this.props.canInviteByEmail,handleMessageChanged:this.props.handleMessageChanged,modalClose:this.props.modalClose,recipientMessage:this.props.recipientMessage,sharedLink:this.props.sharedLink,showPostNoteAsComment:this.props.showPostNoteAsComment,isFolder:this.props.isFolder,isPostNoteAsCommentChecked:this.props.isPostNoteAsCommentChecked,isTeamSharedFolder:this.props.isTeamSharedFolder,isTokenizerEmpty:this.props.isTokenizerEmpty,initialTypeaheadTokens:this.props.initialTypeaheadTokens,user:this.props.user,emailCountChangeCallback:this.updateEmailTokenCount.bind(this),accessLevel:this.props.accessLevel,getEmailTokenCountFn:this.getEmailTokenCount.bind(this),canCreateLink:this.props.canCreateLink,canCreateViewLinkForFolder:this.props.canCreateViewLinkForFolder,createEditFolderLinkExpVariant:this.props.createEditFolderLinkExpVariant,viewLinkForFolder:this.props.viewLinkForFolder})}updateEmailTokenCount(e){this.setState({numEmailTokens:e})}getEmailTokenCount(){return this.state.numEmailTokens}}t.ShareLinkSection=r,r.displayName="ShareLinkSection",r.contextType=a.ShareModalEvolutionContext})),define("modules/clean/sharing/views/share_modal_evolution/share/main_section/link_section",["require","exports","tslib","react","modules/clean/sharing/views/share_modal_evolution/share/main_section/share_link_section","modules/clean/sharing/views/share_modal_evolution/utils/context"],(function(e,t,s,n,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LinkSection=void 0,n=s.__importDefault(n);class r extends n.default.Component{constructor(e){super(e),this.state={isUpdatingAccess:!1}}render(){return n.default.createElement(i.ShareLinkSection,{key:"shareLinkSection",accessLevel:this.props.accessLevel,actionHandler:this.props.actionHandler,canCreateLink:this.props.canCreateLink,canInviteByEmail:this.props.canInviteByEmail,contactsError:this.props.contactsError,isEmailSending:this.props.isEmailSending,handleMessageChanged:this.props.handleMessageChanged,modalClose:this.props.modalClose,recipientMessage:this.props.recipientMessage,sharedLink:this.props.sharedLink,isPostNoteAsCommentChecked:this.props.isPostNoteAsCommentChecked,isFolder:this.props.isFolder,showPostNoteAsComment:this.props.showPostNoteAsComment,isTeamSharedFolder:this.props.isTeamSharedFolder,isTokenizerEmpty:this.props.isTokenizerEmpty,initialTypeaheadTokens:this.props.initialTypeaheadTokens,user:this.props.user,canCreateViewLinkForFolder:this.props.canCreateViewLinkForFolder,createEditFolderLinkExpVariant:this.props.createEditFolderLinkExpVariant,viewLinkForFolder:this.props.viewLinkForFolder})}}t.LinkSection=r,r.displayName="LinkSection",r.contextType=a.ShareModalEvolutionContext})),define("modules/clean/sharing/views/share_modal_evolution/share/main_section/main_section",["require","exports","tslib","react","spectrum-sharing/components/action_container/index","modules/clean/sharing/access_level","modules/clean/sharing/views/share_modal_evolution/share/main_section/link_section","modules/clean/sharing/views/share_modal_evolution/share/main_section/no_permissions_banner","spectrum-sharing/components/info_box/index","modules/core/i18n","modules/clean/sharing/views/share_modal_evolution/utils/context","spectrum-sharing/utils/logging","modules/clean/sharing/views/share_modal_evolution/share/main_section/access_level_section","modules/clean/static_urls","spectrum-sharing/share_modal/sharing_settings/utils/sharing_settings_util"],(function(e,t,s,n,i,a,r,o,l,d,c,h,p,u,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MainSection=void 0,n=s.__importDefault(n);class g extends n.default.Component{constructor(e){super(e),this.onTabSelected=e=>{this.props.actionHandler.changeRecipientAccess("editor"===e?a.ACCESS_LEVEL.WRITER:a.ACCESS_LEVEL.READER);const t="editor"===e?h.ShareTabName.EditTab:h.ShareTabName.ViewTab;this.context.logEvent(h.TiburonEventName.ViewShareTab,void 0,{share_tab:t})}}componentDidMount(){const e="editor"===this.props.selectedAccessLevel?h.ShareTabName.EditTab:h.ShareTabName.ViewTab;this.context.logEvent(h.TiburonEventName.ViewShareScreen,void 0,{share_tab:e}),this.context.logEvent(h.TiburonEventName.ViewShareTab,void 0,{share_tab:e})}render(){const{actionHandler:e,contentMetadata:t,selectedAccessLevel:s,sharingInfo:a}=this.props;return 0===this.getLinkAccessLevelOptions().length?n.default.createElement(l.InfoBox,{imgPath:u.static_url("/static/images/sharing/share_modal/no_access-vflRKAkm7.png"),imgAlt:d.intl.formatMessage({id:"jLOGFI",defaultMessage:"No permissions to share"}),title:d.intl.formatMessage({id:"XGWBlY",defaultMessage:"You can view, but not share"}),message:this.getNoPermissionsMessage()}):n.default.createElement(i.ActionContainer,{header:this.getHeaderDescription()},n.default.createElement(p.AccessLevelSection,{selectedAccessLevel:s,canCreateLink:this.canCreateLink(s),contentMetadata:t,linkAccessLevelOptions:this.getLinkAccessLevelOptions(),selectedAudience:a.getSelectedAudienceByAccessLevel(s),sharedLink:this.getSharedLinkByAccessLevel(s),teamPolicy:a.teamPolicy(),onSelectedAccessLevelChange:this.onTabSelected,openSharingSettingsModal:e.openSharingSettingsModal}),"editor"===this.props.selectedAccessLevel?this.renderLinkSection("editor"):this.renderLinkSection("viewer"))}getSharedLinkByAccessLevel(e){let t;return"editor"===e?t=this.props.sharingInfo.editRighteousLink():"viewer"===e&&(t=this.props.sharingInfo.viewRighteousLink()||this.props.sharingInfo.shmodelLink()),t}canInvite(e){const t=this.props.sharingInfo.permissionsObj();switch(e){case"editor":return t.canInviteEditor();case"viewer":return t.canInviteViewer();default:return!1}}canCreateLink(e){const{sharingInfo:t,isTeamSharedFolder:s}=this.props,n=this.props.sharingInfo.permissionsObj(),i="ON"===t.sharingPrefs().create_edit_folder_link_variant;return m.canCreateLink(e,t.isCloudDoc(),t.isFolder(),s,t.isConfidentialFolder(),i,n.canInviteEditor(),t.canShareLink(),n.canCreateViewLink(),n.canCreateEditLink())}validateAccessLevel(e){return this.canInvite(e)||this.canCreateLink(e)||void 0!==this.getSharedLinkByAccessLevel(e)}renderLinkSection(e){const{actionHandler:t,sharingInfo:s}=this.props;return this.validateAccessLevel(e)?n.default.createElement(r.LinkSection,{accessLevel:e,actionHandler:t,canCreateLink:this.canCreateLink(e),canInviteByEmail:this.canInvite(e),contactsError:this.props.contactsError,contentMetadata:this.props.contentMetadata,isEmailSending:this.props.isEmailSending,handleMessageChanged:this.props.handleMessageChanged,initialTypeaheadTokens:this.props.initialTypeaheadTokens,isPostNoteAsCommentChecked:s.isShareMessageAsCommentChecked(),isTokenizerEmpty:this.props.isTokenizerEmpty,isTeamSharedFolder:this.props.isTeamSharedFolder,onManageAccessClick:this.props.onManageAccessClick,recipientMessage:this.props.recipientMessage,user:this.props.user,sharedLink:this.getSharedLinkByAccessLevel(e),modalClose:this.props.closeModalHandler,isFolder:s.isFolder(),teamPolicy:s.teamPolicy(),showPostNoteAsComment:s.permissionsObj().canShareMessageAsComment(),canCreateViewLinkForFolder:this.canCreateLink("viewer"),createEditFolderLinkExpVariant:this.props.sharingInfo.sharingPrefs().create_edit_folder_link_variant,viewLinkForFolder:s.shmodelLink()}):n.default.createElement(o.NoPermissionsBanner,{accessLevel:e,isFolder:s.isFolder()})}getHeaderDescription(){return this.props.sharingInfo.isFolder()?d.intl.formatMessage({id:"hMjxKh",defaultMessage:"Share this folder"}):d.intl.formatMessage({id:"8fJdJ4",defaultMessage:"Share this file"})}getLinkAccessLevelOptions(){const e=[];return e.push({link_access_level:"viewer",allowed:this.validateAccessLevel("viewer"),label:"can view"}),e.push({link_access_level:"editor",allowed:this.validateAccessLevel("editor"),label:"can edit"}),e.filter(e=>e.allowed)}getNoPermissionsMessage(){return this.props.sharingInfo.isFolder()?d.intl.formatMessage({id:"fpgILd",defaultMessage:"To share this folder, ask someone else for access to edit."}):d.intl.formatMessage({id:"m4b4bb",defaultMessage:"To share this file, ask someone else for access to edit."})}}t.MainSection=g,g.displayName="MainSection",g.contextType=c.ShareModalEvolutionContext})),define("modules/clean/sharing/views/share_modal_evolution/share/main_section/no_permissions_banner",["require","exports","tslib","react","modules/core/i18n","dig-components/typography","spectrum-sharing/components/banner/index"],(function(e,t,s,n,i,a,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NoPermissionsBanner=void 0,n=s.__importDefault(n);class o extends n.default.Component{render(){return n.default.createElement(r.Banner,{variant:"transparent-left"},n.default.createElement(a.Text,null,this.getNoPermissionsText()))}getNoPermissionsText(){return"editor"===this.props.accessLevel?this.props.isFolder?i.intl.formatMessage({id:"dooCWY",defaultMessage:"You can only share a link for viewing for this folder."}):i.intl.formatMessage({id:"XbAqHv",defaultMessage:"You can only share a link for viewing for this type of file."}):i.intl.formatMessage({id:"X+IYXP",defaultMessage:"This link type isn’t supported."})}}t.NoPermissionsBanner=o,o.displayName="NoPermissionsBanner"})),define("modules/clean/sharing/views/share_modal_evolution/utils/access_level",["require","exports","modules/core/i18n"],(function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getAccessLevelDescription=void 0;const n=s.intl.formatMessage({id:"jAzCAz",defaultMessage:"can edit"}),i=s.intl.formatMessage({id:"GKgRRt",defaultMessage:"can edit"}),a=s.intl.formatMessage({id:"wZejJ8",defaultMessage:"can view"}),r=s.intl.formatMessage({id:"eCFw0p",defaultMessage:"can view"});t.getAccessLevelDescription=function(e,t){return"public"===e?"editor"===t?n:a:"editor"===t?i:r}})),define("modules/clean/sharing/views/share_modal_evolution/utils/audience",["require","exports","modules/clean/sharing/api/types/metadata","modules/core/i18n","spectrum-sharing/share_modal/sharing_settings/utils/index","modules/clean/em_string","spectrum-sharing/utils/sharing_constants"],(function(e,t,s,n,i,a,r){"use strict";function o(e,t,s){return t&&"members"===t.shared_link_policy?"no_one":e&&"default_public"!==e.shared_link_create_policy?"team":s||"public"}Object.defineProperty(t,"__esModule",{value:!0}),t.getSelectedAudience=t.getDefaultAudienceOptions=t.getDefaultAudience=t.getAudienceText=void 0,t.getAudienceText=function(e,t){switch(e){case"public":return n.intl.formatMessage({id:"vAFlk4",defaultMessage:"Anyone with this link"});case"team":return t?n.intl.formatMessage({id:"tOfnIZ",defaultMessage:"{team_name} members with this link"},{team_name:a.Emstring.em_snippet(t.name,r.SNIPPET_SIZES.COMPANY_NAME,1)}):n.intl.formatMessage({id:"wrE9Wi",defaultMessage:"Team Members with this link"});case"password":return n.intl.formatMessage({id:"QI5Jkq",defaultMessage:"People with the password for this link"});case"no_one":return n.intl.formatMessage({id:"SnIjdP",defaultMessage:"Only people invited"})}},t.getDefaultAudience=o,t.getDefaultAudienceOptions=function(e,t,n){const i=[],a=t&&"team_only"===t.shared_link_create_policy;return i.push(new s.LinkAudienceOption({audience:"public",allowed:!a,disallowed_reason:a?s.LinkAudienceDisallowedReason.RestrictedByTeam:null})),i.push(new s.LinkAudienceOption({audience:"team",allowed:e.is_team,disallowed_reason:e.is_team?null:s.LinkAudienceDisallowedReason.UserNotOnTeam})),i.push(new s.LinkAudienceOption({audience:"no_one",allowed:!0})),n&&"members"===n.shared_link_policy?i.map(e=>new s.LinkAudienceOption({audience:e.audience,allowed:!1,disallowed_reason:s.LinkAudienceDisallowedReason.RestrictedBySharedFolder})):i},t.getSelectedAudience=function(e,t,s,n,a,r){return t||(s?i.getAudienceForLink(s.link_permissions):e?o(n,a,r):"no_one")}})),define("modules/clean/sharing/views/share_modal_evolution/utils/context",["require","exports","tslib","react"],(function(e,t,s,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ShareModalEvolutionContextProvider=t.ShareModalEvolutionContext=void 0,n=s.__importDefault(n),t.ShareModalEvolutionContext=n.default.createContext({logEvent:()=>{},experiments:{}}),t.ShareModalEvolutionContextProvider=e=>{const s=n.default.useMemo(()=>({logEvent:e.logEvent,experiments:e.experiments}),[e.logEvent,e.experiments]);return n.default.createElement(t.ShareModalEvolutionContext.Provider,{value:s},e.children)},t.ShareModalEvolutionContextProvider.displayName="ShareModalEvolutionContextProvider"})),define("modules/clean/sharing/views/constants",["require","exports","tslib","lodash","modules/core/i18n"],(function(e,t,s,n,i){"use strict";var a,r,o;Object.defineProperty(t,"__esModule",{value:!0}),t.CONTENT_NAME_MESSAGE_LEVEL_VALUES=t.BANNER_VALUES=t.MODE_VALUES=t.CONTENT_NAME_EMPTY_TOOLTIP=t.NS_LIMIT_ERROR=t.LINK_ONLY_REASON=t.MODES=t.LinkabilityStates=t.FETCH_METADATA_STATUS=t.CONTENT_NAME_MESSAGE_LEVELS=t.BANNERS=void 0,n=s.__importStar(n),(function(e){e[e.NO_MEMBERS=0]="NO_MEMBERS",e[e.INPUT_CONTENT_NAME=1]="INPUT_CONTENT_NAME"})(a=t.BANNERS||(t.BANNERS={})),(function(e){e[e.INFO=0]="INFO",e[e.ERROR=1]="ERROR"})(r=t.CONTENT_NAME_MESSAGE_LEVELS||(t.CONTENT_NAME_MESSAGE_LEVELS={})),(function(e){e[e.FETCHING=0]="FETCHING",e[e.SUCCESS=1]="SUCCESS",e[e.FAIL=2]="FAIL"})(t.FETCH_METADATA_STATUS||(t.FETCH_METADATA_STATUS={})),(function(e){e.CAN_LINK="CAN_LINK",e.INVITE_NO_LINK="INVITE_NO_LINK",e.NO_INVITE_NO_LINK="NO_INVITE_NO_LINK",e.CANT_LINK_TEAM_FOLDER="CANT_LINK_TEAM_FOLDER",e.ERROR_FETCHING_LINK_INFO="ERROR_FETCHING_LINK_INFO"})(t.LinkabilityStates||(t.LinkabilityStates={})),(function(e){e.LINK_ONLY="link-only",e.LOADING="loading",e.MEMBERSHIP="membership",e.POINTER="pointer",e.SHARE="share",e.SHARE_SENDING="share-sending",e.EVOLUTION="evolution"})(o=t.MODES||(t.MODES={})),(function(e){e.INSIDE_SHARED_FOLDER="inside_shared_folder",e.CONTAINS_SHARED_FOLDER="contains_shared_folder",e.LINKS_PAGE="links_page",e.TOTAL_MOUNTS_EXCEEDED="total_mounts_exceeded",e.HOME_MOUNTS_EXCEEDED="home_mounts_exceeded",e.TREE_SIZE_EXCEEDED="tree_size_exceeded"})(t.LINK_ONLY_REASON||(t.LINK_ONLY_REASON={})),(function(e){e.TOTAL_MOUNTS_EXCEEDED="total_mounts_exceeded",e.HOME_MOUNTS_EXCEEDED="home_mounts_exceeded",e.TREE_SIZE_EXCEEDED="tree_size_exceeded"})(t.NS_LIMIT_ERROR||(t.NS_LIMIT_ERROR={})),t.CONTENT_NAME_EMPTY_TOOLTIP=i.intl.formatMessage({id:"mYGncD",defaultMessage:"Name your shared folder"}),t.MODE_VALUES=n.values(o),t.BANNER_VALUES=n.values(a),t.CONTENT_NAME_MESSAGE_LEVEL_VALUES=n.values(r)})),define("modules/clean/sharing/views/inherited_members",["require","exports","tslib","classnames","react","modules/clean/em_string","modules/clean/react/snackbar","modules/clean/react/sprite","modules/clean/sharing/api/types/metadata","spectrum-sharing/utils/sharing_constants","modules/clean/sharing/views/inherited_members_helpers","modules/clean/web_user_action_logger","modules/clean/web_user_action_events","modules/core/i18n","spectrum/icon_content/index","spectrum/button/index","spectrum/modal/index","modules/clean/sharing/ui_notifications_util"],(function(e,t,s,n,i,a,r,o,l,d,c,h,p,u,m,g,_,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SingleInheritedUserAccessChangeModal=t.SetInheritedMembersUIConfidentialModal=t.InheritedMembers=void 0,n=s.__importDefault(n),i=s.__importDefault(i),f=s.__importStar(f);class S extends i.default.Component{constructor(e){super(e),this.onToggleShowMemberList=()=>{0!==this.props.members.length&&this.setState({areMembersExpanded:!this.state.areMembersExpanded})},this.handleToggleInheritanceClick=e=>{this.props.actionHandler.handleSetConfidentialClick(!1,this.props.ownerTeamName)},this.state={areMembersExpanded:!1}}renderMembersList(){return this.state.areMembersExpanded?i.default.createElement("div",null,i.default.createElement("div",{className:"u-mar-top-xs u-mar-horizontal-xs u-pad-top-xs inherited-member-list__divider"}),i.default.createElement("div",null,i.default.createElement("ul",{className:"u-pad-horizontal-s u-pad-vertical-xs inherited-member-list__member"},this.props.children))):void 0}renderRemoveButton(){return this.props.canUpdateConfidentiality?i.default.createElement(g.Button,{className:"inherited-member-list__remove-button button-as-link",onClick:this.handleToggleInheritanceClick,variant:"styleless"},u.intl.formatMessage({id:"aPhz2c",defaultMessage:"Remove"})):void 0}renderTriangle(){return 0===this.props.members.length?i.default.createElement("div",{className:"u-pad-horizontal-xs"}):i.default.createElement(g.Button,{className:"u-pad-horizontal-xxs o-flag__fix inherited-member-list__triangle button-as-link",onClick:this.onToggleShowMemberList,variant:"styleless"},i.default.createElement(o.Sprite,{alt:u.intl.formatMessage({id:"Bcpu+z",defaultMessage:"Toggle whether inherited members are displayed or hidden"}),group:"web",name:this.state.areMembersExpanded?"triangle_open_1x":"triangle_closed_1x"}))}render(){const e=this.props.actionHandler.getSharingInfo().parentFolderName(),t=""===e?u.intl.formatMessage({id:"6fi/fQ",defaultMessage:"Everyone at {team_name}"},{team_name:a.Emstring.em_snippet(this.props.ownerTeamName,d.SNIPPET_SIZES.DISPLAY_NAME)}):u.intl.formatMessage({id:"U5hJI+",defaultMessage:"People with access to “{folder_name}” folder"},{folder_name:a.Emstring.em_snippet(e,d.SNIPPET_SIZES.FILENAME)});let s=0,r=null;this.props.memberCounts&&(r=this.props.contentInfo.isSharedFolder()?this.props.memberCounts.total_unique_inherited_members:this.props.memberCounts.total_unique_users),null!=r?s=r:this.props.members.forEach(e=>{e instanceof l.GroupMembershipInfo?s+=e.member_count:s++});const o=u.intl.formatMessage({id:"ECZFz/",defaultMessage:"{count, plural, one{{count} member} other{{count} members}}"},{count:s}),c=n.default([{"u-mar-bottom-xs":!0,"inherited-member-list__outer-expanded":this.state.areMembersExpanded,"inherited-member-list__outer-closed":!this.state.areMembersExpanded,"inherited-member-list__outer-spectrum":!0}]),h=n.default([{"inherited-member-list__inner":!this.state.areMembersExpanded}]);return i.default.createElement("div",{className:c},i.default.createElement("div",{className:h},i.default.createElement("div",{className:"o-flag inherited-member-list__toggle-show-member",onClick:this.onToggleShowMemberList},this.renderTriangle(),i.default.createElement("div",{className:"o-flag__flex u-pad-vertical-xs u-pad-right-s"},i.default.createElement("div",{className:"o-flag"},i.default.createElement("div",{className:"o-flag__fix"},i.default.createElement(m.IconContent,{name:"folder_shared-small"})),i.default.createElement("div",{className:"o-flag__flex u-pad-left-s"},i.default.createElement("div",{className:"inherited-member-list__member-str u-font-strong"},t),i.default.createElement("div",{className:"inherited-member-list__member-count-str u-font-meta"},o)),i.default.createElement("div",{className:"o-flag__fix u-pad-right-xxs"},this.renderRemoveButton())))),i.default.createElement("div",null,this.renderMembersList())))}}t.InheritedMembers=S,S.displayName="InheritedMembers";class E extends i.default.Component{constructor(e){super(e),this._onToggleConfidentialFolderFalse=()=>{this._onToggleConfidentialFolder(!1)},this.state={isAccepting:!1};const t=e.actionHandler.getSharingInfo().displayPath(),s=e.actionHandler.getSharingInfo().parentFolderName();this.contentGenerator=new c.SetInheritedMembersUIConfidentialModalContentGenerator(e.initialIsConfidentialFolder,t,e.teamName,s)}_onToggleConfidentialFolder(e){const t=!e,s=e===this.props.initialIsConfidentialFolder;e||this.setState({isAccepting:!0});const{actionHandler:n,contentInfo:a}=this.props;r.Snackbar.sync(this.contentGenerator.syncSnackMessage(s),!0,"share-folder-notification");const o=a.isSharedFolder();return n.handleSetConfidential(s).then(e=>{n.fetchDataAndShowShareModal(),s&&h.WebUserActionLog.log(this.props.userId,t?p.WebUserActionLogEvent.CONF_BY_MANAGE_ACCESS:p.WebUserActionLogEvent.CONF_BY_UNDO_AFTER_RESTORE_ACCESS,{ns_id:e.shared_folder_id,original_folder_type:o?p.WebUserActionLogExtraValue.SHARED_FOLDER:p.WebUserActionLogExtraValue.FILE_FOLDER})}).then(()=>{const e=this.contentGenerator.completeSnackMessage(s);t?r.Snackbar.show(i.default.createElement(r.Snackbar,{title:e,timeoutDelayMs:1e4,actionButtonText:u.intl.formatMessage({id:"OfxyEk",defaultMessage:"Undo"}),onActionClick:()=>this._onToggleConfidentialFolder(!0),closeButtonText:u.intl.formatMessage({id:"u/p3Pl",defaultMessage:"Close"}),variant:"complete",id:"share-folder-notification"})):r.Snackbar.complete(e,"share-folder-notification")}).catch(e=>c.handleApiError(e,this.contentGenerator.failSnackMessage(s),()=>this.setState({isAccepting:!1}),"share-folder-notification"))}render(){return i.default.createElement(_.UtilityModal,{ariaLabel:this.contentGenerator.getTitleContent(),title:this.contentGenerator.getTitleContent(),overlayClickClose:!0,primaryAction:this.contentGenerator.getActionString(),secondaryAction:u.intl.formatMessage({id:"d9/SE1",defaultMessage:"Cancel"}),onPrimaryAction:this._onToggleConfidentialFolderFalse,onSecondaryAction:this.props.onCancel,open:!0,onRequestClose:this.props.onCancel,overlayClassName:"file-viewer-modal-overlay"},this.contentGenerator.getBodyContent())}}t.SetInheritedMembersUIConfidentialModal=E,E.displayName="SetInheritedMembersUIConfidentialModal";class M extends i.default.Component{constructor(e){super(e),this.actionCompleteCallback=()=>{const{actionHandler:e}=this.props;f.sharingNotificationSuccess(this.contentGenerator.getSnackBarCompleteString()),this.setState({removing:!1}),e.fetchDataAndShowShareModal()},this.removeTheSelectedMember=()=>{const{member:e,actionHandler:t,isUserSelf:s}=this.props,n=t.getContentInfo().id;return s?t.relinquishMembershipSimple(n,!1):t.removeMemberSimple(n,e.memberId(),!1)},this.changeAccessOfSelectedMember=()=>{const{newAccessLevel:e,actionHandler:t,member:s}=this.props,n=e;return t.changeMemberAccessSimple(t.getContentInfo().id,s.memberId(),n)},this.changeConfidentialAccess=()=>{const{actionHandler:e,userId:t,isSharedFolder:s,isDowngrading:n}=this.props;this.setState({removing:!0});return e.shareIfFileFolder(this.contentGenerator.getSnackBarRemovingString()).then(()=>e.handleSetConfidential(!0,!0).then(()=>this.logWebUserAction(t,n,e.getContentInfo().id,s))).then(()=>n?this.changeAccessOfSelectedMember():this.removeTheSelectedMember()).then(this.actionCompleteCallback).catch(e=>c.handleApiError(e,this.contentGenerator.getSnackBarFailString(),()=>this.setState({removing:!1})))},this.state={removing:!1};const{member:t,teamName:s,parentFolderName:n,currentFolderName:i,isDowngrading:a,isUserSelf:r}=this.props;this.contentGenerator=new c.SingleInheritedUserAccessChangeModalContentGenerator(a,s,n,i,t.displayName()||"",t instanceof l.GroupMembershipInfo,r)}render(){return i.default.createElement(_.UtilityModal,{ariaLabel:this.contentGenerator.getConfirmModalTitleString(),title:this.contentGenerator.getConfirmModalTitleString(),overlayClickClose:!0,primaryAction:this.contentGenerator.getButtonText(),secondaryAction:u.intl.formatMessage({id:"d9/SE1",defaultMessage:"Cancel"}),onPrimaryAction:this.changeConfidentialAccess,onSecondaryAction:this.props.actionHandler.openShareModal,open:!0,onRequestClose:this.props.actionHandler.openShareModal,overlayClassName:"file-viewer-modal-overlay"},this.renderBody())}renderBody(){return i.default.createElement("div",null,i.default.createElement("div",{className:"confirmation-modal__content"},this.contentGenerator.getConfirmModalContent()),i.default.createElement("br",null))}logWebUserAction(e,t,s,n){h.WebUserActionLog.log(e,t?p.WebUserActionLogEvent.CONF_BY_DOWNGRADE_MEMBER:p.WebUserActionLogEvent.CONF_BY_REMOVE_MEMBER,{ns_id:s,original_folder_type:n?p.WebUserActionLogExtraValue.SHARED_FOLDER:p.WebUserActionLogExtraValue.FILE_FOLDER})}}t.SingleInheritedUserAccessChangeModal=M,M.displayName="SingleInheritedUserAccessChangeModal"})),define("modules/clean/sharing/views/inherited_members_helpers",["require","exports","tslib","react","react-intl","api_v2/error","modules/clean/em_string","modules/clean/filepath/filepath","modules/clean/react/components/modal","modules/clean/react/snackbar","spectrum-sharing/utils/sharing_constants","modules/core/i18n","modules/core/notify"],(function(e,t,s,n,i,a,r,o,l,d,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SingleInheritedUserAccessChangeModalContentGenerator=t.SetInheritedMembersUIConfidentialModalContentGenerator=t.handleApiError=void 0,n=s.__importDefault(n),o=s.__importStar(o);t.handleApiError=(e,t,s,n)=>{a.catchApiError(()=>(s&&s(),d.Snackbar.close(n),e instanceof a.ServerError?d.Snackbar.fail(t):l.Modal.close(),p.Notify.error(e.message||h.intl.formatMessage({id:"EQfnGr",defaultMessage:"We were unable to complete your request."})),e))(e)};t.SetInheritedMembersUIConfidentialModalContentGenerator=class{constructor(e,t,s,n){this.initialIsConfidentialFolder=e,this.teamName=s,this.folderName=o.filename(t),this.parentFolderName=n,this.topMostLevelFolder=""===n,this.folderSnippet=r.Emstring.em_snippet(this.folderName,15),this.parentFolderSnippet=r.Emstring.em_snippet(this.parentFolderName,15),this.teamSnippet=r.Emstring.em_snippet(this.teamName,c.SNIPPET_SIZES.DISPLAY_NAME)}getActionString(){const e=r.Emstring.em_snippet(this.teamName,c.SNIPPET_SIZES.DISPLAY_NAME),t=this.topMostLevelFolder?h.intl.formatMessage({id:"xbrdNQ",defaultMessage:"Share with {team_name}"},{team_name:e}):h.intl.formatMessage({id:"CcpVyl",defaultMessage:"Share"});return this.initialIsConfidentialFolder?t:h.intl.formatMessage({id:"6WOQfa",defaultMessage:"Remove"})}getTitleContent(){let e;return e=this.initialIsConfidentialFolder?this.topMostLevelFolder?h.intl.formatMessage({id:"XmdmiQ",defaultMessage:"Share “{folder_name}” with everyone at {team_name}?"},{folder_name:this.folderSnippet,team_name:this.teamSnippet}):h.intl.formatMessage({id:"o2uL8S",defaultMessage:"Share “{folder_name}” with everyone who can access “{parent_folder_name}”?"},{folder_name:this.folderSnippet,parent_folder_name:this.parentFolderSnippet}):this.topMostLevelFolder?h.intl.formatMessage({id:"fYJ2Zy",defaultMessage:"Remove members of {team_name}?"},{team_name:this.teamSnippet}):h.intl.formatMessage({id:"qioX4z",defaultMessage:"Remove members of “{folder_name}” folder?"},{folder_name:this.parentFolderSnippet}),e}getBodyContent(){let e;return e=this.initialIsConfidentialFolder?this.topMostLevelFolder?h.intl.formatMessage({id:"+yGlTj",defaultMessage:"<strong>{folder_name}</strong> won’t be shared privately any more. Everyone at {team_name} will have access to this folder."},{team_name:this.teamSnippet,folder_name:this.folderSnippet,strong:e=>n.default.createElement("strong",{style:{fontWeight:500}},e)}):h.intl.formatMessage({id:"qc2+KU",defaultMessage:"Everyone who can access <strong>{parent_folder_name}</strong> will be able to access this folder."},{parent_folder_name:this.parentFolderSnippet,strong:e=>n.default.createElement("strong",{style:{fontWeight:500}},e)}):this.topMostLevelFolder?h.intl.formatMessage({id:"EFGwFd",defaultMessage:"Members of {team_name} won’t be able to access <strong>{folder_name}</strong>."},{team_name:this.teamSnippet,folder_name:this.folderSnippet,strong:e=>n.default.createElement("strong",{style:{fontWeight:500}},e)}):h.intl.formatMessage({id:"8x9N0T",defaultMessage:"Members of <strong>{parent_folder_name}</strong> folder won’t be able to access <strong>{folder_name}</strong>."},{parent_folder_name:this.parentFolderSnippet,folder_name:this.folderSnippet,strong:e=>n.default.createElement("strong",{style:{fontWeight:500}},e)}),n.default.createElement("div",null,n.default.createElement("div",{className:"confirmation-modal__content"},e),n.default.createElement("br",null))}syncSnackMessage(e){return e?h.intl.formatMessage({id:"YFmCHZ",defaultMessage:"Removing members from <strong>{folder_name}</strong>…"},{folder_name:this.folderSnippet,strong:e=>n.default.createElement("strong",{style:{fontWeight:500}},e)}):this.topMostLevelFolder?h.intl.formatMessage({id:"4xzuPe",defaultMessage:"Sharing <strong>{folder_name}</strong> with everyone…"},{folder_name:this.folderSnippet,strong:e=>n.default.createElement("strong",{style:{fontWeight:500}},e)}):h.intl.formatMessage({id:"DI9fEf",defaultMessage:"Sharing <strong>{folder_name}</strong> with members of <strong>{parent_folder_name}</strong>…"},{folder_name:this.folderSnippet,parent_folder_name:this.parentFolderSnippet,strong:e=>n.default.createElement("strong",{style:{fontWeight:500}},e)})}completeSnackMessage(e){return e?h.intl.formatMessage({id:"r445sC",defaultMessage:"Members removed from <strong>{folder_name}</strong>."},{folder_name:this.folderSnippet,strong:e=>n.default.createElement("strong",{style:{fontWeight:500}},e)}):this.topMostLevelFolder?h.intl.formatMessage({id:"a5EQjJ",defaultMessage:"<strong>{folder_name}</strong> shared with everyone."},{folder_name:this.folderSnippet,strong:e=>n.default.createElement("strong",{style:{fontWeight:500}},e)}):h.intl.formatMessage({id:"67McYW",defaultMessage:"<strong>{folder_name}</strong> shared with members of <strong>{parent_folder_name}</strong>."},{folder_name:this.folderSnippet,parent_folder_name:this.parentFolderSnippet,strong:e=>n.default.createElement("strong",{style:{fontWeight:500}},e)})}failSnackMessage(e){return e?h.intl.formatMessage({id:"otsE6R",defaultMessage:"Too many members to restrict access. Try adding specific people to a new folder."}):h.intl.formatMessage({id:"Z4c55e",defaultMessage:"Couldn’t share folder. Try sharing again."})}};t.SingleInheritedUserAccessChangeModalContentGenerator=class{constructor(e,t,s,a,r,o,l){this.getButtonText=()=>this.isDowngrading?h.intl.formatMessage({id:"/sfVvH",defaultMessage:"Change access"}):this.isTsdPlusOne?h.intl.formatMessage({id:"g7vg1d",defaultMessage:"Remove everyone"}):h.intl.formatMessage({id:"6WOQfa",defaultMessage:"Remove"}),this.getConfirmModalTitleString=()=>this.isRelinquishment?h.intl.formatMessage({id:"amnrJj",defaultMessage:"Remove yourself from “{parent_folder}”?"},{parent_folder:this.parentFolderName}):this.isDowngrading?h.intl.formatMessage({id:"x01mJ5",defaultMessage:"Change how members can access “{current_folder}”?"},{current_folder:this.currentFolderName}):this.isTsdPlusOne?h.intl.formatMessage({id:"sSJ+PD",defaultMessage:"Remove everyone at {team_name}?"},{team_name:this.teamName}):h.intl.formatMessage({id:"F23jdQ",defaultMessage:"Remove a member of “{parent_folder}”?"},{parent_folder:this.parentFolderName}),this.getConfirmModalTitle=()=>{const e={current_folder:this.currentFolderName,parent_folder:this.parentFolderName,team_name:this.teamName,b:e=>n.default.createElement("b",{style:{fontWeight:500}},e)};let t;return t=this.isRelinquishment?i.defineMessage({id:"ANxsmU",defaultMessage:"<b>Remove yourself from “{parent_folder}”?</b>"}):this.isDowngrading?i.defineMessage({id:"fG6HZx",defaultMessage:"<b>Change how members can access “{current_folder}”?</b>"}):this.isTsdPlusOne?i.defineMessage({id:"7gnJT/",defaultMessage:"<b>Remove everyone at {team_name}?</b>"}):i.defineMessage({id:"tAFtaB",defaultMessage:"<b>Remove a member of “{parent_folder}”?</b>"}),h.intl.formatMessage(t,e)},this.getConfirmModalContent=()=>{const e={member_name:this.memberName,parent_folder:this.parentFolderName,current_folder:this.currentFolderName,team_name:this.teamName,b:e=>n.default.createElement("b",{style:{fontWeight:500}},e),br:n.default.createElement("br",null)};let t;return t=this.isRelinquishment?i.defineMessage({id:"hfMe4J",defaultMessage:"You won’t be able to see future changes to this shared folder, and new members of <b>{parent_folder}</b> won’t have access to this folder automatically."}):this.isTsdPlusOne?this.isDowngrading?i.defineMessage({id:"xO44hJ",defaultMessage:"{member_name} will only be able to view this folder, and new {team_name} members won’t be able to access it automatically.{br}{br}To add more people to this folder in the future, you’ll need to invite them directly."}):i.defineMessage({id:"8bNVGs",defaultMessage:"{team_name} members won’t be able to see future changes to <b>{current_folder}</b> automatically.{br}{br}To give people access to this folder in the future, you’ll need to invite them directly."}):this.isDowngrading?i.defineMessage({id:"eo+uWg",defaultMessage:"{member_name} will only be able to view this folder, and new members of <b>{parent_folder}</b> won’t be able to access it automatically.{br}{br}To add more people to this folder in the future, you’ll need to invite them directly."}):i.defineMessage({id:"zDnrtL",defaultMessage:"{member_name} and new members of the <b>{parent_folder}</b> folder won’t be able to see future changes to this shared folder.{br}{br}To add more people to this folder in the future, you’ll need to invite them directly."}),h.intl.formatMessage(t,e)},this.getSnackBarRemovingString=()=>{const e={b:e=>n.default.createElement("b",{style:{fontWeight:500}},e),current_folder:this.currentFolderName},t=this.isDowngrading?i.defineMessage({id:"0Lmb+Y",defaultMessage:"Changing access for <b>{current_folder}</b>…"}):this.memberIsGroup?i.defineMessage({id:"hpOZFA",defaultMessage:"Removing members from <b>{current_folder}</b>…"}):i.defineMessage({id:"tbN3jw",defaultMessage:"Removing member from <b>{current_folder}</b>…"});return h.intl.formatMessage(t,e)},this.getSnackBarCompleteString=()=>{const e={b:e=>n.default.createElement("b",{style:{fontWeight:500}},e),current_folder:this.currentFolderName},t=this.isDowngrading?i.defineMessage({id:"srndH4",defaultMessage:"Access changed for <b>{current_folder}</b>."}):this.memberIsGroup?i.defineMessage({id:"bnI+zs",defaultMessage:"Members removed from <b>{current_folder}</b>."}):i.defineMessage({id:"GWzQpn",defaultMessage:"Member removed from <b>{current_folder}</b>."});return h.intl.formatMessage(t,e)},this.getSnackBarFailString=()=>this.isDowngrading?h.intl.formatMessage({id:"5Yzfj9",defaultMessage:"Couldn’t change access. Try changing access again."}):this.memberIsGroup?h.intl.formatMessage({id:"NCQATi",defaultMessage:"Couldn’t remove members. Try removing them again."}):h.intl.formatMessage({id:"jHXRss",defaultMessage:"Couldn’t remove member. Try removing them again."}),this.isDowngrading=e,this.teamName=t,this.parentFolderName=s,this.currentFolderName=a,this.memberName=r,this.isTsdPlusOne=""===s,this.memberIsGroup=o,this.isRelinquishment=l}}})),define("modules/clean/sharing/views/member_list",["require","exports","tslib","immutable","classnames","react","modules/clean/sharing/access_level","modules/clean/sharing/api/types/metadata","spectrum-sharing/utils/sharing_constants","modules/clean/sharing/views/inherited_members","modules/clean/sharing/views/member_list_item","modules/clean/sharing/views/viewer_info","modules/clean/sharing/ui_util","modules/clean/viewer","modules/core/i18n","modules/clean/sharing/views/wrapped_group_viewers_maker","modules/clean/react/pass/store","modules/clean/integrations/data/store","react-redux","modules/clean/sharing/ui_util","spectrum-sharing/utils/logging"],(function(e,t,s,n,i,a,r,o,l,d,c,h,p,u,m,g,_,f,S,E,M){"use strict";var C;Object.defineProperty(t,"__esModule",{value:!0}),t.SharingMemberList=t.SecurityBannerType=void 0,i=s.__importDefault(i),a=s.__importDefault(a),(function(e){e[e.RemoveAccess=0]="RemoveAccess",e[e.DowngradeAccess=1]="DowngradeAccess"})(C=t.SecurityBannerType||(t.SecurityBannerType={}));class b extends a.default.Component{constructor(){super(...arguments),this.renderMembersListItem=(e,t,s)=>{const n=e.memberKey(),i=this.isLinkVisitor(e,t),o=this.props.groupSeenStateInfo[e.memberId()]?this.renderWrappedGroupViewersElement(e):void 0,d=this.props.canUpdateConfidentiality&&e.is_inherited,h=!!d||!this.props.contentInfo.isFileFolder()&&this.props.canRelinquishMembership;return a.default.createElement(c.SharingMemberListItem,{hasLinkMetadata:this.props.hasLinkMetadata,canInviteMembers:this.props.canInviteMembers,canRelinquishMembership:h,contentInfo:this.props.contentInfo,wrappedGroupViewersElement:o,isInheritedMember:s,isMemberActionPending:this.props.pendingMemberAction.has(n),isPresent:this.props.shouldShowPassUI&&this.isMemberCurrentlyViewing(e),key:n,member:e,user:this.props.user,onAccessChangeInBubbleMenu:t=>{const s=t===l.MEMBER_ACTION.REMOVE,n=t===l.MEMBER_ACTION.MANAGE_LINK_ACCESS,a=!s&&r.isLowerAccess(e.access_type,t),o=this.props.contentInfo.isSharedFolder()?e.inherited_access_type:e.access_type,c=s||a&&o&&r.isLowerAccess(o,t);if((s||a)&&this.props.onShowSecurityBanner){const e=s?C.RemoveAccess:C.DowngradeAccess;this.props.onShowSecurityBanner(e)}if(d&&c){const s=this.props.ownerTeamName,n={new_access:t,old_access:e.access_type,inherited_access:o};return E.logTiburonEvent(this.props.contentInfo,this.props.user.id,M.TiburonEventName.SelectChangeMemberPermission,n),this.props.actionHandler.handleInheritedMemberAccessChange(e,s,a,a?t:void 0)}if(n&&i){const t="writer"===e.access_type?"editor":"viewer",s={access_level:t};return E.logTiburonEvent(this.props.contentInfo,this.props.user.id,M.TiburonEventName.ClickManageAccess,s),this.props.actionHandler.handleLinkSettingsClick({isLinkOnly:!1,linkAccessLevel:t})}return this.props.actionHandler.handleMemberAccessChange(e,t)},isLinkVisitor:i})}}render(){const e=p.makeMemberSortCmp(this.props.user,this.props.presentAccountIds||n.Set(),this.shouldSortUsingPassRules()),t=this.membersByInheritance();let s=t.get(!1);s&&(s=s.sort(e));let i=t.get(!0);i&&(i=i.sort(e));let r=null;return this.props.areMembersFullyLoaded||(r=a.default.createElement("div",{className:"sharing-member-list__loading c-loader u-mar-horizontal-auto u-l-b"},m.intl.formatMessage({id:"A0CVFo",defaultMessage:"Loading more members..."}))),a.default.createElement(S.Provider,{store:f.initStoreForIntegration(this.props.user.id)},a.default.createElement("div",{className:"sharing-member-list"},this.renderInheritedUI(s,i),r))}shouldSortUsingPassRules(){const e=_.passStore.getPassPermissions(this.props.contentInfo.extras.fileId);return null!=e&&(e.canReadPresence||e.canReadSeenState)}renderInheritedUI(e,t){const s=n.Set(this.getLinkVisitors()),r=this.renderInheritedMembers(s,t);let o=null;e&&e.count()>0&&(o=a.default.createElement("div",null,e.map(e=>this.renderMembersListItem(e,s)).toArray()));const l=i.default({"o-list-ui":!0});return a.default.createElement("ul",{className:l},r,o)}renderInheritedMembers(e,t){const{isConfidentialFolder:s,ownerTeamName:n}=this.props;if(this.shouldShowInherited()&&n&&!s)return a.default.createElement(d.InheritedMembers,{actionHandler:this.props.actionHandler,canUpdateConfidentiality:this.props.canUpdateConfidentiality,contentInfo:this.props.contentInfo,memberCounts:this.props.memberCounts,members:t?t.toArray():[],ownerTeamName:n},t&&t.map(t=>this.renderMembersListItem(t,e,!0)))}getLinkVisitors(){return this.props.linkMembers.concat(this.props.guestMembers)}isLinkVisitor(e,t){return e instanceof o.UserMembershipInfo&&t.contains(e)}isMemberCurrentlyViewing(e){return!this.memberIsAssumed(e)&&(e instanceof o.UserMembershipInfo&&this.props.presentAccountIds&&this.props.presentAccountIds.has(e.account_id))}memberIsAssumed(e){return e instanceof o.UserMembershipInfo&&e.account_id===this.props.user.account_id&&u.Viewer.get_viewer().is_assume_user_session}dedupUsersAndLinkVisitors(e,t){let s=n.Map();return t.forEach(e=>{s=s.set(e.memberKey(),e)}),s.merge(e)}membersByInheritance(){const e=this.getLinkVisitors(),t=e=>this.shouldShowInherited()&&e.is_inherited,{membership:s}=this.props;if(!s)return e.length>0?n.List(e).groupBy(t):n.Map();const{groups:i,invitees:a,users:r}=s,o=this.dedupUsersAndLinkVisitors(r,e);return i.valueSeq().concat(a.valueSeq(),o.valueSeq()).groupBy(t)}shouldShowInherited(){const e=this.props.actionHandler.getSharingInfo(),t=!!e.parentSharedFolderId();return e.isUserOnOwnerTeam()&&t}extractGroupSeenStateAndViewers(e){const t=this.props.groupSeenStateInfo[e.memberId()];let s=[];return this.props.presentAccountIds&&(s=t.map(e=>new h.ViewerInfo(e)).filter(e=>null!=e.time_last_seen||this.props.presentAccountIds.has(e.account_id))),{singleGroupSeenStateInfo:t,viewers:s}}renderWrappedGroupViewersElement(e){const{viewers:t}=this.extractGroupSeenStateAndViewers(e);return t.length?g.WrappedGroupViewersMaker.make(t,this.props.presentAccountIds):{element:null,elementText:""}}}t.SharingMemberList=b,b.displayName="SharingMemberList",b.defaultProps={disabled:!1,groupSeenStateInfo:{},guestMembers:[],linkMembers:[]}})),define("modules/clean/sharing/views/member_list_item",["require","exports","tslib","classnames","react","modules/clean/avatar/avatar_with_default","modules/clean/em_string","modules/clean/avatar/initials_avatar","modules/clean/avatar/size","spectrum-sharing/utils/sharing_constants","modules/clean/datetime/datetime","modules/clean/react/pass/utils","modules/clean/react/title_bubble","modules/clean/sharing/share_modal_dropdown_util","modules/clean/sharing/api/types/metadata","modules/clean/static_urls","modules/core/i18n","modules/core/user_i18n","spectrum-sharing/components/member_row/index","modules/clean/sharing/access_level","modules/clean/sharing/strings","spectrum-sharing/utils/sharing_constants","modules/clean/integrations/profile_card_popover","modules/clean/integrations/integration_popover","modules/clean/integrations/data/store","react-redux","typescript/component_libraries/deep-integrations/src/async","spectrum/button/index","modules/clean/integrations/data/selectors","modules/clean/react/sticky_position"],(function(e,t,s,n,i,a,r,o,l,d,c,h,p,u,m,g,_,f,S,E,M,C,b,I,v,y,T,k,w,A){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SharingMemberListItem=t.SharingMemberListItemElement=void 0,n=s.__importDefault(n),i=s.__importDefault(i),a=s.__importDefault(a),f=s.__importStar(f);class N extends i.default.Component{constructor(){super(...arguments),this.popoverGroup=new I.IntegrationPopoverGroup,this.onMemberRowChange=(e,t)=>{this.props.onAccessChangeInBubbleMenu(t)},this.openProfileCard=()=>{this.popoverRef&&this.popoverRef.openProfileCard()}}shouldLinkToGroup(){return this.props.member instanceof m.GroupMembershipInfo&&(!!this.props.member.same_team&&(!!this.props.user.is_team_admin||!!this.props.member.is_member&&this.props.member.group_management_type!==m.GroupManagementType.system_managed))}linkToGroup(e,t,s){const a=`/team#groups/${e.group_id}`,r=n.default({"u-font-meta":!s,"sharing-member-info__group-name-link":!0,"sharing-member-info__display-name-title":s});return i.default.createElement("a",{href:a,target:"_blank",rel:"noopener noreferrer",className:r,title:e.group_name},t)}renderAvatar(e,t){const s=this.props.member.displayName()||"",n=this.getAvatarInitials(),r=t?"SQUARE":"CIRCLE",{member:d,user:c,contentInfo:p,isPresent:u,isProfileCardEnabled:g}=this.props,f=h.AnonymousViewerUtils.isAnonymousUserId(d.memberId())?d.memberId():s,S=i.default.createElement("div",{className:"o-flag__fix"},i.default.createElement(a.default,{dimension:l.AvatarSize.MEDIUM,photoUrl:e,shape:r,defaultAvatar:i.default.createElement(o.InitialsAvatarWithColorDerivedFromName,{dimension:l.AvatarSize.MEDIUM,shape:r,initials:n,name:f,alt:""})}));if(g){const t=v.initStoreForIntegration(this.props.user.id);let s,n;if(d instanceof m.GroupMembershipInfo){const e=d;let t="";this.shouldRenderGroupCount()&&(t=_.intl.formatMessage({id:"ECZFz/",defaultMessage:"{count, plural, one{{count} member} other{{count} members}}"},{count:d.member_count})),s={avatarType:"group",targetGroup:{gid:e.group_id,groupName:e.displayName(),message:t}}}else if(d instanceof m.InviteeMembershipInfo){const t=d;s={avatarType:"invited_person",targetUser:{accountId:t.contact,displayName:t.displayName(),familiarName:t.displayName(),accessType:M.ACCESS_NAME[t.access_type],email:t.contact,photoUrl:e||void 0}}}else if(d instanceof m.UserMembershipInfo){const t=d;s={avatarType:"joined_member",targetUser:{accountId:t.account_id,displayName:t.displayName()||t.email()||"",familiarName:t.displayName(),accessType:M.ACCESS_NAME[t.access_type],isViewer:t.account_id===this.props.user.account_id,email:t.email(),photoUrl:e||void 0}},n=t.time_last_seen}const a={".tag":p.isFolder()?"folder":"file",id:T.fulfilled(p.idForLink()),name:p.name()};if(s)return i.default.createElement(b.ProfileCardPopover,{popoverRef:e=>this.popoverRef=e,popoverGroup:this.popoverGroup,integrationStore:t,avatarInfo:s,entryPoint:"share_sheet",file:this.props.hasLinkMetadata?a:void 0,seenState:u?this.getPresentText():this.getLastSeenText(n),viewerId:c.id,positioning:"right",upsellPositioning:"right",portalParentElement:document.querySelector("body")||void 0,maxCalendarEventsToRender:1,autoRePosition:!0},i.default.createElement(k.Button,{variant:"circular"},S))}return S}getDisplayName(e,t){let s;this.props.member.displayName()&&(s=this.props.member.displayName()),s=void 0!==s?s:"";let n=this.getLastSeenText(e);this.props.isPresent?n=this.getPresentText():e&&(n=this.getLastSeenText(e));const i=this.getDisabledMessage(t);let a=0,o=0;n&&(a=new r.Emstring(`  ·  ${n}`).length),i&&(o=new r.Emstring(`  ·  ${i}`).length);const l=d.SNIPPET_SIZES.DISPLAY_NAME-a-o,c=r.Emstring.em_snippet(s,l);return this.shouldLinkToGroup()&&!this.shouldRenderGroupCount()?this.linkToGroup(this.props.member,c,!0):c}getAvatarInitials(){const e=this.props.member.displayName()||"";return f.getInitials(e)}getPresentText(){return _.intl.formatMessage({id:"BMhlbR",defaultMessage:"Viewing now"})}getLastSeenText(e){let t="";return e&&(t=_.intl.formatMessage({id:"uIg+ju",defaultMessage:"Viewed {time_str}"},{time_str:c.ago(e)})),t}getDisabledMessage(e){let t="";return e&&e.disabled&&(t=_.intl.formatMessage({id:"RBvabN",defaultMessage:"Deleted"})),t}getOffTeamMessage(e){let t="";const s=e&&!e.email;return!this.props.user.is_team||this.props.member.same_team||s||(t=_.intl.formatMessage({id:"x48gqV",defaultMessage:"Outside your Dropbox team"})),t}getMemberDetails(e,t){let s;return e?s=this.shouldLinkToGroup()?this.linkToGroup(this.props.member,e,!1):e:t&&t.email&&t.email_verified&&(s=t.email),s}isAllowedToRelinquishMembership(){return this.props.member.memberId()===this.props.user.account_id&&this.props.canRelinquishMembership}getOptionGroup(){let e=[],t="";const s=M.ACCESS_NAME[this.props.member.access_type],n=u.getMemberActionInfo(this.isAllowedToRelinquishMembership());for(const s of n){const n=s[0],i=s[1];this.props.member.access_type===i.value&&(t=i.value);const a=this.getOptionGroupOption(n,i);a&&e.push(a)}const i=e.find(e=>e.apiId===C.MEMBER_ACTION.MANAGE_LINK_ACCESS);return i&&(e=[i]),{id:`optionGroup${this.props.member.memberId()}`,label:s,options:e,selectedApiId:t,enabled:!this.props.isMemberActionPending}}getOptionGroupOption(e,t){if(t.value===C.MEMBER_ACTION.MANAGE_LINK_ACCESS&&this.props.isLinkVisitor)return{apiId:t.value,label:t.title,tooltip:_.intl.formatMessage({id:"Ja6XYU",defaultMessage:"Change or remove their access in link settings"}),disabled:!1};if(u.shouldShowMemberAction(e,t.value,this.props.member.access_type,this.props.member.permissions,this.isAllowedToRelinquishMembership())){const e=this.props.contentInfo.isFolder()?t.folder_description:t.file_description,s=t.value===C.MEMBER_ACTION.REMOVE?"red":t.value===E.ACCESS_LEVEL.READER?"border":"default";return{apiId:t.value,label:t.title,tooltip:e||"",variant:s}}}renderSeenStateInfo(e,t){const s=_.intl.formatDate(t,{day:"numeric",month:"short",year:"numeric"}),n=_.intl.formatTime(t,{hour:"numeric",minute:"numeric"});return i.default.createElement(p.TitleBubble,{content:i.default.createElement("div",null,s,n&&i.default.createElement("br",null),n),className:"timestamp-tooltip",children:i.default.createElement("span",null,e),position:A.StickyPosition.BOTTOM,isTargetPositionFixed:!0})}shouldRenderGroupCount(){return this.props.member instanceof m.GroupMembershipInfo&&this.props.member.member_count}render(){const{member:e}=this.props;let t,s,n=void 0,a=!1,r=void 0,o=void 0,l="";if(e instanceof m.UserMembershipInfo){if(l=e.account_id,n=e.account,!n)return null;r=n.profile_photo_url,t=e.time_last_seen}else e instanceof m.GroupMembershipInfo&&(l=e.group_id,a=!0,"team"===e.group_type&&(r=g.static_url("/static/images/icons/team_24@2x-vflR8kGKs.png")),this.shouldRenderGroupCount()&&(o=_.intl.formatMessage({id:"ECZFz/",defaultMessage:"{count, plural, one{{count} member} other{{count} members}}"},{count:e.member_count})));return this.props.wrappedGroupViewersElement&&this.props.wrappedGroupViewersElement.element?s=this.props.wrappedGroupViewersElement.element:this.props.isPresent?s=this.getPresentText():t&&(s=this.renderSeenStateInfo(this.getLastSeenText(t),t)),i.default.createElement(S.MemberRow,{id:l,avatarUrl:r||"",avatarElement:this.renderAvatar(r,a),initialAvatarShape:a?"square":"circle",displayName:this.getDisplayName(t,n),disabledMessage:this.getDisabledMessage(n),description:this.getMemberDetails(o,n),passString:s,offTeamMessage:this.getOffTeamMessage(n),present:this.props.isPresent,initials:this.getAvatarInitials(),loadingSpinnerVisible:this.props.isMemberActionPending,optionGroup:this.getOptionGroup(),onChange:this.onMemberRowChange,variant:this.props.isInheritedMember?"borderless":"default",onClickDetails:this.props.isProfileCardEnabled?this.openProfileCard:void 0,onClickDisplayName:this.props.isProfileCardEnabled?this.openProfileCard:void 0})}}t.SharingMemberListItemElement=N,N.displayName="SharingMemberListItemElement",N.defaultProps={canInviteMembers:!1,canRelinquishMembership:!1,disabled:!1,isPresent:!1,isViewOnly:!1},t.SharingMemberListItem=y.connect(e=>({isProfileCardEnabled:w.isProfileCardInShareSheetEnabled(e)}))(N)})),define("modules/clean/sharing/views/modal_content_spectrum",["require","exports","tslib","modules/core/browser","classnames","react","modules/clean/analytics","modules/clean/contacts/util","modules/clean/filepath/filepath","modules/clean/react/bubble_dropdown_v2","modules/clean/react/components/css","ts-key-enum","modules/clean/react/async/loadable","modules/clean/react/pass/constants","modules/clean/sharing/ui_util","modules/clean/sharing/gating_util","modules/clean/sharing/content_manager","modules/clean/sharing/views/constants","modules/clean/sharing/views/share_modal_header_section","modules/clean/sharing/views/member_list","modules/clean/sharing/views/share_modal_contacts_section","modules/clean/sharing/views/share_modal_footer_link_section","modules/clean/sharing/views/share_modal_pointer_mode","modules/clean/web_timing_logger","modules/clean/sharing/views/share_modal/contacts_error_banner","modules/clean/sharing/views/share_modal/sharing_modal_no_permissions_section","modules/core/i18n","spectrum-sharing/components/confidential_folder_section/index","modules/clean/sharing/views/share_modal/inform_owner_update_section","spectrum-sharing/components/sharing_modal_banner/index","spectrum-sharing/components/sharing_modal_message_field/index","spectrum-sharing/components/scooter_loader/index","spectrum-sharing/utils/logging","spectrum-sharing/utils/sharing_constants","modules/clean/sharing/views/share_modal_evolution/share_modal_evolution","modules/clean/sharing/access_level","modules/clean/sharing/ui_util"],(function(e,t,s,n,i,a,r,o,l,d,c,h,p,u,m,g,_,f,S,E,M,C,b,I,v,y,T,k,w,A,N,L,P,O,F,R,x){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MODES=t.ShareModalContentSpectrum=void 0,n=s.__importStar(n),i=s.__importDefault(i),a=s.__importDefault(a),o=s.__importDefault(o),l=s.__importStar(l),I=s.__importStar(I),Object.defineProperty(t,"MODES",{enumerable:!0,get:function(){return f.MODES}});const D=p.Loadable({loader:()=>new Promise((t,s)=>{e(["modules/clean/sharing/views/comments_integrated_footer_section"],t,s)}).then(s.__importStar).then(({CommentsIntegratedFooterSection:e})=>e)});class U extends a.default.Component{constructor(){super(...arguments),this.isGoldenGateTeamOverLimit=()=>m.shouldEnforceMemberLimits(this.props.user,this.props.isTeamSharedFolder,this.props.isFolderInsideTeamFolderTree)&&(null!=this.props.memberCounts?this.props.memberCounts.total_unique_users:0)>=g.GoldenGate.SHARING_TOTAL_LIMIT,this.handleCheckChanged=e=>{this.props.actionHandler.changeCreateCommentCheckbox(e)},this.handleLogTiburonEvent=(e,t,s)=>{const{modalSessionId:n,origin:i}=this.props.contentInfo.extras;r.ShareTibEventLogger.log(t,e,i,Object.assign(Object.assign({},s),{modal_session_id:n}))},this.handleMessageChanged=e=>{this.props.actionHandler.changeRecipientMessage(e.target.value)},this.linkSectionProps=()=>({actionHandler:this.props.actionHandler,contentInfo:this.props.contentInfo,mode:this.props.mode,user:this.props.user,onLinkSettingsClick:this.props.onLinkSettingsClick,closeModalHandler:this.props.onModalCloseClick,isLinkMetadataLoaded:this.props.isLinkMetadataLoaded,isTeamSharedFolder:this.props.isTeamSharedFolder,canShareLink:this.props.canShareLink,permissions:this.props.sharingPermissions}),this._addEveryoneGroup=()=>this.contactsSection.addExternalContacts([o.default.teamGroupInfoToContact(this.props.teamGroupInfo)]),this.headerSectionProps=()=>({ref:this.setHeaderSectionRef,actionHandler:this.props.actionHandler,contentInfo:this.props.contentInfo,contentNameMessage:this.props.contentNameMessage,contentNameMessageLevel:this.props.contentNameMessageLevel,canEdit:this.props.canEdit,isTeamSharedFolder:this.props.isTeamSharedFolder,isFolderInsideTeamFolderTree:this.props.isFolderInsideTeamFolderTree,isInContentManager:this.props.isInContentManager,isConfidentialFolder:this.props.isConfidentialFolder,isContentNameFocused:this.props.isContentNameFocused,isCreatingNewFolder:this.props.isCreatingNewFolder,isMetadataLoaded:this.props.isMetadataLoaded,initialContentName:this.props.initialContentName,onModalCloseClick:this.props.onModalCloseClick,onSettingsButtonClick:this.props.onSettingsClick,onContentNameInputChange:this.handleContentNameInputChange,onContentNameInputKeyUp:this.handleContentNameInputKeyUp,ownerTeam:this.props.ownerTeam,sharingInfo:this.props.actionHandler.getSharingInfo(),showPassFileSettings:this.props.showPassFileSettings,user:this.props.user}),this.contactsSectionProps=()=>({ref:this.setContactsSectionRef,actionHandler:this.props.actionHandler,contentInfo:this.props.contentInfo,canInviteEditor:this.props.sharingPermissions.canInviteEditor(),canInviteViewer:this.props.sharingPermissions.canInviteViewer(),context:"spectrum",focusOnMount:this.props.focusOnMount&&this.props.contentInfo.pathExists(),initialTypeaheadTokens:this.getInitialTypeaheadTokens(),isFolderInsideTeamFolderTree:this.props.isFolderInsideTeamFolderTree,isInContentManager:this.props.isInContentManager,isTeamSharedFolder:this.props.isTeamSharedFolder,memberCountWithRecipients:this.props.memberCountWithRecipients,ownerTeam:this.props.ownerTeam,shouldLogContactSearch:!0,typeaheadPlaceholder:this.getTypeaheadPlaceholder(),user:this.props.user,showContactImport:!this.props.isTeamSharedFolder,teamGroupInfo:this.props.isTeamSharedFolder?this.props.teamGroupInfo:void 0}),this.handleContentNameInputChange=e=>{this.props.actionHandler.handleContentNameChange(e.currentTarget.value)},this.handleContentNameInputKeyUp=e=>{e.key===h.Key.Enter&&this.contactsSection&&this.contactsSection.focusTypeaheadInput()},this.handleShareButtonClick=t=>s.__awaiter(this,void 0,void 0,(function*(){const{actionHandler:n,recipientMessage:i,user:a}=this.props;if(this.props.isCreatingNewFolder)try{return yield n.setContentNameAndSendShare(this.contactsSection)}catch(e){this.headerSection.selectContentNameInput(),this.props.onSetContentNameAndSendShareFail&&this.props.onSetContentNameAndSendShareFail(e)}else{const r=i&&n.getSharingInfo().isShareMessageAsCommentChecked()&&!n.getSharingInfo().permissionsObj().canShareMessageAsComment(),o=r?yield this.extractUserContacts():[];if(yield n.sendShare(this.contactsSection),r)return new Promise((t,s)=>{e(["modules/clean/sharing/actions/comments2_integration"],t,s)}).then(s.__importStar).then(({processAndDispatchAddCommentAction:e})=>{e(t,a,i,o)})}})),this.setContactsSectionRef=e=>{this.contactsSection=e},this.setHeaderSectionRef=e=>{this.headerSection=e}}componentDidMount(){this.logTTI()}componentDidUpdate(e,t){return this.logTTI()}logTTI(){return this.props.contentInfo.extras.origin===O.SHARE_ACTION_ORIGIN_TYPE.GRANT_ACCESS&&this.props.mode!==f.MODES.LOADING&&I.mark_time_to_interactive(),this.props.mode===f.MODES.LINK_ONLY&&this.props.isLinkMetadataLoaded?this.props.actionHandler.logIfHaventBefore(P.TiburonEventName.ViewLinkOnlyModal,{link_only_reason:this.props.linkOnlyReason||"undefined"}):(this.props.mode!==f.MODES.LOADING&&this.props.actionHandler.logIfHaventBefore(P.TiburonEventName.ViewShareModal),this.props.mode===f.MODES.MEMBERSHIP?this.props.actionHandler.logIfHaventBefore(P.TiburonEventName.MemberListLoaded,{member_count:this.props.actionHandler.getSharingInfo().memberNum()}):void 0)}render(){let e=`${this.props.mode}`;this.props.mode===f.MODES.MEMBERSHIP&&(this._shouldRenderMainMembershipMode()||(e="no-main-membership"));const t=i.default("unified-share-modal",`unified-share-modal--${e}`,"unified-share-modal--two-link",{"unified-share-modal--loading":e===f.MODES.LOADING});switch(this.props.mode){case f.MODES.LINK_ONLY:return a.default.createElement("div",{className:t},a.default.createElement(S.ShareModalHeaderSection,Object.assign({},this.headerSectionProps())),this.props.linkOnlyReason!==f.LINK_ONLY_REASON.LINKS_PAGE&&this.renderLinkOnlyNoPermissionSection(),this.renderLinkOnlyFooter());case f.MODES.POINTER:return a.default.createElement(b.ShareModalPointerMode,{className:t,sharingInfo:this.props.sharingInfo,onClickCloseButton:this.props.onModalCloseClick});case f.MODES.LOADING:return a.default.createElement("div",{className:t},a.default.createElement(S.ShareModalHeaderSection,Object.assign({},this.headerSectionProps(),{isLoading:!0})),this._renderMainLoading());case f.MODES.EVOLUTION:return a.default.createElement("div",{className:t},a.default.createElement(F.ShareModalEvolution,Object.assign({},this.shareModalEvolutionProps())));default:return a.default.createElement("div",{className:t},a.default.createElement(S.ShareModalHeaderSection,Object.assign({},this.headerSectionProps())),this._renderToSection(),a.default.createElement(v.ContactsErrorBanner,Object.assign({},this.props.contactsError)),this.shouldRenderConfidentialFolderSection()&&a.default.createElement(k.ConfidentialFolderSection,Object.assign({},this.confidentialFolderSectionProps())),this.shouldRenderInformOwnerUpdateSection()&&a.default.createElement(w.InformOwnerUpdateSection,null),this._renderMainSection(),this.shouldRenderFooterSection()&&this.renderFooterSection())}}_renderToSection(){return this.props.showContentManagerBridge?this._renderContentManagerBridge():this.props.sharingPermissions.canInvite()?this.isGoldenGateTeamOverLimit()?this._renderOverLimitSection():a.default.createElement(M.ShareModalContactsSection,Object.assign({},this.contactsSectionProps())):a.default.createElement(y.SharingModalNoPermissionsSection,Object.assign({},this.noPermissionsSectionProps()))}noPermissionsSectionProps(){return{isFolder:this.props.contentInfo.isFolder(),isTeamSharedFolder:this.props.isTeamSharedFolder,members:this.props.members,teamName:this.props.ownerTeam&&this.props.ownerTeam.name}}shouldRenderContentSettingsShareButton(){return this.props.contentInfo.isFolder()&&this.props.contentInfo.pathExists()||this.props.contentInfo.isFile()&&this.props.showPassFileSettings||this.inShareMode()||this.props.isInContentManager}inShareMode(){return[f.MODES.SHARE,f.MODES.SHARE_SENDING].includes(this.props.mode)}shouldRenderFooterSection(){return!!this.props.isMetadataLoaded&&(this.shouldRenderLinkRowInFooter()||this.shouldRenderContentSettingsShareButton())}renderFooterSection(){const e=i.default(["unified-share-modal__section","unified-share-modal__section--footer"]);return a.default.createElement("div",{className:e},this.shouldRenderLinkRowInFooter()?this.renderLinkRowContent():this.renderRegularFooterContent())}shareButtonProps(){return{mode:this.props.mode,contentInfo:this.props.contentInfo,contactsError:this.props.contactsError,contentNameMessage:this.props.contentNameMessage,isInContentManager:this.props.isInContentManager,isTeamSharedFolder:this.props.isTeamSharedFolder,isTokenizerEmpty:this.props.isTokenizerEmpty,onShareButtonClick:this.handleShareButtonClick,shareButtonLabelOverride:this.props.shareButtonLabelOverride}}renderRegularFooterContent(){return a.default.createElement(D,Object.assign({sharingInfo:this.props.sharingInfo,onCheckChanged:this.handleCheckChanged,hasRecipientMessage:this.props.recipientMessage.length>0},this.shareButtonProps()))}_shouldRenderMainMembershipMode(){return this.props.sharingPermissions.canInvite()||this._showSharingMemberList()}_renderMainSection(){switch(this.props.mode){case f.MODES.MEMBERSHIP:return this._shouldRenderMainMembershipMode()?this._renderMainMembership():null;case f.MODES.SHARE:case f.MODES.SHARE_SENDING:return this._renderMainShare();default:return null}}confidentialFolderSectionProps(){const{ownerTeam:e,contentInfo:t,actionHandler:s}=this.props;return{intl:T.intl,teamName:e?e.name:"",parentFolderName:s.getSharingInfo().parentFolderName(),isRestoreAccessEnabled:t.pathExists(),onRestoreAccessClick:s.handleSetConfidentialClick}}shouldRenderConfidentialFolderSection(){return this.props.isConfidentialFolder&&this.props.canUpdateConfidentiality}hasOwnersThatAreNotCurrentUser(){const e=this.props.members;return null!=e&&e.users.filter(e=>e.access_type===R.ACCESS_LEVEL.OWNER&&e.team_member_id!==this.props.user.team_member_id).size>0}shouldRenderInformOwnerUpdateSection(){return!!this.props.sharingInfo.metadata()&&(this.props.isInContentManager&&this.props.contentInfo.isFolder()&&!this.props.isTeamSharedFolder&&!this.props.isFolderInsideTeamFolderTree&&this.hasOwnersThatAreNotCurrentUser())}_renderContentManagerBridge(){const e=this.props.actionHandler.getSharingInfo(),t=l.parent_dir(e.displayPath()),s=e.name(),n=_.genContentManagerBridgeUri({containingFolder:t,filenameToSelect:s}),i=a.default.createElement("span",null,T.intl.formatMessage({id:"EpLafK",defaultMessage:"You can manage access in the <link>admin console</link>."},{link:e=>a.default.createElement("a",{href:n.toString(),target:"_blank",rel:"noreferrer"},e)}));return a.default.createElement(A.SharingModalBanner,{message:i})}_renderOverLimitSection(){const e=T.intl.formatMessage({id:"JSd+J1",defaultMessage:"This folder is over its {member_limit}-member limit."},{member_limit:g.GoldenGate.SHARING_TOTAL_LIMIT}),t=a.default.createElement("div",null,a.default.createElement("div",null,e),a.default.createElement("div",null,T.intl.formatMessage({id:"wFsjaI",defaultMessage:"Please remove some members."})," ",a.default.createElement("a",{href:"/help/9292",target:"_blank",rel:"noopener"},T.intl.formatMessage({id:"epmnB3",defaultMessage:"Learn more."}))));return a.default.createElement(A.SharingModalBanner,{message:t})}_renderMainLoading(){return a.default.createElement("div",{className:i.default(["unified-share-modal__main","unified-share-modal__section","unified-share-modal__section--no-border",this.shouldRenderFooterSection()?void 0:"unified-share-modal__main--no-footer-spectrum"])},a.default.createElement("div",{className:"unified-share-modal__loader-wrapper"},a.default.createElement("div",{className:"c-loader"},T.intl.formatMessage({id:"/DGYJM",defaultMessage:"Loading..."}))))}renderLinkOnlyFooter(){return a.default.createElement("div",{className:i.default(["unified-share-modal__section","unified-share-modal__section--footer"])},this.props.isLinkMetadataLoaded?this.renderLinkRowContent():this.renderLinkOnlyLoading())}renderLinkRowContent(){if(!this.props.isInContentManager)return a.default.createElement(C.ShareModalFooterLinkSection,Object.assign({},this.linkSectionProps()))}getLinkOnlyReasonMessage(){const e=this.props.sharingInfo.countsExceedNsLimit();switch(this.props.linkOnlyReason){case f.LINK_ONLY_REASON.INSIDE_SHARED_FOLDER:return a.default.createElement("span",null,T.intl.formatMessage({id:"vApw15",defaultMessage:"This folder can only be shared as a link because it’s in a shared folder."})," ",a.default.createElement("a",{href:"/help/1931",target:"_blank",rel:"noopener noreferrer"},T.intl.formatMessage({id:"bjsWDZ",defaultMessage:"Learn more"})));case f.LINK_ONLY_REASON.CONTAINS_SHARED_FOLDER:return a.default.createElement("span",null,T.intl.formatMessage({id:"0er2Ve",defaultMessage:"This folder can only be shared as a link because it contains a shared folder."})," ",a.default.createElement("a",{href:"/help/1931",target:"_blank",rel:"noopener noreferrer"},T.intl.formatMessage({id:"bjsWDZ",defaultMessage:"Learn more"})));case f.LINK_ONLY_REASON.TOTAL_MOUNTS_EXCEEDED:return a.default.createElement("span",null,e?x.getTotalMountsExceededLinkOnlyMsg(e):x.getTotalMountsExceededMsg()," ",a.default.createElement("a",{href:"/support",target:"_blank",rel:"noopener noreferrer"},T.intl.formatMessage({id:"bjsWDZ",defaultMessage:"Learn more"})));case f.LINK_ONLY_REASON.HOME_MOUNTS_EXCEEDED:return a.default.createElement("span",null,e?x.getHomeMountsExceededLinkOnlyMsg(e):x.getHomeMountsExceededMsg()," ",a.default.createElement("a",{href:"/support",target:"_blank",rel:"noopener noreferrer"},T.intl.formatMessage({id:"bjsWDZ",defaultMessage:"Learn more"})));case f.LINK_ONLY_REASON.TREE_SIZE_EXCEEDED:return a.default.createElement("span",null,e?x.getTreeSizeExceededLinkOnlyMsg(e):x.getTreeSizeExceededMsg()," ",a.default.createElement("a",{href:"/support",target:"_blank",rel:"noopener noreferrer"},T.intl.formatMessage({id:"bjsWDZ",defaultMessage:"Learn more"})));default:return T.intl.formatMessage({id:"RSBaM6",defaultMessage:"This folder can only be shared as a link."})}}renderLinkOnlyNoPermissionSection(){let e;return e=this.props.actionHandler.getSharingInfo().isOSXPackage()?T.intl.formatMessage({id:"vJ3Igb",defaultMessage:"This package file can only be shared as a link."}):this.getLinkOnlyReasonMessage(),a.default.createElement(A.SharingModalBanner,{message:e})}renderLinkOnlyLoading(){return a.default.createElement("div",{className:"unified-share-modal__link-info--loading"},a.default.createElement(L.ScooterLoader,{"aria-label":T.intl.formatMessage({id:"qxfDnR",defaultMessage:"Loading..."})}))}_showSharingMemberList(){return!!this.props.sharingInfo.hasNonSelfMembers()||(this.props.isFolderInsideTeamFolderTree?1===this.props.members.users.size||!this.props.isConfidentialFolder:this.props.guestMembers.length>0||this.props.linkMembers.length>0)}_renderMemberList(){return a.default.createElement("div",{className:i.default(["unified-share-modal__section","unified-share-modal__section--no-padding","unified-share-modal__section--no-border"])},a.default.createElement(E.SharingMemberList,Object.assign({},this.memberListProps())))}shareModalEvolutionProps(){return{actionHandler:this.props.actionHandler,contactsError:this.props.contactsError,contentMetadata:this.props.metadata,currentScreen:this.props.currentScreen,isEmailSending:this.props.sharingInfo.uiMode()===f.MODES.SHARE_SENDING,handleMessageChanged:this.handleMessageChanged,initialTypeaheadTokens:this.getInitialTypeaheadTokens(),isFolder:this.props.contentInfo.isFolder(),isFolderInsideTeamFolderTree:this.props.isFolderInsideTeamFolderTree,isTeamSharedFolder:this.props.isTeamSharedFolder,isTokenizerEmpty:this.props.isTokenizerEmpty,logTiburonEvent:this.handleLogTiburonEvent,memberListProps:this.memberListProps(),onCloseButtonClick:this.props.onModalCloseClick,onSettingsButtonClick:this.props.onSettingsClick,ownerTeam:this.props.ownerTeam,recipientMessage:this.props.recipientMessage,sharingInfo:this.props.sharingInfo,showScreen:this.props.actionHandler.showScreen,user:this.props.user,guestMembers:this.props.guestMembers,linkMembers:this.props.linkMembers,showPassFileSettings:this.props.showPassFileSettings}}memberListProps(){return{actionHandler:this.props.actionHandler,areMembersFullyLoaded:this.props.areMembersFullyLoaded,canInviteMembers:this.props.sharingPermissions.canInvite(),hasLinkMetadata:this.props.isLinkMetadataLoaded,canRelinquishMembership:this.props.canRelinquishMembership,canUpdateConfidentiality:this.props.canUpdateConfidentiality,contentInfo:this.props.contentInfo,disabled:this.props.showContentManagerBridge,groupSeenStateInfo:this.props.groupSeenStateInfo,guestMembers:this.props.guestMembers,isConfidentialFolder:this.props.isConfidentialFolder,linkMembers:this.props.linkMembers,memberCounts:this.props.memberCounts,membership:this.props.members,ownerTeamName:this.props.ownerTeam?this.props.ownerTeam.name:void 0,pendingMemberAction:this.props.pendingMemberAction,presentAccountIds:this.props.presentAccountIds,shouldShowPassUI:this.props.isPassEnabled&&u.fetchingStatusIsSuccessful(this.props.passFetchingStatus),user:this.props.user}}_renderTeamSharedFolderBanner(){let e;return e=null!=this.props.teamGroupInfo?[a.default.createElement("p",{className:"u-mar-top-xxl"},a.default.createElement("a",{onClick:this._addEveryoneGroup},T.intl.formatMessage({id:"DnaiNC",defaultMessage:"Add everyone at {team_name}"},{team_name:this.props.ownerTeam.name}))),a.default.createElement("p",null,T.intl.formatMessage({id:"ix7pHj",defaultMessage:"Or, add groups to this team folder."})+" ",a.default.createElement("a",{onClick:this.props.onCreateGroupCallback},T.intl.formatMessage({id:"tthwuJ",defaultMessage:"Create a group"})))]:a.default.createElement("p",{className:"u-mar-top-xxl"},T.intl.formatMessage({id:"IjevGW",defaultMessage:"Add groups to this team folder."})+" ",a.default.createElement("a",{onClick:this.props.onCreateGroupCallback},T.intl.formatMessage({id:"tthwuJ",defaultMessage:"Create a group"}))),a.default.createElement("div",{className:i.default(["unified-share-modal__section","unified-share-modal__section--no-border"])},a.default.createElement("div",{className:i.default(["unified-share-modal__no-members-banner","u-font-center","u-font-meta","u-font-center","u-font-meta"])},e))}_renderMainMembership(){const e=i.default(["unified-share-modal__main",this._isPassInfoLoaded()?"unified-share-modal__main--pass-loaded":void 0]);return this._showSharingMemberList()?a.default.createElement("div",{className:e},this._renderMemberList()):this.props.isTeamSharedFolder?a.default.createElement("div",{className:e},this._renderTeamSharedFolderBanner()):a.default.createElement("div",{className:e},a.default.createElement(N.SharingModalMessageField,Object.assign({},this.messageFieldProps())))}messageFieldProps(){return{placeholder:T.intl.formatMessage({id:"LQgYei",defaultMessage:"Add a message (optional)"}),onChange:this.handleMessageChanged,value:this.props.recipientMessage}}_renderMainShare(){return a.default.createElement("div",{className:"unified-share-modal__main"},!this.props.isTeamSharedFolder&&a.default.createElement(N.SharingModalMessageField,Object.assign({},this.messageFieldProps())))}_isPassInfoLoaded(){return u.fetchingStatusIsComplete(this.props.passFetchingStatus)}shouldRenderLinkRowInFooter(){return this.props.mode!==f.MODES.SHARE&&this.props.mode!==f.MODES.SHARE_SENDING&&!this.props.isInContentManager}getInitialTypeaheadTokens(){const{recipientTokens:e,initialRecipientTokens:t}=this.props;return e?t.concat(e):t}getTypeaheadPlaceholder(){return this.props.isTeamSharedFolder?T.intl.formatMessage({id:"GLQxt4",defaultMessage:"Group names"}):this.props.user.is_team?T.intl.formatMessage({id:"BoLL3S",defaultMessage:"Email, name, or group"}):T.intl.formatMessage({id:"EUp7Eo",defaultMessage:"Email or name"})}extractUserContacts(){return s.__awaiter(this,void 0,void 0,(function*(){return yield this.props.actionHandler.recipientsChange(this.contactsSection.getContacts()),this.contactsSection.getContacts().filter(({dbx_account_id:e,email:t})=>void 0!==e||void 0!==t).map(({dbx_account_id:e,email:t,name:s})=>e?{accountId:e,displayName:s}:{email:t,displayName:s})}))}}U.displayName="ShareModalContentSpectrum",U.defaultProps={headerId:"unified-share-modal-title",initialRecipientTokens:[],isTeamSharedFolder:!1,mode:f.MODES.MEMBERSHIP,onFolderSettingsClick:null,guestMembers:[],linkMembers:[],onCreateGroupCallback:()=>{n.redirect("/team#groups/newgroup")}};const B=c.requireCssWithComponent(U,["/static/css/spectrum/index.web-vfliw9181.css","/static/js/spectrum-sharing/index.web-vflcBM29v.css","/static/css/react/contacts_tokenizer-vfl6f1mr3.css","/static/css/scooter/scooter-scoped-vflpl9JSl.css","/static/css/sharing/share_modal-vfllczqU5.css","/static/css/modal-vflp8UKYY.css"],[d.BubbleDropdown]);t.ShareModalContentSpectrum=B})),define("modules/clean/sharing/views/righteous_modal_link_info",["require","exports","tslib","modules/core/i18n","classnames","react","modules/clean/clipboard_v2","modules/clean/sharing/views/constants","modules/clean/react/util","spectrum-sharing/components/sharing_modal_footer_link/index","spectrum-sharing/components/scooter_loader/index","spectrum/button/index","spectrum/icon_acl/index","spectrum/colorized_icon/index","modules/clean/sharing/ui_notifications_util","modules/clean/sharing/link_description","modules/clean/sharing/views/share_modal/sharing_modal_upsell_premium_sharing","modules/clean/sharing/ui_util","spectrum-sharing/utils/sharing_constants","spectrum-sharing/utils/logging","spectrum-sharing/utils/logging","modules/clean/sharing/views/share_modal_evolution/utils/logging"],(function(e,t,s,n,i,a,r,o,l,d,c,h,p,u,m,g,_,f,S,E,M,C){"use strict";function b(e){const t=S.COLORS.COLOR_INK_60;switch(e){case"editor":return a.default.createElement(u.ColorizedIcon,{color:t},a.default.createElement(p.IconAcl,{name:"link-edit"}));default:return a.default.createElement(u.ColorizedIcon,{color:t},a.default.createElement(p.IconAcl,{name:"link-view"}))}}Object.defineProperty(t,"__esModule",{value:!0}),t.RighteousModalLinkInfo=t.getSpectrumLinkIcon=void 0,i=s.__importDefault(i),a=s.__importDefault(a),n.intl.formatMessage({id:"tyzuDO",defaultMessage:"Link copied. Allows editing."}),n.intl.formatMessage({id:"6z63dh",defaultMessage:"Link copied. Allows viewing."}),t.getSpectrumLinkIcon=b;class I extends a.default.Component{constructor(e){super(e),this.getSpectrumLinkText=e=>{switch(e){case"editor":return a.default.createElement("span",null,a.default.createElement("b",null,n.intl.formatMessage({id:"fE8Xhp",defaultMessage:"Can edit"})),a.default.createElement("br",null),this.renderLinkDescription());case"viewer":return a.default.createElement("span",null,a.default.createElement("b",null,n.intl.formatMessage({id:"ReyNxC",defaultMessage:"Can view"})),a.default.createElement("br",null),this.renderLinkDescription());default:return this.renderLinkDescription()}},this.setTextInputRef=e=>(this.urlField=e,e),this.getSpectrumNoLinkText=e=>{switch(e){case"editor":return a.default.createElement("span",null,a.default.createElement("b",null,n.intl.formatMessage({id:"fE8Xhp",defaultMessage:"Can edit"})),a.default.createElement("br",null),n.intl.formatMessage({id:"QfMy5I",defaultMessage:"No link created yet."}));case"viewer":return a.default.createElement("span",null,a.default.createElement("b",null,n.intl.formatMessage({id:"ReyNxC",defaultMessage:"Can view"})),a.default.createElement("br",null),n.intl.formatMessage({id:"QfMy5I",defaultMessage:"No link created yet."}));default:return n.intl.formatMessage({id:"le+3CZ",defaultMessage:"No link created yet"})}},this.onClickButtonCreateLink=()=>{this.setState({creatingLink:!0},()=>this.handleCreateLinkClicked())},this.handleCreateLinkClicked=()=>{this.props.actionHandler&&this.props.actionHandler.createSharedLink(this.props.linkAccessLevel)},this.getSpectrumLoadingText=e=>{switch(e){case"editor":return a.default.createElement("span",null,a.default.createElement("b",null,n.intl.formatMessage({id:"fE8Xhp",defaultMessage:"Can edit"})),a.default.createElement("br",null),n.intl.formatMessage({id:"d3Gvwr",defaultMessage:"Creating edit link..."}),a.default.createElement(c.ScooterLoader,null));case"viewer":return a.default.createElement("span",null,a.default.createElement("b",null,n.intl.formatMessage({id:"ReyNxC",defaultMessage:"Can view"})),a.default.createElement("br",null),n.intl.formatMessage({id:"rnuyM8",defaultMessage:"Creating view link..."}),a.default.createElement(c.ScooterLoader,null));default:return}},this.handleCopyLinkClicked=()=>{if(!this.state.showingUrl){const e={};if(this.props.linkMetadata){e.visibility=this.props.linkMetadata.link_permissions.resolved_visibility,e.expiration=this.props.linkMetadata.expires;const t=C.getLinkKey(this.props.linkMetadata.url);t.kind!==M.LinkKeyTypes.NONE&&(e[t.kind]=t.val,e.link_type=t.link_type)}this.props.contentInfo&&(f.logTiburonEvent(this.props.contentInfo,this.props.user.id,E.TiburonEventName.ClickTibCopyLink,e),f.logTiburonEvent(this.props.contentInfo,this.props.user.id,E.TiburonEventName.CopySharedLink,e))}return l.setStatePromise(this,{showingUrl:!this.state.showingUrl,creatingLink:!1}).then(()=>{if(this.urlField){const e=this.urlField;e.focus(),e.select(),this.clipboard.do_copy()}})},this.state={showingUrl:!1,creatingLink:!1},this.clipboard=null}getLinkabilityState(){const e=this.props.actionHandler&&this.props.actionHandler.getSharingInfo(),{permissions:t}=this.props;return e&&e.isCloudDoc()?this.getLinkabilityStateForCloudDoc():this.props.isTeamSharedFolder?o.LinkabilityStates.CANT_LINK_TEAM_FOLDER:(e.isFolder()||!e.isMetadataLoaded()||t.canCreateViewLink())&&(this.props.canShareLink||this.props.mode===o.MODES.LINK_ONLY)?o.LinkabilityStates.CAN_LINK:t.canInvite()?o.LinkabilityStates.INVITE_NO_LINK:o.LinkabilityStates.NO_INVITE_NO_LINK}getLinkabilityStateForCloudDoc(){const e=this.props.actionHandler&&this.props.actionHandler.getSharingInfo();return this.props.linkMetadata?o.LinkabilityStates.CAN_LINK:"editor"===this.props.linkAccessLevel&&e.permissionsObj().canCreateEditLink()?o.LinkabilityStates.CAN_LINK:"viewer"===this.props.linkAccessLevel&&e.permissionsObj().canCreateViewLink()?o.LinkabilityStates.CAN_LINK:o.LinkabilityStates.NO_INVITE_NO_LINK}componentWillMount(){this.clipboard=new r.ClipboardV2(()=>(this.props.modalClose(),m.showCopyLinkSuccessSnackbar(this.props.linkMetadata.url,this.props.linkAccessLevel)),(function(){m.sharingNotificationError(n.intl.formatMessage({id:"YHoriR",defaultMessage:"Unable to copy the link, please copy manually"}))}))}spectrumClassNames(){return i.default("scl-sharing-modal-footer-link--no-border")}render(){const e=this.props.actionHandler&&this.props.actionHandler.getSharingInfo(),t=this.getLinkabilityState();if(t===o.LinkabilityStates.NO_INVITE_NO_LINK)return this.renderSpectrumCantLinkOrShare();if(t===o.LinkabilityStates.INVITE_NO_LINK)return this.renderSpectrumCantLinkCDM();if(t===o.LinkabilityStates.CANT_LINK_TEAM_FOLDER)return this.renderSpectrumCantLinkTeamFolder();if(this.props.linkMetadata){let t;return t=this.state.showingUrl?this.renderSpectrumCopyLink():this.renderSpectrumLink(),a.default.createElement(a.default.Fragment,null,t,e.hasCreatedLink()&&this.renderUpsellPremiumSharing())}return this.state.creatingLink?a.default.createElement(a.default.Fragment,null,this.renderSpectrumLoading(),this.renderUpsellPremiumSharing()):t===o.LinkabilityStates.CAN_LINK?this.renderSpectrumNoLink():null}getSpectrumLinkNoAvailableCloudDocText(e){switch(e){case"editor":return a.default.createElement("span",null,a.default.createElement("b",null,n.intl.formatMessage({id:"fE8Xhp",defaultMessage:"Can edit"})),a.default.createElement("br",null),n.intl.formatMessage({id:"5tpMRl",defaultMessage:"Link not available"}));case"viewer":return a.default.createElement("span",null,a.default.createElement("b",null,n.intl.formatMessage({id:"ReyNxC",defaultMessage:"Can view"})),a.default.createElement("br",null),n.intl.formatMessage({id:"5tpMRl",defaultMessage:"Link not available"}));default:return n.intl.formatMessage({id:"5tpMRl",defaultMessage:"Link not available"})}}renderSpectrumCantLinkOrShare(){return a.default.createElement(d.SharingModalFooterLink,{className:this.spectrumClassNames(),icon:b(this.props.linkAccessLevel),body:this.getSpectrumLinkNoAvailableCloudDocText(this.props.linkAccessLevel)})}getSpectrumCantLinkCDMCloudDocText(e){switch(e){case"editor":return a.default.createElement("span",null,a.default.createElement("b",null,n.intl.formatMessage({id:"fE8Xhp",defaultMessage:"Can edit"})),a.default.createElement("br",null),n.intl.formatMessage({id:"3VVFir",defaultMessage:"Link not available. To share, invite specific people."}));case"viewer":return a.default.createElement("span",null,a.default.createElement("b",null,n.intl.formatMessage({id:"ReyNxC",defaultMessage:"Can view"})),a.default.createElement("br",null),n.intl.formatMessage({id:"3VVFir",defaultMessage:"Link not available. To share, invite specific people."}));default:return n.intl.formatMessage({id:"3VVFir",defaultMessage:"Link not available. To share, invite specific people."})}}renderSpectrumCantLinkCDM(){const e=a.default.createElement("a",{href:"/help/business/team-folders",target:"_blank",rel:"noopener noreferrer"},n.intl.formatMessage({id:"sGKSF8",defaultMessage:"Learn more"}));return a.default.createElement(d.SharingModalFooterLink,{className:this.spectrumClassNames(),icon:b(this.props.linkAccessLevel),body:this.getSpectrumCantLinkCDMCloudDocText(this.props.linkAccessLevel),actions:e})}renderSpectrumCantLinkTeamFolder(){const e=a.default.createElement("a",{href:"/help/business/team-folders",target:"_blank",rel:"noopener noreferrer"},n.intl.formatMessage({id:"sGKSF8",defaultMessage:"Learn more"}));return a.default.createElement(d.SharingModalFooterLink,{className:this.spectrumClassNames(),icon:b(this.props.linkAccessLevel),body:this.getSpectrumLinkNoAvailableCloudDocText(this.props.linkAccessLevel),actions:e})}renderLinkDescription(){let e;if(this.props.linkMetadata){const t=this.props.actionHandler&&this.props.actionHandler.getSharingInfo();e=g.formatLinkDescriptionPlainText(this.props.linkMetadata,t.isUserOnOwnerTeam(),!0)}return e}renderSpectrumLink(){const e=a.default.createElement("span",{className:"copy-link-button"},n.intl.formatMessage({id:"DhomU6",defaultMessage:"Copy link"}));return a.default.createElement(d.SharingModalFooterLink,{className:this.spectrumClassNames(),icon:b(this.props.linkAccessLevel),body:this.getSpectrumLinkText(this.props.linkAccessLevel),actions:a.default.createElement(h.Button,{className:"button-as-link copy-link-container",key:"copy",variant:"borderless",onClick:this.handleCopyLinkClicked},e)})}renderSpectrumCopyLink(){const e=null!=this.props.linkMetadata?this.props.linkMetadata.url:"";return a.default.createElement(d.SharingModalFooterLinkCopy,{className:this.spectrumClassNames(),icon:b(this.props.linkAccessLevel),sharedLinkUrl:e,labelSharedLinkUrl:n.intl.formatMessage({id:"9s4M13",defaultMessage:"Shared link URL"}),textButton:n.intl.formatMessage({id:"CgREwE",defaultMessage:"Hide link"}),textInputRef:this.setTextInputRef,onClickButton:this.handleCopyLinkClicked})}renderSpectrumNoLink(){return a.default.createElement(d.SharingModalFooterLinkCreate,{className:this.spectrumClassNames(),icon:b(this.props.linkAccessLevel),statusNoLinkCreated:this.getSpectrumNoLinkText(this.props.linkAccessLevel),textButtonCreateLink:n.intl.formatMessage({id:"/nFZR2",defaultMessage:"Create link"}),onClickButtonCreateLink:this.onClickButtonCreateLink})}renderSpectrumLoading(){return a.default.createElement(d.SharingModalFooterLink,{className:this.spectrumClassNames(),icon:b(this.props.linkAccessLevel),body:this.getSpectrumLoadingText(this.props.linkAccessLevel)})}renderUpsellPremiumSharing(){const e=this.props.actionHandler&&this.props.actionHandler.getSharingInfo(),t=e=>{this.props.actionHandler&&this.props.actionHandler.setSeenUpsellCounterPref(e)};return e.isShareModalUpsellPremiumSharing()&&e.shareModalUpsellPremiumSharingVariant()&&!e.isCloudDoc()?a.default.createElement(_.SharingModalUpsellPremiumSharing,{user:this.props.user,contentInfo:this.props.contentInfo,variant:e.shareModalUpsellPremiumSharingVariant(),hasIncrementedCounter:e.hasIncrementedUpsellCounter(),hasSeenCounter:e.hasSeenUpsellCounter(),onSetSeenCounter:t}):void 0}}t.RighteousModalLinkInfo=I,I.displayName="RighteousModalLinkInfo"})),define("modules/clean/sharing/views/share_modal_contacts_section",["require","exports","tslib","react","spectrum-sharing/components/sharing_modal_contacts_field/index","modules/clean/sharing/access_level","modules/clean/sharing/views/share_contacts_tokenizer","spectrum-sharing/utils/sharing_constants","modules/clean/sharing/strings","modules/core/i18n"],(function(e,t,s,n,i,a,r,o,l,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ShareModalContactsSection=void 0,n=s.__importDefault(n);class c extends n.default.Component{constructor(e){super(e),this.finishLogging=e=>this.shareContactsTokenizerRef.finishLogging(e),this.setShareContactsTokenizerRef=e=>{this.shareContactsTokenizerRef=e},this.onTypeaheadTokensChange=e=>{this.setState({typeaheadTokens:e})},this.handleAccessTypeChange=e=>{this.props.actionHandler.changeRecipientAccess(e)},this.filterContacts=e=>this.props.isTeamSharedFolder?!!e.group_id:this.props.isInContentManager||e.email!==this.props.user.email,this.state={typeaheadTokens:[]}}getContacts(){return this.shareContactsTokenizerRef.getContacts()}focusTypeaheadInput(){return this.shareContactsTokenizerRef.focusTypeaheadInput()}addExternalContacts(e){return this.shareContactsTokenizerRef.addExternalContacts(e)}render(){const e=this.props.isTeamSharedFolder?d.intl.formatMessage({id:"aTEm56",defaultMessage:"Add groups:"}):d.intl.formatMessage({id:"bLfZ53",defaultMessage:"To:"}),t=d.intl.formatMessage({id:"CIbq3r",defaultMessage:"This file type can only be shared with view access"});return n.default.createElement(i.SharingModalContactsField,{contactsField:this.renderContactsField(),labelledAccessTypes:this.getAccessTypes(),onAccessTypeChange:this.handleAccessTypeChange,selectedAccessType:this.getSelectedAccessType(),toLabel:e,showNoEditTooltip:this.props.contentInfo.isFile()&&!this.props.canInviteEditor,noEditText:t})}getAccessTypes(){const e=[],t=e=>d.intl.formatMessage({id:"+f5spv",defaultMessage:"change permission for users to {label}"},{label:e}),s=l.ACCESS_NAME,n=this.props.contentInfo&&this.props.contentInfo.isFolder()?l.MEMBER_ACTION_FOLDER:this.props.actionHandler.getSharingInfo().isCloudDoc()?l.MEMBER_ACTION_CLOUD_DOC:l.MEMBER_ACTION_FILE;return this.props.canInviteEditor&&e.push({apiId:a.ACCESS_LEVEL.WRITER,ariaLabel:t(a.ACCESS_LEVEL.WRITER),label:s[a.ACCESS_LEVEL.WRITER],details:n[o.MEMBER_ACTION.MAKE_EDITOR]}),this.props.canInviteViewer&&e.push({apiId:a.ACCESS_LEVEL.READER,ariaLabel:t(a.ACCESS_LEVEL.READER),label:s[a.ACCESS_LEVEL.READER],details:n[o.MEMBER_ACTION.MAKE_VIEWER]}),e}getSelectedAccessType(){const e=this.props.actionHandler.getSharingInfo(),t=this.getAccessTypes();let s;for(const n of t)n.apiId===e.recipientAccess()&&(s=n);return s}renderContactsField(){return n.default.createElement(r.ShareContactsTokenizer,{ref:this.setShareContactsTokenizerRef,actionHandler:this.props.actionHandler,typeaheadTokens:this.state.typeaheadTokens,onTypeaheadTokensChange:this.onTypeaheadTokensChange,context:this.props.context,focusOnMount:this.props.focusOnMount,initialTypeaheadTokens:this.props.initialTypeaheadTokens,typeaheadPlaceholder:this.props.typeaheadPlaceholder,user:this.props.user,filterContacts:this.filterContacts,shouldLogContactSearch:this.props.shouldLogContactSearch,showContactImport:this.props.showContactImport,teamGroupInfo:this.props.teamGroupInfo})}}t.ShareModalContactsSection=c,c.displayName="ShareModalContactsSection"})),define("modules/clean/sharing/views/share_contacts_tokenizer",["require","exports","tslib","react","modules/core/browser","modules/clean/contacts/config","modules/clean/analytics","modules/clean/static_urls","modules/clean/react/flag","modules/clean/react/image","spectrum-sharing/components/sharing_contact_token/index","spectrum-sharing/utils/index","spectrum-sharing/components/member_row/index","spectrum/typeahead/index","modules/clean/contacts/data_v2","modules/clean/contacts/contact","modules/clean/contacts/util","modules/clean/profile_services/profile_services_constants","modules/clean/profile_services/profile_services_link","modules/clean/profile_services/popup_handler","modules/clean/teams/admin/widgets/groups/util","modules/core/assert","modules/core/notify","modules/core/i18n","react-dom","modules/core/user_i18n"],(function(e,t,s,n,i,a,r,o,l,d,c,h,p,u,m,g,_,f,S,E,M,C,b,I,v,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ShareContactsTokenizer=t.ThirdPartyImport=t.ExpandImport=void 0,n=s.__importStar(n),i=s.__importStar(i),a=s.__importStar(a),_=s.__importDefault(_),f=s.__importDefault(f),v=s.__importStar(v),y=s.__importStar(y);const T=h.ContactsTokenizer(g.Contact);class k{constructor(){}getKey(){return"expand-importer"}}t.ExpandImport=k;class w{constructor({provider:e,connected:t}){this.provider=e,this.connected=t}getKey(){return`third-party-import${this.provider}`}}t.ThirdPartyImport=w;class A extends n.Component{constructor(e){super(e),this.updateRecipientData=()=>{this.props.actionHandler.recipientsChange(this.props.typeaheadTokens,this.typeaheadInput.value)},this.filterContacts=e=>this.props.filterContacts?this.props.filterContacts(e):e.email!==this.props.user.email,this.handleTypeaheadOnChange=e=>{const t=T.tokenizeDelimitedInputs(e);if(t.length>0)return this.validateAndAddTokens(t),void this.typeahead.setState({inputValue:""});this.showSuggestions(e),this.updateRecipientData()},this.handleExpandImport=()=>{this.tokenizeRawInput();const e=[];Array.from(f.default.importable_contact_services()).map(t=>{if(this.profile_services){const s=new w({provider:t,connected:this.profile_services.service_is_connected(t)});e.push(s)}}),this.setState({typeaheadSuggestions:e})},this.handleThirdPartyImport=e=>{let t;if(C.assert((t=e.provider,Array.from(f.default.importable_contact_services()).includes(t)),`invalid party contact provider ${e.provider}`),!this.profile_services||!this.profile_services.service_is_connected(e.provider))return this.link_handler.auth_service_with_user(e.provider,this.props.user.id,e=>S.ProfileServicesLinkingHandler.show_import_notifications(e));{const t=I.intl.formatMessage({id:"D/rjjz",defaultMessage:"You’re already connected to {service_name}"},{service_name:f.default.to_name(e.provider)});b.Notify.success(t)}},this.handleTypeaheadSelect=(e,t,s)=>{if(e||s)if(e instanceof k)this.handleExpandImport();else if(e instanceof w)this.handleThirdPartyImport(e);else{e&&this._logTokenSelect(e,t,s);const n=e?[e]:T.tokenizeAllRawInputs(s);this.validateAndAddTokens(n),this.setState({typeaheadSuggestions:[]})}},this.handleTypeaheadRemoveToken=e=>{const t=this.props.typeaheadTokens.filter(t=>t!==e);this._logTokenChangeEvent(e,!0),this.props.onTypeaheadTokensChange(t)},this.renderTypeaheadTokenContent=e=>{const t=e.name||e.email;this._logTokenChangeEvent(e,!1,{did_select_suggestion:!1});const s=this._getValidation(e);return n.createElement(c.SharingContactToken,{avatarUrl:e.photo_url,displayName:t,validation:s})},this.setTypeaheadRef=e=>{this.typeahead=e},this.setTypeaheadInputRef=e=>{this.typeaheadInput=e},this.finishLogging=e=>{const t=this.contactsDataSource.getStats().numLocalContacts;if(this._flush_unfinished_queries_cache(),this.shouldLogSearch())return this.contact_search_logger.log_records(this.props.user.id,e,t)},this._logTokenSelect=(e,t,s)=>{const n={search_expr:s,selected_pos:t||0,num_query_results:this.state.typeaheadSuggestions.length,did_select_suggestion:!0};this._logTokenChangeEvent(e,!1,n)},this._logTokenChangeEvent=(e,t=!1,s={})=>{if(this.contact_search_logger&&e){if(!t){const t={context:this._getLoggingContext(),contact_type:e.type,contact_id:e.getContactID(),contact_name:e.name,sort_variant:null,event_ts:N(i.performance(),"now",e=>e.now())};for(const e in s)s[e]&&(t[e]=s[e]);return this.contact_search_logger.add_record(t)}{const t=e.getContactID();if(t)return this.contact_search_logger.flag_record_as_removed(t)}}},this._logSearchComplete=(e,t,s=!0)=>{if(!this.shouldLogSearch()||!e)return;const n=i.performance().now();let a=this.unfinished_contact_search_queries[e];if(!a)return;const r=a.begin_time;!("ttfr"in a)&&t>0&&(a.ttfr=Math.floor(n-r)),s?(a.local_duration=Math.floor(n-r),a.num_local_results=t):(a.remote_duration=Math.floor(n-r),a.num_additional_remote_results=t),a.num_results+=t;return(()=>this.contactsDataSource.isSearchLocalOnly()&&s||!s)()?(a=this._prepareSearchStatsForLogging(a,e,n,!0),this.contact_search_logger.add_timing_record(a),this.contact_search_logger.count_search(a.is_slow),delete this.unfinished_contact_search_queries[e]):void 0},this._logSearchBegin=e=>{if(!this.shouldLogSearch()||!e)return;const t=i.performance().now();return this._flush_unfinished_queries_cache(t),this.unfinished_contact_search_queries[e]={begin_time:t,num_results:0}},this._flush_unfinished_queries_cache=e=>{if(this.shouldLogSearch()){null==e&&(e=i.performance().now());for(const t in this.unfinished_contact_search_queries)if(this.unfinished_contact_search_queries[t]){let s=this.unfinished_contact_search_queries[t];e&&e-s.begin_time<a.CONTACTS_SEARCH_PREEMPTED_THRESHOLD&&(s.is_preempted=!0),s=this._prepareSearchStatsForLogging(s,t,e,!1),this.contact_search_logger.add_timing_record(s),this.contact_search_logger.count_search(s.is_slow)}return this.unfinished_contact_search_queries={}}},this._prepareSearchStatsForLogging=(e,t,s,n)=>{const i=e.begin_time;e.duration=Math.floor(s-i),"ttfr"in e?e.is_slow=e.ttfr>100:n&&0===e.num_results?e.is_slow=!1:e.is_slow=e.duration>100;const a=this.contactsDataSource.getStats().localContactsDownloadedTime;return e.started_before_download=null==a||i<a,"is_preempted"in e||(e.is_preempted=!1),e.context=this._getLoggingContext(),e.query_length=t.length,e.is_finished=n,e},this._getLoggingContext=()=>{let e="spectrum_tokenizer";return null!=this.props.context&&(e+=`_${this.props.context}`),e},this.state={typeaheadSuggestions:[]},this.link_handler=new S.ProfileServicesLinkingHandler,this.profile_services=null,this.props.teamGroupInfo||this.props.showContactImport&&this.props.user&&(this.profile_services=S.LinkedProfileServices.get_linked_profile_services_for_user(this.props.user.id))}getContacts(){return this.tokenizeRawInput(),this.props.typeaheadTokens}focusTypeaheadInput(){v.findDOMNode(this.typeaheadInput).focus()}addExternalContacts(e){this.validateAndAddTokens(e)}componentDidMount(){this.contactsDataSource=this.initContactsDataSource(this.props.user,this.filterContacts),this.props.shouldLogContactSearch&&(this.contact_search_logger=new r.ContactSearchLogger(this._getLoggingContext(),this.contactsDataSource.searchModeName),this.unfinished_contact_search_queries={}),this.props.initialTypeaheadTokens&&this.props.initialTypeaheadTokens.length>0&&this.validateAndAddTokens(this.props.initialTypeaheadTokens),this.props.focusOnMount&&this.focusTypeaheadInput(),this.props.actionHandler.suggestTargets({query:"fake",force_refresh:!0})}componentDidUpdate(e,t){if(this.contactsDataSource=this.initContactsDataSource(this.props.user,this.filterContacts),this.state.typeaheadSuggestions.length>0){const e=this.state.typeaheadSuggestions[0]instanceof k;t.typeaheadSuggestions===this.state.typeaheadSuggestions||e?e&&this.typeahead.setState({suggestionsListSelectedIndex:-1}):this.typeahead.setState({suggestionsListSelectedIndex:0})}e.typeaheadTokens!==this.props.typeaheadTokens&&this.updateRecipientData()}tokenizeRawInput(){const e=this.typeaheadInput.value;if(""!==e){const t=T.tokenizeAllRawInputs(e);this.validateAndAddTokens(t),this.typeahead.setState({inputValue:""})}}getSuggestionRenderer(){return this.props.renderTypeaheadSuggestion}getSuggestions(){return this.state.typeaheadSuggestions}render(){return n.createElement(u.Typeahead,{ref:this.setTypeaheadRef,className:this.props.className,height:160,inputProps:{ref:this.setTypeaheadInputRef,disabled:this.props.disabledInput,placeholder:this.props.typeaheadPlaceholder,"aria-label":I.intl.formatMessage({id:"rQOIK5",defaultMessage:"Contact name"})},listItemHeight:48,onChange:this.handleTypeaheadOnChange,onRemoveToken:this.handleTypeaheadRemoveToken,onSelect:this.handleTypeaheadSelect,renderSuggestion:this.getSuggestionRenderer(),renderTokenContent:this.renderTypeaheadTokenContent,suggestions:this.getSuggestions(),suggestionsBuffer:0,tokens:this.createTypeaheadTokenObjects()})}initContactsDataSource(e,t){return new m.ContactsDataSourceV2(e,t,!1)}_getValidation(e){const t=this.props.actionHandler.getSharingInfo().recipientAccess(),s=this.props.actionHandler.getSharingInfo().recipientValidation()[t]||{},n=e.getKey();return s[n]?s[n]:{state:"pending",msg:null}}getVariantForTypeaheadToken(e){const t=this._getValidation(e);return"invalid"===t.state?"error":"warn"===t.state?"warning":"default"}createTypeaheadTokenObjects(){return this.props.typeaheadTokens.map(e=>({key:e.getKey(),variant:this.getVariantForTypeaheadToken(e),content:e}))}filterExistingTokens(e){if(!e)return[];const t=this.props.typeaheadTokens.map(e=>e.getKey());return e.filter(e=>!t.includes(e.getKey()))}suggestSharingTargets(e){this.props.actionHandler.suggestTargets({query:e}).then(e=>{e?this.setSuggestions(this.filterExistingTokens(e.filter(e=>this.filterContacts(e)))):this.typeahead.setState({suggestionsListSelectedIndex:-1})})}is_server_side_contact_search_on(){return"ON"===this.props.actionHandler.getSharingInfo().sharingPrefs().in_server_side_contact_search_settings}showSuggestions(e){if(this.is_server_side_contact_search_on())return this.suggestSharingTargets(e);this._logSearchBegin(e);const t=[];this.contactsDataSource.search(e,s=>{t.push(...this.filterExistingTokens(s)),this.setSuggestions(t),this._logSearchComplete(e,(null!=s?s.length:void 0)||0,!0)},s=>{const n=this.filterExistingTokens(s);e===this.typeaheadInput.value&&n.length>0&&(t[t.length-1]instanceof k?t.push(...n.concat(t.pop())):t.push(...n),this.setState({typeaheadSuggestions:t})),this._logSearchComplete(e,s.length,!1)})}setSuggestions(e){const t=e;this.props.teamGroupInfo?t.push(_.default.teamGroupInfoToContact(this.props.teamGroupInfo)):this.props.showContactImport&&t.push(new k),this.setState({typeaheadSuggestions:t})}validateAndAddTokens(e){const t=e.reduce((e,t)=>(t.pending&&t.query&&e.push(t.query),e),[]),s=t=>{const{onTypeaheadTokensChange:s,typeaheadTokens:n}=this.props,i=[],a=n.map(e=>e.getKey());for(const s of e){let e=s;if(e.pending&&e.query){const s=this.contactsDataSource.normalizeQuery(e.query),n=this.determineQueryMatch(s,t[s]);n&&(e=n)}const n=e.getKey();a.includes(n)||(a.push(n),i.push(e))}s(n.concat(i))};if(!this.is_server_side_contact_search_on())return this.contactsDataSource.searchBatch(t,s,s);{const t=this.props.typeaheadTokens.map(e=>e.getKey()),s=[];for(const n of e){const e=n.getKey();t.includes(e)||(t.push(e),s.push(n))}this.props.onTypeaheadTokensChange(this.props.typeaheadTokens.concat(s))}}determineQueryMatch(e,t){if(!t||!e)return null;const s={email:[],name:[]};for(const n of t){const t=n.email?this.contactsDataSource.normalizeQuery(n.email):null,i=n.name?this.contactsDataSource.normalizeQuery(n.name):null;e===t?s.email.push(n):e===i&&s.name.push(n)}for(const e of["email","name"])if(1===s[e].length)return s[e][0];return null}shouldLogSearch(){return!this.is_server_side_contact_search_on()&&this.props.shouldLogContactSearch&&null!=this.contact_search_logger&&null!=(e=i.performance(),t=e=>e.now,null!=e?t(e):void 0);var e,t}}function N(e,t,s){return null!=e&&"function"==typeof e[t]?s(e,t):void 0}t.ShareContactsTokenizer=A,A.displayName="ShareContactsTokenizer",A.defaultProps={disabledInput:!1,shouldLogContactSearch:!1,renderTypeaheadSuggestion:e=>{return e instanceof k?n.createElement("div",{className:"typeahead-option"},n.createElement(l.Flag,{leftAttachment:n.createElement(d.Image,{className:"u-pad-right-s",src:o.static_url("/static/images/icons/icon-import-vflOL9sCs.png"),srcHiRes:o.static_url("/static/images/icons/icon-import@2x-vfluE8TBO.png")})},n.createElement("div",{className:"option-primary option-only"},I.intl.formatMessage({id:"H3lmrv",defaultMessage:"Import contacts"})))):e instanceof w?(t=e,n.createElement(L,{import:t})):(e=>{const t=e.name||e.email,s=e.group_id?M.getInitials(e.name):y.getInitials(t),i=e.group_id?I.intl.formatMessage({id:"XMHn5C",defaultMessage:"{count, plural, one{# member} other{# members}}"},{count:e.group_size||0}):e.email;return n.createElement(p.MemberRow,{id:e.getKey(),initials:s,avatarUrl:e.photo_url,description:i,displayName:t,tag:"div",variant:"narrow"})})(e);var t}};class L extends n.PureComponent{constructor(e){super(e),this.show_contact_import_spinner=e=>{if(this.props.import.provider===e.provider)return this.setState({showLoading:!0})},this.state={showLoading:!1}}componentDidMount(){return this.authCompleteListenerToken=E.addAuthCompleteListener(this.show_contact_import_spinner)}componentWillUnmount(){return E.removeAuthCompleteListener(this.authCompleteListenerToken)}render(){const{provider:e,connected:t}=this.props.import,s=f.default.to_img_legacy(e);let i=f.default.to_name(e);!t&&this.state.showLoading&&(i=I.intl.formatMessage({id:"MeFKtq",defaultMessage:"Importing {service_name} Contacts"},{service_name:i}));const a=t?I.intl.formatMessage({id:"2/+46g",defaultMessage:"Connected"}):"";return n.createElement("div",{className:"typeahead-option"},n.createElement(l.Flag,{leftAttachment:n.createElement(d.Image,{className:"u-pad-right-s",src:o.static_url(s[0]),srcHiRes:o.static_url(s[1])})},n.createElement("div",{className:"option-primary"},i),n.createElement("div",{className:"option-secondary u-font-meta"},a)))}}L.displayName="ThirdPartyImportOption"})),define("modules/clean/sharing/views/share_modal_footer_section",["require","exports","tslib","react","lodash","modules/clean/sharing/ui_util","modules/clean/sharing/views/constants","spectrum-sharing/components/sharing_modal_footer_inband/index","modules/core/i18n"],(function(e,t,s,n,i,a,r,o,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ShareModalFooterSection=void 0,n=s.__importDefault(n),i=s.__importStar(i);class d extends n.default.PureComponent{isInbandFooterDisabled(){return this.props.isTokenizerEmpty||this.props.contactsError&&this.props.contactsError.level===a.ContactsErrorLevel.Error||!!this.props.contentNameMessage}render(){const{mode:e,children:t,shareButtonLabelOverride:s}=this.props;switch(e){case r.MODES.SHARE:return n.default.createElement(o.SharingModalFooterInband,{isButtonShareDisabled:this.isInbandFooterDisabled(),textButtonShare:s||(this.props.isTeamSharedFolder?l.intl.formatMessage({id:"YcxVqg",defaultMessage:"Add"}):l.intl.formatMessage({id:"CcpVyl",defaultMessage:"Share"})),onClickButtonShare:this.props.onShareButtonClick},t);case r.MODES.SHARE_SENDING:return n.default.createElement(o.SharingModalFooterInband,{isButtonShareDisabled:!0,textButtonShare:s||(this.props.isTeamSharedFolder?l.intl.formatMessage({id:"JowGoo",defaultMessage:"Adding..."}):l.intl.formatMessage({id:"WyW2Um",defaultMessage:"Sharing..."})),onClickButtonShare:i.noop},t);case r.MODES.MEMBERSHIP:return this.props.isInContentManager&&!this.props.contentInfo.pathExists()?n.default.createElement(o.SharingModalFooterInband,{isButtonShareDisabled:!1,textButtonShare:s||(this.props.isTeamSharedFolder?l.intl.formatMessage({id:"YcxVqg",defaultMessage:"Add"}):l.intl.formatMessage({id:"CcpVyl",defaultMessage:"Share"})),onClickButtonShare:this.props.onShareButtonClick}):null;default:return null}}}t.ShareModalFooterSection=d,d.displayName="ShareModalFooterSection"})),define("modules/clean/sharing/views/share_modal_footer_link_section",["require","exports","tslib","react","modules/core/i18n","classnames","spectrum/button/index","modules/clean/sharing/views/righteous_modal_link_info","spectrum-sharing/components/sharing_modal_footer_link_list/index","modules/clean/sharing/views/constants"],(function(e,t,s,n,i,a,r,o,l,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ShareModalFooterLinkSection=void 0,n=s.__importDefault(n),a=s.__importDefault(a);class c extends n.default.Component{constructor(){super(...arguments),this.onClickButtonLinkSettings=()=>{this.props.mode===d.MODES.LINK_ONLY?this.props.actionHandler.handleLinkSettingsClick():this.props.onLinkSettingsClick()}}renderSharedLinks(){const e=this.props.actionHandler&&this.props.actionHandler.getSharingInfo();if(e.isCloudDoc()){let t,s;return e&&e.sharedLinks()&&(t=e.editRighteousLink(),s=e.viewRighteousLink(),s||(s=e.shmodelLink())),[this.renderModalLinkInfo(t,"editor"),this.renderModalLinkInfo(s,"viewer")]}{const t=e.shmodelLink();return this.renderModalLinkInfo(t,"viewer")}}renderModalLinkInfo(e,t){return n.default.createElement(o.RighteousModalLinkInfo,{key:t,actionHandler:this.props.actionHandler,contentInfo:this.props.contentInfo,linkMetadata:e,linkAccessLevel:t,mode:this.props.mode,user:this.props.user,isLinkMetadataLoaded:this.props.isLinkMetadataLoaded,isTeamSharedFolder:this.props.isTeamSharedFolder,canShareLink:this.props.canShareLink,permissions:this.props.permissions,modalClose:this.props.closeModalHandler})}renderActions(){const e=this.props.actionHandler&&this.props.actionHandler.getSharingInfo();if(e.sharedLinks()&&e.sharedLinks().length>0&&(!e.isCloudDoc()||e.permissionsObj().canCreateEditLink()||e.permissionsObj().canCreateViewLink()))return n.default.createElement(r.Button,{variant:"borderless",onClick:this.onClickButtonLinkSettings},i.intl.formatMessage({id:"zxECIJ",defaultMessage:"Link settings"}))}render(){const e=this.props.actionHandler&&this.props.actionHandler.getSharingInfo();return n.default.createElement("div",{className:a.default({"unified-share-modal-two-link-model":!0,"unified-share-modal-two-link-model--upsell-enabled":e.isShareModalUpsellPremiumSharing()})},(()=>this.props.isLinkMetadataLoaded?n.default.createElement(l.SharingModalFooterLinkList,{className:a.default({"scl-sharing-modal-footer-link-list--no-border":this.props.mode===d.MODES.LINK_ONLY}),title:i.intl.formatMessage({id:"Ao5Pwf",defaultMessage:"Share a link instead"}),actions:this.renderActions()},this.renderSharedLinks()):void 0)())}}t.ShareModalFooterLinkSection=c,c.displayName="ShareModalFooterLinkSection"})),define("modules/clean/sharing/views/share_modal_header_section",["require","exports","tslib","classnames","react","react-dom","spectrum-sharing/components/sharing_modal_header/index","modules/clean/react/bubble","modules/clean/sharing/views/constants","modules/clean/em_string","modules/core/i18n","modules/clean/react/icon/folder_icon","modules/clean/sharing/share_modal_icon","spectrum-sharing/utils/sharing_constants"],(function(e,t,s,n,i,a,r,o,l,d,c,h,p,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ShareModalHeaderSection=void 0,n=s.__importDefault(n),i=s.__importDefault(i),a=s.__importStar(a),o=s.__importDefault(o);class m extends i.default.Component{constructor(e){super(e),this.handleContentNameFocus=()=>{this.setState({isFocusOnContentName:!0})},this.handleContentNameBlur=()=>{this.setState({isFocusOnContentName:!1})},this.setHeaderInputRef=e=>{this.headerInput=e},this.state={isFocusOnContentName:this.props.isContentNameFocused}}selectContentNameInput(){this.headerInput&&a.findDOMNode(this.headerInput.input).select()}render(){return this.props.isCreatingNewFolder&&!this.props.initialContentName?i.default.createElement(r.SharingModalHeaderInput,{inputAutoFocus:!0,ref:this.setHeaderInputRef,icon:i.default.createElement(h.SharedFolderIcon,null),inputAriaLabel:this.props.contentNameMessage,inputPlaceholder:this.state.isFocusOnContentName?void 0:c.intl.formatMessage({id:"ss4CO0",defaultMessage:"Folder name"}),onClickCloseButton:this.props.onModalCloseClick,onInputChange:this.props.onContentNameInputChange,onInputFocus:this.handleContentNameFocus,onInputBlur:this.handleContentNameBlur,onInputKeyUp:this.props.onContentNameInputKeyUp},this.shouldShowContentNameBubble()&&this.renderContentNameBubble()):i.default.createElement(r.SharingModalHeaderTitle,{closeButtonVisible:!0,icon:this.getIcon(),subTitle:!this.props.isLoading&&(this.props.subTitle||this.getMemberCountsString()),onClickCloseButton:this.props.onModalCloseClick,onClickSettingsButton:this.props.onSettingsButtonClick,settingsButtonVisible:this.props.isMetadataLoaded&&this.isContentSettingsEnabled(),title:this.getHeaderTitle()})}getHeaderTitle(){return this.props.initialContentName?this.props.initialContentName:d.Emstring.em_snippet(this.props.sharingInfo.name(),u.SNIPPET_SIZES.FILENAME)}isContentNameInputError(){return this.props.contentNameMessageLevel===l.CONTENT_NAME_MESSAGE_LEVELS.ERROR}shouldShowContentNameBubble(){return this.props.contentNameMessage&&(this.state.isFocusOnContentName||this.isContentNameInputError())}renderContentNameBubble(){return i.default.createElement(o.default,{arrow:o.default.ARROW.TOP,className:n.default("unified-share-modal__content-name__tooltip","u-pad-xs","u-font-strong",{"unified-share-modal__content-name__tooltip-error":this.isContentNameInputError()})},this.props.contentNameMessage)}getIcon(){const e=this.props.contentInfo;if(e.isFolder()){if(!e.extras.exists)return i.default.createElement(h.SharedFolderIcon,null);if(!this.props.isMetadataLoaded)return e.isTeamSharedFolder()||e.isFolderInsideTeamFolderTree()?i.default.createElement(h.TeamFolderIcon,null):e.isSharedFolder()?i.default.createElement(h.SharedFolderIcon,null):i.default.createElement(h.SimpleFolderIcon,null)}return i.default.createElement(p.ShareModalIcon,{alt:"",className:"unified-share-modal__title-icon",filename:this.props.sharingInfo.name(),isSharedFolder:e.isSharedFolder(),isFolder:e.isFolder(),isTeamSharedFolder:this.props.isTeamSharedFolder,isFolderInsideTeamFolderTree:!0===this.props.isFolderInsideTeamFolderTree,isViewOnly:!this.props.canEdit,isConfidentialFolder:this.props.isInContentManager&&this.props.isConfidentialFolder,pathExists:e.pathExists()})}getOutsideTeamString(){const e=this.props.sharingInfo,t=e.memberCounts();if(e.hasOutsideTeamMembers())return c.intl.formatMessage({id:"LrSVy3",defaultMessage:"{count, plural, one{{count} outside your Dropbox team} other{{count} outside your Dropbox team}}"},{count:t.users_outside_team})}getMemberCountsString(){const e=this.props.sharingInfo.memberNum();if(!e||this.props.isSendingForSignature)return;const t=this.props.sharingInfo.memberCounts(),s=this.getOutsideTeamString(),n=t&&t.exceeds_count;return s?n?c.intl.formatMessage({id:"Ys93fl",defaultMessage:"{count, plural, one{{count}+ member ({outside_team_string})} other{{count}+ members ({outside_team_string})}}"},{count:e,outside_team_string:s}):c.intl.formatMessage({id:"JPk+XA",defaultMessage:"{count, plural, one{{count} member ({outside_team_string})} other{{count} members ({outside_team_string})}}"},{count:e,outside_team_string:s}):n?c.intl.formatMessage({id:"eaJeP5",defaultMessage:"{count, plural, one{{count}+ member} other{{count}+ members}}"},{count:e}):c.intl.formatMessage({id:"ECZFz/",defaultMessage:"{count, plural, one{{count} member} other{{count} members}}"},{count:e})}isContentSettingsEnabled(){return this.props.contentInfo.isFolder()&&this.props.contentInfo.pathExists()||this.props.contentInfo.isFile()&&this.props.showPassFileSettings}}t.ShareModalHeaderSection=m,m.defaultProps={isLoading:!1},m.displayName="ShareModalHeaderSection"})),define("modules/clean/sharing/views/share_modal_pointer_mode",["require","exports","tslib","react","modules/core/i18n","modules/clean/clipboard_v2","modules/clean/sharing/ui_util","modules/clean/sharing/ui_notifications_util","spectrum-sharing/utils/logging","spectrum/icon_content/index","spectrum-sharing/components/sharing_modal_header/index","spectrum-sharing/components/sharing_modal_footer_link/index"],(function(e,t,s,n,i,a,r,o,l,d,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ShareModalPointerMode=void 0,n=s.__importDefault(n);class p extends n.default.Component{constructor(){super(...arguments),this.handleCopyLinkClicked=()=>{this.urlInput.focus(),this.urlInput.select(),this.clipboard.do_copy(),this.logCopyEvent()},this.setTextInputRef=e=>(this.urlInput=e,e)}componentDidMount(){this.setupCopy()}componentDidUpdate(){this.setupCopy()}render(){const{className:e,sharingInfo:t,onClickCloseButton:s}=this.props;return n.default.createElement("div",{className:e},n.default.createElement(c.SharingModalHeaderTitle,{closeButtonVisible:!0,icon:n.default.createElement(d.IconContent,{name:"dlink-small"}),onClickCloseButton:s,title:t.name()}),n.default.createElement(h.SharingModalFooterLinkCopy,{labelSharedLinkUrl:i.intl.formatMessage({id:"vLmOAd",defaultMessage:"Shared link URL"}),isIconHidden:!0,inputProps:{autoFocus:!1},onClickButton:this.handleCopyLinkClicked,sharedLinkUrl:this.getLinkUrl(),textButton:i.intl.formatMessage({id:"L4Tupd",defaultMessage:"Copy link"}),textInputRef:this.setTextInputRef}))}getLinkUrl(){return this.props.sharingInfo.isLinkMetadataLoaded()?this.props.sharingInfo.sharedLinks()[0].url:""}setupCopy(){this.props.sharingInfo.isLinkMetadataLoaded()&&(this.clipboard=new a.ClipboardV2(()=>o.sharingNotificationSuccess(i.intl.formatMessage({id:"z1RKgB",defaultMessage:"Link copied to clipboard"})),()=>o.sharingNotificationError(i.intl.formatMessage({id:"zMYKz7",defaultMessage:"Unable to copy the link, please copy manually"}))))}logCopyEvent(){const e=this.props.sharingInfo.user(),t=this.props.sharingInfo.contentInfo();r.logTiburonEvent(t,e.id,l.TiburonEventName.CopySharedLink,{type:"pointer"})}}t.ShareModalPointerMode=p,p.displayName="ShareModalPointerMode"})),define("modules/clean/sharing/views/sharing_settings_file_folder_policy_view",["require","exports","tslib","react","modules/core/i18n","modules/clean/sharing/sharing_settings_util","modules/clean/sharing/views/sharing_settings_policy_view","modules/clean/em_string","spectrum-sharing/share_modal/sharing_settings/utils/sharing_settings_constants"],(function(e,t,s,n,i,a,r,o,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SharingSettingsFileFolderPolicyView=void 0,n=s.__importDefault(n);class d extends r.SharingSettingsPolicyView{render(){return this.renderPolicies()}renderPolicies(){const e=this.props.policies.map(e=>{const t=this.getPolicyDict(e);return this.renderPolicy(e,t)});return n.default.createElement("div",null,e)}renderPolicy(e,t){let s,n,i;[s,n]=a.getEffectivePolicyValue(e,this.props.policyUpdate,this.props.currentPolicy,this.props.showContentManagerBridge,this.props.teamPolicy,this.props.permissions);const r=Object.keys(t.optionsDict);if(s&&!r.includes(s))throw new Error(`Invalid Policy: ${s}`);if(t.type===l.DROPDOWN){const a=t=>{this.props.onPolicyUpdate(e,t)};i=this.renderDropdown(e,s,t.optionsDict,r,a,!n)}else if(t.type===l.TOGGLE){const a=(s,n)=>{for(const n of r){t.optionsDict[n].value===s&&this.props.onPolicyUpdate(e,n)}};i=this.renderToggle(e,s,t.optionsDict,a,!n)}return this.renderPolicyRow(e,t,n,i)}isTeamMemberFolder(){return!this.isTeamFolderTree()&&this.props.ownerTeam}isTeamFolderTree(){return this.props.isTeamSharedFolder||this.props.isFolderInsideTeamFolderTree}getMemberPolicyQuestion(){return this.isTeamFolderTree()?i.intl.formatMessage({id:"+JxbQ8",defaultMessage:"Limit who can be added as a member of folders."}):i.intl.formatMessage({id:"lUdY7W",defaultMessage:"Limit who can be added as a member of this folder."})}getAclUpdatePolicyQuestion(){return this.isTeamFolderTree()?i.intl.formatMessage({id:"8eiYiI",defaultMessage:"Choose who can add people to folders."}):i.intl.formatMessage({id:"d2BniZ",defaultMessage:"Choose who can add people to this folder."})}getViewerInfoPolicyDescription(){return this.props.ownerTeam?this.props.isFolder?i.intl.formatMessage({id:"9Ihzjr",defaultMessage:"Show who viewed files in this folder to team members and people who can edit."}):i.intl.formatMessage({id:"pPFsa4",defaultMessage:"Show who viewed this file to team members and people who can edit."}):this.props.isFolder?i.intl.formatMessage({id:"FquCbz",defaultMessage:"Show who’s viewing files in this folder to people who can edit."}):i.intl.formatMessage({id:"VloA8O",defaultMessage:"Show who’s viewing this file to people who can edit."})}getPolicyDict(e){switch(e){case l.MEMBER_POLICY:return{title:i.intl.formatMessage({id:"Z0CQak",defaultMessage:"Folder membership"}),description:this.getMemberPolicyQuestion(),optionsDict:{anyone:{label:i.intl.formatMessage({id:"m1ZBqW",defaultMessage:"Anyone"})},team:{label:i.intl.formatMessage({id:"flkJcx",defaultMessage:"Only team members"})}},type:l.DROPDOWN};case l.ACL_UPDATE_POLICY:return{title:i.intl.formatMessage({id:"qG3VMJ",defaultMessage:"Manage access"}),description:this.getAclUpdatePolicyQuestion(),optionsDict:{editors:{label:this.isTeamFolderTree()||this.isTeamMemberFolder()?i.intl.formatMessage({id:"KBoyON",defaultMessage:"Team members who can edit"}):i.intl.formatMessage({id:"CyxyyA",defaultMessage:"Folder members"}),description:this.isTeamFolderTree()||this.isTeamMemberFolder()?i.intl.formatMessage({id:"rY7b9W",defaultMessage:"Team members with edit access can add people."}):i.intl.formatMessage({id:"U8/o8J",defaultMessage:"Members with edit access can add people."})},owner:{label:this.isTeamFolderTree()?i.intl.formatMessage({id:"FRQa4i",defaultMessage:"Only Team Admins"}):i.intl.formatMessage({id:"svCMOP",defaultMessage:"Only the owner"}),description:this.isTeamFolderTree()?i.intl.formatMessage({id:"kmb+og",defaultMessage:"Only Team Admins."}):i.intl.formatMessage({id:"mNi7Xx",defaultMessage:"Only the owner can add people."})}},type:l.DROPDOWN};case l.VIEWER_INFO_POLICY:return{title:i.intl.formatMessage({id:"OFgJ+q",defaultMessage:"Viewer info"}),description:this.getViewerInfoPolicyDescription(),optionsDict:{enabled:{label:i.intl.formatMessage({id:"4ASaZl",defaultMessage:"On"}),value:!0},disabled:{label:i.intl.formatMessage({id:"495asM",defaultMessage:"Off"}),value:!1}},type:l.TOGGLE};case l.FOLDER_LINK_AUDIENCE_POLICY:if(!this.props.ownerTeam)throw new Error("Policy only valid for teams");return"team"===this.props.currentPolicy[l.FOLDER_LINK_AUDIENCE_POLICY]?this.renderFolderLinkPolicyDropdown():{title:i.intl.formatMessage({id:"dpUA0F",defaultMessage:"Link restrictions"}),description:i.intl.formatMessage({id:"ZnIqIh",defaultMessage:"Prevent non-members from accessing this folder via link."}),optionsDict:{members:{label:i.intl.formatMessage({id:"4ASaZl",defaultMessage:"On"}),value:!0},anyone:{label:i.intl.formatMessage({id:"495asM",defaultMessage:"Off"}),value:!1}},type:l.TOGGLE};default:throw new Error("Policy name not found")}}renderFolderLinkPolicyDropdown(){if(!this.props.ownerTeam)throw new Error("Policy only valid for teams");return{title:i.intl.formatMessage({id:"dpUA0F",defaultMessage:"Link restrictions"}),description:i.intl.formatMessage({id:"W3KUO0",defaultMessage:"Limits who can access this folder via a link."}),optionsDict:{anyone:{label:i.intl.formatMessage({id:"xkdOhD",defaultMessage:"No restrictions"}),description:i.intl.formatMessage({id:"cLesiI",defaultMessage:"Show all access options for links."})},members:{label:i.intl.formatMessage({id:"Tj12s5",defaultMessage:"Invite-only"}),description:i.intl.formatMessage({id:"02i0Sa",defaultMessage:"Show “Only invited members” only."})},team:{label:i.intl.formatMessage({id:"axkOyT",defaultMessage:"Team only"}),description:i.intl.formatMessage({id:"chneWK",defaultMessage:"Show “Only people at {team_name}”."},{team_name:o.Emstring.em_snippet(this.props.ownerTeam.name,12)})}},type:l.DROPDOWN}}}t.SharingSettingsFileFolderPolicyView=d})),define("modules/clean/sharing/views/sharing_settings_link_policy_view",["require","exports","tslib","react","modules/core/i18n","modules/clean/filepath/filepath","modules/clean/sharing/sharing_settings_util","spectrum-sharing/components/sharing_modal_banner/index","spectrum-sharing/share_modal/sharing_settings/sharing_settings_expire","spectrum-sharing/share_modal/sharing_settings/sharing_settings_audience","spectrum-sharing/share_modal/sharing_settings/sharing_settings_download"],(function(e,t,s,n,i,a,r,o,l,d,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SharingSettingsLinkPolicyView=void 0,n=s.__importDefault(n);const h=e=>{window.open(e,"_blank")};class p extends n.default.Component{constructor(){super(...arguments),this.getPolicyDict=e=>this.props.getPolicyDict(e,this.props.isFolder),this.renderCannotPreviewBanner=()=>{if(!r.shouldRenderNoPreviewFileWarning(!this.props.isFolder,this.props.linkMetadata))return;const e=a.file_extension(this.props.linkMetadata.name).toUpperCase();return n.default.createElement(o.SharingModalBanner,{className:"sharing-settings-modal__banner",type:"default",message:i.intl.formatMessage({id:"7E5yD4",defaultMessage:"{file_extension} files can’t be previewed. Downloads must be enabled to share."},{file_extension:`.${e}`})})},this.handleMultiplePolicyUpdate=e=>{const t=this.props.linkPolicy.merge(e);this.props.onPolicyUpdate(this.props.linkMetadata,t)},this.handlePolicyUpdate=(e,t)=>{const s=this.props.linkPolicy.set(e,t);this.props.onPolicyUpdate(this.props.linkMetadata,s)}}render(){const e=this.props.readOnlyPolicy;return n.default.createElement("div",null,n.default.createElement(d.SharingSettingsAudience,{intl:i.intl,linkPermissions:this.props.linkMetadata.link_permissions,linkPolicy:this.props.linkPolicy,getPolicyDict:this.getPolicyDict,onPolicyUpdate:this.handleMultiplePolicyUpdate,readOnlyPolicy:e}),n.default.createElement(l.SharingSettingsExpire,{intl:i.intl,linkMetadata:this.props.linkMetadata,linkPolicy:this.props.linkPolicy,getPolicyDict:this.getPolicyDict,onPolicyUpdate:this.handleMultiplePolicyUpdate,readOnlyPolicy:e}),n.default.createElement(c.SharingSettingsDownload,{intl:i.intl,linkPermissions:this.props.linkMetadata.link_permissions,linkPolicy:this.props.linkPolicy,getPolicyDict:this.getPolicyDict,onPolicyUpdate:this.handlePolicyUpdate,onLinkClicked:h,banner:this.renderCannotPreviewBanner(),readOnlyPolicy:e,isEditFolderLink:!1}))}}t.SharingSettingsLinkPolicyView=p,p.displayName="SharingSettingsLinkPolicyView"})),define("modules/clean/sharing/views/sharing_settings_link_policies",["require","exports","spectrum-sharing/share_modal/sharing_settings/utils/sharing_settings_link_policies","modules/core/i18n"],(function(e,t,s,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getRLPolicyDict=t.getShmodelInMultipleLinksPolicyDict=void 0;const i=s.SharingSettingsLinkPolicies(n.intl);t.getShmodelInMultipleLinksPolicyDict=i.getShmodelInMultipleLinksPolicyDict,t.getRLPolicyDict=i.getRLPolicyDict})),define("modules/clean/sharing/views/sharing_settings_link_section",["require","exports","tslib","react","spectrum/button/index","spectrum-sharing/components/card/index","modules/clean/sharing/views/sharing_settings_link_policy_view","modules/clean/sharing/views/sharing_settings_righteous_link_policy_view","modules/clean/sharing/sharing_settings_util","modules/clean/sharing/delete_link_modal","modules/clean/sharing/views/righteous_modal_link_info","modules/clean/sharing/views/sharing_settings_link_policies","modules/core/i18n","spectrum-sharing/components/scooter_loader/index","spectrum-sharing/share_modal/sharing_settings/utils/sharing_settings_util"],(function(e,t,s,n,i,a,r,o,l,d,c,h,p,u,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SharingSettingsLinkActions=t.SharingSettingsLinkSection=void 0,n=s.__importDefault(n);class g extends n.default.Component{constructor(e){super(e),this.onClickButtonCreateLink=e=>{"editor"===e?this.setState({creatingEditLink:!0},()=>this.handleCreateLinkClicked(e)):this.setState({creatingViewLink:!0},()=>this.handleCreateLinkClicked(e))},this.handleCreateLinkClicked=e=>{this.props.actionHandler&&this.props.actionHandler.createSharedLink(e).catch(()=>{"editor"===e&&this.state.creatingEditLink?this.setState({creatingEditLink:!1}):this.setState({creatingViewLink:!1})})},this.handleClickDeleteLink=e=>{d.deleteLinkWithConfirm({client:this.props.client,url:e.url,contentName:e.name,onDeleteLink:()=>{this.props.onDeleteLink(e)},onCancel:this.props.onCancelDeleteLink,actionHandler:this.props.actionHandler})},this.state={creatingEditLink:!1,creatingViewLink:!1}}render(){let e=void 0;"editor"===this.props.accessLevel?e=this.props.sharingInfo.editRighteousLink():(e=this.props.sharingInfo.viewRighteousLink(),e||(e=this.props.sharingInfo.shmodelLink()));const t=this.renderLinkPolicy(this.props.accessLevel,e);return n.default.createElement("div",{className:"scl-sharing-settings-links-section"},t)}emptyLinkCreateActions(e,t){return t?this.renderCreateLinkLoading(e):this.renderEmptyLinkPolicy(e)}renderLinkPolicy(e,t){if(!t)return"editor"===e?this.emptyLinkCreateActions(e,this.state.creatingEditLink):this.emptyLinkCreateActions(e,this.state.creatingViewLink);const s=this.props.updatedLinkPolicies[t.url],i=l.getLinkPolicy(t),d=m.isReadOnlyPolicy(i,t.link_permissions);let p;return p=t.isRighteousLink()?n.default.createElement(o.SharingSettingsRighteousLinkPolicyView,{linkPolicy:s||i,linkMetadata:t,onPolicyUpdate:this.props.onPolicyUpdate,readOnlyPolicy:d}):n.default.createElement(r.SharingSettingsLinkPolicyView,{linkPolicy:s||i,linkMetadata:t,isFolder:t.isFolder(),onPolicyUpdate:this.props.onPolicyUpdate,getPolicyDict:h.getShmodelInMultipleLinksPolicyDict,readOnlyPolicy:d}),n.default.createElement(a.Card,{key:t.url||e,icon:c.getSpectrumLinkIcon(e),title:this.renderTitle(e),actions:this.renderLinkActions(t)},p)}renderLinkActions(e){return n.default.createElement(_,{linkMetadata:e,onClickDeleteLink:this.handleClickDeleteLink})}renderEmptyLinkPolicy(e){const{sharingInfo:t,sharingPrefs:s}=this.props,r=this.props.sharingInfo.permissionsObj();let o;const l="ON"===s.create_edit_folder_link_variant;return o=m.canCreateLink(e,t.isCloudDoc(),t.isFolder(),t.isTeamSharedFolder(),t.isConfidentialFolder(),l,r.canInviteEditor(),t.canShareLink(),r.canCreateViewLink(),r.canCreateEditLink())?n.default.createElement("div",null,this.getEmptyLinkMessage(e)," ",n.default.createElement(i.Button,{variant:"borderless",onClick:()=>this.onClickButtonCreateLink(e)},p.intl.formatMessage({id:"F7gl6q",defaultMessage:"Create link"}))):p.intl.formatMessage({id:"DhAXrs",defaultMessage:"Link not available."}),n.default.createElement(a.Card,{key:e,icon:c.getSpectrumLinkIcon(e),title:this.renderTitle(e)},n.default.createElement("div",{className:"sharing-settings-modal__link-policy"},n.default.createElement("div",{className:"sharing-settings-modal__link-policy-text"},o)))}getEmptyLinkMessage(e){return"editor"===e?p.intl.formatMessage({id:"K79TJX",defaultMessage:"There isn’t a link for editing."}):p.intl.formatMessage({id:"B3RLyV",defaultMessage:"There isn’t a link for viewing."})}renderCreateLinkLoading(e){let t;const s=p.intl.formatMessage({id:"MnjJiE",defaultMessage:"Creating link"});return t=n.default.createElement("span",null,s,n.default.createElement(u.ScooterLoader,null)),n.default.createElement(a.Card,{key:e,icon:c.getSpectrumLinkIcon(e),title:this.renderTitle(e)},n.default.createElement("div",{className:"sharing-settings-modal__link-policy"},n.default.createElement("div",{className:"sharing-settings-modal__link-policy-text"},t)))}renderTitle(e){return"editor"===e?p.intl.formatMessage({id:"jN5OfV",defaultMessage:"People with this link can edit"}):p.intl.formatMessage({id:"xLAQNV",defaultMessage:"People with this link can view"})}}t.SharingSettingsLinkSection=g,g.displayName="SharingSettingsLinkSection";class _ extends n.default.Component{constructor(){super(...arguments),this.handleClickDelete=e=>{e.preventDefault(),this.props.onClickDeleteLink(this.props.linkMetadata)}}render(){return this.canDeleteLink()?n.default.createElement(i.Button,{variant:"borderless",onClick:this.handleClickDelete},p.intl.formatMessage({id:"lDhFjo",defaultMessage:"Delete link"})):null}canDeleteLink(){return this.props.linkMetadata.link_permissions.can_revoke}}t.SharingSettingsLinkActions=_,_.displayName="SharingSettingsLinkActions"})),define("modules/clean/sharing/views/sharing_settings_righteous_link_policy_view",["require","exports","tslib","react","modules/clean/sharing/views/sharing_settings_link_policies","modules/core/i18n","spectrum-sharing/share_modal/sharing_settings/sharing_settings_audience","spectrum-sharing/share_modal/sharing_settings/sharing_settings_password","spectrum-sharing/share_modal/sharing_settings/sharing_settings_expire","spectrum-sharing/share_modal/sharing_settings/sharing_settings_download"],(function(e,t,s,n,i,a,r,o,l,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SharingSettingsRighteousLinkPolicyView=void 0,n=s.__importDefault(n);const c=e=>{window.open(e,"_blank")};class h extends n.default.Component{constructor(){super(...arguments),this.getPolicyDict=e=>{const{link_permissions:t}=this.props.linkMetadata;return i.getRLPolicyDict(e,t.link_access_level,this.props.linkMetadata.isFolder())},this.handleMultiplePolicyUpdate=e=>{const t=this.props.linkPolicy.merge(e);this.props.onPolicyUpdate(this.props.linkMetadata,t)},this.handlePolicyUpdate=(e,t)=>{const s=this.props.linkPolicy.set(e,t);this.props.onPolicyUpdate(this.props.linkMetadata,s)}}render(){const e=this.props.readOnlyPolicy;return n.default.createElement("div",null,n.default.createElement(r.SharingSettingsAudience,{intl:a.intl,linkPermissions:this.props.linkMetadata.link_permissions,linkPolicy:this.props.linkPolicy,getPolicyDict:this.getPolicyDict,onPolicyUpdate:this.handleMultiplePolicyUpdate,readOnlyPolicy:e}),n.default.createElement(o.SharingSettingsPassword,{intl:a.intl,linkPermissions:this.props.linkMetadata.link_permissions,linkPolicy:this.props.linkPolicy,getPolicyDict:this.getPolicyDict,onPolicyUpdate:this.handleMultiplePolicyUpdate,readOnlyPolicy:e}),n.default.createElement(l.SharingSettingsExpire,{intl:a.intl,linkMetadata:this.props.linkMetadata,linkPolicy:this.props.linkPolicy,getPolicyDict:this.getPolicyDict,onPolicyUpdate:this.handleMultiplePolicyUpdate,readOnlyPolicy:e}),n.default.createElement(d.SharingSettingsDownload,{intl:a.intl,linkPermissions:this.props.linkMetadata.link_permissions,linkPolicy:this.props.linkPolicy,getPolicyDict:this.getPolicyDict,onPolicyUpdate:this.handlePolicyUpdate,onLinkClicked:c,readOnlyPolicy:e,isEditFolderLink:this.props.linkMetadata.isFolder(),banner:n.default.createElement(d.DisableDownloadsBanner,{intl:a.intl,linkPermissions:this.props.linkMetadata.link_permissions,linkPolicy:this.props.linkPolicy})}))}}t.SharingSettingsRighteousLinkPolicyView=h,h.displayName="SharingSettingsRighteousLinkPolicyView"})),define("modules/clean/sharing/views/sharing_settings_policy_view",["require","exports","tslib","react","spectrum/toggle/index","spectrum-sharing/components/sharing_modal_settings_row/index","modules/clean/sharing/sharing_settings_dropdown"],(function(e,t,s,n,i,a,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SharingSettingsPolicyView=void 0,n=s.__importDefault(n);class o extends n.default.Component{constructor(e){super(e),this.sharingModalSettingsRowLinkClicked=e=>{window.open(e,"_blank")},this.renderPolicyRow=(e,t,s,i,r)=>n.default.createElement(a.SharingModalSettingsRow,{policyFieldName:e,key:t.title,displayName:t.title,displayNameTitle:t.title,description:t.description,descriptionLinkUrl:t.descriptionLinkUrl,descriptionLinkText:t.descriptionLinkText,descriptionLinkOnClicked:this.sharingModalSettingsRowLinkClicked,rightSideElement:i,bottomElement:r})}renderDropdown(e,t,s,i,a,o){return n.default.createElement(r.SettingDropdown,{currentValue:t,valuesList:i,optionsDict:s,onValueSelected:a,disabled:o})}renderToggle(e,t,s,a,r){const o=r?(e,t)=>{}:a;return n.default.createElement(i.Toggle,{ariaLabel:"toggle",className:"sharing-settings-modal__toggle",labelContent:s[t].label,checked:s[t].value,interactive:!r,disabled:r,onCheckedChange:o})}}t.SharingSettingsPolicyView=o,o.displayName="SharingSettingsPolicyView"})),define("modules/clean/sharing/views/viewer_info",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ViewerInfo=void 0;t.ViewerInfo=class{constructor(e){e.when_last_seen&&(this.time_last_seen=new Date(1e3*e.when_last_seen));const t=e.seen_state_user;this.account_id=t.user_id,this.display_name=t.display_name,this.email=t.email,this.photo_circle_url=t.photo_circle_url,this.same_team=!0}displayName(){return this.display_name}memberId(){return this.account_id}}})),define("modules/clean/sharing/views/wrapped_group_viewers_maker",["require","exports","tslib","react","modules/clean/datetime/datetime","modules/clean/em_string","modules/clean/react/title_bubble","spectrum-sharing/utils/sharing_constants","modules/core/i18n","modules/clean/react/sticky_position"],(function(e,t,s,n,i,a,r,o,l,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WrappedGroupViewersMaker=void 0,n=s.__importDefault(n);(function(e){function t(e,t){const s=t.has(e.account_id)?l.intl.formatMessage({id:"BMhlbR",defaultMessage:"Viewing now"}):i.ago(e.time_last_seen);return[n.default.createElement("tr",null,n.default.createElement("td",{className:"group-tooltip__viewers-table-cell group-tooltip__member-name"},a.Emstring.em_snippet(e.displayName(),o.SNIPPET_SIZES.DISPLAY_NAME)),n.default.createElement("td",{className:"group-tooltip__viewers-table-cell dot"},"·"),n.default.createElement("td",{className:"group-tooltip__viewers-table-cell group-tooltip__seen-string"},s))]}e.make=function(e,s){const i=l.intl.formatMessage({id:"4joFvJ",defaultMessage:"{count, plural, one{{count} viewer} other{{count} viewers}}"},{count:e.length}),a=e.length<=10,o=a?e.length:9;let c=t(e[0],s);for(let n=1;n<o;n++)c=c.concat(t(e[n],s));if(!a){const t=e.length-o,s=l.intl.formatMessage({id:"6gF5ZF",defaultMessage:"{count, plural, one{and {count} other} other{and {count} others}}"},{count:t});c=c.concat(n.default.createElement("tr",null,n.default.createElement("td",{className:"group-tooltip__viewers-table-cell group-tooltip__member-name"},s)))}return{element:n.default.createElement(r.TitleBubble,{content:n.default.createElement("table",{className:"group-tooltip__viewers-table"},n.default.createElement("tbody",null,c)),className:"group-tooltip",children:n.default.createElement("span",{className:"u-font-meta sharing-member-info__viewer-count-text"},i),position:d.StickyPosition.BOTTOM,isTargetPositionFixed:!0}),elementText:i}}})(t.WrappedGroupViewersMaker||(t.WrappedGroupViewersMaker={}))})),define("modules/clean/sharing/views/wrapped_sharing_modal_checkbox_row",["require","exports","tslib","react","modules/clean/sharing/views/hover_close_button","modules/core/i18n","spectrum-sharing/components/sharing_modal_checkbox_row/index"],(function(e,t,s,n,i,a,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WrappedSharingModalCheckboxRow=void 0,n=s.__importDefault(n),i=s.__importDefault(i);const o=e=>{let t;if(e.showShareAsCommentOnboarding){t={className:"checkbox-row-tooltip",content:n.default.createElement("div",{className:"content"},n.default.createElement("div",{className:"text-content"},n.default.createElement("div",{className:"header"},a.intl.formatMessage({id:"5q97ZA",defaultMessage:"Let everyone know"})),a.intl.formatMessage({id:"pbYebK",defaultMessage:"Check this box so others can see your message when viewing this file."})),n.default.createElement("div",null,n.default.createElement(i.default,{className:"c-coach-mark__x",onClick:e.onCloseShareAsCommentOnboarding}))),alwaysShow:!0}}return n.default.createElement(r.SharingModalCheckboxRow,Object.assign({},e,{tooltipData:t}))};o.displayName="WrappedSharingModalCheckboxRowInternal",t.WrappedSharingModalCheckboxRow=n.default.memo(o),t.WrappedSharingModalCheckboxRow.displayName="WrappedSharingModalCheckboxRow"})),define("modules/clean/teams/admin/widgets/groups/util",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getInitials=void 0,t.getInitials=e=>{const t=e.toUpperCase().split(" ");return`${t[0][0]}${t.length>1?t[t.length-1][0]:""}`}})),define("modules/clean/previews/data/store",["require","exports","modules/clean/react/file_viewer/data/store","modules/clean/previews/data/actions"],(function(e,t,s,n){"use strict";function i(e,t,s){e.dispatch(n.fetchPreviewData(t,s))}Object.defineProperty(t,"__esModule",{value:!0}),t.fetchPreviewDataUpdateStore=t.hydratePreviewStore=t.hydrateFileStoreAndPreviewStore=void 0,t.hydrateFileStoreAndPreviewStore=function(e,t,n){s.hydrateFileStore(e,t),i(e,t,n)},t.hydratePreviewStore=i,t.fetchPreviewDataUpdateStore=function(e,t,s,i){e.dispatch(n.fetchPreviewData(t,s,i))}})),define("modules/clean/sharing/upsells/family_upsell_modal",["require","exports","tslib","react","react-intl","dig-components/buttons","dig-components/modal","dig-components/typography","modules/clean/react/components/css","modules/core/i18n","modules/clean/ux_analytics/utils"],(function(e,t,s,n,i,a,r,o,l,d,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CreateFamilyUpsellModal=void 0,n=s.__importDefault(n);class h extends n.default.Component{constructor(e){super(e),this.onClickCancel=()=>{this.setState({isModalOpen:!1})},this.state={isModalOpen:!0}}render(){return r.Modal.setAppElement(document.getElementById("embedded-app")||document.body),n.default.createElement(i.RawIntlProvider,{value:d.intl},n.default.createElement(r.Modal,{width:"standard",open:this.state.isModalOpen,className:"uxa-modal",id:"family-sharing-upsell-modal",onAfterOpen:()=>c.dispatchModalOpened(),onAfterClose:()=>c.dispatchModalClosed()},n.default.createElement("img",{role:"presentation",src:"/static/images/product_growth/visual-identity-system-photos-1-vflo7MMGP.png",className:"cfsum__hero_image"}),n.default.createElement(r.Modal.Body,null,n.default.createElement(o.Title,{className:"cfsum__title"},d.intl.formatMessage({id:"9z+sIf",defaultMessage:"Share Dropbox with family and save money"})),n.default.createElement(o.Text,null,n.default.createElement(i.FormattedMessage,{id:"apZcyM",defaultMessage:"For less than the price of two Plus plans, Dropbox Family lets up to six people share 2 TB (2,000 GB) of space. Everyone has their own account and private storage, plus a Family Room for sharing photos and files with each other."}))),n.default.createElement(r.Modal.Footer,{className:"cfsum__footer"},n.default.createElement(a.Button,{variant:"transparent",onClick:this.onClickCancel,"data-uxa-log":"family-sharing-upsell-cancel"},n.default.createElement(i.FormattedMessage,{id:"myX3dP",defaultMessage:"Not now"})),n.default.createElement(a.Button,{href:"/plans?trigger=nr",target:"_blank",variant:"primary","data-uxa-log":"family-sharing-upsell-continue"},n.default.createElement(i.FormattedMessage,{id:"ewzgz2",defaultMessage:"Compare plans"})))))}}h.displayName="CreateFamilyUpsellModalNoStyles",t.CreateFamilyUpsellModal=l.requireCssWithComponent(h,["/static/css/dig-components/index.web-vflm67Rix.css","/static/css/growth/create_family_sharing_upsell_modal-vflMAFYnt.css"])})),define("spectrum-sharing/components/back_button/index",["require","exports","tslib","spectrum-sharing/components/back_button/back_button"],(function(e,t,s,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),s.__exportStar(n,t)})),define("spectrum-sharing/components/back_button/back_button",["require","exports","tslib","react","dig-components/buttons","dig-components/icons"],(function(e,t,s,n,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BackButton=void 0,n=s.__importStar(n);class r extends n.Component{render(){return n.createElement("div",{className:"scl-back-button__wrapper"},n.createElement("span",{className:"scl-back-button__icon"},n.createElement(a.UIIcon,{src:this.props.icon,size:"small","aria-label":this.props.label,onClick:this.props.onBackButtonClick})),n.createElement("span",{className:"scl-back-button__label"},n.createElement(i.Button,{autoFocus:this.props.autoFocus,size:"small",variant:"transparent",onClick:this.props.onBackButtonClick,hasNoUnderline:!0},this.props.label)))}}t.BackButton=r,r.displayName="BackButton"})),define("spectrum-sharing/components/action_container/index",["require","exports","tslib","spectrum-sharing/components/action_container/action_container"],(function(e,t,s,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),s.__exportStar(n,t)})),define("spectrum-sharing/components/action_container/action_container",["require","exports","tslib","react","classnames","dig-components/typography"],(function(e,t,s,n,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ActionContainer=void 0,n=s.__importStar(n),i=s.__importDefault(i);const r="scl-action-container";class o extends n.Component{render(){const{banner:e,footer:t,children:s,className:o,header:l,headerSize:d,showBorder:c}=this.props,h=i.default(o,r,{[`${r}--bordered`]:c});return n.createElement("div",{className:h},l&&n.createElement("div",{className:`${r}__header`},n.createElement(a.Title,{size:d,isBold:!0},l)),e&&n.createElement("div",{className:`${r}__banner`},e),n.createElement("div",{className:`${r}__children`},s),t&&n.createElement("div",{className:`${r}__footer`},t))}}t.ActionContainer=o,o.displayName="ActionContainer",o.defaultProps={showBorder:!1}})),define("spectrum-sharing/components/action_section/index",["require","exports","tslib","spectrum-sharing/components/action_section/action_section"],(function(e,t,s,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),s.__exportStar(n,t)})),define("spectrum-sharing/components/action_section/action_section",["require","exports","tslib","react","classnames","dig-components/typography"],(function(e,t,s,n,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ActionSection=void 0,n=s.__importStar(n),i=s.__importDefault(i);const r="scl-action-section";class o extends n.Component{render(){const{children:e,className:t,layout:s,header:o,footerContent:l,footerActions:d,isHeaderBold:c}=this.props,h=i.default(t,r,{[`${r}--${s}`]:!!s});return n.createElement("div",{className:h},o&&n.createElement(a.Text,{className:`${r}__header`,tagName:"div",size:"small",isBold:c},o),n.createElement("div",{className:`${r}__children`},e),n.createElement("div",{className:`${r}__footer`},l&&n.createElement("div",{className:`${r}__footer-content`},l),d&&n.createElement("div",{className:`${r}__footer-actions`},d)))}}t.ActionSection=o,o.displayName="ActionSection",o.defaultProps={isHeaderBold:!0,layout:"rows"}})),define("spectrum-sharing/components/checkbox_with_label/index",["require","exports","tslib","spectrum-sharing/components/checkbox_with_label/checkbox_with_label"],(function(e,t,s,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),s.__exportStar(n,t)})),define("spectrum-sharing/components/checkbox_with_label/checkbox_with_label",["require","exports","tslib","react","classnames","dig-components/controls","dig-components/typography"],(function(e,t,s,n,i,a,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CheckboxWithLabel=void 0,n=s.__importStar(n),i=s.__importDefault(i);class o extends n.Component{render(){const{label:e,fontSize:t,isChecked:s,isCheckboxDisabled:o,onCheckboxToggled:l,className:d}=this.props,c=i.default(d,"scl-checkbox-with-label");return n.createElement("span",{className:c},n.createElement(a.Checkbox,{"aria-label":e,onChange:l,checked:s,disabled:o,id:"checkbox"}),n.createElement(r.Text,{className:"scl-checkbox-with-label__text",tagName:"label",size:t,htmlFor:"checkbox"},e))}}t.CheckboxWithLabel=o,o.displayName="CheckboxWithLabel"})),define("spectrum-sharing/components/card/index",["require","exports","tslib","spectrum-sharing/components/card/card"],(function(e,t,s,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),s.__exportStar(n,t)})),define("spectrum-sharing/components/card/card",["require","exports","tslib","classnames","react"],(function(e,t,s,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Card=t.baseClassName=void 0,n=s.__importDefault(n),i=s.__importStar(i),t.baseClassName="scl-card";class a extends i.PureComponent{render(){const{className:e}=this.props,s=n.default(t.baseClassName,e);return i.createElement("div",{className:s},this.renderHeader(),this.renderBody())}renderHeader(){if(this.props.icon||this.props.title||this.props.actions)return i.createElement("div",{className:`${t.baseClassName}__header`},this.props.icon&&i.createElement("div",{className:`${t.baseClassName}__icon`},this.props.icon),this.props.title&&i.createElement("div",{className:`${t.baseClassName}__title`},this.props.title),this.props.actions&&i.createElement("div",{className:`${t.baseClassName}__actions`},this.props.actions))}renderBody(){return i.createElement("div",{className:`${t.baseClassName}__body`},this.props.children)}}t.Card=a,a.displayName="Card"})),define("spectrum-sharing/components/confidential_folder_section/index",["require","exports","tslib","spectrum-sharing/components/confidential_folder_section/confidential_folder_section"],(function(e,t,s,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),s.__exportStar(n,t)})),define("spectrum-sharing/components/confidential_folder_section/confidential_folder_section",["require","exports","tslib","react","spectrum-sharing/components/sharing_modal_banner/index","dig-components/buttons","spectrum-sharing/utils/sharing_constants","spectrum-sharing/utils/em_string"],(function(e,t,s,n,i,a,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ConfidentialFolderSection=void 0,n=s.__importStar(n);class l extends n.Component{constructor(){super(...arguments),this.restoreAccessToConfidentialFolder=()=>{const{teamName:e,onRestoreAccessClick:t}=this.props;t(!0,e)}}render(){const{intl:e,teamName:t,parentFolderName:s,isRestoreAccessEnabled:l}=this.props;let d,c;""!==s?(d=e.formatMessage({id:"V1N9tG",defaultMessage:'This folder isn’t shared with everyone who has access to parent folder "{parent}".'},{parent:o.Emstring.em_snippet(s,r.SNIPPET_SIZES.FILENAME)}),c=e.formatMessage({id:"R+Gy+p",defaultMessage:"Share with everyone"})):(d=e.formatMessage({id:"z87QTd",defaultMessage:"This folder isn’t shared with everyone on {team_name}."},{team_name:o.Emstring.em_snippet(t,r.SNIPPET_SIZES.DISPLAY_NAME)}),c=e.formatMessage({id:"R+Gy+p",defaultMessage:"Share with everyone"}));const h=n.createElement("div",{className:"confidential-folder-section"},d," ",l&&n.createElement(a.Button,{className:"button-as-link","aria-label":c,key:"restore access",variant:"transparent",size:"small",hasNoUnderline:!0,onClick:this.restoreAccessToConfidentialFolder},c));return n.createElement(i.SharingModalBanner,{type:"dark",message:h})}}t.ConfidentialFolderSection=l,l.displayName="ConfidentialFolderSection"})),define("spectrum-sharing/components/fixed_tabbed_container/index",["require","exports","tslib","spectrum-sharing/components/fixed_tabbed_container/fixed_tabbed_container"],(function(e,t,s,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),s.__exportStar(n,t)})),define("spectrum-sharing/components/fixed_tabbed_container/fixed_tabbed_container",["require","exports","tslib","classnames","react","spectrum/tabbed_header/index"],(function(e,t,s,n,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FixedTabbedContainer=void 0,n=s.__importDefault(n),i=s.__importStar(i);class r extends i.PureComponent{render(){const{activeTabId:e,className:t,onTabSelected:s,tabs:r}=this.props,o=n.default("scl-fixed-tabbed-container",t);return i.createElement("div",{className:o},i.createElement("div",{className:"scl-fixed-tabbed-container__tabbed-header"},i.createElement(a.TabbedHeader,{onSelection:s,activeTabId:e},r.map(t=>i.createElement(a.Tab,{active:e===t.id,className:"sharing-settings-modal__tab-header",id:t.id,key:t.id},t.label)))),i.createElement("div",{className:"scl-fixed-tabbed-container__content"},this.props.children))}}t.FixedTabbedContainer=r,r.displayName="FixedTabbedContainer"})),define("spectrum-sharing/components/form_validation_message/index",["require","exports","tslib","spectrum-sharing/components/form_validation_message/form_validation_message"],(function(e,t,s,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),s.__exportStar(n,t)})),define("spectrum-sharing/components/form_validation_message/form_validation_message",["require","exports","tslib","react","dig-components/icons","dig-components/icons/src","dig-components/typography"],(function(e,t,s,n,i,a,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FormValidationMessage=void 0,n=s.__importStar(n);t.FormValidationMessage=function({message:e,variant:t}){if(!e)return null;const s="error"===t?"error":"standard";return n.createElement("div",{className:"scl-form-validation-message"},"warn"===t&&n.createElement(i.UIIcon,{src:a.WarningPictogram,size:"small"}),n.createElement("div",{className:"scl-form-validation-message__text"},n.createElement(r.Text,{size:"small",color:s},e)))}})),define("spectrum-sharing/components/help_info/index",["require","exports","tslib","spectrum-sharing/components/help_info/help_info"],(function(e,t,s,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),s.__exportStar(n,t)})),define("spectrum-sharing/components/help_info/help_info",["require","exports","tslib","react","classnames","dig-components/icons","dig-components/icons/src","dig-components/tooltips"],(function(e,t,s,n,i,a,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HelpInfo=void 0,n=s.__importStar(n),i=s.__importDefault(i);class l extends n.PureComponent{render(){const{id:e,className:t,text:s,placement:l,iconSize:d,children:c}=this.props,h=i.default(t,"scl-help-info");return n.createElement(o.Tooltip,{className:h,id:e,placement:l,title:s},n.createElement("span",{className:"scl-help-info"},c,n.createElement(a.UIIcon,{src:r.HelpLine,className:"scl-help-info__icon",size:d,"aria-label":""})))}}t.HelpInfo=l,l.displayName="HelpInfo",l.defaultProps={placement:"top",iconSize:"small"}})),define("spectrum-sharing/components/icons/icon_dropdown_caret",["require","exports","tslib","react"],(function(e,t,s,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IconDropdownCaretBlueWeb=t.IconDropdownCaretWeb=t.IconDropdownCaretWin=t.IconDropdownCaretOsx=void 0,n=s.__importStar(n),t.IconDropdownCaretOsx=({className:e,variant:t="default"})=>n.createElement("svg",{className:e,xmlns:"http://www.w3.org/2000/svg",width:"9",height:"5",viewBox:"0 0 9 5"},n.createElement("path",{fill:"none",fillRule:"evenodd",stroke:"highlighted"===t?"#0269D9":"#3E3E3E",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",d:"M8 1L4.5 4 1 1"})),t.IconDropdownCaretWin=({className:e,variant:t="default"})=>n.createElement("svg",{className:e,width:"12px",height:"6px",viewBox:"0 0 12 6",xmlns:"http://www.w3.org/2000/svg"},n.createElement("g",{stroke:"highlighted"===t?"#0269D9":"none",strokeWidth:"1",fill:"none",fillRule:"evenodd",fillOpacity:"0.8"},n.createElement("g",{fill:"#000000"},n.createElement("polygon",{points:"6 5.01369863 11.4626866 0 12 0.493150685 6 6 0 0.493150685 0.537313433 0"})))),t.IconDropdownCaretWeb=({className:e})=>n.createElement("svg",{className:e,width:"7px",height:"4px",viewBox:"0 0 7 4",xmlns:"http://www.w3.org/2000/svg"},n.createElement("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},n.createElement("g",{transform:"translate(-509.000000, -24.000000)",fill:"#637282"},n.createElement("g",{transform:"translate(444.000000, 16.000000)"},n.createElement("polygon",{points:"65 8 72 8 68.5 12"}))))),t.IconDropdownCaretBlueWeb=({className:e})=>n.createElement("svg",{className:e,width:"7px",height:"4px",viewBox:"0 0 7 4",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},n.createElement("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},n.createElement("g",{transform:"translate(-509.000000, -128.000000)",fill:"#007AF5"},n.createElement("polygon",{id:"Arrow",points:"509 128 516 128 512.5 132"})))),t.IconDropdownCaretOsx.displayName="IconDropdownCaretOsx",t.IconDropdownCaretWin.displayName="IconDropdownCaretWin",t.IconDropdownCaretWeb.displayName="IconDropdownCaretWeb",t.IconDropdownCaretBlueWeb.displayName="IconDropdownCaretBlueWeb"})),define("spectrum-sharing/components/icons/icon_dropdown_selected",["require","exports","tslib","react"],(function(e,t,s,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IconDropdownSelectedBlue=t.IconDropdownSelected=void 0,n=s.__importStar(n),t.IconDropdownSelected=({className:e})=>n.createElement("svg",{className:e,width:"12px",height:"12px",viewBox:"0 0 12 12",xmlns:"http://www.w3.org/2000/svg"},n.createElement("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},n.createElement("g",{fill:"#3E3E3E",fillRule:"nonzero"},n.createElement("path",{d:"M2.25927473,6.3493149 C1.89985258,5.92998906 1.2685526,5.88142752 0.849226756,6.24084967\n                  C0.429900914,6.60027182 0.381339377,7.2315718 0.740761528,7.65089765 L3.65485393,11.0506721\n                  C3.75823486,11.1606625 3.75823486,11.1606625 3.87986598,11.2500569 C4.38534754,11.5870446\n                  5.06830382,11.4504534 5.40529152,10.9449718 L11.3320684,2.05480647 C11.6384209,1.59527778\n                  11.514247,0.974408438 11.0547183,0.668055979 C10.5951896,0.36170352 9.97432029,0.485877389\n                  9.66796784,0.945406077 L4.40019879,8.84705964 L2.25927473,6.3493149 Z"})))),t.IconDropdownSelected.displayName="IconDropdownSelected",t.IconDropdownSelectedBlue=({className:e})=>n.createElement("svg",{className:e,width:"14px",height:"11px",viewBox:"0 0 14 11",xmlns:"http://www.w3.org/2000/svg"},n.createElement("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},n.createElement("g",{transform:"translate(-3.000000, -5.000000)",fill:"#0070E0"},n.createElement("path",{d:"M11,13 L11,3 L13,3 L13,13 L13,15 L7,15 L7,13 L11,13 Z",id:"Icon",transform:"translate(10.000000, 9.000000) rotate(-315.000000) translate(-10.000000, -9.000000) "})))),t.IconDropdownSelectedBlue.displayName="IconDropdownSelectedBlue"})),define("spectrum-sharing/components/icons/icon_link",["require","exports","tslib","react"],(function(e,t,s,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IconLink=void 0,n=s.__importStar(n);const i={default:"transparent",active:"#D0D4D9",edit:"transparent",view:"transparent"},a=()=>n.createElement("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},n.createElement("g",{transform:"translate(-24.000000, -8.000000)"},n.createElement("g",null,n.createElement("g",{transform:"translate(24.000000, 8.000000)"},n.createElement("circle",{stroke:"#D0D4D9",strokeWidth:"1.32",cx:"16",cy:"16",r:"15.34"}),n.createElement("path",{d:"M21.0859375,13.1015625 L20.0195312,14.1679688 L17.8320312,11.9804688\n                L18.8984375,10.9140625 C19.007813,10.804687 19.1445304,10.75 19.3085938,10.75\n                C19.4726571,10.75 19.6093745,10.804687 19.71875,10.9140625 L21.0859375,12.28125\n                C21.195313,12.3906255 21.25,12.5273429 21.25,12.6914062 C21.25,12.8554696\n                21.195313,12.992187 21.0859375,13.1015625 Z M10.75,19.0625 L17.203125,12.609375\n                L19.390625,14.796875 L12.9375,21.25 L10.75,21.25 L10.75,19.0625 Z",fill:"#6A7C8F"}))))),r=()=>n.createElement("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},n.createElement("g",{transform:"translate(-24.000000, -8.000000)"},n.createElement("g",null,n.createElement("g",{transform:"translate(24.000000, 8.000000)"},n.createElement("circle",{stroke:"#D0D4D9",strokeWidth:"1.32",cx:"16",cy:"16",r:"15.34"}),n.createElement("path",{d:"M14.7695312,14.7695312 C15.1158871,14.4231754 15.5260393,14.25 16,14.25\n                  C16.4739607,14.25 16.8841129,14.4231754 17.2304688,14.7695312 C17.5768246,\n                  15.1158871 17.75,15.5260393 17.75,16 C17.75,16.4739607 17.5768246,16.8841129\n                  17.2304688,17.2304688 C16.8841129,17.5768246 16.4739607,17.75 16,17.75 C15.5260393,\n                  17.75 15.1158871,17.5768246 14.7695312,17.2304688 C14.4231754,16.8841129 14.25,\n                  16.4739607 14.25,16 C14.25,15.5260393 14.4231754,15.1158871 14.7695312,14.7695312\n                  Z M13.921875,18.078125 C14.5052113,18.643232 15.1979127,18.9257812 16,18.9257812\n                  C16.8020873,18.9257812 17.4902315,18.6386747 18.0644531,18.0644531 C18.6386747,\n                  17.4902315 18.9257812,16.8020873 18.9257812,16 C18.9257812,15.1979127 18.6386747,\n                  14.5097685 18.0644531,13.9355469 C17.4902315,13.3613253 16.8020873,13.0742188 16,\n                  13.0742188 C15.1979127,13.0742188 14.5097685,13.3613253 13.9355469,13.9355469\n                  C13.3613253,14.5097685 13.0742188,15.1979127 13.0742188,16 C13.0742188,16.8020873\n                  13.356768,17.4947887 13.921875,18.078125 Z M12.0898438,12.828125 C13.2565163,\n                  12.0260377 14.5598886,11.625 16,11.625 C17.4401114,11.625 18.7434837,12.0260377\n                  19.9101562,12.828125 C21.0768288,13.6302123 21.915362,14.6874934 22.4257812,16\n                  C21.915362,17.3125066 21.0768288,18.3697877 19.9101562,19.171875 C18.7434837,\n                  19.9739623 17.4401114,20.375 16,20.375 C14.5598886,20.375 13.2565163,19.9739623\n                  12.0898438,19.171875 C10.9231712,18.3697877 10.084638,17.3125066 9.57421875,\n                  16 C10.084638,14.6874934 10.9231712,13.6302123 12.0898438,12.828125 Z",fill:"#667C91"}))))),o=()=>n.createElement("g",{fill:"#6A7C8F",transform:"translate(16.071068, 16.071068) rotate(-315.000000)\n                  translate(-16.071068, -16.071068) translate(13.071068, 9.071068)"},n.createElement("path",{d:"M5.98487348,4.76239943 L4.58487348,4.76239943 L4.58487348,3.36107038\n                      C4.58487348,2.58309388 3.95807213,1.96239943 3.18487348,1.96239943\n                      C2.40628423,1.96239943 1.78487348,2.58860575 1.78487348,3.36107038\n                      L1.78487348,6.16372849 C1.78487348,6.94170499 2.41167483,7.56239943\n                      3.18487348,7.56239943 L3.18487348,8.96239943 C1.63847618,8.96239943\n                      0.384873479,7.70483456 0.384873479,6.16532106 L0.384873479,3.3594778\n                      C0.384873479,1.81469408 1.64162279,0.562399434 3.18487348,0.562399434\n                      C4.73127078,0.562399434 5.98487348,1.81996431 5.98487348,3.3594778\n                      L5.98487348,4.76239943 Z"}),n.createElement("path",{d:"M0.384873479,9.66239943 L1.78487348,9.66239943 L1.78487348,11.0637285\n                      C1.78487348,11.841705 2.41167483,12.4623994 3.18487348,12.4623994\n                      C3.96346273,12.4623994 4.58487348,11.8361931 4.58487348,11.0637285\n                      L4.58487348,8.26107038 C4.58487348,7.48309388 3.95807213,6.86239943\n                      3.18487348,6.86239943 L3.18487348,5.46239943 C4.73127078,5.46239943\n                      5.98487348,6.71996431 5.98487348,8.2594778 L5.98487348,11.0653211\n                      C5.98487348,12.6101048 4.72812417,13.8623994 3.18487348,13.8623994\n                      C1.63847618,13.8623994 0.384873479,12.6048346 0.384873479,11.0653211\n                      L0.384873479,9.66239943 Z"}));t.IconLink=({className:e,variant:t})=>n.createElement("svg",{className:e,width:"32px",height:"32px",viewBox:"0 0 32 32",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},n.createElement("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},n.createElement("circle",{stroke:"#D0D4D9",strokeWidth:"1.32",cx:"16",cy:"16",r:"15.34",fill:i[t||"default"]}),(e=>{switch(e){case"edit":return a();case"view":return r();default:return o()}})(t||"default")))})),define("spectrum-sharing/components/icons/icon_settings_gear",["require","exports","tslib","react"],(function(e,t,s,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IconSettingsGear=void 0,n=s.__importStar(n);t.IconSettingsGear=()=>n.createElement("svg",{width:"24",height:"24",viewBox:"-4 -4 24 24"},n.createElement("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},n.createElement("g",{transform:"translate(-8.000000, -8.000000)",fill:"#6A7C8F"},n.createElement("path",{d:"M24,15.2 L24,17.1428571 L21.4857143,17.1428571 C21.2888229,17.8170566 21.0206419,\n            18.4683533 20.6857143,19.0857143 L22.0571429,21.0285714 L20.6857143,22.4 L18.8571429,\n            21.0285714 C18.2754139,21.325336 17.6619932,21.5553687 17.0285714,21.7142857 L16.8,24\n            L14.8571429,24 L14.5142857,21.8285714 C13.8530915,21.7734369 13.2201272,21.5360752\n            12.6857143,21.1428571 L10.8571429,22.5142857 L9.6,21.1428571 L10.9714286,19.0857143\n            C10.6251458,18.4858566 10.3926725,17.8271824 10.2857143,17.1428571 L8,17.0285714\n            L8,14.9714286 L10.2857143,14.7428571 C10.4547526,14.0951222 10.7247251,13.4780422\n            11.0857143,12.9142857 L9.6,11.0857143 L10.9714286,9.6 L12.8,10.9714286 C13.3973396,\n            10.711597 14.0076729,10.4827221 14.6285714,10.2857143 L14.9714286,8 L16.9142857,8\n            17.2571429,10.2857143 C17.9212591,10.4043389 18.5478652,10.678479 19.0857143,11.0857143\n            L20.9142857,9.6 L22.2857143,10.9714286 L20.9142857,12.9142857 C21.3270172,13.533851\n            21.5999981,14.2358018 21.7142857,14.9714286 L24,15.2 Z M16,19.4285714 C17.8935477,\n            19.4285714 19.4285714,17.8935477 19.4285714,16 C19.4285714,14.1064523 17.8935477,\n            12.5714286 16,12.5714286 C14.1064523,12.5714286 12.5714286,14.1064523 12.5714286,16\n            C12.5714286,17.8935477 14.1064523,19.4285714 16,19.4285714 Z"}))))})),define("spectrum-sharing/components/input/index",["require","exports","tslib","spectrum-sharing/components/input/input"],(function(e,t,s,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),s.__exportStar(n,t)})),define("spectrum-sharing/components/input/input",["require","exports","tslib","classnames","react","spectrum/input/index"],(function(e,t,s,n,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Input=void 0,n=s.__importDefault(n),i=s.__importStar(i);class r extends i.PureComponent{render(){const e=this.props,{className:t,variant:r}=e,o=s.__rest(e,["className","variant"]),l=n.default("scl-input",t,`scl-input--${r}`),d="borderless"===r?"default":r;return i.createElement(a.Input,Object.assign({className:l,variant:d},o))}}t.Input=r,r.displayName="Input"})),define("spectrum-sharing/components/member_row/index",["require","exports","tslib","spectrum-sharing/components/member_row/member_row"],(function(e,t,s,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),s.__exportStar(n,t)})),define("spectrum-sharing/components/member_row/member_row",["require","exports","tslib","classnames","react","spectrum/avatar/index","spectrum-sharing/components/scooter_loader/index","spectrum-sharing/components/sharing_avatar_initials/index","spectrum-sharing/components/sharing_portal_dropdown/index"],(function(e,t,s,n,i,a,r,o,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MemberRow=void 0,n=s.__importDefault(n),i=s.__importStar(i);class d extends i.PureComponent{constructor(){super(...arguments),this.handleDropdownChange=e=>{const{id:t,onChange:s,optionGroup:n}=this.props;!s||n&&n.selectedApiId===e||s(t,e)}}render(){const{className:e,variant:t="default",position:s="default",tag:a}=this.props,r=a||"li",o=n.default(e,{"scl-member-row":!0,"scl-member-row-borderless":"borderless"===t,"scl-member-row-default":"default"===t,"scl-member-row-narrow":"narrow"===t},{"scl-member-row-positioned":"bottom"===s||"middle"===s,"scl-member-row-bottom":"bottom"===s});return i.createElement(r,{className:o},i.createElement("div",{className:"scl-member-row-outer"},this.renderAvatar(),i.createElement("div",{className:"scl-member-row-info"},this.renderDisplayName(),this.renderMemberDetails())),this.renderRightSideElement())}renderAvatar(){const{avatarHidden:e,avatarUrl:t,avatarElement:s,displayName:n,id:r,initials:l,initialAvatarShape:d}=this.props;return e?i.createElement("div",{className:"scl-member-row-avatar-empty"}):s||(t?i.createElement(a.Avatar,{src:t,className:"scl-member-row-avatar"}):i.createElement(o.SharingAvatarInitials,{avatarSize:32,backgroundColor:a.avatarColorForUserIdentifier(n||r),className:"scl-member-row-avatar",shape:d},l))}renderRightSideElement(){const{id:e,loadingSpinnerVisible:t,optionGroup:s}=this.props;let n;return n=t?i.createElement(r.ScooterLoader,null):s?1===s.options.length&&s.selectedApiId===s.options[0].apiId?i.createElement("div",null," ",s.label," "):i.createElement(l.SharingPortalDropdown,{id:e,optionGroup:s,onSelection:this.handleDropdownChange}):null,n}renderDisabledMessage(){return this.props.disabledMessage?[i.createElement("span",{key:0,className:"u-font-meta dot"}," · "),i.createElement("span",{key:1,className:"u-font-danger"}," ",this.props.disabledMessage)]:null}renderNameTitleAndText(){return i.createElement("span",{className:"scl-member-row-info-display-name-title",title:this.props.displayName},this.props.truncatedDisplayName||this.props.displayName)}renderPASSDot(){return this.props.passString?i.createElement("span",{className:"scl-member-row-dot"}," · "):null}renderOffTeamDot(){return this.props.offTeamMessage&&this.props.description?i.createElement("span",{className:"u-font-meta"}," · "):null}renderPASS(){const{present:e,passString:t}=this.props;if(t){const s=n.default({"scl-member-row-last-seen":!0,"scl-member-row-last-seen-not-present":!e});return i.createElement("span",{className:s},t)}return null}renderDisplayName(){return i.createElement("div",{className:"scl-member-row-display-name"},i.createElement("span",{className:this.props.onClickDisplayName?"scl-member-row-pointer":"",onClick:this.props.onClickDisplayName},this.renderNameTitleAndText(),this.renderDisabledMessage(),this.renderPASSDot(),this.renderPASS()))}renderOffTeamMessage(e){return e?i.createElement("span",{className:"u-font-meta"},e):null}renderMemberDetails(){const{description:e,offTeamMessage:t,truncatedDescription:s}=this.props;return i.createElement("div",{className:"scl-member-row-details"},i.createElement("span",{className:this.props.onClickDetails?"scl-member-row-pointer":"",onClick:this.props.onClickDetails},i.createElement("span",{className:"scl-member-row-details-span",title:e},s||e),this.renderOffTeamDot(),this.renderOffTeamMessage(t)))}}t.MemberRow=d,d.displayName="MemberRow"})),define("spectrum-sharing/components/scooter_loader/index",["require","exports","tslib","spectrum-sharing/components/scooter_loader/scooter_loader"],(function(e,t,s,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),s.__exportStar(n,t)})),define("spectrum-sharing/components/scooter_loader/scooter_loader",["require","exports","tslib","classnames","react"],(function(e,t,s,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ScooterLoader=void 0,n=s.__importDefault(n),i=s.__importStar(i),t.ScooterLoader=e=>{var{className:t}=e,a=s.__rest(e,["className"]);return i.createElement("div",Object.assign({className:n.default("scl-scooter-loader",t)},a),i.createElement("div",{className:"scl-scooter-loader-animation"}))},t.ScooterLoader.displayName="ScooterLoader"})),define("spectrum-sharing/components/sharing_contact_token/index",["require","exports","tslib","spectrum-sharing/components/sharing_contact_token/sharing_contact_token"],(function(e,t,s,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),s.__exportStar(n,t)})),define("spectrum-sharing/components/sharing_contact_token/sharing_contact_token",["require","exports","tslib","react","spectrum/avatar/index","spectrum/tooltip/index"],(function(e,t,s,n,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SharingContactToken=void 0,n=s.__importStar(n);class r extends n.PureComponent{render(){const{avatarUrl:e,displayName:t,validation:s}=this.props,r=n.createElement("div",{style:{display:"flex",maxWidth:"200px"}},e&&n.createElement(i.Avatar,{size:16,src:e}),n.createElement("div",{style:{flex:"auto",marginLeft:"5px",minWidth:"0",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}},t));return s&&"invalid"===s.state?n.createElement(a.Tooltip,{tooltipContent:s.msg?s.msg:""},r):r}}t.SharingContactToken=r,r.displayName="SharingContactToken"})),define("spectrum-sharing/components/sharing_dropdown_menu/index",["require","exports","tslib","spectrum-sharing/components/sharing_dropdown_menu/sharing_dropdown_menu","spectrum-sharing/components/sharing_dropdown_menu/sharing_dropdown_menu_button","spectrum-sharing/components/sharing_dropdown_menu/sharing_dropdown_menu_item"],(function(e,t,s,n,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),s.__exportStar(n,t),s.__exportStar(i,t),s.__exportStar(a,t)})),define("spectrum-sharing/components/sharing_dropdown_menu/sharing_dropdown_menu",["require","exports","tslib","classnames","react","spectrum/dropdown_menu/index"],(function(e,t,s,n,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SharingDropdownMenu=t.baseClassName=void 0,n=s.__importDefault(n),i=s.__importStar(i),t.baseClassName="scl-sharing-dropdown-menu",t.SharingDropdownMenu=e=>{const{position:r,className:o}=e,l=s.__rest(e,["position","className"]),d=n.default(t.baseClassName,o,{[`${t.baseClassName}--right`]:"right"===r});return i.createElement(a.DropdownMenu,Object.assign({className:d},l))},t.SharingDropdownMenu.displayName="SharingDropdownMenu"})),define("spectrum-sharing/components/sharing_dropdown_menu/sharing_dropdown_menu_button",["require","exports","tslib","classnames","react","spectrum/dropdown_menu/index","spectrum-sharing/components/icons/icon_dropdown_caret"],(function(e,t,s,n,i,a,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SharingDropdownMenuButton=void 0,n=s.__importDefault(n),i=s.__importStar(i);const o="scl-sharing-dropdown-menu-button";class l extends i.PureComponent{render(){const e=this.props,{children:t,className:l}=e,d=s.__rest(e,["children","className"]),c=n.default(o,l);return i.createElement(a.DropdownMenuButton,Object.assign({className:c},d),t,i.createElement(r.IconDropdownCaretOsx,{className:`${o}__icon ${o}__icon--osx`}),i.createElement(r.IconDropdownCaretWin,{className:`${o}__icon ${o}__icon--win`}))}}t.SharingDropdownMenuButton=l,l.displayName="SharingDropdownMenuButton"})),define("spectrum-sharing/components/sharing_dropdown_menu/sharing_dropdown_menu_item",["require","exports","tslib","classnames","react","spectrum/dropdown_menu/index","spectrum-sharing/components/icons/icon_dropdown_selected"],(function(e,t,s,n,i,a,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SharingDropdownMenuItem=void 0,n=s.__importDefault(n),i=s.__importStar(i);const o="scl-sharing-dropdown-menu-item";t.SharingDropdownMenuItem=e=>{var{description:t,label:l,selected:d,value:c}=e,h=s.__rest(e,["description","label","selected","value"]);return i.createElement(a.MenuItem,Object.assign({className:o,key:c,value:c,text:l,selected:d},h),d&&i.createElement(r.IconDropdownSelected,{className:`${o}__selected-icon`}),i.createElement("div",{className:n.default(`${o}__wrapper`,{[`${o}__wrapper-selected`]:d})},i.createElement("div",{className:`${o}__label`},l),t&&i.createElement("div",{className:`${o}__description`},t)))},t.SharingDropdownMenuItem.displayName="SharingDropdownMenuItem"})),define("spectrum-sharing/components/sharing_modal_checkbox_row/index",["require","exports","tslib","spectrum-sharing/components/sharing_modal_checkbox_row/sharing_modal_checkbox_row"],(function(e,t,s,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),s.__exportStar(n,t)})),define("spectrum-sharing/components/sharing_modal_checkbox_row/sharing_modal_checkbox_row",["require","exports","tslib","classnames","react","spectrum/checkbox/index","spectrum/tooltip/index","spectrum/util/uuid_generator"],(function(e,t,s,n,i,a,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SharingModalCheckboxRow=void 0,n=s.__importDefault(n),i=s.__importStar(i);class l extends i.PureComponent{constructor(e){super(e),this.onCheckChanged=e=>{this.props.onCheckChanged("checked"===e)},this.checkboxId=o.generateUUID("scl-sharing-modal-checkbox-row")}render(){const{checked:e,className:t,disabled:s,labelText:o,tooltipData:l}=this.props,d=n.default("scl-sharing-modal-checkbox-row",t,{"scl-sharing-modal-checkbox-row--disabled":s}),c=i.createElement(a.Checkbox,{id:this.checkboxId,checked:e?"checked":"unchecked",disabled:s,onChange:this.onCheckChanged}),h=!(!l||!l.alwaysShow),p=l?i.createElement(r.Tooltip,{className:l.className,tooltipContent:l.content,isShowInitially:h,showOnMouseMove:!h,closeOnBlur:!h,positioning:l.positioning},c):c;return i.createElement("div",{className:d},p,i.createElement("label",{className:"scl-sharing-modal-checkbox-row__label",htmlFor:this.checkboxId},o))}}t.SharingModalCheckboxRow=l,l.displayName="SharingModalCheckboxRow"})),define("spectrum-sharing/components/sharing_modal_contacts_field/index",["require","exports","tslib","spectrum-sharing/components/sharing_modal_contacts_field/sharing_modal_contacts_field"],(function(e,t,s,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),s.__exportStar(n,t)})),define("spectrum-sharing/components/sharing_modal_contacts_field/sharing_modal_contacts_field",["require","exports","tslib","classnames","react","spectrum/dropdown_menu/index","spectrum/tooltip/index","spectrum-sharing/components/sharing_dropdown_menu/index"],(function(e,t,s,n,i,a,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SharingModalContactsField=t.baseClassName=void 0,n=s.__importDefault(n),i=s.__importStar(i),t.baseClassName="scl-sharing-modal-contacts-field";class l extends i.Component{constructor(e){super(e),this.renderDropdown=()=>{const{labelledAccessTypes:e,selectedAccessType:t,showNoEditTooltip:s,noEditText:n}=this.props,l=t?t.label:void 0,d=i.createElement(o.SharingDropdownMenu,{position:"right",onSelection:this.handleChange},i.createElement(o.SharingDropdownMenuButton,{disabled:s},l),i.createElement(a.Menu,null,i.createElement(i.Fragment,null,e.map(e=>i.createElement(o.SharingDropdownMenuItem,{"aria-label":e.ariaLabel,description:e.details,key:e.apiId,label:e.label,selected:t&&t.apiId===e.apiId,value:e.apiId})))));return s?i.createElement(r.Tooltip,{positioning:"below",tooltipContent:n},d):d},this.handleChange=e=>{this.props.onAccessTypeChange&&this.props.onAccessTypeChange(e)}}render(){const{className:e,toLabel:s}=this.props,a=n.default(t.baseClassName,e);return i.createElement("div",{className:a},i.createElement("div",{className:`${t.baseClassName}__left`},i.createElement("div",{className:`${t.baseClassName}__to-label`},s),i.createElement("div",{className:`${t.baseClassName}__input`},this.props.contactsField)),i.createElement("div",{className:`${t.baseClassName}__right`},this.renderDropdown()))}}t.SharingModalContactsField=l,l.displayName="SharingModalContactsField"})),define("spectrum-sharing/components/sharing_modal_footer_inband/index",["require","exports","tslib","spectrum-sharing/components/sharing_modal_footer_inband/sharing_modal_footer_inband"],(function(e,t,s,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),s.__exportStar(n,t)})),define("spectrum-sharing/components/sharing_modal_footer_inband/sharing_modal_footer_inband",["require","exports","tslib","classnames","react","spectrum/button/index"],(function(e,t,s,n,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SharingModalFooterInband=void 0,n=s.__importDefault(n),i=s.__importStar(i);class r extends i.PureComponent{render(){const{className:e,children:t,textButtonShare:s,isButtonShareDisabled:r,onClickButtonShare:o}=this.props,l=n.default("scl-sharing-modal-footer-inband",e,"scl-sharing-modal-footer");return i.createElement("div",{className:l},t,i.createElement("div",{className:"scl-sharing-modal-footer-inband__spacer"}),i.createElement(a.Button,{variant:"primary",className:"scl-sharing-modal-footer-inband__button","aria-label":s,onClick:o,disabled:r},s))}}t.SharingModalFooterInband=r,r.defaultProps={isButtonShareDisabled:!1},r.displayName="SharingModalFooterInband"})),define("spectrum-sharing/components/sharing_modal_footer_link/index",["require","exports","tslib","spectrum-sharing/components/sharing_modal_footer_link/sharing_modal_footer_link","spectrum-sharing/components/sharing_modal_footer_link/sharing_modal_footer_link_create","spectrum-sharing/components/sharing_modal_footer_link/sharing_modal_footer_link_disabled","spectrum-sharing/components/sharing_modal_footer_link/sharing_modal_footer_link_loading","spectrum-sharing/components/sharing_modal_footer_link/sharing_modal_footer_link_options","spectrum-sharing/components/sharing_modal_footer_link/sharing_modal_footer_link_copy"],(function(e,t,s,n,i,a,r,o,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),s.__exportStar(n,t),s.__exportStar(i,t),s.__exportStar(a,t),s.__exportStar(r,t),s.__exportStar(o,t),s.__exportStar(l,t)})),define("spectrum-sharing/components/sharing_modal_footer_link_list/index",["require","exports","tslib","spectrum-sharing/components/sharing_modal_footer_link_list/sharing_modal_footer_link_list"],(function(e,t,s,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),s.__exportStar(n,t)})),define("spectrum-sharing/components/sharing_modal_footer_link_list/sharing_modal_footer_link_list",["require","exports","tslib","classnames","react"],(function(e,t,s,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SharingModalFooterLinkList=t.baseClassName=void 0,n=s.__importDefault(n),i=s.__importStar(i),t.baseClassName="scl-sharing-modal-footer-link-list";class a extends i.PureComponent{render(){const e=n.default(t.baseClassName,this.props.className);return i.createElement("div",{className:e},i.createElement("div",{className:`${t.baseClassName}__header`},i.createElement("div",{className:`${t.baseClassName}__title`},this.props.title),i.createElement("div",{className:`${t.baseClassName}__actions`},this.props.actions)),i.createElement("div",{className:`${t.baseClassName}__items`},this.props.children))}}t.SharingModalFooterLinkList=a,a.displayName="SharingModalFooterLinkList"})),define("spectrum-sharing/components/sharing_modal_footer_link/sharing_modal_footer_link",["require","exports","tslib","classnames","react","spectrum-sharing/components/icons/icon_link"],(function(e,t,s,n,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SharingModalFooterLink=t.baseClassName=void 0,n=s.__importDefault(n),i=s.__importStar(i),t.baseClassName="scl-sharing-modal-footer-link";class r extends i.PureComponent{render(){const e=n.default(t.baseClassName,this.props.className);return i.createElement("div",{className:e},!0!==this.props.isIconHidden&&i.createElement("div",{className:`${t.baseClassName}__icon`},this.props.icon?this.props.icon:i.createElement(a.IconLink,null)),i.createElement("div",{className:`${t.baseClassName}__body`},this.props.body),i.createElement("div",{className:`${t.baseClassName}__actions`},this.props.actions))}}t.SharingModalFooterLink=r,r.displayName="SharingModalFooterLink"})),define("spectrum-sharing/components/sharing_modal_footer_link/sharing_modal_footer_link_copy",["require","exports","tslib","react","classnames","spectrum/button/index","spectrum-sharing/components/icons/icon_link","spectrum-sharing/components/sharing_modal_footer_link/sharing_modal_footer_link"],(function(e,t,s,n,i,a,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SharingModalFooterLinkCopy=void 0,n=s.__importStar(n),i=s.__importDefault(i);t.SharingModalFooterLinkCopy=function(e){const t=i.default(o.baseClassName,`${o.baseClassName}--copy`,e.className);return n.createElement(o.SharingModalFooterLink,{className:t,icon:e.icon?e.icon:n.createElement(r.IconLink,{variant:"active"}),isIconHidden:e.isIconHidden,body:n.createElement("input",Object.assign({readOnly:!0,autoFocus:!0,value:e.sharedLinkUrl,onClick:l,onFocus:l,"aria-label":e.labelSharedLinkUrl,ref:e.textInputRef},e.inputProps)),actions:n.createElement(a.Button,{variant:"borderless",onClick:e.onClickButton},e.textButton)})};const l=e=>{e.currentTarget.select()}})),define("spectrum-sharing/components/sharing_modal_footer_link/sharing_modal_footer_link_create",["require","exports","tslib","react","spectrum/button/index","spectrum-sharing/components/sharing_modal_footer_link/sharing_modal_footer_link"],(function(e,t,s,n,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SharingModalFooterLinkCreate=void 0,n=s.__importStar(n);t.SharingModalFooterLinkCreate=e=>n.createElement(a.SharingModalFooterLink,{className:e.className,icon:e.icon,body:e.statusNoLinkCreated,actions:n.createElement(i.Button,{variant:"borderless",onClick:e.onClickButtonCreateLink},e.textButtonCreateLink)})})),define("spectrum-sharing/components/sharing_modal_footer_link/sharing_modal_footer_link_disabled",["require","exports","tslib","react","spectrum-sharing/components/sharing_modal_footer_link/sharing_modal_footer_link"],(function(e,t,s,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SharingModalFooterLinkDisabled=void 0,n=s.__importStar(n);t.SharingModalFooterLinkDisabled=e=>n.createElement(i.SharingModalFooterLink,{className:e.className,icon:e.icon,body:n.createElement("div",null,e.statusDisabledLink)})})),define("spectrum-sharing/components/sharing_modal_footer_link/sharing_modal_footer_link_loading",["require","exports","tslib","classnames","react","spectrum-sharing/components/scooter_loader/index","spectrum-sharing/components/sharing_modal_footer_link/sharing_modal_footer_link"],(function(e,t,s,n,i,a,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SharingModalFooterLinkLoading=void 0,n=s.__importDefault(n),i=s.__importStar(i);t.SharingModalFooterLinkLoading=e=>{const t=n.default(r.baseClassName,`${r.baseClassName}--loading`,e.className);return i.createElement(r.SharingModalFooterLink,{className:t,icon:e.icon,body:i.createElement("div",{className:`${r.baseClassName}--loading-body`},i.createElement("span",null,e.statusCreatingLink),i.createElement(a.ScooterLoader,null))})}})),define("spectrum-sharing/components/sharing_modal_footer_link/sharing_modal_footer_link_options",["require","exports","tslib","react","spectrum/button/index","spectrum-sharing/components/sharing_modal_footer_link/sharing_modal_footer_link","spectrum-sharing/components/icons/icon_link"],(function(e,t,s,n,i,a,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SharingModalFooterLinkOptions=void 0,n=s.__importStar(n);t.SharingModalFooterLinkOptions=e=>n.createElement(a.SharingModalFooterLink,{className:e.className,icon:e.icon?e.icon:n.createElement(r.IconLink,{variant:"active"}),body:e.statusLinkCreated,actions:n.createElement("div",null,n.createElement(i.Button,{key:"settings",variant:"borderless",onClick:e.onClickButtonLinkSettings},e.textButtonLinkSettings),n.createElement("span",{key:"separator",className:"scl-sharing-modal-footer-link__sep"},"•"),n.createElement(i.Button,{className:e.buttonCopyClassName,key:"copy",variant:"borderless",onClick:e.onClickButtonCopyLink},e.textButtonCopyLink))})})),define("spectrum-sharing/components/sharing_modal_header/index",["require","exports","tslib","spectrum-sharing/components/sharing_modal_header/sharing_modal_header","spectrum-sharing/components/sharing_modal_header/sharing_modal_header_title","spectrum-sharing/components/sharing_modal_header/sharing_modal_header_input","spectrum-sharing/components/sharing_modal_header/sharing_modal_header_with_back_button"],(function(e,t,s,n,i,a,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),s.__exportStar(n,t),s.__exportStar(i,t),s.__exportStar(a,t),s.__exportStar(r,t)})),define("spectrum-sharing/components/sharing_modal_header/sharing_modal_header",["require","exports","tslib","classnames","react","spectrum/button/index","spectrum/icon_form/index","spectrum-sharing/components/icons/icon_settings_gear"],(function(e,t,s,n,i,a,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SharingModalHeader=t.baseClassName=void 0,n=s.__importDefault(n),i=s.__importStar(i),t.baseClassName="scl-sharing-modal-header";class l extends i.PureComponent{render(){const{children:e,className:s,closeButtonVisible:a,icon:r,settingsButtonVisible:o}=this.props,l=n.default(t.baseClassName,s);return i.createElement("div",{className:l},i.createElement("div",{className:`${t.baseClassName}__icon`},r),i.createElement("div",{className:`${t.baseClassName}__children`},e),o&&this.renderSettingsButton(),a&&this.renderCloseButton())}renderSettingsButton(){return i.createElement(a.Button,{"aria-label":"settings",className:`${t.baseClassName}__settings`,onClick:this.props.onClickSettingsButton,variant:"styleless"},i.createElement(o.IconSettingsGear,null))}renderCloseButton(){return i.createElement(a.Button,{"aria-label":"close",className:`${t.baseClassName}__close`,onClick:this.props.onClickCloseButton,variant:"styleless"},i.createElement(r.IconForm,{name:"cancel"}))}}t.SharingModalHeader=l,l.defaultProps={closeButtonVisible:!1,settingsButtonVisible:!1},l.displayName="SharingModalHeader"})),define("spectrum-sharing/components/sharing_modal_header/sharing_modal_header_input",["require","exports","tslib","react","spectrum-sharing/components/input/index","spectrum-sharing/components/sharing_modal_header/sharing_modal_header"],(function(e,t,s,n,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SharingModalHeaderInput=void 0,n=s.__importStar(n);class r extends n.PureComponent{constructor(){super(...arguments),this.setInputRef=e=>{this.input=e}}render(){const e=this.props,{inputAriaLabel:t,inputAutoFocus:r,inputPlaceholder:o,onInputBlur:l,onInputChange:d,onInputFocus:c,onInputKeyUp:h}=e,p=s.__rest(e,["inputAriaLabel","inputAutoFocus","inputPlaceholder","onInputBlur","onInputChange","onInputFocus","onInputKeyUp"]);return n.createElement(a.SharingModalHeader,Object.assign({closeButtonVisible:!0},p),n.createElement(i.Input,{ref:this.setInputRef,className:`${a.baseClassName}__input`,variant:"borderless","aria-label":t,autoFocus:r,onChange:d,onFocus:c,onBlur:l,onKeyUp:h,placeholder:o}),this.props.children)}}t.SharingModalHeaderInput=r,r.displayName="SharingModalHeaderInput"})),define("spectrum-sharing/components/sharing_modal_header/sharing_modal_header_title",["require","exports","tslib","react","spectrum-sharing/components/sharing_modal_header/sharing_modal_header"],(function(e,t,s,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SharingModalHeaderTitle=void 0,n=s.__importStar(n);class a extends n.PureComponent{render(){const e=this.props,{title:t,subTitle:a}=e,r=s.__rest(e,["title","subTitle"]);return n.createElement(i.SharingModalHeader,Object.assign({},r),n.createElement("div",{className:`${i.baseClassName}__title`},t),a&&n.createElement("div",{className:`${i.baseClassName}__sub-title`},a))}}t.SharingModalHeaderTitle=a,a.displayName="SharingModalHeaderTitle"})),define("spectrum-sharing/components/sharing_modal_header/sharing_modal_header_with_back_button",["require","exports","tslib","react","spectrum-sharing/components/back_button/index","dig-components/icons/src","spectrum-sharing/components/sharing_modal_header/sharing_modal_header"],(function(e,t,s,n,i,a,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SharingModalHeaderWithBackButton=void 0,n=s.__importStar(n);class o extends n.PureComponent{render(){const e=`${r.baseClassName}--with-back-button`;return n.createElement(r.SharingModalHeader,Object.assign({className:e},this.props),n.createElement(i.BackButton,{autoFocus:this.props.autoFocus,onBackButtonClick:this.props.onClickBackButton,label:this.props.label,icon:a.ChevronLeftLine}))}}t.SharingModalHeaderWithBackButton=o,o.displayName="SharingModalHeaderWithBackButton"})),define("spectrum-sharing/components/sharing_modal_message_field/index",["require","exports","tslib","spectrum-sharing/components/sharing_modal_message_field/sharing_modal_message_field"],(function(e,t,s,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),s.__exportStar(n,t)})),define("spectrum-sharing/components/sharing_modal_message_field/sharing_modal_message_field",["require","exports","tslib","classnames","react"],(function(e,t,s,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SharingModalMessageField=void 0,n=s.__importDefault(n),i=s.__importStar(i);class a extends i.PureComponent{render(){const{className:e,children:t,onChange:s,value:a,placeholder:r}=this.props,o=n.default("scl-sharing-modal-message-field",e);return i.createElement("div",{className:o},i.createElement("textarea",{"aria-label":r,className:"scl-textarea",placeholder:r,onChange:s,value:a}),t)}}t.SharingModalMessageField=a,a.displayName="SharingModalMessageField"})),define("spectrum-sharing/components/sharing_modal_settings_row/index",["require","exports","tslib","spectrum-sharing/components/sharing_modal_settings_row/sharing_modal_settings_row"],(function(e,t,s,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),s.__exportStar(n,t)})),define("spectrum-sharing/components/sharing_modal_settings_row/sharing_modal_settings_row",["require","exports","tslib","classnames","react"],(function(e,t,s,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SharingModalSettingsRow=void 0,n=s.__importDefault(n),i=s.__importStar(i);class a extends i.PureComponent{constructor(){super(...arguments),this.handleLinkClicked=e=>{e.preventDefault(),this.props.descriptionLinkOnClicked&&this.props.descriptionLinkUrl&&this.props.descriptionLinkOnClicked(this.props.descriptionLinkUrl)}}render(){const{className:e,rightSideElement:t,bottomElement:s}=this.props,a=n.default("scl-sharing-modal-settings-row",e);return i.createElement("div",{className:a},i.createElement("div",{className:"scl-sharing-modal-settings-row-outer"},i.createElement("div",{className:"scl-sharing-modal-settings-row-info"},i.createElement("div",{className:"scl-sharing-modal-settings-row-display-name"},i.createElement("span",{className:"scl-sharing-modal-settings-row-info-display-name-title",title:this.props.displayNameTitle},this.props.displayName)),i.createElement("div",{className:"scl-sharing-modal-settings-row-details"},i.createElement("span",{className:"scl-sharing-modal-settings-row-details-span",title:this.props.description},this.props.description,this.props.descriptionLinkUrl&&this.props.descriptionLinkText&&i.createElement("span",null," ",i.createElement("a",{className:"scl-sharing-modal-settings-row-description-link",href:"#",onClick:this.handleLinkClicked},this.props.descriptionLinkText))))),t&&i.createElement("div",{className:"scl-sharing-modal-settings-right-element"},t)),s&&i.createElement("div",{className:"scl-sharing-modal-settings-bottom-element"},s))}}t.SharingModalSettingsRow=a,a.displayName="SharingModalSettingsRow"})),define("spectrum-sharing/components/sharing_modal_downgrade_banner/index",["require","exports","tslib","spectrum-sharing/components/sharing_modal_downgrade_banner/sharing_modal_downgrade_banner"],(function(e,t,s,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),s.__exportStar(n,t)})),define("spectrum-sharing/components/sharing_modal_downgrade_banner/sharing_modal_downgrade_banner",["require","exports","tslib","react","dig-components/buttons","dig-components/icons","dig-components/icons/src","dig-components/typography"],(function(e,t,s,n,i,a,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SharingModalDowngradeBanner=void 0,n=s.__importStar(n);const l="scl-sharing-modal-downgrade-banner";class d extends n.PureComponent{render(){const{subheader:e,header:t,onClickOutlineButton:s,onClickTransparentButton:a,outlineButtonLabel:r,transparentButtonLabel:d,showCloseButton:c}=this.props;return n.createElement("div",{className:`${l} dig-Theme---VIS`},n.createElement("div",{className:`${l}__header`},n.createElement(o.Text,{isBold:!0,size:"large"},t),c&&this.renderCloseButton()),n.createElement("div",{className:`${l}__subheader`},n.createElement(o.Text,null,e)),n.createElement("div",{className:`${l}__buttons`},n.createElement(i.Button,{variant:"outline",onClick:s},r),n.createElement(i.Button,{variant:"transparent",onClick:a},d)))}renderCloseButton(){return n.createElement(i.IconButton,{variant:"transparent","aria-label":"close",className:`${l}__close`,onClick:this.props.onClickCloseButton,size:"standard"},n.createElement(a.UIIcon,{src:r.CloseLine}))}}t.SharingModalDowngradeBanner=d,d.displayName="SharingModalDowngradeBanner"})),define("spectrum-sharing/share_modal/sharing_settings/restricted_visibility_banner",["require","exports","tslib","react","spectrum-sharing/utils/sharing_constants","spectrum-sharing/utils/em_string","spectrum-sharing/components/sharing_modal_banner/index","spectrum-sharing/share_modal/sharing_settings/utils/link_metadata_types"],(function(e,t,s,n,i,a,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RestrictedVisibilityBanner=void 0,n=s.__importStar(n),i=s.__importStar(i);class l extends n.Component{render(){const e=this.props.linkPermissions.resolved_visibility,t=this.props.linkPermissions.audience_options[0].disallowed_reason;return t!==o.LinkAudienceDisallowedReason.RestrictedBySharedFolder&&t!==o.LinkAudienceDisallowedReason.DeleteAndRecreate?null:n.createElement(r.SharingModalBanner,{className:"sharing-settings-modal__banner",type:"default",message:n.createElement("span",null,n.createElement("span",{className:"shared-link-settings-modal__audience-disallowed-text"},this.audienceDisallowedText(e))," ",n.createElement("span",{className:"shared-link-settings-modal__audience-disallowed-advice u-font-meta"},this.audienceDisallowedAdviceText(t)))})}audienceDisallowedText(e){if(e===o.ResolvedVisibilityPolicy.shared_folder_only){let e=this.props.linkPermissions.restricting_shared_folder_path;return e=a.Emstring.em_snippet(e,i.SNIPPET_SIZES.FILENAME),this.props.intl.formatMessage({id:"Wzk4tW",defaultMessage:"Only members of the shared folder “{shared_folder_name}” can view this link."},{shared_folder_name:e})}return e===o.ResolvedVisibilityPolicy.only_you?this.props.intl.formatMessage({id:"kp9e20",defaultMessage:"Only you can view this link."}):void 0}audienceDisallowedAdviceText(e){return e===o.LinkAudienceDisallowedReason.RestrictedBySharedFolder?this.props.intl.formatMessage({id:"D2VN2I",defaultMessage:"To change who can access the link, go to the shared folder options."}):e===o.LinkAudienceDisallowedReason.DeleteAndRecreate?this.props.intl.formatMessage({id:"HbDkss",defaultMessage:"To change who can access the link, delete this link and create a new one."}):void 0}}t.RestrictedVisibilityBanner=l,l.displayName="RestrictedVisibilityBanner"})),define("spectrum-sharing/share_modal/sharing_settings/sharing_settings_dropdown",["require","exports","tslib","react","spectrum/dropdown_menu/index","spectrum/dropdown_menu/index","spectrum-sharing/components/sharing_dropdown_menu/index"],(function(e,t,s,n,i,a,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SettingDropdown=void 0,n=s.__importStar(n);class o extends n.Component{constructor(){super(...arguments),this.handleSelection=e=>{this.props.onValueSelected(e)}}render(){return n.createElement(r.SharingDropdownMenu,{disabled:this.props.disabled,onSelection:this.handleSelection,position:"right"},this.renderButton(),n.createElement(a.Menu,null,n.createElement(n.Fragment,null,this.renderMenuItems())))}renderButton(){return n.createElement(i.DropdownMenuButton,{className:"sharing-settings-dropdown__button",disabled:this.props.disabled},this.props.optionsDict[this.props.currentValue].label)}renderMenuItems(){return this.props.valuesList.map(e=>n.createElement(r.SharingDropdownMenuItem,{key:e,value:e,label:this.props.optionsDict[e].label,description:this.props.optionsDict[e].description,selected:e===this.props.currentValue}))}}t.SettingDropdown=o,o.displayName="SettingDropdown"})),define("spectrum-sharing/share_modal/sharing_settings/sharing_settings_audience",["require","exports","tslib","react","spectrum-sharing/share_modal/sharing_settings/utils/sharing_settings_constants","spectrum-sharing/share_modal/sharing_settings/sharing_settings_dropdown","spectrum-sharing/share_modal/sharing_settings/sharing_settings_policy_view","spectrum-sharing/share_modal/sharing_settings/sharing_settings_password","spectrum-sharing/share_modal/sharing_settings/restricted_visibility_banner","spectrum-sharing/share_modal/sharing_settings/utils/sharing_settings_util","spectrum-sharing/utils/sharing_util"],(function(e,t,s,n,i,a,r,o,l,d,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SharingSettingsAudience=t.AudienceDropdown=void 0,n=s.__importStar(n);function h(e){const s="password"===e.linkPolicy.audience;return n.createElement("div",null,n.createElement(t.AudienceDropdown,Object.assign({},e)),s&&n.createElement(o.PasswordInput,Object.assign({},e)))}t.AudienceDropdown=e=>{const{linkPermissions:t,linkPolicy:s,getPolicyDict:r,onPolicyUpdate:o}=e,l=s.audience||"",h=t.audience_options.filter(e=>!((e,t)=>"public"===e&&d.isPasswordPolicyEnforcedByAdmin(t)&&!c.isRighteousLink(t))(e.audience,t)&&e.allowed).map(e=>e.audience),p=r(i.AUDIENCE),u=h.length>1;return n.createElement(a.SettingDropdown,{currentValue:l,valuesList:h,optionsDict:p.optionsDict,onValueSelected:e=>{const n={audience:e};(function(e,t,s,n){if(d.isExternalAudience(e)){if(d.isExpirationPolicySetByAdmin(t)){const e=new Date,i=new Date(e.getFullYear(),e.getMonth(),e.getDate()+d.daysExpirationPolicyToNumber[t.days_to_expire_policy]);(!s.expires||s.expires>i)&&(n.expires=i,n.display_expiration_warning=!0)}d.isPasswordPolicyEnforcedByAdmin(t)&&!s.require_password&&(n.require_password=!0,"public"===e&&(n.display_password_warning=!0))}else n.display_expiration_warning=!1,n.display_password_warning=!1})(e,t,s,n),o(n)},disabled:!u||e.readOnlyPolicy})},t.SharingSettingsAudience=function(e){const{intl:t,linkPermissions:s}=e;let a;s.audience_options.filter(e=>e.allowed).length>1||(a=n.createElement(l.RestrictedVisibilityBanner,{intl:t,linkPermissions:s}));const o=e.getPolicyDict(i.AUDIENCE),d=n.createElement(h,Object.assign({},e));return n.createElement(r.SettingPolicyRow,{policyName:i.AUDIENCE,policyDict:o,selector:d,extra:a})}})),define("spectrum-sharing/share_modal/sharing_settings/sharing_settings_password",["require","exports","tslib","react","spectrum/input/index","spectrum-sharing/share_modal/sharing_settings/sharing_settings_policy_view","spectrum-sharing/share_modal/sharing_settings/utils/sharing_settings_constants","spectrum-sharing/share_modal/sharing_settings/utils/sharing_settings_util"],(function(e,t,s,n,i,a,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SharingSettingsPassword=t.PasswordInput=void 0,n=s.__importStar(n);const l=(e,t)=>o.isPasswordPolicyEnforcedByAdmin(e)&&o.isExternalAudience(t);function d(e,t){return t.link_password||""===t.link_password?t.link_password:o.hasLinkPassword(e)?"123456":""}t.PasswordInput=e=>{const{intl:t,linkPolicy:s,linkPermissions:a,onPolicyUpdate:r}=e;return n.createElement(i.Input,{role:"textbox",autoFocus:!0,className:"password-input__input sharing-settings-modal__input",disabled:!o.canModifyPassword(a)||e.readOnlyPolicy,placeholder:t.formatMessage({id:"um5odk",defaultMessage:"Set password"}),name:"link_password",onChange:e=>{r({[e.target.name]:e.target.value})},type:"password",variant:s.link_password?"default":"invalid",value:d(a,s)})},t.SharingSettingsPassword=e=>{const{getPolicyDict:s,linkPolicy:i}=e,d=s(r.REQUIRE_PASSWORD),c=n.createElement("div",null,(e=>{const{linkPolicy:t,linkPermissions:s,getPolicyDict:i,onPolicyUpdate:d}=e,c=i(r.REQUIRE_PASSWORD).optionsDict,h=t.require_password?"enabled":"disabled";return n.createElement(a.SettingsToggle,{currentValue:h,optionsDict:c,onOptionChange:(e,t)=>{d({require_password:e})},disabled:!o.canTogglePassword(s)||l(s,t.audience)||e.readOnlyPolicy})})(e),(i.require_password||l(e.linkPermissions,i.audience)&&!e.readOnlyPolicy)&&n.createElement(t.PasswordInput,Object.assign({},e)));return n.createElement(a.SettingPolicyRow,{policyName:r.REQUIRE_PASSWORD,policyDict:d,selector:c})}})),define("spectrum-sharing/share_modal/sharing_settings/sharing_settings_expire",["require","exports","tslib","react","spectrum/datepicker/index","spectrum-sharing/utils/datetime_util","spectrum-sharing/share_modal/sharing_settings/sharing_settings_policy_view","spectrum-sharing/share_modal/sharing_settings/utils/sharing_settings_util","spectrum-sharing/share_modal/sharing_settings/utils/sharing_settings_constants"],(function(e,t,s,n,i,a,r,o,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SharingSettingsExpire=void 0,n=s.__importStar(n);const d=e=>{const{linkMetadata:t,linkPolicy:s}=e,n=new Date;let i=void 0;if(o.isExternalAudience(s.audience)){const{days_to_expire_policy:e}=t.link_permissions;o.isExpirationPolicyEnforcedByAdmin(t.link_permissions)&&(i=new Date(n.getFullYear(),n.getMonth(),n.getDate()+o.daysExpirationPolicyToNumber[e]))}return{before:new Date(n.getFullYear(),n.getMonth(),n.getDate()+1),after:i}},c=e=>{const{intl:t,linkMetadata:s,linkPolicy:r,onPolicyUpdate:l}=e;return n.createElement(i.DatepickerInput,{disabled:!o.canModifyExpire(s)||e.readOnlyPolicy,disabledDays:d(e),selectedDay:r.expires,onDayClick:e=>{l({expires:e,display_expiration_warning:!1})},placeholder:t.formatMessage({id:"J5Qx8E",defaultMessage:"mm/dd/yyyy"}),localization:a.getDatePickerLocalization(t)})},h=e=>{const{linkPolicy:t,linkMetadata:s,getPolicyDict:i,onPolicyUpdate:d}=e,c=i(l.EXPIRES),h=null!=e.linkPolicy.expires?"enabled":"disabled",{days_to_expire_policy:u}=s.link_permissions;return n.createElement(r.SettingsToggle,{currentValue:h,optionsDict:c.optionsDict,onOptionChange:(e,n)=>{let i=null;e&&(i=t.expires,t.expires||(i=a.daysAfterToday(o.isExternalAudience(t.audience)&&o.isExpirationPolicySetByAdmin(s.link_permissions)?o.daysExpirationPolicyToNumber[u]:30))),d({expires:i,display_expiration_warning:!1})},disabled:p(s,t)||e.readOnlyPolicy})},p=(e,t)=>!o.canToggleExpire(e)||o.isExternalAudience(t.audience)&&o.isExpirationPolicyEnforcedByAdmin(e.link_permissions);t.SharingSettingsExpire=e=>{const t=e.getPolicyDict(l.EXPIRES),s=t=>{t&&t.expires instanceof Date&&(t.expires.setHours(23),t.expires.setMinutes(59),t.expires.setSeconds(59)),e.onPolicyUpdate(t)},i=null!=e.linkPolicy.expires,a=n.createElement(h,Object.assign({},e,{onPolicyUpdate:s})),o=n.createElement("div",null,a,i&&n.createElement(c,Object.assign({},e,{onPolicyUpdate:s})));return n.createElement(r.SettingPolicyRow,{policyName:l.EXPIRES,policyDict:t,selector:o})}})),define("spectrum-sharing/share_modal/sharing_settings/sharing_settings_download",["require","exports","tslib","react","spectrum-sharing/share_modal/sharing_settings/utils/sharing_settings_constants","spectrum-sharing/components/sharing_modal_banner/index","spectrum-sharing/share_modal/sharing_settings/sharing_settings_policy_view"],(function(e,t,s,n,i,a,r){"use strict";function o(e){return Boolean(e&&e.allow_download?e.can_disallow_download:e.can_allow_download)}Object.defineProperty(t,"__esModule",{value:!0}),t.SharingSettingsDownload=t.DisableDownloadsBanner=void 0,n=s.__importStar(n),t.DisableDownloadsBanner=e=>{const{intl:t,linkPolicy:s,linkPermissions:i}=e;return!s.allow_download&&i.can_disallow_download?n.createElement(a.SharingModalBanner,{className:"sharing-settings-modal__banner",type:"warn",message:t.formatMessage({id:"+EZZAD",defaultMessage:"This applies only within Dropbox."})}):null};const l=e=>{const{linkPolicy:t,onPolicyUpdate:s,getPolicyDict:a,linkPermissions:l}=e,d=t.allow_download?"disabled":"enabled",c=a(i.ALLOW_DOWNLOAD);return n.createElement(r.SettingsToggle,{currentValue:d,optionsDict:c.optionsDict,onOptionChange:(e,t)=>{s(i.ALLOW_DOWNLOAD,!e)},disabled:!o(l)||e.readOnlyPolicy})};t.SharingSettingsDownload=e=>{const t=e.getPolicyDict(i.ALLOW_DOWNLOAD),s=e.isEditFolderLink?void 0:n.createElement(l,Object.assign({},e)),a=e.isEditFolderLink?"setting-disabled":"";return n.createElement(r.SettingPolicyRow,{policyName:i.ALLOW_DOWNLOAD,policyDict:t,selector:s,onLinkClicked:e.onLinkClicked,extra:e.banner,className:a})}})),define("spectrum-sharing/share_modal/sharing_settings/sharing_settings_policy_view",["require","exports","tslib","react","spectrum/toggle/index","spectrum-sharing/components/sharing_modal_settings_row/index"],(function(e,t,s,n,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SettingsToggle=t.SettingPolicyRow=void 0,n=s.__importStar(n),t.SettingPolicyRow=e=>{const{policyName:t,policyDict:s,selector:i,onLinkClicked:r,extra:o,className:l}=e;return n.createElement(a.SharingModalSettingsRow,{policyFieldName:t,key:s.title,displayName:s.title,displayNameTitle:s.title,description:s.description,descriptionLinkUrl:s.descriptionLinkUrl,descriptionLinkText:s.descriptionLinkText,descriptionLinkOnClicked:r,rightSideElement:i,bottomElement:o,className:l})},t.SettingsToggle=e=>{const{currentValue:t,optionsDict:s,onOptionChange:a,disabled:r}=e,o=r?(e,t)=>{}:a;return n.createElement(i.Toggle,{ariaLabel:s[t].label,className:"sharing-settings-modal__toggle",labelContent:s[t].label,checked:s[t].value,interactive:!r,disabled:r,onCheckedChange:o})}})),define("spectrum-sharing/components/sharing_avatar_initials/index",["require","exports","tslib","spectrum-sharing/components/sharing_avatar_initials/sharing_avatar_initials"],(function(e,t,s,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),s.__exportStar(n,t)})),define("spectrum-sharing/components/sharing_avatar_initials/sharing_avatar_initials",["require","exports","tslib","classnames","react"],(function(e,t,s,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SharingAvatarInitials=void 0,n=s.__importDefault(n),i=s.__importStar(i),t.SharingAvatarInitials=e=>{var{children:t,className:a,backgroundColor:r,avatarSize:o=32,variant:l,shape:d}=e,c=s.__rest(e,["children","className","backgroundColor","avatarSize","variant","shape"]);const h=n.default(`scl-sharing-avatar-initials-${o}-${d}`,{"scl-avatar-text-inactive":"inactive"===l,"scl-sharing-avatar-text":!0},a),p={background:`${r}`,border:`1px solid ${r}`,borderRadius:"square"===d?"12%":"50%",height:`${o}px`,width:`${o}px`};return i.createElement("div",Object.assign({className:h,style:p},c),t)},t.SharingAvatarInitials.displayName="SharingAvatarInitials"})),define("spectrum-sharing/components/sharing_menu/index",["require","exports","tslib","spectrum-sharing/components/sharing_menu/sharing_menu","spectrum-sharing/components/sharing_menu/sharing_menu_item"],(function(e,t,s,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),s.__exportStar(n,t),s.__exportStar(i,t)})),define("spectrum-sharing/components/sharing_menu/sharing_menu",["require","exports","tslib","react","classnames","spectrum/dropdown_menu/index"],(function(e,t,s,n,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SharingMenu=void 0,n=s.__importStar(n),i=s.__importDefault(i),t.SharingMenu=e=>{var{className:t}=e,r=s.__rest(e,["className"]);const o=i.default(t,"scl-sharing-menu");return n.createElement(a.Menu,Object.assign({className:o},r))},t.SharingMenu.displayName="SharingMenu"})),define("spectrum-sharing/components/sharing_menu/sharing_menu_item",["require","exports","tslib","classnames","react","spectrum/dropdown_menu/index","spectrum-sharing/components/icons/icon_dropdown_selected"],(function(e,t,s,n,i,a,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SharingMenuItem=void 0,n=s.__importDefault(n),i=s.__importStar(i);t.SharingMenuItem=e=>{var{value:t,label:o,description:l,selected:d,variant:c="default"}=e,h=s.__rest(e,["value","label","description","selected","variant"]);return i.createElement(a.MenuItem,Object.assign({className:n.default({"scl-sharing-menu-item-border":"border"===c}),key:t,value:t,text:o,selected:d},h),d&&i.createElement(r.IconDropdownSelectedBlue,{className:"scl-sharing-menu-item-selected-icon"}),i.createElement("div",{className:n.default("scl-sharing-menu-item-wrapper",{"scl-sharing-menu-item-wrapper-selected":d})},i.createElement("div",{className:n.default("scl-sharing-menu-item-label",{"scl-sharing-menu-item-label-default":"default"===c,"scl-sharing-menu-item-label-red":"red"===c})},o),i.createElement("div",{className:"scl-sharing-menu-item-description"},l)))}})),define("spectrum-sharing/components/sharing_portal_dropdown/index",["require","exports","tslib","spectrum-sharing/components/sharing_portal_dropdown/sharing_portal_dropdown"],(function(e,t,s,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),s.__exportStar(n,t)})),define("spectrum-sharing/components/sharing_portal_dropdown/sharing_portal_dropdown",["require","exports","tslib","classnames","react","react-dom","react-aria-menubutton","spectrum/util/uuid_generator","spectrum/positioned_portal/index","spectrum/button/index","spectrum-sharing/components/icons/icon_dropdown_caret","spectrum-sharing/components/sharing_menu/index"],(function(e,t,s,n,i,a,r,o,l,d,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SharingPortalDropdown=void 0,n=s.__importDefault(n),i=s.__importStar(i),a=s.__importStar(a);class p extends i.PureComponent{constructor(e){super(e),this.dropdownId=o.generateUUID("portalDropdown"),this.handleResizeEvent=()=>{this.state.isOpen&&this.resolvePortalPosition()},this.handleScrollEvent=()=>{this.state.isOpen&&this.resolvePortalPosition()},this.onMenuToggle=({isOpen:e})=>{e||this.positionedPortalEl.hidePortal(),this.setState({isOpen:e})},this.handlePortalDidShow=()=>{r.openMenu(this.dropdownId,{focusMenu:!0})},this.state={isOpen:!1}}componentDidUpdate(e,t){this.state.isOpen&&this.positionedPortalEl?(this.mountListeners(),this.resolvePortalPosition()):this.positionedPortalEl&&this.unMountListeners()}componentWillUnmount(){this.unMountListeners()}mountListeners(){document.addEventListener("scroll",this.handleScrollEvent,!1),window.addEventListener("resize",this.handleResizeEvent,!1)}unMountListeners(){document.removeEventListener("scroll",this.handleScrollEvent,!1),window.removeEventListener("resize",this.handleResizeEvent,!1)}resolvePortalPosition(){if(this.positionedPortalEl&&this.positionedPortalEl.portalInstance.portalContentElementRef){const e=a.findDOMNode(this.positionedPortalEl);if(!(e instanceof Element))throw new Error("Unable to find PositionedPortal DOM node - check if this SharingPortalDropdown is still mounted");{const t=e.getElementsByClassName("scl-sharing-portal-dropdown-button");if(!t.length)throw new Error("Unable to find SharingPortalDropdownButton - check if this SharingPortalDropdown is still mounted");{const e=t[0],s=this.positionedPortalEl.portalInstance.portalContentElementRef,n=e.getBoundingClientRect(),i=s.getBoundingClientRect(),a=10;let r={top:0,left:0};r=n.bottom+i.height>window.innerHeight?{top:n.top-i.height-a,left:n.left+n.width-i.width}:{top:n.top+n.height+a,left:n.left+n.width-i.width},s.style.top=r.top+"px",s.style.left=r.left+"px"}}}}render(){const{optionGroup:e,onSelection:t}=this.props;return i.createElement(l.PositionedPortal,{closeOnBlur:!1,ref:e=>this.positionedPortalEl=e,renderContent:()=>i.createElement(r.Wrapper,{id:this.dropdownId,onSelection:t,onMenuToggle:this.onMenuToggle},i.createElement(r.Button,{className:"scl-sharing-portal-dropdown-button-invisible"},e.label),i.createElement(h.SharingMenu,{className:"scl-sharing-portal-menu"},i.createElement(i.Fragment,null,e.options.map(t=>i.createElement(h.SharingMenuItem,{description:t.tooltip,key:t.apiId,label:t.label,selected:e.selectedApiId===t.apiId,value:t.apiId,variant:t.variant,disabled:t.disabled}))))),role:"sharing-dropdown",showOnMouseMove:!1,showOnClick:!0,onDidShow:this.handlePortalDidShow},i.createElement(d.Button,{className:n.default("scl-sharing-portal-dropdown-button",{"scl-sharing-portal-dropdown-button-expanded":this.state.isOpen}),variant:"styleless"},e.label,(()=>this.state.isOpen?i.createElement(c.IconDropdownCaretBlueWeb,{className:"scl-sharing-portal-dropdown-icon scl-sharing-portal-dropdown-icon-web"}):i.createElement(c.IconDropdownCaretWeb,{className:"scl-sharing-portal-dropdown-icon scl-sharing-portal-dropdown-icon-web"}))()))}}t.SharingPortalDropdown=p,p.displayName="SharingPortalDropdown"})),define("spectrum-sharing/components/info_box/index",["require","exports","tslib","spectrum-sharing/components/info_box/info_box"],(function(e,t,s,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),s.__exportStar(n,t)})),define("spectrum-sharing/components/info_box/info_box",["require","exports","tslib","react","dig-components/typography"],(function(e,t,s,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InfoBox=void 0,n=s.__importStar(n);class a extends n.Component{componentDidMount(){setTimeout(()=>{(new Image).src=this.props.imgPath},200)}render(){const{imgPath:e,imgAlt:t,title:s,message:a}=this.props;return n.createElement("div",{className:"scl-info-box"},n.createElement("img",{src:e,className:"scl-info-box__img",alt:t}),n.createElement("div",{className:"scl-info-box__text"},n.createElement(i.Title,{size:"small",isBold:!0},s),n.createElement(i.Text,{size:"small"},a)))}}t.InfoBox=a,a.displayName="InfoBox"})),define("spectrum-sharing/components/banner/index",["require","exports","tslib","spectrum-sharing/components/banner/banner"],(function(e,t,s,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),s.__exportStar(n,t)})),define("spectrum-sharing/components/banner/banner",["require","exports","tslib","classnames","react"],(function(e,t,s,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Banner=t.baseClassName=void 0,n=s.__importDefault(n),i=s.__importStar(i),t.baseClassName="scl-banner";class a extends i.PureComponent{render(){const{variant:e="default",className:s,showTopCaret:a,children:r}=this.props,o=n.default(t.baseClassName,s,{"scl-banner--transparent-left":"transparent-left"===e});return i.createElement("div",{className:o},a&&i.createElement("div",{className:t.baseClassName+"__caret-up"}),i.createElement("div",{className:t.baseClassName+"__container"},r))}}t.Banner=a,a.displayName="Banner"})),define("spectrum-sharing/utils/index",["require","exports","tslib","spectrum-sharing/utils/contacts_tokenizer/index","spectrum-sharing/utils/logging"],(function(e,t,s,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),s.__exportStar(n,t),s.__exportStar(i,t)})),define("spectrum-sharing/utils/datetime_util",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formatDateToString=t.daysAfterToday=t.getDatePickerLocalization=t.DAY_OF_WEEK_BY_LOCALE=t.DOW_MONDAY=t.DOW_SUNDAY=void 0,t.DOW_SUNDAY=0,t.DOW_MONDAY=1,t.DAY_OF_WEEK_BY_LOCALE={"da-DK":t.DOW_MONDAY,de:t.DOW_MONDAY,en:t.DOW_SUNDAY,"en-US":t.DOW_SUNDAY,"en-GB":t.DOW_MONDAY,es:t.DOW_MONDAY,"es-ES":t.DOW_MONDAY,fr:t.DOW_MONDAY,id:t.DOW_SUNDAY,it:t.DOW_MONDAY,ja:t.DOW_SUNDAY,ko:t.DOW_MONDAY,ms:t.DOW_MONDAY,"nb-NO":t.DOW_MONDAY,"nl-NL":t.DOW_MONDAY,pl:t.DOW_MONDAY,"pt-BR":t.DOW_SUNDAY,ru:t.DOW_MONDAY,"sv-SE":t.DOW_MONDAY,"th-TH":t.DOW_MONDAY,"uk-UA":t.DOW_MONDAY,"zh-CN":t.DOW_MONDAY,"zh-TW":t.DOW_MONDAY},t.getDatePickerLocalization=e=>{const s=t.DAY_OF_WEEK_BY_LOCALE[e.locale];return{firstDayOfWeek:void 0===s?t.DOW_MONDAY:s,months:[e.formatDate(new Date(2019,0,1),{month:"long"}),e.formatDate(new Date(2019,1,1),{month:"long"}),e.formatDate(new Date(2019,2,1),{month:"long"}),e.formatDate(new Date(2019,3,1),{month:"long"}),e.formatDate(new Date(2019,4,1),{month:"long"}),e.formatDate(new Date(2019,5,1),{month:"long"}),e.formatDate(new Date(2019,6,1),{month:"long"}),e.formatDate(new Date(2019,7,1),{month:"long"}),e.formatDate(new Date(2019,8,1),{month:"long"}),e.formatDate(new Date(2019,9,1),{month:"long"}),e.formatDate(new Date(2019,10,1),{month:"long"}),e.formatDate(new Date(2019,11,1),{month:"long"})],weekdaysLong:[e.formatDate(new Date(2019,8,1),{weekday:"long"}),e.formatDate(new Date(2019,8,2),{weekday:"long"}),e.formatDate(new Date(2019,8,3),{weekday:"long"}),e.formatDate(new Date(2019,8,4),{weekday:"long"}),e.formatDate(new Date(2019,8,5),{weekday:"long"}),e.formatDate(new Date(2019,8,6),{weekday:"long"}),e.formatDate(new Date(2019,8,7),{weekday:"long"})],weekdaysShort:[e.formatDate(new Date(2019,8,1),{weekday:"narrow"}),e.formatDate(new Date(2019,8,2),{weekday:"narrow"}),e.formatDate(new Date(2019,8,3),{weekday:"narrow"}),e.formatDate(new Date(2019,8,4),{weekday:"narrow"}),e.formatDate(new Date(2019,8,5),{weekday:"narrow"}),e.formatDate(new Date(2019,8,6),{weekday:"narrow"}),e.formatDate(new Date(2019,8,7),{weekday:"narrow"})]}};t.daysAfterToday=e=>{const t=new Date;return t.setHours(0),t.setMinutes(0),t.setSeconds(0),t.setMilliseconds(0),((e,t,s,n,i,a)=>(null==t&&(t=0),null==s&&(s=0),null==n&&(n=0),null==i&&(i=0),null==a&&(a=0),e.setFullYear(e.getFullYear()+t),e.setMonth(e.getMonth()+s),e.setDate(e.getDate()+n),e.setHours(e.getHours()+i),e.setMinutes(e.getMinutes()+a),e))(t,0,0,e)},t.formatDateToString=e=>e.toISOString().split(".")[0]+"Z"})),define("spectrum-sharing/utils/em_string",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Emstring=void 0;class s{constructor(e){if(!(this instanceof s))return new s(e);this.s=e,this.info=this.widthInfo(),this.length=e.length?this.info[this.s.length-1]:0}static initClass(){this.ACCURACY=2,this.CODEPOINT_TO_WIDTH={32:38,33:25,34:42,35:67,36:58,37:92,38:75,39:25,40:33,41:33,42:58,43:58,44:25,45:33,46:25,47:42,48:58,49:58,50:58,51:58,52:58,53:58,54:58,55:58,56:58,57:58,58:25,59:25,60:58,61:58,62:58,63:50,64:100,65:67,66:67,67:67,68:75,69:58,70:58,71:75,72:83,73:33,74:25,75:67,76:58,77:100,78:83,79:83,80:67,81:83,82:67,83:58,84:58,85:75,86:67,87:100,88:67,89:58,90:58,91:33,92:42,93:33,94:58,95:50,96:67,97:58,98:67,99:50,100:67,101:58,102:33,103:58,104:67,105:25,106:25,107:58,108:25,109:100,110:67,111:67,112:67,113:67,114:42,115:50,116:42,117:67,118:58,119:83,120:58,121:58,122:50,123:42,124:58,125:42,126:58,161:25,162:58,163:58,164:58,165:58,166:58,167:58,168:67,169:92,170:42,171:50,172:58,174:92,175:58,176:50,177:58,178:42,179:42,180:67,181:67,182:75,183:25,184:25,185:42,186:42,187:50,188:83,189:83,190:83,191:50,192:67,193:67,194:67,195:67,196:67,197:67,198:92,199:67,200:58,201:58,202:58,203:58,204:33,205:33,206:33,207:33,208:75,209:83,210:83,211:83,212:83,213:83,214:83,215:58,216:83,217:75,218:75,219:75,220:75,221:58,222:67,223:67,224:58,225:58,226:58,227:58,228:58,229:58,230:92,231:50,232:58,233:58,234:58,235:58,236:25,237:25,238:25,239:25,240:67,241:67,242:67,243:67,244:67,245:67,246:67,247:58,248:67,249:67,250:67,251:67,252:67,253:58,254:67,255:58,256:75,257:67,258:75,259:67,260:75,261:67,262:75,263:58,264:75,265:58,266:75,267:58,268:75,269:58,270:83,271:83,272:83,273:75,274:67,275:67,276:67,277:67,278:67,279:67,280:67,281:67,282:67,283:67,284:83,285:75,286:83,287:75,288:83,289:75,290:83,291:75,292:83,293:75,294:92,295:75,296:33,297:33,298:33,299:33,300:33,301:33,302:33,303:33,304:33,305:25,306:67,307:67,308:42,309:33,310:75,311:67,312:67,313:58,314:33,315:58,316:33,317:58,318:42,319:58,320:50,321:67,322:42,323:83,324:75,325:83,326:75,327:83,328:75,329:83,330:83,331:75,332:92,333:67,334:92,335:67,336:92,337:67,338:100,339:100,340:75,341:50,342:75,343:50,344:75,345:50,346:67,347:58,348:67,349:58,350:67,351:58,352:67,353:58,354:75,355:42,356:75,357:42,358:75,359:42,360:83,361:75,362:83,363:75,364:83,365:75,366:83,367:75,368:83,369:75,370:83,371:75,372:100,373:92,374:75,375:58,376:75,377:67,378:67,379:67,380:67,381:67,382:67,383:42,384:75,385:83,386:67,387:75,388:75,389:67,390:75,391:83,392:58,393:83,394:100,395:67,396:75,397:67,398:67,399:75,400:58,401:58,402:75,403:83,404:75,405:100,406:50,407:50,408:75,409:67,410:50,411:67,412:117,413:83,414:75,415:92,416:92,417:75,418:117,419:100,420:75,421:75,422:75,423:67,424:58,425:67,426:58,427:42,428:75,429:42,430:75,431:83,432:75,433:92,434:83,435:75,436:75,437:67,438:67,439:67,440:67,441:58,442:58,443:75,444:75,445:58,446:50,447:67,448:33,449:50,450:50,451:33,452:142,453:142,454:133,455:100,456:92,457:67,458:117,459:117,460:100,461:75,462:67,463:33,464:33,465:92,466:67,467:83,468:75,469:83,470:75,471:83,472:75,473:83,474:75,475:83,476:75,477:67,478:75,479:67,480:75,481:67,482:100,483:100,484:92,485:75,486:83,487:75,488:75,489:67,490:92,491:67,492:92,493:67,494:67,495:58,496:33,497:142,498:142,499:133,500:83,501:75,502:117,503:67,504:83,505:75,506:75,507:67,508:100,509:100,510:92,511:67,512:75,513:67,514:75,515:67,516:67,517:67,518:67,519:67,520:33,521:33,522:33,523:33,524:92,525:67,526:92,527:67,528:75,529:50,530:75,531:50,532:83,533:75,534:83,535:75,536:67,537:58,538:75,539:42,540:58,541:58,542:83,543:75,544:83,545:100,546:92,547:67,548:67,549:67,550:75,551:67,552:67,553:67,554:92,555:67,556:92,557:67,558:92,559:67,560:92,561:67,562:75,563:58,564:67,565:100,566:67,567:33,568:100,569:100,570:75,571:75,572:58,573:58,574:67,575:58,576:58,577:67,578:50,579:75,580:75,581:75,582:75,583:58,584:58,585:25,586:83,587:58,588:75,589:33,590:75,591:58,880:67,881:50,882:67,883:50,884:33,885:33,886:75,887:67,888:108,889:108,890:67,891:58,892:58,893:58,894:42,895:108,896:108,897:108,898:108,899:108,900:67,901:67,902:75,903:42,904:83,905:100,906:58,907:108,908:100,909:108,910:100,911:100,912:42,913:75,914:67,915:58,916:83,917:67,918:67,919:83,920:92,921:33,922:75,923:75,924:100,925:83,926:75,927:92,928:83,929:67,930:108,931:67,932:75,933:75,934:83,935:75,936:83,937:92,938:33,939:75,940:83,941:58,942:75,943:42,944:67,945:83,946:67,947:67,948:67,949:58,950:75,951:75,952:67,953:42,954:67,955:67,956:75,957:67,958:67,959:67,960:92,961:67,962:67,963:75,964:67,965:67,966:92,967:67,968:92,969:100,970:42,971:67,972:67,973:67,974:100,975:108,976:58,977:75,978:75,979:100,980:75,981:92,982:100,983:67,984:92,985:67,986:75,987:58,988:58,989:58,990:67,991:58,992:75,993:92,994:100,995:92,996:75,997:58,998:75,999:58,1e3:75,1001:75,1002:67,1003:67,1004:83,1005:58,1006:50,1007:42,1008:67,1009:67,1010:58,1011:33,1012:92,1013:58,1014:58,1015:67,1016:67,1017:75,1018:100,1019:83,1020:58,1021:75,1022:75,1023:75,1024:67,1025:67,1026:92,1027:58,1028:75,1029:67,1030:33,1031:33,1032:42,1033:108,1034:108,1035:83,1036:75,1037:83,1038:75,1039:83,1040:75,1041:67,1042:67,1043:58,1044:83,1045:67,1046:92,1047:67,1048:83,1049:83,1050:75,1051:83,1052:100,1053:83,1054:92,1055:83,1056:67,1057:75,1058:75,1059:75,1060:83,1061:75,1062:83,1063:75,1064:108,1065:108,1066:75,1067:92,1068:67,1069:75,1070:108,1071:75,1072:67,1073:67,1074:58,1075:58,1076:75,1077:67,1078:83,1079:58,1080:75,1081:75,1082:67,1083:67,1084:83,1085:75,1086:67,1087:75,1088:75,1089:58,1090:58,1091:58,1092:92,1093:67,1094:75,1095:58,1096:92,1097:100,1098:67,1099:83,1100:58,1101:58,1102:92,1103:58,1104:67,1105:67,1106:75,1107:58,1108:58,1109:58,1110:33,1111:33,1112:42,1113:92,1114:92,1115:75,1116:67,1117:75,1118:58,1119:75,1120:100,1121:75,1122:75,1123:67,1124:83,1125:83,1126:75,1127:67,1128:100,1129:92,1130:92,1131:83,1132:117,1133:108,1134:67,1135:67,1136:83,1137:83,1138:92,1139:67,1140:83,1141:67,1142:83,1143:67,1144:133,1145:125,1146:92,1147:67,1148:100,1149:75,1150:100,1151:75,1152:75,1153:58,1154:75,1155:0,1156:0,1157:0,1158:0,1159:108,1160:0,1161:0,1162:83,1163:75,1164:67,1165:58,1166:67,1167:75,1168:58,1169:58,1170:67,1171:58,1172:75,1173:67,1174:100,1175:92,1176:67,1177:58,1178:75,1179:67,1180:83,1181:75,1182:75,1183:67,1184:83,1185:75,1186:83,1187:75,1188:100,1189:83,1190:117,1191:100,1192:92,1193:75,1194:75,1195:58,1196:75,1197:58,1198:75,1199:58,1200:75,1201:58,1202:75,1203:75,1204:100,1205:83,1206:75,1207:67,1208:75,1209:67,1210:75,1211:58,1212:92,1213:75,1214:92,1215:75,1216:33,1217:92,1218:83,1219:75,1220:67,1221:83,1222:67,1223:83,1224:75,1225:83,1226:75,1227:75,1228:58,1229:100,1230:83,1231:25,1232:75,1233:67,1234:75,1235:67,1236:100,1237:100,1238:67,1239:67,1240:75,1241:67,1242:75,1243:67,1244:92,1245:83,1246:67,1247:58,1248:67,1249:58,1250:83,1251:75,1252:83,1253:75,1254:92,1255:67,1256:92,1257:67,1258:92,1259:67,1260:75,1261:58,1262:75,1263:58,1264:75,1265:58,1266:75,1267:58,1268:75,1269:58,1270:58,1271:42,1272:92,1273:83,1274:58,1275:42,1276:75,1277:58,1278:75,1279:58,2026:67,19977:108,65403:58},this._ELLIPSIS_LENGTH=new s("…").length}static em_snippet(e,t,n){return null==t&&(t=50),null==n&&(n=.75),new s(e.toString()).snippet(t,n).toString()}widthInfo(){const e={"-1":0};for(let t=0,s=this.s.length,n=0<=s;n?t<s:t>s;n?t++:t--)e[t]=e[t-1]+this.ems(this.s.charAt(t));return e}findSpot(e){let t;if(!e)return 0;let s=0,n=this.s.length;for(;s<=n;){t=Math.floor(s/2+n/2);const i=this.info[t-1];if(i>e)n=t-1;else{if(!(i<e))return t;s=t+1}}return s>t?s:t}ems(e){const t=e.charCodeAt(0),n=s.CODEPOINT_TO_WIDTH[t];return n?n/Math.pow(10,s.ACCURACY):768<=t&&t<=879?0:65377<=t&&t<=65500?.58:11904<=t&&t<=40911||44032<=t&&t<=55215||4352<=t&&t<=4607||63744<=t&&t<=64255||65280<=t&&t<=65535||131072<=t&&t<=196607?1.08:.65}substr(e,t){const n=this.findSpot(e);if(null!=t){let i=this.findSpot(e+t);if(i-n<this.s.length){const e=this.s.charCodeAt(i-n);65024<=e&&e<=65039&&i--}return new s(this.s.substr(n,i-n))}return new s(this.s.substr(n))}toString(){return this.s}snippet(e=50,t=.75){if(this.length<=e)return this;const n=(e-=s._ELLIPSIS_LENGTH)*t,i=e-n,a=this.length-i,r=this.substr(0,n),o=this.substr(a);return new s(r.toString()+"…"+o.toString())}}t.Emstring=s,s.initClass()})),define("spectrum-sharing/utils/contacts_tokenizer/index",["require","exports","tslib","spectrum-sharing/utils/contacts_tokenizer/contacts_tokenizer_util"],(function(e,t,s,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),s.__exportStar(n,t)})),define("spectrum-sharing/utils/contacts_tokenizer/contacts_tokenizer_util",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ContactsTokenizer=void 0;const s=/['&A-Za-z0-9\._%+-]+@[A-Za-z0-9-][A-Za-z0-9\.-]*\.[A-Za-z]{2,15}/gi,n=/[,|;>]+/;t.ContactsTokenizer=e=>({tokenizeAllRawInputs(t){const s=this.tokenizeValidRawInputs(t);return s.length>0?s:[e.buildFromRawEmail(t)]},tokenizeValidRawInputs:t=>(t.match(s)||[]).map(e.buildFromRawEmail),tokenizeDelimitedInputs(e){return n.test(e)?this.tokenizeValidRawInputs(e):[]}})})),define("spectrum-sharing/share_modal/sharing_settings/utils/index",["require","exports","tslib","spectrum-sharing/share_modal/sharing_settings/utils/sharing_settings_constants","spectrum-sharing/share_modal/sharing_settings/utils/sharing_settings_link_policies","spectrum-sharing/share_modal/sharing_settings/utils/link_metadata_types","spectrum-sharing/share_modal/sharing_settings/utils/sharing_settings_util"],(function(e,t,s,n,i,a,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),s.__exportStar(n,t),s.__exportStar(i,t),s.__exportStar(a,t),s.__exportStar(r,t)})),define("spectrum-sharing/share_modal/sharing_settings/utils/sharing_settings_constants",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VIEW_LINK_SETTINGS=t.EDIT_LINK_SETTINGS=t.FOLDER_SETTINGS=t.FILE_SETTINGS=t.TEXT=t.TOGGLE=t.DROPDOWN=t.ACL_UPDATE_POLICY=t.DISPLAY_EXPIRATION_WARNING=t.REQUIRE_PASSWORD=t.AUDIENCE=t.REQUESTED_VISIBILITY=t.ALLOW_DOWNLOAD=t.EXPIRES=t.FOLDER_LINK_AUDIENCE_POLICY=t.ACCESS_LEVEL_POLICY=t.VIEWER_INFO_POLICY=t.MEMBER_POLICY=void 0,t.MEMBER_POLICY="member_policy",t.VIEWER_INFO_POLICY="viewer_info_policy",t.ACCESS_LEVEL_POLICY="access_level",t.FOLDER_LINK_AUDIENCE_POLICY="shared_link_policy",t.EXPIRES="expires",t.ALLOW_DOWNLOAD="allow_download",t.REQUESTED_VISIBILITY="requested_visibility",t.AUDIENCE="audience",t.REQUIRE_PASSWORD="require_password",t.DISPLAY_EXPIRATION_WARNING="display_expiration_warning",t.ACL_UPDATE_POLICY="acl_update_policy",t.DROPDOWN="dropdown",t.TOGGLE="toggle",t.TEXT="text",t.FILE_SETTINGS="file_settings",t.FOLDER_SETTINGS="folder_settings",t.EDIT_LINK_SETTINGS="edit_link_settings",t.VIEW_LINK_SETTINGS="view_link_settings"})),define("spectrum-sharing/share_modal/sharing_settings/utils/sharing_settings_link_policies",["require","exports","spectrum-sharing/share_modal/sharing_settings/utils/sharing_settings_constants"],(function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SharingSettingsLinkPolicies=void 0,t.SharingSettingsLinkPolicies=e=>({getShmodelInMultipleLinksPolicyDict(t,n){switch(t){case s.AUDIENCE:return{title:e.formatMessage({id:"uCVAxq",defaultMessage:"Who has access"}),description:n?e.formatMessage({id:"4HZCOQ",defaultMessage:"Control who can view the folder with this link."}):e.formatMessage({id:"xb28qW",defaultMessage:"Control who can view the file with this link."}),optionsDict:{public:{label:e.formatMessage({id:"JWcJZ7",defaultMessage:"Anyone with link"}),description:n?e.formatMessage({id:"ysL13U",defaultMessage:"Anyone with this link can view the folder."}):e.formatMessage({id:"oxZeg7",defaultMessage:"Anyone with this link can view the file."})},team:{label:e.formatMessage({id:"i9dq7T",defaultMessage:"Team members"}),description:n?e.formatMessage({id:"AvhnVi",defaultMessage:"Team members with this link can view the folder."}):e.formatMessage({id:"YTZEp1",defaultMessage:"Team members with this link can view the file."})},password:{label:e.formatMessage({id:"DDCDRp",defaultMessage:"People with password"}),description:n?e.formatMessage({id:"uos+ms",defaultMessage:"Password protect this link for viewing the folder."}):e.formatMessage({id:"oPivFQ",defaultMessage:"Password protect this link for viewing the file."})},no_one:{label:e.formatMessage({id:"kuFRq0",defaultMessage:"Only people invited"}),description:e.formatMessage({id:"+ZBQS4",defaultMessage:"The link is off and does not grant additional access to anyone."})}},type:s.DROPDOWN};case s.EXPIRES:return{title:e.formatMessage({id:"HIIRnD",defaultMessage:"Expiration"}),description:e.formatMessage({id:"92TP40",defaultMessage:"Disable this link on a specific date."}),optionsDict:{enabled:{label:e.formatMessage({id:"J8zY2i",defaultMessage:"On"}),value:!0},disabled:{label:e.formatMessage({id:"w6dVgn",defaultMessage:"Off"}),value:!1}},type:s.TOGGLE};case s.ALLOW_DOWNLOAD:return{title:e.formatMessage({id:"d8lth0",defaultMessage:"Disable downloads"}),description:e.formatMessage({id:"B5ygR1",defaultMessage:"Prevent people with this link from downloading."}),descriptionLinkUrl:"/help/files-folders/set-link-permissions",descriptionLinkText:e.formatMessage({id:"gk12sS",defaultMessage:"Learn more"}),optionsDict:{enabled:{label:e.formatMessage({id:"47AlCD",defaultMessage:"On"}),value:!0},disabled:{label:e.formatMessage({id:"0oEiHx",defaultMessage:"Off"}),value:!1}},type:s.TOGGLE};default:throw new Error("Policy name not found")}},getRLPolicyDict(t,n,i){const a="editor"===n;switch(t){case s.AUDIENCE:return{title:e.formatMessage({id:"uCVAxq",defaultMessage:"Who has access"}),description:a?i?e.formatMessage({id:"inMOXx",defaultMessage:"Control who can edit the folder with this link."}):e.formatMessage({id:"/1cHLH",defaultMessage:"Control who can edit the file with this link."}):e.formatMessage({id:"xb28qW",defaultMessage:"Control who can view the file with this link."}),optionsDict:{public:{label:e.formatMessage({id:"JWcJZ7",defaultMessage:"Anyone with link"}),description:a?i?e.formatMessage({id:"w/+tle",defaultMessage:"Anyone with this link can edit the folder."}):e.formatMessage({id:"a3Sd0R",defaultMessage:"Anyone with this link can edit the file."}):e.formatMessage({id:"oxZeg7",defaultMessage:"Anyone with this link can view the file."})},team:{label:e.formatMessage({id:"i9dq7T",defaultMessage:"Team members"}),description:a?i?e.formatMessage({id:"qUcOUf",defaultMessage:"Team members with this link can edit the folder."}):e.formatMessage({id:"dyCqAa",defaultMessage:"Team members with this link can edit the file."}):e.formatMessage({id:"YTZEp1",defaultMessage:"Team members with this link can view the file."})},no_one:{label:e.formatMessage({id:"kuFRq0",defaultMessage:"Only people invited"}),description:e.formatMessage({id:"+ZBQS4",defaultMessage:"The link is off and does not grant additional access to anyone."})}},type:s.DROPDOWN};case s.REQUIRE_PASSWORD:return{title:e.formatMessage({id:"8stY8L",defaultMessage:"Require password"}),description:i?e.formatMessage({id:"1Syz7Y",defaultMessage:"Set a password to limit access to the folder via link."}):e.formatMessage({id:"AH/PXS",defaultMessage:"Set a password to limit access to the file via link."}),optionsDict:{enabled:{label:e.formatMessage({id:"oUP+qL",defaultMessage:"On"}),value:!0},disabled:{label:e.formatMessage({id:"h58mvf",defaultMessage:"Off"}),value:!1}},type:s.TOGGLE};case s.ALLOW_DOWNLOAD:{const t=a&&i;return{title:e.formatMessage({id:"d8lth0",defaultMessage:"Disable downloads"}),description:t?e.formatMessage({id:"RQ2sAU",defaultMessage:"To disable downloads, share the link for viewing."}):e.formatMessage({id:"B5ygR1",defaultMessage:"Prevent people with this link from downloading."}),descriptionLinkUrl:"/help/files-folders/set-link-permissions",descriptionLinkText:t?void 0:e.formatMessage({id:"gk12sS",defaultMessage:"Learn more"}),optionsDict:{enabled:{label:e.formatMessage({id:"47AlCD",defaultMessage:"On"}),value:!0},disabled:{label:e.formatMessage({id:"0oEiHx",defaultMessage:"Off"}),value:!1}},type:s.TOGGLE}}case s.EXPIRES:return{title:e.formatMessage({id:"HIIRnD",defaultMessage:"Expiration"}),description:e.formatMessage({id:"92TP40",defaultMessage:"Disable this link on a specific date."}),optionsDict:{enabled:{label:e.formatMessage({id:"J8zY2i",defaultMessage:"On"}),value:!0},disabled:{label:e.formatMessage({id:"w6dVgn",defaultMessage:"Off"}),value:!1}},type:s.TOGGLE};default:throw new Error("Policy name not found")}}})})),define("spectrum-sharing/share_modal/sharing_settings/utils/sharing_settings_util",["require","exports","spectrum-sharing/share_modal/sharing_settings/utils/link_metadata_types","spectrum-sharing/utils/datetime_util"],(function(e,t,s,n){"use strict";function i(e){return e.requested_visibility===s.RequestedVisibilityPolicy.password||e.require_password}function a(e){return e.audience_options.filter(e=>"password"===e.audience&&e.allowed).length>0}function r(e){if(e.effective_audience)return e.effective_audience;switch(e.resolved_visibility){case"public":case"password":case"no_one":return e.resolved_visibility;case"team_only":return"team";case"team_and_password":return"password";case"shared_folder_only":case"only_you":return"no_one"}}function o(e){return["public","password"].includes(e)}function l(e){return!!e.days_to_expire_policy&&"none"!==e.days_to_expire_policy}function d(e){return!!e.enforce_shared_link_password_policy&&"required"===e.enforce_shared_link_password_policy}function c(e){return l(e)&&!!e.change_shared_link_expiration_policy&&"not_allowed"===e.change_shared_link_expiration_policy}function h(e,t){return o(e.audience)&&(!e.expires&&c(t)||!i(t)&&d(t))}Object.defineProperty(t,"__esModule",{value:!0}),t.canCreateLink=t.getLinkControlPolicyWarningText=t.isReadOnlyPolicy=t.isExpirationPolicyEnforcedByAdmin=t.isPasswordPolicyEnforcedByAdmin=t.isExpirationPolicySetByAdmin=t.isExternalAudience=t.daysExpirationPolicyToFormattedString=t.daysExpirationPolicyToNumber=t.SharingSettingsUtil=t.getAudienceForLink=t.canModifyExpire=t.canToggleExpire=t.canModifyPassword=t.canChangeShmodelPassword=t.canTogglePassword=t.hasLinkPassword=void 0,t.hasLinkPassword=i,t.canTogglePassword=function(e){return Boolean(e&&e.require_password?e.can_remove_password:e.can_set_password)||a(e)},t.canChangeShmodelPassword=a,t.canModifyPassword=function(e){return Boolean(e&&e.can_set_password)||a(e)},t.canToggleExpire=function(e){const t=e.link_permissions;return Boolean(null!=e.expires?t.can_remove_expiry:t.can_set_expiry)},t.canModifyExpire=function(e){const t=e.link_permissions;return Boolean(t.can_set_expiry)},t.getAudienceForLink=r,t.SharingSettingsUtil=e=>({getLinkPolicy:e=>({link_password:i(e.link_permissions)?void 0:"",expires:e.expires,allow_download:e.link_permissions.allow_download,audience:r(e.link_permissions),require_password:e.link_permissions.require_password}),getModifiedSettings:(t,s,i)=>{if(s===i)return;const a={},r=null!=t.expires&&null==s.expires;if(s.audience!==i.audience&&(a.audience=s.audience),s.allow_download!==i.allow_download&&(a.allow_download=s.allow_download),s.expires&&t.link_permissions.can_set_expiry&&(a.expires=n.formatDateToString(s.expires)),s.require_password!==i.require_password&&(a.require_password=s.require_password),"password"===s.audience||s.require_password)if(s.link_password)a.require_password=!0,a.link_password=s.link_password;else if(""===s.link_password)return{error:e.formatMessage({id:"wFrAfD",defaultMessage:"Password can’t be empty"})};return Object.keys(a).length<=0&&!r?void 0:{url:t.url,settings:a,remove_expiration:r}}}),t.daysExpirationPolicyToNumber={day_1:1,day_3:3,day_7:7,day_30:30,day_90:90,day_180:180,year_1:365},t.daysExpirationPolicyToFormattedString={day_1:"1 day",day_3:"3 days",day_7:"7 days",day_30:"30 days",day_90:"90 days",day_180:"180 days",year_1:"1 year"},t.isExternalAudience=o,t.isExpirationPolicySetByAdmin=l,t.isPasswordPolicyEnforcedByAdmin=d,t.isExpirationPolicyEnforcedByAdmin=c,t.isReadOnlyPolicy=h,t.getLinkControlPolicyWarningText=function(e,s,n,i){let a="";const r="allowed"===n.change_shared_link_expiration_policy?" You can change or remove this expiration.":"";if(h(e,n)){const e=c(n),t=d(n);a=i.formatMessage({id:"RKcgo5",defaultMessage:"Your admin requires {requirements} for links shared outside the team. To change the link setting, delete the link and create it again."},{requirements:e&&t?"an expiration and a password":t?"a password":"an expiration"})}else s.display_expiration_warning&&s.display_password_warning?a=i.formatMessage({id:"DhK9nV",defaultMessage:"Your admin requires a password and has set an expiration for all links shared outside the team. This link will expire in {days_to_expire}.{changeExpirationAllowed}"},{days_to_expire:t.daysExpirationPolicyToFormattedString[n.days_to_expire_policy],changeExpirationAllowed:r}):s.display_expiration_warning?a=i.formatMessage({id:"6AZ9fF",defaultMessage:"Your admin has set an expiration for all links shared outside the team. This link will expire in {days_to_expire}.{changeExpirationAllowed}"},{days_to_expire:t.daysExpirationPolicyToFormattedString[n.days_to_expire_policy],changeExpirationAllowed:r}):s.display_password_warning&&(a=i.formatMessage({id:"lcVbzE",defaultMessage:"Your admin requires to set a password for links shared outside the team."}));return a},t.canCreateLink=function(e,t,s,n,i,a,r,o,l,d){switch(e){case"editor":return s?a&&r&&!n&&!i:!n&&d;case"viewer":return t?l:!n&&l||o;default:return!1}}})),define("spectrum-sharing/share_modal/sharing_settings/utils/link_metadata_types",["require","exports"],(function(e,t){"use strict";var s;Object.defineProperty(t,"__esModule",{value:!0}),t.LinkAudienceDisallowedReason=t.ResolvedVisibilityPolicy=t.RequestedVisibilityPolicy=void 0,t.RequestedVisibilityPolicy={policy_name:"requested_visibility",password:"password",public:"public",team_only:"team_only"},t.ResolvedVisibilityPolicy={policy_name:"resolved_visibility",only_you:"only_you",password:"password",public:"public",shared_folder_only:"shared_folder_only",team_and_password:"team_and_password",team_only:"team_only",no_one:"no_one"},(s=t.LinkAudienceDisallowedReason||(t.LinkAudienceDisallowedReason={})).DeleteAndRecreate="delete_and_recreate",s.RestrictedBySharedFolder="restricted_by_shared_folder",s.RestrictedByTeam="restricted_by_team",s.UserAccountType="user_account_type",s.UserNotOnTeam="user_not_on_team",s.PermissionDenied="permission_denied"})),define("spectrum-sharing/share_modal_evolution/copy_link/copy_link_education_tooltip",["require","exports","tslib","react","dig-components/tooltips","spectrum-sharing/share_modal_evolution/utils/link_description"],(function(e,t,s,n,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CopyLinkEducationTooltip=t.baseClassName=void 0,n=s.__importStar(n),t.baseClassName="scl-copy-link-education-tooltip";class r extends n.Component{render(){return this.shouldRenderCopyLinkEducationTooltip()?n.createElement(i.Tooltip,{triggerRef:this.props.linkRef,placement:"top",className:t.baseClassName,title:this.renderLinkSettingsTooltipContent()},this.props.children):this.props.children}renderLinkSettingsTooltipContent(){const e=a.getLinkDescriptions(this.props.intl,this.props.sharedLink),t=e.length;return n.createElement(n.Fragment,null,a.getCopyLinkEducationTooltipTitle(this.props.intl),t>1?this.renderListOfSettings(e):this.renderOneSetting(e))}renderOneSetting(e){return n.createElement(n.Fragment,null," ",n.createElement("span",null,e[0]))}renderListOfSettings(e){const t=[];return e.forEach(e=>{t.push(n.createElement("li",null,e))}),n.createElement(n.Fragment,null,n.createElement("ul",null,t))}shouldRenderCopyLinkEducationTooltip(){return a.getLinkDescriptions(this.props.intl,this.props.sharedLink).length>0}}t.CopyLinkEducationTooltip=r,r.displayName="CopyLinkEducationTooltip"})),define("spectrum-sharing/share_modal_evolution/utils/link_description",["require","exports","spectrum-sharing/share_modal/sharing_settings/utils/index"],(function(e,t,s){"use strict";function n(e){return e.formatMessage({id:"K/i5x+",defaultMessage:"Password required"})}function i(e){return e.formatMessage({id:"KjJiVt",defaultMessage:"Download disabled"})}function a(e,t){const s=r(t);return e.formatMessage({id:"fp7TGs",defaultMessage:"{count, plural, one{Expires in a day} other{Expires in {count} days}}"},{count:s})}function r(e){const t=e.expires?e.expires.getTime():0;if(null!=e.expires){let e=t-(new Date).getTime();return e<0&&(e=0),Math.floor(e/864e5)}return-1}Object.defineProperty(t,"__esModule",{value:!0}),t.daysTilExpires=t.getLinkDescriptions=t.getExpirationEnabledText=t.getDownloadDisabledText=t.getPasswordRequiredText=t.getRestrictionsApplyText=t.getModifyText=t.getCopyLinkEducationTooltipTitle=void 0,t.getCopyLinkEducationTooltipTitle=function(e){return e.formatMessage({id:"LLktNG",defaultMessage:"Link settings:"})},t.getModifyText=function(e){return e.formatMessage({id:"BypDcT",defaultMessage:"Modify"})},t.getRestrictionsApplyText=function(e){return e.formatMessage({id:"RVzGyv",defaultMessage:"Restrictions apply"})},t.getPasswordRequiredText=n,t.getDownloadDisabledText=i,t.getExpirationEnabledText=a,t.getLinkDescriptions=function(e,t){const r=[],o=s.getAudienceForLink(t.link_permissions),l=t.link_permissions.require_password||"password"===o,d=t.expires,c=!t.link_permissions.allow_download;return l&&r.push(n(e)),d&&r.push(a(e,t)),c&&r.push(i(e)),r},t.daysTilExpires=r})),define("spectrum/icon_acl/index",["require","exports","tslib","react","spectrum/icon_templates/stateless/index","spectrum/svg_icon_bundle/index","spectrum/icon_acl/bundle"],(function(e,t,s,n,i,a,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IconAcl=t.ICONS=void 0,n=s.__importStar(n),Object.defineProperty(t,"ICONS",{enumerable:!0,get:function(){return r.ICONS}}),t.IconAcl=e=>{const{name:t}=e,s=n.createElement(a.SvgIconBundle,{focusable:"false",icon:r.ICONS[t]});return n.createElement(i.Component,Object.assign({icon:s},e))},t.IconAcl.displayName="IconAcl"})),define("spectrum/icon_acl/bundle",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ICONS=void 0,t.ICONS=JSON.parse('\n    {"link-edit":{"attrs":{"width":"32","height":"32","viewBox":"0 0 32 32"},"dangerouslySetInnerIconHtml":"<path fill-rule=\\"evenodd\\" clip-rule=\\"evenodd\\" d=\\"M19.9 9.17l1.377-1.377a1 1 0 0 1 1.415 0l1.364 1.364a1 1 0 0 1 0 1.414l-1.377 1.377L19.9 9.17zM9.653 19.415l9.193-9.192 2.779 2.779-9.193 9.192-2.779-2.779zM8.6 20.441l2.778 2.779-3.219 1.073a.5.5 0 0 1-.632-.633L8.6 20.441z\\" fill=\\"#000\\"></path>"},"link-small":{"attrs":{"width":"24","height":"24","viewBox":"0 0 24 24"},"dangerouslySetInnerIconHtml":"<g fill=\\"none\\" fill-rule=\\"evenodd\\"><path d=\\"M5 12c0-1.657 1.347-3 2.997-3h3.006A3 3 0 0 1 14 12v3H7.997A3 3 0 0 1 5 12zm1.5 0c0 .834.672 1.5 1.5 1.5h1.5V15H14v-2.5h-1.5v-.505c0-.818-.67-1.495-1.499-1.495H8c-.834 0-1.499.672-1.499 1.5z\\" fill=\\"#637282\\"></path><path d=\\"M19 12c0 1.657-1.347 3-2.997 3h-3.006A3 3 0 0 1 10 12V9h6.003A3 3 0 0 1 19 12zm-1.5 0c0-.834-.672-1.5-1.5-1.5h-1.5V9H10v2.5h1.5v.505c0 .818.67 1.495 1.499 1.495H16c.834 0 1.499-.672 1.499-1.5z\\" fill=\\"#637282\\"></path></g>"},"link-view":{"attrs":{"width":"32","height":"32","viewBox":"0 0 32 32"},"dangerouslySetInnerIconHtml":"<path fill-rule=\\"evenodd\\" clip-rule=\\"evenodd\\" d=\\"M16 22c3.524 0 6.612-2.572 8.324-4.348a2.354 2.354 0 0 0 0-3.304C22.612 12.572 19.524 10 16 10s-6.612 2.572-8.324 4.348a2.354 2.354 0 0 0 0 3.304C9.388 19.428 12.476 22 16 22zm0-2c2.153 0 3.899-1.79 3.899-4S18.153 12 16 12s-3.899 1.79-3.899 4 1.746 4 3.899 4z\\" fill=\\"#000\\"></path><path fill-rule=\\"evenodd\\" clip-rule=\\"evenodd\\" d=\\"M16 18.5c1.346 0 2.437-1.12 2.437-2.5S17.346 13.5 16 13.5c-1.346 0-2.437 1.12-2.437 2.5s1.091 2.5 2.437 2.5z\\" fill=\\"#000\\"></path>"},"link":{"attrs":{"width":"32","height":"32","viewBox":"0 0 32 32"},"dangerouslySetInnerIconHtml":"<g fill=\\"none\\" fill-rule=\\"evenodd\\"><g fill=\\"#637282\\"><path d=\\"M6 16c0-2.21 1.794-4 4.007-4h4.986A4.006 4.006 0 0 1 19 16v4h-8.993A4.006 4.006 0 0 1 6 16zm2 0c0 1.112.898 2 2.005 2H13v2h6v-3h-2v-.999c0-1.1-.894-2.001-1.997-2.001H9.997A2 2 0 0 0 8 16z\\"></path><path d=\\"M26 16c0 2.21-1.794 4-4.007 4h-4.986A4.006 4.006 0 0 1 13 16v-4h8.993A4.006 4.006 0 0 1 26 16zm-2 0c0-1.112-.898-2-2.005-2H19v-2h-6v3h2v.999c0 1.1.894 2.001 1.997 2.001h5.006A2 2 0 0 0 24 16z\\"></path></g></g>"}}\n  ')}));
//# sourceMappingURL=pkg-sharing.min.js-vfloXb5rd.map