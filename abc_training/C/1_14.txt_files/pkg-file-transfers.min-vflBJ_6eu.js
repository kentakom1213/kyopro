define("modules/clean/react/download_manager/types",["require","exports"],(function(e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.BlockTokenExpired=r.DownloadManager=r.DownloadManagerStatus=void 0,(function(e){e[e.NOT_STARTED=0]="NOT_STARTED",e[e.DOWNLOADING=1]="DOWNLOADING",e[e.ERROR=2]="ERROR",e[e.PAUSED=3]="PAUSED",e[e.FETCHING_TOKENS=4]="FETCHING_TOKENS",e[e.CANCELED=5]="CANCELED",e[e.COMPLETED=6]="COMPLETED"})(r.DownloadManagerStatus||(r.DownloadManagerStatus={}));r.DownloadManager=class{constructor(e){}};class t extends Error{constructor(e){super(e),this.message=e,this.name="BlockTokenExpired"}}r.BlockTokenExpired=t})),define("modules/clean/react/file_transfers/components/hoc",["require","exports","tslib","react","modules/clean/web_timing_logger","file-transfers/i18n/index","modules/core/i18n","modules/clean/react/components/helpers","modules/clean/react/components/css","react-redux","modules/clean/react/file_transfers/components/product_config_provider","modules/clean/react/file_transfers/lib/utils","modules/clean/react/snackbar_manager","react-intl"],(function(e,r,t,n,a,i,s,o,l,u,c,d,f,_){"use strict";function p(e){return"Add email or name"===e.text&&"Placeholder text for transfer recipient entry"===e.description?s.intl.formatMessage({id:"PGj8nM",defaultMessage:"Add email or name"}):"Add a message"===e.text&&"Placeholder text for message to be sent to transfer recipients"===e.description?s.intl.formatMessage({id:"pjLmVF",defaultMessage:"Add a message"}):"Recipients"===e.text&&"Placeholder text for transfer recipient entry"===e.description?s.intl.formatMessage({id:"xgctbz",defaultMessage:"Recipients"}):null}Object.defineProperty(r,"__esModule",{value:!0}),r.withSnackbarManager=r.withWebTimingLogger=r.withTranslations=r.withProductConfigConsumer=r.withProductConfig=r.withCSS=r.withReduxStore=void 0,n=t.__importDefault(n),r.withReduxStore=function(e){return function(r){const t=t=>n.default.createElement(u.Provider,{store:e},n.default.createElement(r,Object.assign({},t)));return t.displayName=`WithProvider(${o.getDisplayName(r)})`,t}},r.withCSS=function(e){return function(r){return l.requireCssWithComponent(r,e)}},r.withProductConfig=function(e){const r=r=>n.default.createElement(c.ProductConfigProvider,null,n.default.createElement(e,Object.assign({},r)));return r.displayName=`WithProductConfig(${o.getDisplayName(e)})`,r},r.withProductConfigConsumer=function(e){const r=r=>n.default.createElement(c.ProductConfigConsumer,null,t=>n.default.createElement(e,Object.assign({},t,r)));return r.displayName=`WithProductConfigConsumer(${o.getDisplayName(e)})`,r},r.withTranslations=function(e){const r=r=>n.default.createElement(_.RawIntlProvider,{value:s.intl},n.default.createElement(i.TranslationProvider,{applyTranslation:p,formatBytes:d.formatBytes,intl:s.intl,isEnvExternal:!0},n.default.createElement(e,Object.assign({},r))));return r.displayName=`WithTranslations(${o.getDisplayName(e)})`,r},r.withWebTimingLogger=function(e){const r=r=>{const{webTimingLoggerServerContext:t}=r;return a.initialize_module(Object.assign(Object.assign({},t),{log_time_to_interactive:!0,log_time_to_view:!0,ttv_at_dom_interactive:!0,tti_at_dom_interactive:!0})),n.default.createElement(e,Object.assign({},r))};return r.displayName=`WithWebTimingLogger(${o.getDisplayName(e)})`,r},r.withSnackbarManager=function(e){return function(r){const t=()=>n.default.createElement(n.default.Fragment,null,r,n.default.createElement(f.SnackbarManager,{ref:e,getParentElement:f.SnackbarManager.getEmbeddedAppPagelet,useDigSnackbars:!0}));return t.displayname=`WithSnackbarManager(${o.getDisplayName(r)})`,t()}}})),define("modules/clean/react/file_transfers/components/product_config",["require","exports"],(function(e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.FeatureName=r.ConstantName=void 0,(function(e){e.USER_SEND_SIZE_LIMIT="userSendSizeLimit",e.PREMIUM_SEND_SIZE_LIMIT="premiumSendSizeLimit",e.MAX_UNEXPIRED_DAYS="maxUnexpiredDays",e.AVAILABLE_BACKGROUNDS="availableBackgrounds",e.SUPPORTED_BACKGROUND_EXTENSIONS="supportedBackgroundExtensions",e.UPSELL_VARIABLES="upsellVariables",e.NUM_ACTIVE_TRANSFERS="numActiveTransfers",e.NUM_TOTAL_TRANSFERS="numTotalTransfers",e.UPLOADER_TYPE="uploaderType",e.UPSELL_CONFIGS="upsellConfigs"})(r.ConstantName||(r.ConstantName={})),(function(e){e.CAN_SELECT_FOLDERS="canSelectFolders",e.CUSTOMIZE_TRANSFER="canCustomizeTransfers",e.PARALLEL_COMMIT_AND_UPLOAD="canParallelCommitAndUpload",e.SET_PASSWORD="password",e.SET_EXPIRATION="canSetExpiration",e.VIEW_EXPIRED_TRANSFER="canSeeExpiredTransfers",e.IS_PRODUCT_DISABLED="isProductDisabled",e.IS_MANAGE_PAGE_UPSELL_BANNER_VARIANT_ON="isManagePageUpsellBannerVariantOn",e.IS_MANAGE_PAGE_UPSELL_BANNER_VARIANT_CONTROL="isManagePageUpsellBannerVariantControl",e.CAN_SEND_EVENTS_TO_USERLEAP="canSendEventsToUserLeap",e.CAN_SEE_PLAN_COMPARISON_UPSELL_MODAL="canSeePlanComparisonUpsellModal",e.CAN_SEE_GLOBAL_NAV="canSeeGlobalNav",e.CAN_USE_DIG_STYLES="canUseDIGStyles",e.CAN_SEE_MANAGE_PAGE_ONBOARDING_MODAL="canSeeManagePageOnboardingModal",e.CAN_SEE_RECEIVED_TRANSFERS_MANAGEMENT="canSeeReceivedTransfersManagement",e.CAN_SEE_STANDALONE_LOGGED_OUT_EXP="canSeeStandaloneLoggedOutExp",e.CAN_SEE_NEW_SETTINGS_FORM_UPSELL_EXP="canSeeNewSettingsFormUpsellExp",e.CAN_SEE_PERMANENT_SIZE_LIMIT_UPSELL_EXP="canSeePermanentSizeLimitUpsellExp",e.CAN_SEE_NEW_USER_ONBOARDING_IMPROVEMENT_EXP="canSeeNewUserOnboardingImprovementExp",e.CAN_SEE_LANDING_CHANGES_EXP="canSeeLandingChangesExp"})(r.FeatureName||(r.FeatureName={}))})),define("modules/clean/react/file_transfers/components/product_config_provider",["require","exports","tslib","react","react-redux","modules/clean/react/file_transfers/redux/selectors"],(function(e,r,t,n,a,i){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ProductConfigConsumer=r.ProductConfigProvider=r.UnconnectedProductConfigProvider=void 0;const s={getConstant:()=>{},isFeatureEnabled:()=>!1},o=(n=t.__importDefault(n)).default.createContext(s);class l extends n.default.Component{constructor(){super(...arguments),this.getConstant=e=>{const{productConfig:r}=this.props;return r&&r.constants?r.constants[e]:void 0},this.isFeatureEnabled=e=>{const{productConfig:r}=this.props;return!(!r||!r.features)&&r.features[e]},this.getLastProductConfigRefreshDate=()=>{const{productConfig:e}=this.props;return e?e.lastProductConfigRefreshDate:void 0}}render(){return n.default.createElement(o.Provider,{value:{getConstant:this.getConstant,isFeatureEnabled:this.isFeatureEnabled,lastProductConfigRefreshDate:this.getLastProductConfigRefreshDate()}},this.props.children)}}r.UnconnectedProductConfigProvider=l,l.displayName="ProductConfigProvider";const u=a.connect(e=>({productConfig:i.getProductConfig(e)}))(l);r.ProductConfigProvider=u;const c=o.Consumer;r.ProductConfigConsumer=c})),define("modules/clean/react/file_transfers/constants",["require","exports","modules/clean/static_urls","file-transfers/common/constants"],(function(e,r,t,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.CUSTOM_LOGO_ID=r.CUSTOM_BACKGROUND_ID=r.UpsellVariant=r.PageName=r.STABLE_SEND_SIZE_LIMIT_PREMIUM=r.STABLE_SEND_SIZE_LIMIT_PAID=r.STABLE_SEND_SIZE_LIMIT_FREE=r.UserLeapEvent=r.TRANSFER_PREVIEW_BREAKPOINT=r.UpsellFeature=r.LIST_PAGE_TRANSFERS_PER_REQUEST=r.MAX_LEN_OF_FILE_NAME=r.LEN_OF_FILE_NAME_SUFFIX=r.LEN_OF_FILE_NAME_PREFIX=r.COMPLETED_TRANSFER_BROWSE_ENTRY_ONBOARDING=r.ViewPageDisplayState=r.EditorPageDisplayState=r.PRIVACY_AND_LEGAL_PAGE=r.TRANSFER_SUPPORT_PAGE=r.QUERY_PARAM_REFERRER=r.TransferUrlQueryParameter=r.UPLOAD_NUM_FILES_WARNING_THRESHOLD=r.SEND_BY_EMAIL_LIMIT_MESSAGE_LENGTH=r.SEND_BY_EMAIL_LIMIT_NUM_RECIPIENTS=r.VALID_EMAIL_REGEX=r.EXPIRED_TRANSFER_IMAGE_SRC=r.SHARE_TRANSFER_VIEW_IMAGE_SRC=r.DEFAULT_BACKGROUND_COLOR=r.PRODUCT_NAME=r.NULL_FILE_TRANSFER_KEY=void 0,r.NULL_FILE_TRANSFER_KEY="NULL",r.PRODUCT_NAME="Dropbox Transfer",r.DEFAULT_BACKGROUND_COLOR="#0093ce",r.SHARE_TRANSFER_VIEW_IMAGE_SRC=t.static_url("/static/images/file_transfer/03_success_state@2x-vflrkXa_N.png"),r.EXPIRED_TRANSFER_IMAGE_SRC=t.static_url("/static/images/file_transfer/02_empty_expired@2x-vfla_QTsC.png"),r.VALID_EMAIL_REGEX=/^['&A-Za-z0-9\._%+-]+@[A-Za-z0-9-][A-Za-z0-9\.-]*\.[A-Za-z]{2,15}$/i,r.SEND_BY_EMAIL_LIMIT_NUM_RECIPIENTS=50,r.SEND_BY_EMAIL_LIMIT_MESSAGE_LENGTH=2e3,r.UPLOAD_NUM_FILES_WARNING_THRESHOLD=500,(function(e){e.CUSTOMIZE_DESIGN="customize_design",e.DOWNLOAD_ALL="download_all",e.DISABLE_DOWNLOAD_NOTIFICATIONS="disable_download_notifications",e.EMAIL_JUST_VERIFIED="email_just_verified",e.EMAIL_TYPE="email_type",e.FEEDBACK="feedback",e.LIKE_EMAIL="like_email",e.RECP_TRACKING="ftref",e.SAVE_TO_DROPBOX="s2d",e.SEND_REMINDERS="send_reminders"})(r.TransferUrlQueryParameter||(r.TransferUrlQueryParameter={})),r.QUERY_PARAM_REFERRER="referrer",r.TRANSFER_SUPPORT_PAGE="https://help.dropbox.com/files-folders/share/dropbox-transfer",r.PRIVACY_AND_LEGAL_PAGE="/privacy",(function(e){e[e.ADD_FILES=0]="ADD_FILES",e[e.UPLOAD_PROGRESS=1]="UPLOAD_PROGRESS",e[e.REDESIGNED_EMAIL_SENT_CONFIRMATION=2]="REDESIGNED_EMAIL_SENT_CONFIRMATION",e[e.REDESIGNED_SHARE_LINK_CONFIRMATION=3]="REDESIGNED_SHARE_LINK_CONFIRMATION"})(r.EditorPageDisplayState||(r.EditorPageDisplayState={})),(function(e){e[e.VIEW_FILES=0]="VIEW_FILES",e[e.DOWNLOAD_CONFIRMATION=1]="DOWNLOAD_CONFIRMATION"})(r.ViewPageDisplayState||(r.ViewPageDisplayState={})),r.COMPLETED_TRANSFER_BROWSE_ENTRY_ONBOARDING="completedTransferBrowseEntryOnboarding",r.LEN_OF_FILE_NAME_PREFIX=5,r.LEN_OF_FILE_NAME_SUFFIX=7,r.MAX_LEN_OF_FILE_NAME=r.LEN_OF_FILE_NAME_PREFIX+r.LEN_OF_FILE_NAME_SUFFIX+3,r.LIST_PAGE_TRANSFERS_PER_REQUEST=25,(function(e){e.CUSTOM_BACKGROUND="custom_background",e.EXPIRATION="expiration",e.EXPIRED_TRANSFERS="expired_transfers",e.OVER_LIMIT="over_limit",e.PASSWORD="password",e.TRANSFER_LOGO="transfer_logo",e.SHOW_WHO_HAS_DOWNLOADED="show_who_has_downloaded",e.MANAGE_PAGE_UPSELL_BANNER="manage_page_upsell_banner",e.SHARING_SETTINGS_UPSELL_BANNER="sharing_settings_upsell_banner"})(r.UpsellFeature||(r.UpsellFeature={})),r.TRANSFER_PREVIEW_BREAKPOINT=1024,(function(e){e.ACTIVATE_MANUAL_FEEDBACK="activate_manual_feedback",e.MANAGE_ACTIVE_TRANSFERS="manage_active_transfers",e.RECEIVED_TRANSFER="received_transfer",e.SENDER_CSAT_SURVEY="sender_csat_survey",e.SENT_TRANSFER="sent_transfer",e.SET_CONTROL_ACCESS="set_control_access"})(r.UserLeapEvent||(r.UserLeapEvent={})),r.STABLE_SEND_SIZE_LIMIT_FREE=100*n.BYTES_IN_MEGABYTE,r.STABLE_SEND_SIZE_LIMIT_PAID=2*n.BYTES_IN_GIGABYTE,r.STABLE_SEND_SIZE_LIMIT_PREMIUM=100*n.BYTES_IN_GIGABYTE,(function(e){e.ABOUT_PAGE="about",e.CREATE_PAGE="create",e.VIEW_PAGE="view",e.VIEW_EXPIRED_PAGE="view_expired",e.VIEW_DELETED_PAGE="view_deleted",e.LIST_PAGE="list"})(r.PageName||(r.PageName={})),(function(e){e.TRY_PROFESSIONAL="try_professional",e.BUY_PROFESSIONAL="buy_professional",e.CONTACT_ADMIN="contact_admin",e.TRY_BUSINESS_ADVANCED="try_business_advanced",e.BUY_TRANSFER="buy_transfer",e.BUY_TRANSFER_WITH_PRICING="buy_transfer_with_pricing",e.TRY_PROFESSIONAL_WITH_PRICING="try_professional_with_pricing",e.TRANSFER_PROFESSIONAL_PLAN_COMPARISON="transfer_professional_plan_comparison"})(r.UpsellVariant||(r.UpsellVariant={})),r.CUSTOM_BACKGROUND_ID="custom",r.CUSTOM_LOGO_ID="custom_logo"})),define("modules/clean/react/file_transfers/lib/api",["require","exports","tslib","api_v2/noauth_client","api_v2/user_client","api_v2/datetime","modules/clean/react/file_transfers/redux/types","file-transfers/common/constants","modules/clean/filepath/filepath","modules/clean/react/file_transfers/constants","modules/clean/react/user_metadata/api","api_v2/transport/beacon"],(function(e,r,t,n,a,i,s,o,l,u,c,d){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.getBlocksFiles=r.getFileTransfersUserMetadata=r.getProductConfig=r.listRecipients=r.logProductAnalyticsEvent=r.submitFeedback=r.addRecipientsAndSend=r.deleteTransfer=r.logUserMetricsEvent=r.updateUserConfig=r.updateMetadata=r.share=r.addFilesByBlocks=r.removeFileByPath=r.removeFileById=r.addFilesById=r.saveToDropbox=r.downloadFiles=r.fetchFiles=r.createTransfer=r.fetchReceivedTransfersList=r.fetchTransfersList=r.authWithPassword=r.getFolderSizes=r.isApiErrorResult=void 0,s=t.__importStar(s),r.isApiErrorResult=function(e){return null!=e.error&&null!=e.error.error_type},r.getFolderSizes=function(e,r){return t.__awaiter(this,void 0,void 0,(function*(){return yield(new a.UserApiV2Client).ns("folders_info").rpc("get_folder_sizes",{paths:r},{subjectUserId:e})}))},r.authWithPassword=function(e,r,i){return t.__awaiter(this,void 0,void 0,(function*(){const t={transfer_id:r,password:i};return e?yield(new a.UserApiV2Client).ns("file_transfers").rpc("auth_with_password",t,{subjectUserId:e}):yield(new n.NoAuthApiV2Client).ns("file_transfers").rpc("auth_with_password_logged_out",t,{})}))},r.fetchTransfersList=function(e,r,n){return t.__awaiter(this,void 0,void 0,(function*(){const t={requested_count:u.LIST_PAGE_TRANSFERS_PER_REQUEST};n&&(t.cursor_token=n);const i={view:(e=>{switch(e){case s.TransferListView.Active:return{".tag":"active"};case s.TransferListView.Expired:return{".tag":"expired"}}})(r),pagination:t};return yield(new a.UserApiV2Client).ns("file_transfers").rpc("list",i,{subjectUserId:e})}))},r.fetchReceivedTransfersList=function(e,r,n){return t.__awaiter(this,void 0,void 0,(function*(){const t={requested_count:u.LIST_PAGE_TRANSFERS_PER_REQUEST};n&&(t.cursor_token=n);const i={view:(e=>{switch(e){case s.TransferListView.Active:return{".tag":"active"};case s.TransferListView.Expired:return{".tag":"expired"}}})(r),pagination:t};return yield(new a.UserApiV2Client).ns("file_transfers").rpc("received_transfer/list",i,{subjectUserId:e})}))},r.createTransfer=function(e,r){return t.__awaiter(this,void 0,void 0,(function*(){const t={};return r&&(t.client_generated_tracking_id=r),yield(new a.UserApiV2Client).ns("file_transfers").rpc("create",t,{subjectUserId:e})}))},r.fetchFiles=function(e,r,i=!1){return t.__awaiter(this,void 0,void 0,(function*(){const t={transfer_id:r,include_all_files:i};return e?yield(new a.UserApiV2Client).ns("file_transfers").rpc("files/list",t,{subjectUserId:e}):yield(new n.NoAuthApiV2Client).ns("file_transfers").rpc("files/list_logged_out",t,{})}))},r.downloadFiles=function(e,r,i,s){return t.__awaiter(this,void 0,void 0,(function*(){const t={transfer_id:r,requested_files_by_id:i,is_preview_download:s||!1};return e?yield(new a.UserApiV2Client).ns("file_transfers").rpc("files/download",t,{subjectUserId:e}):yield(new n.NoAuthApiV2Client).ns("file_transfers").rpc("files/download_logged_out",t,{})}))},r.saveToDropbox=function(e,r,n,i,s){return t.__awaiter(this,void 0,void 0,(function*(){const t=new a.UserApiV2Client,o={transfer_id:r,destination_path:l.normalize(n)+l.normalize(i),requested_files_by_id:s};return yield t.ns("file_transfers").rpc("files/save_to_dropbox",o,{subjectUserId:e})}))},r.addFilesById=function(e,r,n){return t.__awaiter(this,void 0,void 0,(function*(){const t={transfer_id:r||void 0,files_to_add:n};return yield(new a.UserApiV2Client).ns("file_transfers").rpc("files/add_by_id",t,{subjectUserId:e})}))},r.removeFileById=function(e,r,n){return t.__awaiter(this,void 0,void 0,(function*(){const t={transfer_id:r,files_to_remove:n};return yield(new a.UserApiV2Client).ns("file_transfers").rpc("files/remove",t,{subjectUserId:e})}))},r.removeFileByPath=function(e,r,n){return t.__awaiter(this,void 0,void 0,(function*(){const t={transfer_id:r,requested_files_by_path:n};return yield(new a.UserApiV2Client).ns("file_transfers").rpc("files/remove",t,{subjectUserId:e})}))},r.addFilesByBlocks=function(e,r,n){return t.__awaiter(this,void 0,void 0,(function*(){const t={transfer_id:r||void 0,files_to_add:n};return yield(new a.UserApiV2Client).ns("file_transfers").rpc("files/add_by_blocks",t,{subjectUserId:e})}))},r.share=function(e,r){return t.__awaiter(this,void 0,void 0,(function*(){const t={transfer_id:r};return yield(new a.UserApiV2Client).ns("file_transfers").rpc("share",t,{subjectUserId:e})}))},r.updateMetadata=function(e,r,n,s,o,l){return t.__awaiter(this,void 0,void 0,(function*(){const t={transfer_id:r};return void 0!==n&&(t.expiration_time_update={".tag":"expiration_time",expiration_time:i.formatTimestamp(n)}),void 0!==o&&(t.password_update=""===o?{".tag":"no_password"}:{".tag":"password",password:o}),void 0!==s&&(t.should_notify_creator_on_download_update={".tag":"should_notify_creator_on_download",should_notify_creator_on_download:s}),void 0!==l&&(t.title_update=""===l?{".tag":"no_title"}:{".tag":"title",title:l}),yield(new a.UserApiV2Client).ns("file_transfers").rpc("update_metadata",t,{subjectUserId:e})}))},r.updateUserConfig=function(e,r){return t.__awaiter(this,void 0,void 0,(function*(){const t=r?{background_id:r.background_id}:{};return yield(new a.UserApiV2Client).ns("file_transfers").rpc("update_user_config",t,{subjectUserId:e})}))},r.logUserMetricsEvent=function(e,r,i,s){return t.__awaiter(this,void 0,void 0,(function*(){const t={transfer_id:r,event_name:i,recipient_tracking_id:s};return e?yield(new a.UserApiV2Client).ns("file_transfers").rpc("user_metrics/log_event",t,{subjectUserId:e}):yield(new n.NoAuthApiV2Client).ns("file_transfers").rpc("user_metrics/log_event_logged_out",t,{})}))},r.deleteTransfer=function(e,r){return t.__awaiter(this,void 0,void 0,(function*(){const t={transfer_id:r};return yield(new a.UserApiV2Client).ns("file_transfers").rpc("delete",t,{subjectUserId:e})}))},r.addRecipientsAndSend=function(e,r,n,i){return t.__awaiter(this,void 0,void 0,(function*(){const t=[],s=(new a.UserApiV2Client).ns("file_transfers");for(let a=0;a<r.length;a+=10){const o={recipients:r.slice(a,a+10),message_body:n,transfer_id:i};t.push(s.rpc("recipients/add_and_send",o,{subjectUserId:e}))}return yield Promise.all(t),{}}))},r.submitFeedback=function(e,r,i,s,l,u,c,d){return t.__awaiter(this,void 0,void 0,(function*(){let t;t=r===o.NOT_APPLICABLE_SATISFACTION_RATING_VALUE?{".tag":"not_applicable"}:{".tag":"value",value:r};const f={satisfaction_rating:t,comments:i,file_transfer_flow:s||void 0,transfer_id:l||void 0,client_generated_transfer_tracking_id:u||void 0,platform:c||void 0,extra:d};return e?yield(new a.UserApiV2Client).ns("file_transfers").rpc("submit_feedback",f,{subjectUserId:e}):yield(new n.NoAuthApiV2Client).ns("file_transfers").rpc("submit_feedback_logged_out",f,{})}))},r.logProductAnalyticsEvent=function(e,r,i){return t.__awaiter(this,void 0,void 0,(function*(){const t={transfer_id:r.transferId,event_name:r.eventName,file_expiration:r.fileExpiration,file_transfer_flow:r.fileTransferFlow,client_generated_transfer_tracking_id:r.clientGeneratedTransferTrackingId,extra:JSON.stringify(r.extra)};return i?e?new a.UserApiV2Client(new d.BeaconTransport).ns("file_transfers").rpc("product_analytics/log_event",t,{subjectUserId:e}):new n.NoAuthApiV2Client(new d.BeaconTransport).ns("file_transfers").rpc("product_analytics/log_event_logged_out",t,{}):e?yield(new a.UserApiV2Client).ns("file_transfers").rpc("product_analytics/log_event",t,{subjectUserId:e}):yield(new n.NoAuthApiV2Client).ns("file_transfers").rpc("product_analytics/log_event_logged_out",t,{})}))},r.listRecipients=function(e,r){return t.__awaiter(this,void 0,void 0,(function*(){const t={transfer_id:r};return yield(new a.UserApiV2Client).ns("file_transfers").rpc("recipients/list",t,{subjectUserId:e})}))},r.getProductConfig=function(e){return t.__awaiter(this,void 0,void 0,(function*(){return e?yield(new a.UserApiV2Client).ns("file_transfers").rpc("product_config/get",{},{subjectUserId:e}):yield(new n.NoAuthApiV2Client).ns("file_transfers").rpc("product_config/get",{},{})}))},r.getFileTransfersUserMetadata=function(e){return t.__awaiter(this,void 0,void 0,(function*(){const r=yield c.getUserMetadata(["FILE_TRANSFER_SHOULD_NOTIFY_CREATOR_ON_DOWNLOAD","FILE_TRANSFER_EXPIRATION_OPTION"],e);return{defaultExpirationOption:r.FILE_TRANSFER_EXPIRATION_OPTION,defaultShouldNotifyCreatorOnDownloadSetting:r.FILE_TRANSFER_SHOULD_NOTIFY_CREATOR_ON_DOWNLOAD}}))},r.getBlocksFiles=function(e,r,i){return t.__awaiter(this,void 0,void 0,(function*(){const t={transfer_id:i,requested_files_by_id:[r]};return e?yield(new a.UserApiV2Client).ns("file_transfers").rpc("files/get_blocks",t,{subjectUserId:e}):yield(new n.NoAuthApiV2Client).ns("file_transfers").rpc("files/get_blocks_logged_out",t,{})}))}})),define("modules/clean/react/file_transfers/lib/urls",["require","exports","tslib","modules/core/browser","modules/clean/history","modules/clean/react/location/types","modules/core/uri","modules/clean/react/file_transfers/constants"],(function(e,r,t,n,a,i,s,o){"use strict";function l(e){return e.replace(/^cap_pid_ft:/,"")}function u(){return"https://www.dropbox.com/"}function c(e,t){const n=`/${r.BASE_URL}/${encodeURIComponent(l(e))}/edit`;return t?`${n}?referrer=${t.referrer}&log_create=${t.logCreateTransferEvent}`:n}function d(e){const t=`https://www.dropbox.com/${r.BASE_URL}`;return e?`${t}?referrer=${e}`:t}function f(e){return`https://www.dropbox.com/${r.BASE_URL}/${encodeURIComponent(l(e))}`}function _(e){const r=e.query.transfer_id,t=Array.isArray(r)?r[0]:r;return t?(function(e){return-1===e.indexOf("cap_pid_ft:")?`cap_pid_ft:${e}`:e})(t):t}function p(e,r){const t=e.query[r],n=Array.isArray(t)?t[0]:t;return Boolean(n&&"true"===n.toLowerCase())}function g(e,r){const t=e.query[r];return Array.isArray(t)?t[0]:t}function E(e){const r=n.get_uri();r.removeQuery(e),a.default.replace_state(r.getPath(),r.getQuery())}function S(e){const r=e.query[o.TransferUrlQueryParameter.RECP_TRACKING];return Array.isArray(r)?r[0]:r}Object.defineProperty(r,"__esModule",{value:!0}),r.prepareFileIdsParam=r.addTrackingParams=r.removeNoDownloadRecipientList=r.shouldShowNoDownloadRecipientList=r.shouldDisableDownloadNotifications=r.removeDisableDownloadNotificationsInLocation=r.getRecipientTrackingIdFromLocation=r.getRecipientTrackingIdFromUrl=r.removeCustomizeDesignInLocation=r.updateTransferIdInLocation=r.getReferrerFromUrlParam=r.shouldEmailFeedbackBeInitiallyLogged=r.shouldEmailVerifiedModalBeInitiallyShown=r.shouldCustomizeDesignBeInitiallyShown=r.shouldFeedbackFormBeInitiallyShown=r.removeQueryParam=r.getQueryParamValue=r.isQueryParamValueTrue=r.getTransferIdFromLocation=r.getTransferIdFromUrl=r.addTransferIdToUrl=r.cleanBrowserHrefForEditPage=r.professionalTryUrl=r.checkoutUrl=r.professionalBuyUrl=r.aboutUrl=r.dropboxTermsUrls=r.reportAbuseUrl=r.shareTransferUrl=r.viewTransferUrl=r.createTransferUrlWithParams=r.createTransferUrl=r.editTransferUrl=r.listReceivedTransfersUrl=r.listTransfersUrl=r.dropboxUrl=r.BASE_URL=void 0,n=t.__importStar(n),a=t.__importDefault(a),r.BASE_URL="transfer",r.dropboxUrl=u,r.listTransfersUrl=function(e,t){const n=`https://www.dropbox.com/${r.BASE_URL}/manage`;return e&&t?`${n}?referrer=${e}&transfer_id=${l(t)}`:e?`${n}?referrer=${e}`:t?`${n}?transfer_id=${l(t)}`:n},r.listReceivedTransfersUrl=function(e){const t=`https://www.dropbox.com/${r.BASE_URL}/manage/received`;return e?`${t}?referrer=${e}`:t},r.editTransferUrl=c,r.createTransferUrl=d,r.createTransferUrlWithParams=function(e){return new s.URI({scheme:"https",authority:"www.dropbox.com",path:`/${r.BASE_URL}`,query:e}).toString()},r.viewTransferUrl=f,r.shareTransferUrl=function(e,r){return r&&r.share_url?r.share_url:f(e)},r.reportAbuseUrl=function(e){return`https://www.dropbox.com/report_abuse${e?`?ssu=${f(e)}`:""}`},r.dropboxTermsUrls=function(){return"https://www.dropbox.com/terms"},r.aboutUrl=function(e){const t=`https://www.dropbox.com/${r.BASE_URL}/about`;return e?`${t}?referrer=${e}`:t},r.professionalBuyUrl=function(){return"https://www.dropbox.com/buy"},r.checkoutUrl=function(){return"https://www.dropbox.com/buy/transfer"},r.professionalTryUrl=function(){return"https://www.dropbox.com/pro/try"},r.cleanBrowserHrefForEditPage=function(){n.get_pathname()!==`/${r.BASE_URL}/cfd`?a.default.replace_state(n.get_pathname()):a.default.replace_state(d("desktop").replace(new RegExp("^https://www.dropbox.com"),""))},r.addTransferIdToUrl=function(e){n.get_pathname().endsWith("/edit")||a.default.replace_state(c(e))},r.getTransferIdFromUrl=function(e){return _(i.Location.fromURI(s.URI.parse(e)))},r.getTransferIdFromLocation=_,r.isQueryParamValueTrue=p,r.getQueryParamValue=g,r.removeQueryParam=E,r.shouldFeedbackFormBeInitiallyShown=function(e){return p(e,o.TransferUrlQueryParameter.FEEDBACK)},r.shouldCustomizeDesignBeInitiallyShown=function(e){return p(e,o.TransferUrlQueryParameter.CUSTOMIZE_DESIGN)},r.shouldEmailVerifiedModalBeInitiallyShown=function(e){return"1"===g(e,o.TransferUrlQueryParameter.EMAIL_JUST_VERIFIED)},r.shouldEmailFeedbackBeInitiallyLogged=function(e){return Boolean(g(e,o.TransferUrlQueryParameter.EMAIL_TYPE)&&g(e,o.TransferUrlQueryParameter.LIKE_EMAIL))},r.getReferrerFromUrlParam=function(e){const r=e.query.referrer;return Array.isArray(r)?r[0]:r},r.updateTransferIdInLocation=function(e){let r=n.get_uri();e?(r=r.updateQuery({transfer_id:l(e)}),a.default.replace_state(r.getPath(),r.getQuery())):(r=r.removeQuery("transfer_id"),a.default.replace_state(r.getPath(),r.getQuery()))},r.removeCustomizeDesignInLocation=function(){E(o.TransferUrlQueryParameter.CUSTOMIZE_DESIGN)},r.getRecipientTrackingIdFromUrl=function(){return S(i.Location.fromURI(s.URI.parse(n.get_uri())))},r.getRecipientTrackingIdFromLocation=S,r.removeDisableDownloadNotificationsInLocation=function(){E(o.TransferUrlQueryParameter.DISABLE_DOWNLOAD_NOTIFICATIONS)},r.shouldDisableDownloadNotifications=function(e){return p(e,o.TransferUrlQueryParameter.DISABLE_DOWNLOAD_NOTIFICATIONS)},r.shouldShowNoDownloadRecipientList=function(e){return p(e,o.TransferUrlQueryParameter.SEND_REMINDERS)},r.removeNoDownloadRecipientList=function(){E(o.TransferUrlQueryParameter.SEND_REMINDERS)},r.addTrackingParams=function(e,r,t){const n=s.URI.parse(e),a=Object.assign(Object.assign({},r),!!t&&{trigger:`web_ft_${t}`});return n.updateQuery(a),n.toString()},r.prepareFileIdsParam=function(e){return e.map(e=>e.file_id.replace("id:","")).join(".")}})),define("modules/clean/react/file_transfers/lib/utils",["require","exports","tslib","modules/clean/react/file_transfers/lib/api","lodash","modules/core/browser_detection","modules/core/browser","modules/core/cookies","modules/clean/display_format","modules/clean/downloads","modules/clean/react/snackbar","modules/core/exception","modules/clean/react/upload_kit/lib/types","modules/clean/react/file_transfers/uploader/types","modules/clean/react/file_transfers/constants","modules/clean/filepath/filepath","modules/clean/uuid/uuid","modules/clean/react/browse/models","modules/core/i18n","modules/clean/react/file_transfers/lib/urls","file-transfers/common/constants","file-transfers/common/types","modules/clean/react/file_transfers/lib/urls","modules/clean/react/download_manager/types","modules/clean/web_user_action_events"],(function(e,r,t,n,a,i,s,o,l,u,c,d,f,_,p,g,E,S,m,T,A,I,F,N,h){"use strict";function L(e){const r=localStorage.getItem(e);return null===r?null:parseInt(r,10)}function R(e,r){localStorage.setItem(e,r.toString())}Object.defineProperty(r,"__esModule",{value:!0}),r.shouldShowTransferInSplitShare=r.redirectToCreateTransferWithFiles=r.computeAddToTransferReferrer=r.getDefaultExpirationOption=r.getPlanComparisonUpsellConfig=r.convertToUploadErrorType=r.getBlock=r.getBlocks=r.browserSupportsNativeFS=r.computeCreationRelativeExpirationDate=r.areItemsUploaded=r.getChildrenFiles=r.numSuccess=r.numWaiting=r.generateTransferTrackingId=r.getVideoBackgroundAsset=r.getImageBackgroundAsset=r.isVideoBackground=r.isImageBackground=r.isColorBackground=r.getUpsellProps=r.estimateExpirationOption=r.getDateDiff=r.DAYS_IN_MS=r.renameDuplicateFiles=r.downloadFiles=r.displayDownloadSnackbarError=r.downloadZipFromUrl=r.isLocalDirectory=r.getTransferFilesKey=r.getRootDirectory=r.isInPath=r.isAtRoot=r.fileSystemDirectoryEntryAsStateFileInfo=r.sumBytes=r.stateFileInfoAsFileInfo=r.fileNameFromPath=r.fileSysEntrytoStateFileInfo=r.fileAsStateFileInfo=r.pluploadFileAsStateFileInfo=r.chooserFileAsStateFileInfo=r.transferFileAsStateFileInfo=r.createDirectoryStateFileInfo=r.formatLongFileNameForDisplay=r.generateTransferTitle=r.generateTransferSummaryTitle=r.markHasEverSetLogo=r.hasEverSetLogo=r.markHasEverSetBackground=r.hasEverSetBackground=r.markAtLeastOneFileDownloaded=r.hasAtLeastOneFileDownloaded=r.markUserAgreedToLoggedOutTransferTOS=r.hasUserAgreedToLoggedOutTransferTOS=r.HAS_USER_AGREED_TO_LOGGED_OUT_TRANSFER_TOS_KEY=r.setLocalStorageValueForKey=r.getLocalStorageBooleanValueForKey=r.getLocalStorageNumberValueForKey=r.incrementLocalStorageValueForKey=r.formatBytes=r.SUPPORTED_LOCALES=r.DEFAULT_LOCALE=r.sortByFirstReceivedTimeDesc=r.sortByCreationTimeDesc=r.contactToEmailRecipient=void 0,n=t.__importStar(n),i=t.__importStar(i),s=t.__importStar(s),u=t.__importStar(u),d=t.__importStar(d),r.contactToEmailRecipient=function(e){return{recipient:{".tag":"email_address",email_address:e.email}}},r.sortByCreationTimeDesc=function(e){return[...e].sort((e,r)=>e.creation_time<r.creation_time?1:r.creation_time<e.creation_time?-1:0)},r.sortByFirstReceivedTimeDesc=function(e){return[...e].sort((e,r)=>e.first_received_time<r.first_received_time?1:r.first_received_time<e.first_received_time?-1:0)},r.DEFAULT_LOCALE="en",r.SUPPORTED_LOCALES=["da_DK","de","en","en_GB","es","es_ES","fr","id","it","ja","ko","ms","nb_NO","nl_NL","pl","pt_BR","ru","sv_SE","th_TH","uk_UA","zh_CN","zh_TW"],r.formatBytes=function(e,r={}){return void 0===r.numDecimalPlaces&&(e<l.SWITCH_UNIT_THRESHOLD*A.BYTES_IN_KILOBYTE?r.numDecimalPlaces=0:e<l.SWITCH_UNIT_THRESHOLD*A.BYTES_IN_MEGABYTE?r.numDecimalPlaces=1:r.numDecimalPlaces=2),l.format_bytes(e,r.numDecimalPlaces,r.includeSpace,r.lazy,r.allowNegative)},r.incrementLocalStorageValueForKey=function(e){const r=L(e);R(e,r?r+1:1)},r.getLocalStorageNumberValueForKey=L,r.getLocalStorageBooleanValueForKey=function(e){const r=localStorage.getItem(e);return null===r?null:"true"===r},r.setLocalStorageValueForKey=R,r.HAS_USER_AGREED_TO_LOGGED_OUT_TRANSFER_TOS_KEY="transfer_agreed_to_tos",r.hasUserAgreedToLoggedOutTransferTOS=function(){return!!o.Cookies.read(r.HAS_USER_AGREED_TO_LOGGED_OUT_TRANSFER_TOS_KEY)},r.markUserAgreedToLoggedOutTransferTOS=function(){o.Cookies.create(r.HAS_USER_AGREED_TO_LOGGED_OUT_TRANSFER_TOS_KEY,"true")},r.hasAtLeastOneFileDownloaded=function(e){return null!==sessionStorage.getItem(`fileTransferAtLeastOneFileDownloaded:${e}`)},r.markAtLeastOneFileDownloaded=function(e){sessionStorage.setItem(`fileTransferAtLeastOneFileDownloaded:${e}`,"true")};r.hasEverSetBackground=function(){return null!==localStorage.getItem("fileTransferEverSetBackground")},r.markHasEverSetBackground=function(){localStorage.setItem("fileTransferEverSetBackground","true")};function U(e,r,t){return 0===e.length?m.intl.formatMessage({id:"syJiNE",defaultMessage:"Transfer with no items"}):r<=1?m.intl.formatMessage({id:"8oHG0B",defaultMessage:"{item_name}"},{item_name:t?O(e[0]):e[0]}):m.intl.formatMessage({id:"IUBT/B",defaultMessage:"{item_name} + {item_count}"},{item_name:t?O(e[0]):e[0],item_count:r-1})}function O(e){let r=e;if(e.length>p.MAX_LEN_OF_FILE_NAME){r=`${e.slice(0,p.LEN_OF_FILE_NAME_PREFIX)}...${e.slice(e.length-p.LEN_OF_FILE_NAME_SUFFIX)}`}return r}function C(e){const r=e.split("/");return r[r.length-1]}function D(e){return null===v(e)}function v(e){let r;if("dest"in e)r=e.dest;else if("fullPath"in e){if(!e.fullPath)return null;r=e.fullPath,"/"===r.charAt(0)&&(r=e.fullPath.substring(1))}else{if(!("path"in e))throw new Error("file must be either PluploadFile, StateFileInfo, or FileSystemEntry");if(!e.path)return null;r=e.path}const t=r.split("/");return t.length<=1?null:t[0]}function y(e,r={}){const t=document.getElementsByName("file-downloads-iframe");for(const e of Array.from(t))e&&e.parentNode&&e.parentNode.removeChild(e);const n=document.createElement("iframe");n.name="file-downloads-iframe",n.src="about:blank",n.setAttribute("style","display: none;"),document.body.appendChild(n);const a=n.contentDocument,i=a.createElement("form");i.action=e,i.method="post",Object.keys(r).forEach(e=>{const t=document.createElement("input");t.type="hidden",t.name=e,t.value=r[e],i.appendChild(t)}),a.body.appendChild(i),i.submit()}function w(e,t){return Math.round((t.getTime()-e.getTime())/r.DAYS_IN_MS)}function P(e){return r=>(function(e){return e.value?e.value[".tag"]:"other"})(r)===e}r.hasEverSetLogo=function(){return null!==localStorage.getItem("fileTransferHasEverSetLogo")},r.markHasEverSetLogo=function(){localStorage.setItem("fileTransferHasEverSetLogo","true")},r.generateTransferSummaryTitle=function(e,r){return e.title||U(e.summary_file_names,e.display_file_count,r)},r.generateTransferTitle=U,r.formatLongFileNameForDisplay=O,r.createDirectoryStateFileInfo=function(e,r){let t=_.OriginalFileSource.Unknown;return r===_.FileSource.Dropbox?t=_.OriginalFileSource.Dropbox:r===_.FileSource.Computer&&(t=_.OriginalFileSource.Computer),{id:E.UUID.v4(),isDir:!0,path:e,size:0,source:r,originalSource:t,thumbnailUrl:null}},r.transferFileAsStateFileInfo=function(e,r){return{id:e.transfer_file_id,isDir:e.obsolete_is_dir,path:e.relative_path,size:e.file_size,source:_.FileSource.Transfer,originalSource:r,thumbnailUrl:e.thumbnail_url||null,fileForPreview:e.file_preview_info,isExpanded:!1,depth:0}},r.chooserFileAsStateFileInfo=function({id:e,isDir:r,name:t,bytes:n}){return{id:e,isDir:r,path:t,size:n,source:_.FileSource.Dropbox,originalSource:_.OriginalFileSource.Dropbox,thumbnailUrl:null}},r.pluploadFileAsStateFileInfo=function(e){return{id:e.id,isDir:0===e.size,path:e.dest,size:e.size,source:_.FileSource.Computer,originalSource:_.OriginalFileSource.Computer,thumbnailUrl:null}},r.fileAsStateFileInfo=function(e){return{path:e.name,id:e.name,size:e.size||0,isDir:!1,source:_.FileSource.Computer,originalSource:_.OriginalFileSource.Computer,thumbnailUrl:null}},r.fileSysEntrytoStateFileInfo=function(e,r){return{path:e.name,id:e.name,size:r,isDir:!1,source:_.FileSource.Computer,originalSource:_.OriginalFileSource.Computer,thumbnailUrl:null}},r.fileNameFromPath=C,r.stateFileInfoAsFileInfo=function(e,r={}){return Object.assign({id:e.id,isDir:e.isDir,name:C(e.path),size:e.size,thumbnailUrl:e.thumbnailUrl,fileForPreview:e.fileForPreview,depth:e.depth||0},r)},r.sumBytes=function(e){return e.reduce((e,r)=>e+r.size,0)},r.fileSystemDirectoryEntryAsStateFileInfo=function(e){return{id:E.UUID.v4(),isDir:!0,path:e.fullPath?e.fullPath.substring(1):e.name,size:0,source:_.FileSource.Computer,originalSource:_.OriginalFileSource.Computer,thumbnailUrl:null}},r.isAtRoot=D,r.isInPath=function(e,r,t=!1){if(r&&e.path){const n=r.split("/").filter(e=>e),a=e.path.split("/").filter(e=>e);return(t||n.length===a.length-1)&&n.length<a.length&&0===n.filter((e,r)=>e!==a[r]).length}return!1},r.getRootDirectory=v,r.getTransferFilesKey=function(e){return e||p.NULL_FILE_TRANSFER_KEY},r.isLocalDirectory=function(e){return e.isDir&&e.source===_.FileSource.Computer},r.downloadZipFromUrl=y,r.displayDownloadSnackbarError=function(e){c.Snackbar.fail(m.intl.formatMessage({id:"eIzkSh",defaultMessage:"Something's not working. Try downloading again."}),"download-transfer-notification"),d.reportException({err:e,tags:["js:file_transfers"]})},r.downloadFiles=function(e,r,a,i){return t.__awaiter(this,void 0,void 0,(function*(){const t=n.downloadFiles(r,e,a,i);return t.then(e=>{const r=e.post_params?JSON.parse(e.post_params):{},t=e.url.toString();0===Object.keys(r).length?u.get({url:t}):y(t,r)}),t}))},r.renameDuplicateFiles=function(e,r=[]){const t=[],n=[],a=new Set,i=new Set;return r.filter(e=>D(e)).forEach(e=>{a.add(e.id),i.add(e.path.toLowerCase())}),e.forEach(e=>{let r;const s=g.split_filename(e.path);let o;if(i.has(e.path.toLowerCase())){if(a.has(e.id))return;let n,l=1;do{n=`${s.name} (${l})`,r=s.ext?`${n}.${s.ext}`:n,l++}while(i.has(r.toLowerCase()));a.add(e.id),i.add(r.toLowerCase()),o=Object.assign(Object.assign({},e),{path:r}),t.push(o)}else D(e)?(a.add(e.id),i.add(e.path.toLowerCase()),o=Object.assign({},e)):o=Object.assign({},e);n.push(o)}),{files:n,filesRenamed:t}},r.DAYS_IN_MS=864e5,r.getDateDiff=w,r.estimateExpirationOption=function(e,r){const t=w(new Date(e.getFullYear(),e.getMonth(),e.getDate()),new Date(r.getFullYear(),r.getMonth(),r.getDate()));switch(t){case I.ExpirationOption.SEVEN_DAYS:case I.ExpirationOption.THIRTY_DAYS:case I.ExpirationOption.NINETY_DAYS:return t;default:return I.ExpirationOption.CUSTOM}},r.getUpsellProps=function(e,r){const t={ctaCopy:e.cta_copy,ctaLink:e.cta_link,productName:e.product_name};return r&&(t.ctaLink=F.addTrackingParams(t.ctaLink,{},r)),t};const b=P("image"),M=P("video");function k(e){return!!e.asset&&b(e.asset)}function B(e){return!!e.asset&&M(e.asset)}function x(e,r){return r?a.filter(r,r=>r.status===e).length:0}r.isColorBackground=function(e){return!!e.color_hex&&!e.asset},r.isImageBackground=k,r.isVideoBackground=B,r.getImageBackgroundAsset=function(e){return k(e)?e.asset.value:null},r.getVideoBackgroundAsset=function(e){return B(e)?e.asset.value:null},r.generateTransferTrackingId=function(){return E.UUID.v4()},r.numWaiting=e=>x(_.UploadStatus.Waiting,e),r.numSuccess=e=>x(_.UploadStatus.Success,e),r.getChildrenFiles=function(e,r){if(!e.isDir)throw Error("Can only get children of a directory");return r.filter(r=>r.path!==e.path&&r.path.startsWith(`${e.path}/`))},r.areItemsUploaded=function(e,r){return e.every(e=>r[e.id]&&r[e.id].status===_.UploadStatus.Success)},r.computeCreationRelativeExpirationDate=function(e,r){const t=e=>Date.UTC(e.getFullYear(),e.getMonth(),e.getDate()),n=t(r)-t(e);return new Date(+e+n)},r.browserSupportsNativeFS=function(){return!!i.checkBrowserVersion(i.chromium(),86,!0)},r.getBlocks=function(e,r,a){return t.__awaiter(this,void 0,void 0,(function*(){return n.getBlocksFiles(e,r,a)}))},r.getBlock=function(e,r){return t.__awaiter(this,void 0,void 0,(function*(){const t=yield fetch(`https://${e}/web_download_chunks_batch`,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:`web_block_request_tokens=${JSON.stringify([r])}`});if(!t.ok)throw 403===t.status?new N.BlockTokenExpired("Refresh block tokens"):new Error("Blockserver error");return t}))},r.convertToUploadErrorType=function(e){var r;switch(null===(r=e.error_type)||void 0===r?void 0:r[".tag"]){case"not_found":return f.UploadErrorType.NotFound;case"no_permission":return f.UploadErrorType.NoPermission;case"restricted":return f.UploadErrorType.Restricted;case"invalid_args":return f.UploadErrorType.InvalidArgs;case"unknown":case"other":default:return f.UploadErrorType.Unknown}};r.getPlanComparisonUpsellConfig=function(e){const r=e&&e.find(e=>(e=>Boolean(e.upsell_config_value&&"plan_comparison_upsell_config"===e.upsell_config_value[".tag"]))(e));return r?r.upsell_config_value:void 0},r.getDefaultExpirationOption=function(e){return e?A.DEFAULT_EXPIRATION_OPTION_PAID:A.DEFAULT_EXPIRATION_OPTION_FREE},r.computeAddToTransferReferrer=(e,r,t,n)=>{let a=`${r}`;return t&&(a=`${t}`,n&&(a=`${t}_${n}`,n===h.ActionSurfaceLogValue.RIGHT_SIDEBAR&&1===e.length?a=`${t}_${n}_single_file`:n===h.ActionSurfaceLogValue.RIGHT_SIDEBAR&&e.length>1&&(a=`${t}_${n}_multi_file`))),a},r.redirectToCreateTransferWithFiles=(e,r)=>{const t=T.prepareFileIdsParam(e);c.Snackbar.sync(m.intl.formatMessage({id:"EmOY+w",defaultMessage:"Creating new transfer..."}),!1,"create-transfer"),s.redirect(T.createTransferUrlWithParams({referrer:r,fileids:t}))},r.shouldShowTransferInSplitShare=(e,r)=>e&&r.length>0&&!r.some(e=>e.is_cloud_doc)&&!r.some(S.File.isNoAccessSharedFolder)})),define("modules/clean/react/file_transfers/redux/selectors",["require","exports","tslib","lodash","file-transfers/common/types","modules/clean/react/file_transfers/constants","modules/clean/react/file_transfers/redux/types","modules/clean/react/file_transfers/lib/utils","modules/clean/redux/selectors","modules/clean/redux/namespaces","modules/clean/react/browse/models","modules/clean/react/file_transfers/uploader/types"],(function(e,r,t,n,a,i,s,o,l,u,c,d){"use strict";function f(e,t){if(t===i.NULL_FILE_TRANSFER_KEY)throw Error("This should be used only get already-created transfers");return r.getFileTransfersState(e).transferSummaries[t]||null}function _(e,t){if(t===i.NULL_FILE_TRANSFER_KEY)throw Error("This should be used only get already-created transfers");return r.getFileTransfersState(e).receivedTransferSummaries[t]||null}Object.defineProperty(r,"__esModule",{value:!0}),r.getNumTotalTransfersFromFileTransfersNamespace=r.getBackgroundAndLogoFromFileTransfersNamespace=r.getOnboardingStepsShown=r.getTotalFailedFileCount=r.getTemporarilySavedEmailFormInfo=r.getTrackingParams=r.getUserMetadata=r.getInitialTrafficSource=r.getUserFlow=r.getProductConfig=r.getCompletedOnboardingSteps=r.getRecipients=r.getTransferSizeFromFileTransfersNamespace=r.getItemCountFromFileTransfersNamespace=r.getCurrentExpirationDate=r.getCurrentCreationDate=r.getLogo=r.getDisplayedBackground=r.getBackgroundPreview=r.getBackground=r.getTransferTrackingId=r.isConfirmTransferDeletionModalOpen=r.isManagementModalOpen=r.getCurrentTransferShareStatus=r.getTransferShareStatus=r.getReceivedTransferSummary=r.getTransferSummary=r.getIndexOfTransferId=r.getTransferId=r.getIsShareComplete=r.getIsShared=r.getFileList=r.computeSize=r.getPreviewableFiles=r.getFilesAsFileInfos=r.getRootLevelFilesAsFileInfos=r.getFileListForTransferId=r.getFile=r.getFilesForCurrentTransfer=r.getFiles=r.getActiveUserId=r.getCurrentTransferForEditing=r.getCurrentTransferSummary=r.getListReceivedTransferCursorToken=r.getReceivedTransferSummaries=r.getListTransferCursorToken=r.getTransferSummaries=r.getFileTransfersState=void 0,n=t.__importStar(n),r.getFileTransfersState=e=>l.getStateAtNamespace(e,u.FILE_TRANSFERS_NAMESPACE_KEY),r.getTransferSummaries=(e,t)=>{const n=r.getFileTransfersState(e).transfersList[t].transferIds;return n?n.map(r=>f(e,r)):null},r.getListTransferCursorToken=(e,t)=>r.getFileTransfersState(e).transfersList[t].cursorToken,r.getReceivedTransferSummaries=(e,t)=>{const n=r.getFileTransfersState(e).receivedTransfersList[t].transferIds;return n?n.map(r=>_(e,r)):null},r.getListReceivedTransferCursorToken=(e,t)=>r.getFileTransfersState(e).receivedTransfersList[t].cursorToken,r.getCurrentTransferSummary=e=>{const t=r.getTransferId(e);return t?f(e,t):null},r.getCurrentTransferForEditing=e=>{const t=r.getTransferId(e)||i.NULL_FILE_TRANSFER_KEY;return t&&r.getFileTransfersState(e).transferSummaries[t]||null},r.getActiveUserId=e=>r.getFileTransfersState(e).activeUserId,r.getFiles=e=>r.getFileTransfersState(e).files,r.getFilesForCurrentTransfer=e=>r.getFiles(e)[o.getTransferFilesKey(r.getTransferId(e))],r.getFile=(e,t)=>r.getFilesForCurrentTransfer(e)[t]||null,r.getFileListForTransferId=(e,t)=>{const a=r.getFiles(e),i=o.getTransferFilesKey(t);return i in a?n.sortBy(n.values(a[i]),"path"):null},r.getRootLevelFilesAsFileInfos=e=>{const t=r.getFileList(e,{isAtRoot:!0});if(!t)return null;const n=[];for(const a of t)n.push(o.stateFileInfoAsFileInfo(a,{size:r.computeSize(e,a)}));return n},r.getFilesAsFileInfos=e=>{const t=r.getFileList(e);if(!t)return null;const n=[];for(const a of t)(o.isAtRoot(a)||a.isExpanded)&&n.push(o.stateFileInfoAsFileInfo(a,{size:r.computeSize(e,a)}));return n},r.getPreviewableFiles=e=>{const t=r.getFileList(e);return t?t.map(e=>{const r=e.fileForPreview&&c.File.fromServerObject(JSON.parse(e.fileForPreview));return r&&Object.assign(Object.assign({},r),{name:o.fileNameFromPath(e.path)})}).filter(e=>e):[]},r.computeSize=(e,t)=>{if(!t.isDir)return t.size;const n=r.getFileList(e)||[],a=o.getChildrenFiles(t,n)||[];if(t.size>0)return t.size;let i=0;for(const e of a)i+=e.size;return i},r.getFileList=(e,t)=>{let n=r.getFileListForTransferId(e,r.getTransferId(e));return t?n?(t.isAtRoot&&(n=n.filter(e=>o.isAtRoot(e))),!0===t.isDir?n=n.filter(e=>e.isDir):!1===t.isDir&&(n=n.filter(e=>!e.isDir)),n):null:n},r.getIsShared=e=>r.getFileTransfersState(e).isShared,r.getIsShareComplete=e=>r.getFileTransfersState(e).isShareComplete,r.getTransferId=e=>r.getFileTransfersState(e).transferId,r.getIndexOfTransferId=(e,t)=>{if(null===t)return-1;const n=r.getTransferShareStatus(e,t);let i=null;return n===a.TransferShareStatus.SHARED?i=r.getFileTransfersState(e).transfersList[s.TransferListView.Active]:n===a.TransferShareStatus.EXPIRED&&(i=r.getFileTransfersState(e).transfersList[s.TransferListView.Expired]),i&&i.transferIds?i.transferIds.indexOf(t):-1},r.getTransferSummary=f,r.getReceivedTransferSummary=_,r.getTransferShareStatus=(e,t)=>{if(!t)return null;const n=r.getFileTransfersState(e).transfersList,i=n[s.TransferListView.Active].transferIds;if(i&&i.includes(t))return a.TransferShareStatus.SHARED;const o=n[s.TransferListView.Expired].transferIds;return o&&o.includes(t)?a.TransferShareStatus.EXPIRED:null},r.getCurrentTransferShareStatus=e=>r.getTransferShareStatus(e,r.getTransferId(e)),r.isManagementModalOpen=e=>r.getFileTransfersState(e).managementModalOpen,r.isConfirmTransferDeletionModalOpen=e=>r.getFileTransfersState(e).confirmTransferDeletionModalOpen,r.getTransferTrackingId=e=>r.getFileTransfersState(e).transferTrackingId,r.getBackground=e=>r.getFileTransfersState(e).background,r.getBackgroundPreview=e=>r.getFileTransfersState(e).backgroundPreview,r.getDisplayedBackground=e=>{var t;return null!==(t=r.getBackgroundPreview(e))&&void 0!==t?t:r.getBackground(e)},r.getLogo=e=>r.getFileTransfersState(e).logo,r.getCurrentCreationDate=e=>{const t=r.getCurrentTransferForEditing(e);if(null!==t&&t.creation_time)return new Date(t.creation_time)},r.getCurrentExpirationDate=e=>{const t=r.getCurrentTransferForEditing(e);if(null!==t&&t.expiration_time)return new Date(t.expiration_time)},r.getItemCountFromFileTransfersNamespace=e=>{const r=e.files[o.getTransferFilesKey(e.transferId)];if(!r)return{computerItemCount:0,dropboxItemCount:0,totalItemCount:0};const t=n.values(r),a=t.filter(e=>e.originalSource===d.OriginalFileSource.Computer),i=t.filter(e=>e.originalSource===d.OriginalFileSource.Dropbox);return{computerItemCount:n.size(a),dropboxItemCount:n.size(i),totalItemCount:n.size(t)}},r.getTransferSizeFromFileTransfersNamespace=e=>{const r=e.files[o.getTransferFilesKey(e.transferId)];if(!r)return null;const t=n.values(r);return n.reduce(t,(e,r)=>e+r.size,0)},r.getRecipients=e=>{const t=o.getTransferFilesKey(r.getTransferId(e));return t?r.getFileTransfersState(e).recipients[t]:null},r.getCompletedOnboardingSteps=e=>r.getFileTransfersState(e).completedOnboardingSteps,r.getProductConfig=e=>r.getFileTransfersState(e).productConfig,r.getUserFlow=e=>r.getFileTransfersState(e).userFlow,r.getInitialTrafficSource=e=>r.getFileTransfersState(e).initialTrafficSource,r.getUserMetadata=e=>r.getFileTransfersState(e).userMetadata,r.getTrackingParams=e=>r.getFileTransfersState(e).trackingParams,r.getTemporarilySavedEmailFormInfo=e=>r.getFileTransfersState(e).temporarilySavedEmailFormInfo,r.getTotalFailedFileCount=e=>r.getFileTransfersState(e).totalFailedFileCount,r.getOnboardingStepsShown=e=>r.getFileTransfersState(e).onboardingStepsShown,r.getBackgroundAndLogoFromFileTransfersNamespace=e=>{var r,t;return{background_id:(null===(r=e.background)||void 0===r?void 0:r.background_id)||null,logo_id:(null===(t=e.logo)||void 0===t?void 0:t.asset_id)||null}},r.getNumTotalTransfersFromFileTransfersNamespace=e=>{var r;return(null===(r=e.productConfig)||void 0===r?void 0:r.constants.numTotalTransfers)||null}})),define("modules/clean/react/file_transfers/redux/types",["require","exports"],(function(e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Actions=r.TransferListView=r.SettingsVisibilityChange=r.ModalVisibilityChange=r.UserFlow=void 0,(function(e){e.TRANSFER_MANAGEMENT_MODAL="transfer_management_modal",e.MANAGEMENT_LIST_VIEW="management_list_view",e.CREATION="creation",e.RECIPIENT="recipient",e.BROWSE="browse"})(r.UserFlow||(r.UserFlow={})),(function(e){e.OPEN="open",e.CANCEL="cancel",e.OK="ok"})(r.ModalVisibilityChange||(r.ModalVisibilityChange={})),(function(e){e.OPEN="open",e.CLOSE="close"})(r.SettingsVisibilityChange||(r.SettingsVisibilityChange={})),(function(e){e[e.Active=0]="Active",e[e.Expired=1]="Expired"})(r.TransferListView||(r.TransferListView={})),(function(e){e.ChangeSettingsModalState="FileTransfers/ChangeSettingsModalState",e.ChangeConfirmTransferDeletionModalState="FileTransfers/ChangeConfirmTransferDeletionModalState",e.CopyTransferLink="FileTransfers/CopyTransferLink",e.DeleteTransferSummary="FileTransfers/DeleteTransferSummary",e.ExpireTransferSummary="FileTransfers/ExpireTransferSummary",e.ReactivateTransferSummary="FileTransfers/ReactivateTransferSummary",e.FinishedEditing="FileTransfers/FinishedEditing",e.HideOnboardingStep="FileTransfers/HideOnboardingStep",e.InitApp="FileTransfers/InitApp",e.LogAllItemsUploaded="FileTransfers/LogAllItemsUploaded",e.LogAutoDownload="FileTransfers/LogAutoDownload",e.LogOnboarding="FileTransfers/LogOnboarding",e.LogEmailFeedback="FileTransfers/LogEmailFeedback",e.LogUpsell="FileTransfers/LogUpsell",e.MarkOnboardingStepComplete="FileTransfers/MarkOnboardingStepComplete",e.MarkServerRestrictedFiles="FileTransfers/MarkServerRestrictedFiles",e.MetadataUpdated="FileTransfers/MetadataUpdated",e.SendTransferViaEmail="FileTransfers/SendTransferViaEmail",e.TrackUserLeapEvent="FileTransfers/TrackUserLeapEvent",e.ReceivedTransferRowClick="FileTransfers/ReceivedTransferRowClick",e.SetActiveUserId="FileTransfers/SetActiveUserId",e.SetBackground="FileTransfers/SetBackground",e.SetBackgroundPreview="FileTransfers/SetBackroundPreview",e.SetLogo="FileTransfers/SetLogo",e.SaveLogo="FileTransfers/SaveLogo",e.SetCurrentTransfer="FileTransfers/SetCurrentTransfer",e.SetExpiration="FileTransfers/SetExpiration",e.SetIsShared="FileTransfers/SetShareStatus",e.SetIsShareComplete="FileTransfer/SetShareComplete",e.ChangeManagementModalState="FileTransfers/ChangeManagementModalState",e.SetProductConfig="FileTransfers/SetProductConfig",e.SetRecipients="FileTransfers/SetRecipients",e.SetShareUrl="FileTransfers/SetShareUrl",e.SetFileTransfersUserMetadata="FileTransfers/SetFileTransfersUserMetadata",e.UpdateTransferSummaries="FileTransfers/UpdateTransferSummaries",e.UpdateReceivedTransferSummaries="FileTransfers/UpdateReceivedTransferSummaries",e.ViewFeedbackForm="FileTransfers/ViewFeedbackForm",e.TemporarilySaveEmailFormInfo="FileTransfers/TemporarilySaveEmailFormInfo",e.ClearSavedEmailFormInfo="FileTransfers/ClearSavedEmailFormInfo",e.LogInternetDisconnected="FileTransfers/LogInternetDisconnected",e.LogOnboardingStepShown="FileTransfers/LogOnboardingStepShown",e.MarkOnboardingStepShown="FileTransfers/MarkOnboardingStepShown",e.CollapseDirectory="FileTransfers/CollapseDirectory",e.ExpandDirectory="FileTransfers/ExpandDirectory",e.LogShareError="FileTransfers/LogShareError",e.LogExperimentExposure="FileTransfers/LogExperimentExposure",e.UpdateSettingsFromManagementModal="FileTransfers/UpdateSettingsFromManagementModal",e.LogSettingsClicked="LogSettingsClicked"})(r.Actions||(r.Actions={}))})),define("modules/clean/react/file_transfers/uploader/types",["require","exports"],(function(e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.UploaderType=r.UploadCancelSource=r.UploadErrorType=r.UploadActionSource=r.OriginalFileSource=r.FileSource=r.UploadStatus=void 0,(function(e){e[e.Waiting=0]="Waiting",e[e.Uploading=1]="Uploading",e[e.Success=2]="Success",e[e.Error=3]="Error"})(r.UploadStatus||(r.UploadStatus={})),(function(e){e.Dropbox="dropbox",e.Computer="computer",e.Transfer="transfer"})(r.FileSource||(r.FileSource={})),(function(e){e.Dropbox="dropbox",e.Computer="computer",e.Unknown="unknown"})(r.OriginalFileSource||(r.OriginalFileSource={})),(function(e){e.DRAG_DROP="drag_drop",e.DROPBOX_CHOOSER_ADDITIONAL="dropbox_chooser_additional",e.DROPBOX_CHOOSER_INITIAL="dropbox_chooser_initial",e.UPLOAD_BUTTON_ADDITIONAL="upload_button_additional",e.UPLOAD_BUTTON_INITIAL="upload_button_initial",e.DESKTOP_CONTEXT_MENU="desktop_context_menu",e.PAGELET_ON_LOAD="pagelet_on_load"})(r.UploadActionSource||(r.UploadActionSource={})),(function(e){e.EmptyFile="empty_file",e.IgnoredFile="ignored_file",e.OverMaxFileSize="over_max_file_size",e.PointerFile="pointer_file",e.TemporaryFile="temporary_file",e.InvalidChar="invalid_char",e.NotFound="not_found",e.NoPermission="no_permission",e.Restricted="restricted",e.InvalidArgs="invalid_args",e.Unknown="unknown"})(r.UploadErrorType||(r.UploadErrorType={})),(function(e){e.CancelButton="cancel_button",e.WindowClose="window_close"})(r.UploadCancelSource||(r.UploadCancelSource={})),(function(e){e.Pluploader="pluploader",e.UploadKitBasic="upload_kit_basic",e.UploadKitParallel="upload_kit_parallel"})(r.UploaderType||(r.UploaderType={}))})),define("file-transfers/i18n/index",["require","exports","tslib","react","prop-types","react-intl"],(function(e,r,t,n,a,i){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.TranslationProvider=void 0,n=t.__importStar(n),a=t.__importDefault(a);class s extends n.Component{getChildContext(){return{formatBytes:this.props.formatBytes,isEnvExternal:this.props.isEnvExternal,applyTranslation:this.props.applyTranslation}}render(){return n.createElement(i.RawIntlProvider,{value:this.props.intl},this.props.children)}}r.TranslationProvider=s,s.displayName="TranslationProvider",s.childContextTypes={formatBytes:a.default.func,isEnvExternal:a.default.bool,applyTranslation:a.default.func}}));
//# sourceMappingURL=pkg-file-transfers.min.js-vflQP-VxP.map