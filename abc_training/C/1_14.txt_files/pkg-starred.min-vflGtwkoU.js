define("modules/clean/react/starred/actions",["require","exports","tslib","modules/clean/flux/dispatcher","modules/clean/react/starred/api","modules/clean/react/starred/constants","modules/clean/react/starred/model","modules/core/i18n","modules/clean/react/snackbar"],(function(e,t,r,a,s,o,i,n,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StarredActions=void 0,s=r.__importStar(s);class l{static setStarredStatus(e,t){a.Dispatcher.dispatch({type:o.StarredActionTypes.SET_STATUS,starredStatuses:[{idTypePair:e,starred:t}]})}static fetchStatuses(e,t,r=!1){return r||l.markAsLoading(t),s.fetchStatuses(e,t).then(e=>{a.Dispatcher.dispatch({type:o.StarredActionTypes.SET_STATUS,starredStatuses:i.statusResultsToStarredStatuses(e)})}).catch(e=>(a.Dispatcher.dispatch({type:o.StarredActionTypes.LOAD_FAILURE,idTypePairs:t}),Promise.reject(e)))}static markAsLoading(e){a.Dispatcher.dispatch({type:o.StarredActionTypes.LOADING,idTypePairs:e})}static update(e,t,r,i){const n={id:t,type:r};let d;a.Dispatcher.dispatch({type:o.StarredActionTypes.LOADING,idTypePairs:[n]});const l=s.update(e,t,r,i);return l.then(()=>d=i).catch(e=>{throw d=!i,e}).finally(()=>{a.Dispatcher.dispatch({type:o.StarredActionTypes.SET_STATUS,starredStatuses:[{idTypePair:{id:t,type:r},starred:d}]})}),l}static updateWithSnackbar(e,t,r,a,s){return l.update(e,t,r,a).then(()=>{let e;e=s?a?n.intl.formatMessage({id:"m96IvY",defaultMessage:"Starred {itemName}."},{itemName:s}):n.intl.formatMessage({id:"Yn2gx1",defaultMessage:"Unstarred {itemName}."},{itemName:s}):a?n.intl.formatMessage({id:"IxGSEU",defaultMessage:"Starred."},{itemName:s}):n.intl.formatMessage({id:"RZWOu0",defaultMessage:"Unstarred."},{itemName:s}),d.Snackbar.complete(e,"star-action")}).catch(e=>{let t;s?t=a?n.intl.formatMessage({id:"5O9Xva",defaultMessage:"There was a problem starring {item_name}"},{item_name:s}):n.intl.formatMessage({id:"CvW0nU",defaultMessage:"There was a problem unstarring {item_name}"},{item_name:s}):(t=a?n.intl.formatMessage({id:"jouX9E",defaultMessage:"There was a problem starring your selection"}):n.intl.formatMessage({id:"TkdYlT",defaultMessage:"There was a problem unstarring your selection"}),d.Snackbar.fail(t))})}}t.StarredActions=l})),define("modules/clean/react/starred/api",["require","exports","modules/clean/deprecated_ajax/ajax_jquery"],(function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.update=t.fetchStatuses=void 0;const a=(e,t,a)=>new Promise((s,o)=>{(a?r.SilentBackgroundRequest:r.WebRequest)({url:e,type:"POST",dataType:"json",data:t,success:s,error:(e,t,r)=>o(Error(`error: ${r}, status: ${t}`))})});t.fetchStatuses=(e,t)=>a("/starred/get_status",{role:e,resources_json:JSON.stringify(t)},!0),t.update=(e,t,r,s)=>a("/starred/update",{role:e,resource_id:t,id_type:r,is_starred:s},!0)})),define("modules/clean/react/starred/star",["require","exports","tslib","classnames","react","dig-components/icons","dig-components/icons/src","dig-components/tooltips","modules/clean/react/components/css","modules/clean/react/starred/actions","modules/clean/react/starred/starred_activity_logger","modules/clean/react/starred/store","modules/core/i18n"],(function(e,t,r,a,s,o,i,n,d,l,c,u,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Star=void 0,a=r.__importDefault(a),s=r.__importDefault(s);class m extends s.default.PureComponent{constructor(e){super(e),this.onStoreUpdate=()=>{const e=this.getStateFromStore();this.setState(e)},this.onClick=e=>{if(e.stopPropagation(),e.preventDefault(),!this.state.isLoading){const e=!this.state.isStarred,{id:t,idType:r,isDir:a,itemName:s,onStarClick:o,source:i,user:n}=this.props;c.starredActivityLogger.logClick(n,t,r,a,i,e),o&&o(e),l.StarredActions.updateWithSnackbar(n.role,t,r,e,s)}},this.state=this.getStateFromStore(),this.removeStoreListener=u.StarredStore.addListener(this.onStoreUpdate)}componentWillUnmount(){this.removeStoreListener&&this.removeStoreListener()}UNSAFE_componentWillReceiveProps(e){this.props.id===e.id&&this.props.idType===e.idType||this.setState(this.getStateFromStore(e))}getStateFromStore(e=this.props){const t={id:e.id,type:e.idType};return{isLoading:u.StarredStore.getIsLoading(t),isStarred:u.StarredStore.getIsStarred(t)}}getTooltipContent(){return this.props.isReadOnly?this.state.isStarred?p.intl.formatMessage({id:"LAVXPn",defaultMessage:"Starred"}):null:this.state.isStarred?p.intl.formatMessage({id:"XQNf7s",defaultMessage:"Remove from Starred"}):p.intl.formatMessage({id:"iGfiaV",defaultMessage:"Add to Starred"})}render(){const{starButtonClassName:e,alwaysShowUnstarred:t}=this.props;if(void 0===this.state.isStarred)return null;if(this.props.isReadOnly&&!this.state.isStarred)return null;const r={star__toggle:!0,"star__toggle--starred":this.state.isStarred,"star__toggle--unstarred":!this.state.isStarred&&!this.props.isTabbing&&!t,"star__toggle--loading":this.state.isLoading},d=this.getTooltipContent();return s.default.createElement(n.Tooltip,{title:d,placement:this.props.tooltipPlacement||"top"},s.default.createElement("button",{className:a.default(r,e),role:"button","aria-pressed":this.state.isStarred,"aria-label":d,onClick:this.onClick,onDoubleClick:this.onClick,disabled:this.props.isReadOnly,tabIndex:this.props.tabIndex},s.default.createElement(o.UIIcon,{src:this.state.isStarred?i.StarFill:i.StarLine})))}}m.displayName="Star",t.Star=d.requireCssWithComponent(m,["/static/css/starred/star-vflRNeO9W.css"])})),define("modules/clean/react/starred/starred_activity_logger",["require","exports","modules/clean/react/home/api","modules/clean/react/home/starred/constants","modules/clean/react/starred/constants","modules/clean/web_user_action_logger","modules/clean/web_user_action_events"],(function(e,t,r,a,s,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.starredActivityLogger=t.StarredActivityLogger=void 0;const n=[s.StarredSource.HOME_STARRED,s.StarredSource.HOME_RECENTS];class d{logClick(e,t,s,d,l,c){if("BROWSE"===l)return Promise.resolve();const u=[];if(n.includes(l)){const o=c?a.StarredLoggingTypes.CLICK_STAR:a.StarredLoggingTypes.CLICK_UNSTAR;u.push(r.logHomeActivity({eventName:o,role:e.role,extra:{resource_id:t,id_type:s,is_dir:d}}))}const p=c?i.WebUserActionLogEvent.STAR:i.WebUserActionLogEvent.REMOVE_STAR;return u.push(o.WebUserActionLog.log(e.id,p,{resource_id:t,id_type:s,is_dir:d,role:e.role,source:l})),Promise.all(u)}}t.StarredActivityLogger=d,t.starredActivityLogger=new d})),define("modules/clean/react/starred/store",["require","exports","tslib","lodash","modules/clean/flux/dispatcher","modules/clean/flux/flux_store","modules/clean/react/starred/constants","modules/clean/react/home/starred/constants","modules/clean/react/starred/id_type_pair"],(function(e,t,r,a,s,o,i,n,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StarredStore=t._StarredStoreClass=void 0,a=r.__importStar(a);class l extends o.FluxStore{constructor(){super(s.Dispatcher),this.idsToLoadingState={},this.idsToStarred={}}getLoadingStates(){return this.idsToLoadingState}hasIdTypePair(e){return this.idsToLoadingState.hasOwnProperty(d.idTypePairToString(e))}getLoadingState(e){return this.idsToLoadingState[d.idTypePairToString(e)]}getIsStarred(e){return this.idsToStarred[d.idTypePairToString(e)]}getAllStarredPairStrings(){return Object.keys(a.pickBy(this.idsToStarred,e=>e))}getIsLoading(e){return this.getLoadingState(e)===i.StarredLoadingState.LOADING}onLoading(e){const t={};e.forEach(e=>t[d.idTypePairToString(e)]=i.StarredLoadingState.LOADING),this.idsToLoadingState=Object.assign(Object.assign({},this.idsToLoadingState),t)}onSetStatus(e=[]){const t={},r={};e.forEach(e=>{const a=d.idTypePairToString(e.idTypePair);t[a]=i.StarredLoadingState.LOAD_SUCCESS,r[a]=e.starred}),this.idsToLoadingState=Object.assign(Object.assign({},this.idsToLoadingState),t),this.idsToStarred=Object.assign(Object.assign({},this.idsToStarred),r)}onLoadFailure(e){const t={};e.forEach(e=>{const r=d.idTypePairToString(e),a=this.idsToLoadingState[r];void 0!==a&&a!==i.StarredLoadingState.LOADING||(t[r]=i.StarredLoadingState.LOAD_FAILED)}),this.idsToLoadingState=Object.assign(Object.assign({},this.idsToLoadingState),t)}__onDispatch(e){const t=e.action;switch(t.type){case i.StarredActionTypes.LOADING:this.onLoading(t.idTypePairs),this.__emitChange();break;case i.StarredActionTypes.SET_STATUS:case n.StarredResourceActionTypes.LOAD_SUCCESS:this.onSetStatus(t.starredStatuses),this.__emitChange();break;case i.StarredActionTypes.LOAD_FAILURE:this.onLoadFailure(t.idTypePairs),this.__emitChange();break;default:return}}}t._StarredStoreClass=l,t.StarredStore=new l})),define("modules/clean/react/starred/model",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.statusResultsToStarredStatuses=void 0,t.statusResultsToStarredStatuses=function(e){return e.map(e=>{const{id:t,type:r,is_starred:a,canonical_id:s,canonical_id_type:o}=e,i={idTypePair:{id:t,type:r},starred:a};return s&&o&&(i.canonicalIdTypePair={id:s,type:o}),i})}})),define("modules/clean/react/home/starred/constants",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.INITIAL_STARRED_ITEMS_LIMIT=t.LOAD_ALL_ITEMS_COUNT=t.StarredLoadingTypes=t.StarredLoggingTypes=t.NOT_PAPER_USER_ERROR=t.StarredResourceActionTypes=void 0,t.StarredResourceActionTypes={LOADING_INITIAL:"HOME_STARRED_LOADING_INITIAL",LOADING_ALL:"HOME_STARRED_LOADING_ALL",LOAD_SUCCESS:"HOME_STARRED_LOAD_SUCCESS",LOAD_FAILURE:"HOME_STARRED_LOAD_FAILURE",HIDE_EMPTY_SECTION:"HOME_STARRED_HIDE_EMPTY_SECTION"},t.NOT_PAPER_USER_ERROR="not_paper_user",t.StarredLoggingTypes={CLICK_STAR:"click_star",CLICK_UNSTAR:"click_unstar"},t.StarredLoadingTypes={INITIAL:"INITIAL",ALL:"ALL"},t.LOAD_ALL_ITEMS_COUNT=1e3,t.INITIAL_STARRED_ITEMS_LIMIT=5})),define("modules/clean/react/home/starred/conditional_interface",["require","exports","modules/clean/react/home/starred/starred_resource_store","modules/clean/react/starred/star","modules/clean/react/home/recents/recent_activity_starred","modules/clean/react/home/starred/starred_view","modules/clean/react/starred/id_type_pair","modules/clean/react/files_page/data/store","modules/clean/react/files_page/data/action_creators"],(function(e,t,r,a,s,o,i,n,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.filesPageAppInit=t.getStoreForFilesPage=t.idTypePairToString=t.StarredView=t.getIdTypePairFromRecentItem=t.Star=t.getStarredResourceStore=void 0,Object.defineProperty(t,"getStarredResourceStore",{enumerable:!0,get:function(){return r.getStarredResourceStore}}),Object.defineProperty(t,"Star",{enumerable:!0,get:function(){return a.Star}}),Object.defineProperty(t,"getIdTypePairFromRecentItem",{enumerable:!0,get:function(){return s.getIdTypePairFromRecentItem}}),Object.defineProperty(t,"StarredView",{enumerable:!0,get:function(){return o.StarredView}}),Object.defineProperty(t,"idTypePairToString",{enumerable:!0,get:function(){return i.idTypePairToString}}),Object.defineProperty(t,"getStoreForFilesPage",{enumerable:!0,get:function(){return n.getStoreForFilesPage}}),Object.defineProperty(t,"filesPageAppInit",{enumerable:!0,get:function(){return d.appInit}})})),define("modules/clean/react/home/starred/actions",["require","exports","tslib","modules/clean/flux/dispatcher","modules/clean/react/home/starred/constants","modules/clean/react/home/starred/models/starred_item","modules/clean/react/starred/model","modules/clean/react/home/starred/models/starred_item","modules/core/exception","modules/core/exception"],(function(e,t,r,a,s,o,i,n,d,l){"use strict";function c(e,t){return a.Dispatcher.dispatch({type:s.StarredResourceActionTypes.LOAD_FAILURE,error:t,loadingType:e}),t}Object.defineProperty(t,"__esModule",{value:!0}),t.StarredActions=t.onRetrieveStarredError=void 0,l=r.__importStar(l),t.onRetrieveStarredError=c;class u{static handleRetrieveStarredPayload(e,t,r){if("success"!==r.status)throw c(t,r.status);{if(!r.items||void 0===r.has_more)throw d.reportStack("Home starred items request returned success without items or hasMore",{severity:d.SEVERITY.NONCRITICAL}),c(t,new Error("Invalid server response for Starred getItems"));const n=r.items.map(o.starredItemFromJson),l=i.statusResultsToStarredStatuses(n.map(o.starredItemModelToStarredStatus));a.Dispatcher.dispatch({type:s.StarredResourceActionTypes.LOAD_SUCCESS,hasMore:r.has_more,items:n,starredStatuses:l,loadingType:t}),e().then(({getStarredStatusMetadata:e})=>e(l))}}static handleEdisonStarredData(e,t,r){if(r.jsonData){let t;t=JSON.parse(r.jsonData),u.handleRetrieveStarredPayload(e,s.StarredLoadingTypes.ALL,t)}else if("success"===r.status){const o=n.edisonStarredDataToStarredStatus(r);a.Dispatcher.dispatch({type:s.StarredResourceActionTypes.LOAD_SUCCESS,hasMore:Boolean(r.hasMore),items:r.items,starredStatuses:o,loadingType:t}),e().then(({getStarredStatusMetadata:e})=>e(o))}else{const e=new Error("EdisonStarredPrefetchFailure");l.reportException({err:e,severity:l.SEVERITY.CRITICAL,exc_extra:{starredData:JSON.stringify(r)}}),a.Dispatcher.dispatch({type:s.StarredResourceActionTypes.LOAD_FAILURE,loadError:e,loadingType:t})}}}t.StarredActions=u})),define("modules/clean/react/home/starred/models/starred_item",["require","exports","modules/clean/react/home/constants"],(function(e,t,r){"use strict";function a(e,t){const a=r.DisplayTypeToResourceType[e];if(a===r.FILE_RESOURCE_TYPE){return{fqPath:t.fq_path}}if(a===r.FOLDER_RESOURCE_TYPE){const e=t;return{fqPath:e.fq_path,targetNsId:e.target_ns_id,isTeamMemberFolder:e.is_team_member_folder}}return{}}Object.defineProperty(t,"__esModule",{value:!0}),t.starredItemModelToStarredStatus=t.edisonStarredDataToStarredStatus=t.detailsFromJson=t.starredItemFromJson=void 0,t.starredItemFromJson=function(e){return{title:e.title,resourceId:e.resource_id,idType:e.id_type,displayType:e.display_type,url:e.url,isMounted:e.is_mounted,perNodeMetadata:e.per_node_metadata,details:a(e.display_type,e.details),icon:e.icon}},t.detailsFromJson=a,t.edisonStarredDataToStarredStatus=function(e){return e.items.map(e=>({idTypePair:{id:e.resourceId,type:e.idType},starred:!0}))},t.starredItemModelToStarredStatus=function(e){return{id:e.resourceId,type:e.idType,is_starred:!0}}})),define("modules/clean/react/home/starred/starred_item_list",["require","exports","tslib","react","react-dom","modules/clean/react/common/rendering","modules/clean/react/home/post_tti/api","modules/clean/react/home/starred/constants","modules/clean/react/home/starred/starred_empty_state","modules/clean/react/home/util/logging/activity_logger","modules/clean/react/home/util/show_hide_link","modules/clean/react/home/starred/starred_table"],(function(e,t,r,a,s,o,i,n,d,l,c,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StarredItemList=void 0,a=r.__importDefault(a),s=r.__importDefault(s);const p=o.withSuspenseNoSSR(a.default.lazy(()=>r.__awaiter(void 0,void 0,void 0,(function*(){const{FilesPageActionBar:t}=yield new Promise((t,r)=>{e(["modules/clean/react/files_page/actionBar/files_page_action_bar"],t,r)}).then(r.__importStar);return{default:t}}))));class m extends a.default.PureComponent{constructor(e){super(e),this.toggleShowAll=()=>r.__awaiter(this,void 0,void 0,(function*(){const e=!this.state.showAll;if(l.homeActivityLogger.logClickShowAll("starred",e),this.setState({showAll:e}),e&&this.props.hasMore){const{loadAllStarredItems:e}=yield i.waitForHomeTTI();e()}const t=s.default.findDOMNode(this.refs.lastUnhiddenStar);if(t){const e=t.querySelector("a");e&&e.focus()}})),this.state={showAll:e.showAll}}render(){const{itemModels:e}=this.props,{showAll:t}=this.state,r="STARRED"===this.props.pageType&&this.props.useStarredActionBar,s=Math.max(e.length-n.INITIAL_STARRED_ITEMS_LIMIT,0),o=s&&!t?e.slice(0,n.INITIAL_STARRED_ITEMS_LIMIT):e;let i=a.default.createElement(d.StarredEmptyState,null);return o.length&&(i=a.default.createElement(u.StarredTable,{items:o,withSelection:r})),a.default.createElement("div",{className:"starred"},a.default.createElement("div",{className:"starred-container"},r&&a.default.createElement(p,null),i,!this.props.showAll&&s?a.default.createElement(c.ShowHideLink,{onClick:this.toggleShowAll,isExpanded:t,hiddenItemCount:s,canLoadMore:!1}):null))}}t.StarredItemList=m,m.displayName="StarredItemList"})),define("modules/clean/react/home/starred/starred_resource_store",["require","exports","modules/clean/flux/dispatcher","modules/clean/react/home/constants","modules/clean/react/home/starred/constants","modules/clean/react/starred/constants","modules/clean/react/home/starred/actions","modules/clean/react/starred/store","modules/clean/react/home/util/logging/availability_logger","modules/clean/flux/flux_store","modules/clean/react/home/post_tti/api"],(function(e,t,r,a,s,o,i,n,d,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getStarredResourceStore=t.PrivateStarredResourceStoreClass=void 0;class u extends l.FluxStore{constructor(e){super(r.Dispatcher),this.orderedIds=[],this.itemsById={},this.loadingState=a.LoadingStates.LOADING,this.hasMore=!0,this.hasLoadedInitial=!1,this.hasLoadedAll=!1,this.isPaperUser=!0,e?i.StarredActions.handleEdisonStarredData(c.waitForHomeTTI,s.StarredResourceActionTypes.LOADING_INITIAL,e):d.getHomeAvailabilityLogger().handlePrefetch(a.HomePrefetchTypes.RETRIEVE_STARRED,e=>i.StarredActions.handleRetrieveStarredPayload(c.waitForHomeTTI,s.StarredResourceActionTypes.LOADING_INITIAL,e))}getStarredStore(){return n.StarredStore}clearPresentableItemsCache(){this.presentableItemsCache=null}getItems(){return this.presentableItemsCache||(this.presentableItemsCache=this.orderedIds.map(e=>this.itemsById[e]).filter(e=>{const t={id:e.resourceId,type:e.idType},r=this.getStarredStore().getLoadingState(t),a=this.getStarredStore().getIsStarred(t);return r===o.StarredLoadingState.LOADING||a})),this.presentableItemsCache}getItem(e){return this.itemsById[e]}getLoadingState(){return this.loadingState}getHasMore(){return this.hasMore}getHasLoadedInitial(){return this.hasLoadedInitial}getHasLoadedAll(){return this.hasLoadedAll}getIsPaperUser(){return this.isPaperUser}onItemsLoading(){this.loadingState=a.LoadingStates.LOADING}onItemsLoadSuccess(e,t){e.forEach(e=>{this.itemsById[e.resourceId]=e}),this.loadingState=a.LoadingStates.SUCCESS,this.orderedIds=e.map(e=>e.resourceId),this.hasMore=t,e.length&&this.clearPresentableItemsCache()}onItemsLoadFailure(e){this.loadingState=a.LoadingStates.FAILURE,e&&e===s.NOT_PAPER_USER_ERROR&&(this.isPaperUser=!1)}onItemsLoadComplete(e,t){e!==s.StarredLoadingTypes.INITIAL&&t||(this.hasLoadedInitial=!0),e!==s.StarredLoadingTypes.ALL&&t||(this.hasLoadedAll=!0)}onStatusChange(){c.waitForHomeTTI().then(({loadAllStarredItems:e})=>e()),this.clearPresentableItemsCache()}__onDispatch(e){const t=e.action;switch(t.type){case s.StarredResourceActionTypes.LOADING_INITIAL:case s.StarredResourceActionTypes.LOADING_ALL:this.onItemsLoading(),this.__emitChange();break;case s.StarredResourceActionTypes.LOAD_SUCCESS:this.onItemsLoadSuccess(t.items,t.hasMore),this.onItemsLoadComplete(t.loadingType,t.hasMore),this.__emitChange();break;case s.StarredResourceActionTypes.LOAD_FAILURE:this.onItemsLoadFailure(t.error),this.onItemsLoadComplete(t.loadingType,!0),this.__emitChange();break;case o.StarredActionTypes.LOADING:this.clearPresentableItemsCache(),this.__emitChange();break;case o.StarredActionTypes.SET_STATUS:this.onStatusChange(),this.__emitChange()}}}t.PrivateStarredResourceStoreClass=u;let p=null;t.getStarredResourceStore=function(e){return null===p&&(p=new u(e)),p}})),define("modules/clean/react/home/starred/starred_view",["require","exports","tslib","react","react-redux","modules/clean/react/files_page/data/store","modules/clean/react/files_page/data/action_creators","modules/clean/react/home/constants","modules/clean/react/home/starred/constants","modules/clean/react/home/starred/starred_item_list","modules/clean/react/home/starred/starred_layout","modules/clean/react/home/store","modules/clean/react/home/starred/starred_resource_store","modules/clean/react/home/util/logging/activity_logger","modules/clean/react/home/util/logging/timing_component","modules/clean/react/home/util/logging/timing_logger"],(function(e,t,r,a,s,o,i,n,d,l,c,u,p,m,S,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StarredView=t.StarViewWithFilesPage=void 0,a=r.__importDefault(a);class g extends a.default.PureComponent{constructor(e){super(e),this.onStoreUpdate=()=>this.setState(this.getStateFromStore()),this.removeStoreListener=p.getStarredResourceStore().addListener(this.onStoreUpdate),this.state=Object.assign({showAll:"STARRED"===e.pageType,pageType:e.pageType},this.getStateFromStore())}getStateFromStore(){const e=p.getStarredResourceStore(),t=e.getLoadingState(),r=e.getItems(),a=e.getHasMore(),s=e.getHasLoadedInitial();if(t===n.LoadingStates.SUCCESS){if(h.homeTimingLogger.logTTData(n.HomeSections.STARRED)){const e=r.length>d.INITIAL_STARRED_ITEMS_LIMIT;m.homeActivityLogger.logStarredShown(r.length,e,a)}}return{itemModels:r,hasLoadedInitial:s,hasMore:a,canShowSpinner:t===n.LoadingStates.LOADING&&!e.getHasLoadedAll()}}componentWillUnmount(){this.removeStoreListener&&this.removeStoreListener()}render(){const{canRenderItems:e,isHiddenByUser:r,useStarredActionBar:s}=this.props;return a.default.createElement(t.StarViewWithFilesPage,null,a.default.createElement(a.default.Fragment,null,e?a.default.createElement(c.StarredLayout,Object.assign({isHiddenByUser:r,showHeader:"HOME"===this.state.pageType,starredComponent:l.StarredItemList,useStarredActionBar:s},this.state)):null))}}g.displayName="StarredView",t.StarViewWithFilesPage=({children:e})=>{const t=a.default.useMemo(()=>{const e=o.getStoreForFilesPage();return e.dispatch(i.appInit({user:u.getUser()})),e},[]);return a.default.createElement(s.Provider,{store:t},e)},t.StarViewWithFilesPage.displayName="StarViewWithFilesPage",t.StarredView=S.timingComponent(g,n.HomeSections.STARRED)})),define("modules/clean/react/home/starred/starred_uri_interface",["require","exports","modules/clean/react/home/constants","modules/clean/browse_uri_interface"],(function(e,t,r,a){"use strict";function s(e){return r.DisplayTypeToResourceType[e.displayType]===r.FOLDER_RESOURCE_TYPE}Object.defineProperty(t,"__esModule",{value:!0}),t.isFolder=t.href_for_file=void 0,t.href_for_file=function(e,t,r={}){var o;if(s(t))return t.url;const i=null===(o=t.details)||void 0===o?void 0:o.fqPath;return i?a.preview_uri_for_fq_path(e,i,r).toString():t.url},t.isFolder=s})),define("modules/clean/react/home/util/paper_utils",["require","exports","modules/clean/navigation"],(function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sharePaperDoc=void 0,t.sharePaperDoc=function(e,t){r.logAndNavigate(`${e}?openSharing=1`,t)}})),define("modules/clean/react/home/recents/recent_activity_starred",["require","exports","tslib","lodash","modules/clean/react/starred/id_type_pair"],(function(e,t,r,a,s){"use strict";function o(e){return e.resource_id&&e.id_type?{id:e.resource_id,type:e.id_type}:null}Object.defineProperty(t,"__esModule",{value:!0}),t.getIdTypePairFromRecentItem=t.getIdTypePairsByRecentActivityItems=t.getIdTypePair=void 0,a=r.__importStar(a),t.getIdTypePair=o,t.getIdTypePairsByRecentActivityItems=function(e){const t={};return e.forEach(e=>{const r=o(e);r&&(t[s.idTypePairToString(r)]=r)}),a.values(t)},t.getIdTypePairFromRecentItem=function(e){return e.resourceId&&e.idType?{id:e.resourceId,type:e.idType}:null}})),define("modules/clean/search/logger",["require","exports","modules/clean/analytics","modules/clean/search/api_helpers"],(function(e,t,r,a){"use strict";function s(e,t){const r=e;return Object.assign(Object.assign({},t),{file_nsid:r.ns_id,file_sjid:r.sjid,match_type:r.match_type||void 0})}Object.defineProperty(t,"__esModule",{value:!0}),t.logHoverPreviewFailed=t.logHoverPreviewCompleted=t.logHoverPreviewStarted=t.logRecentHistoryDisplayed=t.SearchLogResultType=void 0,(function(e){e.SHARED_DOC="shared_doc",e.SHARED_CLOUD_DOC="shared_cloud_doc"})(t.SearchLogResultType||(t.SearchLogResultType={})),t.logRecentHistoryDisplayed=function({searchSessionId:e,user:t,history:s}){const o=a.getCurrentTimezoneOffset(),i=s.map(e=>e.rawQuery).reduce((e,t,r)=>(e[r]=t,e),{}),n={search_session_id:e,recent_history_map:JSON.stringify(i),timezone_offset:o,viewport:"dropdown-view"};r.SearchClientActivityLogger.log("recent_history_displayed",t.id,n)},t.logHoverPreviewStarted=function({searchSessionId:e,result:t,user:o,previewRequestId:i,viewport:n="dropdown-view"}){const d={search_session_id:e,preview_request_id:i,timezone_offset:a.getCurrentTimezoneOffset(),viewport:n};r.SearchClientActivityLogger.log("preview_started",o.id,s(t,d))},t.logHoverPreviewCompleted=function({searchSessionId:e,result:t,user:o,previewRequestId:i,viewport:n="dropdown-view",latency:d,displayed:l}){const c={search_session_id:e,preview_request_id:i,timezone_offset:a.getCurrentTimezoneOffset(),viewport:n,latency:d,displayed:l?"true":"false"};r.SearchClientActivityLogger.log("preview_completed",o.id,s(t,c))},t.logHoverPreviewFailed=function({searchSessionId:e,result:t,user:o,previewRequestId:i,viewport:n="dropdown-view",failureType:d}){const l={search_session_id:e,preview_request_id:i,timezone_offset:a.getCurrentTimezoneOffset(),viewport:n,failure_type:d};r.SearchClientActivityLogger.log("preview_failed",o.id,s(t,l))}})),define("modules/clean/react/home/starred/starred_table",["require","exports","tslib","react","dig-experimental/managed_table/index","typescript/component_libraries/files_components/src/index","modules/clean/react/components/css","modules/clean/react/home/starred/starred_to_ikea"],(function(e,t,r,a,s,o,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StarredTable=void 0,a=r.__importStar(a);const d=s.createManagedTable(o.UseStarring,s.useHoverActions,s.useLinkBehavior,s.useKeyboarding),l=e=>{var{data:t,columns:i}=e,n=r.__rest(e,["data","columns"]);const d=s.useManagedTable({columns:i,data:t},o.UseStarring,s.useHoverActions,s.useLinkBehavior,s.useKeyboarding,s.useFlexLayout,s.useRowSelect);return a.createElement(s.UnmanagedTable,Object.assign({instance:d},n))},c=[o.FileNameColumn],u=[s.rowSelectionColumn,o.FileNameColumn],p=({items:e,withSelection:t=!1})=>{const r=a.useMemo(()=>e.map(n.starredToIkea),[e]);return t?a.createElement(l,{isSelectable:!0,showHeader:!1,columns:u,data:r}):a.createElement(d,{isSelectable:!0,showHeader:!1,columns:c,data:r})};p.displayName="StarredTableNoCss",t.StarredTable=i.requireCssWithComponent(p,["/static/js/dig-experimental/index.web-vfl_TJZKT.css"])})),define("modules/clean/react/home/starred/starred_to_ikea",["require","exports","tslib","react","modules/clean/react/home/constants","modules/clean/react/starred/id_type_pair","modules/clean/react/starred/actions","modules/clean/react/home/store","modules/core/i18n","dig-components/buttons","modules/clean/react/home/post_tti/api","modules/clean/navigation","modules/clean/filepath/filepath","modules/clean/react/home/util/paper_utils","spectrum-sharing/utils/sharing_constants","modules/clean/react/home/util/logging/activity_logger","modules/clean/react/home/starred/starred_uri_interface","modules/clean/react/edison/router_utils","modules/clean/history_singleton"],(function(e,t,r,a,s,o,i,n,d,l,c,u,p,m,S,h,g,_,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.starredToIkea=void 0,a=r.__importStar(a),t.starredToIkea=(e,t)=>{var r;const s=Object.assign(e,{index:t}),i=null===(r=e.details)||void 0===r?void 0:r.fqPath;return{uniqueKey:o.idTypePairToString({type:e.idType,id:e.resourceId}),title:e.title,extension:p.file_extension(i||""),isFolder:g.isFolder(e),isStarred:!0,isStarrable:!0,url:g.href_for_file(n.getUser(),e),renderHoverActions:()=>a.createElement(T,{item:s}),performOpenAction:e=>L(s,e),performStarAction:e=>I(s,e)}};const T=({item:e})=>a.createElement(l.Button,{onClick:()=>f(e),variant:"opacity"},d.intl.formatMessage({id:"At94iP",defaultMessage:"Share"}));T.displayName="StarredHoverActions";const f=e=>{if(e.displayType===s.PAPER_DOCUMENT_RESOURCE_TYPE)return void m.sharePaperDoc(e.url,()=>v(e));v(e);const t=g.isFolder(e)?e.details.targetNsId:null,r=e.details.fqPath;c.waitForHomeTTI().then(a=>{a.asyncShowShareModal(n.getUser(),{fqPath:r,isFolder:g.isFolder(e),origin:S.SHARE_ACTION_ORIGIN_TYPE.STARRED,targetNsId:t})})},I=(e,t)=>i.StarredActions.updateWithSnackbar(n.getUser().role,e.resourceId,e.idType,t,e.title),L=(e,t)=>{if(s.DisplayTypeToResourceType[e.displayType]!==s.FILE_RESOURCE_TYPE||t)if(!t&&_.shouldUseReactRouter()){const t=new URL(e.url).pathname;R(e),y.getBrowserHistory().push(t)}else u.logAndNavigate(e.url,()=>R(e),t?u.NavigationMethod.NEW_TAB:u.NavigationMethod.REDIRECT);else c.waitForHomeTTI().then(t=>t.openInFileViewer(o.idTypePairToString({type:e.idType,id:e.resourceId}),()=>R(e)))},A=e=>[e.resourceId,s.DisplayTypeToResourceType[e.displayType],e.index],v=e=>h.homeActivityLogger.logClickStarOverflowShare(...A(e)),R=e=>h.homeActivityLogger.logOpenStarredItem(...A(e))})),define("modules/clean/react/async_overquota_modal_controller",["require","exports","tslib"],(function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.showOverquota=void 0,t.showOverquota=function(t,a,s){return r.__awaiter(this,void 0,void 0,(function*(){const{showOverquota:o}=yield new Promise((t,r)=>{e(["modules/clean/react/overquota/overquota_modal_controller"],t,r)}).then(r.__importStar);o({oqa:t,tagline:a,headline:s})}))}}));
//# sourceMappingURL=pkg-starred.min.js-vflU1luCO.map