define("modules/clean/dbmodal_stack",["require","exports"],(function(e,t){"use strict";function o(e,t={detail:null}){if("function"==typeof CustomEvent)return new CustomEvent(e,t);const o=document.createEvent("CustomEvent");return o.initCustomEvent(e,!0,!0,t.detail),o}Object.defineProperty(t,"__esModule",{value:!0}),t.DBModalStack=t.createCustomEvent=void 0,t.createCustomEvent=o;class s{static initClass(){this.__stack=[],this.CLEAR="dbmodal:clear"}static pop(e){null!=e?s.remove(e):e=s.__stack.pop(),null!=e&&e._hide();const t=s.top();null!=t?t._show():this.trigger(s.CLEAR)}static push(e){s.remove(e);const t=s.top();(null!=t?t.visible:void 0)&&t._hide(),s.__stack.push(e),e._show()}static top(){const{length:e}=s.__stack;return e?s.__stack[e-1]:null}static remove(e){const t=[];for(const o of Array.from(s.__stack))o!==e&&t.push(o);s.__stack=t}static clear(){for(let e=s.__stack.length-1;e>=0;e--){const t=s.__stack[e];t.visible&&t._hide()}this.trigger(s.CLEAR),s.__stack=[]}static register(e,t){document.addEventListener(e,t),document.addEventListener(s.CLEAR,()=>document.removeEventListener(e,t))}static unregister(e,t){document.removeEventListener(e,t)}static trigger(e,t){document.dispatchEvent(o(e,{detail:t}))}}t.DBModalStack=s,s.initClass()})),define("modules/clean/deprecated_ajax/ajax_jquery",["require","exports","tslib","modules/clean/devtools/panels/performance/perf_hub_action_types","modules/clean/deprecated_ajax/job_progress","modules/clean/deprecated_ajax/util","modules/core/persistence/storage","modules/constants/ajax_strings","modules/constants/page_load","modules/constants/request","modules/core/assert","modules/core/browser","modules/core/html","modules/core/notify","modules/core/uri","modules/clean/csrf","modules/clean/viewer"],(function(e,t,o,s,n,r,i,a,c,l,u,d,p,_,h,m,f){"use strict";function g(e){return e}Object.defineProperty(t,"__esModule",{value:!0}),t.SilentBackgroundBeaconRequest=t.ValidationSchemaRequest=t.SilentBackgroundRequest=t.BackgroundRequest=t.WebProgressRequest=t.FormWebRequest=t.WebRequestOref=t.WebRequest=t.Request=t.RESPONSE_PREFIX_NOTIFY_ERROR=t.getFakeJQXHR=void 0,n=o.__importStar(n),i=o.__importStar(i),a=o.__importStar(a),c=o.__importStar(c),l=o.__importStar(l),d=o.__importStar(d),t.getFakeJQXHR=e=>({response:void 0,responseText:"",status:0,statusText:"",getResponseHeader:function(e){return this.response?this.response.headers.get(e):null},readyState:XMLHttpRequest.UNSENT,abortController:e,thens:[],catches:[],abort:()=>e&&e.abort(),then:function(e,t){return this.thens.push(e),this.catches.push(t),this},catch:function(e){return this.catches.push(e),this},resolve:function(e){this.thens.forEach(t=>{t&&t(e)})},reject:function(e){this.catches.forEach(t=>{t&&t(e)})}});t.RESPONSE_PREFIX_NOTIFY_ERROR="err:";function w(e,o){var s;null==e&&(e={}),null==o&&(o=[]);const n=new S(e),i=y(n,o),a=i.options().type||"POST",c=i.data(),l=i.dataType(),u=i.headers();u.has("Content-Type")||u.append("Content-Type","application/x-www-form-urlencoded; charset=UTF-8");let d=String(i.url());const p=new AbortController,_={method:a,mode:"cors",credentials:e.credentials||"include",headers:u,signal:p.signal};if("POST"===a){const e=null===(s=u.get("Content-Type"))||void 0===s?void 0:s.includes("application/x-www-form-urlencoded");_.body=e?r.jqParam(c,!0):c}else d=r.mergeQueryParams(d,c);const h=t.getFakeJQXHR(p),m=fetch(d,_).then(e=>e.text().then(t=>({response:e,responseText:t}))).then(({response:e,responseText:o})=>{const{ok:s,status:n,statusText:r}=e;if(h.response=e,h.readyState=XMLHttpRequest.DONE,h.responseText=o,h.status=n,h.statusText=r,s)if("abort"===r)i.error(h,"aborted","abort"),i.complete(h,"aborted");else if("failed"===r)i.error(h,"failed",r),i.complete(h,"failed");else if("json"===l)try{const e=o.startsWith(t.RESPONSE_PREFIX_NOTIFY_ERROR)?o:JSON.parse(o);i.success(e,"success",h),i.complete(h,"success"),h.resolve(e)}catch(e){i.error(h,"parsererror",e.message),i.complete(h,"parsererror")}else i.success(o,"success",h),i.complete(h,"success"),h.resolve(o);else{h.status=e.status;const t=500===e.status?"":o;h.responseText=t,i.error(h,"error",t||h.statusText),i.complete(h,"error"),h.reject(h.responseText)}return e}).catch(e=>{"AbortError"===e.name?(h.statusText="abort",i.error(h,"aborted","abort"),i.complete(h,"aborted")):(i.error(h,"error",e.message),i.complete(h,"error")),h.reject(e)});return i.request(m),h}function b(e){return e.type===v.CHAINED}t.Request=w;const y=function(e,t){const o=[e];for(const e of Array.from(t.slice(0).reverse()))o.push(new e);let s=e;for(const e of o)s&&b(e)&&(e.next=s),s=e;return s};var v;(function(e){e.BASE="base",e.CHAINED="chained"})(v||(v={}));class S{constructor(e){this.type=v.BASE;const t=e||{},o=new Headers,s=t.headers||{};Object.keys(s).forEach(e=>{const t=s[e]||"";o.append(e,String(t))}),this.options=()=>t,this.url=()=>String(t.url||""),this.data=()=>t.data||{},this.dataType=()=>t.dataType||"text",this.headers=()=>o,this.success=t.success||g,this.error=t.error||g,this.complete=t.complete||g,this.request=g}}class T{constructor(){this.type=v.CHAINED}options(){return this.next.options()}url(){return this.next.url()}contentType(){return this.next.contentType()}data(){return this.next.data()}dataType(){return this.next.dataType()}headers(){return this.next.headers()}success(e,t,o){this.next.success(e,t,o)}error(e,t,o){this.next.error(e,t,o)}complete(e,t){this.next.complete(e,t)}request(e){this.next.request(e)}}class x extends T{constructor(){super(...arguments),this.SUPPORTED_TLDS=["dropbox.com"]}static initClass(){}data(){if(this.options().skipInjectCsrf)return this.next.data();u.assert(this._is_db_domain(),"injecting CSRF token into request to non-dropbox domain");const e={is_xhr:!0};return"GET"!==(this.options().type||"POST").toUpperCase()&&(e.t=m.readCsrfToken()),Object.assign(Object.assign({},e),this.next.data())}_is_db_domain(){const e=h.URI.parse(String(this.url())).getAuthority();if(!e)return!0;const t=e.split(".");return this.SUPPORTED_TLDS.reduce((function(e,o){const s=o.split("."),n=t.slice(-1*s.length).join(".");return e||o===n}),!1)}}x.initClass();class E extends T{data(){const e=this.next.data(),t=this.options();return t.subject_user&&!e._subject_uid&&(e._subject_uid=String(t.subject_user)),e}headers(){const e=this.next.headers(),t=this.options();return t.subject_user&&e.set("X-DROPBOX-UID",String(t.subject_user)),e}}class A extends T{headers(){var e,t;const o=this.next.headers(),s=this.options().teamAuthParams||{},n=s.team_id||f.Viewer.get_viewer().team_id;if(n){const{subject_user:s}=this.options(),r=null===(e=this.next.data())||void 0===e?void 0:e._subject_uid,i=("number"==typeof s?s:null==s?void 0:s.id)||("string"==typeof r?parseInt(r,10):r);i&&i===(null===(t=f.Viewer.get_viewer().work_user)||void 0===t?void 0:t.id)&&o.set("X-Dropbox-Teamid",String(n))}const r=s.auth_role||f.Viewer.get_viewer().auth_role,i=s.auth_action_type||f.Viewer.get_viewer().auth_action_type;return(r||i)&&o.set("X-Dropbox-Team-Authorization",JSON.stringify({auth_role:String(r),auth_action_type:String(i)})),o}}class C extends T{data(){const e=this.next.data();return l.REQUEST_TRACING_ENABLED?Object.assign({parent_request_id:l.REQUEST_ID},e):e}headers(){const e=this.next.headers(),t=this.options().type||"POST";return l.REQUEST_TRACING_ENABLED&&"POST"===t.toUpperCase()&&e.append(s.PerfHubHeaderNames.FORCE_REQUEST_TRACING_HEADER,"ON"),e}}class L extends T{success(e,o,s){let n;if(!s.responseText.length)return this.next.error(s,o,"AJAX Response was empty.");const r=this.options();let i=!0,a=!1;if(0===s.responseText.indexOf(t.RESPONSE_PREFIX_NOTIFY_ERROR))n=s.responseText.substr(t.RESPONSE_PREFIX_NOTIFY_ERROR.length),["{","["].includes(n[0])&&(i=!1);else{if(0!==s.responseText.indexOf("htmlerr:"))return this.next.success(e,o,s);n=s.responseText.substr("htmlerr:".length),a=!0}const c=this.next.error(s,o,n);if(i&&!r.skipNotifyError){let e=n;a&&(e=new p.HTML(n)),_.Notify.error(e)}return c}error(e,t,o){return"aborted"!==t&&_.Notify.error(a.PROBLEM_COMPLETING_REQUEST),this.next.error(e,t,o)}}class M extends T{constructor(){super(),this._watch=this._watch.bind(this)}data(){this.job_id=M.generate_job_id();const e=this.next.data(),t=e._subject_uid,o=this.options(),{subject_user:s}=o;return t&&"string"==typeof t?this.uid=t:s&&(this.uid=String(s)),Object.assign({job_id:this.job_id},e)}request(e){return this._interval=1e3,this._failures=0,this._watch_count=0,this._watch_id=setInterval(this._watch,this._interval),this.next.request(e)}success(e,t,o){return this.next.success(e,t,o)}error(e,t,o){return this.next.error(e,t,o)}complete(e,t){return this._stop(),n.Job.handled(this.job_id),this.next.complete(e,t)}_watch(){return n.Job.peek(this.job_id)?this._stop():(this._watch_count++,this._watch_count%10==0&&(clearInterval(this._watch_id),this._interval=Math.min(Math.floor(1.5*this._interval),3e4),this._watch_id=setInterval(this._watch,this._interval)),this._show_progress_modal(),this._fetch_progress())}_stop(){clearInterval(this._watch_id),n.ModalProgress.hide()}_show_progress_modal(){if(this._modal_shown)return;this._modal_shown=!0;const e=this.options();e.progress_text&&n.ModalProgress.show(e.progress_text)}_fetch_progress(){const e={};return this.uid&&(e._subject_uid=this.uid),B({url:`/job_status/${this.job_id}`,data:e,dataType:"text",success(e,t,o){let s;s=0===o.responseText.indexOf("done")?"1/1":o.responseText,n.ModalProgress.update(s)},error:(e,t,o)=>{if(this._failures++,!(this._failures<3))return this._stop(),this.next.error(e,t,o)}})}static generate_job_id(){const e=(new Date).getTime().toString();let t=Math.floor(1e6*Math.random()).toString();return t=`000000${t}`.substring(t.length),e+t}}class P extends T{data(){var e;const t=d.get_uri().getQuery().oref;return!(null===(e=this.next.data())||void 0===e?void 0:e.oref)&&t?Object.assign({oref:t},this.next.data()):this.next.data()}}const R=[class extends T{constructor(){super(),this.browser_unload_handler=this.browser_unload_handler.bind(this),this.is_browser_unloading=!1}browser_unload_handler(){this.is_browser_unloading=!0}request(e){return window.addEventListener("beforeunload",this.browser_unload_handler),this.next.request(e)}error(e,t,o){return"error"===t&&this.is_browser_unloading?this.next.error(e,"aborted","unload"):this.next.error(e,t,o)}complete(e,t){return window.removeEventListener("beforeunload",this.browser_unload_handler),this.next.complete(e,t)}}],F=[E,A,x,class extends T{error(e,t,o){if(403===e.status){const e=i.SessionStorage.get("reload-timestamp"),t=(new Date).getTime();(!e||t-e>3e4)&&(i.SessionStorage.set("reload-timestamp",t),window.location.reload(!0))}return this.next.error(e,t,o)}}],k=[class extends T{constructor(){super(),this._clear_working_msg=this._clear_working_msg.bind(this)}request(e){let t=!1;return e.catch(()=>{}).then(()=>{t=!0}),setTimeout(()=>{t||this._should_show_working_msg()&&(this._show_working_msg(),e.catch(()=>{}).then(()=>{this._clear_working_msg()}))},4e3),this.next.request(e)}_should_show_working_msg(){return _.Notify.isShown()}_show_working_msg(){return this.notification=_.Notify.success(a.STILL_WORKING),this.notification}_clear_working_msg(){if(_.Notify.isShown()&&this.notification===_.Notify.current())return _.Notify.clear()}}],O=[class extends T{error(e,t,o){return this._notify_dev(e,t,o),this.next.error(e,t,o)}_notify_dev(e,t,o){e.getResponseHeader("X-Debug-Url")}},C,class extends T{data(){const e=this.next.data(),t={};return c.PUBLIC_MODE_OVERRIDE&&(t.public_mode_override="1"),c.COUNTRY_OVERRIDE&&(t.country_override=c.COUNTRY_OVERRIDE),Object.assign(Object.assign({},t),e)}}],N=[class extends T{constructor(){super(),this._watch=this._watch.bind(this)}data(){const e=this.next.data();this.uid=String(e._subject_uid);const{subject_user:t}=this.options();return!this.uid&&t&&(this.uid=String(t)),e}success(e,t,o){return this._is_async_job_response(o.responseText)?(this.job_id=o.responseText.split(":")[1],this._interval=1e3,this._failures=0,this._watch_count=0,this._watch_id=setInterval(this._watch,this._interval)):this.next.success(e,t,o)}complete(e,t){if(!this._is_async_job_response(e.responseText))return this.next.complete(e,t)}_is_async_job_response(e){if(!e||0!==e.indexOf("async_task_started:"))return!1;return e.split(":")[1].match(/^[A-Za-z0-9_\-=]*$/)}_watch(){return n.Job.peek(this.job_id)?this._stop():(this._watch_count++,this._watch_count%10==0&&(clearInterval(this._watch_id),this._interval=Math.min(Math.floor(1.5*this._interval),3e4),this._watch_id=setInterval(this._watch,this._interval)),this._show_progress_modal(),this._fetch_progress())}_stop(){clearInterval(this._watch_id),n.ModalProgress.hide()}_show_progress_modal(){if(this._modal_shown)return;this._modal_shown=!0;const{progress_text:e}=this.options();e&&n.ModalProgress.show(e)}_fetch_progress(){const e={};return this.uid&&(e._subject_uid=this.uid),U({url:`/async_task_status/${this.job_id}`,data:e,dataType:"text",success:(e,o,s)=>{let r=s.responseText;if(0===r.indexOf("done:"))return n.Job.handled(this.job_id),this._stop(),r=r.substr("done:".length),s.responseText=r,this.next.success(e,o,s),this.next.complete(s,o);if(0===r.indexOf(t.RESPONSE_PREFIX_NOTIFY_ERROR)){n.Job.handled(this.job_id),this._stop();const e=r.substr(t.RESPONSE_PREFIX_NOTIFY_ERROR.length);return _.Notify.error(e),this.next.error(s,o,e),this.next.complete(s,o)}if(0===r.indexOf("async_task_err:")){n.Job.handled(this.job_id),this._stop();const e=r.substr("async_task_err:".length),{skipNotifyError:t}=this.options();return t||_.Notify.error(new p.HTML(e)),this.next.error(s,o,e),this.next.complete(s,o)}n.ModalProgress.update(r)},error:(e,t,o)=>{if(this._failures++,!(this._failures<3))return this._stop(),this.next.error(e,t,o),this.next.complete(e,t)}})}}],I=[].concat(R,k,L,O,F,N);t.WebRequest=function(e){return null==e&&(e={}),w(e,I)},t.WebRequestOref=function(e){return null==e&&(e={}),w(e,[].concat(P,I))};const D=[].concat(R,k,class extends T{success(e,o,s){if(!this.options().skipErrorHandling){if(!s.responseText.length)return this.next.error(s,o,"AJAX Form response was empty.");if(0===s.responseText.indexOf(t.RESPONSE_PREFIX_NOTIFY_ERROR)){const e=s.responseText.substr(t.RESPONSE_PREFIX_NOTIFY_ERROR.length);return this.next.error(s,o,e)}}return this.next.success(e,o,s)}},O,F,N);t.FormWebRequest=function(e){return null==e&&(e={}),w(e,D)};const j=[].concat(R,k,L,O,F,M,N);function B(e){return null==e&&(e={}),w(e,[].concat(R,O,F))}t.WebProgressRequest=function(e){return null==e&&(e={}),w(e,j)},t.BackgroundRequest=B;const H=[E,A,x],V=[].concat(R,O,H);function U(e){return null==e&&(e={}),w(e,V)}t.SilentBackgroundRequest=U,t.ValidationSchemaRequest=function(e){return e.type="OPTIONS",w(e,F)},t.SilentBackgroundBeaconRequest=function(e){if(null==e&&(e={}),!navigator.sendBeacon)return U(e);const t=new S(e),o=y(t,[].concat(H,C)),s=o.url(),n=(e=>{const t=new FormData;for(const o of Object.keys(e)){const s=e[o];(null===s?[]:Array.isArray(s)?s:[s]).forEach(e=>{let s;void 0!==e&&(s=!0===e?"true":!1===e?"false":"number"==typeof e?String(e):e,t.append(o,s))})}return t})(o.data());navigator.sendBeacon(String(s),n)||console.warn(`Beacon request failed: ${s}`)}})),define("modules/clean/deprecated_ajax/job_progress",["require","exports","modules/clean/dbmodal_stack"],(function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Job=t.ModalProgress=void 0;const s={complete:{},handled(e){if(!e)return!1;const t=!!s.complete[e];return s.complete[e]=!0,t},peek:e=>!!e&&!!s.complete[e]};t.Job=s;const n={show(e){var t;if(!e)return;null===(t=o.DBModalStack.top())||void 0===t||t.hide();const s=document.createElement("div");s.id="modal-progress-overlay",s.style.position="fixed",s.style.width="100%",s.style.height="100%",s.style.display="none",s.classList.add("fade-out"),document.body.appendChild(s);const n=document.createElement("div");n.id="modal-progress-content",n.style.display="none",n.classList.add("fade-out");const r=document.createElement("div");r.id="modal-progress-bar";const i=(function(e,t=300){const o=t.toString()+"px",s=document.createElement("div");s.classList.add("outer-progress-bar");const n=document.createElement("div");n.style.width=o,n.id=`pb_${e}`,n.classList.add("inner-progress-bar");const r=document.createElement("div");r.style.width=o,r.classList.add("under-pb"),r.classList.add("progress-bar");const i=document.createElement("div");i.style.display="none",i.id=`pb_${e}_over`,i.classList.add("over-pb"),i.classList.add("progress-bar");const a=document.createElement("div");a.style.width=o,a.id=`pb_${e}_upct`,a.classList.add("pb-percentage");const c=document.createElement("div");return c.style.width=o,c.id=`pb_${e}_opct`,c.classList.add("pb-percentage"),r.appendChild(a),i.appendChild(c),n.appendChild(r),n.appendChild(i),s.appendChild(n),s})("modal-progress",150);r.appendChild(i);const a=document.createElement("div");a.id="modal-progress-text",a.textContent=e;const c=document.createElement("modal-progress-container");c.id="modal-progress-container",c.appendChild(r),c.appendChild(a),n.appendChild(c),document.body.appendChild(n),s.style.display="",s.classList.add("fade-to"),s.classList.remove("fade-out"),n.style.display="",n.classList.add("fade-in"),n.classList.remove("fade-out")},update(e){e.indexOf("progress")>-1&&(e=e.substring("progress".length)),(function(e,t){const o=document.querySelector(`#pb_${e}_over`);if(!o)return;const s=t.split("/").map(Number),n=s.length>1?s[0]/s[1]:s[0],r=isNaN(n)?0:n;o.style.width=`${100*Math.min(r,1)}%`,o.style.display="",o.style.backgroundColor="#348DD3",o.style.overflow="hidden"})("modal-progress",e)},hide(){const e=document.querySelector("#modal-progress-overlay");e&&(e.classList.add("fade-out"),e.classList.remove("fade-to"),window.setTimeout(()=>{e.remove()},250));const t=document.querySelector("#modal-progress-content");t&&(t.classList.add("fade-out"),t.classList.remove("fade-in"),window.setTimeout(()=>{t.remove()},250))}};t.ModalProgress=n})),define("modules/clean/deprecated_ajax/util",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mergeQueryParams=t.jqParam=void 0;const o={};function s(e){return null===e?String(e):o[toString.call(e)]||"object"}function n(e){return(function(e){return"object"===s(e)})(e)&&!(function(e){return null!==e&&e===e.window})(e)&&Object.getPrototypeOf(e)===Object.prototype}["Boolean","Number","String","Function","Array","Date","RegExp","Object","Error"].forEach(e=>{o["[object "+e+"]"]=e.toLowerCase()}),t.jqParam=function(e,t=!1){const o=[];return o.add=function(e,t){(function(e){return"function"===s(e)})(t)&&(t=t()),void 0!==t&&(null===t&&(t=""),o.push(encodeURIComponent(e)+"="+encodeURIComponent(t)))},(function e(t,o,r=!1,i=""){let a;const c=Array.isArray(o),l=n(o);Object.entries(o).forEach(([o,n])=>{a=s(n),i&&(o=r?i:i+"["+(l||"object"===a||"array"===a?o:"")+"]"),!i&&c?t.add(n.name,n.value):"array"===a||!r&&"object"===a?e(t,n,r,o):t.add(o,n)})})(o,e,t),o.join("&").replace(/%20/g,"+")},t.mergeQueryParams=function(e,o){const s=e.startsWith("//"),n=!s&&!e.includes("://")?"http://example":s?"http:":"",r=new URL(n+e),i={};r.searchParams.forEach((function(e,t){i[t]=e})),Object.keys(o).forEach(e=>{let t=o[e];null===t&&(t=""),void 0!==t&&(i[e]=t)});const a=[];Object.entries(i).forEach(([e,o])=>{a.push(t.jqParam({[e]:o},!0))}),r.search=a.join("&");let c=r.toString();return c=c.slice(n.length),c}})),define("modules/clean/devtools/panels/performance/perf_hub_action_types",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PerfHubHeaderNames=t.ActionTypes=void 0,(function(e){e.PROFILED_AJAX_LOAD_FINISHED="PROFILED_AJAX_LOAD_FINISHED",e.WEB_TIMING_FETCHED="WEB_TIMING_FETCHED",e.VISUALLY_COMPLETE="VISUALLY_COMPLETE"})(t.ActionTypes||(t.ActionTypes={})),(function(e){e.SERVER_RESPONSE_TIME="x-server-response-time",e.REQUEST_PROFILE_ID="x-dropbox-request-profile-id",e.REQUEST_ID="x-dropbox-request-id",e.FORCE_REQUEST_TRACING_HEADER="x-dropbox-force-request-tracing"})(t.PerfHubHeaderNames||(t.PerfHubHeaderNames={}))})),define("modules/clean/event_load",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.window_load=void 0;t.window_load=function(e){"complete"===document.readyState&&(e=>{window.setTimeout(()=>e.apply(e),0)})(e),window.addEventListener("load",e,!1)}})),define("modules/clean/filepath/filepath",["require","exports"],(function(e,t){"use strict";function o(e){return e?("/"!==e.charAt(0)&&(e=`/${e}`),"/"===e.charAt(e.length-1)?e.substr(0,e.length-1):e):""}function s(e){if(!e)return{name:"",ext:""};const t=e.split("."),o=e.length>0&&"."===e[0];let s=e.indexOf(".")<0;o&&(s=t.length<=2);const n=t.pop();return n&&!s?{name:t.join("."),ext:n}:{name:e,ext:""}}function n(e){return s(e).ext.toLowerCase()}function r(e){return e.split("/").slice(0,-1).join("/")||"/"}Object.defineProperty(t,"__esModule",{value:!0}),t.joinPathWithFileName=t.parentDirName=t.child_dir=t.parent_dirs=t.parent_dir=t.file_extension_for_logging=t.file_extension=t.split_filename=t.filename_without_extension=t.filename=t.inSubDirectory=t.inSameDirectory=t.paths_are_equal=t.depth=t.normalize=void 0,t.normalize=o,t.depth=function(e){return o(e).split("/").length-1},t.paths_are_equal=function(e,t){return o(e).toLowerCase()===o(t).toLowerCase()},t.inSameDirectory=function(e){if(!e.length)return!1;const t=r(e[0]);return!e.find(e=>r(e)!==t)},t.inSubDirectory=function(e,t){const s=(e=o(e)).split("/"),n=(t=o(t)).split("/");if(n.length<=s.length)return!1;for(let e=0;e<s.length;e++)if(s[e]!==n[e])return!1;return!0},t.filename=function(e,t){const s=(e=o(e)).split("/").pop();return s||(t||"Dropbox")},t.filename_without_extension=function(e){return e?-1===e.indexOf(".")?e:e.split(".").slice(0,-1).join("."):""},t.split_filename=s,t.file_extension=n,t.file_extension_for_logging=function(e){return-1===e.indexOf(".")?"":n(e).toLowerCase()},t.parent_dir=r,t.parent_dirs=function(e){const t=[];let o=r(e);for(;"/"!==o;)t.push(o),o=r(o);return t},t.child_dir=function(e){return e.split("/").pop()||""},t.parentDirName=function(e){const t=e.split("/");return t.length>1?t[t.length-2]:""},t.joinPathWithFileName=function({fqPath:e,fileName:t}){return[e,t].join("/"===e?"":"/")}})),define("modules/clean/ts_utils",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.notEmpty=t.throwEnforceExhaustive=t.enforceExhaustive=void 0,t.enforceExhaustive=function(e){return e},t.throwEnforceExhaustive=function(e,t){throw new Error(t)},t.notEmpty=function(e){return null!=e}})),define("modules/clean/user",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mkUser=void 0;class o{constructor(e){Object.assign(this,e)}toString(){return String(this.id)}}t.mkUser=function(e){return new o(e)}})),define("modules/clean/ux_analytics/utils",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getWARPInfoFromDOM=t.getModalId=t.dispatchModalClosed=t.dispatchModalOpened=void 0;const o=(e,t)=>{if("function"==typeof CustomEvent)document.dispatchEvent(new CustomEvent(e,{detail:t}));else{const o=document.createEvent("CustomEvent");o.initCustomEvent(e,!0,!0,t),document.dispatchEvent(o)}};t.dispatchModalOpened=()=>{o("modalOpened")},t.dispatchModalClosed=()=>{o("modalClosed")},t.getModalId=e=>{if(e.id)return e.id;const t=e.className;if(t){const e=t.split(" ");if(e.length>1){return e.find(e=>e.indexOf("modal")>-1)||`${t[0]}-modal`}return t.indexOf("modal")>-1?t:`${t}-modal`}};t.getWARPInfoFromDOM=()=>{const e=document.getElementById("warp-metadata");return e?e.getAttribute("data-warp-info"):null}})),define("modules/clean/viewer",["require","exports","modules/constants/viewer","modules/core/assert","modules/clean/user"],(function(e,t,o,s,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Viewer=void 0;class r{constructor(e={}){this.replace_viewer_data(e)}static get_viewer(){return r._cached_viewer}static get_role_title(e){return this.get_viewer().get_title_by_role(e.role)}static get_root_name(e){return this.get_viewer().get_root_name_by_role(e.role)}static get_is_signed_in(e){return e.is_signed_in}replace_viewer_data(e={}){this._authed_users={},this._all_users={};const t=e._user_data||[];for(const e of t){const t=n.mkUser(e);this._all_users[t.id]=t,e._authed&&(this._authed_users[t.id]=t)}this.display_name=e.display_name,this.team_id=e.team_id,this.auth_role=e.auth_role,this.auth_action_type=e.auth_action_type,this.team_dbtid=e.team_dbtid,this.team_name=e.team_name,this.team_type=e.team_type,this.team_is_limited=e.team_is_limited||!1,this.team_is_locked=e.team_is_locked||!1,this.is_assume_user_session=e.is_assume_user_session||!1,this.is_team_assume_user_session=e.is_team_assume_user_session||!1,this.is_signed_in=t.length>0,this.is_paired=t.length>1,e.deprecated_first_user_in_the_cookie_id&&(this.deprecated_first_user_in_the_cookie=this.get_user_by_id(e.deprecated_first_user_in_the_cookie_id)),this._load_cached_users()}get_user_by_role(e,t){const o=this.get_uid_by_role(e);return null!=o?this.get_user_by_id(o,t):void 0}role_exists(e){return null!=this.get_uid_by_role(e)}get_user_by_id(e,t){s.assert(this.is_uid_associated(e),`User ${e} is not associated with this viewer`);const o=(t?this._all_users:this._authed_users)[e];return s.assert(!!o,`User ${e} is not signed in`),o}is_role_signed_in(e){const t=this.get_uid_by_role(e);return null!=t&&t in this._authed_users}is_uid_signed_in(e){return e in this._authed_users}is_user_signed_in(e){return null!=e&&this.is_uid_signed_in(e.id)}is_uid_associated(e){return e in this._all_users}get_users(e){const t=e?this._all_users:this._authed_users,o=Object.keys(t).map(e=>t[e]);return o.sort((e,t)=>"personal"===e.role?-1:1),o}get_user_ids(e){return this.get_users(e).map(e=>e.id)}get_roles(e){return this.get_users(e).map(e=>e.role)}get_account_ids(e){return this.get_users(e).map(e=>e.account_id)}get_email_by_role(e){const t=this.get_user_by_role(e,!0);return t&&t.email}get_uid_by_role(e){"photos"===e&&(e=this.is_paired||!this.is_signed_in?"personal":this._all_users[Object.keys(this._all_users)[0]].role);for(const t in this._all_users)if(this._all_users.hasOwnProperty(t)){const o=this._all_users[t];if(o.role===e)return o.id}}get_title_by_role(e){return"work"===e?this.team_name:this.is_paired?o.PERSONAL_ROLE_STRING:""}get_root_name_by_role(e){return this.get_title_by_role(e)||o.DEFAULT_ROOT_NAME}_sign_in_all_users(){this._authed_users=Object.assign({},this._all_users),this._load_cached_users()}_sign_out_user_by_id(e){delete this._authed_users[e],this._load_cached_users()}sign_in_user_by_id(e){s.assert(this.is_uid_associated(e),`User ${e} is not associated with this viewer`),this._authed_users[e]=this._all_users[e],this._load_cached_users()}_load_cached_users(){this.personal_user=this._authed_users[this.get_uid_by_role("personal")],this.photos_user=this._authed_users[this.get_uid_by_role("photos")],this.work_user=this._authed_users[this.get_uid_by_role("work")],this.personal_email=this.get_email_by_role("personal"),this.work_email=this.get_email_by_role("work"),this.is_personal_user_signed_in=this.is_role_signed_in("personal"),this.is_photos_user_signed_in=this.is_role_signed_in("photos"),this.is_work_user_signed_in=this.is_role_signed_in("work")}}t.Viewer=r,r._cached_viewer=new r(o._viewer_properties)})),define("modules/core/accessible_announce",["require","exports","tslib","dompurify","modules/clean/css","modules/core/html"],(function(e,t,o,s,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AccessibleAnnounce=void 0,s=o.__importStar(s);class i{static polite(e,t=10){return this.announce("polite",e,t)}static assertive(e,t=10){return this.announce("assertive",e,t)}static clear(){this.lastTimeout&&clearTimeout(this.lastTimeout),Array.from(document.querySelectorAll("#accessible-announce")).forEach(e=>{e.setAttribute("aria-live","off"),e.innerHTML=""})}static announce(e,t,o=10){return n.require_css("/static/css/accessibility-vfliGZNRm.css",()=>document.querySelector("#accessible-announce")?(this.setMessage(t,e),this.scheduleClear(o)):(document.body.insertAdjacentHTML("afterend","<div id='accessible-announce' aria-live='assertive' class='ax-visually-hidden'></div>"),setTimeout(()=>(this.setMessage(t,e),this.scheduleClear(o)),this.TIMEOUT_LENGTH)))}static setMessage(e,t){this.clear(),Array.from(document.querySelectorAll("#accessible-announce")).forEach(o=>{o.setAttribute("aria-live",t),e instanceof HTMLElement?o.innerHTML=s.sanitize(e.innerHTML):r.isHTML(e)?o.innerHTML=s.sanitize(e.toHTML()):o.textContent=e})}static scheduleClear(e){return this.lastTimeout=setTimeout(()=>{this.clear()},1e3*e)}}t.AccessibleAnnounce=i,i.TIMEOUT_LENGTH=50})),define("modules/core/browser",["require","exports","tslib","modules/constants/env","modules/core/assert","modules/core/uri"],(function(e,t,o,s,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.unsafeRedirect=t.now=t.performance=t.reload=t.replace_location=t.redirect=t.onBrowserRedirect=t.open_mail=t.unsafe_open_tab=t.open_tab=t.mockableInternalMethods=t.set_hash=t.get_href_no_hash=t.get_hash=t.get_uri=t.get_origin=t.get_hostname=t.get_pathname=t.get_href=void 0;const i=(s=o.__importStar(s)).REDIRECT_SAFE_ORIGINS;function a(e=window){return e.location.href}t.get_href=a,t.get_pathname=function(e=window){return e.location.pathname},t.get_hostname=function(e=window){return e.location.hostname},t.get_origin=function(e=window){return e.location.origin},t.get_uri=function(e=window){return r.URI.parse(a(e))},t.get_hash=function(){return window.location.hash.split("#")[1]},t.get_href_no_hash=function(){return a().split("#")[0]},t.set_hash=function(e){window.location.hash=e},t.mockableInternalMethods={_navigate(e,t=window){t.location.href=e},_parse_target(e,{target_window:t=window,checkDomainWhitelist:o=!0,httpsOnly:s=!0}={}){const a=t.document.createElement("a");e instanceof r.URI?a.href=e.toString():a.href=e;let c=a.protocol||t.location.protocol;":"===a.protocol&&(c=t.location.protocol);const l=a.hostname||t.location.hostname;let u=a.port||t.location.port;"443"===u&&"https:"===c&&(u=""),o&&n.assert(!u,"Non-default port not legal when checking the whitelist.");const d=0===a.pathname.indexOf("/")?a.pathname:`/${a.pathname}`;s?n.assert("https:"===c,"Target URI must be secure"):n.assert("data:"!==c&&"javascript:"!==c&&"vbscript:"!==c,"Target URI can't use the data or javascript scheme"),o&&n.assert(i.indexOf(l)>-1,"Target URI must be in the domain whitelist");let p=l;return u&&(p=p+":"+u),e=c+"//"+p+d+a.search+a.hash}},t.open_tab=function(e,o=!1){const s=t.mockableInternalMethods._parse_target(e),n=window.open(s,"_blank");return o?n:null},t.unsafe_open_tab=function(e){return e=t.mockableInternalMethods._parse_target(e,{checkDomainWhitelist:!1,httpsOnly:!1}),window.open(e,"_blank")},t.open_mail=function(e,t="_blank"){n.assert(e.startsWith("mailto:"),"Mailto link is malformed."),window.open(e,t)};const c=[];function l(){return window.performance||null}t.onBrowserRedirect=function(e){c.push(e)},t.redirect=function(e,o=window){const s="string"==typeof e?e:e.toString();for(const e of c)e(s);const n=t.mockableInternalMethods._parse_target(e,{target_window:o});t.mockableInternalMethods._navigate(n,o)},t.replace_location=function(e){const o=t.mockableInternalMethods._parse_target(e);window.location.replace(o)},t.reload=function(e=!1){window.location.reload(e)},t.performance=l,t.now=function(){const e=l();return e&&e.now&&e.timing?Math.round(e.now()+e.timing.navigationStart):Date.now()},t.unsafeRedirect=function(e){e=t.mockableInternalMethods._parse_target(e,{checkDomainWhitelist:!1,httpsOnly:!1}),t.mockableInternalMethods._navigate(e)}})),define("modules/core/browser_detection",["require","exports"],(function(e,t){"use strict";function o(e,t){const o=/win(dows)? 9x 4\.90/.test(e)||/windows me/.test(e),s={windows3_11:/win16/.test(e),windows95:/windows 95/.test(e)||/win95/.test(e)||/windows_95/.test(e),windows98:!o&&(/windows 98/.test(e)||/win98/.test(e)),windowsCE:/windows ce/.test(e),windowsME:o,windowsNT4_0:/windows nt 4\.0/.test(e)||/winnt4.0/.test(e)||/winnt/.test(e)||/windows nt([^ ]| [^0-9])/.test(e),windows2000:/windows nt 5\.0/.test(e)||/windows 2000/.test(e),windowsXP:/windows nt 5\.1/.test(e)||/windows xp/.test(e),windowsXPx64:/windows nt 5\.2/.test(e),windowsVista:/windows nt 6\.0/.test(e)||/windows vista/.test(e),windows7:/windows nt 6\.1/.test(e),windows8:/windows nt 6\.2/.test(e),windows8_1:/windows nt 6\.3/.test(e),windows10:/windows nt 6\.4/.test(e)||/windows nt 10\.0/.test(e),win7OrLower:!1,win8OrHigher:!1};return s.win7OrLower=s.windows3_11||s.windows95||s.windows98||s.windowsCE||s.windowsME||s.windowsNT4_0||s.windows2000||s.windowsXP||s.windowsXPx64||s.windowsVista||s.windows7,s.win8OrHigher=t&&!s.win7OrLower,s}function s(e=navigator.userAgent){const t=(function(e){const t=e.toLowerCase(),o=/(ipad)/.exec(t)||/(edge)[ \/]([\w.]+)/.exec(t)||/(edg)[ \/]([\w.]+)/.exec(t)||/(chrome)[ \/]([\w.]+)/.exec(t)||/(webkit)[ \/]([\w.]+)/.exec(t)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(t)||/(msie) ([\w.]+)/.exec(t)||/(trident).*? rv:([\w.]+)/.exec(t)||t.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(t)||[],s=t.match(/version\/([\d.]+)/i);let n=null!=s?o[1]:null;return"webkit"===n&&(n=null!=s?s[1]:null),{browser:o[1]||"",version:n||o[2]||"0",userAgent:e}})(e);return"trident"===t.browser&&(t.browser="msie"),t}function n(e=navigator.plugins||[]){return Array.from(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.INTERNAL_FILE_DATA_TRANSFER_TYPE=t.is_input_webkitdirectory_supported=t.is_mobile_or_tablet=t.is_tablet=t.is_android=t.is_supported_mobile_browser=t.checkBrowserVersion=t.unsubscribeConnectivityStatusChange=t.subscribeConnectivityStatusChange=t.isOnline=t.is_high_density_display=t.msie_version_at_most=t.pluginNames=t.plugins=t.userAgent=t.version=t.browser_name=t.facebookWebView=t.iOS=t.ipod=t.iphone=t.windowsInfo=t.windows=t.mac=t.webkit=t.mozilla=t.chromium=t.edgeChromium=t.edge=t.msie=t.opera=t.safari=t.chrome=t.ipad=t.get_plugins=t.get_browser_info=t.parseWindowsOsInfo=void 0,t.parseWindowsOsInfo=o,t.get_browser_info=s,t.get_plugins=n;const r=s();function i(e,o,s=!0){return s?Boolean(e)&&parseInt(t.version,10)>=o:Boolean(e)&&parseInt(t.version,10)<=o}function a(e=navigator.userAgent){const o=(e||"").toLowerCase();return t.ipod||t.iphone||-1!==o.indexOf("tizen")||-1!==o.indexOf("android")&&-1!==o.indexOf("mobile")||-1!==o.indexOf("bb10")||-1!==o.indexOf("netfront")||/windows phone|opera mini|blackberry|nokia/.test(o)||-1!==o.indexOf("firefox")&&-1!==o.indexOf("mobile")||-1!==o.indexOf("googlebot-mobile")||-1!==o.indexOf("iemobile")||-1!==o.indexOf("opera mobi")||/ucweb|ucbrowser/.test(o)||-1!==o.indexOf("microsoft office mobile")}function c(e=navigator.userAgent){const t=(e||"").toLowerCase();return-1!==t.indexOf("android")||-1!==t.indexOf("silk")}function l(e=navigator.userAgent){return t.ipad||c(e)&&!a(e)}t.ipad="ipad"===r.browser||void 0,t.chrome="chrome"===r.browser||void 0,t.safari=!("webkit"!==r.browser&&!Boolean(t.ipad))||void 0,t.opera="opera"===r.browser||void 0,t.msie="msie"===r.browser||void 0,t.edge="edge"===r.browser||"edg"===r.browser,t.edgeChromium=()=>"edg"===s().browser,t.chromium=()=>Boolean(t.chrome)||t.edgeChromium(),t.mozilla="mozilla"===r.browser||void 0,t.webkit=!("webkit"!==r.browser&&!Boolean(t.ipad)&&!Boolean(t.chrome))||void 0,t.mac=Boolean(/(macintosh)/.exec(navigator.userAgent.toLowerCase())),t.windows=/win(16|nt|dows)/.test(navigator.userAgent.toLowerCase()),t.windowsInfo=o(navigator.userAgent.toLowerCase(),t.windows),t.iphone=Boolean(/(iphone)/.exec(navigator.userAgent.toLowerCase())),t.ipod=Boolean(/(ipod)/.exec(navigator.userAgent.toLowerCase())),t.iOS=t.ipad||t.ipod||t.iphone,t.facebookWebView=Boolean(/(FBAN)|(FBAV)/.exec(navigator.userAgent)),t.browser_name=r.browser,t.version=r.version,t.userAgent=r.userAgent,t.plugins=n(),t.pluginNames=t.plugins.map(e=>e.name),t.msie_version_at_most=function(e){return i(t.msie,e,!1)},t.is_high_density_display=function(){if(window.matchMedia){const e="(-webkit-min-device-pixel-ratio: 1.1), (min-resolution: 192dpx), (min-resolution: 1.1dppx)";return Boolean(window.matchMedia(e).matches)}return!1},t.isOnline=function(){return navigator.onLine},t.subscribeConnectivityStatusChange=function(e){window.addEventListener("online",e),window.addEventListener("offline",e)},t.unsubscribeConnectivityStatusChange=function(e){window.removeEventListener("online",e),window.removeEventListener("offline",e)},t.checkBrowserVersion=i,t.is_supported_mobile_browser=a,t.is_android=c,t.is_tablet=l,t.is_mobile_or_tablet=function(e=navigator.userAgent){return a(e)||l(e)},t.is_input_webkitdirectory_supported=function(){return"webkitdirectory"in document.createElement("input")},t.INTERNAL_FILE_DATA_TRANSFER_TYPE=t.msie?"text":t.edge?"text/plain":"application/x-dropbox-file-list"})),define("modules/core/dom",["require","exports","ts-key-enum"],(function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isElementInViewport=t.keepFocusIn=t.getTabbableElementsIn=t.getFocusableElementsIn=t.clone_position=t.scroll_to=t.scroll_unlock_document=t.scroll_lock_document=t.is_page_scrollable=t.scroll_offsets=t.is_content_editable=t.is_input=t.focus_in_input=void 0;t.focus_in_input=()=>t.is_input(document.activeElement),t.is_input=e=>null!=e&&(["INPUT","TEXTAREA","SELECT"].includes(e.tagName)&&!(e.type in["submit","button"])||t.is_content_editable(e)),t.is_content_editable=e=>null!=e&&(e.hasAttribute&&e.hasAttribute("contenteditable")&&"false"!==e.getAttribute("contenteditable").toLowerCase());let s=!1,n=null,r=0,i=null;t.scroll_offsets=function(){let e,o;return s||(window.addEventListener("scroll",()=>n=null),s=!0),t.is_page_scrollable()?n||(o=document.documentElement.scrollTop,e=document.documentElement.scrollLeft,n={0:e,1:o,left:e,top:o}):(o=i.top,e=i.left,n={0:e,1:o,left:e,top:o}),n},t.is_page_scrollable=()=>!document.documentElement.classList.contains("no-scroll"),t.scroll_lock_document=function(){r++;const e=document.documentElement;if(!e.classList.contains("no-scroll")){i=t.scroll_offsets();const o=-1*i.top+"px",s=-1*i.left+"px";e.style.top=o,e.style.left=s,e.classList.add("no-scroll")}},t.scroll_unlock_document=function(){r>0&&r--;const e=document.documentElement;if(0===r&&e.classList.contains("no-scroll")&&i){const o=i.top,s=i.left;e.style.top="",e.style.left="",e.classList.remove("no-scroll"),t.scroll_to(s,o+1),t.scroll_to(s,o-1),t.scroll_to(s,o)}},t.scroll_to=function(e,o){const s=Math.max(document.documentElement.scrollHeight,document.documentElement.clientHeight);if(e=Math.max(e,0),(o=Math.max(o,0))>t.scroll_offsets().top&&(o=Math.min(o,s-document.documentElement.clientHeight)),t.is_page_scrollable())window.scrollTo(e,o),n={0:e,1:o,left:e,top:o};else{i={0:e,1:o,left:e,top:o};const t=-1*o+"px",s=-1*e+"px",n=document.documentElement;n.style.top=t,n.style.left=s}},t.clone_position=function(e,t,o){const s=Object.assign(Object.assign({},{setLeft:!0,setTop:!0,setWidth:!0,setHeight:!0,offsetTop:0,offsetLeft:0}),o),n=t.getBoundingClientRect();let r={top:0,left:0},i=null;if("absolute"===getComputedStyle(e).position&&(i=e.offsetParent||e,i&&(r=Object.assign({},i.getBoundingClientRect()))),i===document.body&&(r.left-=document.body.offsetLeft,r.top-=document.body.offsetTop),s.setLeft){const t=n.left-r.left+s.offsetLeft+"px";e.style.left=t}if(s.setTop){const t=n.top-r.top+s.offsetTop+"px";e.style.top=t}s.setWidth&&(e.style.width=t.offsetWidth+"px"),s.setHeight&&(e.style.height=t.offsetHeight+"px")},t.getFocusableElementsIn=function(e,t){let o;if(e instanceof Element?o=e:e instanceof Node&&(o=e),!o)return[];const s=o.querySelectorAll("a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), iframe, object, embed, *[tabindex], *[contenteditable]"),n=Array.from(s).filter(e=>{if(!(e instanceof HTMLElement))return!1;const t=e.offsetWidth&&e.offsetHeight,o=e.getClientRects().length;return!(!t&&!o)});return t?n.filter(e=>!e.matches('*[tabindex="-1"]')):n},t.getTabbableElementsIn=function(e){const o=t.getFocusableElementsIn(e,!0),s=[],n=[];if(o.forEach(e=>{e.matches('*:not([tabindex]), *[tabindex="0"]')?s.push(e):n.push(e)}),!n.length)return s;return n.sort((function(e,t){return parseInt(e.getAttribute("tabindex"),10)-parseInt(t.getAttribute("tabindex"),10)})),n.concat(s)},t.keepFocusIn=function(e,s,n,r){if(n.key!==o.Key.Tab)return;const i=t.getTabbableElementsIn(e);if(i.length){const o=i.indexOf(s);if(-1!==o)n.shiftKey?0===o?(n.preventDefault(),i[i.length-1].focus()):r&&i[o-1]&&(n.preventDefault(),i[o-1].focus()):o===i.length-1?(n.preventDefault(),i[0].focus()):r&&i[o+1]&&(n.preventDefault(),i[o+1].focus());else{n.preventDefault();const o=t.getFocusableElementsIn(e);n.shiftKey&&o.reverse();const r=o.indexOf(s);if(-1===r)i[0].focus();else{let e=null;for(const t of o.slice(r))if(i.includes(t)){e=t;break}e?e.focus():n.shiftKey?i[i.length-1].focus():i[0].focus()}}}},t.isElementInViewport=function(e,t=0){if(!e)return!1;const o=e.getBoundingClientRect().top;return o+t>=0&&o-t<=window.innerHeight}})),define("modules/core/html",["require","exports","tslib","lodash"],(function(e,t,o,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HTML=t.isHTML=void 0,s=o.__importStar(s);const n=/[^\w@\.\ \-\(\)\,\$~%#\[\]\{\}\!\^]/g,r=e=>`&#${e.charCodeAt(0)};`,i=e=>`${e}`.replace(n,r);t.isHTML=function(e){return"object"==typeof e&&"function"==typeof e.toHTML};class a{constructor(e){this._str_DONT_TOUCH=e}toHTML(){return this._str_DONT_TOUCH}toString(){return"[object HTML]"}static tmpl(e,t){if(!/[^\w:.-]/.test(e)){const t=document.getElementById(e);e=t.innerHTML,window.CSP_SCRIPT_NONCE!==(t.nonce||t.getAttribute("nonce"))&&(e="")}const o=e.replace(/[\r\t\n]/g," ").replace(/'(?=[^%]*%>)/g,"\t").split("'").join("\\'").split("\t").join("'").replace(/<%=(.*?)%>/g,"',__no_conflict_HTML__._raw_escape($1),'").split("<%").join("');").split("%>").join("p.push('"),n=new Function("__no_conflict_HTML__","TEMPLATE_DATA","var p=[],print=function(){p.push.apply(p,arguments);}; p.push('"+o+"'); return new __no_conflict_HTML__(p.join('').trim());"),r=s.partial(n,a);return t?r(t):r}static escape(e){return e instanceof a?e:new a(i(e))}static _raw_escape(e){return e instanceof a?e.toHTML():"number"==typeof e?e:i(e)}}t.HTML=a})),define("modules/core/notify",["require","exports","tslib","dompurify","react-dom","react","modules/core/accessible_announce","modules/core/html"],(function(e,t,o,s,n,r,i,a){"use strict";var c;Object.defineProperty(t,"__esModule",{value:!0}),t.Notify=void 0,s=o.__importStar(s),n=o.__importStar(n),r=o.__importStar(r),(function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Info=2]="Info",e[e.Success=3]="Success"})(c||(c={}));const l=e=>{if(!e.message)return null;let t="";switch(e.notificationType){case c.Error:t="server-error";break;case c.Warning:t="server-warning";break;case c.Info:t="server-info";break;case c.Success:t="server-success"}const o=`notify-wrapper${e.hasTopNotification?" with-top-notification":""}`;return r.createElement("div",{id:"notify-wrapper",className:o},r.createElement("div",{id:"notify",className:t,style:{display:"inline-block"}},a.isHTML(e.message)?r.createElement("span",{id:"notify-msg",className:"notify-msg",dangerouslySetInnerHTML:{__html:s.sanitize(e.message.toHTML())}}):r.createElement("span",{id:"notify-msg",className:"notify-msg"},e.message)))};l.displayName="NotificationComponent";class u extends r.Component{constructor(e){super(e),this.state={message:"",hasTopNotification:!1,notificationType:c.Info,visible:!1}}show(e,t,o){const s=document.querySelectorAll(".maestro .has-top-notification").length>0;this.setState({message:e,hasTopNotification:s,notificationType:t,onHide:o,visible:!0})}hide(){this.setState({visible:!1})}render(){return this.state.visible?r.createElement(l,{message:this.state.message,hasTopNotification:this.state.hasTopNotification,notificationType:this.state.notificationType}):null}}u.displayName="NotifyPortalComponent";t.Notify=new class{constructor(){this._portal=r.createRef()}customSuccess(e,t,o=10,s){return i.AccessibleAnnounce.polite(t,o+1),this.show(e,o,c.Success,s)}success(e,t=10,o){return i.AccessibleAnnounce.polite(e,t+1),this.show(e,t,c.Success,o)}error(e,t=10,o){return i.AccessibleAnnounce.assertive(e,t+1),this.show(e,t,c.Error,o)}warning(e,t=10,o){return i.AccessibleAnnounce.polite(e,t+1),this.show(e,t,c.Warning,o)}info(e,t=10,o){return i.AccessibleAnnounce.polite(e,t+1),this.show(e,t,c.Info,o)}clear(){this._portal.current&&(this._portal.current.hide(),this._timeout&&(clearTimeout(this._timeout),this._timeout=null))}isShown(){return null!=this._timeout}current(){return this._timeout}show(e,t,o,s){const i=1e3*t;if(this._portal.current)this._portal.current.show(e,o,s);else{const t=document.createElement("div");t.classList.add("notify-portal-component"),document.body.appendChild(t),n.render(r.createElement(u,{ref:this._portal}),t,()=>{this._portal.current&&this._portal.current.show(e,o,s)})}return null!=this._timeout&&clearTimeout(this._timeout),this._timeout=setTimeout(()=>{this._portal.current&&this._portal.current.hide(),this._timeout=null,s&&s()},i)}}})),define("modules/core/persistence/storage",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UserLocalStorage=t.LocalStorage=t.SessionStorage=t.BrowserStorage=t.MemoryStorage=void 0;class o{constructor(){this.storage={}}clear(){this.storage={}}getItem(e){return this.storage[e]}key(e){return Object.keys(this.storage)[e]}removeItem(e){delete this.storage[e]}setItem(e,t){this.storage[e]=t}}t.MemoryStorage=o;class s{constructor(e){this.initFn=e}get storage(){return this.initFn&&(this._storage=(function(e){let t;try{t=e()||new o}catch(e){t=new o}try{const e="__storage_test__";return t.setItem(e,e),t.removeItem(e),t}catch(e){return t&&n(e)?t:new o}})(this.initFn),delete this.initFn),this._storage}get(e){if(this.storage){const t=this.storage.getItem(e);return t?"undefined"===t?void 0:JSON.parse(t):t}}set(e,t){if(this.storage)try{return null===t?this.delete(e):this.storage.setItem(e,JSON.stringify(t))}catch(e){if(n(e))return;throw e}}delete(e){return this.storage?this.storage.removeItem(e):void 0}reset(){return this.storage?this.storage.clear():void 0}}t.BrowserStorage=s;function n(e){return e instanceof DOMException&&(22===e.code||1014===e.code||"QuotaExceededError"===e.name||"NS_ERROR_DOM_QUOTA_REACHED"===e.name)}t.SessionStorage=new s(()=>window.sessionStorage),t.LocalStorage=new s(()=>window.localStorage),t.UserLocalStorage=new class{constructor(e){this.idPrefix="userId:",this.browserStorage=e}get(e,t){return this.browserStorage.get(this.formatKey(e,t))}set(e,t,o){return this.browserStorage.set(this.formatKey(e,t),o)}clearOtherUsers(e){Object.keys(this.browserStorage.storage).map(t=>{if(t.startsWith(this.idPrefix)){const o=t.substring(this.idPrefix.length,t.indexOf("."));e.includes(Number(o))||this.browserStorage.delete(t)}})}delete(e,t){return this.browserStorage.delete(this.formatKey(e,t))}formatKey(e,t){return`${this.idPrefix}${e}.${t}`}}(t.LocalStorage)})),define("prod_assets_web_modules/ts-key-enum",["./common/_commonjsHelpers"],(function(e){"use strict";var t,o,s={};return t=s,Object.defineProperty(t,"__esModule",{value:!0}),(o=t.Key||(t.Key={})).Unidentified="Unidentified",o.Alt="Alt",o.AltGraph="AltGraph",o.CapsLock="CapsLock",o.Control="Control",o.Fn="Fn",o.FnLock="FnLock",o.Hyper="Hyper",o.Meta="Meta",o.NumLock="NumLock",o.ScrollLock="ScrollLock",o.Shift="Shift",o.Super="Super",o.Symbol="Symbol",o.SymbolLock="SymbolLock",o.Enter="Enter",o.Tab="Tab",o.ArrowDown="ArrowDown",o.ArrowLeft="ArrowLeft",o.ArrowRight="ArrowRight",o.ArrowUp="ArrowUp",o.End="End",o.Home="Home",o.PageDown="PageDown",o.PageUp="PageUp",o.Backspace="Backspace",o.Clear="Clear",o.Copy="Copy",o.CrSel="CrSel",o.Cut="Cut",o.Delete="Delete",o.EraseEof="EraseEof",o.ExSel="ExSel",o.Insert="Insert",o.Paste="Paste",o.Redo="Redo",o.Undo="Undo",o.Accept="Accept",o.Again="Again",o.Attn="Attn",o.Cancel="Cancel",o.ContextMenu="ContextMenu",o.Escape="Escape",o.Execute="Execute",o.Find="Find",o.Finish="Finish",o.Help="Help",o.Pause="Pause",o.Play="Play",o.Props="Props",o.Select="Select",o.ZoomIn="ZoomIn",o.ZoomOut="ZoomOut",o.BrightnessDown="BrightnessDown",o.BrightnessUp="BrightnessUp",o.Eject="Eject",o.LogOff="LogOff",o.Power="Power",o.PowerOff="PowerOff",o.PrintScreen="PrintScreen",o.Hibernate="Hibernate",o.Standby="Standby",o.WakeUp="WakeUp",o.AllCandidates="AllCandidates",o.Alphanumeric="Alphanumeric",o.CodeInput="CodeInput",o.Compose="Compose",o.Convert="Convert",o.Dead="Dead",o.FinalMode="FinalMode",o.GroupFirst="GroupFirst",o.GroupLast="GroupLast",o.GroupNext="GroupNext",o.GroupPrevious="GroupPrevious",o.ModeChange="ModeChange",o.NextCandidate="NextCandidate",o.NonConvert="NonConvert",o.PreviousCandidate="PreviousCandidate",o.Process="Process",o.SingleCandidate="SingleCandidate",o.HangulMode="HangulMode",o.HanjaMode="HanjaMode",o.JunjaMode="JunjaMode",o.Eisu="Eisu",o.Hankaku="Hankaku",o.Hiragana="Hiragana",o.HiraganaKatakana="HiraganaKatakana",o.KanaMode="KanaMode",o.KanjiMode="KanjiMode",o.Katakana="Katakana",o.Romaji="Romaji",o.Zenkaku="Zenkaku",o.ZenkakuHanaku="ZenkakuHanaku",o.F1="F1",o.F2="F2",o.F3="F3",o.F4="F4",o.F5="F5",o.F6="F6",o.F7="F7",o.F8="F8",o.F9="F9",o.F10="F10",o.F11="F11",o.F12="F12",o.F13="F13",o.F14="F14",o.F15="F15",o.F16="F16",o.F17="F17",o.F18="F18",o.F19="F19",o.F20="F20",o.Soft1="Soft1",o.Soft2="Soft2",o.Soft3="Soft3",o.Soft4="Soft4",o.AppSwitch="AppSwitch",o.Call="Call",o.Camera="Camera",o.CameraFocus="CameraFocus",o.EndCall="EndCall",o.GoBack="GoBack",o.GoHome="GoHome",o.HeadsetHook="HeadsetHook",o.LastNumberRedial="LastNumberRedial",o.Notification="Notification",o.MannerMode="MannerMode",o.VoiceDial="VoiceDial",o.ChannelDown="ChannelDown",o.ChannelUp="ChannelUp",o.MediaFastForward="MediaFastForward",o.MediaPause="MediaPause",o.MediaPlay="MediaPlay",o.MediaPlayPause="MediaPlayPause",o.MediaRecord="MediaRecord",o.MediaRewind="MediaRewind",o.MediaStop="MediaStop",o.MediaTrackNext="MediaTrackNext",o.MediaTrackPrevious="MediaTrackPrevious",o.AudioBalanceLeft="AudioBalanceLeft",o.AudioBalanceRight="AudioBalanceRight",o.AudioBassDown="AudioBassDown",o.AudioBassBoostDown="AudioBassBoostDown",o.AudioBassBoostToggle="AudioBassBoostToggle",o.AudioBassBoostUp="AudioBassBoostUp",o.AudioBassUp="AudioBassUp",o.AudioFaderFront="AudioFaderFront",o.AudioFaderRear="AudioFaderRear",o.AudioSurroundModeNext="AudioSurroundModeNext",o.AudioTrebleDown="AudioTrebleDown",o.AudioTrebleUp="AudioTrebleUp",o.AudioVolumeDown="AudioVolumeDown",o.AudioVolumeMute="AudioVolumeMute",o.AudioVolumeUp="AudioVolumeUp",o.MicrophoneToggle="MicrophoneToggle",o.MicrophoneVolumeDown="MicrophoneVolumeDown",o.MicrophoneVolumeMute="MicrophoneVolumeMute",o.MicrophoneVolumeUp="MicrophoneVolumeUp",o.TV="TV",o.TV3DMode="TV3DMode",o.TVAntennaCable="TVAntennaCable",o.TVAudioDescription="TVAudioDescription",o.TVAudioDescriptionMixDown="TVAudioDescriptionMixDown",o.TVAudioDescriptionMixUp="TVAudioDescriptionMixUp",o.TVContentsMenu="TVContentsMenu",o.TVDataService="TVDataService",o.TVInput="TVInput",o.TVInputComponent1="TVInputComponent1",o.TVInputComponent2="TVInputComponent2",o.TVInputComposite1="TVInputComposite1",o.TVInputComposite2="TVInputComposite2",o.TVInputHDMI1="TVInputHDMI1",o.TVInputHDMI2="TVInputHDMI2",o.TVInputHDMI3="TVInputHDMI3",o.TVInputHDMI4="TVInputHDMI4",o.TVInputVGA1="TVInputVGA1",o.TVMediaContext="TVMediaContext",o.TVNetwork="TVNetwork",o.TVNumberEntry="TVNumberEntry",o.TVPower="TVPower",o.TVRadioService="TVRadioService",o.TVSatellite="TVSatellite",o.TVSatelliteBS="TVSatelliteBS",o.TVSatelliteCS="TVSatelliteCS",o.TVSatelliteToggle="TVSatelliteToggle",o.TVTerrestrialAnalog="TVTerrestrialAnalog",o.TVTerrestrialDigital="TVTerrestrialDigital",o.TVTimer="TVTimer",o.AVRInput="AVRInput",o.AVRPower="AVRPower",o.ColorF0Red="ColorF0Red",o.ColorF1Green="ColorF1Green",o.ColorF2Yellow="ColorF2Yellow",o.ColorF3Blue="ColorF3Blue",o.ColorF4Grey="ColorF4Grey",o.ColorF5Brown="ColorF5Brown",o.ClosedCaptionToggle="ClosedCaptionToggle",o.Dimmer="Dimmer",o.DisplaySwap="DisplaySwap",o.DVR="DVR",o.Exit="Exit",o.FavoriteClear0="FavoriteClear0",o.FavoriteClear1="FavoriteClear1",o.FavoriteClear2="FavoriteClear2",o.FavoriteClear3="FavoriteClear3",o.FavoriteRecall0="FavoriteRecall0",o.FavoriteRecall1="FavoriteRecall1",o.FavoriteRecall2="FavoriteRecall2",o.FavoriteRecall3="FavoriteRecall3",o.FavoriteStore0="FavoriteStore0",o.FavoriteStore1="FavoriteStore1",o.FavoriteStore2="FavoriteStore2",o.FavoriteStore3="FavoriteStore3",o.Guide="Guide",o.GuideNextDay="GuideNextDay",o.GuidePreviousDay="GuidePreviousDay",o.Info="Info",o.InstantReplay="InstantReplay",o.Link="Link",o.ListProgram="ListProgram",o.LiveContent="LiveContent",o.Lock="Lock",o.MediaApps="MediaApps",o.MediaAudioTrack="MediaAudioTrack",o.MediaLast="MediaLast",o.MediaSkipBackward="MediaSkipBackward",o.MediaSkipForward="MediaSkipForward",o.MediaStepBackward="MediaStepBackward",o.MediaStepForward="MediaStepForward",o.MediaTopMenu="MediaTopMenu",o.NavigateIn="NavigateIn",o.NavigateNext="NavigateNext",o.NavigateOut="NavigateOut",o.NavigatePrevious="NavigatePrevious",o.NextFavoriteChannel="NextFavoriteChannel",o.NextUserProfile="NextUserProfile",o.OnDemand="OnDemand",o.Pairing="Pairing",o.PinPDown="PinPDown",o.PinPMove="PinPMove",o.PinPToggle="PinPToggle",o.PinPUp="PinPUp",o.PlaySpeedDown="PlaySpeedDown",o.PlaySpeedReset="PlaySpeedReset",o.PlaySpeedUp="PlaySpeedUp",o.RandomToggle="RandomToggle",o.RcLowBattery="RcLowBattery",o.RecordSpeedNext="RecordSpeedNext",o.RfBypass="RfBypass",o.ScanChannelsToggle="ScanChannelsToggle",o.ScreenModeNext="ScreenModeNext",o.Settings="Settings",o.SplitScreenToggle="SplitScreenToggle",o.STBInput="STBInput",o.STBPower="STBPower",o.Subtitle="Subtitle",o.Teletext="Teletext",o.VideoModeNext="VideoModeNext",o.Wink="Wink",o.ZoomToggle="ZoomToggle",o.SpeechCorrectionList="SpeechCorrectionList",o.SpeechInputToggle="SpeechInputToggle",o.Close="Close",o.New="New",o.Open="Open",o.Print="Print",o.Save="Save",o.SpellCheck="SpellCheck",o.MailForward="MailForward",o.MailReply="MailReply",o.MailSend="MailSend",o.LaunchCalculator="LaunchCalculator",o.LaunchCalendar="LaunchCalendar",o.LaunchContacts="LaunchContacts",o.LaunchMail="LaunchMail",o.LaunchMediaPlayer="LaunchMediaPlayer",o.LaunchMusicPlayer="LaunchMusicPlayer",o.LaunchMyComputer="LaunchMyComputer",o.LaunchPhone="LaunchPhone",o.LaunchScreenSaver="LaunchScreenSaver",o.LaunchSpreadsheet="LaunchSpreadsheet",o.LaunchWebBrowser="LaunchWebBrowser",o.LaunchWebCam="LaunchWebCam",o.LaunchWordProcessor="LaunchWordProcessor",o.LaunchApplication1="LaunchApplication1",o.LaunchApplication2="LaunchApplication2",o.LaunchApplication3="LaunchApplication3",o.LaunchApplication4="LaunchApplication4",o.LaunchApplication5="LaunchApplication5",o.LaunchApplication6="LaunchApplication6",o.LaunchApplication7="LaunchApplication7",o.LaunchApplication8="LaunchApplication8",o.LaunchApplication9="LaunchApplication9",o.LaunchApplication10="LaunchApplication10",o.LaunchApplication11="LaunchApplication11",o.LaunchApplication12="LaunchApplication12",o.LaunchApplication13="LaunchApplication13",o.LaunchApplication14="LaunchApplication14",o.LaunchApplication15="LaunchApplication15",o.LaunchApplication16="LaunchApplication16",o.BrowserBack="BrowserBack",o.BrowserFavorites="BrowserFavorites",o.BrowserForward="BrowserForward",o.BrowserHome="BrowserHome",o.BrowserRefresh="BrowserRefresh",o.BrowserSearch="BrowserSearch",o.BrowserStop="BrowserStop",o.Decimal="Decimal",o.Key11="Key11",o.Key12="Key12",o.Multiply="Multiply",o.Add="Add",o.Divide="Divide",o.Subtract="Subtract",o.Separator="Separator",e.getDefaultExportFromCjs(s)})),define("prod_assets_web_modules/ts-keycode-enum",["./common/_commonjsHelpers"],(function(e){"use strict";var t,o,s={};return t=s,Object.defineProperty(t,"__esModule",{value:!0}),(o=t.Key||(t.Key={}))[o.Backspace=8]="Backspace",o[o.Tab=9]="Tab",o[o.Enter=13]="Enter",o[o.Shift=16]="Shift",o[o.Ctrl=17]="Ctrl",o[o.Alt=18]="Alt",o[o.PauseBreak=19]="PauseBreak",o[o.CapsLock=20]="CapsLock",o[o.Escape=27]="Escape",o[o.Space=32]="Space",o[o.PageUp=33]="PageUp",o[o.PageDown=34]="PageDown",o[o.End=35]="End",o[o.Home=36]="Home",o[o.LeftArrow=37]="LeftArrow",o[o.UpArrow=38]="UpArrow",o[o.RightArrow=39]="RightArrow",o[o.DownArrow=40]="DownArrow",o[o.Insert=45]="Insert",o[o.Delete=46]="Delete",o[o.Zero=48]="Zero",o[o.ClosedParen=48]="ClosedParen",o[o.One=49]="One",o[o.ExclamationMark=49]="ExclamationMark",o[o.Two=50]="Two",o[o.AtSign=50]="AtSign",o[o.Three=51]="Three",o[o.PoundSign=51]="PoundSign",o[o.Hash=51]="Hash",o[o.Four=52]="Four",o[o.DollarSign=52]="DollarSign",o[o.Five=53]="Five",o[o.PercentSign=53]="PercentSign",o[o.Six=54]="Six",o[o.Caret=54]="Caret",o[o.Hat=54]="Hat",o[o.Seven=55]="Seven",o[o.Ampersand=55]="Ampersand",o[o.Eight=56]="Eight",o[o.Star=56]="Star",o[o.Asterik=56]="Asterik",o[o.Nine=57]="Nine",o[o.OpenParen=57]="OpenParen",o[o.A=65]="A",o[o.B=66]="B",o[o.C=67]="C",o[o.D=68]="D",o[o.E=69]="E",o[o.F=70]="F",o[o.G=71]="G",o[o.H=72]="H",o[o.I=73]="I",o[o.J=74]="J",o[o.K=75]="K",o[o.L=76]="L",o[o.M=77]="M",o[o.N=78]="N",o[o.O=79]="O",o[o.P=80]="P",o[o.Q=81]="Q",o[o.R=82]="R",o[o.S=83]="S",o[o.T=84]="T",o[o.U=85]="U",o[o.V=86]="V",o[o.W=87]="W",o[o.X=88]="X",o[o.Y=89]="Y",o[o.Z=90]="Z",o[o.LeftWindowKey=91]="LeftWindowKey",o[o.RightWindowKey=92]="RightWindowKey",o[o.SelectKey=93]="SelectKey",o[o.Numpad0=96]="Numpad0",o[o.Numpad1=97]="Numpad1",o[o.Numpad2=98]="Numpad2",o[o.Numpad3=99]="Numpad3",o[o.Numpad4=100]="Numpad4",o[o.Numpad5=101]="Numpad5",o[o.Numpad6=102]="Numpad6",o[o.Numpad7=103]="Numpad7",o[o.Numpad8=104]="Numpad8",o[o.Numpad9=105]="Numpad9",o[o.Multiply=106]="Multiply",o[o.Add=107]="Add",o[o.Subtract=109]="Subtract",o[o.DecimalPoint=110]="DecimalPoint",o[o.Divide=111]="Divide",o[o.F1=112]="F1",o[o.F2=113]="F2",o[o.F3=114]="F3",o[o.F4=115]="F4",o[o.F5=116]="F5",o[o.F6=117]="F6",o[o.F7=118]="F7",o[o.F8=119]="F8",o[o.F9=120]="F9",o[o.F10=121]="F10",o[o.F11=122]="F11",o[o.F12=123]="F12",o[o.NumLock=144]="NumLock",o[o.ScrollLock=145]="ScrollLock",o[o.SemiColon=186]="SemiColon",o[o.Equals=187]="Equals",o[o.Comma=188]="Comma",o[o.Dash=189]="Dash",o[o.Period=190]="Period",o[o.UnderScore=189]="UnderScore",o[o.PlusSign=187]="PlusSign",o[o.ForwardSlash=191]="ForwardSlash",o[o.Tilde=192]="Tilde",o[o.GraveAccent=192]="GraveAccent",o[o.OpenBracket=219]="OpenBracket",o[o.ClosedBracket=221]="ClosedBracket",o[o.Quote=222]="Quote",e.getDefaultExportFromCjs(s)}));
//# sourceMappingURL=pkg-core.min.js-vflCys_Xu.map