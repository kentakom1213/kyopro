define(["require","exports","typescript/libraries/file-viewer/src/core/data/actions","typescript/libraries/file-viewer/src/core/data/utils","typescript/libraries/file-viewer/src/core/data/preview_key","typescript/libraries/file-viewer/src/core/data/selectors"],(function(e,t,r,i,a,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.tabSelectionHandler=void 0,t.tabSelectionHandler=({dispatch:e,getState:t})=>s=>c=>{if(s(c),c.type!==r.Action.SwitchWorkbookTab)return;const{previewKey:o,fileViewerId:n,tabIndex:d}=c.payload;if(a.isNestedArchiveFilePreviewKey(o))return;const p=t(),u=l.getPreviewData(p,o),f=l.getRivieraData(p,o);if(null==u||!i.isExcelApiV2MetadataContent(u.content))return;if(null==f||!i.isExcelPreviewRivieraData(f))return;const{workbook_data_url_tmpl:v}=u.content;if(null!=f.sheets){const t=f.sheets[d];null!=t&&"errored"!==t.state||e(r.fetchExcelSheetLayoutData({previewKey:o,fileViewerId:n,sheetIndex:d,workbookDataUrlTmpl:v}))}}}));
//# sourceMappingURL=tab_selection_handler.amd.min.js-vflPwSRC0.map