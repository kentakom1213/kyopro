define(["require","exports","tslib","react","react-redux","modules/clean/react/integrations/pdf_editor/strings","modules/clean/react/integrations/pdf_editor/redux/features/page_actions/page_actions_slice","modules/clean/react/integrations/pdf_editor/redux/features/thunks_across_multiple_slices","react-intl","dig-components/buttons","dig-components/icons","dig-components/icons/src","dig-components/text_fields","dig-components/tooltips","dig-components/typography","dig-components/menu","modules/clean/react/integrations/pdf_editor/utils/reorder_util","modules/clean/react/integrations/pdf_editor/utils/string_input_util","dig-components/text_fields","modules/clean/shallow_equal","modules/clean/react/integrations/pdf_editor/redux/features/logging/logging_actions_slice","modules/clean/logging/hive/schemas/web-edit_mode"],(function(e,t,a,n,s,r,l,i,o,c,d,u,m,g,p,f,v,E,b,_,S,M){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MoveButton=void 0,n=a.__importStar(n),t.MoveButton=({open:e=!1})=>{const t=s.useSelector(e=>e.sidebarActions.pagesData),a=s.useSelector(e=>e.pageActions.selectedPages),P=s.useSelector(e=>e.application.isNewActionAllowed),I=s.useDispatch(),h=o.useIntl(),[x,O]=n.useState([]),[N,j]=n.useState(),[H,w]=n.useState(""),[F,T]=n.useState(""),[C,A]=n.useState(!0),[B,y]=n.useState(!1),[k,D]=n.useState(e),L=e=>{(e.match(/^[\-0-9, ]+$/g)||""===e)&&(w(e),O(E.parseMoveInput(e)))},z=e=>{(e.match(/^[0-9]+$/g)||""===e)&&(T(e),e.match(/^[0-9]+$/g)&&""!==e?j(+e):j(-1))};n.useEffect(()=>{if(x.length>0){const e=E.isValidMoveInput(x,"moving",t.length);if(A(e),e){const e=x.map(e=>e-1);I(l.setPageSelection(e))}}else A(!1)},[x]),n.useEffect(()=>{let e;e=!(!N&&0!==N)&&E.isValidMoveInput([N],"after",t.length),y(e)},[N]),n.useEffect(()=>{const e=Object.keys(a).map(Number),t=x.map(e=>e-1);_.shallowEqualArray(t,e)||L(E.selectedPagesToString(e))},[a]);const U=()=>{if(!P)return;if(!B||!C)return;const e=x.map(e=>e-1),{result:a,indicesAfterDrag:n,afterIndex:s}=v.reorder(t,e,N,!1);I(S.logUserAction({eventName:M.PDFEditingEventNames.MOVE_PAGE,extra:{input_pages_for_move:H,move_after_page:s+1}})),I(i.reorderPages({newPageOrder:a,indicesAfterReorder:n,afterIndex:s})),z(""),D(!1)};return(n.default.createElement(f.Menu.Wrapper,{inverse:!0,isPortaled:!1},({getTriggerProps:e,getContentProps:t})=>n.default.createElement(n.default.Fragment,null,n.default.createElement(g.Tooltip,{title:r.HeaderStrings.movePageTooltip.defaultMessage,openDelay:1e3,shouldCloseOnClick:!0,className:"button-tooltip",inverse:!1},n.default.createElement(c.Button,Object.assign({},e(),{variant:"opacity",className:"tool-bar-button-general",withIconLeft:n.default.createElement(d.UIIcon,{src:u.MoveLine}),withDropdownIcon:!0,onClick:()=>D(!k)}),n.default.createElement(o.FormattedMessage,Object.assign({},r.HeaderStrings.movePageButton)))),n.default.createElement(f.Menu.Content,Object.assign({},t(),{className:"dropdown-move-menu",auto:!0,open:k}),n.default.createElement(f.Menu.Segment,null,n.default.createElement(f.Menu.Row,{preferComposition:!0,className:"dropdown-move-menu-row"},n.default.createElement(p.Text,{variant:"paragraph",size:"small",tagName:"p",isBold:!0,inverse:!0,className:"move-menu-line"},n.default.createElement(o.FormattedMessage,Object.assign({},r.HeaderStrings.movePageTitle))),n.default.createElement(m.TextInput,{"aria-label":h.formatMessage(Object.assign({},r.HeaderStrings.movePageSelectedPagesAriaLabel)),value:H,isInvalid:!C&&""!==H,onChange:e=>L(e.currentTarget.value),inverse:!0,className:"move-menu-line text-input",placeholder:h.formatMessage(Object.assign({},r.HeaderStrings.movePageSelectedPagesPlaceholder))}),!C&&""!==H&&n.default.createElement(b.FormHelperText,{isInvalid:!0,id:"invalid-input"},n.default.createElement(d.UIIcon,{src:u.FailLine,size:"small"})," ",n.default.createElement(o.FormattedMessage,Object.assign({},r.HeaderStrings.invalidMoveInput))),n.default.createElement(p.Text,{variant:"paragraph",size:"small",tagName:"p",isBold:!0,inverse:!0,className:"move-menu-line after-index"},n.default.createElement(o.FormattedMessage,Object.assign({},r.HeaderStrings.movePageEndIndex))),n.default.createElement(m.TextInput,{"aria-label":h.formatMessage(Object.assign({},r.HeaderStrings.movePageSelectedPagesEndIndexAriaLabel)),value:F,isInvalid:!B&&!!F,onChange:e=>z(e.currentTarget.value),inverse:!0,placeholder:h.formatMessage(Object.assign({},r.HeaderStrings.movePageEndIndexPlaceholder)),className:"move-menu-line text-input"}),!B&&F&&n.default.createElement(b.FormHelperText,{isInvalid:!0,id:"invalid-input"},n.default.createElement(d.UIIcon,{src:u.FailLine,size:"small"})," ",n.default.createElement(o.FormattedMessage,Object.assign({},r.HeaderStrings.invalidMoveInput))),n.default.createElement("div",{className:"confirmation-cancel-buttons"},n.default.createElement(c.Button,{variant:"transparent",onClick:()=>D(!1),inverse:!0,className:"cancel-button"},n.default.createElement(o.FormattedMessage,Object.assign({},r.HeaderStrings.movePageCancelButton))),n.default.createElement(c.Button,{variant:"outline",onClick:U,disabled:!(B&&C),inverse:!0,className:"move-button"},n.default.createElement(o.FormattedMessage,Object.assign({},r.HeaderStrings.movePageConfirmationButton))))))))))}}));
//# sourceMappingURL=move_button.min.js-vflB-zb0l.map