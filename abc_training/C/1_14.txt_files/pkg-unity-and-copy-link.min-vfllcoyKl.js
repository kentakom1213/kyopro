define("modules/clean/growth/user_action/trackers/personalization_tracker",["require","exports","modules/clean/growth/user_action/tracker"],(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PersonalizationTracker=t.PersonalizationProjectTag=t.PersonalizationActions=void 0,(function(e){e.ASSIGNED_SUGGESTED_FOLDERS="assigned_suggested_folders",e.DISMISS_ALL_SUGGESTED_FOLDER_TO_MOVE="dismiss_all_suggested_folder_to_move",e.DISMISS_DOWNLOAD_APP_PANEL="dismiss_download_app_panel",e.DISMISS_COLLECTIONS_QUICK_ACTION="dismiss_collections_quick_action",e.DISMISS_IN_FOLDER_ACTIVATION_BANNER="dismiss_in_folder_activation_banner",e.CLICK_IN_FOLDER_ACTIVATION_BANNER="click_in_folder_activation_banner",e.HIDE_SUGGESTED_FOLDER="hide_suggested_folder",e.CREATE_SUGGESTED_FOLDER="create_suggested_folder",e.DISMISS_SUGGESTED_FOLDER_TO_MOVE="dismiss_suggested_folder_to_move",e.MINIMIZE_COLLECTIONS_QUICK_ACTIONS="minimize_collections_quick_actions",e.QUICK_ACTION_SEE_SUGGESTED_FOLDERS="quick_action_see_suggested_folders",e.CLICK_DESKTOP_CTA="click_desktop_cta",e.DISMISS_CREATE_SUGGESTED_FOLDER_TOOLTIP="dismiss_create_suggested_folder_tooltip"})(t.PersonalizationActions||(t.PersonalizationActions={})),t.PersonalizationProjectTag="personalization";class i extends n.GrowthUserActionTracker{constructor(){super(...arguments),this.project=t.PersonalizationProjectTag}}t.PersonalizationTracker=i})),define("modules/clean/sharing/views/copy_link_mini_modal/copy_link_mini_modal",["require","exports","tslib","react","modules/clean/react/components/modal","modules/clean/react/components/css","modules/clean/web_user_action_events","modules/clean/sharing/views/share_modal_evolution/utils/logging","spectrum-sharing/utils/logging","spectrum-sharing/utils/sharing_constants","modules/clean/analytics","modules/core/browser_detection","modules/clean/sharing/views/copy_link_mini_modal/copy_link_mini_modal_util","modules/clean/sharing/views/copy_link_mini_modal/copy_link_mini_modal_overlay","modules/clean/sharing/views/copy_link_mini_modal/copy_link_mini_modal_util","modules/clean/clipboard_v3"],(function(e,t,n,i,s,o,r,a,_,l,c,d,h,u,p,E){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CopyLinkMiniModal=t.CopyLinkMiniModalComponent=void 0,i=n.__importDefault(i),s=n.__importStar(s);class S extends i.default.Component{constructor(e){super(e),this.handleCopyLinkToClipboard=()=>{E.copyToClipboard(this.sharedLink.url,()=>{this.handleClipboardSuccess(h.CopyLinkMethod.EXEC_COMMAND)},this.handleClipboardFailure)},this.handleClipboardSuccess=e=>{e!==h.CopyLinkMethod.MANUAL&&this.setState({stage:h.ModalState.RESULT}),this.logEvent(_.TiburonEventName.CopySharedLink,{created_new_link:this.isLinkNewlyCreated,copy_method:e})},this.handleClipboardFailure=()=>{this.copyLinkToClipboardNewAPI()},this.copyLinkToClipboardNewAPI=()=>{if(navigator.clipboard){const e=this.sharedLink.url;navigator.clipboard.writeText(e).then(()=>{this.handleClipboardSuccess(h.CopyLinkMethod.CLIPBOARD_API)},()=>{this.handleClipboardFailureNewAPI()})}else this.handleClipboardFailureNewAPI()},this.handleClipboardFailureNewAPI=()=>{this.exceptionType=h.CopyLinkException.FAILED_COPY_TO_CLIPBOARD,this.failToFetchCopyLinkHelper()},this.onClose=()=>{this.props.setIsCreatingSharedLink(!1,this.fileIdOrPath),this.props.userActionSource===r.ActionSourceValue.BUTTON&&this.props.onHoverLocked&&this.props.onHoverLocked({isOpen:!1}),this.props.onActionFlowComplete&&this.props.onActionFlowComplete(),this.setState({isOpen:!1})},this.focusOnInput=()=>{this.inputRef.current&&this.inputRef.current.select()},this.inputRef=i.default.createRef(),this.state={isOpen:!0,stage:h.ModalState.PENDING},this.fileIdOrPath=this.getFileIdOrPath()}componentDidMount(){this.createSharedLink()}createSharedLink(){this.props.setIsCreatingSharedLink(!0,this.fileIdOrPath),this.props.userActionSource===r.ActionSourceValue.BUTTON&&this.props.onHoverLocked&&this.props.onHoverLocked({isOpen:!0}),p.getApiClient(this.props.user).createSharedLinkNonAlpha({fileIdOrPath:this.fileIdOrPath,settings:{access:"max"}}).then(e=>{this.succeedToFetchLinkHelper(e,!0)}).catch(e=>{e.error[".tag"]===h.CopyLinkException.SHARED_LINK_ALREADY_EXISTS?this.succeedToFetchLinkHelper(e.error.shared_link_already_exists.metadata,!1,e):e.error[".tag"]===h.CopyLinkException.ACCESS_DENIED?(this.exceptionType=h.CopyLinkException.ACCESS_DENIED,this.failToFetchCopyLinkHelper(e)):e.error[".tag"]===h.CopyLinkException.SETTINGS_ERROR&&e.error.settings_error[".tag"]===h.CopyLinkException.NOT_AUTHORIZED?(this.exceptionType=h.CopyLinkException.NOT_AUTHORIZED,this.failToFetchCopyLinkHelper(e)):e.error[".tag"]===h.CopyLinkException.PATH&&e.error.path[".tag"]===h.CopyLinkException.NOT_FOUND?(this.exceptionType=h.CopyLinkException.NOT_FOUND,this.failToFetchCopyLinkHelper(e)):e.error[".tag"]===h.CopyLinkException.EMAIL_NOT_VERIFIED?(this.exceptionType=h.CopyLinkException.EMAIL_NOT_VERIFIED,this.failToFetchCopyLinkHelper(e)):(this.exceptionType=e.error[".tag"]?e.error[".tag"]:h.CopyLinkException.UNDEFINED_ERROR,this.failToFetchCopyLinkHelper(e))})}succeedToFetchLinkHelper(e,t,n){this.sharedLink=e,this.isLinkNewlyCreated=t;const i=t?200:n&&n.raw&&n.raw.status;this.logEvent(_.TiburonEventName.SucceedCreateSharedLinkWithSettings,{created_new_link:t,http_status_code:i,response_status:"success",is_alpha:!1}),p.isBrowserCopyEnabled()?this.handleCopyLinkToClipboard():this.setState({stage:h.ModalState.COPY})}failToFetchCopyLinkHelper(e){e&&this.logEvent(_.TiburonEventName.FailCreateSharedLinkWithSettings,{error_message:this.exceptionType,http_status_code:e.raw&&e.raw.status,is_alpha:!1}),this.setState({stage:h.ModalState.ERROR}),this.logEvent(_.TiburonEventName.CopySharedLinkFailure,{error:this.exceptionType})}getFileIdOrPath(){var e,t;return(null===(e=this.props.file)||void 0===e?void 0:e.file_id)||(null===(t=this.props.file)||void 0===t?void 0:t.fq_path)||this.props.filePath}getAccessLevel(){const e=this.sharedLink?this.sharedLink.link_permissions.link_access_level:void 0;let t="viewer";return e&&(t=e.hasOwnProperty(".tag")?e[".tag"]:e),t}logEvent(e,t){var n,i;let s=l.SHARE_ACTION_ORIGIN_TYPE.BROWSE_FILE_ROW_BUTTON;this.props.userActionSource===r.ActionSourceValue.OVERFLOW_MENU?s=l.SHARE_ACTION_ORIGIN_TYPE.BROWSE_FILE_ROW_OVERFLOW_MENU:this.props.userActionSource===r.ActionSourceValue.COPY_LINK_FROM_UPLOAD_MODAL&&(s=l.SHARE_ACTION_ORIGIN_TYPE.COPY_LINK_FROM_UPLOAD_MODAL);const o=d.get_browser_info();c.ShareTibEventLogger.log(this.props.user.id,e,s,Object.assign(Object.assign(Object.assign({},a.buildExtraFromLinkMetadata(this.sharedLink)),{file_id:null===(n=this.props.file)||void 0===n?void 0:n.file_id,fq_path:(null===(i=this.props.file)||void 0===i?void 0:i.fq_path)||this.props.filePath,browser:o.browser,browser_version:o.version}),t))}static show(e,n){s.Modal.showInstance(i.default.createElement(t.CopyLinkMiniModal,Object.assign({},e)),!0,n)}render(){if(!this.state.isOpen)return null;switch(this.state.stage){case h.ModalState.PENDING:return i.default.createElement(u.CopyLinkMiniModalOverlay,{stage:h.ModalStage.PENDING,closeButtonHandler:this.onClose,anchorRef:this.props.anchorRef,zIndexOverride:this.props.zIndexOverride,yOffsetDistance:this.props.yOffsetDistance});case h.ModalState.COPY:return i.default.createElement(u.CopyLinkMiniModalOverlay,{stage:h.ModalStage.COPY,actionHandler:this.handleCopyLinkToClipboard,closeButtonHandler:this.onClose,sharedLink:this.sharedLink,focusOnInput:this.focusOnInput,anchorRef:this.props.anchorRef,inputRef:this.inputRef,shouldFocusOnLink:!1,onCopyToClipboard:this.handleClipboardSuccess,zIndexOverride:this.props.zIndexOverride,yOffsetDistance:this.props.yOffsetDistance});case h.ModalState.ERROR:return this.exceptionType!==h.CopyLinkException.FAILED_COPY_TO_CLIPBOARD?i.default.createElement(u.CopyLinkMiniModalOverlay,{stage:h.ModalStage.ERROR_SERVER,closeButtonHandler:this.onClose,anchorRef:this.props.anchorRef,errorMessage:p.getServerErrorMessage(this.exceptionType),zIndexOverride:this.props.zIndexOverride,yOffsetDistance:this.props.yOffsetDistance}):i.default.createElement(u.CopyLinkMiniModalOverlay,{stage:h.ModalStage.ERROR_CLIENT,actionHandler:this.handleCopyLinkToClipboard,closeButtonHandler:this.onClose,sharedLink:this.sharedLink,focusOnInput:this.focusOnInput,inputRef:this.inputRef,anchorRef:this.props.anchorRef,shouldFocusOnLink:!0,onCopyToClipboard:this.handleClipboardSuccess,zIndexOverride:this.props.zIndexOverride,yOffsetDistance:this.props.yOffsetDistance});case h.ModalState.RESULT:return i.default.createElement(u.CopyLinkMiniModalOverlay,{stage:h.ModalStage.RESULT,linkAccessLevel:this.getAccessLevel(),actionHandler:this.handleCopyLinkToClipboard,closeButtonHandler:this.onClose,sharedLink:this.sharedLink,focusOnInput:this.focusOnInput,inputRef:this.inputRef,anchorRef:this.props.anchorRef,shouldFocusOnLink:!0,onCopyToClipboard:this.handleClipboardSuccess,zIndexOverride:this.props.zIndexOverride,yOffsetDistance:this.props.yOffsetDistance})}}}t.CopyLinkMiniModalComponent=S,S.displayName="CopyLinkMiniModalComponent",t.CopyLinkMiniModal=o.requireCssWithComponent(S,["/static/css/sharing/copy_link_mini_modal-vflbYOhyK.css","/static/css/dig-components/index.web-vflm67Rix.css"])})),define("modules/clean/sharing/views/copy_link_mini_modal/copy_link_mini_modal_header",["require","exports","tslib","react","spectrum-sharing/components/sharing_spinner/index","modules/core/i18n","dig-components/typography","dig-components/icons/src","dig-components/icons","dig-components/buttons","modules/clean/react/components/css","modules/clean/sharing/views/copy_link_mini_modal/copy_link_mini_modal_util"],(function(e,t,n,i,s,o,r,a,_,l,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CopyLinkMiniModalHeader=t.CopyLinkMiniModalHeaderComponent=void 0,i=n.__importStar(i);const h="copy-link-mini-modal__header";class u extends i.Component{render(){return i.createElement("div",{className:h},i.createElement("div",{className:`${h}-content`},this.props.stageType===d.ModalStage.PENDING&&this._renderPendingStage(),this.props.stageType===d.ModalStage.COPY&&this._renderCopyStage(),this.props.stageType===d.ModalStage.RESULT&&this._renderResultStage(),this.props.stageType===d.ModalStage.ERROR_CLIENT&&this._renderClientErrorStage(),this.props.stageType===d.ModalStage.ERROR_SERVER&&this._renderServerErrorStage()),this._renderCloseButton())}_renderPendingStage(){return i.createElement(i.Fragment,null,i.createElement(s.SharingSpinner,{ariaValue:"Loading xsmall",textSize:"standard"}),i.createElement(r.Text,{className:`${h}--pending-text`},o.intl.formatMessage({id:"LPF3tp",defaultMessage:"Getting the link..."})))}_renderCopyStage(){return i.createElement(r.Text,null,i.createElement(r.Link,{href:"#",hasNoUnderline:!0,onClick:this.props.actionHandler,isBold:!0},i.createElement(_.UIIcon,{src:a.LinkLine,"aria-label":""}),o.intl.formatMessage({id:"emiHs/",defaultMessage:"Copy Link"})))}_renderResultStage(){const e=o.intl.formatMessage({id:"l+Mf7Y",defaultMessage:"Allows editing."}),t=o.intl.formatMessage({id:"FXqYpV",defaultMessage:"Allows viewing."});let n="";return void 0!==this.props.linkAccessLevel&&(n="editor"===this.props.linkAccessLevel?e:t),i.createElement(i.Fragment,null,i.createElement(_.UIIcon,{className:`${h}--result-icon`,src:a.CheckmarkCircleLine,size:"standard","aria-label":""}),i.createElement(r.Text,{className:`${h}--result-text`},i.createElement("b",null,o.intl.formatMessage({id:"v2yJMn",defaultMessage:"Link copied."}))," ",n))}_renderClientErrorStage(){return i.createElement(i.Fragment,null,i.createElement(_.UIIcon,{className:`${h}--client-error-icon`,src:a.FailLine,"aria-label":""}),i.createElement(r.Text,{className:`${h}--client-error-text`},i.createElement("b",null,o.intl.formatMessage({id:"rp1Lxc",defaultMessage:"Couldn't copy the link."})," "),i.createElement(r.Link,{href:"#",hasNoUnderline:!0,onClick:this.props.actionHandler,isBold:!0},o.intl.formatMessage({id:"wXhxJC",defaultMessage:"Try again"}))))}_renderServerErrorStage(){return i.createElement(i.Fragment,null,i.createElement("div",null,i.createElement(_.UIIcon,{size:"standard",src:a.FailLine,"aria-label":""})),i.createElement(r.Text,{className:`${h}--server-error-text`},this.props.errorMessage))}_renderCloseButton(){return i.createElement(l.IconButton,{"aria-label":"close",onClick:this.props.closeButtonHandler,variant:"transparent",isRounded:!0,size:"small"},i.createElement(_.UIIcon,{src:a.CloseLine,"aria-label":""}))}}t.CopyLinkMiniModalHeaderComponent=u,u.displayName="CopyLinkMiniModalHeaderComponent",t.CopyLinkMiniModalHeader=c.requireCssWithComponent(u,["/static/css/dig-components/index.web-vflm67Rix.css","/static/css/sharing/copy_link_mini_modal-vflbYOhyK.css"])})),define("modules/clean/sharing/views/copy_link_mini_modal/copy_link_mini_modal_link",["require","exports","tslib","react","modules/clean/react/components/css","dig-components/text_fields","modules/clean/sharing/views/copy_link_mini_modal/copy_link_mini_modal_util"],(function(e,t,n,i,s,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CopyLinkMiniModalLink=t.CopyLinkMiniModalLinkComponent=void 0,i=n.__importStar(i);class a extends i.Component{constructor(){super(...arguments),this.handleCopy=()=>{this.props.onCopyToClipboard(r.CopyLinkMethod.MANUAL)}}componentDidMount(){this.props.shouldFocusOnLink&&this.props.focusOnInput()}componentDidUpdate(){this.props.shouldFocusOnLink&&this.props.focusOnInput()}render(){return i.createElement("div",{className:"copy-link-mini-modal__link"},i.createElement(o.TextInput,{onCopy:this.handleCopy,size:"standard","aria-label":"Link for copy link click",value:this.props.sharedLink.url,readOnly:!0,onClick:this.props.focusOnInput,ref:this.props.inputRef}))}}t.CopyLinkMiniModalLinkComponent=a,a.displayName="CopyLinkMiniModalLinkComponent",t.CopyLinkMiniModalLink=s.requireCssWithComponent(a,["/static/css/dig-components/index.web-vflm67Rix.css","/static/css/sharing/copy_link_mini_modal-vflbYOhyK.css"])})),define("modules/clean/sharing/views/copy_link_mini_modal/copy_link_mini_modal_overlay",["require","exports","tslib","react","modules/clean/react/components/css","lodash","dig-components/overlay","dig-components/click_outside","dig-components/layer","modules/clean/sharing/views/copy_link_mini_modal/copy_link_mini_modal_header","modules/clean/sharing/views/copy_link_mini_modal/copy_link_mini_modal_link"],(function(e,t,n,i,s,o,r,a,_,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CopyLinkMiniModalOverlay=t.CopyLinkMiniModalOverlayComponent=void 0,i=n.__importDefault(i);class d extends i.default.Component{constructor(){super(...arguments),this.onWindowResize=o.throttle(()=>{this.props.anchorRef.current||this.props.closeButtonHandler()},500),this.handleClick=e=>{e.preventDefault(),e.stopPropagation()}}componentDidMount(){window.addEventListener("resize",this.onWindowResize)}componentWillUnmount(){window.removeEventListener("resize",this.onWindowResize)}render(){var e;const{anchorRef:t,inputRef:n,stage:s,closeButtonHandler:o,linkAccessLevel:d,sharedLink:h,shouldFocusOnLink:u,focusOnInput:p,actionHandler:E,errorMessage:S,onCopyToClipboard:m,zIndexOverride:C}=this.props,g=i.default.createElement(l.CopyLinkMiniModalHeader,{stageType:s,actionHandler:E,closeButtonHandler:o,sharedLink:h,linkAccessLevel:d,errorMessage:S});let f=i.default.createElement(i.default.Fragment,null);return h&&p&&n&&(f=i.default.createElement(c.CopyLinkMiniModalLink,{sharedLink:h,focusOnInput:p,inputRef:n,shouldFocusOnLink:u,onCopyToClipboard:m})),i.default.createElement(_.LayerContext.Provider,{value:C||20},i.default.createElement(a.ClickOutside,{isActive:!0,onClickOutside:o,shouldPropagateMouseEvents:!1,isBlock:!0,shouldClickOutsideWhenDefaultPrevented:!0},i.default.createElement(r.Overlay,{className:"copy-link-mini-modal__overlay",anchorRef:t,placement:"bottom",auto:!0,offsetDistance:null!==(e=this.props.yOffsetDistance)&&void 0!==e?e:4,onClick:this.handleClick},g,f)))}}t.CopyLinkMiniModalOverlayComponent=d,d.displayName="CopyLinkMiniModalOverlayComponent",t.CopyLinkMiniModalOverlay=s.requireCssWithComponent(d,["/static/css/sharing/copy_link_mini_modal-vflbYOhyK.css","/static/css/dig-components/index.web-vflm67Rix.css"])})),define("modules/clean/sharing/views/copy_link_mini_modal/copy_link_mini_modal_util",["require","exports","modules/clean/sharing/api/client","modules/core/i18n"],(function(e,t,n,i){"use strict";var s;Object.defineProperty(t,"__esModule",{value:!0}),t.getServerErrorMessage=t.isBrowserCopyEnabled=t.getApiClient=t.CopyLinkMethod=t.ModalState=t.CopyLinkException=t.ModalStage=void 0,(function(e){e.PENDING="pending",e.COPY="copy",e.RESULT="result",e.ERROR_CLIENT="error_client",e.ERROR_SERVER="error_server"})(t.ModalStage||(t.ModalStage={})),(function(e){e.SHARED_LINK_ALREADY_EXISTS="shared_link_already_exists",e.ACCESS_DENIED="access_denied",e.PATH="path",e.NOT_FOUND="not_found",e.EMAIL_NOT_VERIFIED="email_not_verified",e.SETTINGS_ERROR="settings_error",e.NOT_AUTHORIZED="not_authorized",e.UNDEFINED_ERROR="undefined_error",e.FAILED_COPY_TO_CLIPBOARD="failed_copy_to_clipboard"})(s=t.CopyLinkException||(t.CopyLinkException={})),(function(e){e.PENDING="pending",e.COPY="copy",e.RESULT="result",e.ERROR="error"})(t.ModalState||(t.ModalState={})),(function(e){e.EXEC_COMMAND="exec_command",e.CLIPBOARD_API="clipboard_api",e.MANUAL="manual"})(t.CopyLinkMethod||(t.CopyLinkMethod={})),t.getApiClient=e=>new n.FileShareApiClient({userId:e.id}),t.isBrowserCopyEnabled=()=>{const e=document.createElement("input");return e.value="sharing is caring",document.body.appendChild(e),e.select(),document.queryCommandEnabled("copy")},t.getServerErrorMessage=e=>{switch(e){case s.ACCESS_DENIED:case s.NOT_AUTHORIZED:return i.intl.formatMessage({id:"2wQgFw",defaultMessage:"Couldn't copy the link. You don't have permission to create a link to this content."});case s.NOT_FOUND:return i.intl.formatMessage({id:"+HMjSg",defaultMessage:"We can't find this file anymore. Try checking activity or folder history to see what happened."});case s.EMAIL_NOT_VERIFIED:return i.intl.formatMessage({id:"cHWnMe",defaultMessage:"You can't share until you verify your email address."});default:return i.intl.formatMessage({id:"pAS2H5",defaultMessage:"Couldn't copy, but it might be a fluke. Try reloading the page or ask us for help."})}}})),define("modules/clean/sharing/views/share_modal_evolution/utils/logging",["require","exports","spectrum-sharing/utils/logging"],(function(e,t,n){"use strict";function i(e){const t=new URL(e);if(-1!==t.search.indexOf("rlkey")){const e=t.searchParams.get("rlkey");return{kind:n.LinkKeyTypes.RL,val:e,link_type:n.LinkTypes.Righteous}}if(-1!==t.pathname.indexOf("/s/")||-1!==t.pathname.indexOf("/sh/")){const e=(e=>e.pathname.indexOf("/raw/")*e.pathname.indexOf("/dl/")*e.pathname.indexOf("/print/")>0)(t)?3:2,i=t.pathname.split("/")[e];return{kind:n.LinkKeyTypes.SH,val:i,link_type:n.LinkTypes.Shmodel}}return{kind:n.LinkKeyTypes.NONE,val:"",link_type:n.LinkTypes.NONE}}function s(e){if(!e)return{};const t={link_id:e.id,link_access_level:(s=e.link_permissions.link_access_level,s?s.hasOwnProperty(".tag")?s[".tag"]:s:n.AccessType.Viewer)};var s;const o=i(e.url);return o.kind!==n.LinkKeyTypes.NONE&&(t[o.kind]=o.val,t.link_type=o.link_type),t}Object.defineProperty(t,"__esModule",{value:!0}),t.buildExtraFromLinkMetadata=t.getLinkKey=t.buildExtraFromMetadata=void 0,t.buildExtraFromMetadata=function(e,t){return Object.assign(Object.assign({},(function(e){return{user_access_type:e.access_type,is_folder:e.isFolder(),fq_path:e.path_lower,content_id:e.contentId(),ns_id:e.nsId(),can_create_edit_link:e.canCreateEditLink(),can_create_view_link:e.canCreateViewLink(),can_edit_inband_invite:e.canEditInbandInvite(),can_view_inband_invite:e.canViewInbandInvite(),max_access:e.canCreateEditLink()||e.canEditInbandInvite()?n.AccessType.Editor:n.AccessType.Viewer}})(e)),s(t))},t.getLinkKey=i,t.buildExtraFromLinkMetadata=s})),define("modules/clean/unity/check_file_cache",["require","exports","modules/clean/unity/features"],(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{static is_cached_and_locally_available(e,t){const i=this._cache[n.UnityFeatures.server_path(e,t)];return null!=i&&i.is_locally_available}static get(e,t){return this._cache[n.UnityFeatures.server_path(e,t)]}static set(e,t){this._cache[e]=t}static set_batch(e){Object.assign(this._cache,e)}static clear(){this._cache={}}}i._cache={};let s=i;n.UnityFeatures.isUnitySupported()||(s=void 0),t.default=s})),define("modules/clean/unity/connection",["require","exports","tslib","lodash","modules/clean/deprecated_ajax/ajax_jquery","modules/clean/unity/connection_error","modules/clean/unity/logger","modules/clean/unity/versions","modules/clean/unity/websocket_config","modules/clean/unity/web_socket","modules/clean/viewer","modules/constants/unity","modules/core/assert","modules/core/uri"],(function(e,t,n,i,s,o,r,a,_,l,c,d,h,u){"use strict";var p,E,S;Object.defineProperty(t,"__esModule",{value:!0}),t.isUnitySupported=t.UnityConnection=t.MAX_PORT=t.MIN_PORT=t.Permissions=t.ConnectionState=t.LastCompletedSecurityHandshakeStep=void 0,s=n.__importStar(s),r=n.__importDefault(r),a=n.__importDefault(a),d=n.__importStar(d),(function(e){e.CONNECTION_OPENED="CONNECTION_OPENED",e.VERSION_CHECK="VERSION_CHECK",e.FETCHING_NONCE="FETCHING_NONCE",e.NONCE_RETURNED_TO_CLIENT="NONCE_RETURNED_TO_CLIENT",e.HANDSHAKE_COMPLETED="HANDSHAKE_COMPLETED"})(p=t.LastCompletedSecurityHandshakeStep||(t.LastCompletedSecurityHandshakeStep={})),(function(e){e.PENDING="PENDING",e.ESTABLISHED="ESTABLISHED",e.CLOSED="CLOSED",e.RETRYING="RETRYING"})(E=t.ConnectionState||(t.ConnectionState={})),(function(e){e.SECURE_PERMISSION="secure",e.INSECURE_WEB_PERMISSION="insecure_web",e.INSECURE_CLIENT_PERMISSION="insecure_client",e.INSECURE_PERMISSION="insecure"})(S=t.Permissions||(t.Permissions={}));t.MIN_PORT=17600,t.MAX_PORT=17602;class m{constructor(){this.client_version=null,this.logger=new r.default,this._on_open_callbacks=[],this._on_open_failed_callbacks=[],this._on_close_callbacks=[],this._pending_callbacks=[],this._response_callbacks={},this._webSocket=null,this._port=null,this._active_ports={},this._connection_state=E.PENDING,this._current_message_id=1,this._permission_level=null,this._on_close=e=>t=>{[1e3,1001,1005,1006].includes(t.code)||this.logger.report_event("unity_failure",{message:`WebSocket closed. Code: ${t.code}. Reason: ${t.reason}`,port:e}),this._close_port(e)},this._on_error=e=>t=>{this.logger.report_event("unity_failure",{message:"WebSocket unknown error",port:e}),this._close_port(e)},this._set_connection_state=e=>{if(e===this._connection_state)return;const t=this._connection_state;if(h.assert(t!==E.CLOSED,"Shouldn't unclose a closed connection."),this._connection_state=e,e===E.ESTABLISHED){h.assert(this._is_connection_in_progress(t),"Can only establish from pending or retrying."),this.logger.report_event("handshake_complete"),t===E.PENDING&&this._on_open_callbacks.forEach(e=>e());const e=[];for(;this._pending_callbacks.length;){const{callback:t,error_callback:n}=this._pending_callbacks.pop();this.is_ready()?e.push(t()):e.push("function"==typeof n?n(o.UnityConnectionError.UNEXPECTED_ERROR):void 0)}return e}if(e!==E.RETRYING){if(e===E.CLOSED){t===E.PENDING?(this.logger.report_event("connection_not_established"),this._on_open_failed_callbacks.forEach(e=>e())):t===E.RETRYING?(this.logger.report_event("connection_terminated"),this._on_close_callbacks.forEach(e=>e())):h.assert(!1,"CONNECTION_CLOSED can only be set from PENDING or RETRYING");const e=[];for(;this._pending_callbacks.length;){const{error_callback:t}=this._pending_callbacks.pop();e.push("function"==typeof t?t(o.UnityConnectionError.CONNECTION_CLOSED):void 0)}return e}return h.assert(!1,"Changing connection_state to CONNECTION_PENDING not supported.")}},this._on_message=e=>t=>{const n=JSON.parse(t.data);if(n.func&&n.header&&n.header.message_id&&void 0!==n.header.should_respond)if(n.header.log_data&&this.logger.update(n.header.log_data),this.logger.update({port:e.port}),"response"===n.func)this._on_response(n.header.message_id,n.data);else{const t=this._routes[n.func];if(null==t)return void this._terminate_handshake(e.ws,"Unknown function.",{function:n.func});const i=this.is_ready()?t(n.data):t(e,n.data);n.header&&n.header.should_respond&&this.send("response",i,null,null,n.header.message_id)}else this._terminate_handshake(e.ws,"Malformed message from client.",{message:t.data})},this._on_response_timeout=e=>()=>{const{error_callback:t}=this._response_callbacks[e];delete this._response_callbacks[e],t&&t(o.UnityConnectionError.CONNECTION_TIMEOUT)},this._check_unity_version=(e,t)=>{if(e.state!==p.CONNECTION_OPENED)return void this._terminate_handshake(e.ws,"Handshake version check at wrong time of protocol.");if(e.state=p.VERSION_CHECK,e.client_version=t.client_version,t.client_version<a.default.UNITY_HANDSHAKE)return void this._terminate_handshake(e.ws,"Client version is too old.");const n=this._web_has_auth();if(!(t.client_version<a.default.PERMISSION_LEVELS)||n)return this.logger.report_event("handshake_version_check"),t.client_version>=a.default.PERMISSION_LEVELS?this._send_with_ws(e.ws,"initiate_handshake",{secure_web:n}):this._send_with_ws(e.ws,"initiate_handshake");this._terminate_handshake(e.ws,"Client version is too old to support insecure web connections.")},this._fetch_unity_nonce=(e,t)=>{e.state===p.VERSION_CHECK?(e.state=p.FETCHING_NONCE,this.logger.report_event("handshake_fetch_nonce"),this._retrieve_unity_nonce(e,t.nonce_key)):this._terminate_handshake(e.ws,"Fetch Unity nonce at wrong time of protocol.")},this._complete_handshake=(e,t)=>{if(e.state===p.NONCE_RETURNED_TO_CLIENT&&t.is_success)if(e.state=p.HANDSHAKE_COMPLETED,this._connection_state===E.CLOSED)this._terminate_handshake(e.ws,"No more handshakes are allowed to complete.");else if(null!=this._webSocket){const t="Only one Unity handshake can succeed! There's likely a MITM attack, so close all connections.";this._terminate_handshake(e.ws,t),this._terminate_handshake(this._webSocket,t),this.client_version=null,this._webSocket=null,this._port=null,this._set_connection_state(E.CLOSED)}else this.client_version=e.client_version,this._webSocket=e.ws,this._port=e.port,this._set_connection_state(E.ESTABLISHED);else this._terminate_handshake(e.ws,"Unable to complete handshake.")},this._routes={check_unity_version:this._check_unity_version,fetch_unity_nonce:this._fetch_unity_nonce,complete_handshake:this._complete_handshake}}start(){_.WebSocketConfig.canUnityConnect()?this._attempt_handshake():(this._set_connection_state(E.CLOSED),this.logger.report_event("unity_failure",{message:"WebSocket creation failed. Not able to create web socket."}))}_attempt_handshake(){for(let e=t.MIN_PORT;e<=t.MAX_PORT;e++)try{this._active_ports[e]=!0;const t={scheme:"ws",authority:`127.0.0.1:${e.toString()}`,path:"/ws"},n=l.UnityWebSocket.create(new u.URI(t).toString());n.onmessage=this._on_message({ws:n,port:e,state:p.CONNECTION_OPENED,client_version:null,client_has_auth:null}),n.onclose=this._on_close(e),n.onerror=this._on_error(e)}catch(t){this.logger.report_event("unity_failure",{message:`WebSocket creation failed. Message: ${t.message}`,error_name:t.name,port:e}),this._set_connection_state(E.CLOSED)}this.logger.report_event("handshake_started")}_close_port(e){if(e in this._active_ports&&(delete this._active_ports[e],i.isEmpty(this._active_ports)))return this._connection_state===E.ESTABLISHED?this._retry_connection():this._set_connection_state(E.CLOSED)}_retry_connection(){return this.logger.report_event("connection_retrying"),this._set_connection_state(E.RETRYING),this.client_version=this._webSocket=this._port=null,this._attempt_handshake()}send(e,t=null,n=null,i=null,s=null){if(this._webSocket)return this._send_with_ws(this._webSocket,e,t,n,i,s)}_send_with_ws(e,t,n=null,i=null,s=null,r=null){if(null==r&&(r=this._current_message_id,h.assert(this._current_message_id%2==1,"Web-initiated message_ids should remain odd"),this._current_message_id+=2),null!==i){const e=window.setTimeout(this._on_response_timeout(r),5e3);this._response_callbacks[r]={response_callback:i,error_callback:s,timeout_id:e}}const a={func:t,header:{message_id:r,should_respond:null!==i,log_data:this.logger.get_log_data_for_client()}};null!=n&&(a.data=n);try{return e.send(JSON.stringify(a))}catch(e){this.logger.report_event("unity_failure",{message:`WebSocket send failed. Message: ${e.message}`,error_name:e.name}),s&&s(o.UnityConnectionError.COULD_NOT_SEND)}}_on_response(e,t){if(e in this._response_callbacks){const{response_callback:n,timeout_id:i}=this._response_callbacks[e];delete this._response_callbacks[e],window.clearTimeout(i),n&&n(t)}}_web_has_auth(){return c.Viewer.get_viewer().is_signed_in}_retrieve_unity_nonce(e,t){return s.WebRequest({url:new u.URI({path:"/retrieve_unity_nonce"}),dataType:"json",data:{nonce_key:t},success:t=>{switch(t.status){case"OK":if(e.state=p.NONCE_RETURNED_TO_CLIENT,(null===e.client_version||e.client_version>=a.default.PORT_CHECK)&&(h.assert(t.message.client_port,`Port check must happen in version ${e.client_version}`),t.message.client_port!==e.port))return void this._terminate_handshake(e.ws,"Mismatched ports.",{client_port:t.message.client_port,web_port:e.port});e.client_has_auth=t.message.client_has_auth;const n=this._web_has_auth();return e.client_has_auth&&n?this._permission_level=m.SECURE_PERMISSION:(h.assert(null===e.client_version||e.client_version>=a.default.PERMISSION_LEVELS,`Insecure connections only supported by client_version >= ${a.default.PERMISSION_LEVELS}.`),this._permission_level=e.client_has_auth?m.INSECURE_WEB_PERMISSION:n?m.INSECURE_CLIENT_PERMISSION:m.INSECURE_PERMISSION),this.logger.update({unity_permission_level:this._permission_level}),this.logger.report_event("handshake_nonce_sent_to_unity_server"),this._send_with_ws(e.ws,"verify_unity_nonce",{nonce:t.message.nonce});case"MISMATCHED_USER_IDS":return this._terminate_handshake(e.ws,"Mismatched user_ids.",{client_user_ids:t.message.client_user_ids,web_user_ids:t.message.web_user_ids});case"INVALID":return this._terminate_handshake(e.ws,"Could not find nonce with given nonce_key.");case"AUTH_REQUIRED":return this._terminate_handshake(e.ws,"Did not have the necessary authentication to retrieve nonce.");case"LOCAL_INFORMATION_PERMISSION_REQUIRED":return this._terminate_handshake(e.ws,"Did not have permission to start a local-information-allowed connection.")}},error:(t,n,i)=>{this._terminate_handshake(e.ws,"Unable to retrieve nonce from server",{status:n,error_string:i})}})}_terminate_handshake(e,t,n={}){const i=Object.assign({message:t},n);d.UNITY_WEB_DEBUG&&console.error(i),this.logger.report_event("unity_failure",i),e&&e.close()}_is_connection_in_progress(e){return e===E.PENDING||e===E.RETRYING}add_on_open_callback(e){this._on_open_callbacks.push(e)}add_on_open_failed_callback(e){this._on_open_failed_callbacks.push(e)}add_on_close_callback(e){this._on_close_callbacks.push(e)}call_when_ready(e,t=null){return this.is_ready()?e():this._is_connection_in_progress(this._connection_state)?this._pending_callbacks.push({callback:e,error_callback:t}):t?t(o.UnityConnectionError.CONNECTION_CLOSED):void 0}is_ready(){return this._webSocket&&this._webSocket.readyState===WebSocket.OPEN&&this._connection_state===E.ESTABLISHED}feature_supported(e,t=[]){return h.assert(null!==this._permission_level,"Connection is not ready."),!(null!==this.client_version&&this.client_version<e)&&t.includes(this._permission_level)}}t.UnityConnection=m,m.SECURE_PERMISSION=S.SECURE_PERMISSION,m.INSECURE_WEB_PERMISSION=S.INSECURE_WEB_PERMISSION,m.INSECURE_CLIENT_PERMISSION=S.INSECURE_CLIENT_PERMISSION,m.INSECURE_PERMISSION=S.INSECURE_PERMISSION,t.isUnitySupported=()=>l.UnityWebSocket.web_sockets_supported()})),define("modules/clean/unity/connection_error",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UnityConnectionError=void 0,(function(e){e.CONNECTION_TIMEOUT="connection_timeout",e.CONNECTION_CLOSED="connection_closed",e.COULD_NOT_SEND="could_not_send",e.UNEXPECTED_ERROR="unexpected_error"})(t.UnityConnectionError||(t.UnityConnectionError={}))})),define("modules/clean/unity/features",["require","exports","tslib","modules/clean/deprecated_ajax/ajax_jquery","modules/clean/filepath/filepath","modules/clean/unity/connection","modules/clean/unity/versions","modules/core/assert","modules/core/i18n","modules/core/notify","modules/core/uri"],(function(e,t,n,i,s,o,r,a,_,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UnityFeatures=void 0,i=n.__importStar(i),s=n.__importStar(s),r=n.__importDefault(r),t.UnityFeatures={_uc:new o.UnityConnection,_has_handshake_started:!1,_cached_file_browser_display_name:null,_start_handshake_if_needed(){this._has_handshake_started||(this._uc.start(),this._has_handshake_started=!0)},continue_as_user(e,t,n,i=null){return this._start_handshake_if_needed(),this._uc.call_when_ready(()=>{if(this._uc.feature_supported(r.default.WEB_DESTINY,[o.UnityConnection.INSECURE_WEB_PERMISSION]))return this._uc.logger.report_event("continue_as_user",{browser:e,refresh_token:t}),this._uc.send("continue_as_user",{browser:e,refresh_token:t},n,i)},i)},continue_as_user_direct(e,t=null){return this._start_handshake_if_needed(),this._uc.call_when_ready(()=>{if(this._uc.feature_supported(r.default.WEB_DESTINY_V2,[o.UnityConnection.INSECURE_WEB_PERMISSION]))return this._uc.logger.report_event("continue_as_user_direct"),this._uc.send("continue_as_user_direct",null,e,t)},t)},web_destiny_info(e,t=null){return this._start_handshake_if_needed(),this._uc.call_when_ready(()=>{if(this._uc.feature_supported(r.default.WEB_DESTINY_V2,[o.UnityConnection.INSECURE_WEB_PERMISSION]))return this._uc.logger.report_event("web_destiny_info"),this._uc.send("web_destiny_info",null,e,t)},t)},client_supports_open_in_file_browser(){return this._uc.feature_supported(r.default.OPEN_IN_FILE_BROWSER,[o.UnityConnection.SECURE_PERMISSION])},ensure_unity_ready(){return this._start_handshake_if_needed(),new Promise(e=>this._uc.call_when_ready(()=>{e(!0)},()=>{this._uc=new o.UnityConnection,this._has_handshake_started=!1,e(!1)}))},open_file(e,t,n,_,l=null,d=!1){this._start_handshake_if_needed();const h=this.server_path(e,t);return this._uc.call_when_ready(()=>{if(this._uc.feature_supported(r.default.UNITY_HANDSHAKE,[o.UnityConnection.SECURE_PERMISSION])){this._uc.logger.report_event("open_file",{user_id:n,path_id:h,file_extension:s.file_extension(h),in_file_browser:d}),i.SilentBackgroundRequest({url:new c.URI({path:"/unity_open_log"}),data:{user_id:n,server_path:h,file_extension:s.file_extension(h),in_file_browser:d,unity_session_id:this._uc.logger.unity_session_id(),buildno:this._uc.logger._data.buildno,host_id:this._uc.logger._data.host_id}});const e={server_path:h,user_id:n};this._uc.client_version>=r.default.OPEN_IN_FILE_BROWSER?e.in_file_browser=d:a.assert(!d,"The connected client doesn't support opening in file browser."),this._uc.send("open_file",e,_,l)}},l)},standard_open_file_handler(e){if(!e)return l.Notify.error(_.intl.formatMessage({id:"9HWjA9",defaultMessage:"Error opening file"}))},check_file(e,t,n,i,a=null){this._start_handshake_if_needed();const _=this.server_path(e,t),l=e=>{this._check_file_deprecated_on_client()&&(e={is_locally_available:e}),i(e)};this._uc.call_when_ready(()=>{if(this._uc.feature_supported(r.default.UNITY_HANDSHAKE,[o.UnityConnection.SECURE_PERMISSION]))return this._uc.logger.report_event("check_file",{user_id:n,path_id:_,file_extension:s.file_extension(_)}),this._uc.send("check_file",{server_path:_,user_id:n},l,a)},a)},add_on_ready_callback(e){return this._uc.call_when_ready(e)},check_file_batch(e,t,n,i=null){return new Promise((a,_)=>{this._start_handshake_if_needed();const l=e.map(e=>this.server_path(e.ns_id,e.ns_path)),c=e=>{if(this._check_file_deprecated_on_client())for(const t in e){const n=e[t];e[t]={is_locally_available:n}}n&&n(e),a(e)},d=function(e){i&&i(e),_(e)};this._uc.call_when_ready(()=>{if(this._uc.feature_supported(r.default.UNITY_HANDSHAKE,[o.UnityConnection.SECURE_PERMISSION]))return this._uc.logger.report_event("check_file_batch",{user_id:t,path_ids:l,file_extensions:l.map(s.file_extension)}),this._uc.send("check_file_batch",{server_paths:l,user_id:t},c,d)},d)})},file_browser_display_name(e,t=null){if(null!=this._cached_file_browser_display_name)return void e(this._cached_file_browser_display_name);const n=t=>(this._cached_file_browser_display_name=t,e(t));this._start_handshake_if_needed();return this._uc.call_when_ready(()=>this._uc.feature_supported(r.default.CHECK_FILE_RETURNS_OBJ,[o.UnityConnection.SECURE_PERMISSION])?(this._uc.logger.report_event("file_browser_display_name"),this._uc.send("file_browser_display_name",null,n,t)):e(null),t)},_check_file_deprecated_on_client(){return r.default.UNITY_HANDSHAKE<=this._uc.client_version&&this._uc.client_version<r.default.CHECK_FILE_RETURNS_OBJ},server_path:(e,t)=>`${e}:${t}`,has_chime(e,t=null){this._start_handshake_if_needed();return this._uc.call_when_ready(()=>{if(this._uc.feature_supported(r.default.CHIME_OPEN,[o.UnityConnection.SECURE_PERMISSION]))return this._uc.logger.report_event("has_chime"),this._uc.send("has_chime",null,e,t)},t)},open_chime(e,t,n=null){this._start_handshake_if_needed();return this._uc.call_when_ready(()=>{if(this._uc.feature_supported(r.default.CHIME_OPEN,[o.UnityConnection.SECURE_PERMISSION]))return this._uc.logger.report_event("open_chime",{parameters:e}),this._uc.send("open_chime",e,t,n)},n)},growth_deep_link(e,t={}){return new Promise((n,i)=>{this._start_handshake_if_needed(),this._uc.call_when_ready(()=>{if(this._uc.feature_supported(r.default.GROWTH_DEEP_LINK,[o.UnityConnection.SECURE_PERMISSION]))return this._uc.logger.report_event("growth_deep_link"),this._uc.send("growth_deep_link",{resource:e,data:t},n,i);i("featured_unsupported")},i)})},can_open_apollo(){return new Promise((e,t)=>(this._start_handshake_if_needed(),this._uc.call_when_ready(()=>{this._uc.feature_supported(r.default.OPEN_COLLAB_BROWSE,[o.UnityConnection.SECURE_PERMISSION,o.UnityConnection.INSECURE_WEB_PERMISSION])&&this._uc.send("can_open_apollo",{},e,t)},t)))},open_apollo_main_window(){return new Promise((e,t)=>(this._start_handshake_if_needed(),this._uc.call_when_ready(()=>{this._uc.feature_supported(r.default.OPEN_COLLAB_BROWSE,[o.UnityConnection.SECURE_PERMISSION,o.UnityConnection.INSECURE_WEB_PERMISSION])&&this._uc.send("open_apollo_main_window",{},e,t)},t)))},isUnitySupported:()=>o.isUnitySupported()};const d=o.isUnitySupported()?t.UnityFeatures:void 0;t.default=d})),define("modules/clean/unity/logger",["require","exports","tslib","modules/clean/deprecated_ajax/ajax_jquery","modules/clean/unity/versions","modules/constants/unity","modules/core/uri"],(function(e,t,n,i,s,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=n.__importStar(i),s=n.__importDefault(s),o=n.__importStar(o);t.default=class{constructor(){this._data={logging_source:"web",web_unity_version:s.default.LATEST}}update(e){return this._data=Object.assign(Object.assign({},this._data),e),this._data}report_event(e,t=null){if(this._data.event_name=e,this._data.local_ts=(new Date).getTime()/1e3,this._data.extra=JSON.stringify(t||{}),i.SilentBackgroundRequest({url:new r.URI({path:"/unity_connection_log"}),data:this._data}),o.UNITY_WEB_DEBUG)return console.log(this._data)}get_log_data_for_client(){return{web_unity_version:this._data.web_unity_version,user_agent:window.navigator.userAgent}}unity_session_id(){return this._data.unity_session_id}}})),define("modules/clean/unity/versions",["require","exports"],(function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),(function(e){e[e.LATEST=16]="LATEST",e[e.INITIAL_UNITY=1]="INITIAL_UNITY",e[e.UNITY_HANDSHAKE=2]="UNITY_HANDSHAKE",e[e.REUNITY=3]="REUNITY",e[e.OPEN_IN_FILE_BROWSER=4]="OPEN_IN_FILE_BROWSER",e[e.CHECK_FILE_RETURNS_OBJ=5]="CHECK_FILE_RETURNS_OBJ",e[e.PERMISSION_LEVELS=6]="PERMISSION_LEVELS",e[e.WEB_DESTINY=7]="WEB_DESTINY",e[e.WEB_DESTINY_V2=8]="WEB_DESTINY_V2",e[e.PORT_CHECK=9]="PORT_CHECK",e[e.CHIME_OPEN=10]="CHIME_OPEN",e[e.GROWTH_DEEP_LINK=15]="GROWTH_DEEP_LINK",e[e.OPEN_COLLAB_BROWSE=16]="OPEN_COLLAB_BROWSE"})(n||(n={})),t.default=n})),define("modules/clean/unity/web_socket",["require","exports","tslib","modules/clean/unity/logger","modules/clean/unity/websocket_config"],(function(e,t,n,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UnityWebSocket=void 0,i=n.__importDefault(i),t.UnityWebSocket={create(e){const t=new i.default;return s.WebSocketConfig.canUnityConnect()&&t.report_event("using_default_web_socket"),new WebSocket(e)},web_sockets_supported:()=>s.WebSocketConfig.canUnityConnect()}})),define("modules/clean/unity/websocket_config",["require","exports","tslib","modules/core/browser_detection"],(function(e,t,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WebSocketConfig=void 0,i=n.__importStar(i),t.WebSocketConfig={canUnityConnect:()=>t.WebSocketConfig.canBrowserSupportNonSecureWebsocket(),canBrowserSupportNonSecureWebsocket(){const e=parseInt(i.version,10);return!!(i.safari&&e<9)||(!!(i.mozilla&&e>=55)||(!!(i.chrome&&e>=53)||!!i.edgeChromium()))}},t.default=t.WebSocketConfig})),define("spectrum-sharing/components/sharing_spinner/index",["require","exports","tslib","spectrum-sharing/components/sharing_spinner/sharing_spinner"],(function(e,t,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n.__exportStar(i,t)})),define("spectrum-sharing/components/sharing_spinner/sharing_spinner",["require","exports","tslib","react","classnames","dig-components/typography","dig-components/progress_indicators"],(function(e,t,n,i,s,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SharingSpinner=void 0,i=n.__importStar(i),s=n.__importDefault(s);class a extends i.Component{render(){const{ariaValue:e,iconSize:t,textSize:n,message:a,className:_}=this.props,l=s.default("scl-sharing-spinner__text",_);return i.createElement(o.Text,{size:n,isBold:!0},i.createElement(r.Spinner,{"aria-valuetext":e,size:t,className:"scl-sharing-spinner__icon"}),a&&i.createElement("span",{className:l},a))}}t.SharingSpinner=a,a.displayName="SharingSpinner",a.defaultProps={iconSize:"xsmall"}})),define("spectrum-sharing/utils/logging",["require","exports"],(function(e,t){"use strict";var n,i,s,o,r,a,_;Object.defineProperty(t,"__esModule",{value:!0}),t.LinkKeyTypes=t.LinkTypes=t.AccessType=t.ScreenName=t.SettingsTabName=t.ShareTabName=t.TiburonEventName=void 0,(n=t.TiburonEventName||(t.TiburonEventName={})).AttemptTargetValidation="ATTEMPT_TARGET_VALIDATION",n.BeginShareFlow="BEGIN_SHARE_FLOW",n.ClickManageAccess="CLICK_MANAGE_ACCESS",n.SelectChangeMemberPermission="SELECT_CHANGE_MEMBER_PERMISSION",n.SucceedChangeMemberPermission="SUCCEED_CHANGE_MEMBER_PERMISSION",n.FailChangeMemberPermission="FAIL_CHANGE_MEMBER_PERMISSION",n.AttemptCreateSharedLinkWithSettings="ATTEMPT_CREATE_SHARED_LINK_WITH_SETTINGS",n.SucceedCreateSharedLinkWithSettings="SUCCEED_CREATE_SHARED_LINK_WITH_SETTINGS",n.FailCreateSharedLinkWithSettings="FAIL_CREATE_SHARED_LINK_WITH_SETTINGS",n.ClickTibCopyLink="CLICK_TIB_COPY_LINK",n.ClickTibCreateLink="CLICK_TIB_CREATE_LINK",n.ClickInbandShareButton="CLICK_INBAND_SHARE_BUTTON",n.CopySharedLink="COPY_SHARED_LINK",n.CopySharedLinkFailure="COPY_SHARED_LINK_FAILURE",n.ElementClick="ELEMENT_CLICK",n.ElementView="ELEMENT_VIEW",n.FailInbandShare="FAIL_INBAND_SHARE",n.FailTargetValidation="FAIL_TARGET_VALIDATION",n.MemberListLoaded="MEMBER_LIST_LOADED",n.OpenFileSettingsModal="OPEN_FILE_SETTINGS_MODAL",n.OpenFolderSettingsModal="OPEN_FOLDER_SETTINGS_MODAL",n.OpenLinkSettingsModal="OPEN_LINK_SETTINGS_MODAL",n.OpenParentFolderAccessModal="OPEN_PARENT_FOLDER_ACCESS_MODAL",n.ShareModalEmailUnverified="SHARE_MODAL_EMAIL_UNVERIFIED",n.SucceedInbandShare="SUCCEED_INBAND_SHARE",n.SucceedTargetValidation="SUCCEED_TARGET_VALIDATION",n.ViewLinkOnlyModal="VIEW_LINK_ONLY_MODAL",n.ViewShareModal="VIEW_SHARE_MODAL",n.AttemptTargetSearch="ATTEMPT_TARGET_SEARCH",n.SucceedTargetSearch="SUCCEED_TARGET_SEARCH",n.FailTargetSearch="FAIL_TARGET_SEARCH",n.AttemptNavigateAwayDuringShare="ATTEMPT_NAVIGATE_AWAY_DURING_SHARE",n.SucceedNavigateAwayDuringShare="SUCCEED_NAVIGATE_AWAY_DURING_SHARE",n.AttemptRemoveAllMembers="ATTEMPT_REMOVE_ALL_MEMBERS",n.SucceedRemoveAllMembers="SUCCEED_REMOVE_ALL_MEMBERS",n.FailRemoveAllMembers="FAIL_REMOVE_ALL_MEMBERS",n.ChangeSharedLinkAudience="CHANGE_SHARED_LINK_AUDIENCE",n.ClickShareButtonLinkSettingsStatus="CLICK_SHARE_BUTTON_LINK_SETTINGS_STATUS",n.ClickSettingsText="CLICK_SETTINGS_TEXT",n.ClickSettingsGear="CLICK_SETTINGS_GEAR",n.CloseShareModal="CLOSE_SHARE_MODAL",n.ViewManageAccessScreen="VIEW_MANAGE_ACCESS_SCREEN",n.ViewSettingsScreen="VIEW_SETTINGS_SCREEN",n.ViewShareScreen="VIEW_SHARE_SCREEN",n.ViewShareTab="VIEW_SHARE_TAB",n.ViewSettingsTab="VIEW_SETTINGS_TAB",(i=t.ShareTabName||(t.ShareTabName={})).EditTab="edit_tab",i.ViewTab="view_tab",(s=t.SettingsTabName||(t.SettingsTabName={})).FileSettingsTab="file_settings",s.FolderSettingsTab="folder_settings",s.EditLinkSettingsTab="edit_link_settings",s.ViewLinkSettingsTab="view_link_settings",(o=t.ScreenName||(t.ScreenName={})).ShareScreen="share_screen",o.ManageAccessScreen="manage_access_screen",o.SettingsScreen="settings_screen",(r=t.AccessType||(t.AccessType={})).Editor="editor",r.Viewer="viewer",(a=t.LinkTypes||(t.LinkTypes={}))[a.NONE=0]="NONE",a.Righteous="righteous",a.Shmodel="shmodel",(_=t.LinkKeyTypes||(t.LinkKeyTypes={}))[_.NONE=0]="NONE",_.RL="rlkey",_.SH="tkey"}));
//# sourceMappingURL=pkg-unity-and-copy-link.min.js-vflAy6PbR.map