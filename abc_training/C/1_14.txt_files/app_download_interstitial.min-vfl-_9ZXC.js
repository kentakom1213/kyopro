define(["require","exports","tslib","react","modules/clean/bug_reporting/routing","modules/clean/react/file_viewer/app_download_interstitial/app_download_interstitial","modules/clean/react/file_viewer/constants","modules/clean/analytics","modules/clean/web_timing_logger","modules/clean/file_store/utils","modules/core/browser_detection","modules/clean/react/file_viewer/utils","modules/clean/react/open_in_app/banner","modules/constants/file_viewer"],(function(e,t,n,i,o,l,s,a,r,p,d,c,u,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeOpenInAppPluginLoader=t.APP_DOWNLOAD_PLUGIN_ID=t.FvsdkAppDownloadInterstitial=void 0,i=n.__importDefault(i),d=n.__importStar(d),t.FvsdkAppDownloadInterstitial=e=>{const{file:t,sharedLinkInfo:n,onDismiss:d,openInAppData:c,fileViewerSessionId:u,filePreviewSessionId:_,onAppDownload:A,logUserAction:I}=e,f=p.getFilename(t),m=i.default.useCallback(e=>{t.ns_id&&t.sjid&&(a.MobileFilePreviewLogger.log(e,u,_,t.ns_id,t.sjid,{context:s.UserActionContext.AppDownloadInterstitial}),I({action:e,context:s.UserActionContext.AppDownloadInterstitial}))},[t,_,u,I]);i.default.useEffect(()=>{r.mark_time_to_interactive(),m(s.UserAction.AppDownloadInterstitialView)},[]);const w=i.default.useCallback(()=>{d(),m(s.UserAction.AppDownloadInterstitialContinue)},[d,m]),h=i.default.useCallback(()=>{d(),m(s.UserAction.AppDownloadInterstitialClose)},[d]),g=i.default.useCallback(()=>{m(s.UserAction.AppDownloadInterstitialInstall),A()},[d,A]);return i.default.createElement(o.RegisterComponentWithBugReporter,{componentId:"web.previews",componentName:"File Preview"},i.default.createElement("div",{"aria-label":f},i.default.createElement(l.AppDownloadInterstitial,{fileOrFolderName:f,open_in_app_data:c,onContinue:w,onAppDownload:g,ownerName:n.ownerName,ownerTeamName:n.ownerTeamName,onClose:h})))},t.FvsdkAppDownloadInterstitial.displayName="FvsdkAppDownloadInterstitial";t.APP_DOWNLOAD_PLUGIN_ID="app_download",t.makeOpenInAppPluginLoader=function(e,o,l){return a=>n.__awaiter(this,void 0,void 0,(function*(){return class extends class{constructor(e,n,o,l){this.context=e,this.getActiveFile=n,this.user=o,this.hideOpenInAppInterstitial=l,this.openInAppBannerOnClick=()=>{this.context.logUserAction({action:s.UserAction.OpenInApp,context:s.UserActionContext.OpenInAppBanner,mobile_web_appbanner_color_experiment:_.MOBILE_WEB_BANNER_EXPERIMENT})},this.getHeader=()=>{if(this.context.sdkConfig.preview_content_only)return null;if(!d.is_mobile_or_tablet()&&(d.iOS||d.is_android()))return null;const{file:e,shareToken:t,sharePermission:n}=this.getActiveFile(),o=c.getOpenInAppUrls(e,t,n,this.user);if(o){const l=!(e&&t&&n);return({onHide:e})=>i.default.createElement("div",{style:{width:"100%"}},i.default.createElement(u.OpenInAppBanner,{urls:o,onClick:this.openInAppBannerOnClick,onClose:e,mobileWebExperiment:"ON"===_.MOBILE_WEB_BANNER_EXPERIMENT,isMountedFile:l}))}return null},this.Interstitial=({onHide:e,onClickAppDownload:n})=>{const{file:o,sharedLinkInfo:l}=this.getActiveFile();return p.isSharedFile(o)&&l&&o.open_in_app_data?i.default.createElement(t.FvsdkAppDownloadInterstitial,{file:o,openInAppData:o.open_in_app_data,sharedLinkInfo:l,onDismiss:e,onAppDownload:n,fileViewerSessionId:this.context.getFileViewerSessionId(),filePreviewSessionId:this.context.getFilePreviewSessionId(),logUserAction:this.context.logUserAction}):null},this.getInterstitial=()=>{if(this.hideOpenInAppInterstitial)return null;const{file:e,sharedLinkInfo:t}=this.getActiveFile();return p.isSharedFile(e)&&t&&e.open_in_app_data?this.Interstitial:null},this.lifecycle={}}}{constructor(t){super(t,e,o,l)}}}))}}));
//# sourceMappingURL=app_download_interstitial.min.js-vfllm77Wk.map