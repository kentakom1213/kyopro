define(["require","exports","tslib","react","react-redux","typescript/libraries/file-viewer/src/plugins/index","modules/clean/react/file_viewer/sdk_file_viewer/action_plugins/utils","modules/core/i18n","dig-components/menu","dig-components/buttons","dig-components/icons","dig-components/icons/src","modules/clean/react/extensions/data/store","modules/clean/react/extensions/data/helpers","modules/clean/react/extensions/data/selectors","modules/clean/react/action_bar/action_bar_strings","modules/clean/react/action_bar/file_actions/portable/go_to_folder","modules/clean/react/extensions/extensions_menu_component_v2","modules/clean/react/file_viewer/unity/with_unity","modules/clean/file_store/utils"],(function(e,t,n,o,i,s,r,a,l,c,u,d,p,f,m,_,O,g,I,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeOpenDropdownActionLoader=t.OpenMenuContent=t.OPEN_DROPDOWN_ACTION_PLUGIN_ID=void 0,o=n.__importDefault(o);const w={surface:"previews"};t.OPEN_DROPDOWN_ACTION_PLUGIN_ID="OPEN_DROPDOWN_ACTION",t.OpenMenuContent=e=>h.isBrowseFile(e.file)?o.default.createElement(I.WithUnity,{file:e.file,user:e.user,render:t=>o.default.createElement(g.ExtensionsPopoverContent,Object.assign({},e,{unityInfo:t}))}):o.default.createElement(g.ExtensionsPopoverContent,Object.assign({},e)),t.OpenMenuContent.displayName="OpenMenuContent";const v=({file:e,user:n,store:r,logUserAction:p})=>{const f=o.default.createElement(t.OpenMenuContent,{user:n,file:e,isInActionBar:!0,telemetryContext:w,goToFolderActionHandler:()=>((e,t)=>{if(h.isBrowseFile(e)){const n=[e.fq_path];O.handleShowInFolder({fqPaths:n,user:t})}})(e,n),hideZipAction:!0}),m=o.default.createElement(u.UIIcon,{src:d.OpenLine}),g=a.intl.formatMessage(_.OPEN_ACTION_STRING),I=e=>{e.menuItem.handler(),p(Object.assign({action:e.menuItem.userAction||"unknown",context:s.UserActionContext.Toolbar},e.menuItem.actionName&&{app_action_name:e.menuItem.actionName}))};return{renderButton:e=>o.default.createElement(i.Provider,{store:r},o.default.createElement(l.Menu.Wrapper,{onSelection:I},({getTriggerProps:t,getContentProps:n})=>o.default.createElement(o.default.Fragment,null,o.default.createElement(c.Button,Object.assign({},t(),{variant:"opacity",withIconLeft:e?null:m,withDropdownIcon:!0}),g),o.default.createElement(l.Menu.Content,Object.assign({},n()),f)))),overflowItem:o.default.createElement(i.Provider,{store:r},o.default.createElement(l.Menu.Submenu,{withTriggerContent:g,withLeftAccessory:m},f))}};v.displayName="OpenDropdownPreview",t.makeOpenDropdownActionLoader=(e,t)=>()=>{const n=p.getStore();return Promise.resolve(class{constructor(e){this.lifecycle={previewWillInitialize:()=>{this.actionDefinitions.atTopLevelIfSpace=this.actionToDisplay(),this.actionDefinitions.alwaysInOverflow=[this.actionToDisplay()]}},this.context=e}get actionDefinitions(){return{atTopLevelIfSpace:this.actionToDisplay(),alwaysInOverflow:[this.actionToDisplay()]}}actionToDisplay(){const{file:o}=e();if(!r.isLiveFile(o)||r.isInsideVaultFolder(o)||r.isPnmLinkNodeSelected(o)||h.isArchiveFile(o))return[];if(h.isSharedFile(o)){const e=m.getOpenActionsForFile(n.getState(),o);if(0===f.partitionActions(e).cloudEditors.length)return[]}return[v({file:e().file,store:n,user:t,logUserAction:this.context.logUserAction})]}})}}));
//# sourceMappingURL=open_dropdown_plugin.min.js-vfl1LvF9x.map