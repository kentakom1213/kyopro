define(["require","exports","tslib","react-intl","react","dig-components/menu","dig-components/buttons","dig-components/icons","dig-components/icons/src","typescript/component_libraries/retrieval-components/src/simple-action-bar/action_bar_types","typescript/libraries/file-viewer/src/plugins/types"],(function(e,t,n,r,o,a,l,s,i,c,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getRootName=t.extractSnackbarManagerFromPlugins=t.extractToolbarComponentsFromPlugins=t.extractTitlebarComponentsFromPlugins=t.extractActionsFromPlugins=void 0,o=n.__importStar(o);const f=e=>({actionType:c.ActionBarActionTypes.ADD_CONTENT,text:r.defineMessage({id:"C2s323",defaultMessage:"Blank"}),icon:o.default.createElement("div",null),isEnabled:!0,renderButton:e.renderButton,overflowItem:e.overflowItem}),d=(e,t)=>{const n=u.parseActionBarPluginInstance(t);if(null==n)return e;const{alwaysAtTopLevel:r,atTopLevelIfSpace:o,alwaysInOverflow:a}=n.actionDefinitions,l=(e=[],t=[])=>[...e,...t];return{alwaysAtTopLevel:l(e.alwaysAtTopLevel,null==r?void 0:r.map(f)),atTopLevelIfSpace:l(e.atTopLevelIfSpace,null==o?void 0:o.map(f)),alwaysInOverflow:((e=[],t=[])=>{var n,r;const o=[];for(let a=0;a<e.length||a<t.length;a++)o[a]=[...null!==(n=e[a])&&void 0!==n?n:[],...null!==(r=t[a])&&void 0!==r?r:[]];return o})(e.alwaysInOverflow,null==a?void 0:a.map(e=>e.map(f)))}},m=(e,t)=>{const n=u.parseTitleBarPluginInstance(t);if(null==n)return e;{const{identifier:t,titleBarUI:r}=n;return Object.assign(Object.assign({},e),{[t]:r})}},p=(e,t)=>{const n=u.parseToolbarPluginInstance(t);return n?Object.assign(Object.assign({},e),{[n.identifier]:n.toolbarUI}):e},g={workflows:r.defineMessage({id:"6BWuNX",defaultMessage:"Workflows"})},v={workflows:i.MemberTransferLine},w=({category:e,children:t,hideIcons:n})=>{const i=r.useIntl(),c=g[e],u=v[e],f=o.useCallback(e=>{null==e||e.handler()},[]);return o.default.createElement(a.Menu.Wrapper,{onSelection:f},({getTriggerProps:r,getContentProps:f})=>o.default.createElement(o.default.Fragment,null,o.default.createElement(l.Button,Object.assign({},r(),{variant:"opacity",withIconLeft:n?null:o.default.createElement(s.UIIcon,{src:u}),withDropdownIcon:!0,className:e+"-menu-button"}),i.formatMessage(c)),o.default.createElement(a.Menu.Content,Object.assign({},f()),o.default.createElement(a.Menu.Segment,null,t))))};w.displayName="CategoryButton";const b=({category:e,children:t})=>{const n=r.useIntl(),l=g[e],i=v[e];return o.default.createElement(a.Menu.Submenu,{withTriggerContent:n.formatMessage(l),withLeftAccessory:o.default.createElement(s.UIIcon,{src:i})},o.default.createElement(a.Menu.Segment,null,t))};b.displayName="CategorySubmenu";const I=(e,t,n)=>{var r,a,l,s,i;const c=[];if(e.workflows&&e.workflows.length>0){const t=((e,t)=>{const n=t.map(e=>{var t;return null!==(t=e.overflowItem)&&void 0!==t?t:null}).filter(e=>null!==e);if(0===n.length)return;const r=o.default.createElement(b,{category:e},n);return f({renderButton:t=>o.default.createElement(w,{category:e,hideIcons:t},n),overflowItem:r})})("workflows",e.workflows);void 0!==t&&c.push(t)}const u=t.map(f),d=(null!==(r=n.atTopLevelIfSpace)&&void 0!==r?r:[]).length,m=null!==(s=null===(l=null!==(a=n.alwaysInOverflow)&&void 0!==a?a:[])||void 0===l?void 0:l[0])&&void 0!==s?s:[],p=m.slice(0,d),g=m.slice(d),v=[...p,...u,...c,...g];return Object.assign(Object.assign({},n),{atTopLevelIfSpace:[...null!==(i=n.atTopLevelIfSpace)&&void 0!==i?i:[],...u,...c],alwaysInOverflow:[v]})},y=e=>e.reduce((e,t)=>((e,t)=>{var n,r;const o=e;let a;for(a in t){const l=null!==(n=e[a])&&void 0!==n?n:[],s=null!==(r=t[a])&&void 0!==r?r:[];o[a]=[...l,...s]}return o})(e,(e=>{var t;const n=u.parseActionBarPluginInstance(e);return null==n?{}:null!==(t=n.actionDefinitions.categories)&&void 0!==t?t:{}})(t)),{});t.extractActionsFromPlugins=function(e,t){const n=Object.values(e),r=n.reduce(d,{}),o=y(n);return I(o,t,r)},t.extractTitlebarComponentsFromPlugins=function(e){return Object.values(e).reduce(m,{})},t.extractToolbarComponentsFromPlugins=function(e){return Object.values(e).reduce(p,{})},t.extractSnackbarManagerFromPlugins=function(e){return Object.values(e).find(u.isSnackbarManagerPluginInstance)};t.getRootName=function(e){return"work"===e.role&&e.team?e.team.name:e.is_paired?"Personal":"Dropbox"}}));
//# sourceMappingURL=utils.amd.min.js-vflBh_b55.map