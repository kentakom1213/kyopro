define(["require","exports","tslib","react","dig-components/buttons","classnames","typescript/component_libraries/flows/src/components/spacer/index","react-intl","react-intl","dig-components/chips","dig-components/icons","dig-components/icons/src","dig-components/text_fields","dig-components/typography","dig-components/avatar","dig-components/tooltips","dig-components/badges"],(function(e,a,t,l,o,r,s,n,i,p,d,c,m,u,f,v,g){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.ApprovalRespondForm=a.ApprovalRespondFormInternal=void 0,l=t.__importStar(l),r=t.__importDefault(r),a.ApprovalRespondFormInternal=({onCancel:e,onRespondSuccess:a,onEditSuccess:t,user:n,inlineWithComments:_,ioClient:b,fileId:h,threadId:E,editArgs:M})=>{var I;const[R,y]=l.useState(null!==(I=null==M?void 0:M.content)&&void 0!==I?I:""),[A,C]=l.useState("approved"==(null==M?void 0:M.approvalMetadata.status)||"rejected"!=(null==M?void 0:M.approvalMetadata.status)&&void 0),[F,L]=l.useState(!1),[S,N]=l.useState(!1),T=l.default.useRef(null),{title:x,submitButtonLabel:B,cancelButtonLabel:q,detailsInputLabel:j,detailsInputPlaceholder:z,approveChipLabel:k,rejectChipLabel:w,genericError:D,approveOrRequestFirstTooltip:P,addDetailsTooltip:O,betaBadgeLabel:U}=(function(){const e=i.useIntl();return{title:e.formatMessage({id:"TKvySt",defaultMessage:"Respond to request"}),submitButtonLabel:e.formatMessage({id:"mVrd/b",defaultMessage:"Submit"}),cancelButtonLabel:e.formatMessage({id:"KQ8scR",defaultMessage:"Cancel"}),detailsInputLabel:e.formatMessage({id:"rFAfdB",defaultMessage:"Details"}),detailsInputPlaceholder:e.formatMessage({id:"hzYIsD",defaultMessage:"Tell requester more about your decision"}),approveChipLabel:e.formatMessage({id:"TjnDNv",defaultMessage:"Approve"}),rejectChipLabel:e.formatMessage({id:"YEnec6",defaultMessage:"Request change"}),genericError:e.formatMessage({id:"vK1TiB",defaultMessage:"Something went wrong. Please try again later."}),approveOrRequestFirstTooltip:e.formatMessage({id:"2p63Fj",defaultMessage:"Approve or request change first"}),addDetailsTooltip:e.formatMessage({id:"wWiE03",defaultMessage:"Add details about your change request"}),betaBadgeLabel:e.formatMessage({id:"HA3jPv",defaultMessage:"Beta"})}})(),K=b.getLogger();l.default.useEffect(()=>{K.logShownRespondForm(h,E)},[h,E]);const W=()=>{L(!1),N(!0);const e={type:"approval",status:A?"approved":"rejected",approver_email:null==M?void 0:M.approvalMetadata.approver_email,requester_email:null==M?void 0:M.approvalMetadata.requester_email,approval_type:"response",actor:"approver",approver_display_name:null==M?void 0:M.approvalMetadata.approver_display_name};M?b.editApprovalResponse(h,M.commentId,A,R).then(a=>{K.logApprovalResponseResubmitSucccess(h,E,R.length,e.status,a.comment_id),t&&t(M.commentId,E,{text:R,metadata:[e]})}).catch(()=>{L(!0),N(!1)}):b.respondToApprovalRequest(h,E,A,R).then(t=>{a&&a({text:R,metadata:[e]},E),K.logSubmitResponseSuccess(h,E,e.status,R.length,t.comment_id)}).catch(()=>{L(!0),N(!1)})},H=A||void 0!==A&&!!R,Y=e=>l.default.createElement(o.Button,{onClick:W,variant:"primary",size:"small",disabled:e,className:"approval-form__footer_primary-action",isLoading:S},B),Q=e=>{K.logApproveChipClick(h,E,e),C(e)};return l.default.createElement("div",{className:r.default("approval-form",{"inline-with-comments":_}),ref:T},l.default.createElement("div",{className:"approval-form__title"},l.default.createElement(f.Avatar,{src:n.photoUrl,backgroundColor:f.avatarColorForUserIdentifier(n.initials),hasNoOutline:!0,size:"small",style:{marginRight:"6px"}},n.initials),l.default.createElement(u.Text,{isBold:!0,tagName:"h1"},x),l.default.createElement(g.AccessoryBadge,null,U)),l.default.createElement("div",{className:"approval-form__body"},l.default.createElement("div",{className:"approval-respond-form__action-chips-group"},l.default.createElement(p.FilterChip,{className:A?"approve-action-selected":void 0,isSelected:A,onClick:()=>Q(!0),withIconLeft:l.default.createElement("div",{className:"approval-respond-form__icon-container"},l.default.createElement(d.UIIcon,{size:"small",src:c.CheckmarkCircleLine})),size:"small"},k),l.default.createElement(s.Spacer,{multiplier:2}),l.default.createElement(p.FilterChip,{className:!1===A?"reject-action-selected":void 0,isSelected:!1===A,onClick:()=>Q(!1),withIconLeft:l.default.createElement("div",{className:"approval-respond-form__icon-container"},l.default.createElement(d.UIIcon,{size:"small",src:c.WarningLine})),size:"small"},w)),l.default.createElement(s.Spacer,{multiplier:2}),l.default.createElement(m.FormLabel,{htmlFor:"approval-respond-form__details-input"},l.default.createElement(u.Text,{isBold:!0,size:"small",tagName:"label"},j)),l.default.createElement(m.TextArea,{className:"approval-forms__text-area",id:"approval-respond-form__details-input",placeholder:z,"aria-label":z,value:R,onChange:e=>{y(e.currentTarget.value)},style:{boxSizing:"border-box"}}),F&&l.default.createElement(m.FormHelperText,{isInvalid:!0},D)),l.default.createElement("div",{className:"approval-form__footer"},l.default.createElement(o.Button,{onClick:()=>{e&&(K.logCancelApproval(h,"respond_approval_form"),e())},variant:"transparent",size:"small",disabled:S},q),H?Y(!1):l.default.createElement(v.Tooltip,{title:null==A?P:A||R?null:O,placement:"top-start",auto:!0,boundary:T},l.default.createElement("span",{style:{display:"inline-block"},tabIndex:0},Y(!0)))))},a.ApprovalRespondFormInternal.displayName="ApprovalRespondFormInternal",a.ApprovalRespondForm=e=>l.default.createElement(n.RawIntlProvider,{value:e.intl},l.default.createElement(a.ApprovalRespondFormInternal,Object.assign({},e))),a.ApprovalRespondForm.displayName="ApprovalRespondForm"}));
//# sourceMappingURL=respond_form.amd.min.js-vfliuMV8Y.map